var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(a,b){"object"==(typeof module==="undefined"?"undefined":_typeof(module))&&"object"==_typeof(module.exports)?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a);}:b(a);}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.4",n=function n(a,b){return new n.fn.init(a,b);},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function r(a,b){return b.toUpperCase();};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function toArray(){return d.call(this);},get:function get(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this);},pushStack:function pushStack(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b;},each:function each(a,b){return n.each(this,a,b);},map:function map(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b);}));},slice:function slice(){return this.pushStack(d.apply(this,arguments));},first:function first(){return this.eq(0);},last:function last(){return this.eq(-1);},eq:function eq(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[]);},end:function end(){return this.prevObject||this.constructor(null);},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==(typeof g==="undefined"?"undefined":_typeof(g))||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++){if(null!=(a=arguments[h]))for(b in a){c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));}}return g;},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function error(a){throw new Error(a);},noop:function noop(){},isFunction:function isFunction(a){return"function"===n.type(a);},isArray:Array.isArray,isWindow:function isWindow(a){return null!=a&&a===a.window;},isNumeric:function isNumeric(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0;},isPlainObject:function isPlainObject(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0;},isEmptyObject:function isEmptyObject(a){var b;for(b in a){return!1;}return!0;},type:function type(a){return null==a?a+"":"object"==(typeof a==="undefined"?"undefined":_typeof(a))||"function"==typeof a?h[i.call(a)]||"object":typeof a==="undefined"?"undefined":_typeof(a);},globalEval:function globalEval(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a));},camelCase:function camelCase(a){return a.replace(p,"ms-").replace(q,r);},nodeName:function nodeName(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase();},each:function each(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++){if(d=b.apply(a[e],c),d===!1)break;}}else for(e in a){if(d=b.apply(a[e],c),d===!1)break;}}else if(g){for(;f>e;e++){if(d=b.call(a[e],e,a[e]),d===!1)break;}}else for(e in a){if(d=b.call(a[e],e,a[e]),d===!1)break;}return a;},trim:function trim(a){return null==a?"":(a+"").replace(o,"");},makeArray:function makeArray(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c;},inArray:function inArray(a,b,c){return null==b?-1:g.call(b,a,c);},merge:function merge(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++){a[e++]=b[d];}return a.length=e,a;},grep:function grep(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++){d=!b(a[f],f),d!==h&&e.push(a[f]);}return e;},map:function map(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++){d=b(a[f],f,c),null!=d&&i.push(d);}else for(f in a){d=b(a[f],f,c),null!=d&&i.push(d);}return e.apply([],i);},guid:1,proxy:function proxy(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function f(){return a.apply(b||this,e.concat(d.call(arguments)));},f.guid=a.guid=a.guid||n.guid++,f):void 0;},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase();});function s(a){var b="length"in a&&a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a;}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date(),v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function B(a,b){return a===b&&(l=!0),0;},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function J(a,b){for(var c=0,d=a.length;d>c;c++){if(a[c]===b)return c;}return-1;},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function da(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320);},ea=function ea(){m();};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType;}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b));}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]){}a.length=c-1;}};}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d;}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d;}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d;}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--){o[l]=s+ra(o[l]);}w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",");}if(x)try{return H.apply(d,w.querySelectorAll(x)),d;}catch(y){}finally{r||b.removeAttribute("id");}}}return i(a.replace(R,"$1"),b,d,e);}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e;}return b;}function ia(a){return a[u]=!0,a;}function ja(a){var b=n.createElement("div");try{return!!a(b);}catch(c){return!1;}finally{b.parentNode&&b.parentNode.removeChild(b),b=null;}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--){d.attrHandle[c[e]]=b;}}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling){if(c===b)return-1;}return a?1:-1;}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a;};}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a;};}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--){c[e=f[g]]&&(c[e]=!(d[e]=c[e]));}});});}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a;}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1;},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className");}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length;}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length;}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[];}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b;};}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b;};}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0;}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++]){1===c.nodeType&&d.push(c);}return d;}return f;},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0;},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]");}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:");})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P);}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)));}:function(a,b){if(b)while(b=b.parentNode){if(b===a)return!0;}return!1;},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1);}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode){h.unshift(c);}c=b;while(c=c.parentNode){i.unshift(c);}while(h[d]===i[d]){d++;}return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0;},g):n;},ga.matches=function(a,b){return ga(a,null,null,b);},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d;}catch(e){}return ga(b,n,null,[a]).length>0;},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b);},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null;},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a);},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++]){b===a[f]&&(e=d.push(f));}while(e--){a.splice(d[e],1);}}return k=null,a;},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling){c+=e(a);}}else if(3===f||4===f)return a.nodeValue;}else while(b=a[d++]){c+=e(b);}return c;},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function ATTR(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4);},CHILD:function CHILD(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a;},PSEUDO:function PSEUDO(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3));}},filter:{TAG:function TAG(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0;}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b;};},CLASS:function CLASS(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"");});},ATTR:function ATTR(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0;};},CHILD:function CHILD(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode;}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p]){if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;}o=p="only"===a&&!o&&"nextSibling";}return!0;}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break;}}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;}return m-=e,m===d||m%d===0&&m/d>=0;}};},PSEUDO:function PSEUDO(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--){d=J(a,f[g]),a[d]=!(c[d]=f[g]);}}):function(a){return e(a,0,c);}):e;}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--){(f=g[h])&&(a[h]=!(b[h]=f));}}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop();};}),has:ia(function(a){return function(b){return ga(a,b).length>0;};}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1;};}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");}while((b=b.parentNode)&&1===b.nodeType);return!1;};}),target:function target(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id;},root:function root(a){return a===o;},focus:function focus(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex);},enabled:function enabled(a){return a.disabled===!1;},disabled:function disabled(a){return a.disabled===!0;},checked:function checked(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected;},selected:function selected(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0;},empty:function empty(a){for(a=a.firstChild;a;a=a.nextSibling){if(a.nodeType<6)return!1;}return!0;},parent:function parent(a){return!d.pseudos.empty(a);},header:function header(a){return Z.test(a.nodeName);},input:function input(a){return Y.test(a.nodeName);},button:function button(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b;},text:function text(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase());},first:oa(function(){return[0];}),last:oa(function(a,b){return[b-1];}),eq:oa(function(a,b,c){return[0>c?c+b:c];}),even:oa(function(a,b){for(var c=0;b>c;c+=2){a.push(c);}return a;}),odd:oa(function(a,b){for(var c=1;b>c;c+=2){a.push(c);}return a;}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;){a.push(d);}return a;}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;){a.push(d);}return a;})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){d.pseudos[b]=ma(b);}for(b in{submit:!0,reset:!0}){d.pseudos[b]=na(b);}function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa(),g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter){!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));}if(!c)break;}return b?h.length:h?ga.error(a):z(a,i).slice(0);};function ra(a){for(var b=0,c=a.length,d="";c>b;b++){d+=a[b].value;}return d;}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d]){if(1===b.nodeType||e)return a(b,c,f);}}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d]){if((1===b.nodeType||e)&&a(b,c,g))return!0;}}else while(b=b[d]){if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0;}}};}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--){if(!a[e](b,c,d))return!1;}return!0;}:a[0];}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++){ga(a,b[d],c);}return c;}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++){(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));}return g;}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--){(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));}}if(f){if(e||a){if(e){j=[],k=r.length;while(k--){(l=r[k])&&j.push(q[k]=l);}e(null,r=[],j,i);}k=r.length;while(k--){(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l));}}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r);});}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b;},h,!0),l=sa(function(a){return J(b,a)>-1;},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e;}];f>i;i++){if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++){if(d.relative[a[e].type])break;}return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a));}m.push(c);}}return ta(m);}function ya(a,b){var c=b.length>0,e=a.length>0,f=function f(_f,g,h,i,k){var l,m,o,p=0,q="0",r=_f&&[],s=[],t=j,u=_f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++]){if(o(l,g,h)){i.push(l);break;}}k&&(w=v);}c&&((l=!o&&l)&&p--,_f&&r.push(l));}if(p+=q,c&&q!==p){m=0;while(o=b[m++]){o(r,s,g,h);}if(_f){if(p>0)while(q--){r[q]||s[q]||(s[q]=F.call(i));}s=va(s);}H.apply(i,s),k&&!_f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i);}return k&&(w=v,j=t),r;};return c?ia(f):f;}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--){f=xa(b[c]),f[u]?d.push(f):e.push(f);}f=A(a,ya(e,d)),f.selector=a;}return f;},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length);}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break;}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e;},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"));}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href");})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2);}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value");})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue;}),ja(function(a){return null==a.getAttribute("disabled");})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null;}),ga;}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c;});if(b.nodeType)return n.grep(a,function(a){return a===b!==c;});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a);}return n.grep(a,function(a){return g.call(b,a)>=0!==c;});}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType;}));},n.fn.extend({find:function find(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++){if(n.contains(e[b],this))return!0;}}));for(b=0;c>b;b++){n.find(a,e[b],d);}return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d;},filter:function filter(a){return this.pushStack(x(this,a||[],!1));},not:function not(a){return this.pushStack(x(this,a||[],!0));},is:function is(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length;}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b){n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);}return this;}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this;}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this));};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function dir(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType){if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a);}}return d;},sibling:function sibling(a,b){for(var c=[];a;a=a.nextSibling){1===a.nodeType&&a!==b&&c.push(a);}return c;}}),n.fn.extend({has:function has(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++){if(n.contains(this,b[a]))return!0;}});},closest:function closest(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++){for(c=this[d];c&&c!==b;c=c.parentNode){if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break;}}}return this.pushStack(f.length>1?n.unique(f):f);},index:function index(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1;},add:function add(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))));},addBack:function addBack(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a));}});function D(a,b){while((a=a[b])&&1!==a.nodeType){}return a;}n.each({parent:function parent(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null;},parents:function parents(a){return n.dir(a,"parentNode");},parentsUntil:function parentsUntil(a,b,c){return n.dir(a,"parentNode",c);},next:function next(a){return D(a,"nextSibling");},prev:function prev(a){return D(a,"previousSibling");},nextAll:function nextAll(a){return n.dir(a,"nextSibling");},prevAll:function prevAll(a){return n.dir(a,"previousSibling");},nextUntil:function nextUntil(a,b,c){return n.dir(a,"nextSibling",c);},prevUntil:function prevUntil(a,b,c){return n.dir(a,"previousSibling",c);},siblings:function siblings(a){return n.sibling((a.parentNode||{}).firstChild,a);},children:function children(a){return n.sibling(a.firstChild);},contents:function contents(a){return a.contentDocument||n.merge([],a.childNodes);}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e);};});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0;}),b;}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function j(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++){if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break;}}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable());},k={add:function add(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c);});}(arguments),d?f=h.length:b&&(e=c,j(b));}return this;},remove:function remove(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1){h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--);}}),this;},has:function has(a){return a?n.inArray(a,h)>-1:!(!h||!h.length);},empty:function empty(){return h=[],f=0,this;},disable:function disable(){return h=i=b=void 0,this;},disabled:function disabled(){return!h;},lock:function lock(){return i=void 0,b||k.disable(),this;},locked:function locked(){return!i;},fireWith:function fireWith(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this;},fire:function fire(){return k.fireWith(this,arguments),this;},fired:function fired(){return!!c;}};return k;},n.extend({Deferred:function Deferred(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function state(){return c;},always:function always(){return e.done(arguments).fail(arguments),this;},then:function then(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments);});}),a=null;}).promise();},promise:function promise(a){return null!=a?n.extend(a,d):d;}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h;},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this;},e[f[0]+"With"]=g.fireWith;}),d.promise(e),a&&a.call(e,e),e;},when:function when(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function h(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c);};},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++){c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;}return f||g.resolveWith(k,c),g.promise();}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this;},n.extend({isReady:!1,readyWait:1,holdReady:function holdReady(a){a?n.readyWait++:n.ready(!0);},ready:function ready(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))));}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready();}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b);},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c){n.access(a,b,h,c[h],!0,f,g);}}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function b(a,_b,c){return j.call(n(a),c);})),b))for(;i>h;h++){b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));}return e?a:j?b.call(a):i?b(a[0],c):f;};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType;};function K(){Object.defineProperty(this.cache={},0,{get:function get(){return{};}}),this.expando=n.expando+K.uid++;}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function key(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b);}catch(d){b[this.expando]=c,n.extend(a,b);}}return this.cache[c]||(this.cache[c]={}),c;},set:function set(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b){f[d]=b[d];}return f;},get:function get(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b];},access:function access(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b);},remove:function remove(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--){delete g[d[c]];}}},hasData:function hasData(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{});},discard:function discard(a){a[this.expando]&&delete this.cache[a[this.expando]];}};var L=new K(),M=new K(),N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c;}catch(e){}M.set(a,b,c);}else c=void 0;return c;}n.extend({hasData:function hasData(a){return M.hasData(a)||L.hasData(a);},data:function data(a,b,c){return M.access(a,b,c);},removeData:function removeData(a,b){M.remove(a,b);},_data:function _data(a,b,c){return L.access(a,b,c);},_removeData:function _removeData(a,b){L.remove(a,b);}}),n.fn.extend({data:function data(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--){g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));}L.set(f,"hasDataAttrs",!0);}return e;}return"object"==(typeof a==="undefined"?"undefined":_typeof(a))?this.each(function(){M.set(this,a);}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c;}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b);});},null,b,arguments.length>1,null,!0);},removeData:function removeData(a){return this.each(function(){M.remove(this,a);});}}),n.extend({queue:function queue(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0;},dequeue:function dequeue(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function g(){n.dequeue(a,b);};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire();},_queueHooks:function _queueHooks(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c]);})});}}),n.fn.extend({queue:function queue(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a);});},dequeue:function dequeue(a){return this.each(function(){n.dequeue(this,a);});},clearQueue:function clearQueue(a){return this.queue(a||"fx",[]);},promise:function promise(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function h(){--d||e.resolveWith(f,[f]);};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--){c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));}return h(),e.promise(b);}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function S(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a);},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue;}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0;}function $(){return!1;}function _(){try{return l.activeElement;}catch(a){}}n.event={global:{},add:function add(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return(typeof n==="undefined"?"undefined":_typeof(n))!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0;}),b=(b||"").match(E)||[""],j=b.length;while(j--){h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0);}}},remove:function remove(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--){if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--){k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));}g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o]);}else for(o in i){n.event.remove(a,o+b[j],c,d,!0);}}n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"));}},trigger:function trigger(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==(typeof b==="undefined"?"undefined":_typeof(b))&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode){p.push(g),h=g;}h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a);}f=0;while((g=p[f++])&&!b.isPropagationStopped()){b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());}return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result;}},dispatch:function dispatch(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped()){(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()));}}return k.postDispatch&&k.postDispatch.call(this,a),a.result;}},handlers:function handlers(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this){if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++){f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);}d.length&&g.push({elem:i,handlers:d});}}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function filter(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a;}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function filter(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a;}},fix:function fix(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--){c=d[b],a[c]=f[c];}return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a;},special:{load:{noBubble:!0},focus:{trigger:function trigger(){return this!==_()&&this.focus?(this.focus(),!1):void 0;},delegateType:"focusin"},blur:{trigger:function trigger(){return this===_()&&this.blur?(this.blur(),!1):void 0;},delegateType:"focusout"},click:{trigger:function trigger(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0;},_default:function _default(a){return n.nodeName(a.target,"a");}},beforeunload:{postDispatch:function postDispatch(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result);}}},simulate:function simulate(a,b,c,d){var e=n.extend(new n.Event(),c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault();}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1);},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b);},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function preventDefault(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault();},stopPropagation:function stopPropagation(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation();},stopImmediatePropagation:function stopImmediatePropagation(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation();}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function handle(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c;}};}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function c(a){n.event.simulate(b,a.target,n.event.fix(a),!0);};n.event.special[b]={setup:function setup(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1);},teardown:function teardown(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b));}};}),n.fn.extend({on:function on(a,b,c,d,e){var f,g;if("object"==(typeof a==="undefined"?"undefined":_typeof(a))){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a){this.on(g,b,c,a[g],e);}return this;}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function d(a){return n().off(a),f.apply(this,arguments);},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b);});},one:function one(a,b,c,d){return this.on(a,b,c,d,1);},off:function off(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==(typeof a==="undefined"?"undefined":_typeof(a))){for(e in a){this.off(e,b,a[e]);}return this;}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b);});},trigger:function trigger(a,b){return this.each(function(){n.event.trigger(a,b,this);});},triggerHandler:function triggerHandler(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0;}});var aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ba=/<([\w:]+)/,ca=/<|&#?\w+;/,da=/<(?:script|style|link)/i,ea=/checked\s*(?:[^=]|=\s*.checked.)/i,fa=/^$|\/(?:java|ecma)script/i,ga=/^true\/(.*)/,ha=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ia={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option,ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead,ia.th=ia.td;function ja(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a;}function ka(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a;}function la(a){var b=ga.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a;}function ma(a,b){for(var c=0,d=a.length;d>c;c++){L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"));}}function na(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j){for(c=0,d=j[e].length;d>c;c++){n.event.add(b,e,j[e][c]);}}}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i));}}function oa(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c;}function pa(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue);}n.extend({clone:function clone(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=oa(h),f=oa(a),d=0,e=f.length;e>d;d++){pa(f[d],g[d]);}if(b)if(c)for(f=f||oa(a),g=g||oa(h),d=0,e=f.length;e>d;d++){na(f[d],g[d]);}else na(a,h);return g=oa(h,"script"),g.length>0&&ma(g,!i&&oa(a,"script")),h;},buildFragment:function buildFragment(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++){if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(ca.test(e)){f=f||k.appendChild(b.createElement("div")),g=(ba.exec(e)||["",""])[1].toLowerCase(),h=ia[g]||ia._default,f.innerHTML=h[1]+e.replace(aa,"<$1></$2>")+h[2],j=h[0];while(j--){f=f.lastChild;}n.merge(l,f.childNodes),f=k.firstChild,f.textContent="";}else l.push(b.createTextNode(e));}k.textContent="",m=0;while(e=l[m++]){if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=oa(k.appendChild(e),"script"),i&&ma(f),c)){j=0;while(e=f[j++]){fa.test(e.type||"")&&c.push(e);}}}return k;},cleanData:function cleanData(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events){f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);}L.cache[e]&&delete L.cache[e];}delete M.cache[c[M.expando]];}}}),n.fn.extend({text:function text(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a);});},null,a,arguments.length);},append:function append(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.appendChild(a);}});},prepend:function prepend(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.insertBefore(a,b.firstChild);}});},before:function before(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this);});},after:function after(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling);});},remove:function remove(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++){b||1!==c.nodeType||n.cleanData(oa(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&ma(oa(c,"script")),c.parentNode.removeChild(c));}return this;},empty:function empty(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&(n.cleanData(oa(a,!1)),a.textContent="");}return this;},clone:function clone(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b);});},html:function html(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!da.test(a)&&!ia[(ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(aa,"<$1></$2>");try{for(;d>c;c++){b=this[c]||{},1===b.nodeType&&(n.cleanData(oa(b,!1)),b.innerHTML=a);}b=0;}catch(e){}}b&&this.empty().append(a);},null,a,arguments.length);},replaceWith:function replaceWith(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(oa(this)),a&&a.replaceChild(b,this);}),a&&(a.length||a.nodeType)?this:this.remove();},detach:function detach(a){return this.remove(a,!0);},domManip:function domManip(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&ea.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b);});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(oa(c,"script"),ka),g=f.length;l>j;j++){h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,oa(h,"script"))),b.call(this[j],h,j);}if(g)for(i=f[f.length-1].ownerDocument,n.map(f,la),j=0;g>j;j++){h=f[j],fa.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(ha,"")));}}return this;}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++){c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());}return this.pushStack(d);};});var qa,ra={};function sa(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f;}function ta(a){var b=l,c=ra[a];return c||(c=sa(a,b),"none"!==c&&c||(qa=(qa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qa[0].contentDocument,b.write(),b.close(),c=sa(a,b),qa.detach()),ra[a]=c),c;}var ua=/^margin/,va=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wa=function wa(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null);};function xa(a,b,c){var d,e,f,g,h=a.style;return c=c||wa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),va.test(g)&&ua.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g;}function ya(a,b){return{get:function get(){return a()?void delete this.get:(this.get=b).apply(this,arguments);}};}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){(function(){var g=function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e);};f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);a.getComputedStyle&&n.extend(k,{pixelPosition:function pixelPosition(){return g(),b;},boxSizingReliable:function boxSizingReliable(){return null==c&&g(),c;},reliableMarginRight:function reliableMarginRight(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b;}});})();}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b){g[f]=a.style[f],a.style[f]=b[f];}e=c.apply(a,d||[]);for(f in b){a.style[f]=g[f];}return e;};var za=/^(none|table(?!-c[ea]).+)/,Aa=new RegExp("^("+Q+")(.*)$","i"),Ba=new RegExp("^([+-])=("+Q+")","i"),Ca={position:"absolute",visibility:"hidden",display:"block"},Da={letterSpacing:"0",fontWeight:"400"},Ea=["Webkit","O","Moz","ms"];function Fa(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Ea.length;while(e--){if(b=Ea[e]+c,b in a)return b;}return d;}function Ga(a,b,c){var d=Aa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b;}function Ha(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2){"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));}return g;}function Ia(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wa(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xa(a,b,f),(0>e||null==e)&&(e=a.style[b]),va.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0;}return e+Ha(a,b,c||(g?"border":"content"),d,f)+"px";}function Ja(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++){d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",ta(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));}for(g=0;h>g;g++){d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));}return a;}n.extend({cssHooks:{opacity:{get:function get(a,b){if(b){var c=xa(a,"opacity");return""===c?"1":c;}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function style(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fa(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c==="undefined"?"undefined":_typeof(c),"string"===f&&(e=Ba.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0);}},css:function css(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fa(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xa(a,b,d)),"normal"===e&&b in Da&&(e=Da[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e;}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function get(a,c,d){return c?za.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Ca,function(){return Ia(a,b,d);}):Ia(a,b,d):void 0;},set:function set(a,c,d){var e=d&&wa(a);return Ga(a,c,d?Ha(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0);}};}),n.cssHooks.marginRight=ya(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xa,[a,"marginRight"]):void 0;}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function expand(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++){e[a+R[d]+b]=f[d]||f[d-2]||f[0];}return e;}},ua.test(a)||(n.cssHooks[a+b].set=Ga);}),n.fn.extend({css:function css(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wa(a),e=b.length;e>g;g++){f[b[g]]=n.css(a,b[g],!1,d);}return f;}return void 0!==c?n.style(a,b,c):n.css(a,b);},a,b,arguments.length>1);},show:function show(){return Ja(this,!0);},hide:function hide(){return Ja(this);},toggle:function toggle(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide();});}});function Ka(a,b,c,d,e){return new Ka.prototype.init(a,b,c,d,e);}n.Tween=Ka,Ka.prototype={constructor:Ka,init:function init(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px");},cur:function cur(){var a=Ka.propHooks[this.prop];return a&&a.get?a.get(this):Ka.propHooks._default.get(this);},run:function run(a){var b,c=Ka.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ka.propHooks._default.set(this),this;}},Ka.prototype.init.prototype=Ka.prototype,Ka.propHooks={_default:{get:function get(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop];},set:function set(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now;}}},Ka.propHooks.scrollTop=Ka.propHooks.scrollLeft={set:function set(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now);}},n.easing={linear:function linear(a){return a;},swing:function swing(a){return.5-Math.cos(a*Math.PI)/2;}},n.fx=Ka.prototype.init,n.fx.step={};var La,Ma,Na=/^(?:toggle|show|hide)$/,Oa=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pa=/queueHooks$/,Qa=[Va],Ra={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Oa.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Oa.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do{h=h||".5",g/=h,n.style(c.elem,a,g+f);}while(h!==(h=c.cur()/d)&&1!==h&&--i);}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c;}]};function Sa(){return setTimeout(function(){La=void 0;}),La=n.now();}function Ta(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b){c=R[d],e["margin"+c]=e["padding"+c]=a;}return b&&(e.opacity=e.width=a),e;}function Ua(a,b,c){for(var d,e=(Ra[b]||[]).concat(Ra["*"]),f=0,g=e.length;g>f;f++){if(d=e[f].call(c,b,a))return d;}}function Va(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i();}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire();});})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||ta(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2];}));for(d in b){if(e=b[d],Na.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0;}m[d]=q&&q[d]||n.style(a,d);}else j=void 0;}if(n.isEmptyObject(m))"inline"===("none"===j?ta(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide();}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m){n.style(a,b,m[b]);}});for(d in m){g=Ua(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0));}}}function Wa(a,b){var c,d,e,f,g;for(c in a){if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f){c in a||(a[c]=f[c],b[c]=e);}}else b[d]=e;}}function Xa(a,b,c){var d,e,f=0,g=Qa.length,h=n.Deferred().always(function(){delete i.elem;}),i=function i(){if(e)return!1;for(var b=La||Sa(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++){j.tweens[g].run(f);}return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1);},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:La||Sa(),duration:c.duration,tweens:[],createTween:function createTween(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d;},stop:function stop(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++){j.tweens[c].run(1);}return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this;}}),k=j.props;for(Wa(k,j.opts.specialEasing);g>f;f++){if(d=Qa[f].call(j,a,k,j.opts))return d;}return n.map(k,Ua,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always);}n.Animation=n.extend(Xa,{tweener:function tweener(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++){c=a[d],Ra[c]=Ra[c]||[],Ra[c].unshift(b);}},prefilter:function prefilter(a,b){b?Qa.unshift(a):Qa.push(a);}}),n.speed=function(a,b,c){var d=a&&"object"==(typeof a==="undefined"?"undefined":_typeof(a))?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue);},d;},n.fn.extend({fadeTo:function fadeTo(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d);},animate:function animate(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function g(){var b=Xa(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0);};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g);},stop:function stop(a,b,c){var d=function d(a){var b=a.stop;delete a.stop,b(c);};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g){g[e]&&g[e].stop&&Pa.test(e)&&d(g[e]);}for(e=f.length;e--;){f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));}(b||!c)&&n.dequeue(this,a);});},finish:function finish(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;){f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));}for(b=0;g>b;b++){d[b]&&d[b].finish&&d[b].finish.call(this);}delete c.finish;});}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Ta(b,!0),a,d,e);};}),n.each({slideDown:Ta("show"),slideUp:Ta("hide"),slideToggle:Ta("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d);};}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(La=n.now();b<c.length;b++){a=c[b],a()||c[b]!==a||c.splice(b--,1);}c.length||n.fx.stop(),La=void 0;},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop();},n.fx.interval=13,n.fx.start=function(){Ma||(Ma=setInterval(n.fx.tick,n.fx.interval));},n.fx.stop=function(){clearInterval(Ma),Ma=null;},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d);};});},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value;}();var Ya,Za,$a=n.expr.attrHandle;n.fn.extend({attr:function attr(a,b){return J(this,n.attr,a,b,arguments.length>1);},removeAttr:function removeAttr(a){return this.each(function(){n.removeAttr(this,a);});}}),n.extend({attr:function attr(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return _typeof(a.getAttribute)===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Za:Ya)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b));},removeAttr:function removeAttr(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++]){d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c);}},attrHooks:{type:{set:function set(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b;}}}}}),Za={set:function set(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c;}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$a[b]||n.find.attr;$a[b]=function(a,b,d){var e,f;return d||(f=$a[b],$a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$a[b]=f),e;};});var _a=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function prop(a,b){return J(this,n.prop,a,b,arguments.length>1);},removeProp:function removeProp(a){return this.each(function(){delete this[n.propFix[a]||a];});}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function prop(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b];},propHooks:{tabIndex:{get:function get(a){return a.hasAttribute("tabindex")||_a.test(a.nodeName)||a.href?a.tabIndex:-1;}}}}),k.optSelected||(n.propHooks.selected={get:function get(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null;}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this;});var ab=/[\t\r\n\f]/g;n.fn.extend({addClass:function addClass(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className));});if(h)for(b=(a||"").match(E)||[];j>i;i++){if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):" ")){f=0;while(e=b[f++]){d.indexOf(" "+e+" ")<0&&(d+=e+" ");}g=n.trim(d),c.className!==g&&(c.className=g);}}return this;},removeClass:function removeClass(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className));});if(h)for(b=(a||"").match(E)||[];j>i;i++){if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):"")){f=0;while(e=b[f++]){while(d.indexOf(" "+e+" ")>=0){d=d.replace(" "+e+" "," ");}}g=a?n.trim(d):"",c.className!==g&&(c.className=g);}}return this;},toggleClass:function toggleClass(a,b){var c=typeof a==="undefined"?"undefined":_typeof(a);return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b);}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++]){e.hasClass(b)?e.removeClass(b):e.addClass(b);}}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"");});},hasClass:function hasClass(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++){if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ab," ").indexOf(b)>=0)return!0;}return!1;}});var bb=/\r/g;n.fn.extend({val:function val(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+"";})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e));});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bb,""):null==c?"":c);}}}),n.extend({valHooks:{option:{get:function get(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a));}},select:{get:function get(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++){if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b);}}return g;},set:function set(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--){d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);}return c||(a.selectedIndex=-1),f;}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function set(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0;}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value;});}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b);};}),n.fn.extend({hover:function hover(a,b){return this.mouseenter(a).mouseleave(b||a);},bind:function bind(a,b,c){return this.on(a,null,b,c);},unbind:function unbind(a,b){return this.off(a,null,b);},delegate:function delegate(a,b,c,d){return this.on(b,a,c,d);},undelegate:function undelegate(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c);}});var cb=n.now(),db=/\?/;n.parseJSON=function(a){return JSON.parse(a+"");},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser(),b=c.parseFromString(a,"text/xml");}catch(d){b=void 0;}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b;};var eb=/#.*$/,fb=/([?&])_=[^&]*/,gb=/^(.*?):[ \t]*([^\r\n]*)$/gm,hb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ib=/^(?:GET|HEAD)$/,jb=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lb={},mb={},nb="*/".concat("*"),ob=a.location.href,pb=kb.exec(ob.toLowerCase())||[];function qb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++]){"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c);}};}function rb(a,b,c,d){var e={},f=a===mb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1);}),i;}return g(b.dataTypes[0])||!e["*"]&&g("*");}function sb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b){void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);}return d&&n.extend(!0,a,d),a;}function tb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0]){i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));}if(d)for(e in h){if(h[e]&&h[e].test(d)){i.unshift(e);break;}}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break;}g||(g=e);}f=f||g;}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0;}function ub(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters){j[g.toLowerCase()]=a.converters[g];}f=k.shift();while(f){if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j){if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break;}}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b);}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f};}}}return{state:"success",data:b};}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ob,type:"GET",isLocal:hb.test(pb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function ajaxSetup(a,b){return b?sb(sb(a,n.ajaxSettings),b):sb(n.ajaxSettings,a);},ajaxPrefilter:qb(lb),ajaxTransport:qb(mb),ajax:function ajax(a,b){"object"==(typeof a==="undefined"?"undefined":_typeof(a))&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function getResponseHeader(a){var b;if(2===t){if(!f){f={};while(b=gb.exec(e)){f[b[1].toLowerCase()]=b[2];}}b=f[a.toLowerCase()];}return null==b?null:b;},getAllResponseHeaders:function getAllResponseHeaders(){return 2===t?e:null;},setRequestHeader:function setRequestHeader(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this;},overrideMimeType:function overrideMimeType(a){return t||(k.mimeType=a),this;},statusCode:function statusCode(a){var b;if(a)if(2>t)for(b in a){q[b]=[q[b],a[b]];}else v.always(a[v.status]);return this;},abort:function abort(a){var b=a||u;return c&&c.abort(b),x(0,b),this;}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||ob)+"").replace(eb,"").replace(jb,pb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kb.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pb[1]&&h[2]===pb[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pb[3]||("http:"===pb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rb(lb,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ib.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(db.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fb.test(d)?d.replace(fb,"$1_="+cb++):d+(db.test(d)?"&":"?")+"_="+cb++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nb+"; q=0.01":""):k.accepts["*"]);for(j in k.headers){v.setRequestHeader(j,k.headers[j]);}if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1}){v[j](k[j]);}if(c=rb(mb,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout");},k.timeout));try{t=1,c.send(r,x);}catch(w){if(!(2>t))throw w;x(-1,w);}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tb(k,v,f)),u=ub(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")));}return v;},getJSON:function getJSON(a,b,c){return n.get(a,b,c,"json");},getScript:function getScript(a,b){return n.get(a,void 0,b,"script");}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d});};}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0});},n.fn.extend({wrapAll:function wrapAll(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b));}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild){a=a.firstElementChild;}return a;}).append(this)),this);},wrapInner:function wrapInner(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b));}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a);});},wrap:function wrap(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a);});},unwrap:function unwrap(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes);}).end();}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0;},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a);};var vb=/%20/g,wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==(typeof e==="undefined"?"undefined":_typeof(e))?b:"")+"]",e,c,d);});else if(c||"object"!==n.type(b))d(a,b);else for(e in b){Ab(a+"["+e+"]",b[e],c,d);}}n.param=function(a,b){var c,d=[],e=function e(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b);};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value);});else for(c in a){Ab(c,a[c],b,e);}return d.join("&").replace(vb,"+");},n.fn.extend({serialize:function serialize(){return n.param(this.serializeArray());},serializeArray:function serializeArray(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this;}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!T.test(a));}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")};}):{name:b.name,value:c.replace(xb,"\r\n")};}).get();}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest();}catch(a){}};var Bb=0,Cb={},Db={0:200,1223:204},Eb=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cb){Cb[a]();}}),k.cors=!!Eb&&"withCredentials"in Eb,k.ajax=Eb=!!Eb,n.ajaxTransport(function(a){var _b2;return k.cors||Eb&&!a.crossDomain?{send:function send(c,d){var e,f=a.xhr(),g=++Bb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields){f[e]=a.xhrFields[e];}a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c){f.setRequestHeader(e,c[e]);}_b2=function b(a){return function(){_b2&&(delete Cb[g],_b2=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Db[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()));};},f.onload=_b2(),f.onerror=_b2("error"),_b2=Cb[g]=_b2("abort");try{f.send(a.hasContent&&a.data||null);}catch(h){if(_b2)throw h;}},abort:function abort(){_b2&&_b2();}}:void 0;}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function textScript(a){return n.globalEval(a),a;}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET");}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,_c;return{send:function send(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",_c=function c(a){b.remove(),_c=null,a&&e("error"===a.type?404:200,a.type);}),l.head.appendChild(b[0]);},abort:function abort(){_c&&_c();}};}});var Fb=[],Gb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function jsonpCallback(){var a=Fb.pop()||n.expando+"_"+cb++;return this[a]=!0,a;}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gb,"$1"+e):b.jsonp!==!1&&(b.url+=(db.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0];},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments;},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0;}),"script"):void 0;}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes));};var Hb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hb)return Hb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==(typeof b==="undefined"?"undefined":_typeof(b))&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a);}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a]);}),this;},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a);};}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem;}).length;};var Ib=a.document.documentElement;function Jb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView;}n.offset={setOffset:function setOffset(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m);}},n.fn.extend({offset:function offset(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b);});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(_typeof(d.getBoundingClientRect)!==U&&(e=d.getBoundingClientRect()),c=Jb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e;},position:function position(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)};}},offsetParent:function offsetParent(){return this.map(function(){var a=this.offsetParent||Ib;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position")){a=a.offsetParent;}return a||Ib;});}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jb(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f);},b,e,arguments.length,null);};}),n.each(["top","left"],function(a,b){n.cssHooks[b]=ya(k.pixelPosition,function(a,c){return c?(c=xa(a,b),va.test(c)?n(a).position()[b]+"px":c):void 0;});}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g);},b,f?d:void 0,f,null);};});}),n.fn.size=function(){return this.length;},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n;});var Kb=a.jQuery,Lb=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lb),b&&a.jQuery===n&&(a.jQuery=Kb),n;},(typeof b==="undefined"?"undefined":_typeof(b))===U&&(a.jQuery=a.$=n),n;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(){function t(){}
function e(t){var e=U.call(arguments,1);return function(){return t.apply(this,e);};}
function n(t,e){if(!e)throw new Error("prayer failed: "+t);}
function i(t){n("a direction was passed",t===G||t===X);}
function r(e,n,i,r){function s(){u=a;var t=c.selection?"$"+c.selection.latex()+"$":"";d.select(t);}
function o(){h.detach(),l.focused=!1;}
var c,h,l,u,p,f,d,m=e.contents().detach();return i||e.addClass("mathquill-rendered-math"),n.jQ=e.attr(F,n.id),n.revert=function(){e.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(m);},c=n.cursor=I(n),n.renderLatex(m.text()),h=n.textarea=Z('<span class="textarea"><textarea></textarea></span>'),l=h.children(),n.selectionChanged=function(){u===a&&(u=setTimeout(s)),ue(e[0]);},e.bind("selectstart.mathquill",function(t){t.target!==l[0]&&t.preventDefault(),t.stopPropagation();}),f=c.blink,e.bind("mousedown.mathquill",function(n){function i(t){return c.seek(Z(t.target),t.pageX,t.pageY),(c[G]!==p[G]||c.parent!==p.parent)&&c.selectFrom(p),!1;}
function s(t){return delete t.target,i(t);}
function o(t){p=a,c.blink=f,c.selection||(r?c.show():h.detach()),e.unbind("mousemove",i),Z(t.target.ownerDocument).unbind("mousemove",s).unbind("mouseup",o);}
return setTimeout(function(){l.focus(),l.focused=!0;}),c.blink=t,c.seek(Z(n.target),n.pageX,n.pageY),p=Y(c.parent,c[G],c[X]),r||l.focused||e.prepend(h),e.mousemove(i),Z(n.target.ownerDocument).mousemove(s).mouseup(o),!1;}),r?(d=K(l,{container:e,key:function key(t,e){c.parent.bubble("onKey",t,e);},text:function text(t){c.parent.bubble("onText",t);},cut:function cut(t){c.selection&&setTimeout(function(){c.prepareEdit(),c.parent.bubble("redraw");}),t.stopPropagation();},paste:function paste(t){t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}",c.writeLatex(t).show();}}),e.prepend(h),e.addClass("mathquill-editable"),i&&e.addClass("mathquill-textbox"),l.focus(function(t){c.parent||c.insAtRightEnd(n),c.parent.jQ.addClass("hasCursor"),c.selection?(c.selection.jQ.removeClass("blur"),setTimeout(n.selectionChanged)):c.show(),t.stopPropagation();}).blur(function(t){c.hide().parent.blur(),c.selection&&c.selection.jQ.addClass("blur"),t.stopPropagation();}),void e.bind("focus.mathquill blur.mathquill",function(t){l.trigger(t);}).blur()):(d=K(l,{container:e}),e.bind("cut paste",!1).bind("copy",s).prepend('<span class="selectable">$'+n.latex()+"$</span>"),void l.blur(function(){c.clearSelection(),setTimeout(o);}));}function s(t,e,n){return H(q,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"});}var a,o,c,h,l,u,p,f,d,m,g,b,v,w,x,j,k,q,y,Q,C,S,L,D,O,E,A,R,T,z,$,B,I,_,W=window.jQuery,M="mathquill-command-id",F="mathquill-block-id",P=Math.min,U=(Math.max,[].slice),H=function(t,e,n){function i(t){return"object"==(typeof t==="undefined"?"undefined":_typeof(t));}function r(t){return"function"==typeof t;}function s(){}return function a(o,c){function h(){var t=new l();return r(t.init)&&t.init.apply(t,arguments),t;}function l(){}var u,p,f;return c===n&&(c=o,o=Object),h.Bare=l,u=s[t]=o[t],p=l[t]=h[t]=h.p=new s(),p.constructor=h,h.mixin=function(e){return l[t]=h[t]=a(h,e)[t],h;},(h.open=function(t){if(f={},r(t)?f=t.call(h,p,u,h,o):i(t)&&(f=t),i(f))for(var n in f){e.call(f,n)&&(p[n]=f[n]);}return r(p.init)||(p.init=o),h;})(c);};}("prototype",{}.hasOwnProperty),K=function(){function e(t){var e,i=t.which||t.keyCode,r=n[i],s=[];return t.ctrlKey&&s.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&s.push("Meta"),t.altKey&&s.push("Alt"),t.shiftKey&&s.push("Shift"),e=r||String.fromCharCode(i),s.length||r?(s.push(e),s.join("-")):e;}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function r(t){j=t,clearTimeout(k),k=setTimeout(t);}function s(e){j(),j=t,clearTimeout(k),w.val(e),e&&w[0].select();}function a(){var t=w[0];return"selectionStart"in t?t.selectionStart!==t.selectionEnd:!1;}function o(t){var e=w.val();w.val(""),e&&t(e);}function c(){g(e(q),q);}function h(t){q=t,y=null,c();}function l(t){q&&y&&c(),y=t,r(u);}function u(){a()||o(m);}function p(){q=y=null;}function f(){w.focus(),r(d);}function d(){o(b);}var m,g,b,v,w,x,j,k,q=null,y=null;return i||(i={}),m=i.text||t,g=i.key||t,b=i.paste||t,v=i.cut||t,w=W(n),x=W(i.container||w),j=t,x.bind("keydown keypress input keyup focusout paste",function(){j();}),x.bind({keydown:h,keypress:l,focusout:p,cut:v,paste:f}),{select:s};};}(),N=H(function(t,e,i){function r(t,e){throw t=t?"'"+t+"'":"EOF","Parse Error: "+e+" at "+t;}var s,a,o,c,h,l,u,p,f,d,m,g,b;t.init=function(t){this._=t;},t.parse=function(t){function e(t,e){return e;}return this.skip(b)._(t,e,r);},t.or=function(t){n("or is passed a parser",t instanceof i);var e=this;return i(function(n,i,r){function s(){return t._(n,i,r);}return e._(n,i,s);});},t.then=function(t){var e=this;return i(function(r,s,a){function o(e,r){var o=t instanceof i?t:t(r);return n("a parser is returned",o instanceof i),o._(e,s,a);}return e._(r,o,a);});},t.many=function(){var t=this;return i(function(e,n){function i(t,n){return e=t,s.push(n),!0;}function r(){return!1;}for(var s=[];t._(e,i,r);){}return n(e,s);});},t.times=function(t,e){arguments.length<2&&(e=t);var n=this;return i(function(i,r,s){function a(t,e){return u.push(e),i=t,!0;}function o(t,e){return h=e,i=t,!1;}function c(){return!1;}var h,l,u=[],p=!0;for(l=0;t>l;l+=1){if(p=n._(i,a,o),!p)return s(i,h);}for(;e>l&&p;l+=1){p=n._(i,a,c);}return r(i,u);});},t.result=function(t){return this.then(o(t));},t.atMost=function(t){return this.times(0,t);},t.atLeast=function(t){var e=this;return e.times(t).then(function(t){return e.many().map(function(e){return t.concat(e);});});},t.map=function(t){return this.then(function(e){return o(t(e));});},t.skip=function(t){return this.then(function(e){return t.result(e);});},s=this.string=function(t){var e=t.length,n="expected '"+t+"'";return i(function(i,r,s){var a=i.slice(0,e);return a===t?r(i.slice(e),a):s(i,n);});},a=this.regex=function(t){n("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return i(function(n,i,r){var s,a=t.exec(n);return a?(s=a[0],i(n.slice(s.length),s)):r(n,e);});},o=i.succeed=function(t){return i(function(e,n){return n(e,t);});},c=i.fail=function(t){return i(function(e,n,i){return i(e,t);});},h=i.letter=a(/^[a-z]/i),l=i.letters=a(/^[a-z]*/i),u=i.digit=a(/^[0-9]/),p=i.digits=a(/^[0-9]*/),f=i.whitespace=a(/^\s+/),d=i.optWhitespace=a(/^\s*/),m=i.any=i(function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character");}),g=i.all=i(function(t,e){return e("",t);}),b=i.eof=i(function(t,e,n){return t?n(t,"expected EOF"):e(t,t);});}),G=-1,X=1,Z=H(W,function(t){t.insDirOf=function(t,e){return t===G?this.insertBefore(e.first()):this.insertAfter(e.last());},t.insAtDirEnd=function(t,e){return t===G?this.prependTo(e):this.appendTo(e);};}),Y=H(function(t){t.parent=0,t[G]=0,t[X]=0,t.init=function(t,e,n){this.parent=t,this[G]=e,this[X]=n;};}),J=H(function(t){t[G]=0,t[X]=0,t.parent=0,t.init=function(){this.ends={},this.ends[G]=0,this.ends[X]=0;},t.children=function(){return V(this.ends[G],this.ends[X]);},t.eachChild=function(t){return this.children().each(t);},t.foldChildren=function(t,e){return this.children().fold(t,e);},t.adopt=function(t,e,n){return V(this,this).adopt(t,e,n),this;},t.disown=function(){return V(this,this).disown(),this;};}),V=H(function(t){function e(t,e,i){n("a parent is always present",t),n("leftward is properly set up",function(){return e?e[X]===i&&e.parent===t:t.ends[G]===i;}()),n("rightward is properly set up",function(){return i?i[G]===e&&i.parent===t:t.ends[X]===e;}());}t.init=function(t,e){n("no half-empty fragments",!t==!e),this.ends={},t&&(n("left end node is passed to Fragment",t instanceof J),n("right end node is passed to Fragment",e instanceof J),n("leftEnd and rightEnd have the same parent",t.parent===e.parent),this.ends[G]=t,this.ends[X]=e);},t.adopt=function(t,n,i){var r,s,a;return e(t,n,i),r=this,r.disowned=!1,(s=r.ends[G])?(a=r.ends[X],n||(t.ends[G]=s),i?i[G]=a:t.ends[X]=a,r.ends[X][X]=i,r.each(function(e){e[G]=n,e.parent=t,n&&(n[X]=e),n=e;}),r):this;},t.disown=function(){var t,n,i=this,r=i.ends[G];return!r||i.disowned?i:(i.disowned=!0,t=i.ends[X],n=r.parent,e(n,r[G],r),e(n,t,t[X]),r[G]?r[G][X]=t[X]:n.ends[G]=t[X],t[X]?t[X][G]=r[G]:n.ends[X]=r[G],i);},t.each=function(t){var e=this,n=e.ends[G];if(!n)return e;for(;n!==e.ends[X][X]&&t.call(e,n)!==!1;n=n[X]){}return e;},t.fold=function(t,e){return this.each(function(n){t=e.call(this,t,n);}),t;};}),te=function(){var t=0;return function(){return t+=1;};}(),ee=H(J,function(t,e){t.init=function(){e.init.call(this),this.id=te(),ee[this.id]=this;},t.toString=function(){return"[MathElement "+this.id+"]";},t.bubble=function(t){var e,n,i=U.call(arguments,1);for(e=this;e&&(n=e[t]&&e[t].apply(e,i),n!==!1);e=e.parent){}return this;},t.postOrder=function(t){var e,n=U.call(arguments,1);"string"==typeof t&&(e=t,t=function t(_t){e in _t&&_t[e].apply(_t,n);}),function i(e){e.eachChild(i),t(e);}(this);},t.jQ=Z(),t.jQadd=function(t){this.jQ=this.jQ.add(t);},this.jQize=function(t){var e=Z(t);return e.find("*").andSelf().each(function(){var t=Z(this),e=t.attr("mathquill-command-id"),n=t.attr("mathquill-block-id");e&&ee[e].jQadd(t),n&&ee[n].jQadd(t);}),e;},t.finalizeInsert=function(){var t=this;t.postOrder("finalizeTree"),t.postOrder("blur"),t.postOrder("respace"),t[X].respace&&t[X].respace(),t[G].respace&&t[G].respace(),t.postOrder("redraw"),t.bubble("redraw");};}),ne=H(ee,function(e,i){e.init=function(t,e,n){var r=this;i.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),e&&(r.htmlTemplate=e),n&&(r.textTemplate=n);},e.replaces=function(t){t.disown(),this.replacedFragment=t;},e.isEmpty=function(){return this.foldChildren(!0,function(t,e){return t&&e.isEmpty();});},e.parser=function(){var t=B.block,e=this;return t.times(e.numBlocks()).map(function(t){e.blocks=t;for(var n=0;n<t.length;n+=1){t[n].adopt(e,e.ends[X],0);}return e;});},e.createLeftOf=function(t){var e=this,n=e.replacedFragment;e.createBlocks(),ee.jQize(e.html()),n&&(n.adopt(e.ends[G],0,0),n.jQ.appendTo(e.ends[G].jQ)),t.jQ.before(e.jQ),t[G]=e.adopt(t.parent,t[G],t[X]),e.finalizeInsert(t),e.placeCursor(t);},e.createBlocks=function(){var t,e,n=this,i=n.numBlocks(),r=n.blocks=Array(i);for(t=0;i>t;t+=1){e=r[t]=re(),e.adopt(n,n.ends[X],0);}},e.respace=t,e.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[G],function(t,e){return t.isEmpty()?t:e;}));},e.remove=function(){return this.disown(),this.jQ.remove(),this.postOrder(function(t){delete ee[t.id];}),this;},e.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0;},e.html=function(){var t,e,i,r=this,s=r.blocks,a=" mathquill-command-id="+r.id,o=r.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);for(n("no unmatched angle brackets",o.join("")===this.htmlTemplate),t=0,e=o[0];e;t+=1,e=o[t]){if("/>"===e.slice(-2))o[t]=e.slice(0,-2)+a+"/>";else if("<"===e.charAt(0)){n("not an unmatched top-level close tag","/"!==e.charAt(1)),o[t]=e.slice(0,-1)+a+">",i=1;do{t+=1,e=o[t],n("no missing close tags",e),"</"===e.slice(0,2)?i-=1:"<"===e.charAt(0)&&"/>"!==e.slice(-2)&&(i+=1);}while(i>0);}}return o.join("").replace(/>&(\d+)/g,function(t,e){return" mathquill-block-id="+s[e].id+">"+s[e].join("html");});},e.latex=function(){return this.foldChildren(this.ctrlSeq,function(t,e){return t+"{"+(e.latex()||" ")+"}";});},e.textTemplate=[""],e.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],function(n,i){e+=1;var r=i.text();return n&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?n+r.slice(1,-1)+t.textTemplate[e]:n+i.text()+(t.textTemplate[e]||"");});};}),ie=H(ne,function(e,n){e.init=function(t,e,i){i||(i=t&&t.length>1?t.slice(1):t),n.init.call(this,t,e,[i]);},e.parser=function(){return N.succeed(this);},e.numBlocks=function(){return 0;},e.replaces=function(t){t.remove();},e.createBlocks=t,e.latex=function(){return this.ctrlSeq;},e.text=function(){return this.textTemplate;},e.placeCursor=t,e.isEmpty=function(){return!0;};}),re=H(ee,function(t){t.join=function(t){return this.foldChildren("",function(e,n){return e+n[t]();});},t.latex=function(){return this.join("latex");},t.text=function(){return this.ends[G]===this.ends[X]?this.ends[G].text():"("+this.join("text")+")";},t.isEmpty=function(){return 0===this.ends[G]&&0===this.ends[X];},t.write=function(t,e,n){var i;i=e.match(/^[a-eg-zA-Z]$/)?D(e):(i=he[e]||le[e])?i(e):O(e),n&&i.replaces(n),i.createLeftOf(t);},t.focus=function(){return this.jQ.addClass("hasCursor"),this.jQ.removeClass("empty"),this;},t.blur=function(){return this.jQ.removeClass("hasCursor"),this.isEmpty()&&this.jQ.addClass("empty"),this;};}),se=H(V,function(t,e){t.init=function(t,n){e.init.call(this,t,n||t),this.jQ=this.fold(Z(),function(t,e){return e.jQ.add(t);});},t.latex=function(){return this.fold("",function(t,e){return t+e.latex();});},t.remove=function(){return this.jQ.remove(),this.each(function(t){t.postOrder(function(t){delete ee[t.id];});}),this.disown();};}),ae=H(re,function(t,e){t.latex=function(){return e.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/gi,"$1");},t.text=function(){return this.foldChildren("",function(t,e){return t+e.text();});},t.renderLatex=function(t){var e=this.jQ;e.children().slice(1).remove(),this.ends[G]=this.ends[X]=0,delete this.cursor.selection,this.cursor.insAtRightEnd(this).writeLatex(t);},t.onKey=function(t,e){var n;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":for(;this.cursor[G]||this.cursor.selection;){this.cursor.backspace();}break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":if(n=this.cursor.parent,n===this.cursor.root)return void("Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[X]?this.cursor.insAtLeftEnd(n[X]):this.cursor.insRightOf(n.parent);break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":if(n=this.cursor.parent,n===this.cursor.root)return void("Shift-Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[G]?this.cursor.insAtRightEnd(n[G]):this.cursor.insLeftOf(n.parent);break;case"Enter":break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":for(;this.cursor[X];){this.cursor.selectRight();}break;case"Ctrl-Shift-End":for(;this.cursor[X]||this.cursor.parent!==this;){this.cursor.selectRight();}break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":for(;this.cursor[G];){this.cursor.selectLeft();}break;case"Ctrl-Shift-Home":for(;this.cursor[G]||this.cursor.parent!==this;){this.cursor.selectLeft();}break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[G])for(;this.cursor[G];){this.cursor.selectLeft();}else this.cursor.selectLeft();case"Shift-Down":if(this.cursor[X])for(;this.cursor[X];){this.cursor.selectRight();}else this.cursor.selectRight();case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":for(;this.cursor[X]||this.cursor.selection;){this.cursor.deleteForward();}break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root)return;for(this.cursor.prepareMove().insAtRightEnd(this);this.cursor[G];){this.cursor.selectLeft();}break;default:return!1;}return e.preventDefault(),!1;},t.onText=function(t){return this.cursor.write(t),!1;};}),oe=H(ne,function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t;},t.htmlTemplate='<span class="mathquill-rendered-math">&0</span>',t.createBlocks=function(){this.ends[G]=this.ends[X]=ae(),this.blocks=[this.ends[G]],this.ends[G].parent=this,this.ends[G].cursor=this.cursor,this.ends[G].write=function(t,e,n){"$"!==e?re.prototype.write.call(this,t,e,n):this.isEmpty()?(t.insRightOf(this.parent).backspace().show(),O("\\$","$").createLeftOf(t)):t[X]?t[G]?re.prototype.write.call(this,t,e,n):t.insLeftOf(this.parent):t.insRightOf(this.parent);};},t.latex=function(){return"$"+this.ends[G].latex()+"$";};}),ce=H(re,function(t){t.renderLatex=function(t){var e,n,i,r,s,a,o,c,h,l,u,p=this,f=p.cursor;if(p.jQ.children().slice(1).remove(),p.ends[G]=p.ends[X]=0,delete f.selection,f.show().insAtRightEnd(p),e=N.regex,n=N.string,i=N.eof,r=N.all,s=n("$").then(B).skip(n("$").or(i)).map(function(t){var e,n=oe(f);return n.createBlocks(),e=n.ends[G],t.children().adopt(e,0,0),n;}),a=n("\\$").result("$"),o=a.or(e(/^[^$]/)).map(O),c=s.or(o).many(),h=c.skip(i).or(r.result(!1)).parse(t)){for(l=0;l<h.length;l+=1){h[l].adopt(p,p.ends[X],0);}u=p.join("html"),ee.jQize(u).appendTo(p.jQ),this.finalizeInsert();}},t.onKey=function(t){"Spacebar"!==t&&"Shift-Spacebar"!==t&&ae.prototype.onKey.apply(this,arguments);},t.onText=ae.prototype.onText,t.write=function(t,e,n){if(n&&n.remove(),"$"===e)oe(t).createLeftOf(t);else{var i;"<"===e?i="&lt;":">"===e&&(i="&gt;"),O(e,i).createLeftOf(t);}};}),he={},le={},ue=t,pe=document.createElement("div"),fe=pe.style,de={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1};for(h in de){if(h in fe){c=h;break;}}c?o=function o(t,e,n){t.css(c,"scale("+e+","+n+")");}:"filter"in fe?(ue=function ue(t){t.className=t.className;},o=function o(t,e,n){function i(){t.css("marginRight",(r.width()-1)*(e-1)/e+"px");}var r,s;e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("matrixed-container")||t.addClass("matrixed-container").wrapInner('<span class="matrixed"></span>'),r=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"),i(),s=setInterval(i),Z(window).load(function(){clearTimeout(s),i();});}):o=function o(t,e,n){t.css("fontSize",n+"em");},l=H(ne,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">");};}),le.mathrm=e(l,"\\mathrm","span",'class="roman font"'),le.mathit=e(l,"\\mathit","i",'class="font"'),le.mathbf=e(l,"\\mathbf","b",'class="font"'),le.mathsf=e(l,"\\mathsf","span",'class="sans-serif font"'),le.mathtt=e(l,"\\mathtt","span",'class="monospace font"'),le.underline=e(l,"\\underline","span",'class="non-leaf underline"'),le.overline=le.bar=e(l,"\\overline","span",'class="non-leaf overline"'),u=H(ne,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+' class="non-leaf">&0</'+n+">",[i]);},t.finalizeTree=function(){function t(t){var e=this.parent,n=t;do{if(n[X])return t.insLeftOf(e),!1;n=n.parent.parent;}while(n!==e);return t.insRightOf(e),!1;}n("SupSub is only _ and ^","^"===this.ctrlSeq||"_"===this.ctrlSeq),"_"===this.ctrlSeq?(this.down=this.ends[G],this.ends[G].up=t):(this.up=this.ends[G],this.ends[G].down=t);},t.latex=function(){var t=this.ends[G].latex();return 1===t.length?this.ctrlSeq+t:this.ctrlSeq+"{"+(t||" ")+"}";},t.redraw=function(){this[G]&&this[G].respace(),this[G]instanceof u||(this.respace(),!this[X]||this[X]instanceof u||this[X].respace());},t.respace=function(){if("\\int "===this[G].ctrlSeq||this[G]instanceof u&&this[G].ctrlSeq!=this.ctrlSeq&&this[G][G]&&"\\int "===this[G][G].ctrlSeq?this.limit||(this.limit=!0,this.jQ.addClass("limit")):this.limit&&(this.limit=!1,this.jQ.removeClass("limit")),this.respaced=this[G]instanceof u&&this[G].ctrlSeq!=this.ctrlSeq&&!this[G].respaced,this.respaced){var t=+this.jQ.css("fontSize").slice(0,-2),e=this[G].jQ.outerWidth(),n=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&"_"===this.ctrlSeq?-.25:0)-e/t+"em",marginRight:.1-P(n,e)/t+"em"});}else this.jQ.css(this.limit&&"_"===this.ctrlSeq?{left:"-.25em",marginRight:""}:{left:"",marginRight:""});return this[X]instanceof u&&this[X].respace(),this;};}),le.subscript=le._=e(u,"_","sub","_"),le.superscript=le.supscript=le["^"]=e(u,"^","sup","**"),p=le.frac=le.dfrac=le.cfrac=le.fraction=H(ne,function(t){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>',t.textTemplate=["(","/",")"],t.finalizeTree=function(){this.up=this.ends[X].up=this.ends[G],this.down=this.ends[G].down=this.ends[X];};}),f=le.over=he["/"]=H(p,function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var n=t[G];n&&!(n instanceof R||n instanceof q||n instanceof z||/^[,;:]$/.test(n.ctrlSeq));){n=n[G];}n instanceof z&&n[X]instanceof u&&(n=n[X],n[X]instanceof u&&n[X].ctrlSeq!=n.ctrlSeq&&(n=n[X])),n!==t[G]&&(this.replaces(se(n[X]||t.parent.ends[G],t[G])),t[G]=n);}e.createLeftOf.call(this,t);};}),d=le.sqrt=le[""]=H(ne,function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return B.optBlock.then(function(t){return B.block.map(function(e){var n=g();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n;});}).or(e.parser.call(this));},t.redraw=function(){var t=this.ends[X].jQ;o(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1);};}),m=le.vec=H(ne,function(t){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;</span><span class="vector-stem">&0</span></span>',t.textTemplate=["vec(",")"];}),g=le.nthroot=H(d,function(t){t.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[G].latex()+"]{"+this.ends[X].latex()+"}";};}),b=H(ne,function(t,e){t.init=function(t,n,i,r){e.init.call(this,"\\left"+i,'<span class="non-leaf"><span class="scaled paren">'+t+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+n+"</span></span>",[t,n]),this.end="\\right"+r;},t.jQadd=function(){e.jQadd.apply(this,arguments);var t=this.jQ;this.bracketjQs=t.children(":first").add(t.children(":last"));},t.latex=function(){return this.ctrlSeq+this.ends[G].latex()+this.end;},t.redraw=function(){var t=this.ends[G].jQ,e=t.outerHeight()/+t.css("fontSize").slice(0,-2);o(this.bracketjQs,P(1+.2*(e-1),1.2),1.05*e);};}),le.left=H(ne,function(t){t.parser=function(){var t=N.regex,e=N.string,n=N.succeed,i=N.optWhitespace;return i.then(t(/^(?:[([|]|\\\{)/)).then(function(r){"\\"===r.charAt(0)&&(r=r.slice(1));var s=he[r]();return B.map(function(t){s.blocks=[t],t.adopt(s,0,0);}).then(e("\\right")).skip(i).then(t(/^(?:[\])|]|\\\})/)).then(function(t){return t.slice(-1)!==s.end.slice(-1)?N.fail("open doesn't match close"):n(s);});});};}),le.right=H(ne,function(t){t.parser=function(){return N.fail("unmatched \\right");};}),le.lbrace=he["{"]=e(b,"{","}","\\{","\\}"),le.langle=le.lang=e(b,"&lang;","&rang;","\\langle ","\\rangle "),v=H(b,function(t,e){t.createLeftOf=function(t){t[X]||!t.parent.parent||t.parent.parent.end!==this.end||this.replacedFragment?e.createLeftOf.call(this,t):t.insRightOf(t.parent.parent);},t.placeCursor=function(t){this.ends[G].blur(),t.insRightOf(this);};}),le.rbrace=he["}"]=e(v,"{","}","\\{","\\}"),le.rangle=le.rang=e(v,"&lang;","&rang;","\\langle ","\\rangle "),w=function w(t,e){t.init=function(t,n){e.init.call(this,t,n,t,n);};},x=H(b,w),le.lparen=he["("]=e(x,"(",")"),le.lbrack=le.lbracket=he["["]=e(x,"[","]"),j=H(v,w),le.rparen=he[")"]=e(j,"(",")"),le.rbrack=le.rbracket=he["]"]=e(j,"[","]"),k=le.lpipe=le.rpipe=he["|"]=H(x,function(t,e){t.init=function(){e.init.call(this,"|","|");},t.createLeftOf=v.prototype.createLeftOf;}),q=he.$=le.text=le.textnormal=le.textrm=le.textup=le.textmd=H(ne,function(t,e){t.ctrlSeq="\\text",t.htmlTemplate='<span class="text">&0</span>',t.replaces=function(t){t instanceof se?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t);},t.textTemplate=['"','"'],t.parser=function(){var t=this,e=N.string,n=N.regex,i=N.optWhitespace;return i.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map(function(e){var n,i,r;for(t.createBlocks(),n=t.ends[G],i=0;i<e.length;i+=1){r=O(e.charAt(i)),r.adopt(n,n.ends[X],0);}return t;});},t.createBlocks=function(){this.ends[G]=this.ends[X]=y(),this.blocks=[this.ends[G]],this.ends[G].parent=this;},t.finalizeInsert=function(){this.ends[G].blur=function(){return delete this.blur,this;},e.finalizeInsert.call(this);},t.createLeftOf=function(t){if(e.createLeftOf.call(this,this.cursor=t),this.replacedText)for(var n=0;n<this.replacedText.length;n+=1){this.ends[G].write(t,this.replacedText.charAt(n));}};}),y=H(re,function(t,e){t.onKey=function(t){return"Spacebar"===t||"Shift-Spacebar"===t?!1:void 0;},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this.parent);},t.write=function(t,e,n){var i,r;return n&&n.remove(),"$"!==e?("<"===e?i="&lt;":">"===e&&(i="&gt;"),O(e,i).createLeftOf(t)):this.isEmpty()?(t.insRightOf(this.parent).backspace(),O("\\$","$").createLeftOf(t)):t[X]?t[G]?(r=q(),r.replaces(se(t[X],this.ends[X])),t.insRightOf(this.parent),r.adopt=function(){delete this.adopt,this.adopt.apply(this,arguments),this[G]=0;},r.createLeftOf(t),r[G]=this.parent,t.insLeftOf(r)):t.insLeftOf(this.parent):t.insRightOf(this.parent),!1;},t.blur=function(){if(this.jQ.removeClass("hasCursor"),this.isEmpty()){var t=this.parent,e=t.cursor;e.parent===this?this.jQ.addClass("empty"):(e.hide(),t.remove(),e[X]===t?e[X]=t[X]:e[G]===t&&(e[G]=t[G]),e.show().parent.bubble("redraw"));}return this;},t.focus=function(){var t,n,i,r;return e.focus.call(this),t=this.parent,t[X].ctrlSeq===t.ctrlSeq?(n=this,i=t.cursor,r=t[X].ends[G],r.eachChild(function(t){t.parent=n,t.jQ.appendTo(n.jQ);}),this.ends[X]?this.ends[X][X]=r.ends[G]:this.ends[G]=r.ends[G],r.ends[G][G]=this.ends[X],this.ends[X]=r.ends[X],r.parent.remove(),i[G]?i.insRightOf(i[G]):i.insAtLeftEnd(this),i.parent.bubble("redraw")):t[G].ctrlSeq===t.ctrlSeq&&(i=t.cursor,i[G]?t[G].ends[G].focus():i.insAtRightEnd(t[G].ends[G])),this;};}),le.em=le.italic=le.italics=le.emph=le.textit=le.textsl=s("\\textit","i",'class="text"'),le.strong=le.bold=le.textbf=s("\\textbf","b",'class="text"'),le.sf=le.textsf=s("\\textsf","span",'class="sans-serif text"'),le.tt=le.texttt=s("\\texttt","span",'class="monospace text"'),le.textsc=s("\\textsc","span",'style="font-variant:small-caps" class="text"'),le.uppercase=s("\\uppercase","span",'style="text-transform:uppercase" class="text"'),le.lowercase=s("\\lowercase","span",'style="text-transform:lowercase" class="text"'),Q=he["\\"]=H(ne,function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1;};},t.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[G].focus=function(){return this.parent.jQ.addClass("hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("empty"),this;},this.ends[G].blur=function(){return this.parent.jQ.removeClass("hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("empty"),this;};},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this.cursor=t.insAtRightEnd(this.ends[G]),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(t){return Z(t.target=n).trigger(t),!1;}).insertBefore(this.jQ).add(this.jQ);}this.ends[G].write=function(t,e,n){n&&n.remove(),e.match(/[a-z]/i)?O(e).createLeftOf(t):(this.parent.renderCommand(),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e));};},t.latex=function(){return"\\"+this.ends[G].latex()+" ";},t.onKey=function(t,e){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.renderCommand(),e.preventDefault(),!1):void 0;},t.renderCommand=function(){this.jQ=this.jQ.last(),this.remove(),this[X]?this.cursor.insLeftOf(this[X]):this.cursor.insAtRightEnd(this.parent);var t=this.ends[G].latex();t||(t="backslash"),this.cursor.insertCmd(t,this._replacedFragment);};}),C=le.binom=le.binomial=H(ne,function(t){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>',t.textTemplate=["choose(",",",")"],t.redraw=function(){var t=this.jQ.eq(1),e=t.outerHeight()/+t.css("fontSize").slice(0,-2),n=this.jQ.filter(".paren");o(n,P(1+.2*(e-1),1.2),1.05*e);};}),S=le.choose=H(C,function(t){t.createLeftOf=f.prototype.createLeftOf;}),L=le.vector=H(ne,function(t,e){t.ctrlSeq="\\vector",t.htmlTemplate='<span class="array"><span>&0</span></span>',t.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(t,e){return t.push(e.latex()),t;}).join("\\\\")+"\\end{matrix}";},t.text=function(){return"["+this.foldChildren([],function(t,e){return t.push(e.text()),t;}).join()+"]";},t.createLeftOf=function(t){e.createLeftOf.call(this,this.cursor=t);},t.onKey=function(t,e){var n,i=this.cursor.parent;if(i.parent===this){if("Enter"===t)return n=re(),n.parent=this,n.jQ=Z("<span></span>").attr(F,n.id).insertAfter(i.jQ),i[X]?i[X][G]=n:this.ends[X]=n,n[X]=i[X],i[X]=n,n[G]=i,this.bubble("redraw").cursor.insAtRightEnd(n),e.preventDefault(),!1;if("Tab"===t&&!i[X])return i.isEmpty()?i[G]?(this.cursor.insRightOf(this),delete i[G][X],this.ends[X]=i[G],i.jQ.remove(),this.bubble("redraw"),e.preventDefault(),!1):void 0:(n=re(),n.parent=this,n.jQ=Z("<span></span>").attr(F,n.id).appendTo(this.jQ),this.ends[X]=n,i[X]=n,n[G]=i,this.bubble("redraw").cursor.insAtRightEnd(n),e.preventDefault(),!1);if(8===e.which){if(i.isEmpty())return i[G]?(this.cursor.insAtRightEnd(i[G]),i[G][X]=i[X]):(this.cursor.insLeftOf(this),this.ends[G]=i[X]),i[X]?i[X][G]=i[G]:this.ends[X]=i[G],i.jQ.remove(),this.isEmpty()?this.cursor.deleteForward():this.bubble("redraw"),e.preventDefault(),!1;if(!this.cursor[G])return e.preventDefault(),!1;}}};}),le.editable=H(oe,function(t,e){t.init=function(){ne.prototype.init.call(this,"\\editable");},t.jQadd=function(){var t,n,i=this;e.jQadd.apply(i,arguments),t=i.ends[G].disown(),n=i.jQ.children().detach(),i.ends[G]=i.ends[X]=ae(),i.blocks=[i.ends[G]],i.ends[G].parent=i,r(i.jQ,i.ends[G],!1,!0),i.cursor=i.ends[G].cursor,t.children().adopt(i.ends[G],0,0),n.appendTo(i.ends[G].jQ),i.ends[G].cursor.insAtRightEnd(i.ends[G]);},t.latex=function(){return this.ends[G].latex();},t.text=function(){return this.ends[G].text();};}),le.f=e(ie,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>'),D=H(ie,function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>");},t.text=function(){var t=this.ctrlSeq;return!this[G]||this[G]instanceof D||this[G]instanceof R||(t="*"+t),!this[X]||this[X]instanceof R||"^"===this[X].ctrlSeq||(t+="*"),t;};}),O=H(ie,function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>");};}),he[" "]=e(O,"\\:"," "),le.prime=he["'"]=e(O,"'","&prime;"),E=H(ie,function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="nonSymbola">'+(n||t)+"</span>");};}),le["@"]=E,le["&"]=e(E,"\\&","&amp;"),le["%"]=e(E,"\\%","%"),le.alpha=le.beta=le.gamma=le.delta=le.zeta=le.eta=le.theta=le.iota=le.kappa=le.mu=le.nu=le.xi=le.rho=le.sigma=le.tau=le.chi=le.psi=le.omega=H(D,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";");};}),le.phi=e(D,"\\phi ","&#981;"),le.phiv=le.varphi=e(D,"\\varphi ","&phi;"),le.epsilon=e(D,"\\epsilon ","&#1013;"),le.epsiv=le.varepsilon=e(D,"\\varepsilon ","&epsilon;"),le.piv=le.varpi=e(D,"\\varpi ","&piv;"),le.sigmaf=le.sigmav=le.varsigma=e(D,"\\varsigma ","&sigmaf;"),le.thetav=le.vartheta=le.thetasym=e(D,"\\vartheta ","&thetasym;"),le.upsilon=le.upsi=e(D,"\\upsilon ","&upsilon;"),le.gammad=le.Gammad=le.digamma=e(D,"\\digamma ","&#989;"),le.kappav=le.varkappa=e(D,"\\varkappa ","&#1008;"),le.rhov=le.varrho=e(D,"\\varrho ","&#1009;"),le.pi=le[""]=e(E,"\\pi ","&pi;"),le.lambda=e(E,"\\lambda ","&lambda;"),le.Upsilon=le.Upsi=le.upsih=le.Upsih=e(ie,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),le.Gamma=le.Delta=le.Theta=le.Lambda=le.Xi=le.Pi=le.Sigma=le.Phi=le.Psi=le.Omega=le.forall=H(O,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";");};}),A=H(ne,function(t){t.init=function(t){this.latex=t;},t.createLeftOf=function(t){t.writeLatex(this.latex);},t.parser=function(){var t=B.parse(this.latex).children();return N.succeed(t);};}),le[""]=e(A,"^1"),le[""]=e(A,"^2"),le[""]=e(A,"^3"),le[""]=e(A,"\\frac14"),le[""]=e(A,"\\frac12"),le[""]=e(A,"\\frac34"),R=H(ie,function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="binary-operator">'+n+"</span>",i);};}),T=H(R,function(t){t.init=O.prototype.init,t.respace=function(){return this.jQ[0].className=this[G]?this[G]instanceof R&&this[X]&&!(this[X]instanceof R)?"unary-operator":"binary-operator":"",this;};}),le["+"]=e(T,"+","+"),le[""]=le["-"]=e(T,"-","&minus;"),le[""]=le.pm=le.plusmn=le.plusminus=e(T,"\\pm ","&plusmn;"),le.mp=le.mnplus=le.minusplus=e(T,"\\mp ","&#8723;"),he["*"]=le.sdot=le.cdot=e(R,"\\cdot ","&middot;"),le["="]=e(R,"=","="),le["<"]=e(R,"<","&lt;"),le[">"]=e(R,">","&gt;"),le.notin=le.sim=le.cong=le.equiv=le.oplus=le.otimes=H(R,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";");};}),le.times=e(R,"\\times ","&times;","[x]"),le[""]=le.div=le.divide=le.divides=e(R,"\\div ","&divide;","[/]"),le[""]=le.ne=le.neq=e(R,"\\ne ","&ne;"),le.ast=le.star=le.loast=le.lowast=e(R,"\\ast ","&lowast;"),le.therefor=le.therefore=e(R,"\\therefore ","&there4;"),le.cuz=le.because=e(R,"\\because ","&#8757;"),le.prop=le.propto=e(R,"\\propto ","&prop;"),le[""]=le.asymp=le.approx=e(R,"\\approx ","&asymp;"),le.lt=e(R,"<","&lt;"),le.gt=e(R,">","&gt;"),le[""]=le.le=le.leq=e(R,"\\le ","&le;"),le[""]=le.ge=le.geq=e(R,"\\ge ","&ge;"),le.isin=le["in"]=e(R,"\\in ","&isin;"),le.ni=le.contains=e(R,"\\ni ","&ni;"),le.notni=le.niton=le.notcontains=le.doesnotcontain=e(R,"\\not\\ni ","&#8716;"),le.sub=le.subset=e(R,"\\subset ","&sub;"),le.sup=le.supset=le.superset=e(R,"\\supset ","&sup;"),le.nsub=le.notsub=le.nsubset=le.notsubset=e(R,"\\not\\subset ","&#8836;"),le.nsup=le.notsup=le.nsupset=le.notsupset=le.nsuperset=le.notsuperset=e(R,"\\not\\supset ","&#8837;"),le.sube=le.subeq=le.subsete=le.subseteq=e(R,"\\subseteq ","&sube;"),le.supe=le.supeq=le.supsete=le.supseteq=le.supersete=le.superseteq=e(R,"\\supseteq ","&supe;"),le.nsube=le.nsubeq=le.notsube=le.notsubeq=le.nsubsete=le.nsubseteq=le.notsubsete=le.notsubseteq=e(R,"\\not\\subseteq ","&#8840;"),le.nsupe=le.nsupeq=le.notsupe=le.notsupeq=le.nsupsete=le.nsupseteq=le.notsupsete=le.notsupseteq=le.nsupersete=le.nsuperseteq=le.notsupersete=le.notsuperseteq=e(R,"\\not\\supseteq ","&#8841;"),z=H(ie,function(t,e){t.init=function(t,n){e.init.call(this,t,"<big>"+n+"</big>");};}),le[""]=le.sum=le.summation=e(z,"\\sum ","&sum;"),le[""]=le.prod=le.product=e(z,"\\prod ","&prod;"),le.coprod=le.coproduct=e(z,"\\coprod ","&#8720;"),le[""]=le["int"]=le.integral=e(z,"\\int ","&int;"),le.N=le.naturals=le.Naturals=e(O,"\\mathbb{N}","&#8469;"),le.P=le.primes=le.Primes=le.projective=le.Projective=le.probability=le.Probability=e(O,"\\mathbb{P}","&#8473;"),le.Z=le.integers=le.Integers=e(O,"\\mathbb{Z}","&#8484;"),le.Q=le.rationals=le.Rationals=e(O,"\\mathbb{Q}","&#8474;"),le.R=le.reals=le.Reals=e(O,"\\mathbb{R}","&#8477;"),le.C=le.complex=le.Complex=le.complexes=le.Complexes=le.complexplane=le.Complexplane=le.ComplexPlane=e(O,"\\mathbb{C}","&#8450;"),le.H=le.Hamiltonian=le.quaternions=le.Quaternions=e(O,"\\mathbb{H}","&#8461;"),le.quad=le.emsp=e(O,"\\quad ","    "),le.qquad=e(O,"\\qquad ","        "),le.diamond=e(O,"\\diamond ","&#9671;"),le.bigtriangleup=e(O,"\\bigtriangleup ","&#9651;"),le.ominus=e(O,"\\ominus ","&#8854;"),le.uplus=e(O,"\\uplus ","&#8846;"),le.bigtriangledown=e(O,"\\bigtriangledown ","&#9661;"),le.sqcap=e(O,"\\sqcap ","&#8851;"),le.triangleleft=e(O,"\\triangleleft ","&#8882;"),le.sqcup=e(O,"\\sqcup ","&#8852;"),le.triangleright=e(O,"\\triangleright ","&#8883;"),le.odot=e(O,"\\odot ","&#8857;"),le.bigcirc=e(O,"\\bigcirc ","&#9711;"),le.dagger=e(O,"\\dagger ","&#0134;"),le.ddagger=e(O,"\\ddagger ","&#135;"),le.wr=e(O,"\\wr ","&#8768;"),le.amalg=e(O,"\\amalg ","&#8720;"),le.models=e(O,"\\models ","&#8872;"),le.prec=e(O,"\\prec ","&#8826;"),le.succ=e(O,"\\succ ","&#8827;"),le.preceq=e(O,"\\preceq ","&#8828;"),le.succeq=e(O,"\\succeq ","&#8829;"),le.simeq=e(O,"\\simeq ","&#8771;"),le.mid=e(O,"\\mid ","&#8739;"),le.ll=e(O,"\\ll ","&#8810;"),le.gg=e(O,"\\gg ","&#8811;"),le.parallel=e(O,"\\parallel ","&#8741;"),le.bowtie=e(O,"\\bowtie ","&#8904;"),le.sqsubset=e(O,"\\sqsubset ","&#8847;"),le.sqsupset=e(O,"\\sqsupset ","&#8848;"),le.smile=e(O,"\\smile ","&#8995;"),le.sqsubseteq=e(O,"\\sqsubseteq ","&#8849;"),le.sqsupseteq=e(O,"\\sqsupseteq ","&#8850;"),le.doteq=e(O,"\\doteq ","&#8784;"),le.frown=e(O,"\\frown ","&#8994;"),le.vdash=e(O,"\\vdash ","&#8870;"),le.dashv=e(O,"\\dashv ","&#8867;"),le.longleftarrow=e(O,"\\longleftarrow ","&#8592;"),le.longrightarrow=e(O,"\\longrightarrow ","&#8594;"),le.Longleftarrow=e(O,"\\Longleftarrow ","&#8656;"),le.Longrightarrow=e(O,"\\Longrightarrow ","&#8658;"),le.longleftrightarrow=e(O,"\\longleftrightarrow ","&#8596;"),le.updownarrow=e(O,"\\updownarrow ","&#8597;"),le.Longleftrightarrow=e(O,"\\Longleftrightarrow ","&#8660;"),le.Updownarrow=e(O,"\\Updownarrow ","&#8661;"),le.mapsto=e(O,"\\mapsto ","&#8614;"),le.nearrow=e(O,"\\nearrow ","&#8599;"),le.hookleftarrow=e(O,"\\hookleftarrow ","&#8617;"),le.hookrightarrow=e(O,"\\hookrightarrow ","&#8618;"),le.searrow=e(O,"\\searrow ","&#8600;"),le.leftharpoonup=e(O,"\\leftharpoonup ","&#8636;"),le.rightharpoonup=e(O,"\\rightharpoonup ","&#8640;"),le.swarrow=e(O,"\\swarrow ","&#8601;"),le.leftharpoondown=e(O,"\\leftharpoondown ","&#8637;"),le.rightharpoondown=e(O,"\\rightharpoondown ","&#8641;"),le.nwarrow=e(O,"\\nwarrow ","&#8598;"),le.ldots=e(O,"\\ldots ","&#8230;"),le.cdots=e(O,"\\cdots ","&#8943;"),le.vdots=e(O,"\\vdots ","&#8942;"),le.ddots=e(O,"\\ddots ","&#8944;"),le.surd=e(O,"\\surd ","&#8730;"),le.triangle=e(O,"\\triangle ","&#9653;"),le.ell=e(O,"\\ell ","&#8467;"),le.top=e(O,"\\top ","&#8868;"),le.flat=e(O,"\\flat ","&#9837;"),le.natural=e(O,"\\natural ","&#9838;"),le.sharp=e(O,"\\sharp ","&#9839;"),le.wp=e(O,"\\wp ","&#8472;"),le.bot=e(O,"\\bot ","&#8869;"),le.clubsuit=e(O,"\\clubsuit ","&#9827;"),le.diamondsuit=e(O,"\\diamondsuit ","&#9826;"),le.heartsuit=e(O,"\\heartsuit ","&#9825;"),le.spadesuit=e(O,"\\spadesuit ","&#9824;"),le.oint=e(O,"\\oint ","&#8750;"),le.bigcap=e(O,"\\bigcap ","&#8745;"),le.bigcup=e(O,"\\bigcup ","&#8746;"),le.bigsqcup=e(O,"\\bigsqcup ","&#8852;"),le.bigvee=e(O,"\\bigvee ","&#8744;"),le.bigwedge=e(O,"\\bigwedge ","&#8743;"),le.bigodot=e(O,"\\bigodot ","&#8857;"),le.bigotimes=e(O,"\\bigotimes ","&#8855;"),le.bigoplus=e(O,"\\bigoplus ","&#8853;"),le.biguplus=e(O,"\\biguplus ","&#8846;"),le.lfloor=e(O,"\\lfloor ","&#8970;"),le.rfloor=e(O,"\\rfloor ","&#8971;"),le.lceil=e(O,"\\lceil ","&#8968;"),le.rceil=e(O,"\\rceil ","&#8969;"),le.slash=e(O,"\\slash ","&#47;"),le.opencurlybrace=e(O,"\\opencurlybrace ","&#123;"),le.closecurlybrace=e(O,"\\closecurlybrace ","&#125;"),le.caret=e(O,"\\caret ","^"),le.underscore=e(O,"\\underscore ","_"),le.backslash=e(O,"\\backslash ","\\"),le.vert=e(O,"|"),le.perp=le.perpendicular=e(O,"\\perp ","&perp;"),le.nabla=le.del=e(O,"\\nabla ","&nabla;"),le.hbar=e(O,"\\hbar ","&#8463;"),le.AA=le.Angstrom=le.angstrom=e(O,"\\text\\AA ","&#8491;"),le.ring=le.circ=le.circle=e(O,"\\circ ","&#8728;"),le.bull=le.bullet=e(O,"\\bullet ","&bull;"),le.setminus=le.smallsetminus=e(O,"\\setminus ","&#8726;"),le.not=le[""]=le.neg=e(O,"\\neg ","&not;"),le[""]=le.dots=le.ellip=le.hellip=le.ellipsis=le.hellipsis=e(O,"\\dots ","&hellip;"),le.converges=le.darr=le.dnarr=le.dnarrow=le.downarrow=e(O,"\\downarrow ","&darr;"),le.dArr=le.dnArr=le.dnArrow=le.Downarrow=e(O,"\\Downarrow ","&dArr;"),le.diverges=le.uarr=le.uparrow=e(O,"\\uparrow ","&uarr;"),le.uArr=le.Uparrow=e(O,"\\Uparrow ","&uArr;"),le.to=e(R,"\\to ","&rarr;"),le.rarr=le.rightarrow=e(O,"\\rightarrow ","&rarr;"),le.implies=e(R,"\\Rightarrow ","&rArr;"),le.rArr=le.Rightarrow=e(O,"\\Rightarrow ","&rArr;"),le.gets=e(R,"\\gets ","&larr;"),le.larr=le.leftarrow=e(O,"\\leftarrow ","&larr;"),le.impliedby=e(R,"\\Leftarrow ","&lArr;"),le.lArr=le.Leftarrow=e(O,"\\Leftarrow ","&lArr;"),le.harr=le.lrarr=le.leftrightarrow=e(O,"\\leftrightarrow ","&harr;"),le.iff=e(R,"\\Leftrightarrow ","&hArr;"),le.hArr=le.lrArr=le.Leftrightarrow=e(O,"\\Leftrightarrow ","&hArr;"),le.Re=le.Real=le.real=e(O,"\\Re ","&real;"),le.Im=le.imag=le.image=le.imagin=le.imaginary=le.Imaginary=e(O,"\\Im ","&image;"),le.part=le.partial=e(O,"\\partial ","&part;"),le.inf=le.infin=le.infty=le.infinity=e(O,"\\infty ","&infin;"),le.alef=le.alefsym=le.aleph=le.alephsym=e(O,"\\aleph ","&alefsym;"),le.xist=le.xists=le.exist=le.exists=e(O,"\\exists ","&exist;"),le.and=le.land=le.wedge=e(O,"\\wedge ","&and;"),le.or=le.lor=le.vee=e(O,"\\vee ","&or;"),le.o=le.O=le.empty=le.emptyset=le.oslash=le.Oslash=le.nothing=le.varnothing=e(R,"\\varnothing ","&empty;"),le.cup=le.union=e(R,"\\cup ","&cup;"),le.cap=le.intersect=le.intersection=e(R,"\\cap ","&cap;"),le.deg=le.degree=e(O,"^\\circ ","&deg;"),le.ang=le.angle=e(O,"\\angle ","&ang;"),$=H(ie,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","<span>"+t+"</span>");},t.respace=function(){this.jQ[0].className=this[X]instanceof u||this[X]instanceof b?"":"non-italicized-function";};}),le.ln=le.lg=le.log=le.span=le.proj=le.det=le.dim=le.min=le.max=le.mod=le.lcm=le.gcd=le.gcf=le.hcf=le.lim=$,function(){var t,e=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(t in e){le[e[t]]=le[e[t]+"h"]=le["a"+e[t]]=le["arc"+e[t]]=le["a"+e[t]+"h"]=le["arc"+e[t]+"h"]=$;}}(),B=function(){function t(t){var e=re();return t.adopt(e,0,0),e;}function e(t){var e,n=t[0]||re();for(e=1;e<t.length;e+=1){t[e].children().adopt(n,n.ends[X],0);}return n;}var n=N.string,i=N.regex,r=N.letter,s=N.any,a=N.optWhitespace,o=N.succeed,c=N.fail,h=r.map(D),l=i(/^[^${}\\_^]/).map(O),u=i(/^[^\\a-eg-zA-Z]/).or(n("\\").then(i(/^[a-z]+/i).or(i(/^\s+/).result(" ")).or(s))).then(function(t){var e=le[t];return e?e(t).parser():c("unknown command: \\"+t);}),p=u.or(h).or(l),f=n("{").then(function(){return m;}).skip(n("}")),d=a.then(f.or(p.map(t))),m=d.many().map(e).skip(a),g=n("[").then(d.then(function(t){return"]"!==t.join("latex")?o(t):c();}).many().map(e).skip(a)).skip(n("]")),b=m;return b.block=d,b.optBlock=g,b;}(),I=H(Y,function(t){function e(t,e){var i,r,s,a;if(t.clearSelection().show(),t[X][e])t.insAtLeftEnd(t[X][e]);else if(t[G][e])t.insAtRightEnd(t[G][e]);else{i=t.parent;do{if(r=i[e],r&&("function"==typeof r&&(r=i[e](t)),r===!1||r instanceof re)){t.upDownCache[i.id]=Y(t.parent,t[G],t[X]),r instanceof re&&(s=t.upDownCache[r.id],s?s[X]?t.insLeftOf(s[X]):t.insAtRightEnd(s.parent):(a=n(t).left,t.insAtRightEnd(r),t.seekHoriz(a,r)));break;}i=i.parent.parent;}while(i);}return t;}function n(t){var e=t.jQ.removeClass("cursor").offset();return t.jQ.addClass("cursor"),e;}function r(t){t.upDownCache={};}t.init=function(t){this.parent=this.root=t;var e=this.jQ=this._jQ=Z('<span class="cursor">&#8203;</span>');this.blink=function(){e.toggleClass("blink");},this.upDownCache={};},t.show=function(){return this.jQ=this._jQ.removeClass("blink"),"intervalId"in this?clearInterval(this.intervalId):(this[X]?this.jQ.insertBefore(this.selection&&this.selection.ends[G][G]===this[G]?this.selection.jQ:this[X].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this;},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=Z(),this;},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r.blur();},t.insDirOf=function(t,e){return i(t),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("hasCursor"),this.jQ.insDirOf(t,e.jQ),this;},t.insLeftOf=function(t){return this.insDirOf(G,t);},t.insRightOf=function(t){return this.insDirOf(X,t);},t.insAtDirEnd=function(t,e){return i(t),this.withDirInsertAt(t,e,0,e.ends[t]),t===G&&e.textarea?this.jQ.insDirOf(-t,e.textarea):this.jQ.insAtDirEnd(t,e.jQ),e.focus(),this;},t.insAtLeftEnd=function(t){return this.insAtDirEnd(G,t);},t.insAtRightEnd=function(t){return this.insAtDirEnd(X,t);},t.hopDir=function(t){return i(t),this.jQ.insDirOf(t,this[t].jQ),this[-t]=this[t],this[t]=this[t][t],this;},t.hopLeft=function(){return this.hopDir(G);},t.hopRight=function(){return this.hopDir(X);},t.moveDirWithin=function(t,e){if(i(t),this[t])this[t].ends[-t]?this.insAtDirEnd(-t,this[t].ends[-t]):this.hopDir(t);else{if(this.parent===e)return;this.parent[t]?this.insAtDirEnd(-t,this.parent[t]):this.insDirOf(t,this.parent.parent);}},t.moveLeftWithin=function(t){return this.moveDirWithin(G,t);},t.moveRightWithin=function(t){return this.moveDirWithin(X,t);},t.moveDir=function(t){return i(t),r(this),this.selection?this.insDirOf(t,this.selection.ends[t]).clearSelection():this.moveDirWithin(t,this.root),this.show();},t.moveLeft=function(){return this.moveDir(G);},t.moveRight=function(){return this.moveDir(X);},t.moveUp=function(){return e(this,"up");},t.moveDown=function(){return e(this,"down");},t.seek=function(t,e){r(this);var n,i,s=this.clearSelection().show();return t.hasClass("empty")?(s.insAtLeftEnd(ee[t.attr(F)]),s):(n=ee[t.attr(M)],n instanceof ie?(t.outerWidth()>2*(e-t.offset().left)?s.insLeftOf(n):s.insRightOf(n),s):(n||(i=ee[t.attr(F)],i||(t=t.parent(),n=ee[t.attr(M)],n||(i=ee[t.attr(F)],i||(i=s.root)))),n?s.insRightOf(n):s.insAtRightEnd(i),s.seekHoriz(e,s.root)));},t.seekHoriz=function(t,e){var i,r=this,s=n(r).left-t;do{r.moveLeftWithin(e),i=s,s=n(r).left-t;}while(s>0&&(r[G]||r.parent!==e));return-s>i&&r.moveRightWithin(e),r;},t.writeLatex=function(t){var e,n,i,s=this;return r(s),s.show().deleteSelection(),e=N.all,n=N.eof,i=B.skip(n).or(e.result(!1)).parse(t),i&&(i.children().adopt(s.parent,s[G],s[X]),ee.jQize(i.join("html")).insertBefore(s.jQ),s[G]=i.ends[X],i.finalizeInsert(),s.parent.bubble("redraw")),this.hide();},t.write=function(t){var e=this.prepareWrite();return this.insertCh(t,e);},t.insertCh=function(t,e){return this.parent.write(this,t,e),this;},t.insertCmd=function(t,e){var n=le[t];return n?(n=n(t),e&&n.replaces(e),n.createLeftOf(this)):(n=q(),n.replaces(t),n.ends[G].focus=function(){return delete this.focus,this;},n.createLeftOf(this),this.insRightOf(n),e&&e.remove()),this;},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[X],i=t[G];if(t.disown().eachChild(function(r){r.isEmpty()||(r.children().adopt(e,i,n).each(function(e){e.jQ.insertBefore(t.jQ.first());}),i=r.ends[X]);}),!this[X])if(this[G])this[X]=this[G][X];else for(;!this[X];){if(this.parent=this.parent[X],!this.parent){this[X]=t[X],this.parent=e;break;}this[X]=this.parent.ends[G];}this[X]?this.insLeftOf(this[X]):this.insAtRightEnd(e),t.jQ.remove(),t[G]&&t[G].respace(),t[X]&&t[X].respace();},t.deleteDir=function(t){if(i(t),r(this),this.show(),this.deleteSelection());else if(this[t])this[t].isEmpty()?this[t]=this[t].remove()[t]:this.selectDir(t);else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insDirOf(-t,this.parent.parent).deleteDir(t);this.unwrapGramp();}return this[G]&&this[G].respace(),this[X]&&this[X].respace(),this.parent.bubble("redraw"),this;},t.backspace=function(){return this.deleteDir(G);},t.deleteForward=function(){return this.deleteDir(X);},t.selectFrom=function(t){var e,n,i,r,s,a,o=this,c=t;t:for(;;){for(e=this;e!==o.parent.parent;e=e.parent.parent){if(e.parent===c.parent){i=e,r=c;break t;}}for(n=t;n!==c.parent.parent;n=n.parent.parent){if(o.parent===n.parent){i=o,r=n;break t;}}o.parent.parent&&(o=o.parent.parent),c.parent.parent&&(c=c.parent.parent);}if(i[X]!==r){for(a=i;a;a=a[X]){if(a===r[G]){s=!0;break;}}s||(s=r,r=i,i=s);}this.hide().selection=_(i[G][X]||i.parent.ends[G],r[X][G]||r.parent.ends[X]),this.insRightOf(r[X][G]||r.parent.ends[X]),this.root.selectionChanged();},t.selectDir=function(t){if(i(t),r(this),this.selection){if(this.selection.ends[t]===this[-t])this[t]?this.hopDir(t).selection.extendDir(t):this.parent!==this.root&&this.insDirOf(t,this.parent.parent).selection.levelUp();else{if(this.hopDir(t),this.selection.ends[t]===this.selection.ends[-t])return void this.clearSelection().show();this.selection.retractDir(t);}}else{if(this[t])this.hopDir(t);else{if(this.parent===this.root)return;this.insDirOf(t,this.parent.parent);}this.hide().selection=_(this[-t]);}this.root.selectionChanged();},t.selectLeft=function(){return this.selectDir(G);},t.selectRight=function(){return this.selectDir(X);},t.prepareMove=function(){return r(this),this.show().clearSelection();},t.prepareEdit=function(){return r(this),this.show().deleteSelection();},t.prepareWrite=function(){return r(this),this.show().replaceSelection();},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.root.selectionChanged()),this;},t.deleteSelection=function(){return this.selection?(this[G]=this.selection.ends[G][G],this[X]=this.selection.ends[X][X],this.selection.remove(),this.root.selectionChanged(),delete this.selection):!1;},t.replaceSelection=function(){var t=this.selection;return t&&(this[G]=t.ends[G][G],this[X]=t.ends[X][X],delete this.selection),t;};}),_=H(se,function(t,e){t.init=function(){var t=this;e.init.apply(t,arguments),t.jQwrap(t.jQ);},t.jQwrap=function(t){this.jQ=t.wrapAll('<span class="selection"></span>').parent();},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments);},t.clear=function(){return this.jQ.replaceWith(this.jQ.children()),this;},t.levelUp=function(){var t=this,e=t.ends[G]=t.ends[X]=t.ends[X].parent.parent;return t.clear().jQwrap(e.jQ),t;},t.extendDir=function(t){return i(t),this.ends[t]=this.ends[t][t],this.ends[t].jQ.insAtDirEnd(t,this.jQ),this;},t.extendLeft=function(){return this.extendDir(G);},t.extendRight=function(){return this.extendDir(X);},t.retractDir=function(t){i(t),this.ends[-t].jQ.insDirOf(-t,this.jQ),this.ends[-t]=this.ends[-t][t];},t.retractRight=function(){return this.retractDir(X);},t.retractLeft=function(){return this.retractDir(G);};}),W.fn.mathquill=function(t,e){var n,i,s,a,o;switch(t){case"redraw":return this.each(function(){var t=Z(this).attr(F),e=t&&ee[t];e&&!function n(t){t.eachChild(n),t.redraw&&t.redraw();}(e);});case"revert":return this.each(function(){var t=Z(this).attr(F),e=t&&ee[t];e&&e.revert&&e.revert();});case"latex":return arguments.length>1?this.each(function(){var t=Z(this).attr(F),n=t&&ee[t];n&&n.renderLatex(e);}):(n=Z(this).attr(F),i=n&&ee[n],i&&i.latex());case"text":return n=Z(this).attr(F),i=n&&ee[n],i&&i.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1)return this.each(function(){var t=Z(this).attr(F),n=t&&ee[t],i=n&&n.cursor;i&&i.writeLatex(e).parent.blur();});case"cmd":if(arguments.length>1)return this.each(function(){var t,n=Z(this).attr(F),i=n&&ee[n],r=i&&i.cursor;r&&(t=r.prepareWrite(),/^\\[a-z]+$/i.test(e)?r.insertCmd(e.slice(1),t):r.insertCh(e,t),r.hide().parent.blur());});default:return s="textbox"===t,a=s||"editable"===t,o=s?ce:ae,this.each(function(){r(Z(this),o(),s,a);});}},W(function(){W(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable"),W(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox"),W(".mathquill-embedded-latex").mathquill();});}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher");}(jQuery);+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in n){if(i.style[t]!==undefined)return{end:n[t]};}return!1;}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one("bsTransitionEnd",function(){i=!0;});return r=function r(){i||n(u).trigger(n.support.transition.end);},setTimeout(r,t),this;};n(function(){(n.support.transition=t(),n.support.transition)&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function handle(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments);}});});}(jQuery);+function(n){"use strict";function u(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this));typeof i=="string"&&u[i].call(r);});}var i='[data-dismiss="alert"]',t=function t(_t){n(_t).on("click",i,this.close);},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.close=function(i){function e(){r.detach().trigger("closed.bs.alert").remove();}var f=n(this),u=f.attr("data-target"),r;(u||(u=f.attr("href"),u=u&&u.replace(/.*(?=#[^\s]*$)/,"")),r=n(u),i&&i.preventDefault(),r.length||(r=f.closest(".alert")),r.trigger(i=n.Event("close.bs.alert")),i.isDefaultPrevented())||(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e());};r=n.fn.alert;n.fn.alert=u;n.fn.alert.Constructor=t;n.fn.alert.noConflict=function(){return n.fn.alert=r,this;};n(document).on("click.bs.alert.data-api",i,t.prototype.close);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.button",r=new t(this,f));i=="toggle"?r.toggle():i&&r.setState(i);});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.isLoading=!1;},r;t.VERSION="3.3.5";t.DEFAULTS={loadingText:"loading..."};t.prototype.setState=function(t){var r="disabled",i=this.$element,f=i.is("input")?"val":"html",u=i.data();t+="Text";u.resetText==null&&i.data("resetText",i[f]());setTimeout(n.proxy(function(){i[f](u[t]==null?this.options[t]:u[t]);t=="loadingText"?(this.isLoading=!0,i.addClass(r).attr(r,r)):this.isLoading&&(this.isLoading=!1,i.removeClass(r).removeAttr(r));},this),0);};t.prototype.toggle=function(){var t=!0,i=this.$element.closest('[data-toggle="buttons"]'),n;i.length?(n=this.$element.find("input"),n.prop("type")=="radio"?(n.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):n.prop("type")=="checkbox"&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"));};r=n.fn.button;n.fn.button=i;n.fn.button.Constructor=t;n.fn.button.noConflict=function(){return n.fn.button=r,this;};n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn"));i.call(r,"toggle");n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault();}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type));});}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i),e=typeof i=="string"?i:f.slide;r||u.data("bs.carousel",r=new t(this,f));typeof i=="number"?r.to(i):e?r[e]():f.interval&&r.pause().cycle();});}var t=function t(_t2,i){this.$element=n(_t2);this.$indicators=this.$element.find(".carousel-indicators");this.options=i;this.paused=null;this.sliding=null;this.interval=null;this.$active=null;this.$items=null;this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this));this.options.pause!="hover"||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this));},u,r;t.VERSION="3.3.5";t.TRANSITION_DURATION=600;t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0};t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return;}n.preventDefault();}};t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this;};t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active);};t.prototype.getItemForDirection=function(n,t){var i=this.getItemIndex(t),f=n=="prev"&&i===0||n=="next"&&i==this.$items.length-1,r,u;return f&&!this.options.wrap?t:(r=n=="prev"?-1:1,u=(i+r)%this.$items.length,this.$items.eq(u));};t.prototype.to=function(n){var i=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(n>this.$items.length-1)&&!(n<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(n);}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n));};t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this;};t.prototype.next=function(){if(!this.sliding)return this.slide("next");};t.prototype.prev=function(){if(!this.sliding)return this.slide("prev");};t.prototype.slide=function(i,r){var e=this.$element.find(".item.active"),u=r||this.getItemForDirection(i,e),l=this.interval,f=i=="next"?"left":"right",a=this,o,s,h,c;return u.hasClass("active")?this.sliding=!1:(o=u[0],s=n.Event("slide.bs.carousel",{relatedTarget:o,direction:f}),this.$element.trigger(s),s.isDefaultPrevented())?void 0:(this.sliding=!0,l&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),h=n(this.$indicators.children()[this.getItemIndex(u)]),h&&h.addClass("active")),c=n.Event("slid.bs.carousel",{relatedTarget:o,direction:f}),n.support.transition&&this.$element.hasClass("slide")?(u.addClass(i),u[0].offsetWidth,e.addClass(f),u.addClass(f),e.one("bsTransitionEnd",function(){u.removeClass([i,f].join(" ")).addClass("active");e.removeClass(["active",f].join(" "));a.sliding=!1;setTimeout(function(){a.$element.trigger(c);},0);}).emulateTransitionEnd(t.TRANSITION_DURATION)):(e.removeClass("active"),u.addClass("active"),this.sliding=!1,this.$element.trigger(c)),l&&this.cycle(),this);};u=n.fn.carousel;n.fn.carousel=i;n.fn.carousel.Constructor=t;n.fn.carousel.noConflict=function(){return n.fn.carousel=u,this;};r=function r(t){var o,r=n(this),u=n(r.attr("data-target")||(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")),e,f;u.hasClass("carousel")&&(e=n.extend({},u.data(),r.data()),f=r.attr("data-slide-to"),f&&(e.interval=!1),i.call(u,e),f&&u.data("bs.carousel").to(f),t.preventDefault());};n(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r);n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(t){var i,r=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return n(r);}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.collapse"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);!r&&f.toggle&&/show|hide/.test(i)&&(f.toggle=!1);r||u.data("bs.collapse",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.$trigger=n('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]');this.transitioning=null;this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger);this.options.toggle&&this.toggle();},u;t.VERSION="3.3.5";t.TRANSITION_DURATION=350;t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height";};t.prototype.show=function(){var f,r,e,u,o,s;if(!this.transitioning&&!this.$element.hasClass("in")&&(r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),!r||!r.length||(f=r.data("bs.collapse"),!f||!f.transitioning))&&(e=n.Event("show.bs.collapse"),this.$element.trigger(e),!e.isDefaultPrevented())){if(r&&r.length&&(i.call(r,"hide"),f||r.data("bs.collapse",null)),u=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[u](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,o=function o(){this.$element.removeClass("collapsing").addClass("collapse in")[u]("");this.transitioning=0;this.$element.trigger("shown.bs.collapse");},!n.support.transition)return o.call(this);s=n.camelCase(["scroll",u].join("-"));this.$element.one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[u](this.$element[0][s]);}};t.prototype.hide=function(){var r,i,u;if(!this.transitioning&&this.$element.hasClass("in")&&(r=n.Event("hide.bs.collapse"),this.$element.trigger(r),!r.isDefaultPrevented())){if(i=this.dimension(),this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,u=function u(){this.transitioning=0;this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse");},!n.support.transition)return u.call(this);this.$element[i](0).one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION);}};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]();};t.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,i){var u=n(i);this.addAriaAndCollapsedClass(r(u),u);},this)).end();};t.prototype.addAriaAndCollapsedClass=function(n,t){var i=n.hasClass("in");n.attr("aria-expanded",i);t.toggleClass("collapsed",!i).attr("aria-expanded",i);};u=n.fn.collapse;n.fn.collapse=i;n.fn.collapse.Constructor=t;n.fn.collapse.noConflict=function(){return n.fn.collapse=u,this;};n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var u=n(this);u.attr("data-target")||t.preventDefault();var f=r(u),e=f.data("bs.collapse"),o=e?"toggle":u.data();i.call(f,o);});}(jQuery);+function(n){"use strict";function r(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent();}function u(t){t&&t.which===3||(n(e).remove(),n(i).each(function(){var u=n(this),i=r(u),f={relatedTarget:this};i.hasClass("open")&&(t&&t.type=="click"&&/input|textarea/i.test(t.target.tagName)&&n.contains(i[0],t.target)||(i.trigger(t=n.Event("hide.bs.dropdown",f)),t.isDefaultPrevented())||(u.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",f)));}));}function o(i){return this.each(function(){var r=n(this),u=r.data("bs.dropdown");u||r.data("bs.dropdown",u=new t(this));typeof i=="string"&&u[i].call(r);});}var e=".dropdown-backdrop",i='[data-toggle="dropdown"]',t=function t(_t3){n(_t3).on("click.bs.dropdown",this.toggle);},f;t.VERSION="3.3.5";t.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=r(f),o=i.hasClass("open"),u(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",u);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true");i.toggleClass("open").trigger("shown.bs.dropdown",e);}return!1;}};t.prototype.keydown=function(t){var e,o,s,h,f,u;if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=r(e),s=o.hasClass("open"),!s&&t.which!=27||s&&t.which==27)return t.which==27&&o.find(i).trigger("focus"),e.trigger("click");(h=" li:not(.disabled):visible a",f=o.find(".dropdown-menu"+h),f.length)&&(u=f.index(t.target),t.which==38&&u>0&&u--,t.which==40&&u<f.length-1&&u++,~u||(u=0),f.eq(u).trigger("focus"));}};f=n.fn.dropdown;n.fn.dropdown=o;n.fn.dropdown.Constructor=t;n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this;};n(document).on("click.bs.dropdown.data-api",u).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation();}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown);}(jQuery);+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);u||f.data("bs.modal",u=new t(this,e));typeof i=="string"?u[i](r):e.show&&u.show(r);});}var t=function t(_t4,i){this.options=i;this.$body=n(document.body);this.$element=n(_t4);this.$dialog=this.$element.find(".modal-dialog");this.$backdrop=null;this.isShown=null;this.originalBodyPad=null;this.scrollbarWidth=0;this.ignoreBackdropClick=!1;this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal");},this));},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=300;t.BACKDROP_TRANSITION_DURATION=150;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n);};t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});if(this.$element.trigger(u),!this.isShown&&!u.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.setScrollbar();this.$body.addClass("modal-open");this.escape();this.resize();this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0);});});this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body);r.$element.show().scrollTop(0);r.adjustDialog();f&&r.$element[0].offsetWidth;r.$element.addClass("in");r.enforceFocus();u=n.Event("shown.bs.modal",{relatedTarget:i});f?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u);}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u);});}};t.prototype.hide=function(i){(i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal());};t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus");},this));};t.prototype.escape=function(){if(this.isShown&&this.options.keyboard)this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){n.which==27&&this.hide();},this));else this.isShown||this.$element.off("keydown.dismiss.bs.modal");};t.prototype.resize=function(){if(this.isShown)n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this));else n(window).off("resize.bs.modal");};t.prototype.hideModal=function(){var n=this;this.$element.hide();this.backdrop(function(){n.$body.removeClass("modal-open");n.resetAdjustments();n.resetScrollbar();n.$element.trigger("hidden.bs.modal");});};t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null;};t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){r=n.support.transition&&f;this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+f).prependTo(this.$element);this.$backdrop.on("click.dismiss.bs.modal",n.proxy(function(n){if(this.ignoreBackdropClick){this.ignoreBackdropClick=!1;return;}n.target===n.currentTarget&&(this.options.backdrop=="static"?this.$element[0].focus():this.hide());},this));if(r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i();}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function u(){e.removeBackdrop();i&&i();},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i();};t.prototype.handleUpdate=function(){this.adjustDialog();};t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""});};t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""});};t.prototype.checkScrollbar=function(){var n=window.innerWidth,t;n||(t=document.documentElement.getBoundingClientRect(),n=t.right-Math.abs(t.left));this.bodyIsOverflowing=document.body.clientWidth<n;this.scrollbarWidth=this.measureScrollbar();};t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth);};t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad);};t.prototype.measureScrollbar=function(){var n=document.createElement("div"),t;return n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t;};r=n.fn.modal;n.fn.modal=i;n.fn.modal.Constructor=t;n.fn.modal.noConflict=function(){return n.fn.modal=r,this;};n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault();u.one("show.bs.modal",function(n){if(!n.isDefaultPrevented())u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus");});});i.call(u,e,this);});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.tooltip",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t5){this.type=null;this.options=null;this.enabled=null;this.timeout=null;this.hoverState=null;this.$element=null;this.inState=null;this.init("tooltip",n,_t5);},i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}};t.prototype.init=function(t,i,r){var f,e,u,o,s;if(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(f=this.options.trigger.split(" "),e=f.length;e--;){if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this));}}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle();};t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t;};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r);}),t;};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusin"?"focus":"hover"]=!0),i.tip().hasClass("in")||i.hoverState=="in"){i.hoverState="in";return;}if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show();},i.options.delay.show);};t.prototype.isInStateTrue=function(){for(var n in this.inState){if(this.inState[n])return!0;}return!1;};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusout"?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide();},i.options.delay.hide);}};t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,e,w,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var u=this,r=this.tip(),a=this.getUID(this.type);this.setContent();r.attr("id",a);this.$element.attr("aria-describedby",a);this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top");r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this);this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);this.$element.trigger("inserted.bs."+this.type);var f=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;y&&(p=i,e=this.getPosition(this.$viewport),i=i=="bottom"&&f.bottom+s>e.bottom?"top":i=="top"&&f.top-s<e.top?"bottom":i=="right"&&f.right+o>e.width?"left":i=="left"&&f.left-o<e.left?"right":i,r.removeClass(p).addClass(i));w=this.getCalculatedOffset(i,f,o,s);this.applyPlacement(w,i);h=function h(){var n=u.hoverState;u.$element.trigger("shown.bs."+u.type);u.hoverState=null;n=="out"&&u.leave(u);};n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h();}};t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top+=o;t.left+=s;n.offset.setOffset(r[0],n.extend({using:function using(n){r.css({top:Math.round(n.top),left:Math.round(n.left)});}},t),0);r.addClass("in");h=r[0].offsetWidth;f=r[0].offsetHeight;i=="top"&&f!=e&&(t.top=t.top+e-f);u=this.getViewportAdjustedDelta(i,t,h,f);u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?u.left*2-l+h:u.top*2-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t);this.replaceArrow(a,r[0][v],c);};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","");};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right");};t.prototype.hide=function(i){function e(){u.hoverState!="in"&&r.detach();u.$element.removeAttr("aria-describedby").trigger("hidden.bs."+u.type);i&&i();}var u=this,r=n(this.$tip),f=n.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),this.hoverState=null,this;};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","");};t.prototype.hasContent=function(){return this.getTitle();};t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r=u.tagName=="BODY",i=u.getBoundingClientRect();i.width==null&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var f=r?{top:0,left:0}:t.offset(),e={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},i,e,o,f);};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width};};t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.right&&(f.left=u.left+u.width-c)),f):f;};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);};t.prototype.getUID=function(n){do{n+=~~(Math.random()*1e6);}while(document.getElementById(n));return n;};t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),this.$tip.length!=1))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip;};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow");};t.prototype.enable=function(){this.enabled=!0;};t.prototype.disable=function(){this.enabled=!1;};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled;};t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)));t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i);};t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout);this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type);n.$tip&&n.$tip.detach();n.$tip=null;n.$arrow=null;n.$viewport=null;});};i=n.fn.tooltip;n.fn.tooltip=r;n.fn.tooltip.Constructor=t;n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this;};}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.popover",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t6){this.init("popover",n,_t6);},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.5";t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'});t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype);t.prototype.constructor=t;t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.setContent=function(){var n=this.tip(),i=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](i);n.find(".popover-content").children().detach().end()[this.options.html?typeof t=="string"?"html":"append":"text"](t);n.removeClass("fade top bottom left right in");n.find(".popover-title").html()||n.find(".popover-title").hide();};t.prototype.hasContent=function(){return this.getTitle()||this.getContent();};t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content);};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow");};i=n.fn.popover;n.fn.popover=r;n.fn.popover.Constructor=t;n.fn.popover.noConflict=function(){return n.fn.popover=i,this;};}(jQuery);+function(n){"use strict";function t(i,r){this.$body=n(document.body);this.$scrollElement=n(i).is(document.body)?n(window):n(i);this.options=n.extend({},t.DEFAULTS,r);this.selector=(this.options.target||"")+" .nav li > a";this.offsets=[];this.targets=[];this.activeTarget=null;this.scrollHeight=0;this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this));this.refresh();this.process();}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.scrollspy",r=new t(this,f));typeof i=="string"&&r[i]();});}t.VERSION="3.3.5";t.DEFAULTS={offset:10};t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight);};t.prototype.refresh=function(){var t=this,i="offset",r=0;this.offsets=[];this.targets=[];this.scrollHeight=this.getScrollHeight();n.isWindow(this.$scrollElement[0])||(i="position",r=this.$scrollElement.scrollTop());this.$body.find(this.selector).map(function(){var f=n(this),u=f.data("target")||f.attr("href"),t=/^#./.test(u)&&n(u);return t&&t.length&&t.is(":visible")&&[[t[i]().top+r,u]]||null;}).sort(function(n,t){return n[0]-t[0];}).each(function(){t.offsets.push(this[0]);t.targets.push(this[1]);});};t.prototype.process=function(){var i=this.$scrollElement.scrollTop()+this.options.offset,f=this.getScrollHeight(),e=this.options.offset+f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget,n;if(this.scrollHeight!=f&&this.refresh(),i>=e)return u!=(n=r[r.length-1])&&this.activate(n);if(u&&i<t[0])return this.activeTarget=null,this.clear();for(n=t.length;n--;){u!=r[n]&&i>=t[n]&&(t[n+1]===undefined||i<t[n+1])&&this.activate(r[n]);}};t.prototype.activate=function(t){this.activeTarget=t;this.clear();var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active"));i.trigger("activate.bs.scrollspy");};t.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active");};var r=n.fn.scrollspy;n.fn.scrollspy=i;n.fn.scrollspy.Constructor=t;n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=r,this;};n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this));typeof i=="string"&&r[i]();});}var t=function t(_t7){this.element=n(_t7);},u,i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.show=function(){var t=this.element,f=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),u;if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=f.find(".active:last a"),e=n.Event("hide.bs.tab",{relatedTarget:t[0]}),o=n.Event("show.bs.tab",{relatedTarget:r[0]});(r.trigger(e),t.trigger(o),o.isDefaultPrevented()||e.isDefaultPrevented())||(u=n(i),this.activate(t.closest("li"),f),this.activate(u,u.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]});t.trigger({type:"shown.bs.tab",relatedTarget:r[0]});}));}};t.prototype.activate=function(i,r,u){function o(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1);i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0);e?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade");i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0);u&&u();}var f=r.find("> .active"),e=u&&n.support.transition&&(f.length&&f.hasClass("fade")||!!r.find("> .fade").length);f.length&&e?f.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o();f.removeClass("in");};u=n.fn.tab;n.fn.tab=r;n.fn.tab.Constructor=t;n.fn.tab.noConflict=function(){return n.fn.tab=u,this;};i=function i(t){t.preventDefault();r.call(n(this),"show");};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition();},r;t.VERSION="3.3.5";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1;};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n;};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1);};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if((typeof r==="undefined"?"undefined":_typeof(r))!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix");}i=="bottom"&&this.$element.offset({top:h-s-u});}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this;};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t);});});}(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(c){function f(){return new Date(Date.UTC.apply(Date,arguments));}function a(){var g=new Date();return f(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),0);}var e=function e(h,g){var i=this;this.element=c(h);this.container=g.container||"body";this.language=g.language||this.element.data("date-language")||"en";this.language=this.language in d?this.language:"en";this.isRTL=d[this.language].rtl||false;this.formatType=g.formatType||this.element.data("format-type")||"standard";this.format=b.parseFormat(g.format||this.element.data("date-format")||d[this.language].format||b.getDefaultFormat(this.formatType,"input"),this.formatType);this.isInline=false;this.isVisible=false;this.isInput=this.element.is("input");this.bootcssVer=this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2;this.component=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar").parent():false;this.componentReset=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-remove").parent():this.element.find(".add-on .icon-remove").parent():false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false;}this.linkField=g.linkField||this.element.data("link-field")||false;this.linkFormat=b.parseFormat(g.linkFormat||this.element.data("link-format")||b.getDefaultFormat(this.formatType,"link"),this.formatType);this.minuteStep=g.minuteStep||this.element.data("minute-step")||5;this.pickerPosition=g.pickerPosition||this.element.data("picker-position")||"bottom-right";this.showMeridian=g.showMeridian||this.element.data("show-meridian")||false;this.initialDate=g.initialDate||new Date();this._attachEvents();this.formatViewType="datetime";if("formatViewType"in g){this.formatViewType=g.formatViewType;}else{if("formatViewType"in this.element.data()){this.formatViewType=this.element.data("formatViewType");}}this.minView=0;if("minView"in g){this.minView=g.minView;}else{if("minView"in this.element.data()){this.minView=this.element.data("min-view");}}this.minView=b.convertViewMode(this.minView);this.maxView=b.modes.length-1;if("maxView"in g){this.maxView=g.maxView;}else{if("maxView"in this.element.data()){this.maxView=this.element.data("max-view");}}this.maxView=b.convertViewMode(this.maxView);this.wheelViewModeNavigation=false;if("wheelViewModeNavigation"in g){this.wheelViewModeNavigation=g.wheelViewModeNavigation;}else{if("wheelViewModeNavigation"in this.element.data()){this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation");}}this.wheelViewModeNavigationInverseDirection=false;if("wheelViewModeNavigationInverseDirection"in g){this.wheelViewModeNavigationInverseDirection=g.wheelViewModeNavigationInverseDirection;}else{if("wheelViewModeNavigationInverseDirection"in this.element.data()){this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir");}}this.wheelViewModeNavigationDelay=100;if("wheelViewModeNavigationDelay"in g){this.wheelViewModeNavigationDelay=g.wheelViewModeNavigationDelay;}else{if("wheelViewModeNavigationDelay"in this.element.data()){this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay");}}this.startViewMode=2;if("startView"in g){this.startViewMode=g.startView;}else{if("startView"in this.element.data()){this.startViewMode=this.element.data("start-view");}}this.startViewMode=b.convertViewMode(this.startViewMode);this.viewMode=this.startViewMode;this.viewSelect=this.minView;if("viewSelect"in g){this.viewSelect=g.viewSelect;}else{if("viewSelect"in this.element.data()){this.viewSelect=this.element.data("view-select");}}this.viewSelect=b.convertViewMode(this.viewSelect);this.forceParse=true;if("forceParse"in g){this.forceParse=g.forceParse;}else{if("dateForceParse"in this.element.data()){this.forceParse=this.element.data("date-force-parse");}}this.picker=c(this.bootcssVer==3?b.templateV3:b.template).appendTo(this.isInline?this.element:this.container).on({click:c.proxy(this.click,this),mousedown:c.proxy(this.mousedown,this)});if(this.wheelViewModeNavigation){if(c.fn.mousewheel){this.picker.on({mousewheel:c.proxy(this.mousewheel,this)});}else{console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option");}}if(this.isInline){this.picker.addClass("datetimepicker-inline");}else{this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu");}if(this.isRTL){this.picker.addClass("datetimepicker-rtl");if(this.bootcssVer==3){this.picker.find(".prev span, .next span").toggleClass("glyphicon-arrow-left glyphicon-arrow-right");}else{this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right");}}c(document).on("mousedown",function(j){if(c(j.target).closest(".datetimepicker").length===0){i.hide();}});this.autoclose=false;if("autoclose"in g){this.autoclose=g.autoclose;}else{if("dateAutoclose"in this.element.data()){this.autoclose=this.element.data("date-autoclose");}}this.keyboardNavigation=true;if("keyboardNavigation"in g){this.keyboardNavigation=g.keyboardNavigation;}else{if("dateKeyboardNavigation"in this.element.data()){this.keyboardNavigation=this.element.data("date-keyboard-navigation");}}this.todayBtn=g.todayBtn||this.element.data("date-today-btn")||false;this.todayHighlight=g.todayHighlight||this.element.data("date-today-highlight")||false;this.weekStart=(g.weekStart||this.element.data("date-weekstart")||d[this.language].weekStart||0)%7;this.weekEnd=(this.weekStart+6)%7;this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(g.startDate||this.element.data("date-startdate"));this.setEndDate(g.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(g.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show();}};e.prototype={constructor:e,_events:[],_attachEvents:function _attachEvents(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:c.proxy(this.show,this),keyup:c.proxy(this.update,this),keydown:c.proxy(this.keydown,this)}]];}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:c.proxy(this.show,this),keyup:c.proxy(this.update,this),keydown:c.proxy(this.keydown,this)}],[this.component,{click:c.proxy(this.show,this)}]];if(this.componentReset){this._events.push([this.componentReset,{click:c.proxy(this.reset,this)}]);}}else{if(this.element.is("div")){this.isInline=true;}else{this._events=[[this.element,{click:c.proxy(this.show,this)}]];}}}for(var g=0,h,j;g<this._events.length;g++){h=this._events[g][0];j=this._events[g][1];h.on(j);}},_detachEvents:function _detachEvents(){for(var g=0,h,j;g<this._events.length;g++){h=this._events[g][0];j=this._events[g][1];h.off(j);}this._events=[];},show:function show(g){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();if(this.forceParse){this.update();}this.place();c(window).on("resize",c.proxy(this.place,this));if(g){g.stopPropagation();g.preventDefault();}this.isVisible=true;this.element.trigger({type:"show",date:this.date});},hide:function hide(g){if(!this.isVisible){return;}if(this.isInline){return;}this.picker.hide();c(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){c(document).off("mousedown",this.hide);}if(this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())){this.setValue();}this.isVisible=false;this.element.trigger({type:"hide",date:this.date});},remove:function remove(){this._detachEvents();this.picker.remove();delete this.picker;delete this.element.data().datetimepicker;},getDate:function getDate(){var g=this.getUTCDate();return new Date(g.getTime()+g.getTimezoneOffset()*60000);},getUTCDate:function getUTCDate(){return this.date;},setDate:function setDate(g){this.setUTCDate(new Date(g.getTime()-g.getTimezoneOffset()*60000));},setUTCDate:function setUTCDate(g){if(g>=this.startDate&&g<=this.endDate){this.date=g;this.setValue();this.viewDate=this.date;this.fill();}else{this.element.trigger({type:"outOfRange",date:g,startDate:this.startDate,endDate:this.endDate});}},setFormat:function setFormat(h){this.format=b.parseFormat(h,this.formatType);var g;if(this.isInput){g=this.element;}else{if(this.component){g=this.element.find("input");}}if(g&&g.val()){this.setValue();}},setValue:function setValue(){var g=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(g);}this.element.data("date",g);}else{this.element.val(g);}if(this.linkField){c("#"+this.linkField).val(this.getFormattedDate(this.linkFormat));}},getFormattedDate:function getFormattedDate(g){if(g==undefined){g=this.format;}return b.formatDate(this.date,g,this.language,this.formatType);},setStartDate:function setStartDate(g){this.startDate=g||-Infinity;if(this.startDate!==-Infinity){this.startDate=b.parseDate(this.startDate,this.format,this.language,this.formatType);}this.update();this.updateNavArrows();},setEndDate:function setEndDate(g){this.endDate=g||Infinity;if(this.endDate!==Infinity){this.endDate=b.parseDate(this.endDate,this.format,this.language,this.formatType);}this.update();this.updateNavArrows();},setDaysOfWeekDisabled:function setDaysOfWeekDisabled(g){this.daysOfWeekDisabled=g||[];if(!c.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/);}this.daysOfWeekDisabled=c.map(this.daysOfWeekDisabled,function(h){return parseInt(h,10);});this.update();this.updateNavArrows();},place:function place(){if(this.isInline){return;}var g=0;c("div").each(function(){var m=parseInt(c(this).css("zIndex"),10);if(m>g){g=m;}});var l=g+10;var k,j,i,h;if(this.container instanceof c){h=this.container.offset();}else{h=c(this.container).offset();}if(this.component){k=this.component.offset();i=k.left;if(this.pickerPosition=="bottom-left"||this.pickerPosition=="top-left"){i+=this.component.outerWidth()-this.picker.outerWidth();}}else{k=this.element.offset();i=k.left;}if(i+220>document.body.clientWidth){i=document.body.clientWidth-220;}if(this.pickerPosition=="top-left"||this.pickerPosition=="top-right"){j=k.top-this.picker.outerHeight();}else{j=k.top+this.height;}j=j-h.top;i=i-h.left;this.picker.css({top:j,left:i,zIndex:l});},update:function update(){var g,h=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0]instanceof Date)){g=arguments[0];h=true;}else{g=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate;if(typeof g=="string"||g instanceof String){g=g.replace(/^\s+|\s+$/g,"");}}if(!g){g=new Date();h=false;}this.date=b.parseDate(g,this.format,this.language,this.formatType);if(h){this.setValue();}if(this.date<this.startDate){this.viewDate=new Date(this.startDate);}else{if(this.date>this.endDate){this.viewDate=new Date(this.endDate);}else{this.viewDate=new Date(this.date);}}this.fill();},fillDow:function fillDow(){var g=this.weekStart,h="<tr>";while(g<this.weekStart+7){h+='<th class="dow">'+d[this.language].daysMin[g++%7]+"</th>";}h+="</tr>";this.picker.find(".datetimepicker-days thead").append(h);},fillMonths:function fillMonths(){var h="",g=0;while(g<12){h+='<span class="month">'+d[this.language].monthsShort[g++]+"</span>";}this.picker.find(".datetimepicker-months td").html(h);},fill:function fill(){if(this.date==null||this.viewDate==null){return;}var E=new Date(this.viewDate),q=E.getUTCFullYear(),F=E.getUTCMonth(),j=E.getUTCDate(),z=E.getUTCHours(),u=E.getUTCMinutes(),v=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,A=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,l=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,w=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,n=new f(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),D=new Date();this.picker.find(".datetimepicker-days thead th:eq(1)").text(d[this.language].months[F]+" "+q);if(this.formatViewType=="time"){var B=z%12?z%12:12;var h=(B<10?"0":"")+B;var m=(u<10?"0":"")+u;var H=d[this.language].meridiem[z<12?0:1];this.picker.find(".datetimepicker-hours thead th:eq(1)").text(h+":"+m+" "+(H?H.toUpperCase():""));this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(h+":"+m+" "+(H?H.toUpperCase():""));}else{this.picker.find(".datetimepicker-hours thead th:eq(1)").text(j+" "+d[this.language].months[F]+" "+q);this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(j+" "+d[this.language].months[F]+" "+q);}this.picker.find("tfoot th.today").text(d[this.language].today).toggle(this.todayBtn!==false);this.updateNavArrows();this.fillMonths();var I=f(q,F-1,28,0,0,0,0),y=b.getDaysInMonth(I.getUTCFullYear(),I.getUTCMonth());I.setUTCDate(y);I.setUTCDate(y-(I.getUTCDay()-this.weekStart+7)%7);var g=new Date(I);g.setUTCDate(g.getUTCDate()+42);g=g.valueOf();var o=[];var r;while(I.valueOf()<g){if(I.getUTCDay()==this.weekStart){o.push("<tr>");}r="";if(I.getUTCFullYear()<q||I.getUTCFullYear()==q&&I.getUTCMonth()<F){r+=" old";}else{if(I.getUTCFullYear()>q||I.getUTCFullYear()==q&&I.getUTCMonth()>F){r+=" new";}}if(this.todayHighlight&&I.getUTCFullYear()==D.getFullYear()&&I.getUTCMonth()==D.getMonth()&&I.getUTCDate()==D.getDate()){r+=" today";}if(I.valueOf()==n){r+=" active";}if(I.valueOf()+86400000<=this.startDate||I.valueOf()>this.endDate||c.inArray(I.getUTCDay(),this.daysOfWeekDisabled)!==-1){r+=" disabled";}o.push('<td class="day'+r+'">'+I.getUTCDate()+"</td>");if(I.getUTCDay()==this.weekEnd){o.push("</tr>");}I.setUTCDate(I.getUTCDate()+1);}this.picker.find(".datetimepicker-days tbody").empty().append(o.join(""));o=[];var s="",C="",p="";for(var x=0;x<24;x++){var t=f(q,F,j,x);r="";if(t.valueOf()+3600000<=this.startDate||t.valueOf()>this.endDate){r+=" disabled";}else{if(z==x){r+=" active";}}if(this.showMeridian&&d[this.language].meridiem.length==2){C=x<12?d[this.language].meridiem[0]:d[this.language].meridiem[1];if(C!=p){if(p!=""){o.push("</fieldset>");}o.push('<fieldset class="hour"><legend>'+C.toUpperCase()+"</legend>");}p=C;s=x%12?x%12:12;o.push('<span class="hour'+r+" hour_"+(x<12?"am":"pm")+'">'+s+"</span>");if(x==23){o.push("</fieldset>");}}else{s=x+":00";o.push('<span class="hour'+r+'">'+s+"</span>");}}this.picker.find(".datetimepicker-hours td").html(o.join(""));o=[];s="",C="",p="";for(var x=0;x<60;x+=this.minuteStep){var t=f(q,F,j,z,x,0);r="";if(t.valueOf()<this.startDate||t.valueOf()>this.endDate){r+=" disabled";}else{if(Math.floor(u/this.minuteStep)==Math.floor(x/this.minuteStep)){r+=" active";}}if(this.showMeridian&&d[this.language].meridiem.length==2){C=z<12?d[this.language].meridiem[0]:d[this.language].meridiem[1];if(C!=p){if(p!=""){o.push("</fieldset>");}o.push('<fieldset class="minute"><legend>'+C.toUpperCase()+"</legend>");}p=C;s=z%12?z%12:12;o.push('<span class="minute'+r+'">'+s+":"+(x<10?"0"+x:x)+"</span>");if(x==59){o.push("</fieldset>");}}else{s=x+":00";o.push('<span class="minute'+r+'">'+z+":"+(x<10?"0"+x:x)+"</span>");}}this.picker.find(".datetimepicker-minutes td").html(o.join(""));var J=this.date.getUTCFullYear();var k=this.picker.find(".datetimepicker-months").find("th:eq(1)").text(q).end().find("span").removeClass("active");if(J==q){k.eq(this.date.getUTCMonth()).addClass("active");}if(q<v||q>l){k.addClass("disabled");}if(q==v){k.slice(0,A).addClass("disabled");}if(q==l){k.slice(w+1).addClass("disabled");}o="";q=parseInt(q/10,10)*10;var G=this.picker.find(".datetimepicker-years").find("th:eq(1)").text(q+"-"+(q+9)).end().find("td");q-=1;for(var x=-1;x<11;x++){o+='<span class="year'+(x==-1||x==10?" old":"")+(J==q?" active":"")+(q<v||q>l?" disabled":"")+'">'+q+"</span>";q+=1;}G.html(o);this.place();},updateNavArrows:function updateNavArrows(){var k=new Date(this.viewDate),i=k.getUTCFullYear(),j=k.getUTCMonth(),h=k.getUTCDate(),g=k.getUTCHours();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&i<=this.startDate.getUTCFullYear()&&j<=this.startDate.getUTCMonth()&&h<=this.startDate.getUTCDate()&&g<=this.startDate.getUTCHours()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&i>=this.endDate.getUTCFullYear()&&j>=this.endDate.getUTCMonth()&&h>=this.endDate.getUTCDate()&&g>=this.endDate.getUTCHours()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;case 1:if(this.startDate!==-Infinity&&i<=this.startDate.getUTCFullYear()&&j<=this.startDate.getUTCMonth()&&h<=this.startDate.getUTCDate()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&i>=this.endDate.getUTCFullYear()&&j>=this.endDate.getUTCMonth()&&h>=this.endDate.getUTCDate()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;case 2:if(this.startDate!==-Infinity&&i<=this.startDate.getUTCFullYear()&&j<=this.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&i>=this.endDate.getUTCFullYear()&&j>=this.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;case 3:case 4:if(this.startDate!==-Infinity&&i<=this.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&i>=this.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;}},mousewheel:function mousewheel(h){h.preventDefault();h.stopPropagation();if(this.wheelPause){return;}this.wheelPause=true;var g=h.originalEvent;var j=g.wheelDelta;var i=j>0?1:j===0?0:-1;if(this.wheelViewModeNavigationInverseDirection){i=-i;}this.showMode(i);setTimeout(c.proxy(function(){this.wheelPause=false;},this),this.wheelViewModeNavigationDelay);},click:function click(k){k.stopPropagation();k.preventDefault();var l=c(k.target).closest("span, td, th, legend");if(l.length==1){if(l.is(".disabled")){this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});return;}switch(l[0].nodeName.toLowerCase()){case"th":switch(l[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var g=b.modes[this.viewMode].navStep*(l[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,g);break;case 1:this.viewDate=this.moveDate(this.viewDate,g);break;case 2:this.viewDate=this.moveMonth(this.viewDate,g);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,g);break;}this.fill();this.element.trigger({type:l[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"today":var h=new Date();h=f(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),0);if(h<this.startDate){h=this.startDate;}else{if(h>this.endDate){h=this.endDate;}}this.viewMode=this.startViewMode;this.showMode(0);this._setDate(h);this.fill();if(this.autoclose){this.hide();}break;}break;case"span":if(!l.is(".disabled")){var n=this.viewDate.getUTCFullYear(),m=this.viewDate.getUTCMonth(),o=this.viewDate.getUTCDate(),p=this.viewDate.getUTCHours(),i=this.viewDate.getUTCMinutes(),q=this.viewDate.getUTCSeconds();if(l.is(".month")){this.viewDate.setUTCDate(1);m=l.parent().find("span").index(l);o=this.viewDate.getUTCDate();this.viewDate.setUTCMonth(m);this.element.trigger({type:"changeMonth",date:this.viewDate});if(this.viewSelect>=3){this._setDate(f(n,m,o,p,i,q,0));}}else{if(l.is(".year")){this.viewDate.setUTCDate(1);n=parseInt(l.text(),10)||0;this.viewDate.setUTCFullYear(n);this.element.trigger({type:"changeYear",date:this.viewDate});if(this.viewSelect>=4){this._setDate(f(n,m,o,p,i,q,0));}}else{if(l.is(".hour")){p=parseInt(l.text(),10)||0;if(l.hasClass("hour_am")||l.hasClass("hour_pm")){if(p==12&&l.hasClass("hour_am")){p=0;}else{if(p!=12&&l.hasClass("hour_pm")){p+=12;}}}this.viewDate.setUTCHours(p);this.element.trigger({type:"changeHour",date:this.viewDate});if(this.viewSelect>=1){this._setDate(f(n,m,o,p,i,q,0));}}else{if(l.is(".minute")){i=parseInt(l.text().substr(l.text().indexOf(":")+1),10)||0;this.viewDate.setUTCMinutes(i);this.element.trigger({type:"changeMinute",date:this.viewDate});if(this.viewSelect>=0){this._setDate(f(n,m,o,p,i,q,0));}}}}}if(this.viewMode!=0){var j=this.viewMode;this.showMode(-1);this.fill();if(j==this.viewMode&&this.autoclose){this.hide();}}else{this.fill();if(this.autoclose){this.hide();}}}break;case"td":if(l.is(".day")&&!l.is(".disabled")){var o=parseInt(l.text(),10)||1;var n=this.viewDate.getUTCFullYear(),m=this.viewDate.getUTCMonth(),p=this.viewDate.getUTCHours(),i=this.viewDate.getUTCMinutes(),q=this.viewDate.getUTCSeconds();if(l.is(".old")){if(m===0){m=11;n-=1;}else{m-=1;}}else{if(l.is(".new")){if(m==11){m=0;n+=1;}else{m+=1;}}}this.viewDate.setUTCFullYear(n);this.viewDate.setUTCMonth(m,o);this.element.trigger({type:"changeDay",date:this.viewDate});if(this.viewSelect>=2){this._setDate(f(n,m,o,p,i,q,0));}}var j=this.viewMode;this.showMode(-1);this.fill();if(j==this.viewMode&&this.autoclose){this.hide();}break;}}},_setDate:function _setDate(g,i){if(!i||i=="date"){this.date=g;}if(!i||i=="view"){this.viewDate=g;}this.fill();this.setValue();var h;if(this.isInput){h=this.element;}else{if(this.component){h=this.element.find("input");}}if(h){h.change();if(this.autoclose&&(!i||i=="date")){}}this.element.trigger({type:"changeDate",date:this.date});},moveMinute:function moveMinute(h,g){if(!g){return h;}var i=new Date(h.valueOf());i.setUTCMinutes(i.getUTCMinutes()+g*this.minuteStep);return i;},moveHour:function moveHour(h,g){if(!g){return h;}var i=new Date(h.valueOf());i.setUTCHours(i.getUTCHours()+g);return i;},moveDate:function moveDate(h,g){if(!g){return h;}var i=new Date(h.valueOf());i.setUTCDate(i.getUTCDate()+g);return i;},moveMonth:function moveMonth(g,h){if(!h){return g;}var l=new Date(g.valueOf()),p=l.getUTCDate(),m=l.getUTCMonth(),k=Math.abs(h),o,n;h=h>0?1:-1;if(k==1){n=h==-1?function(){return l.getUTCMonth()==m;}:function(){return l.getUTCMonth()!=o;};o=m+h;l.setUTCMonth(o);if(o<0||o>11){o=(o+12)%12;}}else{for(var j=0;j<k;j++){l=this.moveMonth(l,h);}o=l.getUTCMonth();l.setUTCDate(p);n=function n(){return o!=l.getUTCMonth();};}while(n()){l.setUTCDate(--p);l.setUTCMonth(o);}return l;},moveYear:function moveYear(h,g){return this.moveMonth(h,g*12);},dateWithinRange:function dateWithinRange(g){return g>=this.startDate&&g<=this.endDate;},keydown:function keydown(k){if(this.picker.is(":not(:visible)")){if(k.keyCode==27){this.show();}return;}var m=false,h,n,l,o,g;switch(k.keyCode){case 27:this.hide();k.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation){break;}h=k.keyCode==37?-1:1;viewMode=this.viewMode;if(k.ctrlKey){viewMode+=2;}else{if(k.shiftKey){viewMode+=1;}}if(viewMode==4){o=this.moveYear(this.date,h);g=this.moveYear(this.viewDate,h);}else{if(viewMode==3){o=this.moveMonth(this.date,h);g=this.moveMonth(this.viewDate,h);}else{if(viewMode==2){o=this.moveDate(this.date,h);g=this.moveDate(this.viewDate,h);}else{if(viewMode==1){o=this.moveHour(this.date,h);g=this.moveHour(this.viewDate,h);}else{if(viewMode==0){o=this.moveMinute(this.date,h);g=this.moveMinute(this.viewDate,h);}}}}}if(this.dateWithinRange(o)){this.date=o;this.viewDate=g;this.setValue();this.update();k.preventDefault();m=true;}break;case 38:case 40:if(!this.keyboardNavigation){break;}h=k.keyCode==38?-1:1;viewMode=this.viewMode;if(k.ctrlKey){viewMode+=2;}else{if(k.shiftKey){viewMode+=1;}}if(viewMode==4){o=this.moveYear(this.date,h);g=this.moveYear(this.viewDate,h);}else{if(viewMode==3){o=this.moveMonth(this.date,h);g=this.moveMonth(this.viewDate,h);}else{if(viewMode==2){o=this.moveDate(this.date,h*7);g=this.moveDate(this.viewDate,h*7);}else{if(viewMode==1){if(this.showMeridian){o=this.moveHour(this.date,h*6);g=this.moveHour(this.viewDate,h*6);}else{o=this.moveHour(this.date,h*4);g=this.moveHour(this.viewDate,h*4);}}else{if(viewMode==0){o=this.moveMinute(this.date,h*4);g=this.moveMinute(this.viewDate,h*4);}}}}}if(this.dateWithinRange(o)){this.date=o;this.viewDate=g;this.setValue();this.update();k.preventDefault();m=true;}break;case 13:if(this.viewMode!=0){var j=this.viewMode;this.showMode(-1);this.fill();if(j==this.viewMode&&this.autoclose){this.hide();}}else{this.fill();if(this.autoclose){this.hide();}}k.preventDefault();break;case 9:this.hide();break;}if(m){var i;if(this.isInput){i=this.element;}else{if(this.component){i=this.element.find("input");}}if(i){i.change();}this.element.trigger({type:"changeDate",date:this.date});}},showMode:function showMode(g){if(g){var h=Math.max(0,Math.min(b.modes.length-1,this.viewMode+g));if(h>=this.minView&&h<=this.maxView){this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:h});this.viewMode=h;}}this.picker.find(">div").hide().filter(".datetimepicker-"+b.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows();},reset:function reset(g){this._setDate(null,"date");},convertViewModeText:function convertViewModeText(g){switch(g){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour";}}};c.fn.datetimepicker=function(i){var g=Array.apply(null,arguments);g.shift();var h;this.each(function(){var l=c(this),k=l.data("datetimepicker"),j=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;if(!k){l.data("datetimepicker",k=new e(this,c.extend({},c.fn.datetimepicker.defaults,j)));}if(typeof i=="string"&&typeof k[i]=="function"){h=k[i].apply(k,g);if(h!==undefined){return false;}}});if(h!==undefined){return h;}else{return this;}};c.fn.datetimepicker.defaults={};c.fn.datetimepicker.Constructor=e;var d=c.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today"}};var b={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function isLeapYear(g){return g%4===0&&g%100!==0||g%400===0;},getDaysInMonth:function getDaysInMonth(g,h){return[31,b.isLeapYear(g)?29:28,31,30,31,30,31,31,30,31,30,31][h];},getDefaultFormat:function getDefaultFormat(g,h){if(g=="standard"){if(h=="input"){return"yyyy-mm-dd hh:ii";}else{return"yyyy-mm-dd hh:ii:ss";}}else{if(g=="php"){if(h=="input"){return"Y-m-d H:i";}else{return"Y-m-d H:i:s";}}else{throw new Error("Invalid format type.");}}},validParts:function validParts(g){if(g=="standard"){return(/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g);}else{if(g=="php"){return(/[dDjlNwzFmMnStyYaABgGhHis]/g);}else{throw new Error("Invalid format type.");}}},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function parseFormat(j,h){var g=j.replace(this.validParts(h),"\0").split("\0"),i=j.match(this.validParts(h));if(!g||!g.length||!i||i.length==0){throw new Error("Invalid date format.");}return{separators:g,parts:i};},parseDate:function parseDate(l,u,o,r){if(l instanceof Date){var w=new Date(l.valueOf()-l.getTimezoneOffset()*60000);w.setMilliseconds(0);return w;}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(l)){u=this.parseFormat("yyyy-mm-dd",r);}if(/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(l)){u=this.parseFormat("yyyy-mm-dd hh:ii",r);}if(/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(l)){u=this.parseFormat("yyyy-mm-dd hh:ii:ss",r);}if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(l)){var x=/([-+]\d+)([dmwy])/,m=l.match(/([-+]\d+)([dmwy])/g),g,k;l=new Date();for(var n=0;n<m.length;n++){g=x.exec(m[n]);k=parseInt(g[1]);switch(g[2]){case"d":l.setUTCDate(l.getUTCDate()+k);break;case"m":l=e.prototype.moveMonth.call(e.prototype,l,k);break;case"w":l.setUTCDate(l.getUTCDate()+k*7);break;case"y":l=e.prototype.moveYear.call(e.prototype,l,k);break;}}return f(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),0);}var m=l&&l.match(this.nonpunctuation)||[],l=new Date(0,0,0,0,0,0,0),q={},t=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P"],v={hh:function hh(s,i){return s.setUTCHours(i);},h:function h(s,i){return s.setUTCHours(i);},HH:function HH(s,i){return s.setUTCHours(i==12?0:i);},H:function H(s,i){return s.setUTCHours(i==12?0:i);},ii:function ii(s,i){return s.setUTCMinutes(i);},i:function i(s,_i){return s.setUTCMinutes(_i);},ss:function ss(s,i){return s.setUTCSeconds(i);},s:function s(_s,i){return _s.setUTCSeconds(i);},yyyy:function yyyy(s,i){return s.setUTCFullYear(i);},yy:function yy(s,i){return s.setUTCFullYear(2000+i);},m:function m(s,i){i-=1;while(i<0){i+=12;}i%=12;s.setUTCMonth(i);while(s.getUTCMonth()!=i){if(isNaN(s.getUTCMonth())){return s;}else{s.setUTCDate(s.getUTCDate()-1);}}return s;},d:function d(s,i){return s.setUTCDate(i);},p:function p(s,i){return s.setUTCHours(i==1?s.getUTCHours()+12:s.getUTCHours());}},j,p,g;v.M=v.MM=v.mm=v.m;v.dd=v.d;v.P=v.p;l=f(l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds());if(m.length==u.parts.length){for(var n=0,h=u.parts.length;n<h;n++){j=parseInt(m[n],10);g=u.parts[n];if(isNaN(j)){switch(g){case"MM":p=c(d[o].months).filter(function(){var i=this.slice(0,m[n].length),s=m[n].slice(0,i.length);return i==s;});j=c.inArray(p[0],d[o].months)+1;break;case"M":p=c(d[o].monthsShort).filter(function(){var i=this.slice(0,m[n].length),s=m[n].slice(0,i.length);return i.toLowerCase()==s.toLowerCase();});j=c.inArray(p[0],d[o].monthsShort)+1;break;case"p":case"P":j=c.inArray(m[n].toLowerCase(),d[o].meridiem);break;}}q[g]=j;}for(var n=0,y;n<t.length;n++){y=t[n];if(y in q&&!isNaN(q[y])){v[y](l,q[y]);}}}return l;},formatDate:function formatDate(g,m,o,k){if(g==null){return"";}var n;if(k=="standard"){n={yy:g.getUTCFullYear().toString().substring(2),yyyy:g.getUTCFullYear(),m:g.getUTCMonth()+1,M:d[o].monthsShort[g.getUTCMonth()],MM:d[o].months[g.getUTCMonth()],d:g.getUTCDate(),D:d[o].daysShort[g.getUTCDay()],DD:d[o].days[g.getUTCDay()],p:d[o].meridiem.length==2?d[o].meridiem[g.getUTCHours()<12?0:1]:"",h:g.getUTCHours(),i:g.getUTCMinutes(),s:g.getUTCSeconds()};if(d[o].meridiem.length==2){n.H=n.h%12==0?12:n.h%12;}else{n.H=n.h;}n.HH=(n.H<10?"0":"")+n.H;n.P=n.p.toUpperCase();n.hh=(n.h<10?"0":"")+n.h;n.ii=(n.i<10?"0":"")+n.i;n.ss=(n.s<10?"0":"")+n.s;n.dd=(n.d<10?"0":"")+n.d;n.mm=(n.m<10?"0":"")+n.m;}else{if(k=="php"){n={y:g.getUTCFullYear().toString().substring(2),Y:g.getUTCFullYear(),F:d[o].months[g.getUTCMonth()],M:d[o].monthsShort[g.getUTCMonth()],n:g.getUTCMonth()+1,t:b.getDaysInMonth(g.getUTCFullYear(),g.getUTCMonth()),j:g.getUTCDate(),l:d[o].days[g.getUTCDay()],D:d[o].daysShort[g.getUTCDay()],w:g.getUTCDay(),N:g.getUTCDay()==0?7:g.getUTCDay(),S:g.getUTCDate()%10<=d[o].suffix.length?d[o].suffix[g.getUTCDate()%10-1]:"",a:d[o].meridiem.length==2?d[o].meridiem[g.getUTCHours()<12?0:1]:"",g:g.getUTCHours()%12==0?12:g.getUTCHours()%12,G:g.getUTCHours(),i:g.getUTCMinutes(),s:g.getUTCSeconds()};n.m=(n.n<10?"0":"")+n.n;n.d=(n.j<10?"0":"")+n.j;n.A=n.a.toString().toUpperCase();n.h=(n.g<10?"0":"")+n.g;n.H=(n.G<10?"0":"")+n.G;n.i=(n.i<10?"0":"")+n.i;n.s=(n.s<10?"0":"")+n.s;}else{throw new Error("Invalid format type.");}}var g=[],l=c.extend([],m.separators);for(var j=0,h=m.parts.length;j<h;j++){if(l.length){g.push(l.shift());}g.push(n[m.parts[j]]);}if(l.length){g.push(l.shift());}return g.join("");},convertViewMode:function convertViewMode(g){switch(g){case 4:case"decade":g=4;break;case 3:case"year":g=3;break;case 2:case"month":g=2;break;case 1:case"day":g=1;break;case 0:case"hour":g=0;break;}return g;},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};b.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+b.headTemplate+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+b.headTemplate+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+b.headTemplate+"<tbody></tbody>"+b.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+b.headTemplate+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+b.headTemplate+b.contTemplate+b.footTemplate+"</table></div></div>";b.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+b.headTemplateV3+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+b.headTemplateV3+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+b.headTemplateV3+"<tbody></tbody>"+b.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+b.headTemplateV3+b.contTemplate+b.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+b.headTemplateV3+b.contTemplate+b.footTemplate+"</table></div></div>";c.fn.datetimepicker.DPGlobal=b;c.fn.datetimepicker.noConflict=function(){c.fn.datetimepicker=old;return this;};c(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(h){var g=c(this);if(g.data("datetimepicker")){return;}h.preventDefault();g.datetimepicker("show");});c(function(){c('[data-provide="datetimepicker-inline"]').datetimepicker();});}(window.jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function($){var patterns={num_01:/^[0|1]*$/,num_02:/^[0-2]*$/,num_03:/^[0-3]*$/,num_19:/^[1-9]*$/,num_09:/^[0-9]*$/,num_08:/^[0-8]*$/,num_05:/^[0-5]*$/};var regDate=new RegExp('(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})(-|/|.)(((0[13578]|1[02])(-|/|.)(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)(-|/|.)(0[1-9]|[12][0-9]|30))|(02(-|/|.)(0[1-9]|[1][0-9]|2[0-8]))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00))(-|/|.)02(-|/|.)29)');var regDateYM=new RegExp('(([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})(-|/|.)(((0[13578]|1[02]))|((0[469]|11))))|((([0-9]{2})(0[48]|[2468][048]|[13579][26])|((0[48]|[2468][048]|[3579][26])00)))');var regTime=/^(?:[01]\d|2[0-3])(?::[0-5]\d)$/;var arrKW=['y','M','d','H','m','h','i'];var _this;var InputDatetime=function InputDatetime(input,$dtp){this.input=input;this.$dtp=$dtp;_this=this;_this.input.pos=0;if(input.dataset.format)this.attachEvents();};InputDatetime.prototype={constructor:InputDatetime,init:function init(){},remove:function remove(){this.$dtp.datetimepicker('remove');},_events:[],attachEvents:function attachEvents(){this._detachEvents();this._events=[[this.input,{keydown:$.proxy(this.keydown,this),focus:$.proxy(this.focus,this),click:$.proxy(this.click,this),blur:$.proxy(this.blur,this),input:$.proxy(this.oninput,this),change:$.proxy(this.change,this)}]];for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];$(el).on(ev);}},_detachEvents:function _detachEvents(){for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];$(el).off(ev);}
this._events=[];},oninput:function oninput(e){var inputVal=this.input.value;if(inputVal.length>this.input.dataset.format.length){$(this.input).val($(this.input).data('oldVal'));this.input.selectionStart=this.input.selectionEnd=this.input.pos;}},change:function change(){if(this.input.dataset.format==='yyyy-mm-dd hh'){this.input.value=this.input.value+':00';}},keydown:function keydown(e){var keyCode=e.which;var inputVal=this.input.value;var _that=this;$(this.input).popover('hide');if(keyCode>=48&&keyCode<=57)dealWithKey();if(keyCode>=96&&keyCode<=105)dealWithNumKey();if(keyCode==8||keyCode==46||keyCode==37||keyCode==39)dealWithDelete();return false;function dealWithKey(){var strPosF,strPosFNext,strKey,isMatch=false,strPrev,dIndex,month,strDate,dateTemp;if(_that.input.pos==_that.input.dataset.format.length)return false;strKey=String.fromCharCode(keyCode);strPosF=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);strPosFNext=_that.input.dataset.format.substring(_that.input.pos+1,_that.input.pos+2);strPrev=inputVal.substring(_that.input.pos-1,_that.input.pos);if(strPosF==='y'){isMatch=true;}else if(strPosF==='d'){dIndex=_that.input.dataset.format.indexOf('dd');month=inputVal.substring(dIndex-3,dIndex-1);if(strPosF==strPosFNext){if(strKey=='0'){isMatch=true;}else{strDate=_that.input.value.substring(0,dIndex)+strKey+'0';}}else{strDate=_that.input.value.substring(0,dIndex+1)+strKey;}
if(isMatch==false){dateTemp=new Date(strDate.replace(/\D/g,'-'));if(dateTemp.toString()==="Invalid Date"){isMatch=false;}else if(month!=dateTemp.getMonth()+1){isMatch=false;}else{isMatch=true;}}}else if(strPosF==='H'||strPosF==='h'){if(strPosF==strPosFNext){isMatch=patterns.num_02.test(strKey);}else{if(strPrev=='0'){isMatch=patterns.num_09.test(strKey);}else if(strPrev=='2'){isMatch=patterns.num_03.test(strKey);}else{isMatch=patterns.num_09.test(strKey);}}}else if(strPosF==='i'){if(strPosF==strPosFNext){isMatch=patterns.num_05.test(strKey);}else{isMatch=patterns.num_09.test(strKey);}}else if(strPosF==='M'||strPosF==='m'){if(strPosF==strPosFNext){isMatch=patterns.num_01.test(strKey);}else{if(strPrev=='0'){isMatch=patterns.num_19.test(strKey);}else if(strPrev=='1'){isMatch=patterns.num_02.test(strKey);}}}
if(isMatch){_that.input.value=inputVal.substring(0,_that.input.pos)+strKey+inputVal.substring(_that.input.pos+1,inputVal.length);$(_that.input).data('oldVal',_that.input.value);_that.input.pos++;var strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);while(strOfPos!=''&&$.inArray(strOfPos,arrKW)<0){_that.input.pos++;strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);}
_this.moveCursor(_that.input);}
return false;}
function dealWithNumKey(){keyCode=keyCode-48;dealWithKey(keyCode);}
function dealWithDelete(){var strOfPos;if(keyCode==8||keyCode==46){if(_that.input.pos==_that.input.dataset.format.length&&keyCode==46)return false;if(_that.input.pos==0&&keyCode==8)return false;if(keyCode==8){_that.input.pos--;strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);while(strOfPos!=''&&$.inArray(strOfPos,arrKW)<0){_that.input.pos--;strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);}
_that.input.value=inputVal.substring(0,_that.input.pos)+strOfPos+inputVal.substring(_that.input.pos+1,inputVal.length);$(_that.input).data('oldVal',_that.input.value);}else if(keyCode==46&&/[0-9]/.test(_that.input.value.substring(_that.input.pos))){strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);while(strOfPos!=''&&$.inArray(strOfPos,arrKW)<0){_that.input.pos++;strOfPos=_that.input.dataset.format.substring(_that.input.pos,_that.input.pos+1);}
_that.input.value=inputVal.substring(0,_that.input.pos)+strOfPos+inputVal.substring(_that.input.pos+1,inputVal.length);$(_that.input).data('oldVal',_that.input.value);_that.input.pos++;}}else{if(_that.input.pos==_that.input.dataset.format.length&&keyCode==39)return false;if(_that.input.pos==0&&keyCode==37)return false;if(keyCode==37){_that.input.pos--;}else if(keyCode==39){_that.input.pos++;}}
_this.moveCursor(_that.input);}},focus:function focus(){var inputVal=this.input.value.trim();if(inputVal==''){this.input.value=this.input.dataset.format;$(this.input).data('oldVal',this.input.value);$(this.input).popover({placement:'bottom',content:'',trigger:'focus'});}else{if(inputVal!==this.input.dataset.format&&!_this.isMatchReg(inputVal,this.input.dataset.format)){$(this.input).popover('show');}else{$(this.input).popover('hide');}}
_this.moveCursor(this.input);},moveCursor:function moveCursor(input){setTimeout(function(){input.selectionStart=input.selectionEnd=input.pos;},50);},isMatchReg:function isMatchReg(inputVal,format){var isNotShow=false;if(/^(HH|hh):ii$/.test(format)){isNotShow=regTime.test(inputVal);}else if(/ (HH|hh):ii/.test(format)){isNotShow=regDate.test(inputVal.split(' ')[0])&&regTime.test(inputVal.split(' ')[1]);}else if(new RegExp('^yyyy(-|/|.)(mm|MM)$').test(format)){isNotShow=regDateYM.test(inputVal);}else{isNotShow=regDate.test(inputVal);}
return isNotShow;},click:function click(){var strAfterCursor=this.input.value.substring(this.input.pos);if(!/[0-9]/.test(this.input.value)){this.input.selectionStart=this.input.selectionEnd=this.input.pos=0;}else if(!/[0-9]/.test(strAfterCursor)&&strAfterCursor!==''){this.input.selectionStart=this.input.selectionEnd=this.input.pos;}else{this.input.pos=this.input.selectionStart;}},blur:function blur(){var inputVal=this.input.value.trim();if(inputVal!==this.input.dataset.format&&!_this.isMatchReg(inputVal,this.input.dataset.format)&&$('.datetimepicker [class^="datetimepicker-"]').not(':hidden').length<1){$(this.input).css({border:'1px solid #d43f3a'});$(this.input).addClass('timeError');}else{$(this.input).css({border:''});$(this.input).removeClass('timeError');}}};$.fn.datetime=function(option){var format,minView,startView,maxView,btn,optDTP,$dtp,data,internal_return;this.each(function(){var $this=$(this);var input=this.tagName=="INPUT"?this:this.children[0].tagName=="INPUT"?this.children[0]:null;if(!input){console.log('not found input element');return;}
format=input.dataset.format;optDTP={format:format,autoclose:true,initialDate:new Date(),todayBtn:true};if(new RegExp('^yyyy(-|/|.)(mm|MM)(-|/|.)dd(.)* (HH|hh)(:|.)ii').test(format)){startView=4;minView=0;}else if(new RegExp('^yyyy(-|/|.)(mm|MM)(-|/|.)dd(.)* (HH|hh)').test(format)){startView=4;minView=1;}else if(new RegExp('^yyyy(-|/|.)(mm|MM)(-|/|.)dd(.)*').test(format)){startView=4;minView=2;}else if(new RegExp('^yyyy(-|/|.)(mm|MM)').test(format)){startView=4;minView=3;}else if(new RegExp('^(HH|hh):ii').test(format)){startView=maxView=1;minView=0;}
if(minView)optDTP.minView=minView;if(maxView)optDTP.maxView=maxView;if(startView)optDTP.startView=startView;if((typeof option==='undefined'?'undefined':_typeof(option))=='object'&&!$.isEmptyObject(option)){optDTP=$.extend(true,optDTP,option);}
if(input.attributes.datetimepicker){$this.datetimepicker(optDTP);$dtp=$this;}else if(input.nextElementSibling&&input.nextElementSibling.tagName=='SPAN'&&input.nextElementSibling.classList.contains('add-on')){btn=input.nextElementSibling;if(!input.id||input.id.trim()==''){alert('input element must has a id');return;}
optDTP.linkField=input.id;optDTP.linkFormat=format;$(btn).datetimepicker(optDTP);$dtp=$(btn);}
data=$this.data('datetime');if(!data){$this.data('datetime',data=new InputDatetime(input,$dtp));}
if(typeof option=='string'&&typeof data[option]=='function'){internal_return=data[option].apply(data);if(internal_return!==undefined){return false;}}});};})(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(t,e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))?exports.echarts=e():t.echarts=e();}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports;}var i={};return e.m=t,e.c=i,e.p="",e(0);}([function(t,e,i){t.exports=i(1),i(99),i(134),i(139),i(148),i(152),i(162),i(183),i(195),i(216),i(220),i(224),i(239),i(245),i(252),i(258),i(262),i(270),i(112),i(274),i(280),i(284),i(295),i(225),i(298),i(304),i(316),i(317),i(331),i(346),i(352),i(355),i(358),i(367),i(380);},function(t,e,i){function n(t){return function(e,i,n){e=e&&e.toLowerCase(),z.prototype[t].call(this,e,i,n);};}function r(){z.call(this);}function o(t,e,i){function n(t,e){return t.prio-e.prio;}i=i||{},"string"==typeof e&&(e=et[e]),this.id,this.group,this._dom=t,this._zr=D.init(t,{renderer:i.renderer||"canvas",devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height}),this._theme=P.clone(e),this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._api=new b(this),this._coordSysMgr=new w(),z.call(this),this._messageCenter=new r(),this._initEvents(),this.resize=P.bind(this.resize,this),this._pendingActions=[],O(tt,n),O(K,n),this._zr.animation.on("frame",this._onframe,this),window._echartDomZoom=function o(t){var e=$(t).parent();return e.length<1?1:$(t).css("zoom")*o(e);}(t);}function a(t,e,i){var n,r=this._model,o=this._coordSysMgr.getCoordinateSystems();e=C.parseFinder(r,e);for(var a=0;a<o.length;a++){var s=o[a];if(s[t]&&null!=(n=s[t](r,e,i)))return n;}console.warn("No coordinate system that supports "+t+" found by the given finder.");}function s(t,e){var i=this._model;i&&i.eachComponent({mainType:"series",query:e},function(n,r){var o=this._chartsMap[n.__viewId];o&&o.__alive&&o[t](n,i,this._api,e);},this);}function l(t,e,i){var n=this._api;E(this._componentsViews,function(r){var o=r.__model;r[t](o,e,n,i),v(o,r);},this),e.eachSeries(function(r,o){var a=this._chartsMap[r.__viewId];a[t](r,e,n,i),v(r,a),m(r,a);},this),g(this._zr,e);}function u(t,e){for(var i="component"===t,n=i?this._componentsViews:this._chartsViews,r=i?this._componentsMap:this._chartsMap,o=this._zr,a=0;a<n.length;a++){n[a].__alive=!1;}e[i?"eachComponent":"eachSeries"](function(t,a){if(i){if("series"===t)return;}else a=t;var s=a.id+"_"+a.type,l=r[s];if(!l){var u=M.parseClassType(a.type),h=i?T.getClass(u.main,u.sub):A.getClass(u.sub);if(!h)return;l=new h(),l.init(e,this._api),r[s]=l,n.push(l),o.add(l.group);}a.__viewId=s,l.__alive=!0,l.__id=s,l.__model=a;},this);for(var a=0;a<n.length;){var s=n[a];s.__alive?a++:(o.remove(s.group),s.dispose(e,this._api),n.splice(a,1),delete r[s.__id]);}}function h(t,e){E(K,function(i){i.func(t,e);});}function c(t){var e={};t.eachSeries(function(t){var i=t.get("stack"),n=t.getData();if(i&&"list"===n.type){var r=e[i];r&&(n.stackedOn=r),e[i]=n;}});}function d(t,e){var i=this._api;E(tt,function(n){n.isLayout&&n.func(t,i,e);});}function f(t,e){var i=this._api;t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette();}),E(tt,function(n){n.func(t,i,e);});}function p(t,e){var i=this._api;E(this._componentsViews,function(n){var r=n.__model;n.render(r,t,i,e),v(r,n);},this),E(this._chartsViews,function(t){t.__alive=!1;},this),t.eachSeries(function(n,r){var o=this._chartsMap[n.__viewId];o.__alive=!0,o.render(n,t,i,e),o.group.silent=!!n.get("silent"),v(n,o),m(n,o);},this),g(this._zr,t),E(this._chartsViews,function(e){e.__alive||e.remove(t,i);},this);}function g(t,e){var i=t.storage,n=0;i.traverse(function(t){t.isGroup||n++;}),n>e.get("hoverLayerThreshold")&&!x.node&&i.traverse(function(t){t.isGroup||(t.useHoverLayer=!0);});}function m(t,e){var i=0;e.group.traverse(function(t){"group"===t.type||t.ignore||i++;});var n=+t.get("progressive"),r=i>t.get("progressiveThreshold")&&n&&!x.node;r&&e.group.traverse(function(t){t.isGroup||(t.progressive=r?Math.floor(i++/n):-1,r&&t.stopAnimation(!0));});var o=t.get("blendMode")||null;!x.canvasSupported&&o&&"source-over"!==o&&console.warn("Only canvas support blendMode"),e.group.traverse(function(t){t.isGroup||t.setStyle("blend",o);});}function v(t,e){var i=t.get("z"),n=t.get("zlevel");e.group.traverse(function(t){"group"!==t.type&&(null!=i&&(t.z=i),null!=n&&(t.zlevel=n));});}function y(t){function e(t,e){for(var i=0;i<t.length;i++){var n=t[i];n[o]=e;}}var i=0,n=1,r=2,o="__connectUpdateStatus";P.each(Q,function(a,s){t._messageCenter.on(s,function(a){if(rt[t.group]&&t[o]!==i){var s=t.makeActionFromEvent(a),l=[];P.each(nt,function(e){e!==t&&e.group===t.group&&l.push(e);}),e(l,i),E(l,function(t){t[o]!==n&&t.dispatchAction(s);}),e(l,r);}});});}var x=i(2),_=i(3),b=i(25),w=i(26),S=i(27),M=i(19),I=i(28),T=i(29),A=i(42),L=i(43),C=i(5),D=i(81),P=i(4),k=i(39),z=i(33),O=i(85),E=P.each,R=1e3,N=5e3,V=1e3,B=2e3,G=3e3,F=4e3,H=5e3,W="__flag_in_main_process",Z="_hasGradientOrPatternBg",q="_optionUpdated";r.prototype.on=n("on"),r.prototype.off=n("off"),r.prototype.one=n("one"),P.mixin(r,z);var U=o.prototype;U._onframe=function(){this[q]&&(this[W]=!0,j.prepareAndUpdate.call(this),this[W]=!1,this[q]=!1);},U.getDom=function(){return this._dom;},U.getZr=function(){return this._zr;},U.setOption=function(t,e,i){if(P.assert(!this[W],"`setOption` should not be called during main process."),this[W]=!0,!this._model||e){var n=new S(this._api),r=this._theme,o=this._model=new _(null,null,r,n);o.init(null,null,r,n);}this._model.setOption(t,J),i?this[q]=!0:(j.prepareAndUpdate.call(this),this._zr.refreshImmediately(),this[q]=!1),this[W]=!1,this._flushPendingActions();},U.setTheme=function(){console.log("ECharts#setTheme() is DEPRECATED in ECharts 3.0");},U.getModel=function(){return this._model;},U.getOption=function(){return this._model&&this._model.getOption();},U.getWidth=function(){return this._zr.getWidth();},U.getHeight=function(){return this._zr.getHeight();},U.getRenderedCanvas=function(t){if(x.canvasSupported){t=t||{},t.pixelRatio=t.pixelRatio||1,t.backgroundColor=t.backgroundColor||this._model.get("backgroundColor");var e=this._zr,i=e.storage.getDisplayList();return P.each(i,function(t){t.stopAnimation(!0);}),e.painter.getRenderedCanvas(t);}},U.getDataURL=function(t){t=t||{};var e=t.excludeComponents,i=this._model,n=[],r=this;E(e,function(t){i.eachComponent({mainType:t},function(t){var e=r._componentsMap[t.__viewId];e.group.ignore||(n.push(e),e.group.ignore=!0);});});var o=this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return E(n,function(t){t.group.ignore=!1;}),o;},U.getConnectedDataURL=function(t){if(x.canvasSupported){var e=this.group,i=Math.min,n=Math.max,r=1/0;if(rt[e]){var o=r,a=r,s=-r,l=-r,u=[],h=t&&t.pixelRatio||1;P.each(nt,function(r,h){if(r.group===e){var c=r.getRenderedCanvas(P.clone(t)),d=r.getDom().getBoundingClientRect();o=i(d.left,o),a=i(d.top,a),s=n(d.right,s),l=n(d.bottom,l),u.push({dom:c,left:d.left,top:d.top});}}),o*=h,a*=h,s*=h,l*=h;var c=s-o,d=l-a,f=P.createCanvas();f.width=c,f.height=d;var p=D.init(f);return E(u,function(t){var e=new L.Image({style:{x:t.left*h-o,y:t.top*h-a,image:t.dom}});p.add(e);}),p.refreshImmediately(),f.toDataURL("image/"+(t&&t.type||"png"));}return this.getDataURL(t);}},U.convertToPixel=P.curry(a,"convertToPixel"),U.convertFromPixel=P.curry(a,"convertFromPixel"),U.containPixel=function(t,e){var i,n=this._model;return t=C.parseFinder(n,t),P.each(t,function(t,n){n.indexOf("Models")>=0&&P.each(t,function(t){var r=t.coordinateSystem;if(r&&r.containPoint)i|=!!r.containPoint(e);else if("seriesModels"===n){var o=this._chartsMap[t.__viewId];o&&o.containPoint?i|=o.containPoint(e,t):console.warn(n+": "+(o?"The found component do not support containPoint.":"No view mapping to the found component."));}else console.warn(n+": containPoint is not supported");},this);},this),!!i;},U.getVisual=function(t,e){var i=this._model;t=C.parseFinder(i,t,{defaultMainType:"series"});var n=t.seriesModel;n||console.warn("There is no specified seires model");var r=n.getData(),o=t.hasOwnProperty("dataIndexInside")?t.dataIndexInside:t.hasOwnProperty("dataIndex")?r.indexOfRawIndex(t.dataIndex):null;return null!=o?r.getItemVisual(o,e):r.getVisual(e);};var j={update:function update(t){var e=this._model,i=this._api,n=this._coordSysMgr,r=this._zr;if(e){e.restoreData(),n.create(this._model,this._api),h.call(this,e,i),c.call(this,e),n.update(e,i),f.call(this,e,t),p.call(this,e,t);var o=e.get("backgroundColor")||"transparent",a=r.painter;if(a.isSingleCanvas&&a.isSingleCanvas())r.configLayer(0,{clearColor:o});else{if(!x.canvasSupported){var s=k.parse(o);o=k.stringify(s,"rgb"),0===s[3]&&(o="transparent");}o.colorStops||o.image?(r.configLayer(0,{clearColor:o}),this[Z]=!0,this._dom.style.background="transparent"):(this[Z]&&r.configLayer(0,{clearColor:null}),this[Z]=!1,this._dom.style.background=o);}}},updateView:function updateView(t){var e=this._model;e&&(e.eachSeries(function(t){t.getData().clearAllVisual();}),f.call(this,e,t),l.call(this,"updateView",e,t));},updateVisual:function updateVisual(t){var e=this._model;e&&(e.eachSeries(function(t){t.getData().clearAllVisual();}),f.call(this,e,t),l.call(this,"updateVisual",e,t));},updateLayout:function updateLayout(t){var e=this._model;e&&(d.call(this,e,t),l.call(this,"updateLayout",e,t));},highlight:function highlight(t){s.call(this,"highlight",t);},downplay:function downplay(t){s.call(this,"downplay",t);},prepareAndUpdate:function prepareAndUpdate(t){var e=this._model;u.call(this,"component",e),u.call(this,"chart",e),j.update.call(this,t);}};U.resize=function(t){P.assert(!this[W],"`resize` should not be called during main process."),this[W]=!0,this._zr.resize(t);var e=this._model&&this._model.resetOption("media");j[e?"prepareAndUpdate":"update"].call(this),this._loadingFX&&this._loadingFX.resize(),this[W]=!1,this._flushPendingActions();},U.showLoading=function(t,e){if(P.isObject(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),!it[t])return void console.warn("Loading effects "+t+" not exists.");var i=it[t](this._api,e),n=this._zr;this._loadingFX=i,n.add(i);},U.hideLoading=function(){this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null;},U.makeActionFromEvent=function(t){var e=P.extend({},t);return e.type=Q[t.type],e;},U.dispatchAction=function(t,e){var i=Y[t.type];if(i){var n=i.actionInfo,r=n.update||"update";if(this[W])return void this._pendingActions.push(t);this[W]=!0;var o=[t],a=!1;t.batch&&(a=!0,o=P.map(t.batch,function(e){return e=P.defaults(P.extend({},e),t),e.batch=null,e;}));for(var s,l=[],u="highlight"===t.type||"downplay"===t.type,h=0;h<o.length;h++){var c=o[h];s=i.action(c,this._model),s=s||P.extend({},c),s.type=n.event||s.type,l.push(s),u&&j[r].call(this,c);}"none"===r||u||(this[q]?(j.prepareAndUpdate.call(this,t),this[q]=!1):j[r].call(this,t)),s=a?{type:n.event||t.type,batch:l}:l[0],this[W]=!1,!e&&this._messageCenter.trigger(s.type,s),this._flushPendingActions();}},U._flushPendingActions=function(){for(var t=this._pendingActions;t.length;){var e=t.shift();this.dispatchAction(e);}},U.on=n("on"),U.off=n("off"),U.one=n("one");var X=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];U._initEvents=function(){E(X,function(t){this._zr.on(t,function(e){var i,n=this.getModel(),r=e.target;if("globalout"===t)i={};else if(r&&null!=r.dataIndex){var o=r.dataModel||n.getSeriesByIndex(r.seriesIndex);i=o&&o.getDataParams(r.dataIndex,r.dataType)||{};}else r&&r.eventData&&(i=P.extend({},r.eventData));i&&(i.event=e,i.type=t,this.trigger(t,i));},this);},this),E(Q,function(t,e){this._messageCenter.on(e,function(t){this.trigger(e,t);},this);},this);},U.isDisposed=function(){return this._disposed;},U.clear=function(){this.setOption({series:[]},!0);},U.dispose=function(){if(this._disposed)return void console.warn("Instance "+this.id+" has been disposed");this._disposed=!0;var t=this._api,e=this._model;E(this._componentsViews,function(i){i.dispose(e,t);}),E(this._chartsViews,function(i){i.dispose(e,t);}),this._zr.dispose(),delete nt[this.id];},P.mixin(o,z);var Y=[],Q={},K=[],J=[],tt=[],et={},it={},nt={},rt={},ot=new Date()-0,at=new Date()-0,st="_echarts_instance_",lt={version:"3.3.1",dependencies:{zrender:"3.2.1"}};lt.init=function(t,e,i){if(D.version.replace(".","")-0<lt.dependencies.zrender.replace(".","")-0)throw new Error("ZRender "+D.version+" is too old for ECharts "+lt.version+". Current version need ZRender "+lt.dependencies.zrender+"+");if(!t)throw new Error("Initialize failed: invalid dom.");!P.isDom(t)||"CANVAS"===t.nodeName.toUpperCase()||t.clientWidth&&t.clientHeight||console.warn("Can't get dom width or height");var n=new o(t,e,i);return n.id="ec_"+ot++,nt[n.id]=n,t.setAttribute&&t.setAttribute(st,n.id),y(n),n;},lt.connect=function(t){if(P.isArray(t)){var e=t;t=null,P.each(e,function(e){null!=e.group&&(t=e.group);}),t=t||"g_"+at++,P.each(e,function(e){e.group=t;});}return rt[t]=!0,t;},lt.disConnect=function(t){rt[t]=!1;},lt.dispose=function(t){P.isDom(t)?t=lt.getInstanceByDom(t):"string"==typeof t&&(t=nt[t]),t instanceof o&&!t.isDisposed()&&t.dispose();},lt.getInstanceByDom=function(t){var e=t.getAttribute(st);return nt[e];},lt.getInstanceById=function(t){return nt[t];},lt.registerTheme=function(t,e){et[t]=e;},lt.registerPreprocessor=function(t){J.push(t);},lt.registerProcessor=function(t,e){if("function"==typeof t&&(e=t,t=R),isNaN(t))throw new Error("Unkown processor priority");K.push({prio:t,func:e});},lt.registerAction=function(t,e,i){"function"==typeof e&&(i=e,e="");var n=P.isObject(t)?t.type:[t,t={event:e}][0];t.event=(t.event||n).toLowerCase(),e=t.event,Y[n]||(Y[n]={action:i,actionInfo:t}),Q[e]=n;},lt.registerCoordinateSystem=function(t,e){w.register(t,e);},lt.registerLayout=function(t,e){if("function"==typeof t&&(e=t,t=V),isNaN(t))throw new Error("Unkown layout priority");tt.push({prio:t,func:e,isLayout:!0});},lt.registerVisual=function(t,e){if("function"==typeof t&&(e=t,t=G),isNaN(t))throw new Error("Unkown visual priority");tt.push({prio:t,func:e});},lt.registerLoading=function(t,e){it[t]=e;};var ut=M.parseClassType;lt.extendComponentModel=function(t,e){var i=M;if(e){var n=ut(e);i=M.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendComponentView=function(t,e){var i=T;if(e){var n=ut(e);i=T.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendSeriesModel=function(t,e){var i=I;if(e){e="series."+e.replace("series.","");var n=ut(e);i=I.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendChartView=function(t,e){var i=A;if(e){e.replace("series.","");var n=ut(e);i=A.getClass(n.main,!0);}return i.extend(t);},lt.setCanvasCreator=function(t){P.createCanvas=t;},lt.registerVisual(B,i(93)),lt.registerPreprocessor(i(94)),lt.registerLoading("default",i(96)),lt.registerAction({type:"highlight",event:"highlight",update:"highlight"},P.noop),lt.registerAction({type:"downplay",event:"downplay",update:"downplay"},P.noop),lt.List=i(97),lt.Model=i(12),lt.graphic=i(43),lt.number=i(7),lt.format=i(6),lt.matrix=i(11),lt.vector=i(10),lt.color=i(39),lt.util={},E(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults"],function(t){lt.util[t]=P[t];}),lt.PRIORITY={PROCESSOR:{FILTER:R,STATISTIC:N},VISUAL:{LAYOUT:V,GLOBAL:B,CHART:G,COMPONENT:F,BRUSH:H}},t.exports=lt;},function(t,e){function i(t){var e={},i={},n=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge\/([\d.]+)/);return n&&(i.firefox=!0,i.version=n[1]),r&&(i.ie=!0,i.version=r[1]),o&&(i.edge=!0,i.version=o[1]),{browser:i,os:e,node:!1,canvasSupported:document.createElement("canvas").getContext?!0:!1,touchEventsSupported:"ontouchstart"in window&&!i.ie&&!i.edge,pointerEventsSupported:"onpointerdown"in window&&(i.edge||i.ie&&i.version>=10)};}var n={};n="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0}:i(navigator.userAgent),t.exports=n;},function(t,e,i){function n(t,e){c.each(e,function(e,i){_.hasClass(i)||("object"==(typeof e==="undefined"?"undefined":_typeof(e))?t[i]=t[i]?c.merge(t[i],e,!1):c.clone(e):null==t[i]&&(t[i]=e));});}function r(t){t=t,this.option={},this.option[w]=1,this._componentsMap={},this._seriesIndices=null,n(t,this._theme.option),c.merge(t,b,!1),this.mergeOption(t);}function o(t,e){c.isArray(e)||(e=e?[e]:[]);var i={};return p(e,function(e){i[e]=(t[e]||[]).slice();}),i;}function a(t,e){var i={};p(e,function(t,e){var n=t.exist;n&&(i[n.id]=t);}),p(e,function(e,n){var r=e.option;if(c.assert(!r||null==r.id||!i[r.id]||i[r.id]===e,"id duplicates: "+(r&&r.id)),r&&null!=r.id&&(i[r.id]=e),x(r)){var o=s(t,r,e.exist);e.keyInfo={mainType:t,subType:o};}}),p(e,function(t,e){var n=t.exist,r=t.option,o=t.keyInfo;if(x(r)){if(o.name=null!=r.name?r.name+"":n?n.name:"\x00-",n)o.id=n.id;else if(null!=r.id)o.id=r.id+"";else{var a=0;do{o.id="\x00"+o.name+"\x00"+a++;}while(i[o.id]);}i[o.id]=t;}});}function s(t,e,i){var n=e.type?e.type:i?i.subType:_.determineSubType(t,e);return n;}function l(t){return m(t,function(t){return t.componentIndex;})||[];}function u(t,e){return e.hasOwnProperty("subType")?g(t,function(t){return t.subType===e.subType;}):t;}function h(t){if(!t._seriesIndices)throw new Error("Series has not been initialized yet.");}var c=i(4),d=i(5),f=i(12),p=c.each,g=c.filter,m=c.map,v=c.isArray,y=c.indexOf,x=c.isObject,_=i(19),b=i(23),w="\x00_ec_inner",S=f.extend({constructor:S,init:function init(t,e,i,n){i=i||{},this.option=null,this._theme=new f(i),this._optionManager=n;},setOption:function setOption(t,e){c.assert(!(w in t),"please use chart.getOption()"),this._optionManager.setOption(t,e),this.resetOption();},resetOption:function resetOption(t){var e=!1,i=this._optionManager;if(!t||"recreate"===t){var n=i.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this.mergeOption(n)):r.call(this,n),e=!0;}if(("timeline"===t||"media"===t)&&this.restoreData(),!t||"recreate"===t||"timeline"===t){var o=i.getTimelineOption(this);o&&(this.mergeOption(o),e=!0);}if(!t||"recreate"===t||"media"===t){var a=i.getMediaOption(this,this._api);a.length&&p(a,function(t){this.mergeOption(t,e=!0);},this);}return e;},mergeOption:function mergeOption(t){function e(e,r){var s=d.normalizeToArray(t[e]),u=d.mappingToExists(n[e],s);a(e,u);var h=o(n,r);i[e]=[],n[e]=[],p(u,function(t,r){var o=t.exist,a=t.option;if(c.assert(x(a)||o,"Empty component definition"),a){var s=_.getClass(e,t.keyInfo.subType,!0);if(o&&o instanceof s)o.name=t.keyInfo.name,o.mergeOption(a,this),o.optionUpdated(a,!1);else{var l=c.extend({dependentModels:h,componentIndex:r},t.keyInfo);o=new s(a,this,this,l),c.extend(o,l),o.init(a,this,this,l),o.optionUpdated(null,!0);}}else o.mergeOption({},this),o.optionUpdated({},!1);n[e][r]=o,i[e][r]=o.option;},this),"series"===e&&(this._seriesIndices=l(n.series));}var i=this.option,n=this._componentsMap,r=[];p(t,function(t,e){null!=t&&(_.hasClass(e)?r.push(e):i[e]=null==i[e]?c.clone(t):c.merge(i[e],t,!0));}),_.topologicalTravel(r,_.getAllClassMainTypes(),e,this),this._seriesIndices=this._seriesIndices||[];},getOption:function getOption(){var t=c.clone(this.option);return p(t,function(e,i){if(_.hasClass(i)){for(var e=d.normalizeToArray(e),n=e.length-1;n>=0;n--){d.isIdInner(e[n])&&e.splice(n,1);}t[i]=e;}}),delete t[w],t;},getTheme:function getTheme(){return this._theme;},getComponent:function getComponent(t,e){var i=this._componentsMap[t];return i?i[e||0]:void 0;},queryComponents:function queryComponents(t){var e=t.mainType;if(!e)return[];var i=t.index,n=t.id,r=t.name,o=this._componentsMap[e];if(!o||!o.length)return[];var a;if(null!=i)v(i)||(i=[i]),a=g(m(i,function(t){return o[t];}),function(t){return!!t;});else if(null!=n){var s=v(n);a=g(o,function(t){return s&&y(n,t.id)>=0||!s&&t.id===n;});}else if(null!=r){var l=v(r);a=g(o,function(t){return l&&y(r,t.name)>=0||!l&&t.name===r;});}else a=o;return u(a,t);},findComponents:function findComponents(t){function e(t){var e=r+"Index",i=r+"Id",n=r+"Name";return t&&(t.hasOwnProperty(e)||t.hasOwnProperty(i)||t.hasOwnProperty(n))?{mainType:r,index:t[e],id:t[i],name:t[n]}:null;}function i(e){return t.filter?g(e,t.filter):e;}var n=t.query,r=t.mainType,o=e(n),a=o?this.queryComponents(o):this._componentsMap[r];return i(u(a,t));},eachComponent:function eachComponent(t,e,i){var n=this._componentsMap;if("function"==typeof t)i=e,e=t,p(n,function(t,n){p(t,function(t,r){e.call(i,n,t,r);});});else if(c.isString(t))p(n[t],e,i);else if(x(t)){var r=this.findComponents(t);p(r,e,i);}},getSeriesByName:function getSeriesByName(t){var e=this._componentsMap.series;return g(e,function(e){return e.name===t;});},getSeriesByIndex:function getSeriesByIndex(t){return this._componentsMap.series[t];},getSeriesByType:function getSeriesByType(t){var e=this._componentsMap.series;return g(e,function(e){return e.subType===t;});},getSeries:function getSeries(){return this._componentsMap.series.slice();},eachSeries:function eachSeries(t,e){h(this),p(this._seriesIndices,function(i){var n=this._componentsMap.series[i];t.call(e,n,i);},this);},eachRawSeries:function eachRawSeries(t,e){p(this._componentsMap.series,t,e);},eachSeriesByType:function eachSeriesByType(t,e,i){h(this),p(this._seriesIndices,function(n){var r=this._componentsMap.series[n];r.subType===t&&e.call(i,r,n);},this);},eachRawSeriesByType:function eachRawSeriesByType(t,e,i){return p(this.getSeriesByType(t),e,i);},isSeriesFiltered:function isSeriesFiltered(t){return h(this),c.indexOf(this._seriesIndices,t.componentIndex)<0;},filterSeries:function filterSeries(t,e){h(this);var i=g(this._componentsMap.series,t,e);this._seriesIndices=l(i);},restoreData:function restoreData(){var t=this._componentsMap;this._seriesIndices=l(t.series);var e=[];p(t,function(t,i){e.push(i);}),_.topologicalTravel(e,_.getAllClassMainTypes(),function(e,i){p(t[e],function(t){t.restoreData();});});}});c.mixin(S,i(24)),t.exports=S;},function(t,e){function i(t){if("object"==(typeof t==="undefined"?"undefined":_typeof(t))&&null!==t){var e=t;if(t instanceof Array){e=[];for(var n=0,r=t.length;r>n;n++){e[n]=i(t[n]);}}else if(!M(t)&&!I(t)){e={};for(var o in t){t.hasOwnProperty(o)&&(e[o]=i(t[o]));}}return e;}return t;}function n(t,e,r){if(!S(e)||!S(t))return r?i(e):t;for(var o in e){if(e.hasOwnProperty(o)){var a=t[o],s=e[o];!S(s)||!S(a)||_(s)||_(a)||I(s)||I(a)||M(s)||M(a)?!r&&o in t||(t[o]=i(e[o],!0)):n(a,s,r);}}return t;}function r(t,e){for(var i=t[0],r=1,o=t.length;o>r;r++){i=n(i,t[r],e);}return i;}function o(t,e){for(var i in e){e.hasOwnProperty(i)&&(t[i]=e[i]);}return t;}function a(t,e,i){for(var n in e){e.hasOwnProperty(n)&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n]);}return t;}function s(){return document.createElement("canvas");}function l(){return C||(C=V.createCanvas().getContext("2d")),C;}function u(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;i++){if(t[i]===e)return i;}}return-1;}function h(t,e){function i(){}var n=t.prototype;i.prototype=e.prototype,t.prototype=new i();for(var r in n){t.prototype[r]=n[r];}t.prototype.constructor=t,t.superClass=e;}function c(t,e,i){t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,a(t,e,i);}function d(t){return t?"string"==typeof t?!1:"number"==typeof t.length:void 0;}function f(t,e,i){if(t&&e)if(t.forEach&&t.forEach===z)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,r=t.length;r>n;n++){e.call(i,t[n],n,t);}else for(var o in t){t.hasOwnProperty(o)&&e.call(i,t[o],o,t);}}function p(t,e,i){if(t&&e){if(t.map&&t.map===R)return t.map(e,i);for(var n=[],r=0,o=t.length;o>r;r++){n.push(e.call(i,t[r],r,t));}return n;}}function g(t,e,i,n){if(t&&e){if(t.reduce&&t.reduce===N)return t.reduce(e,i,n);for(var r=0,o=t.length;o>r;r++){i=e.call(n,i,t[r],r,t);}return i;}}function m(t,e,i){if(t&&e){if(t.filter&&t.filter===O)return t.filter(e,i);for(var n=[],r=0,o=t.length;o>r;r++){e.call(i,t[r],r,t)&&n.push(t[r]);}return n;}}function v(t,e,i){if(t&&e)for(var n=0,r=t.length;r>n;n++){if(e.call(i,t[n],n,t))return t[n];}}function y(t,e){var i=E.call(arguments,2);return function(){return t.apply(e,i.concat(E.call(arguments)));};}function x(t){var e=E.call(arguments,1);return function(){return t.apply(this,e.concat(E.call(arguments)));};}function _(t){return"[object Array]"===P.call(t);}function b(t){return"function"==typeof t;}function w(t){return"[object String]"===P.call(t);}function S(t){var e=typeof t==="undefined"?"undefined":_typeof(t);return"function"===e||!!t&&"object"==e;}function M(t){return!!D[P.call(t)];}function I(t){return t&&1===t.nodeType&&"string"==typeof t.nodeName;}function T(t){for(var e=0,i=arguments.length;i>e;e++){if(null!=arguments[e])return arguments[e];}}function A(){return Function.call.apply(E,arguments);}function L(t,e){if(!t)throw new Error(e);}var C,D={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1},P=Object.prototype.toString,k=Array.prototype,z=k.forEach,O=k.filter,E=k.slice,R=k.map,N=k.reduce,V={inherits:h,mixin:c,clone:i,merge:n,mergeAll:r,extend:o,defaults:a,getContext:l,createCanvas:s,indexOf:u,slice:A,find:v,isArrayLike:d,each:f,map:p,reduce:g,filter:m,bind:y,curry:x,isArray:_,isString:w,isObject:S,isFunction:b,isBuildInObject:M,isDom:I,retrieve:T,assert:L,noop:function noop(){}};t.exports=V;},function(t,e,i){function n(t,e){return t&&t.hasOwnProperty(e);}var r=i(6),o=i(7),a=i(12),s=i(4),l={};l.normalizeToArray=function(t){return t instanceof Array?t:null==t?[]:[t];},l.defaultEmphasis=function(t,e){if(t){var i=t.emphasis=t.emphasis||{},n=t.normal=t.normal||{};s.each(e,function(t){var e=s.retrieve(i[t],n[t]);null!=e&&(i[t]=e);});}},l.LABEL_OPTIONS=["position","show","textStyle","distance","formatter"],l.getDataItemValue=function(t){return t&&(null==t.value?t:t.value);},l.isDataItemOption=function(t){return s.isObject(t)&&!(t instanceof Array);},l.converDataValue=function(t,e){var i=e&&e.type;return"ordinal"===i?t:("time"!==i||isFinite(t)||null==t||"-"===t||(t=+o.parseDate(t)),null==t||""===t?NaN:+t);},l.createDataFormatModel=function(t,e){var i=new a();return s.mixin(i,l.dataFormatMixin),i.seriesIndex=e.seriesIndex,i.name=e.name||"",i.mainType=e.mainType,i.subType=e.subType,i.getData=function(){return t;},i;},l.dataFormatMixin={getDataParams:function getDataParams(t,e){var i=this.getData(e),n=this.seriesIndex,r=this.name,o=this.getRawValue(t,e),a=i.getRawIndex(t),s=i.getName(t,!0),l=i.getRawDataItem(t);return{componentType:this.mainType,componentSubType:this.subType,seriesType:"series"===this.mainType?this.subType:null,seriesIndex:n,seriesName:r,name:s,dataIndex:a,data:l,dataType:e,value:o,color:i.getItemVisual(t,"color"),$vars:["seriesName","name","value"]};},getFormattedLabel:function getFormattedLabel(t,e,i,n){e=e||"normal";var o=this.getData(i),a=o.getItemModel(t),s=this.getDataParams(t,i);null!=n&&s.value instanceof Array&&(s.value=s.value[n]);var l=a.get(["label",e,"formatter"]);return"function"==typeof l?(s.status=e,l(s)):"string"==typeof l?r.formatTpl(l,s):void 0;},getRawValue:function getRawValue(t,e){var i=this.getData(e),n=i.getRawDataItem(t);return null!=n?!s.isObject(n)||n instanceof Array?n:n.value:void 0;},formatTooltip:s.noop},l.mappingToExists=function(t,e){e=(e||[]).slice();var i=s.map(t||[],function(t,e){return{exist:t};});return s.each(e,function(t,n){if(s.isObject(t)){for(var r=0;r<i.length;r++){if(!i[r].option&&null!=t.id&&i[r].exist.id===t.id+"")return i[r].option=t,void(e[n]=null);}for(var r=0;r<i.length;r++){var o=i[r].exist;if(!(i[r].option||null!=o.id&&null!=t.id||null==t.name||l.isIdInner(t)||l.isIdInner(o)||o.name!==t.name+""))return i[r].option=t,void(e[n]=null);}}}),s.each(e,function(t,e){if(s.isObject(t)){for(var n=0;n<i.length;n++){var r=i[n].exist;if(!i[n].option&&!l.isIdInner(r)&&null==t.id){i[n].option=t;break;}}n>=i.length&&i.push({option:t});}}),i;},l.isIdInner=function(t){return s.isObject(t)&&t.id&&0===(t.id+"").indexOf("\x00_ec_\x00");},l.compressBatches=function(t,e){function i(t,e,i){for(var n=0,r=t.length;r>n;n++){for(var o=t[n].seriesId,a=l.normalizeToArray(t[n].dataIndex),s=i&&i[o],u=0,h=a.length;h>u;u++){var c=a[u];s&&s[c]?s[c]=null:(e[o]||(e[o]={}))[c]=1;}}}function n(t,e){var i=[];for(var r in t){if(t.hasOwnProperty(r)&&null!=t[r])if(e)i.push(+r);else{var o=n(t[r],!0);o.length&&i.push({seriesId:r,dataIndex:o});}}return i;}var r={},o={};return i(t||[],r),i(e||[],o,r),[n(r),n(o)];},l.queryDataIndex=function(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?s.isArray(e.dataIndex)?s.map(e.dataIndex,function(e){return t.indexOfRawIndex(e);}):t.indexOfRawIndex(e.dataIndex):null!=e.name?s.isArray(e.name)?s.map(e.name,function(e){return t.indexOfName(e);}):t.indexOfName(e.name):void 0;},l.parseFinder=function(t,e,i){if(s.isString(e)){var r={};r[e+"Index"]=0,e=r;}var o=i&&i.defaultMainType;!o||n(e,o+"Index")||n(e,o+"Id")||n(e,o+"Name")||(e[o+"Index"]=0);var a={};return s.each(e,function(i,n){var i=e[n];if("dataIndex"===n||"dataIndexInside"===n)return void(a[n]=i);var r=n.match(/^(\w+)(Index|Id|Name)$/)||[],o=r[1],s=r[2];if(o&&s){var l={mainType:o};l[s.toLowerCase()]=i;var u=t.queryComponents(l);a[o+"Models"]=u,a[o+"Model"]=u[0];}}),a;},t.exports=l;},function(t,e,i){var n=i(4),r=i(7),o=i(8),a={};a.addCommas=function(t){return isNaN(t)?"-":(t=(t+"").split("."),t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:""));},a.toCamelCase=function(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase();});},a.normalizeCssArray=function(t){var e=t.length;return"number"==typeof t?[t,t,t,t]:2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t;},a.encodeHTML=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");};var s=["a","b","c","d","e","f","g"],l=function l(t,e){return"{"+t+(null==e?"":e)+"}";};a.formatTpl=function(t,e){n.isArray(e)||(e=[e]);var i=e.length;if(!i)return"";for(var r=e[0].$vars||[],o=0;o<r.length;o++){var a=s[o];t=t.replace(l(a),l(a,0));}for(var u=0;i>u;u++){for(var h=0;h<r.length;h++){t=t.replace(l(s[h],u),e[u][r[h]]);}}return t;};var u=function u(t){return 10>t?"0"+t:t;};a.formatTime=function(t,e){("week"===t||"month"===t||"quarter"===t||"half-year"===t||"year"===t)&&(t="MM-dd\nyyyy");var i=r.parseDate(e),n=i.getFullYear(),o=i.getMonth()+1,a=i.getDate(),s=i.getHours(),l=i.getMinutes(),h=i.getSeconds();return t=t.replace("MM",u(o)).toLowerCase().replace("yyyy",n).replace("yy",n%100).replace("dd",u(a)).replace("d",a).replace("hh",u(s)).replace("h",s).replace("mm",u(l)).replace("m",l).replace("ss",u(h)).replace("s",h);},a.capitalFirst=function(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t;},a.truncateText=o.truncateText,t.exports=a;},function(t,e){function i(t){return t.replace(/^\s+/,"").replace(/\s+$/,"");}var n={},r=1e-4;n.linearMap=function(t,e,i,n){var r=e[1]-e[0],o=i[1]-i[0];if(0===r)return 0===o?i[0]:(i[0]+i[1])/2;if(n){if(r>0){if(t<=e[0])return i[0];if(t>=e[1])return i[1];}else{if(t>=e[0])return i[0];if(t<=e[1])return i[1];}}else{if(t===e[0])return i[0];if(t===e[1])return i[1];}return(t-e[0])/r*o+i[0];},n.parsePercent=function(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%";}return"string"==typeof t?i(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t;},n.round=function(t,e){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),+(+t).toFixed(e);},n.asc=function(t){return t.sort(function(t,e){return t-e;}),t;},n.getPrecision=function(t){if(t=+t,isNaN(t))return 0;for(var e=1,i=0;Math.round(t*e)/e!==t;){e*=10,i++;}return i;},n.getPrecisionSafe=function(t){var e=t.toString(),i=e.indexOf(".");return 0>i?0:e.length-1-i;},n.getPixelPrecision=function(t,e){var i=Math.log,n=Math.LN10,r=Math.floor(i(t[1]-t[0])/n),o=Math.round(i(Math.abs(e[1]-e[0]))/n);return Math.max(-r+o,0);},n.MAX_SAFE_INTEGER=9007199254740991,n.remRadian=function(t){var e=2*Math.PI;return(t%e+e)%e;},n.isRadianAroundZero=function(t){return t>-r&&r>t;},n.parseDate=function(t){if(t instanceof Date)return t;if("string"==typeof t){var e=new Date(t);return isNaN(+e)&&(e=new Date(new Date(t.replace(/-/g,"/"))-new Date("1970/01/01"))),e;}return new Date(Math.round(t));},n.quantity=function(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10));},n.nice=function(t,e){var i,r=n.quantity(t),o=t/r;return i=e?1.5>o?1:2.5>o?2:4>o?3:7>o?5:10:1>o?1:2>o?2:3>o?3:5>o?5:10,i*r;},t.exports=n;},function(t,e,i){function n(t,e){var i=t+":"+e;if(l[i])return l[i];for(var n=(t+"").split("\n"),r=0,o=0,a=n.length;a>o;o++){r=Math.max(p.measureText(n[o],e).width,r);}return u>h&&(u=0,l={}),u++,l[i]=r,r;}function r(t,e,i,r){var o=((t||"")+"").split("\n").length,a=n(t,e),s=n("",e),l=o*s,u=new d(0,0,a,l);switch(u.lineHeight=s,r){case"bottom":case"alphabetic":u.y-=s;break;case"middle":u.y-=s/2;}switch(i){case"end":case"right":u.x-=u.width;break;case"center":u.x-=u.width/2;}return u;}function o(t,e,i,n){var r=e.x,o=e.y,a=e.height,s=e.width,l=i.height,u=a/2-l/2,h="left";switch(t){case"left":r-=n,o+=u,h="right";break;case"right":r+=n+s,o+=u,h="left";break;case"top":r+=s/2,o-=n+l,h="center";break;case"bottom":r+=s/2,o+=a+n,h="center";break;case"inside":r+=s/2,o+=u,h="center";break;case"insideLeft":r+=n,o+=u,h="left";break;case"insideRight":r+=s-n,o+=u,h="right";break;case"insideTop":r+=s/2,o+=n,h="center";break;case"insideBottom":r+=s/2,o+=a-l-n,h="center";break;case"insideTopLeft":r+=n,o+=n,h="left";break;case"insideTopRight":r+=s-n,o+=n,h="right";break;case"insideBottomLeft":r+=n,o+=a-l-n;break;case"insideBottomRight":r+=s-n,o+=a-l-n,h="right";}return{x:r,y:o,textAlign:h,textBaseline:"top"};}function a(t,e,i,r,o){if(!e)return"";o=o||{},r=f(r,"...");for(var a=f(o.maxIterations,2),l=f(o.minChar,0),u=n("",i),h=n("a",i),c=f(o.placeholder,""),d=e=Math.max(0,e-1),p=0;l>p&&d>=h;p++){d-=h;}var g=n(r);g>d&&(r="",g=0),d=e-g;for(var m=(t+"").split("\n"),p=0,v=m.length;v>p;p++){var y=m[p],x=n(y,i);if(!(e>=x)){for(var _=0;;_++){if(d>=x||_>=a){y+=r;break;}var b=0===_?s(y,d,h,u):x>0?Math.floor(y.length*d/x):0;y=y.substr(0,b),x=n(y,i);}""===y&&(y=c),m[p]=y;}}return m.join("\n");}function s(t,e,i,n){for(var r=0,o=0,a=t.length;a>o&&e>r;o++){var s=t.charCodeAt(o);r+=s>=0&&127>=s?i:n;}return o;}var l={},u=0,h=5e3,c=i(4),d=i(9),f=c.retrieve,p={getWidth:n,getBoundingRect:r,adjustTextPositionOnRect:o,truncateText:a,measureText:function measureText(t,e){var i=c.getContext();return i.font=e||"12px sans-serif",i.measureText(t);}};t.exports=p;},function(t,e,i){"use strict";function n(t,e,i,n){0>i&&(t+=i,i=-i),0>n&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n;}var r=i(10),o=i(11),a=r.applyTransform,s=Math.min,l=Math.abs,u=Math.max;n.prototype={constructor:n,union:function union(t){var e=s(t.x,this.x),i=s(t.y,this.y);this.width=u(t.x+t.width,this.x+this.width)-e,this.height=u(t.y+t.height,this.y+this.height)-i,this.x=e,this.y=i;},applyTransform:function(){var t=[],e=[];return function(i){i&&(t[0]=this.x,t[1]=this.y,e[0]=this.x+this.width,e[1]=this.y+this.height,a(t,t,i),a(e,e,i),this.x=s(t[0],e[0]),this.y=s(t[1],e[1]),this.width=l(e[0]-t[0]),this.height=l(e[1]-t[1]));};}(),calculateTransform:function calculateTransform(t){var e=this,i=t.width/e.width,n=t.height/e.height,r=o.create();return o.translate(r,r,[-e.x,-e.y]),o.scale(r,r,[i,n]),o.translate(r,r,[t.x,t.y]),r;},intersect:function intersect(t){t instanceof n||(t=n.create(t));var e=this,i=e.x,r=e.x+e.width,o=e.y,a=e.y+e.height,s=t.x,l=t.x+t.width,u=t.y,h=t.y+t.height;return!(s>r||i>l||u>a||o>h);},contain:function contain(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height;},clone:function clone(){return new n(this.x,this.y,this.width,this.height);},copy:function copy(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height;},plain:function plain(){return{x:this.x,y:this.y,width:this.width,height:this.height};}},n.create=function(t){return new n(t.x,t.y,t.width,t.height);},t.exports=n;},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array,n={create:function create(t,e){var n=new i(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n;},copy:function copy(t,e){return t[0]=e[0],t[1]=e[1],t;},clone:function clone(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e;},set:function set(t,e,i){return t[0]=e,t[1]=i,t;},add:function add(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t;},scaleAndAdd:function scaleAndAdd(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t;},sub:function sub(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t;},len:function len(t){return Math.sqrt(this.lenSquare(t));},lenSquare:function lenSquare(t){return t[0]*t[0]+t[1]*t[1];},mul:function mul(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t;},div:function div(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t;},dot:function dot(t,e){return t[0]*e[0]+t[1]*e[1];},scale:function scale(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t;},normalize:function normalize(t,e){var i=n.len(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t;},distance:function distance(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]));},distanceSquare:function distanceSquare(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]);},negate:function negate(t,e){return t[0]=-e[0],t[1]=-e[1],t;},lerp:function lerp(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t;},applyTransform:function applyTransform(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t;},min:function min(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t;},max:function max(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t;}};n.length=n.len,n.lengthSquare=n.lenSquare,n.dist=n.distance,n.distSquare=n.distanceSquare,t.exports=n;},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array,n={create:function create(){var t=new i(6);return n.identity(t),t;},identity:function identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t;},copy:function copy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t;},mul:function mul(t,e,i){var n=e[0]*i[0]+e[2]*i[1],r=e[1]*i[0]+e[3]*i[1],o=e[0]*i[2]+e[2]*i[3],a=e[1]*i[2]+e[3]*i[3],s=e[0]*i[4]+e[2]*i[5]+e[4],l=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t;},translate:function translate(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t;},rotate:function rotate(t,e,i){var n=e[0],r=e[2],o=e[4],a=e[1],s=e[3],l=e[5],u=Math.sin(i),h=Math.cos(i);return t[0]=n*h+a*u,t[1]=-n*u+a*h,t[2]=r*h+s*u,t[3]=-r*u+h*s,t[4]=h*o+u*l,t[5]=h*l-u*o,t;},scale:function scale(t,e,i){var n=i[0],r=i[1];return t[0]=e[0]*n,t[1]=e[1]*r,t[2]=e[2]*n,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*r,t;},invert:function invert(t,e){var i=e[0],n=e[2],r=e[4],o=e[1],a=e[3],s=e[5],l=i*a-o*n;return l?(l=1/l,t[0]=a*l,t[1]=-o*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*s-a*r)*l,t[5]=(o*r-i*s)*l,t):null;}};t.exports=n;},function(t,e,i){function n(t,e,i){this.parentModel=e,this.ecModel=i,this.option=t;}var r=i(4),o=i(13);n.prototype={constructor:n,init:null,mergeOption:function mergeOption(t){r.merge(this.option,t,!0);},get:function get(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var i=this.option,n=this.parentModel,r=0;r<t.length&&(!t[r]||(i=i&&"object"==(typeof i==="undefined"?"undefined":_typeof(i))?i[t[r]]:null,null!=i));r++){}return null==i&&n&&!e&&(i=n.get(t)),i;},getShallow:function getShallow(t,e){var i=this.option,n=null==i?i:i[t],r=this.parentModel;return null==n&&r&&!e&&(n=r.getShallow(t)),n;},getModel:function getModel(t,e){var i=this.get(t,!0),r=this.parentModel,o=new n(i,e||r&&r.getModel(t),this.ecModel);return o;},isEmpty:function isEmpty(){return null==this.option;},restoreData:function restoreData(){},clone:function clone(){var t=this.constructor;return new t(r.clone(this.option));},setReadOnly:function setReadOnly(t){o.setReadOnly(this,t);}},o.enableClassExtend(n);var a=r.mixin;a(n,i(14)),a(n,i(16)),a(n,i(17)),a(n,i(18)),t.exports=n;},function(t,e,i){function n(t,e){var i=o.slice(arguments,2);return this.superClass.prototype[e].apply(t,i);}function r(t,e,i){return this.superClass.prototype[e].apply(t,i);}var o=i(4),a={},s=".",l="___EC__COMPONENT__CONTAINER___",u=a.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split(s),e.main=t[0]||"",e.sub=t[1]||""),e;};a.enableClassExtend=function(t,e){t.$constructor=t,t.extend=function(t){o.each(e,function(e){t[e]||console.warn("Method `"+e+"` should be implemented"+(t.type?" in "+t.type:"")+".");});var i=this,a=function a(){t.$constructor?t.$constructor.apply(this,arguments):i.apply(this,arguments);};return o.extend(a.prototype,t),a.extend=this.extend,a.superCall=n,a.superApply=r,o.inherits(a,this),a.superClass=i,a;};},a.enableClassManagement=function(t,e){function i(t){var e=n[t.main];return e&&e[l]||(e=n[t.main]={},e[l]=!0),e;}e=e||{};var n={};if(t.registerClass=function(t,e){if(e)if(e=u(e),e.sub){if(e.sub!==l){var r=i(e);r[e.sub]=t;}}else n[e.main]&&console.warn(e.main+" exists."),n[e.main]=t;return t;},t.getClass=function(t,e,i){var r=n[t];if(r&&r[l]&&(r=e?r[e]:null),i&&!r)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return r;},t.getClassesByMainType=function(t){t=u(t);var e=[],i=n[t.main];return i&&i[l]?o.each(i,function(t,i){i!==l&&e.push(t);}):e.push(i),e;},t.hasClass=function(t){return t=u(t),!!n[t.main];},t.getAllClassMainTypes=function(){var t=[];return o.each(n,function(e,i){t.push(i);}),t;},t.hasSubTypes=function(t){t=u(t);var e=n[t.main];return e&&e[l];},t.parseClassType=u,e.registerWhenExtend){var r=t.extend;r&&(t.extend=function(e){var i=r.call(this,e);return t.registerClass(i,e.type);});}return t;},a.setReadOnly=function(t,e){},t.exports=a;},function(t,e,i){var n=i(15)([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);t.exports={getLineStyle:function getLineStyle(t){var e=n.call(this,t),i=this.getLineDash(e.lineWidth);return i&&(e.lineDash=i),e;},getLineDash:function getLineDash(t){null==t&&(t=1);var e=this.get("type"),i=Math.max(t,2),n=4*t;return"solid"===e||null==e?null:"dashed"===e?[n,n]:[i,i];}};},function(t,e,i){var n=i(4);t.exports=function(t){for(var e=0;e<t.length;e++){t[e][1]||(t[e][1]=t[e][0]);}return function(e){for(var i={},r=0;r<t.length;r++){var o=t[r][1];if(!(e&&n.indexOf(e,o)>=0)){var a=this.getShallow(o);null!=a&&(i[t[r][0]]=a);}}return i;};};},function(t,e,i){t.exports={getAreaStyle:i(15)([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]])};},function(t,e,i){function n(t,e){return t&&t.getShallow(e);}var r=i(8);t.exports={getTextColor:function getTextColor(){var t=this.ecModel;return this.getShallow("color")||t&&t.get("textStyle.color");},getFont:function getFont(){var t=this.ecModel,e=t&&t.getModel("textStyle");return[this.getShallow("fontStyle")||n(e,"fontStyle"),this.getShallow("fontWeight")||n(e,"fontWeight"),(this.getShallow("fontSize")||n(e,"fontSize")||12)+"px",this.getShallow("fontFamily")||n(e,"fontFamily")||"sans-serif"].join(" ");},getTextRect:function getTextRect(t){var e=this.get("textStyle")||{};return r.getBoundingRect(t,this.getFont(),e.align,e.baseline);},truncateText:function truncateText(t,e,i,n){return r.truncateText(t,e,this.getFont(),i,n);}};},function(t,e,i){var n=i(15)([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]);t.exports={getItemStyle:function getItemStyle(t){var e=n.call(this,t),i=this.getBorderLineDash();return i&&(e.lineDash=i),e;},getBorderLineDash:function getBorderLineDash(){var t=this.get("borderType");return"solid"===t||null==t?null:"dashed"===t?[5,5]:[1,1];}};},function(t,e,i){function n(t){var e=[];return o.each(h.getClassesByMainType(t),function(t){a.apply(e,t.prototype.dependencies||[]);}),o.map(e,function(t){return l.parseClassType(t).main;});}var r=i(12),o=i(4),a=Array.prototype.push,s=i(20),l=i(13),u=i(21),h=r.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function $constructor(t,e,i,n){r.call(this,t,e,i,n),this.uid=s.getUID("componentModel");},init:function init(t,e,i,n){this.mergeDefaultAndTheme(t,i);},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){var i=this.layoutMode,n=i?u.getLayoutParams(t):{},r=e.getTheme();o.merge(t,r.get(this.mainType)),o.merge(t,this.getDefaultOption()),i&&u.mergeLayoutParam(t,n,i);},mergeOption:function mergeOption(t,e){o.merge(this.option,t,!0);var i=this.layoutMode;i&&u.mergeLayoutParam(this.option,t,i);},optionUpdated:function optionUpdated(t,e){},getDefaultOption:function getDefaultOption(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var i=e.prototype.defaultOption;i&&t.push(i),e=e.superClass;}for(var n={},r=t.length-1;r>=0;r--){n=o.merge(n,t[r],!0);}this.__defaultOption=n;}return this.__defaultOption;},getReferringComponents:function getReferringComponents(t){return this.ecModel.queryComponents({mainType:t,index:this.get(t+"Index",!0),id:this.get(t+"Id",!0)});}});l.enableClassManagement(h,{registerWhenExtend:!0}),s.enableSubTypeDefaulter(h),s.enableTopologicalTravel(h,n),o.mixin(h,i(22)),t.exports=h;},function(t,e,i){var n=i(4),r=i(13),o=r.parseClassType,a=0,s={},l="_";s.getUID=function(t){return[t||"",a++,Math.random()].join(l);},s.enableSubTypeDefaulter=function(t){var e={};return t.registerSubTypeDefaulter=function(t,i){t=o(t),e[t.main]=i;},t.determineSubType=function(i,n){var r=n.type;if(!r){var a=o(i).main;t.hasSubTypes(i)&&e[a]&&(r=e[a](n));}return r;},t;},s.enableTopologicalTravel=function(t,e){function i(t){var i={},a=[];return n.each(t,function(s){var l=r(i,s),u=l.originalDeps=e(s),h=o(u,t);l.entryCount=h.length,0===l.entryCount&&a.push(s),n.each(h,function(t){n.indexOf(l.predecessor,t)<0&&l.predecessor.push(t);var e=r(i,t);n.indexOf(e.successor,t)<0&&e.successor.push(s);});}),{graph:i,noEntryList:a};}function r(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e];}function o(t,e){var i=[];return n.each(t,function(t){n.indexOf(e,t)>=0&&i.push(t);}),i;}t.topologicalTravel=function(t,e,r,o){function a(t){u[t].entryCount--,0===u[t].entryCount&&h.push(t);}function s(t){c[t]=!0,a(t);}if(t.length){var l=i(e),u=l.graph,h=l.noEntryList,c={};for(n.each(t,function(t){c[t]=!0;});h.length;){var d=h.pop(),f=u[d],p=!!c[d];p&&(r.call(o,d,f.originalDeps.slice()),delete c[d]),n.each(f.successor,p?s:a);}n.each(c,function(){throw new Error("Circle dependency may exists");});}};},t.exports=s;},function(t,e,i){"use strict";function n(t,e,i,n,r){var o=0,a=0;null==n&&(n=1/0),null==r&&(r=1/0);var s=0;e.eachChild(function(l,u){var h,c,d=l.position,f=l.getBoundingRect(),p=e.childAt(u+1),g=p&&p.getBoundingRect();if("horizontal"===t){var m=f.width+(g?-g.x+f.x:0);h=o+m,h>n||l.newline?(o=0,h=m,a+=s+i,s=f.height):s=Math.max(s,f.height);}else{var v=f.height+(g?-g.y+f.y:0);c=a+v,c>r||l.newline?(o+=s+i,a=0,c=v,s=f.width):s=Math.max(s,f.width);}l.newline||(d[0]=o,d[1]=a,"horizontal"===t?o=h+i:a=c+i);});}var r=i(4),o=i(9),a=i(7),s=i(6),l=a.parsePercent,u=r.each,h={},c=["left","right","top","bottom","width","height"];h.box=n,h.vbox=r.curry(n,"vertical"),h.hbox=r.curry(n,"horizontal"),h.getAvailableSize=function(t,e,i){var n=e.width,r=e.height,o=l(t.x,n),a=l(t.y,r),u=l(t.x2,n),h=l(t.y2,r);return(isNaN(o)||isNaN(parseFloat(t.x)))&&(o=0),(isNaN(u)||isNaN(parseFloat(t.x2)))&&(u=n),(isNaN(a)||isNaN(parseFloat(t.y)))&&(a=0),(isNaN(h)||isNaN(parseFloat(t.y2)))&&(h=r),i=s.normalizeCssArray(i||0),{width:Math.max(u-o-i[1]-i[3],0),height:Math.max(h-a-i[0]-i[2],0)};},h.getLayoutRect=function(t,e,i){i=s.normalizeCssArray(i||0);var n=e.width,r=e.height,a=l(t.left,n),u=l(t.top,r),h=l(t.right,n),c=l(t.bottom,r),d=l(t.width,n),f=l(t.height,r),p=i[2]+i[0],g=i[1]+i[3],m=t.aspect;switch(isNaN(d)&&(d=n-h-g-a),isNaN(f)&&(f=r-c-p-u),isNaN(d)&&isNaN(f)&&(m>n/r?d=.8*n:f=.8*r),null!=m&&(isNaN(d)&&(d=m*f),isNaN(f)&&(f=d/m)),isNaN(a)&&(a=n-h-d-g),isNaN(u)&&(u=r-c-f-p),t.left||t.right){case"center":a=n/2-d/2-i[3];break;case"right":a=n-d-g;}switch(t.top||t.bottom){case"middle":case"center":u=r/2-f/2-i[0];break;case"bottom":u=r-f-p;}a=a||0,u=u||0,isNaN(d)&&(d=n-a-(h||0)),isNaN(f)&&(f=r-u-(c||0));var v=new o(a+i[3],u+i[0],d,f);return v.margin=i,v;},h.positionGroup=function(t,e,i,n){var o=t.getBoundingRect();e=r.extend(r.clone(e),{width:o.width,height:o.height}),e=h.getLayoutRect(e,i,n),t.attr("position",[e.x-o.x,e.y-o.y]);},h.mergeLayoutParam=function(t,e,i){function n(n){var r={},s=0,l={},h=0,c=i.ignoreSize?1:2;if(u(n,function(e){l[e]=t[e];}),u(n,function(t){o(e,t)&&(r[t]=l[t]=e[t]),a(r,t)&&s++,a(l,t)&&h++;}),h!==c&&s){if(s>=c)return r;for(var d=0;d<n.length;d++){var f=n[d];if(!o(r,f)&&o(t,f)){r[f]=t[f];break;}}return r;}return l;}function o(t,e){return t.hasOwnProperty(e);}function a(t,e){return null!=t[e]&&"auto"!==t[e];}function s(t,e,i){u(t,function(t){e[t]=i[t];});}!r.isObject(i)&&(i={});var l=["width","left","right"],h=["height","top","bottom"],c=n(l),d=n(h);s(l,t,c),s(h,t,d);},h.getLayoutParams=function(t){return h.copyLayoutParams({},t);},h.copyLayoutParams=function(t,e){return e&&t&&u(c,function(i){e.hasOwnProperty(i)&&(t[i]=e[i]);}),t;},t.exports=h;},function(t,e){t.exports={getBoxLayoutParams:function getBoxLayoutParams(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")};}};},function(t,e){var i="";"undefined"!=typeof navigator&&(i=navigator.platform||""),t.exports={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],textStyle:{fontFamily:i.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:!0,animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3};},function(t,e){t.exports={clearColorPalette:function clearColorPalette(){this._colorIdx=0,this._colorNameMap={};},getColorFromPalette:function getColorFromPalette(t,e){e=e||this;var i=e._colorIdx||0,n=e._colorNameMap||(e._colorNameMap={});if(n[t])return n[t];var r=this.get("color",!0)||[];if(r.length){var o=r[i];return t&&(n[t]=o),e._colorIdx=(i+1)%r.length,o;}}};},function(t,e,i){"use strict";function n(t){r.each(o,function(e){this[e]=r.bind(t[e],t);},this);}var r=i(4),o=["getDom","getZr","getWidth","getHeight","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption"];t.exports=n;},function(t,e,i){"use strict";function n(){this._coordinateSystems=[];}var r=i(4),o={};n.prototype={constructor:n,create:function create(t,e){var i=[];r.each(o,function(n,r){var o=n.create(t,e);i=i.concat(o||[]);}),this._coordinateSystems=i;},update:function update(t,e){r.each(this._coordinateSystems,function(i){i.update&&i.update(t,e);});},getCoordinateSystems:function getCoordinateSystems(){return this._coordinateSystems.slice();}},n.register=function(t,e){o[t]=e;},n.get=function(t){return o[t];},t.exports=n;},function(t,e,i){function n(t){this._api=t,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption;}function r(t,e,i){var n,r,o=[],a=[],s=t.timeline;if(t.baseOption&&(r=t.baseOption),(s||t.options)&&(r=r||{},o=(t.options||[]).slice()),t.media){r=r||{};var l=t.media;d(l,function(t){t&&t.option&&(t.query?a.push(t):n||(n=t));});}return r||(r=t),r.timeline||(r.timeline=s),d([r].concat(o).concat(u.map(a,function(t){return t.option;})),function(t){d(e,function(e){e(t,i);});}),{baseOption:r,timelineOptions:o,mediaDefault:n,mediaList:a};}function o(t,e,i){var n={width:e,height:i,aspectratio:e/i},r=!0;return u.each(t,function(t,e){var i=e.match(m);if(i&&i[1]&&i[2]){var o=i[1],s=i[2].toLowerCase();a(n[s],t,o)||(r=!1);}}),r;}function a(t,e,i){return"min"===i?t>=e:"max"===i?e>=t:t===e;}function s(t,e){return t.join(",")===e.join(",");}function l(t,e){e=e||{},d(e,function(e,i){if(null!=e){var n=t[i];if(c.hasClass(i)){e=h.normalizeToArray(e),n=h.normalizeToArray(n);var r=h.mappingToExists(n,e);t[i]=p(r,function(t){return t.option&&t.exist?g(t.exist,t.option,!0):t.exist||t.option;});}else t[i]=g(n,e,!0);}});}var u=i(4),h=i(5),c=i(19),d=u.each,f=u.clone,p=u.map,g=u.merge,m=/^(min|max)?(.+)$/;n.prototype={constructor:n,setOption:function setOption(t,e){t=f(t,!0);var i=this._optionBackup,n=r.call(this,t,e,!i);this._newBaseOption=n.baseOption,i?(l(i.baseOption,n.baseOption),n.timelineOptions.length&&(i.timelineOptions=n.timelineOptions),n.mediaList.length&&(i.mediaList=n.mediaList),n.mediaDefault&&(i.mediaDefault=n.mediaDefault)):this._optionBackup=n;},mountOption:function mountOption(t){var e=this._optionBackup;return this._timelineOptions=p(e.timelineOptions,f),this._mediaList=p(e.mediaList,f),this._mediaDefault=f(e.mediaDefault),this._currentMediaIndices=[],f(t?e.baseOption:this._newBaseOption);},getTimelineOption:function getTimelineOption(t){var e,i=this._timelineOptions;if(i.length){var n=t.getComponent("timeline");n&&(e=f(i[n.getCurrentIndex()],!0));}return e;},getMediaOption:function getMediaOption(t){var e=this._api.getWidth(),i=this._api.getHeight(),n=this._mediaList,r=this._mediaDefault,a=[],l=[];if(!n.length&&!r)return l;for(var u=0,h=n.length;h>u;u++){o(n[u].query,e,i)&&a.push(u);}return!a.length&&r&&(a=[-1]),a.length&&!s(a,this._currentMediaIndices)&&(l=p(a,function(t){return f(-1===t?r.option:n[t].option);})),this._currentMediaIndices=a,l;}},t.exports=n;},function(t,e,i){"use strict";var n=i(4),r=i(6),o=i(5),a=i(19),s=i(24),l=i(2),u=r.encodeHTML,h=r.addCommas,c=a.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendDataProvider:null,visualColorAccessPath:"itemStyle.normal.color",init:function init(t,e,i,n){this.seriesIndex=this.componentIndex,this.mergeDefaultAndTheme(t,i),this._dataBeforeProcessed=this.getInitialData(t,i),this._data=this._dataBeforeProcessed.cloneShallow();},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){n.merge(t,e.getTheme().get(this.subType)),n.merge(t,this.getDefaultOption()),o.defaultEmphasis(t.label,o.LABEL_OPTIONS),this.fillDataTextStyle(t.data);},mergeOption:function mergeOption(t,e){t=n.merge(this.option,t,!0),this.fillDataTextStyle(t.data);var i=this.getInitialData(t,e);i&&(this._data=i,this._dataBeforeProcessed=i.cloneShallow());},fillDataTextStyle:function fillDataTextStyle(t){if(t)for(var e=0;e<t.length;e++){t[e]&&t[e].label&&o.defaultEmphasis(t[e].label,o.LABEL_OPTIONS);}},getInitialData:function getInitialData(){},getData:function getData(t){return null==t?this._data:this._data.getLinkedData(t);},setData:function setData(t){this._data=t;},getRawData:function getRawData(){return this._dataBeforeProcessed;},coordDimToDataDim:function coordDimToDataDim(t){return[t];},dataDimToCoordDim:function dataDimToCoordDim(t){return t;},getBaseAxis:function getBaseAxis(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis();},formatTooltip:function formatTooltip(t,e,i){function o(t){var i=[];return n.each(t,function(t,n){var o,s=a.getDimensionInfo(n),l=s&&s.type;o="ordinal"===l?t+"":"time"===l?e?"":r.formatTime("yyyy/mm/dd hh:mm:ss",t):h(t),o&&i.push(o);}),i.join(", ");}var a=this._data,s=this.getRawValue(t),l=n.isArray(s)?o(s):h(s),c=a.getName(t),d=a.getItemVisual(t,"color"),f='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+d+'"></span>',p=this.name;return"\x00-"===p&&(p=""),e?f+u(this.name)+" : "+l:(p&&u(p)+"<br />")+f+(c?u(c)+" : "+l:l);},ifEnableAnimation:function ifEnableAnimation(){if(l.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),t;},restoreData:function restoreData(){this._data=this._dataBeforeProcessed.cloneShallow();},getColorFromPalette:function getColorFromPalette(t,e){var i=this.ecModel,n=s.getColorFromPalette.call(this,t,e);return n||(n=i.getColorFromPalette(t,e)),n;},getAxisTooltipDataIndex:null,getTooltipPosition:null});n.mixin(c,o.dataFormatMixin),n.mixin(c,s),t.exports=c;},function(t,e,i){var n=i(30),r=i(20),o=i(13),a=function a(){this.group=new n(),this.uid=r.getUID("viewComponent");};a.prototype={constructor:a,init:function init(t,e){},render:function render(t,e,i,n){},dispose:function dispose(){}};var s=a.prototype;s.updateView=s.updateLayout=s.updateVisual=function(t,e,i,n){},o.enableClassExtend(a),o.enableClassManagement(a,{registerWhenExtend:!0}),t.exports=a;},function(t,e,i){var n=i(4),r=i(31),o=i(9),a=function a(t){t=t||{},r.call(this,t);for(var e in t){t.hasOwnProperty(e)&&(this[e]=t[e]);}this._children=[],this.__storage=null,this.__dirty=!0;};a.prototype={constructor:a,isGroup:!0,type:"group",silent:!1,children:function children(){return this._children.slice();},childAt:function childAt(t){return this._children[t];},childOfName:function childOfName(t){for(var e=this._children,i=0;i<e.length;i++){if(e[i].name===t)return e[i];}},childCount:function childCount(){return this._children.length;},add:function add(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this;},addBefore:function addBefore(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);n>=0&&(i.splice(n,0,t),this._doAdd(t));}return this;},_doAdd:function _doAdd(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__storage,i=this.__zr;e&&e!==t.__storage&&(e.addToMap(t),t instanceof a&&t.addChildrenToStorage(e)),i&&i.refresh();},remove:function remove(t){var e=this.__zr,i=this.__storage,r=this._children,o=n.indexOf(r,t);return 0>o?this:(r.splice(o,1),t.parent=null,i&&(i.delFromMap(t.id),t instanceof a&&t.delChildrenFromStorage(i)),e&&e.refresh(),this);},removeAll:function removeAll(){var t,e,i=this._children,n=this.__storage;for(e=0;e<i.length;e++){t=i[e],n&&(n.delFromMap(t.id),t instanceof a&&t.delChildrenFromStorage(n)),t.parent=null;}return i.length=0,this;},eachChild:function eachChild(t,e){for(var i=this._children,n=0;n<i.length;n++){var r=i[n];t.call(e,r,n);}return this;},traverse:function traverse(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i];t.call(e,n),"group"===n.type&&n.traverse(t,e);}return this;},addChildrenToStorage:function addChildrenToStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.addToMap(i),i instanceof a&&i.addChildrenToStorage(t);}},delChildrenFromStorage:function delChildrenFromStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.delFromMap(i.id),i instanceof a&&i.delChildrenFromStorage(t);}},dirty:function dirty(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this;},getBoundingRect:function getBoundingRect(t){for(var e=null,i=new o(0,0,0,0),n=t||this._children,r=[],a=0;a<n.length;a++){var s=n[a];if(!s.ignore&&!s.invisible){var l=s.getBoundingRect(),u=s.getLocalTransform(r);u?(i.copy(l),i.applyTransform(u),e=e||i.clone(),e.union(i)):(e=e||l.clone(),e.union(l));}}return e||i;}},n.inherits(a,r),t.exports=a;},function(t,e,i){"use strict";var n=i(32),r=i(33),o=i(34),a=i(35),s=i(4),l=function l(t){o.call(this,t),r.call(this,t),a.call(this,t),this.id=t.id||n();};l.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function drift(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0;}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=e,this.decomposeTransform(),this.dirty(!1);},beforeUpdate:function beforeUpdate(){},afterUpdate:function afterUpdate(){},update:function update(){this.updateTransform();},traverse:function traverse(t,e){},attrKV:function attrKV(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var i=this[t];i||(i=this[t]=[]),i[0]=e[0],i[1]=e[1];}}else this[t]=e;},hide:function hide(){this.ignore=!0,this.__zr&&this.__zr.refresh();},show:function show(){this.ignore=!1,this.__zr&&this.__zr.refresh();},attr:function attr(t,e){if("string"==typeof t)this.attrKV(t,e);else if(s.isObject(t))for(var i in t){t.hasOwnProperty(i)&&this.attrKV(i,t[i]);}return this.dirty(!1),this;},setClipPath:function setClipPath(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),this.clipPath=t,t.__zr=e,t.__clipTarget=this,this.dirty(!1);},removeClipPath:function removeClipPath(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1));},addSelfToZr:function addSelfToZr(t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.addAnimator(e[i]);}this.clipPath&&this.clipPath.addSelfToZr(t);},removeSelfFromZr:function removeSelfFromZr(t){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.removeAnimator(e[i]);}this.clipPath&&this.clipPath.removeSelfFromZr(t);}},s.mixin(l,a),s.mixin(l,o),s.mixin(l,r),t.exports=l;},function(t,e){var i=2311;t.exports=function(){return i++;};},function(t,e){var i=Array.prototype.slice,n=function n(){this._$handlers={};};n.prototype={constructor:n,one:function one(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var r=0;r<n[t].length;r++){if(n[t][r].h===e)return this;}return n[t].push({h:e,one:!0,ctx:i||this}),this;},on:function on(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var r=0;r<n[t].length;r++){if(n[t][r].h===e)return this;}return n[t].push({h:e,one:!1,ctx:i||this}),this;},isSilent:function isSilent(t){var e=this._$handlers;return e[t]&&e[t].length;},off:function off(t,e){var i=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],r=0,o=i[t].length;o>r;r++){i[t][r].h!=e&&n.push(i[t][r]);}i[t]=n;}i[t]&&0===i[t].length&&delete i[t];}else delete i[t];return this;},trigger:function trigger(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>3&&(e=i.call(e,1));for(var r=this._$handlers[t],o=r.length,a=0;o>a;){switch(n){case 1:r[a].h.call(r[a].ctx);break;case 2:r[a].h.call(r[a].ctx,e[1]);break;case 3:r[a].h.call(r[a].ctx,e[1],e[2]);break;default:r[a].h.apply(r[a].ctx,e);}r[a].one?(r.splice(a,1),o--):a++;}}return this;},triggerWithContext:function triggerWithContext(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>4&&(e=i.call(e,1,e.length-1));for(var r=e[e.length-1],o=this._$handlers[t],a=o.length,s=0;a>s;){switch(n){case 1:o[s].h.call(r);break;case 2:o[s].h.call(r,e[1]);break;case 3:o[s].h.call(r,e[1],e[2]);break;default:o[s].h.apply(r,e);}o[s].one?(o.splice(s,1),a--):s++;}}return this;}},t.exports=n;},function(t,e,i){"use strict";function n(t){return t>s||-s>t;}var r=i(11),o=i(10),a=r.identity,s=5e-5,l=function l(t){t=t||{},t.position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null;},u=l.prototype;u.transform=null,u.needLocalTransform=function(){return n(this.rotation)||n(this.position[0])||n(this.position[1])||n(this.scale[0]-1)||n(this.scale[1]-1);},u.updateTransform=function(){var t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;return i||e?(n=n||r.create(),i?this.getLocalTransform(n):a(n),e&&(i?r.mul(n,t.transform,n):r.copy(n,t.transform)),this.transform=n,this.invTransform=this.invTransform||r.create(),void r.invert(this.invTransform,n)):void(n&&a(n));},u.getLocalTransform=function(t){t=t||[],a(t);var e=this.origin,i=this.scale,n=this.rotation,o=this.position;return e&&(t[4]-=e[0],t[5]-=e[1]),r.scale(t,t,i),n&&r.rotate(t,t,n),e&&(t[4]+=e[0],t[5]+=e[1]),t[4]+=o[0],t[5]+=o[1],t;},u.setTransform=function(t){var e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0);},u.restoreTransform=function(t){var e=(this.transform,t.dpr||1);t.setTransform(e,0,0,e,0,0);};var h=[];u.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(r.mul(h,t.invTransform,e),e=h);var i=e[0]*e[0]+e[1]*e[1],o=e[2]*e[2]+e[3]*e[3],a=this.position,s=this.scale;n(i-1)&&(i=Math.sqrt(i)),n(o-1)&&(o=Math.sqrt(o)),e[0]<0&&(i=-i),e[3]<0&&(o=-o),a[0]=e[4],a[1]=e[5],s[0]=i,s[1]=o,this.rotation=Math.atan2(-e[1]/o,e[0]/i);}},u.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(i=-i),[e,i];},u.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&o.applyTransform(i,i,n),i;},u.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&o.applyTransform(i,i,n),i;},t.exports=l;},function(t,e,i){"use strict";var n=i(36),r=i(4),o=r.isString,a=r.isFunction,s=r.isObject,l=i(40),u=function u(){this.animators=[];};u.prototype={constructor:u,animate:function animate(t,e){var i,o=!1,a=this,s=this.__zr;if(t){var u=t.split("."),h=a;o="shape"===u[0];for(var c=0,d=u.length;d>c;c++){h&&(h=h[u[c]]);}h&&(i=h);}else i=a;if(!i)return void l('Property "'+t+'" is not existed in element '+a.id);var f=a.animators,p=new n(i,e);return p.during(function(t){a.dirty(o);}).done(function(){f.splice(r.indexOf(f,p),1);}),f.push(p),s&&s.animation.addAnimator(p),p;},stopAnimation:function stopAnimation(t){for(var e=this.animators,i=e.length,n=0;i>n;n++){e[n].stop(t);}return e.length=0,this;},animateTo:function animateTo(t,e,i,n,r){function s(){u--,u||r&&r();}o(i)?(r=n,n=i,i=0):a(n)?(r=n,n="linear",i=0):a(i)?(r=i,i=0):a(e)?(r=e,e=500):e||(e=500),this.stopAnimation(),this._animateToShallow("",this,t,e,i,n,r);var l=this.animators.slice(),u=l.length;u||r&&r();for(var h=0;h<l.length;h++){l[h].done(s).start(n);}},_animateToShallow:function _animateToShallow(t,e,i,n,o){var a={},l=0;for(var u in i){if(i.hasOwnProperty(u))if(null!=e[u])s(i[u])&&!r.isArrayLike(i[u])?this._animateToShallow(t?t+"."+u:u,e[u],i[u],n,o):(a[u]=i[u],l++);else if(null!=i[u])if(t){var h={};h[t]={},h[t][u]=i[u],this.attr(h);}else this.attr(u,i[u]);}return l>0&&this.animate(t,!1).when(null==n?500:n,a).delay(o||0),this;}},t.exports=u;},function(t,e,i){function n(t,e){return t[e];}function r(t,e,i){t[e]=i;}function o(t,e,i){return(e-t)*i+t;}function a(t,e,i){return i>.5?e:t;}function s(t,e,i,n,r){var a=t.length;if(1==r)for(var s=0;a>s;s++){n[s]=o(t[s],e[s],i);}else for(var l=t[0].length,s=0;a>s;s++){for(var u=0;l>u;u++){n[s][u]=o(t[s][u],e[s][u],i);}}}function l(t,e,i){var n=t.length,r=e.length;if(n!==r){var o=n>r;if(o)t.length=r;else for(var a=n;r>a;a++){t.push(1===i?e[a]:x.call(e[a]));}}for(var s=t[0]&&t[0].length,a=0;a<t.length;a++){if(1===i)isNaN(t[a])&&(t[a]=e[a]);else for(var l=0;s>l;l++){isNaN(t[a][l])&&(t[a][l]=e[a][l]);}}}function u(t,e,i){if(t===e)return!0;var n=t.length;if(n!==e.length)return!1;if(1===i){for(var r=0;n>r;r++){if(t[r]!==e[r])return!1;}}else for(var o=t[0].length,r=0;n>r;r++){for(var a=0;o>a;a++){if(t[r][a]!==e[r][a])return!1;}}return!0;}function h(t,e,i,n,r,o,a,s,l){var u=t.length;if(1==l)for(var h=0;u>h;h++){s[h]=c(t[h],e[h],i[h],n[h],r,o,a);}else for(var d=t[0].length,h=0;u>h;h++){for(var f=0;d>f;f++){s[h][f]=c(t[h][f],e[h][f],i[h][f],n[h][f],r,o,a);}}}function c(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e;}function d(t){if(y(t)){var e=t.length;if(y(t[0])){for(var i=[],n=0;e>n;n++){i.push(x.call(t[n]));}return i;}return x.call(t);}return t;}function f(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")";}function p(t,e,i,n,r){var d=t._getter,p=t._setter,v="spline"===e,x=n.length;if(x){var _,b=n[0].value,w=y(b),S=!1,M=!1,I=w&&y(b[0])?2:1;n.sort(function(t,e){return t.time-e.time;}),_=n[x-1].time;for(var T=[],A=[],L=n[0].value,C=!0,D=0;x>D;D++){T.push(n[D].time/_);var P=n[D].value;if(w&&u(P,L,I)||!w&&P===L||(C=!1),L=P,"string"==typeof P){var k=m.parse(P);k?(P=k,S=!0):M=!0;}A.push(P);}if(!C){for(var z=A[x-1],D=0;x-1>D;D++){w?l(A[D],z,I):!isNaN(A[D])||isNaN(z)||M||S||(A[D]=z);}w&&l(d(t._target,r),z,I);var O,E,R,N,V,B,G=0,F=0;if(S)var H=[0,0,0,0];var W=function W(t,e){var i;if(0>e)i=0;else if(F>e){for(O=Math.min(G+1,x-1),i=O;i>=0&&!(T[i]<=e);i--){}i=Math.min(i,x-2);}else{for(i=G;x>i&&!(T[i]>e);i++){}i=Math.min(i-1,x-2);}G=i,F=e;var n=T[i+1]-T[i];if(0!==n)if(E=(e-T[i])/n,v){if(N=A[i],R=A[0===i?i:i-1],V=A[i>x-2?x-1:i+1],B=A[i>x-3?x-1:i+2],w)h(R,N,V,B,E,E*E,E*E*E,d(t,r),I);else{var l;if(S)l=h(R,N,V,B,E,E*E,E*E*E,H,1),l=f(H);else{if(M)return a(N,V,E);l=c(R,N,V,B,E,E*E,E*E*E);}p(t,r,l);}}else if(w)s(A[i],A[i+1],E,d(t,r),I);else{var l;if(S)s(A[i],A[i+1],E,H,1),l=f(H);else{if(M)return a(A[i],A[i+1],E);l=o(A[i],A[i+1],E);}p(t,r,l);}},Z=new g({target:t._target,life:_,loop:t._loop,delay:t._delay,onframe:W,ondestroy:i});return e&&"spline"!==e&&(Z.easing=e),Z;}}}var g=i(37),m=i(39),v=i(4),y=v.isArrayLike,x=Array.prototype.slice,_=function _(t,e,i,o){this._tracks={},this._target=t,this._loop=e||!1,this._getter=i||n,this._setter=o||r,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[];};_.prototype={when:function when(t,e){var i=this._tracks;for(var n in e){if(e.hasOwnProperty(n)){if(!i[n]){i[n]=[];var r=this._getter(this._target,n);if(null==r)continue;0!==t&&i[n].push({time:0,value:d(r)});}i[n].push({time:t,value:e[n]});}}return this;},during:function during(t){return this._onframeList.push(t),this;},_doneCallback:function _doneCallback(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,i=0;e>i;i++){t[i].call(this);}},start:function start(t){var e,i=this,n=0,r=function r(){n--,n||i._doneCallback();};for(var o in this._tracks){if(this._tracks.hasOwnProperty(o)){var a=p(this,t,r,this._tracks[o],o);a&&(this._clipList.push(a),n++,this.animation&&this.animation.addClip(a),e=a);}}if(e){var s=e.onframe;e.onframe=function(t,e){s(t,e);for(var n=0;n<i._onframeList.length;n++){i._onframeList[n](t,e);}};}return n||this._doneCallback(),this;},stop:function stop(t){for(var e=this._clipList,i=this.animation,n=0;n<e.length;n++){var r=e[n];t&&r.onframe(this._target,1),i&&i.removeClip(r);}e.length=0;},delay:function delay(t){return this._delay=t,this;},done:function done(t){return t&&this._doneList.push(t),this;},getClips:function getClips(){return this._clipList;}},t.exports=_;},function(t,e,i){function n(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null==t.loop?!1:t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart;}var r=i(38);n.prototype={constructor:n,step:function step(t){this._initialized||(this._startTime=t+this._delay,this._initialized=!0);var e=(t-this._startTime)/this._life;if(!(0>e)){e=Math.min(e,1);var i=this.easing,n="string"==typeof i?r[i]:i,o="function"==typeof n?n(e):e;return this.fire("frame",o),1==e?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null;}},restart:function restart(t){var e=(t-this._startTime)%this._life;this._startTime=t-e+this.gap,this._needsRemove=!1;},fire:function fire(t,e){t="on"+t,this[t]&&this[t](this._target,e);}},t.exports=n;},function(t,e){var i={linear:function linear(t){return t;},quadraticIn:function quadraticIn(t){return t*t;},quadraticOut:function quadraticOut(t){return t*(2-t);},quadraticInOut:function quadraticInOut(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1);},cubicIn:function cubicIn(t){return t*t*t;},cubicOut:function cubicOut(t){return--t*t*t+1;},cubicInOut:function cubicInOut(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2);},quarticIn:function quarticIn(t){return t*t*t*t;},quarticOut:function quarticOut(t){return 1- --t*t*t*t;},quarticInOut:function quarticInOut(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2);},quinticIn:function quinticIn(t){return t*t*t*t*t;},quinticOut:function quinticOut(t){return--t*t*t*t*t+1;},quinticInOut:function quinticInOut(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2);},sinusoidalIn:function sinusoidalIn(t){return 1-Math.cos(t*Math.PI/2);},sinusoidalOut:function sinusoidalOut(t){return Math.sin(t*Math.PI/2);},sinusoidalInOut:function sinusoidalInOut(t){return.5*(1-Math.cos(Math.PI*t));},exponentialIn:function exponentialIn(t){return 0===t?0:Math.pow(1024,t-1);},exponentialOut:function exponentialOut(t){return 1===t?1:1-Math.pow(2,-10*t);},exponentialInOut:function exponentialInOut(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2);},circularIn:function circularIn(t){return 1-Math.sqrt(1-t*t);},circularOut:function circularOut(t){return Math.sqrt(1- --t*t);},circularInOut:function circularInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1);},elasticIn:function elasticIn(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)));},elasticOut:function elasticOut(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1);},elasticInOut:function elasticInOut(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1);},backIn:function backIn(t){var e=1.70158;return t*t*((e+1)*t-e);},backOut:function backOut(t){var e=1.70158;return--t*t*((e+1)*t+e)+1;},backInOut:function backInOut(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2);},bounceIn:function bounceIn(t){return 1-i.bounceOut(1-t);},bounceOut:function bounceOut(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375;},bounceInOut:function bounceInOut(t){return.5>t?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5;}};t.exports=i;},function(t,e){function i(t){return t=Math.round(t),0>t?0:t>255?255:t;}function n(t){return t=Math.round(t),0>t?0:t>360?360:t;}function r(t){return 0>t?0:t>1?1:t;}function o(t){return i(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100*255:parseInt(t,10));}function a(t){return r(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100:parseFloat(t));}function s(t,e,i){return 0>i?i+=1:i>1&&(i-=1),1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t;}function l(t,e,i){return t+(e-t)*i;}function u(t){if(t){t+="";var e=t.replace(/ /g,"").toLowerCase();if(e in x)return x[e].slice();if("#"!==e.charAt(0)){var i=e.indexOf("("),n=e.indexOf(")");if(-1!==i&&n+1===e.length){var r=e.substr(0,i),s=e.substr(i+1,n-(i+1)).split(","),l=1;switch(r){case"rgba":if(4!==s.length)return;l=a(s.pop());case"rgb":if(3!==s.length)return;return[o(s[0]),o(s[1]),o(s[2]),l];case"hsla":if(4!==s.length)return;return s[3]=a(s[3]),h(s);case"hsl":if(3!==s.length)return;return h(s);default:return;}}}else{if(4===e.length){var u=parseInt(e.substr(1),16);if(!(u>=0&&4095>=u))return;return[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1];}if(7===e.length){var u=parseInt(e.substr(1),16);if(!(u>=0&&16777215>=u))return;return[(16711680&u)>>16,(65280&u)>>8,255&u,1];}}}}function h(t){var e=(parseFloat(t[0])%360+360)%360/360,n=a(t[1]),r=a(t[2]),o=.5>=r?r*(n+1):r+n-r*n,l=2*r-o,u=[i(255*s(l,o,e+1/3)),i(255*s(l,o,e)),i(255*s(l,o,e-1/3))];return 4===t.length&&(u[3]=t[3]),u;}function c(t){if(t){var e,i,n=t[0]/255,r=t[1]/255,o=t[2]/255,a=Math.min(n,r,o),s=Math.max(n,r,o),l=s-a,u=(s+a)/2;if(0===l)e=0,i=0;else{i=.5>u?l/(s+a):l/(2-s-a);var h=((s-n)/6+l/2)/l,c=((s-r)/6+l/2)/l,d=((s-o)/6+l/2)/l;n===s?e=d-c:r===s?e=1/3+h-d:o===s&&(e=2/3+c-h),0>e&&(e+=1),e>1&&(e-=1);}var f=[360*e,i,u];return null!=t[3]&&f.push(t[3]),f;}}function d(t,e){var i=u(t);if(i){for(var n=0;3>n;n++){0>e?i[n]=i[n]*(1-e)|0:i[n]=(255-i[n])*e+i[n]|0;}return y(i,4===i.length?"rgba":"rgb");}}function f(t,e){var i=u(t);return i?((1<<24)+(i[0]<<16)+(i[1]<<8)+ +i[2]).toString(16).slice(1):void 0;}function p(t,e,n){if(e&&e.length&&t>=0&&1>=t){n=n||[0,0,0,0];var r=t*(e.length-1),o=Math.floor(r),a=Math.ceil(r),s=e[o],u=e[a],h=r-o;return n[0]=i(l(s[0],u[0],h)),n[1]=i(l(s[1],u[1],h)),n[2]=i(l(s[2],u[2],h)),n[3]=i(l(s[3],u[3],h)),n;}}function g(t,e,n){if(e&&e.length&&t>=0&&1>=t){var o=t*(e.length-1),a=Math.floor(o),s=Math.ceil(o),h=u(e[a]),c=u(e[s]),d=o-a,f=y([i(l(h[0],c[0],d)),i(l(h[1],c[1],d)),i(l(h[2],c[2],d)),r(l(h[3],c[3],d))],"rgba");return n?{color:f,leftIndex:a,rightIndex:s,value:o}:f;}}function m(t,e,i,r){return t=u(t),t?(t=c(t),null!=e&&(t[0]=n(e)),null!=i&&(t[1]=a(i)),null!=r&&(t[2]=a(r)),y(h(t),"rgba")):void 0;}function v(t,e){return t=u(t),t&&null!=e?(t[3]=r(e),y(t,"rgba")):void 0;}function y(t,e){var i=t[0]+","+t[1]+","+t[2];return("rgba"===e||"hsva"===e||"hsla"===e)&&(i+=","+t[3]),e+"("+i+")";}var x={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};t.exports={parse:u,lift:d,toHex:f,fastMapToColor:p,mapToColor:g,modifyHSL:m,modifyAlpha:v,stringify:y};},function(t,e,i){var n=i(41);t.exports=function(){if(0!==n.debugMode)if(1==n.debugMode)for(var t in arguments){throw new Error(arguments[t]);}else if(n.debugMode>1)for(var t in arguments){console.log(arguments[t]);}};},function(t,e){var i=1;"undefined"!=typeof window&&(i=Math.max(window.devicePixelRatio||1,1));var n={debugMode:0,devicePixelRatio:i};t.exports=n;},function(t,e,i){function n(){this.group=new a(),this.uid=s.getUID("viewChart");}function r(t,e){if(t&&(t.trigger(e),"group"===t.type))for(var i=0;i<t.childCount();i++){r(t.childAt(i),e);}}function o(t,e,i){var n=u.queryDataIndex(t,e);null!=n?h.each(u.normalizeToArray(n),function(e){r(t.getItemGraphicEl(e),i);}):t.eachItemGraphicEl(function(t){r(t,i);});}var a=i(30),s=i(20),l=i(13),u=i(5),h=i(4);n.prototype={type:"chart",init:function init(t,e){},render:function render(t,e,i,n){},highlight:function highlight(t,e,i,n){o(t.getData(),n,"emphasis");},downplay:function downplay(t,e,i,n){o(t.getData(),n,"normal");},remove:function remove(t,e){this.group.removeAll();},dispose:function dispose(){}};var c=n.prototype;c.updateView=c.updateLayout=c.updateVisual=function(t,e,i,n){this.render(t,e,i,n);},l.enableClassExtend(n,["dispose"]),l.enableClassManagement(n,{registerWhenExtend:!0}),t.exports=n;},function(t,e,i){"use strict";function n(t){return null!=t&&"none"!=t;}function r(t){return"string"==typeof t?_.lift(t,-.1):t;}function o(t){if(t.__hoverStlDirty){var e=t.style.stroke,i=t.style.fill,o=t.__hoverStl;o.fill=o.fill||(n(i)?r(i):null),o.stroke=o.stroke||(n(e)?r(e):null);var a={};for(var s in o){o.hasOwnProperty(s)&&(a[s]=t.style[s]);}t.__normalStl=a,t.__hoverStlDirty=!1;}}function a(t){t.__isHover||(o(t),t.useHoverLayer?t.__zr&&t.__zr.addHover(t,t.__hoverStl):(t.setStyle(t.__hoverStl),t.z2+=1),t.__isHover=!0);}function s(t){if(t.__isHover){var e=t.__normalStl;t.useHoverLayer?t.__zr&&t.__zr.removeHover(t):(e&&t.setStyle(e),t.z2-=1),t.__isHover=!1;}}function l(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&a(t);}):a(t);}function u(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&s(t);}):s(t);}function h(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0,t.__isHover&&o(t);}function c(){!this.__isEmphasis&&l(this);}function d(){!this.__isEmphasis&&u(this);}function f(){this.__isEmphasis=!0,l(this);}function p(){this.__isEmphasis=!1,u(this);}function g(t,e,i,n,r,o){"function"==typeof r&&(o=r,r=null);var a=n&&(n.ifEnableAnimation?n.ifEnableAnimation():n.getShallow("animation"));if(a){var s=t?"Update":"",l=n&&n.getShallow("animationDuration"+s),u=n&&n.getShallow("animationEasing"+s),h=n&&n.getShallow("animationDelay"+s);"function"==typeof h&&(h=h(r)),l>0?e.animateTo(i,l,h||0,u,o):(e.attr(i),o&&o());}else e.attr(i),o&&o();}var m=i(4),v=i(44),y=Math.round,x=i(45),_=i(39),b=i(11),w=i(10),S=(i(61),{});S.Group=i(30),S.Image=i(62),S.Text=i(64),S.Circle=i(65),S.Sector=i(66),S.Ring=i(67),S.Polygon=i(68),S.Polyline=i(72),S.Rect=i(73),S.Line=i(75),S.BezierCurve=i(76),S.Arc=i(77),S.CompoundPath=i(78),S.LinearGradient=i(79),S.RadialGradient=i(80),S.BoundingRect=i(9),S.extendShape=function(t){return x.extend(t);},S.extendPath=function(t,e){return v.extendFromString(t,e);},S.makePath=function(t,e,i,n){var r=v.createFromString(t,e),o=r.getBoundingRect();if(i){var a=o.width/o.height;if("center"===n){var s,l=i.height*a;l<=i.width?s=i.height:(l=i.width,s=l/a);var u=i.x+i.width/2,h=i.y+i.height/2;i.x=u-l/2,i.y=h-s/2,i.width=l,i.height=s;}this.resizePath(r,i);}return r;},S.mergePath=v.mergePath,S.resizePath=function(t,e){if(t.applyTransform){var i=t.getBoundingRect(),n=i.calculateTransform(e);t.applyTransform(n);}},S.subPixelOptimizeLine=function(t){var e=S.subPixelOptimize,i=t.shape,n=t.style.lineWidth;return y(2*i.x1)===y(2*i.x2)&&(i.x1=i.x2=e(i.x1,n,!0)),y(2*i.y1)===y(2*i.y2)&&(i.y1=i.y2=e(i.y1,n,!0)),t;},S.subPixelOptimizeRect=function(t){var e=S.subPixelOptimize,i=t.shape,n=t.style.lineWidth,r=i.x,o=i.y,a=i.width,s=i.height;return i.x=e(i.x,n,!0),i.y=e(i.y,n,!0),i.width=Math.max(e(r+a,n,!1)-i.x,0===a?0:1),i.height=Math.max(e(o+s,n,!1)-i.y,0===s?0:1),t;},S.subPixelOptimize=function(t,e,i){var n=y(2*t);return(n+y(e))%2===0?n/2:(n+(i?1:-1))/2;},S.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&h(t,e);}):h(t,e),t.on("mouseover",c).on("mouseout",d),t.on("emphasis",f).on("normal",p);},S.setText=function(t,e,i){var n=e.getShallow("position")||"inside",r=n.indexOf("inside")>=0?"white":i,o=e.getModel("textStyle");m.extend(t,{textDistance:e.getShallow("distance")||5,textFont:o.getFont(),textPosition:n,textFill:o.getTextColor()||r});},S.updateProps=function(t,e,i,n,r){g(!0,t,e,i,n,r);},S.initProps=function(t,e,i,n,r){g(!1,t,e,i,n,r);},S.getTransform=function(t,e){for(var i=b.identity([]);t&&t!==e;){b.mul(i,t.getLocalTransform(),i),t=t.parent;}return i;},S.applyTransform=function(t,e,i){return i&&(e=b.invert([],e)),w.applyTransform([],t,e);},S.transformDirection=function(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-n:"right"===t?n:0,"top"===t?-r:"bottom"===t?r:0];return o=S.applyTransform(o,e,i),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top";},S.groupTransition=function(t,e,i,n){function r(t){var e={};return t.traverse(function(t){!t.isGroup&&t.anid&&(e[t.anid]=t);}),e;}function o(t){var e={position:w.clone(t.position),rotation:t.rotation};return t.shape&&(e.shape=m.extend({},t.shape)),e;}if(t&&e){var a=r(t);e.traverse(function(t){if(!t.isGroup&&t.anid){var e=a[t.anid];if(e){var n=o(t);t.attr(o(e)),S.updateProps(t,n,i,t.dataIndex);}}});}},t.exports=S;},function(t,e,i){function n(t,e,i,n,r,o,a,s,l,u,h){var g=l*(p/180),y=f(g)*(t-i)/2+d(g)*(e-n)/2,x=-1*d(g)*(t-i)/2+f(g)*(e-n)/2,_=y*y/(a*a)+x*x/(s*s);_>1&&(a*=c(_),s*=c(_));var b=(r===o?-1:1)*c((a*a*(s*s)-a*a*(x*x)-s*s*(y*y))/(a*a*(x*x)+s*s*(y*y)))||0,w=b*a*x/s,S=b*-s*y/a,M=(t+i)/2+f(g)*w-d(g)*S,I=(e+n)/2+d(g)*w+f(g)*S,T=v([1,0],[(y-w)/a,(x-S)/s]),A=[(y-w)/a,(x-S)/s],L=[(-1*y-w)/a,(-1*x-S)/s],C=v(A,L);m(A,L)<=-1&&(C=p),m(A,L)>=1&&(C=0),0===o&&C>0&&(C-=2*p),1===o&&0>C&&(C+=2*p),h.addData(u,M,I,a,s,T,C,g,o);}function r(t){if(!t)return[];var e,i=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<h.length;e++){i=i.replace(new RegExp(h[e],"g"),"|"+h[e]);}var r,o=i.split("|"),a=0,l=0,u=new s(),c=s.CMD;for(e=1;e<o.length;e++){var d,f=o[e],p=f.charAt(0),g=0,m=f.slice(1).replace(/e,-/g,"e-").split(",");m.length>0&&""===m[0]&&m.shift();for(var v=0;v<m.length;v++){m[v]=parseFloat(m[v]);}for(;g<m.length&&!isNaN(m[g])&&!isNaN(m[0]);){var y,x,_,b,w,S,M,I=a,T=l;switch(p){case"l":a+=m[g++],l+=m[g++],d=c.L,u.addData(d,a,l);break;case"L":a=m[g++],l=m[g++],d=c.L,u.addData(d,a,l);break;case"m":a+=m[g++],l+=m[g++],d=c.M,u.addData(d,a,l),p="l";break;case"M":a=m[g++],l=m[g++],d=c.M,u.addData(d,a,l),p="L";break;case"h":a+=m[g++],d=c.L,u.addData(d,a,l);break;case"H":a=m[g++],d=c.L,u.addData(d,a,l);break;case"v":l+=m[g++],d=c.L,u.addData(d,a,l);break;case"V":l=m[g++],d=c.L,u.addData(d,a,l);break;case"C":d=c.C,u.addData(d,m[g++],m[g++],m[g++],m[g++],m[g++],m[g++]),a=m[g-2],l=m[g-1];break;case"c":d=c.C,u.addData(d,m[g++]+a,m[g++]+l,m[g++]+a,m[g++]+l,m[g++]+a,m[g++]+l),a+=m[g-2],l+=m[g-1];break;case"S":y=a,x=l;var A=u.len(),L=u.data;r===c.C&&(y+=a-L[A-4],x+=l-L[A-3]),d=c.C,I=m[g++],T=m[g++],a=m[g++],l=m[g++],u.addData(d,y,x,I,T,a,l);break;case"s":y=a,x=l;var A=u.len(),L=u.data;r===c.C&&(y+=a-L[A-4],x+=l-L[A-3]),d=c.C,I=a+m[g++],T=l+m[g++],a+=m[g++],l+=m[g++],u.addData(d,y,x,I,T,a,l);break;case"Q":I=m[g++],T=m[g++],a=m[g++],l=m[g++],d=c.Q,u.addData(d,I,T,a,l);break;case"q":I=m[g++]+a,T=m[g++]+l,a+=m[g++],l+=m[g++],d=c.Q,u.addData(d,I,T,a,l);break;case"T":y=a,x=l;var A=u.len(),L=u.data;r===c.Q&&(y+=a-L[A-4],x+=l-L[A-3]),a=m[g++],l=m[g++],d=c.Q,u.addData(d,y,x,a,l);break;case"t":y=a,x=l;var A=u.len(),L=u.data;r===c.Q&&(y+=a-L[A-4],x+=l-L[A-3]),a+=m[g++],l+=m[g++],d=c.Q,u.addData(d,y,x,a,l);break;case"A":_=m[g++],b=m[g++],w=m[g++],S=m[g++],M=m[g++],I=a,T=l,a=m[g++],l=m[g++],d=c.A,n(I,T,a,l,S,M,_,b,w,d,u);break;case"a":_=m[g++],b=m[g++],w=m[g++],S=m[g++],M=m[g++],I=a,T=l,a+=m[g++],l+=m[g++],d=c.A,n(I,T,a,l,S,M,_,b,w,d,u);}}("z"===p||"Z"===p)&&(d=c.Z,u.addData(d)),r=d;}return u.toStatic(),u;}function o(t,e){var i,n=r(t);return e=e||{},e.buildPath=function(t){t.setData(n.data),i&&l(t,i);var e=t.getContext();e&&t.rebuildPath(e);},e.applyTransform=function(t){i||(i=u.create()),u.mul(i,t,i),this.dirty(!0);},e;}var a=i(45),s=i(49),l=i(60),u=i(11),h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],c=Math.sqrt,d=Math.sin,f=Math.cos,p=Math.PI,g=function g(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);},m=function m(t,e){return(t[0]*e[0]+t[1]*e[1])/(g(t)*g(e));},v=function v(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(m(t,e));};t.exports={createFromString:function createFromString(t,e){return new a(o(t,e));},extendFromString:function extendFromString(t,e){return a.extend(o(t,e));},mergePath:function mergePath(t,e){for(var i=[],n=t.length,r=0;n>r;r++){var o=t[r];o.__dirty&&o.buildPath(o.path,o.shape,!0),i.push(o.path);}var s=new a(e);return s.buildPath=function(t){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e);},s;}};},function(t,e,i){function n(t){r.call(this,t),this.path=new a();}var r=i(46),o=i(4),a=i(49),s=i(52),l=i(59),u=l.prototype.getCanvasPattern,h=Math.abs;n.prototype={constructor:n,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function brush(t,e){var i=this.style,n=this.path,r=i.hasStroke(),o=i.hasFill(),a=i.fill,s=i.stroke,l=o&&!!a.colorStops,h=r&&!!s.colorStops,c=o&&!!a.image,d=r&&!!s.image;if(i.bind(t,this,e),this.setTransform(t),this.__dirty){var f=this.getBoundingRect();l&&(this._fillGradient=i.getGradient(t,a,f)),h&&(this._strokeGradient=i.getGradient(t,s,f));}l?t.fillStyle=this._fillGradient:c&&(t.fillStyle=u.call(a,t)),h?t.strokeStyle=this._strokeGradient:d&&(t.strokeStyle=u.call(s,t));var p=i.lineDash,g=i.lineDashOffset,m=!!t.setLineDash,v=this.getGlobalScale();n.setScale(v[0],v[1]),this.__dirtyPath||p&&!m&&r?(n=this.path.beginPath(t),p&&!m&&(n.setLineDash(p),n.setLineDashOffset(g)),this.buildPath(n,this.shape,!1),this.__dirtyPath=!1):(t.beginPath(),this.path.rebuildPath(t)),o&&n.fill(t),p&&m&&(t.setLineDash(p),t.lineDashOffset=g),r&&n.stroke(t),p&&m&&t.setLineDash([]),this.restoreTransform(t),(i.text||0===i.text)&&this.drawRectText(t,this.getBoundingRect());},buildPath:function buildPath(t,e,i){},getBoundingRect:function getBoundingRect(){var t=this._rect,e=this.style,i=!t;if(i){var n=this.path;this.__dirtyPath&&(n.beginPath(),this.buildPath(n,this.shape,!1)),t=n.getBoundingRect();}if(this._rect=t,e.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){r.copy(t);var o=e.lineWidth,a=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),a>1e-10&&(r.width+=o/a,r.height+=o/a,r.x-=o/a/2,r.y-=o/a/2);}return r;}return t;},contain:function contain(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),r=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var o=this.path.data;if(r.hasStroke()){var a=r.lineWidth,l=r.strokeNoScale?this.getLineScale():1;if(l>1e-10&&(r.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),s.containStroke(o,a/l,t,e)))return!0;}if(r.hasFill())return s.contain(o,t,e);}return!1;},dirty:function dirty(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty();},animateShape:function animateShape(t){return this.animate("shape",t);},attrKV:function attrKV(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):r.prototype.attrKV.call(this,t,e);},setShape:function setShape(t,e){var i=this.shape;if(i){if(o.isObject(t))for(var n in t){t.hasOwnProperty(n)&&(i[n]=t[n]);}else i[t]=e;this.dirty(!0);}return this;},getLineScale:function getLineScale(){var t=this.transform;return t&&h(t[0]-1)>1e-10&&h(t[3]-1)>1e-10?Math.sqrt(h(t[0]*t[3]-t[2]*t[1])):1;}},n.extend=function(t){var e=function e(_e){n.call(this,_e),t.style&&this.style.extendFrom(t.style,!1);var i=t.shape;if(i){this.shape=this.shape||{};var r=this.shape;for(var o in i){!r.hasOwnProperty(o)&&i.hasOwnProperty(o)&&(r[o]=i[o]);}}t.init&&t.init.call(this,_e);};o.inherits(e,n);for(var i in t){"style"!==i&&"shape"!==i&&(e.prototype[i]=t[i]);}return e;},o.inherits(n,r),t.exports=n;},function(t,e,i){function n(t){t=t||{},a.call(this,t);for(var e in t){t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);}this.style=new o(t.style),this._rect=null,this.__clipPaths=[];}var r=i(4),o=i(47),a=i(31),s=i(48);n.prototype={constructor:n,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function beforeBrush(t){},afterBrush:function afterBrush(t){},brush:function brush(t,e){},getBoundingRect:function getBoundingRect(){},contain:function contain(t,e){return this.rectContain(t,e);},traverse:function traverse(t,e){t.call(e,this);},rectContain:function rectContain(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect();return n.contain(i[0],i[1]);},dirty:function dirty(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh();},animateStyle:function animateStyle(t){return this.animate("style",t);},attrKV:function attrKV(t,e){"style"!==t?a.prototype.attrKV.call(this,t,e):this.style.set(e);},setStyle:function setStyle(t,e){return this.style.set(t,e),this.dirty(!1),this;},useStyle:function useStyle(t){return this.style=new o(t),this.dirty(!1),this;}},r.inherits(n,a),r.mixin(n,s),t.exports=n;},function(t,e){function i(t,e,i){var n=e.x,r=e.x2,o=e.y,a=e.y2;e.global||(n=n*i.width+i.x,r=r*i.width+i.x,o=o*i.height+i.y,a=a*i.height+i.y);var s=t.createLinearGradient(n,o,r,a);return s;}function n(t,e,i){var n=i.width,r=i.height,o=Math.min(n,r),a=e.x,s=e.y,l=e.r;e.global||(a=a*n+i.x,s=s*r+i.y,l*=o);var u=t.createRadialGradient(a,s,0,a,s,l);return u;}var r=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],o=function o(t){this.extendFrom(t);};o.prototype={constructor:o,fill:"#000000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,textFill:"#000",textStroke:null,textPosition:"inside",textBaseline:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textTransform:!1,textRotation:0,blend:null,bind:function bind(t,e,i){for(var n=this,o=i&&i.style,a=!o,s=0;s<r.length;s++){var l=r[s],u=l[0];(a||n[u]!==o[u])&&(t[u]=n[u]||l[1]);}if((a||n.fill!==o.fill)&&(t.fillStyle=n.fill),(a||n.stroke!==o.stroke)&&(t.strokeStyle=n.stroke),(a||n.opacity!==o.opacity)&&(t.globalAlpha=null==n.opacity?1:n.opacity),(a||n.blend!==o.blend)&&(t.globalCompositeOperation=n.blend||"source-over"),this.hasStroke()){var h=n.lineWidth;t.lineWidth=h/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1);}},hasFill:function hasFill(){var t=this.fill;return null!=t&&"none"!==t;},hasStroke:function hasStroke(){var t=this.stroke;return null!=t&&"none"!==t&&this.lineWidth>0;},extendFrom:function extendFrom(t,e){if(t){var i=this;for(var n in t){!t.hasOwnProperty(n)||!e&&i.hasOwnProperty(n)||(i[n]=t[n]);}}},set:function set(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0);},clone:function clone(){var t=new this.constructor();return t.extendFrom(this,!0),t;},getGradient:function getGradient(t,e,r){for(var o="radial"===e.type?n:i,a=o(t,e,r),s=e.colorStops,l=0;l<s.length;l++){a.addColorStop(s[l].offset,s[l].color);}return a;}};for(var a=o.prototype,s=0;s<r.length;s++){var l=r[s];l[0]in a||(a[l[0]]=l[1]);}o.getGradient=a.getGradient,t.exports=o;},function(t,e,i){function n(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t;}var r=i(8),o=i(9),a=new o(),s=function s(){};s.prototype={constructor:s,drawRectText:function drawRectText(t,e,i){var o=this.style,s=o.text;if(null!=s&&(s+=""),s){t.save();var l,u,h=o.textPosition,c=o.textDistance,d=o.textAlign,f=o.textFont||o.font,p=o.textBaseline,g=o.textVerticalAlign;i=i||r.getBoundingRect(s,f,d,p);var m=this.transform;if(o.textTransform?this.setTransform(t):m&&(a.copy(e),a.applyTransform(m),e=a),h instanceof Array){if(l=e.x+n(h[0],e.width),u=e.y+n(h[1],e.height),d=d||"left",p=p||"top",g){switch(g){case"middle":u-=i.height/2-i.lineHeight/2;break;case"bottom":u-=i.height-i.lineHeight/2;break;default:u+=i.lineHeight/2;}p="middle";}}else{var v=r.adjustTextPositionOnRect(h,e,i,c);l=v.x,u=v.y,d=d||v.textAlign,p=p||v.textBaseline;}t.textAlign=d||"left",t.textBaseline=p||"alphabetic";var y=o.textFill,x=o.textStroke;y&&(t.fillStyle=y),x&&(t.strokeStyle=x),t.font=f||"12px sans-serif",t.shadowBlur=o.textShadowBlur,t.shadowColor=o.textShadowColor||"transparent",t.shadowOffsetX=o.textShadowOffsetX,t.shadowOffsetY=o.textShadowOffsetY;var _=s.split("\n");o.textRotation&&(m&&t.translate(m[4],m[5]),t.rotate(o.textRotation),m&&t.translate(-m[4],-m[5]));for(var b=0;b<_.length;b++){y&&t.fillText(_[b],l,u),x&&t.strokeText(_[b],l,u),u+=i.lineHeight;}t.restore();}}},t.exports=s;},function(t,e,i){"use strict";var n=i(50),r=i(10),o=i(51),a=i(9),s=i(41).devicePixelRatio,l={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},u=[],h=[],c=[],d=[],f=Math.min,p=Math.max,g=Math.cos,m=Math.sin,v=Math.sqrt,y=Math.abs,x="undefined"!=typeof Float32Array,_=function _(){this.data=[],this._len=0,this._ctx=null,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._ux=0,this._uy=0;};_.prototype={constructor:_,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function setScale(t,e){this._ux=y(1/s/t)||0,this._uy=y(1/s/e)||0;},getContext:function getContext(){return this._ctx;},beginPath:function beginPath(t){return this._ctx=t,t&&t.beginPath(),t&&(this.dpr=t.dpr),this._len=0,this._lineDash&&(this._lineDash=null,this._dashOffset=0),this;},moveTo:function moveTo(t,e){return this.addData(l.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this;},lineTo:function lineTo(t,e){var i=y(t-this._xi)>this._ux||y(e-this._yi)>this._uy||this._len<5;return this.addData(l.L,t,e),this._ctx&&i&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),i&&(this._xi=t,this._yi=e),this;},bezierCurveTo:function bezierCurveTo(t,e,i,n,r,o){return this.addData(l.C,t,e,i,n,r,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,r,o):this._ctx.bezierCurveTo(t,e,i,n,r,o)),this._xi=r,this._yi=o,this;},quadraticCurveTo:function quadraticCurveTo(t,e,i,n){return this.addData(l.Q,t,e,i,n),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this;},arc:function arc(t,e,i,n,r,o){return this.addData(l.A,t,e,i,i,n,r-n,0,o?0:1),this._ctx&&this._ctx.arc(t,e,i,n,r,o),this._xi=g(r)*i+t,this._xi=m(r)*i+t,this;},arcTo:function arcTo(t,e,i,n,r){return this._ctx&&this._ctx.arcTo(t,e,i,n,r),this;},rect:function rect(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this.addData(l.R,t,e,i,n),this;},closePath:function closePath(){this.addData(l.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this;},fill:function fill(t){t&&t.fill(),this.toStatic();},stroke:function stroke(t){t&&t.stroke(),this.toStatic();},setLineDash:function setLineDash(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;for(var e=0,i=0;i<t.length;i++){e+=t[i];}this._dashSum=e;}return this;},setLineDashOffset:function setLineDashOffset(t){return this._dashOffset=t,this;},len:function len(){return this._len;},setData:function setData(t){var e=t.length;this.data&&this.data.length==e||!x||(this.data=new Float32Array(e));for(var i=0;e>i;i++){this.data[i]=t[i];}this._len=e;},appendPath:function appendPath(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,r=0;e>r;r++){i+=t[r].len();}x&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i));for(var r=0;e>r;r++){for(var o=t[r].data,a=0;a<o.length;a++){this.data[n++]=o[a];}}this._len=n;},addData:function addData(t){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++){e[this._len++]=arguments[i];}this._prevCmd=t;},_expandData:function _expandData(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++){t[e]=this.data[e];}this.data=t;}},_needsDash:function _needsDash(){return this._lineDash;},_dashedLineTo:function _dashedLineTo(t,e){var i,n,r=this._dashSum,o=this._dashOffset,a=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,h=t-l,c=e-u,d=v(h*h+c*c),g=l,m=u,y=a.length;for(h/=d,c/=d,0>o&&(o=r+o),o%=r,g-=o*h,m-=o*c;h>0&&t>=g||0>h&&g>=t||0==h&&(c>0&&e>=m||0>c&&m>=e);){n=this._dashIdx,i=a[n],g+=h*i,m+=c*i,this._dashIdx=(n+1)%y,h>0&&l>g||0>h&&g>l||c>0&&u>m||0>c&&m>u||s[n%2?"moveTo":"lineTo"](h>=0?f(g,t):p(g,t),c>=0?f(m,e):p(m,e));}h=g-t,c=m-e,this._dashOffset=-v(h*h+c*c);},_dashedBezierTo:function _dashedBezierTo(t,e,i,r,o,a){var s,l,u,h,c,d=this._dashSum,f=this._dashOffset,p=this._lineDash,g=this._ctx,m=this._xi,y=this._yi,x=n.cubicAt,_=0,b=this._dashIdx,w=p.length,S=0;for(0>f&&(f=d+f),f%=d,s=0;1>s;s+=.1){l=x(m,t,i,o,s+.1)-x(m,t,i,o,s),u=x(y,e,r,a,s+.1)-x(y,e,r,a,s),_+=v(l*l+u*u);}for(;w>b&&(S+=p[b],!(S>f));b++){}for(s=(S-f)/_;1>=s;){h=x(m,t,i,o,s),c=x(y,e,r,a,s),b%2?g.moveTo(h,c):g.lineTo(h,c),s+=p[b]/_,b=(b+1)%w;}b%2!==0&&g.lineTo(o,a),l=o-h,u=a-c,this._dashOffset=-v(l*l+u*u);},_dashedQuadraticTo:function _dashedQuadraticTo(t,e,i,n){var r=i,o=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,r,o);},toStatic:function toStatic(){var t=this.data;t instanceof Array&&(t.length=this._len,x&&(this.data=new Float32Array(t)));},getBoundingRect:function getBoundingRect(){u[0]=u[1]=c[0]=c[1]=Number.MAX_VALUE,h[0]=h[1]=d[0]=d[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,i=0,n=0,s=0,f=0;f<t.length;){var p=t[f++];switch(1==f&&(e=t[f],i=t[f+1],n=e,s=i),p){case l.M:n=t[f++],s=t[f++],e=n,i=s,c[0]=n,c[1]=s,d[0]=n,d[1]=s;break;case l.L:o.fromLine(e,i,t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.C:o.fromCubic(e,i,t[f++],t[f++],t[f++],t[f++],t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.Q:o.fromQuadratic(e,i,t[f++],t[f++],t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.A:var v=t[f++],y=t[f++],x=t[f++],_=t[f++],b=t[f++],w=t[f++]+b,S=(t[f++],1-t[f++]);1==f&&(n=g(b)*x+v,s=m(b)*_+y),o.fromArc(v,y,x,_,b,w,S,c,d),e=g(w)*x+v,i=m(w)*_+y;break;case l.R:n=e=t[f++],s=i=t[f++];var M=t[f++],I=t[f++];o.fromLine(n,s,n+M,s+I,c,d);break;case l.Z:e=n,i=s;}r.min(u,u,c),r.max(h,h,d);}return 0===f&&(u[0]=u[1]=h[0]=h[1]=0),new a(u[0],u[1],h[0]-u[0],h[1]-u[1]);},rebuildPath:function rebuildPath(t){for(var e,i,n,r,o,a,s=this.data,u=this._ux,h=this._uy,c=this._len,d=0;c>d;){var f=s[d++];switch(1==d&&(n=s[d],r=s[d+1],e=n,i=r),f){case l.M:e=n=s[d++],i=r=s[d++],t.moveTo(n,r);break;case l.L:o=s[d++],a=s[d++],(y(o-n)>u||y(a-r)>h||d===c-1)&&(t.lineTo(o,a),n=o,r=a);break;case l.C:t.bezierCurveTo(s[d++],s[d++],s[d++],s[d++],s[d++],s[d++]),n=s[d-2],r=s[d-1];break;case l.Q:t.quadraticCurveTo(s[d++],s[d++],s[d++],s[d++]),n=s[d-2],r=s[d-1];break;case l.A:var p=s[d++],v=s[d++],x=s[d++],_=s[d++],b=s[d++],w=s[d++],S=s[d++],M=s[d++],I=x>_?x:_,T=x>_?1:x/_,A=x>_?_/x:1,L=Math.abs(x-_)>.001,C=b+w;L?(t.translate(p,v),t.rotate(S),t.scale(T,A),t.arc(0,0,I,b,C,1-M),t.scale(1/T,1/A),t.rotate(-S),t.translate(-p,-v)):t.arc(p,v,I,b,C,1-M),1==d&&(e=g(b)*x+p,i=m(b)*_+v),n=g(C)*x+p,r=m(C)*_+v;break;case l.R:e=n=s[d],i=r=s[d+1],t.rect(s[d++],s[d++],s[d++],s[d++]);break;case l.Z:t.closePath(),n=e,r=i;}}}},_.CMD=l,t.exports=_;},function(t,e,i){"use strict";function n(t){return t>-w&&w>t;}function r(t){return t>w||-w>t;}function o(t,e,i,n,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*n+3*o*i);}function a(t,e,i,n,r){var o=1-r;return 3*(((e-t)*o+2*(i-e)*r)*o+(n-i)*r*r);}function s(t,e,i,r,o,a){var s=r+3*(e-i)-t,l=3*(i-2*e+t),u=3*(e-t),h=t-o,c=l*l-3*s*u,d=l*u-9*s*h,f=u*u-3*l*h,p=0;if(n(c)&&n(d)){if(n(l))a[0]=0;else{var g=-u/l;g>=0&&1>=g&&(a[p++]=g);}}else{var m=d*d-4*c*f;if(n(m)){var v=d/c,g=-l/s+v,y=-v/2;g>=0&&1>=g&&(a[p++]=g),y>=0&&1>=y&&(a[p++]=y);}else if(m>0){var x=b(m),w=c*l+1.5*s*(-d+x),S=c*l+1.5*s*(-d-x);w=0>w?-_(-w,I):_(w,I),S=0>S?-_(-S,I):_(S,I);var g=(-l-(w+S))/(3*s);g>=0&&1>=g&&(a[p++]=g);}else{var T=(2*c*l-3*s*d)/(2*b(c*c*c)),A=Math.acos(T)/3,L=b(c),C=Math.cos(A),g=(-l-2*L*C)/(3*s),y=(-l+L*(C+M*Math.sin(A)))/(3*s),D=(-l+L*(C-M*Math.sin(A)))/(3*s);g>=0&&1>=g&&(a[p++]=g),y>=0&&1>=y&&(a[p++]=y),D>=0&&1>=D&&(a[p++]=D);}}return p;}function l(t,e,i,o,a){var s=6*i-12*e+6*t,l=9*e+3*o-3*t-9*i,u=3*e-3*t,h=0;if(n(l)){if(r(s)){var c=-u/s;c>=0&&1>=c&&(a[h++]=c);}}else{var d=s*s-4*l*u;if(n(d))a[0]=-s/(2*l);else if(d>0){var f=b(d),c=(-s+f)/(2*l),p=(-s-f)/(2*l);c>=0&&1>=c&&(a[h++]=c),p>=0&&1>=p&&(a[h++]=p);}}return h;}function u(t,e,i,n,r,o){var a=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-a)*r+a,h=(l-s)*r+s,c=(h-u)*r+u;o[0]=t,o[1]=a,o[2]=u,o[3]=c,o[4]=c,o[5]=h,o[6]=l,o[7]=n;}function h(t,e,i,n,r,a,s,l,u,h,c){var d,f,p,g,m,v=.005,y=1/0;T[0]=u,T[1]=h;for(var _=0;1>_;_+=.05){A[0]=o(t,i,r,s,_),A[1]=o(e,n,a,l,_),g=x(T,A),y>g&&(d=_,y=g);}y=1/0;for(var w=0;32>w&&!(S>v);w++){f=d-v,p=d+v,A[0]=o(t,i,r,s,f),A[1]=o(e,n,a,l,f),g=x(A,T),f>=0&&y>g?(d=f,y=g):(L[0]=o(t,i,r,s,p),L[1]=o(e,n,a,l,p),m=x(L,T),1>=p&&y>m?(d=p,y=m):v*=.5);}return c&&(c[0]=o(t,i,r,s,d),c[1]=o(e,n,a,l,d)),b(y);}function c(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i;}function d(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e));}function f(t,e,i,o,a){var s=t-2*e+i,l=2*(e-t),u=t-o,h=0;if(n(s)){if(r(l)){var c=-u/l;c>=0&&1>=c&&(a[h++]=c);}}else{var d=l*l-4*s*u;if(n(d)){var c=-l/(2*s);c>=0&&1>=c&&(a[h++]=c);}else if(d>0){var f=b(d),c=(-l+f)/(2*s),p=(-l-f)/(2*s);c>=0&&1>=c&&(a[h++]=c),p>=0&&1>=p&&(a[h++]=p);}}return h;}function p(t,e,i){var n=t+i-2*e;return 0===n?.5:(t-e)/n;}function g(t,e,i,n,r){var o=(e-t)*n+t,a=(i-e)*n+e,s=(a-o)*n+o;r[0]=t,r[1]=o,r[2]=s,r[3]=s,r[4]=a,r[5]=i;}function m(t,e,i,n,r,o,a,s,l){var u,h=.005,d=1/0;T[0]=a,T[1]=s;for(var f=0;1>f;f+=.05){A[0]=c(t,i,r,f),A[1]=c(e,n,o,f);var p=x(T,A);d>p&&(u=f,d=p);}d=1/0;for(var g=0;32>g&&!(S>h);g++){var m=u-h,v=u+h;A[0]=c(t,i,r,m),A[1]=c(e,n,o,m);var p=x(A,T);if(m>=0&&d>p)u=m,d=p;else{L[0]=c(t,i,r,v),L[1]=c(e,n,o,v);var y=x(L,T);1>=v&&d>y?(u=v,d=y):h*=.5;}}return l&&(l[0]=c(t,i,r,u),l[1]=c(e,n,o,u)),b(d);}var v=i(10),y=v.create,x=v.distSquare,_=Math.pow,b=Math.sqrt,w=1e-8,S=1e-4,M=b(3),I=1/3,T=y(),A=y(),L=y();t.exports={cubicAt:o,cubicDerivativeAt:a,cubicRootAt:s,cubicExtrema:l,cubicSubdivide:u,cubicProjectPoint:h,quadraticAt:c,quadraticDerivativeAt:d,quadraticRootAt:f,quadraticExtremum:p,quadraticSubdivide:g,quadraticProjectPoint:m};},function(t,e,i){var n=i(10),r=i(50),o={},a=Math.min,s=Math.max,l=Math.sin,u=Math.cos,h=n.create(),c=n.create(),d=n.create(),f=2*Math.PI;o.fromPoints=function(t,e,i){if(0!==t.length){var n,r=t[0],o=r[0],l=r[0],u=r[1],h=r[1];for(n=1;n<t.length;n++){r=t[n],o=a(o,r[0]),l=s(l,r[0]),u=a(u,r[1]),h=s(h,r[1]);}e[0]=o,e[1]=u,i[0]=l,i[1]=h;}},o.fromLine=function(t,e,i,n,r,o){r[0]=a(t,i),r[1]=a(e,n),o[0]=s(t,i),o[1]=s(e,n);};var p=[],g=[];o.fromCubic=function(t,e,i,n,o,l,u,h,c,d){var f,m=r.cubicExtrema,v=r.cubicAt,y=m(t,i,o,u,p);for(c[0]=1/0,c[1]=1/0,d[0]=-(1/0),d[1]=-(1/0),f=0;y>f;f++){var x=v(t,i,o,u,p[f]);c[0]=a(x,c[0]),d[0]=s(x,d[0]);}for(y=m(e,n,l,h,g),f=0;y>f;f++){var _=v(e,n,l,h,g[f]);c[1]=a(_,c[1]),d[1]=s(_,d[1]);}c[0]=a(t,c[0]),d[0]=s(t,d[0]),c[0]=a(u,c[0]),d[0]=s(u,d[0]),c[1]=a(e,c[1]),d[1]=s(e,d[1]),c[1]=a(h,c[1]),d[1]=s(h,d[1]);},o.fromQuadratic=function(t,e,i,n,o,l,u,h){var c=r.quadraticExtremum,d=r.quadraticAt,f=s(a(c(t,i,o),1),0),p=s(a(c(e,n,l),1),0),g=d(t,i,o,f),m=d(e,n,l,p);u[0]=a(t,o,g),u[1]=a(e,l,m),h[0]=s(t,o,g),h[1]=s(e,l,m);},o.fromArc=function(t,e,i,r,o,a,s,p,g){var m=n.min,v=n.max,y=Math.abs(o-a);if(1e-4>y%f&&y>1e-4)return p[0]=t-i,p[1]=e-r,g[0]=t+i,void(g[1]=e+r);if(h[0]=u(o)*i+t,h[1]=l(o)*r+e,c[0]=u(a)*i+t,c[1]=l(a)*r+e,m(p,h,c),v(g,h,c),o%=f,0>o&&(o+=f),a%=f,0>a&&(a+=f),o>a&&!s?a+=f:a>o&&s&&(o+=f),s){var x=a;a=o,o=x;}for(var _=0;a>_;_+=Math.PI/2){_>o&&(d[0]=u(_)*i+t,d[1]=l(_)*r+e,m(p,d,p),v(g,d,g));}},t.exports=o;},function(t,e,i){"use strict";function n(t,e){return Math.abs(t-e)<x;}function r(){var t=b[0];b[0]=b[1],b[1]=t;}function o(t,e,i,n,o,a,s,l,u,h){if(h>e&&h>n&&h>a&&h>l||e>h&&n>h&&a>h&&l>h)return 0;var c=g.cubicRootAt(e,n,a,l,h,_);if(0===c)return 0;for(var d,f,p=0,m=-1,v=0;c>v;v++){var y=_[v],x=0===y||1===y?.5:1,w=g.cubicAt(t,i,o,s,y);u>w||(0>m&&(m=g.cubicExtrema(e,n,a,l,b),b[1]<b[0]&&m>1&&r(),d=g.cubicAt(e,n,a,l,b[0]),m>1&&(f=g.cubicAt(e,n,a,l,b[1]))),p+=2==m?y<b[0]?e>d?x:-x:y<b[1]?d>f?x:-x:f>l?x:-x:y<b[0]?e>d?x:-x:d>l?x:-x);}return p;}function a(t,e,i,n,r,o,a,s){if(s>e&&s>n&&s>o||e>s&&n>s&&o>s)return 0;var l=g.quadraticRootAt(e,n,o,s,_);if(0===l)return 0;var u=g.quadraticExtremum(e,n,o);if(u>=0&&1>=u){for(var h=0,c=g.quadraticAt(e,n,o,u),d=0;l>d;d++){var f=0===_[d]||1===_[d]?.5:1,p=g.quadraticAt(t,i,r,_[d]);a>p||(h+=_[d]<u?e>c?f:-f:c>o?f:-f);}return h;}var f=0===_[0]||1===_[0]?.5:1,p=g.quadraticAt(t,i,r,_[0]);return a>p?0:e>o?f:-f;}function s(t,e,i,n,r,o,a,s){if(s-=e,s>i||-i>s)return 0;var l=Math.sqrt(i*i-s*s);_[0]=-l,_[1]=l;var u=Math.abs(n-r);if(1e-4>u)return 0;if(1e-4>u%y){n=0,r=y;var h=o?1:-1;return a>=_[0]+t&&a<=_[1]+t?h:0;}if(o){var l=n;n=p(r),r=p(l);}else n=p(n),r=p(r);n>r&&(r+=y);for(var c=0,d=0;2>d;d++){var f=_[d];if(f+t>a){var g=Math.atan2(s,f),h=o?1:-1;0>g&&(g=y+g),(g>=n&&r>=g||g+y>=n&&r>=g+y)&&(g>Math.PI/2&&g<1.5*Math.PI&&(h=-h),c+=h);}}return c;}function l(t,e,i,r,l){for(var h=0,p=0,g=0,y=0,x=0,_=0;_<t.length;){var b=t[_++];switch(b===u.M&&_>1&&(i||(h+=m(p,g,y,x,r,l))),1==_&&(p=t[_],g=t[_+1],y=p,x=g),b){case u.M:y=t[_++],x=t[_++],p=y,g=x;break;case u.L:if(i){if(v(p,g,t[_],t[_+1],e,r,l))return!0;}else h+=m(p,g,t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.C:if(i){if(c.containStroke(p,g,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],e,r,l))return!0;}else h+=o(p,g,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.Q:if(i){if(d.containStroke(p,g,t[_++],t[_++],t[_],t[_+1],e,r,l))return!0;}else h+=a(p,g,t[_++],t[_++],t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.A:var w=t[_++],S=t[_++],M=t[_++],I=t[_++],T=t[_++],A=t[_++],L=(t[_++],1-t[_++]),C=Math.cos(T)*M+w,D=Math.sin(T)*I+S;_>1?h+=m(p,g,C,D,r,l):(y=C,x=D);var P=(r-w)*I/M+w;if(i){if(f.containStroke(w,S,I,T,T+A,L,e,P,l))return!0;}else h+=s(w,S,I,T,T+A,L,P,l);p=Math.cos(T+A)*M+w,g=Math.sin(T+A)*I+S;break;case u.R:y=p=t[_++],x=g=t[_++];var k=t[_++],z=t[_++],C=y+k,D=x+z;if(i){if(v(y,x,C,x,e,r,l)||v(C,x,C,D,e,r,l)||v(C,D,y,D,e,r,l)||v(y,D,y,x,e,r,l))return!0;}else h+=m(C,x,C,D,r,l),h+=m(y,D,y,x,r,l);break;case u.Z:if(i){if(v(p,g,y,x,e,r,l))return!0;}else h+=m(p,g,y,x,r,l);p=y,g=x;}}return i||n(g,x)||(h+=m(p,g,y,x,r,l)||0),0!==h;}var u=i(49).CMD,h=i(53),c=i(54),d=i(55),f=i(56),p=i(57).normalizeRadian,g=i(50),m=i(58),v=h.containStroke,y=2*Math.PI,x=1e-4,_=[-1,-1,-1],b=[-1,-1];t.exports={contain:function contain(t,e,i){return l(t,0,!1,e,i);},containStroke:function containStroke(t,e,i,n){return l(t,e,!0,i,n);}};},function(t,e){t.exports={containStroke:function containStroke(t,e,i,n,r,o,a){if(0===r)return!1;var s=r,l=0,u=t;if(a>e+s&&a>n+s||e-s>a&&n-s>a||o>t+s&&o>i+s||t-s>o&&i-s>o)return!1;if(t===i)return Math.abs(o-t)<=s/2;l=(e-n)/(t-i),u=(t*n-i*e)/(t-i);var h=l*o-a+u,c=h*h/(l*l+1);return s/2*s/2>=c;}};},function(t,e,i){var n=i(50);t.exports={containStroke:function containStroke(t,e,i,r,o,a,s,l,u,h,c){if(0===u)return!1;var d=u;if(c>e+d&&c>r+d&&c>a+d&&c>l+d||e-d>c&&r-d>c&&a-d>c&&l-d>c||h>t+d&&h>i+d&&h>o+d&&h>s+d||t-d>h&&i-d>h&&o-d>h&&s-d>h)return!1;var f=n.cubicProjectPoint(t,e,i,r,o,a,s,l,h,c,null);return d/2>=f;}};},function(t,e,i){var n=i(50);t.exports={containStroke:function containStroke(t,e,i,r,o,a,s,l,u){if(0===s)return!1;var h=s;if(u>e+h&&u>r+h&&u>a+h||e-h>u&&r-h>u&&a-h>u||l>t+h&&l>i+h&&l>o+h||t-h>l&&i-h>l&&o-h>l)return!1;var c=n.quadraticProjectPoint(t,e,i,r,o,a,l,u,null);return h/2>=c;}};},function(t,e,i){var n=i(57).normalizeRadian,r=2*Math.PI;t.exports={containStroke:function containStroke(t,e,i,o,a,s,l,u,h){if(0===l)return!1;var c=l;u-=t,h-=e;var d=Math.sqrt(u*u+h*h);if(d-c>i||i>d+c)return!1;if(Math.abs(o-a)%r<1e-4)return!0;if(s){var f=o;o=n(a),a=n(f);}else o=n(o),a=n(a);o>a&&(a+=r);var p=Math.atan2(h,u);return 0>p&&(p+=r),p>=o&&a>=p||p+r>=o&&a>=p+r;}};},function(t,e){var i=2*Math.PI;t.exports={normalizeRadian:function normalizeRadian(t){return t%=i,0>t&&(t+=i),t;}};},function(t,e){t.exports=function(t,e,i,n,r,o){if(o>e&&o>n||e>o&&n>o)return 0;if(n===e)return 0;var a=e>n?1:-1,s=(o-e)/(n-e);(1===s||0===s)&&(a=e>n?.5:-.5);var l=s*(i-t)+t;return l>r?a:0;};},function(t,e){var i=function i(t,e){this.image=t,this.repeat=e,this.type="pattern";};i.prototype.getCanvasPattern=function(t){return this._canvasPattern||(this._canvasPattern=t.createPattern(this.image,this.repeat));},t.exports=i;},function(t,e,i){function n(t,e){var i,n,o,h,c,d,f=t.data,p=r.M,g=r.C,m=r.L,v=r.R,y=r.A,x=r.Q;for(o=0,h=0;o<f.length;){switch(i=f[o++],h=o,n=0,i){case p:n=1;break;case m:n=1;break;case g:n=3;break;case x:n=2;break;case y:var _=e[4],b=e[5],w=l(e[0]*e[0]+e[1]*e[1]),S=l(e[2]*e[2]+e[3]*e[3]),M=u(-e[1]/S,e[0]/w);f[o++]+=_,f[o++]+=b,f[o++]*=w,f[o++]*=S,f[o++]+=M,f[o++]+=M,o+=2,h=o;break;case v:d[0]=f[o++],d[1]=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1],d[0]+=f[o++],d[1]+=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1];}for(c=0;n>c;c++){var d=s[c];d[0]=f[o++],d[1]=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1];}}}var r=i(49).CMD,o=i(10),a=o.applyTransform,s=[[],[],[]],l=Math.sqrt,u=Math.atan2;t.exports=n;},function(t,e){var i=function i(t){this.colorStops=t||[];};i.prototype={constructor:i,addColorStop:function addColorStop(t,e){this.colorStops.push({offset:t,color:e});}},t.exports=i;},function(t,e,i){function n(t){r.call(this,t);}var r=i(46),o=i(9),a=i(4),s=i(63),l=new s(50);n.prototype={constructor:n,type:"image",brush:function brush(t,e){var i,n=this.style,r=n.image;if(n.bind(t,this,e),i="string"==typeof r?this._image:r,!i&&r){var o=l.get(r);if(!o)return i=new Image(),i.onload=function(){i.onload=null;for(var t=0;t<o.pending.length;t++){o.pending[t].dirty();}},o={image:i,pending:[this]},i.src=r,l.put(r,o),void(this._image=i);if(i=o.image,this._image=i,!i.width||!i.height)return void o.pending.push(this);}if(i){var a=n.width||i.width,s=n.height||i.height,u=n.x||0,h=n.y||0;if(!i.width||!i.height)return;if(this.setTransform(t),n.sWidth&&n.sHeight){var c=n.sx||0,d=n.sy||0;t.drawImage(i,c,d,n.sWidth,n.sHeight,u,h,a,s);}else if(n.sx&&n.sy){var c=n.sx,d=n.sy,f=a-c,p=s-d;t.drawImage(i,c,d,f,p,u,h,a,s);}else t.drawImage(i,u,h,a,s);null==n.width&&(n.width=a),null==n.height&&(n.height=s),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect());}},getBoundingRect:function getBoundingRect(){var t=this.style;return this._rect||(this._rect=new o(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect;}},a.inherits(n,r),t.exports=n;},function(t,e){var i=function i(){this.head=null,this.tail=null,this._len=0;},n=i.prototype;n.insert=function(t){var e=new r(t);return this.insertEntry(e),e;},n.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,this._len++;},n.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--;},n.len=function(){return this._len;};var r=function r(t){this.value=t,this.next,this.prev;},o=function o(t){this._list=new i(),this._map={},this._maxSize=t||10;},a=o.prototype;a.put=function(t,e){var i=this._list,n=this._map;if(null==n[t]){var r=i.len();if(r>=this._maxSize&&r>0){var o=i.head;i.remove(o),delete n[o.key];}var a=i.insert(e);a.key=t,n[t]=a;}},a.get=function(t){var e=this._map[t],i=this._list;return null!=e?(e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value):void 0;},a.clear=function(){this._list.clear(),this._map={};},t.exports=o;},function(t,e,i){var n=i(46),r=i(4),o=i(8),a=function a(t){n.call(this,t);};a.prototype={constructor:a,type:"text",brush:function brush(t,e){var i=this.style,n=i.x||0,r=i.y||0,a=i.text;if(null!=a&&(a+=""),i.bind(t,this,e),a){this.setTransform(t);var s,l=i.textAlign,u=i.textFont||i.font;if(i.textVerticalAlign){var h=o.getBoundingRect(a,u,i.textAlign,"top");switch(s="middle",i.textVerticalAlign){case"middle":r-=h.height/2-h.lineHeight/2;break;case"bottom":r-=h.height-h.lineHeight/2;break;default:r+=h.lineHeight/2;}}else s=i.textBaseline;t.font=u||"12px sans-serif",t.textAlign=l||"left",t.textAlign!==l&&(t.textAlign="left"),t.textBaseline=s||"alphabetic",t.textBaseline!==s&&(t.textBaseline="alphabetic");for(var c=o.measureText("",t.font).width,d=a.split("\n"),f=0;f<d.length;f++){i.hasFill()&&t.fillText(d[f],n,r),i.hasStroke()&&t.strokeText(d[f],n,r),r+=c;}this.restoreTransform(t);}},getBoundingRect:function getBoundingRect(){if(!this._rect){var t=this.style,e=t.textVerticalAlign,i=o.getBoundingRect(t.text+"",t.textFont||t.font,t.textAlign,e?"top":t.textBaseline);switch(e){case"middle":i.y-=i.height/2;break;case"bottom":i.y-=i.height;}i.x+=t.x||0,i.y+=t.y||0,this._rect=i;}return this._rect;}},r.inherits(a,n),t.exports=a;},function(t,e,i){"use strict";t.exports=i(45).extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function buildPath(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0);}});},function(t,e,i){t.exports=i(45).extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=e.startAngle,s=e.endAngle,l=e.clockwise,u=Math.cos(a),h=Math.sin(a);t.moveTo(u*r+i,h*r+n),t.lineTo(u*o+i,h*o+n),t.arc(i,n,o,a,s,!l),t.lineTo(Math.cos(s)*r+i,Math.sin(s)*r+n),0!==r&&t.arc(i,n,r,s,a,l),t.closePath();}});},function(t,e,i){t.exports=i(45).extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,r,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,r,!0);}});},function(t,e,i){var n=i(69);t.exports=i(45).extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function buildPath(t,e){n.buildPath(t,e,!0);}});},function(t,e,i){var n=i(70),r=i(71);t.exports={buildPath:function buildPath(t,e,i){var o=e.points,a=e.smooth;if(o&&o.length>=2){if(a&&"spline"!==a){var s=r(o,a,i,e.smoothConstraint);t.moveTo(o[0][0],o[0][1]);for(var l=o.length,u=0;(i?l:l-1)>u;u++){var h=s[2*u],c=s[2*u+1],d=o[(u+1)%l];t.bezierCurveTo(h[0],h[1],c[0],c[1],d[0],d[1]);}}else{"spline"===a&&(o=n(o,i)),t.moveTo(o[0][0],o[0][1]);for(var u=1,f=o.length;f>u;u++){t.lineTo(o[u][0],o[u][1]);}}i&&t.closePath();}}};},function(t,e,i){function n(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e;}var r=i(10);t.exports=function(t,e){for(var i=t.length,o=[],a=0,s=1;i>s;s++){a+=r.distance(t[s-1],t[s]);}var l=a/2;l=i>l?i:l;for(var s=0;l>s;s++){var u,h,c,d=s/(l-1)*(e?i:i-1),f=Math.floor(d),p=d-f,g=t[f%i];e?(u=t[(f-1+i)%i],h=t[(f+1)%i],c=t[(f+2)%i]):(u=t[0===f?f:f-1],h=t[f>i-2?i-1:f+1],c=t[f>i-3?i-1:f+2]);var m=p*p,v=p*m;o.push([n(u[0],g[0],h[0],c[0],p,m,v),n(u[1],g[1],h[1],c[1],p,m,v)]);}return o;};},function(t,e,i){var n=i(10),r=n.min,o=n.max,a=n.scale,s=n.distance,l=n.add;t.exports=function(t,e,i,u){var h,c,d,f,p=[],g=[],m=[],v=[];if(u){d=[1/0,1/0],f=[-(1/0),-(1/0)];for(var y=0,x=t.length;x>y;y++){r(d,d,t[y]),o(f,f,t[y]);}r(d,d,u[0]),o(f,f,u[1]);}for(var y=0,x=t.length;x>y;y++){var _=t[y];if(i)h=t[y?y-1:x-1],c=t[(y+1)%x];else{if(0===y||y===x-1){p.push(n.clone(t[y]));continue;}h=t[y-1],c=t[y+1];}n.sub(g,c,h),a(g,g,e);var b=s(_,h),w=s(_,c),S=b+w;0!==S&&(b/=S,w/=S),a(m,g,-b),a(v,g,w);var M=l([],_,m),I=l([],_,v);u&&(o(M,M,d),r(M,M,f),o(I,I,d),r(I,I,f)),p.push(M),p.push(I);}return i&&p.push(p.shift()),p;};},function(t,e,i){var n=i(69);t.exports=i(45).extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){n.buildPath(t,e,!1);}});},function(t,e,i){var n=i(74);t.exports=i(45).extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.x,r=e.y,o=e.width,a=e.height;e.r?n.buildPath(t,e):t.rect(i,r,o,a),t.closePath();}});},function(t,e){t.exports={buildPath:function buildPath(t,e){var i,n,r,o,a=e.x,s=e.y,l=e.width,u=e.height,h=e.r;0>l&&(a+=l,l=-l),0>u&&(s+=u,u=-u),"number"==typeof h?i=n=r=o=h:h instanceof Array?1===h.length?i=n=r=o=h[0]:2===h.length?(i=r=h[0],n=o=h[1]):3===h.length?(i=h[0],n=o=h[1],r=h[2]):(i=h[0],n=h[1],r=h[2],o=h[3]):i=n=r=o=0;var c;i+n>l&&(c=i+n,i*=l/c,n*=l/c),r+o>l&&(c=r+o,r*=l/c,o*=l/c),n+r>u&&(c=n+r,n*=u/c,r*=u/c),i+o>u&&(c=i+o,i*=u/c,o*=u/c),t.moveTo(a+i,s),t.lineTo(a+l-n,s),0!==n&&t.quadraticCurveTo(a+l,s,a+l,s+n),t.lineTo(a+l,s+u-r),0!==r&&t.quadraticCurveTo(a+l,s+u,a+l-r,s+u),t.lineTo(a+o,s+u),0!==o&&t.quadraticCurveTo(a,s+u,a,s+u-o),t.lineTo(a,s+i),0!==i&&t.quadraticCurveTo(a,s,a+i,s);}};},function(t,e,i){t.exports=i(45).extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,a=e.percent;0!==a&&(t.moveTo(i,n),1>a&&(r=i*(1-a)+r*a,o=n*(1-a)+o*a),t.lineTo(r,o));},pointAt:function pointAt(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t];}});},function(t,e,i){"use strict";function n(t,e,i){var n=t.cpx2,r=t.cpy2;return null===n||null===r?[(i?c:u)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?c:u)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?h:l)(t.x1,t.cpx1,t.x2,e),(i?h:l)(t.y1,t.cpy1,t.y2,e)];}var r=i(50),o=i(10),a=r.quadraticSubdivide,s=r.cubicSubdivide,l=r.quadraticAt,u=r.cubicAt,h=r.quadraticDerivativeAt,c=r.cubicDerivativeAt,d=[];t.exports=i(45).extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,l=e.cpx1,u=e.cpy1,h=e.cpx2,c=e.cpy2,f=e.percent;0!==f&&(t.moveTo(i,n),null==h||null==c?(1>f&&(a(i,l,r,f,d),l=d[1],r=d[2],a(n,u,o,f,d),u=d[1],o=d[2]),t.quadraticCurveTo(l,u,r,o)):(1>f&&(s(i,l,h,r,f,d),l=d[1],h=d[2],r=d[3],s(n,u,c,o,f,d),u=d[1],c=d[2],o=d[3]),t.bezierCurveTo(l,u,h,c,r,o)));},pointAt:function pointAt(t){return n(this.shape,t,!1);},tangentAt:function tangentAt(t){var e=n(this.shape,t,!0);return o.normalize(e,e);}});},function(t,e,i){t.exports=i(45).extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*r+i,u*r+n),t.arc(i,n,r,o,a,!s);}});},function(t,e,i){var n=i(45);t.exports=n.extend({type:"compound",shape:{paths:null},_updatePathDirty:function _updatePathDirty(){for(var t=this.__dirtyPath,e=this.shape.paths,i=0;i<e.length;i++){t=t||e[i].__dirtyPath;}this.__dirtyPath=t,this.__dirty=this.__dirty||t;},beforeBrush:function beforeBrush(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),i=0;i<t.length;i++){t[i].path.setScale(e[0],e[1]);}},buildPath:function buildPath(t,e){for(var i=e.paths||[],n=0;n<i.length;n++){i[n].buildPath(t,i[n].shape,!0);}},afterBrush:function afterBrush(){for(var t=this.shape.paths,e=0;e<t.length;e++){t[e].__dirtyPath=!1;}},getBoundingRect:function getBoundingRect(){return this._updatePathDirty(),n.prototype.getBoundingRect.call(this);}});},function(t,e,i){"use strict";var n=i(4),r=i(61),o=function o(t,e,i,n,_o,a){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==i?1:i,this.y2=null==n?0:n,this.type="linear",this.global=a||!1,r.call(this,_o);};o.prototype={constructor:o},n.inherits(o,r),t.exports=o;},function(t,e,i){"use strict";var n=i(4),r=i(61),o=function o(t,e,i,n,_o2){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==i?.5:i,this.type="radial",this.global=_o2||!1,r.call(this,n);};o.prototype={constructor:o},n.inherits(o,r),t.exports=o;},function(t,e,i){function n(t){delete d[t];}var r=i(32),o=i(2),a=i(82),s=i(84),l=i(86),u=i(89),h=!o.canvasSupported,c={canvas:i(91)},d={},f={};f.version="3.2.1",f.init=function(t,e){var i=new p(r(),t,e);return d[i.id]=i,i;},f.dispose=function(t){if(t)t.dispose();else{for(var e in d){d.hasOwnProperty(e)&&d[e].dispose();}d={};}return f;},f.getInstance=function(t){return d[t];},f.registerPainter=function(t,e){c[t]=e;};var p=function p(t,e,i){i=i||{},this.dom=e,this.id=t;var n=this,r=new s(),d=i.renderer;if(h){if(!c.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");d="vml";}else d&&c[d]||(d="canvas");var f=new c[d](e,r,i);this.storage=r,this.painter=f;var p=o.node?null:new u(f.getViewportRoot());this.handler=new a(r,f,p,f.root),this.animation=new l({stage:{update:function update(){n._needsRefresh&&n.refreshImmediately(),n._needsRefreshHover&&n.refreshHoverImmediately();}}}),this.animation.start(),this._needsRefresh;var g=r.delFromMap,m=r.addToMap;r.delFromMap=function(t){var e=r.get(t);g.call(r,t),e&&e.removeSelfFromZr(n);},r.addToMap=function(t){m.call(r,t),t.addSelfToZr(n);};};p.prototype={constructor:p,getId:function getId(){return this.id;},add:function add(t){this.storage.addRoot(t),this._needsRefresh=!0;},remove:function remove(t){this.storage.delRoot(t),this._needsRefresh=!0;},configLayer:function configLayer(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0;},refreshImmediately:function refreshImmediately(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1;},refresh:function refresh(){this._needsRefresh=!0;},addHover:function addHover(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover());},removeHover:function removeHover(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover());},clearHover:function clearHover(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover());},refreshHover:function refreshHover(){this._needsRefreshHover=!0;},refreshHoverImmediately:function refreshHoverImmediately(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover();},resize:function resize(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize();},clearAnimation:function clearAnimation(){this.animation.clear();},getWidth:function getWidth(){return this.painter.getWidth();},getHeight:function getHeight(){return this.painter.getHeight();},pathToImage:function pathToImage(t,e,i){var n=r();return this.painter.pathToImage(n,t,e,i);},setCursorStyle:function setCursorStyle(t){this.handler.setCursorStyle(t);},on:function on(t,e,i){this.handler.on(t,e,i);},off:function off(t,e){this.handler.off(t,e);},trigger:function trigger(t,e){this.handler.trigger(t,e);},clear:function clear(){this.storage.delRoot(),this.painter.clear();},dispose:function dispose(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,n(this.id);}},t.exports=f;},function(t,e,i){"use strict";function n(t,e,i){return{type:t,event:i,target:e,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta};}function r(){}function o(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n=t;n;){if(n.silent||n.clipPath&&!n.clipPath.contain(e,i))return!1;n=n.parent;}return!0;}return!1;}var a=i(4),s=i(83),l=i(33);r.prototype.dispose=function(){};var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],h=function h(t,e,i,n){l.call(this),this.storage=t,this.painter=e,this.painterRoot=n,i=i||new r(),this.proxy=i,i.handler=this,this._hovered,this._lastTouchMoment,this._lastX,this._lastY,s.call(this),a.each(u,function(t){i.on&&i.on(t,this[t],this);},this);};h.prototype={constructor:h,mousemove:function mousemove(t){var e=t.zrX,i=t.zrY,n=this.findHover(e,i,null),r=this._hovered,o=this.proxy;this._hovered=n,o.setCursor&&o.setCursor(n?n.cursor:"default"),r&&n!==r&&r.__zr&&this.dispatchToElement(r,"mouseout",t),this.dispatchToElement(n,"mousemove",t),n&&n!==r&&this.dispatchToElement(n,"mouseover",t);},mouseout:function mouseout(t){this.dispatchToElement(this._hovered,"mouseout",t);var e,i=t.toElement||t.relatedTarget;do{i=i&&i.parentNode;}while(i&&9!=i.nodeType&&!(e=i===this.painterRoot));!e&&this.trigger("globalout",{event:t});},resize:function resize(t){this._hovered=null;},dispatch:function dispatch(t,e){var i=this[t];i&&i.call(this,e);},dispose:function dispose(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null;},setCursorStyle:function setCursorStyle(t){var e=this.proxy;e.setCursor&&e.setCursor(t);},dispatchToElement:function dispatchToElement(t,e,i){for(var r="on"+e,o=n(e,t,i),a=t;a&&(a[r]&&(o.cancelBubble=a[r].call(a,o)),a.trigger(e,o),a=a.parent,!o.cancelBubble);){}o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,o),t.trigger&&t.trigger(e,o);}));},findHover:function findHover(t,e,i){for(var n=this.storage.getDisplayList(),r=n.length-1;r>=0;r--){if(!n[r].silent&&n[r]!==i&&!n[r].ignore&&o(n[r],t,e))return n[r];}}},a.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){h.prototype[t]=function(e){var i=this.findHover(e.zrX,e.zrY,null);if("mousedown"===t)this._downel=i,this._upel=i;else if("mosueup"===t)this._upel=i;else if("click"===t&&this._downel!==this._upel)return;this.dispatchToElement(i,t,e);};}),a.mixin(h,l),a.mixin(h,s),t.exports=h;},function(t,e){function i(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this);}i.prototype={constructor:i,_dragStart:function _dragStart(t){var e=t.target;e&&e.draggable&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(e,"dragstart",t.event));},_drag:function _drag(t){var e=this._draggingTarget;if(e){var i=t.offsetX,n=t.offsetY,r=i-this._x,o=n-this._y;this._x=i,this._y=n,e.drift(r,o,t),this.dispatchToElement(e,"drag",t.event);var a=this.findHover(i,n,e),s=this._dropTarget;this._dropTarget=a,e!==a&&(s&&a!==s&&this.dispatchToElement(s,"dragleave",t.event),a&&a!==s&&this.dispatchToElement(a,"dragenter",t.event));}},_dragEnd:function _dragEnd(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(e,"dragend",t.event),this._dropTarget&&this.dispatchToElement(this._dropTarget,"drop",t.event),this._draggingTarget=null,this._dropTarget=null;}},t.exports=i;},function(t,e,i){"use strict";function n(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel;}var r=i(4),o=i(2),a=i(30),s=i(85),l=function l(){this._elements={},this._roots=[],this._displayList=[],this._displayListLen=0;};l.prototype={constructor:l,traverse:function traverse(t,e){for(var i=0;i<this._roots.length;i++){this._roots[i].traverse(t,e);}},getDisplayList:function getDisplayList(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList;},updateDisplayList:function updateDisplayList(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,r=0,a=e.length;a>r;r++){this._updateAndAddDisplayable(e[r],null,t);}i.length=this._displayListLen,o.canvasSupported&&s(i,n);},_updateAndAddDisplayable:function _updateAndAddDisplayable(t,e,i){if(!t.ignore||i){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var n=t.clipPath;if(n&&(n.parent=t,n.updateTransform(),e?(e=e.slice(),e.push(n)):e=[n]),t.isGroup){for(var r=t._children,o=0;o<r.length;o++){var a=r[o];t.__dirty&&(a.__dirty=!0),this._updateAndAddDisplayable(a,e,i);}t.__dirty=!1;}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t;}},addRoot:function addRoot(t){this._elements[t.id]||(t instanceof a&&t.addChildrenToStorage(this),this.addToMap(t),this._roots.push(t));},delRoot:function delRoot(t){if(null==t){for(var e=0;e<this._roots.length;e++){var i=this._roots[e];i instanceof a&&i.delChildrenFromStorage(this);}return this._elements={},this._roots=[],this._displayList=[],void(this._displayListLen=0);}if(t instanceof Array)for(var e=0,n=t.length;n>e;e++){this.delRoot(t[e]);}else{var o;o="string"==typeof t?this._elements[t]:t;var s=r.indexOf(this._roots,o);s>=0&&(this.delFromMap(o.id),this._roots.splice(s,1),o instanceof a&&o.delChildrenFromStorage(this));}},addToMap:function addToMap(t){return t instanceof a&&(t.__storage=this),t.dirty(!1),this._elements[t.id]=t,this;},get:function get(t){return this._elements[t];},delFromMap:function delFromMap(t){var e=this._elements,i=e[t];return i&&(delete e[t],i instanceof a&&(i.__storage=null)),this;},dispose:function dispose(){this._elements=this._renderList=this._roots=null;},displayableSortFunc:n},t.exports=l;},function(t,e){function i(t){for(var e=0;t>=h;){e|=1&t,t>>=1;}return t+e;}function n(t,e,i,n){var o=e+1;if(o===i)return 1;if(n(t[o++],t[e])<0){for(;i>o&&n(t[o],t[o-1])<0;){o++;}r(t,e,o);}else for(;i>o&&n(t[o],t[o-1])>=0;){o++;}return o-e;}function r(t,e,i){for(i--;i>e;){var n=t[e];t[e++]=t[i],t[i--]=n;}}function o(t,e,i,n,r){for(n===e&&n++;i>n;n++){for(var o,a=t[n],s=e,l=n;l>s;){o=s+l>>>1,r(a,t[o])<0?l=o:s=o+1;}var u=n-s;switch(u){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;u>0;){t[s+u]=t[s+u-1],u--;}}t[s]=a;}}function a(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])>0){for(s=n-r;s>l&&o(t,e[i+r+l])>0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s),a+=r,l+=r;}else{for(s=r+1;s>l&&o(t,e[i+r-l])<=0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s);var u=a;a=r-l,l=r-u;}for(a++;l>a;){var h=a+(l-a>>>1);o(t,e[i+h])>0?a=h+1:l=h;}return l;}function s(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])<0){for(s=r+1;s>l&&o(t,e[i+r-l])<0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s);var u=a;a=r-l,l=r-u;}else{for(s=n-r;s>l&&o(t,e[i+r+l])>=0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s),a+=r,l+=r;}for(a++;l>a;){var h=a+(l-a>>>1);o(t,e[i+h])<0?l=h:a=h+1;}return l;}function l(t,e){function i(t,e){h[y]=t,f[y]=e,y+=1;}function n(){for(;y>1;){var t=y-2;if(t>=1&&f[t-1]<=f[t]+f[t+1]||t>=2&&f[t-2]<=f[t]+f[t-1])f[t-1]<f[t+1]&&t--;else if(f[t]>f[t+1])break;o(t);}}function r(){for(;y>1;){var t=y-2;t>0&&f[t-1]<f[t+1]&&t--,o(t);}}function o(i){var n=h[i],r=f[i],o=h[i+1],c=f[i+1];f[i]=r+c,i===y-3&&(h[i+1]=h[i+2],f[i+1]=f[i+2]),y--;var d=s(t[o],t,n,r,0,e);n+=d,r-=d,0!==r&&(c=a(t[n+r-1],t,o,c,c-1,e),0!==c&&(c>=r?l(n,r,o,c):u(n,r,o,c)));}function l(i,n,r,o){var l=0;for(l=0;n>l;l++){x[l]=t[i+l];}var u=0,h=r,d=i;if(t[d++]=t[h++],0!==--o){if(1===n){for(l=0;o>l;l++){t[d+l]=t[h+l];}return void(t[d+o]=x[u]);}for(var f,g,m,v=p;;){f=0,g=0,m=!1;do{if(e(t[h],x[u])<0){if(t[d++]=t[h++],g++,f=0,0===--o){m=!0;break;}}else if(t[d++]=x[u++],f++,g=0,1===--n){m=!0;break;}}while(v>(f|g));if(m)break;do{if(f=s(t[h],x,u,n,0,e),0!==f){for(l=0;f>l;l++){t[d+l]=x[u+l];}if(d+=f,u+=f,n-=f,1>=n){m=!0;break;}}if(t[d++]=t[h++],0===--o){m=!0;break;}if(g=a(x[u],t,h,o,0,e),0!==g){for(l=0;g>l;l++){t[d+l]=t[h+l];}if(d+=g,h+=g,o-=g,0===o){m=!0;break;}}if(t[d++]=x[u++],1===--n){m=!0;break;}v--;}while(f>=c||g>=c);if(m)break;0>v&&(v=0),v+=2;}if(p=v,1>p&&(p=1),1===n){for(l=0;o>l;l++){t[d+l]=t[h+l];}t[d+o]=x[u];}else{if(0===n)throw new Error();for(l=0;n>l;l++){t[d+l]=x[u+l];}}}else for(l=0;n>l;l++){t[d+l]=x[u+l];}}function u(i,n,r,o){var l=0;for(l=0;o>l;l++){x[l]=t[r+l];}var u=i+n-1,h=o-1,d=r+o-1,f=0,g=0;if(t[d--]=t[u--],0!==--n){if(1===o){for(d-=n,u-=n,g=d+1,f=u+1,l=n-1;l>=0;l--){t[g+l]=t[f+l];}return void(t[d]=x[h]);}for(var m=p;;){var v=0,y=0,_=!1;do{if(e(x[h],t[u])<0){if(t[d--]=t[u--],v++,y=0,0===--n){_=!0;break;}}else if(t[d--]=x[h--],y++,v=0,1===--o){_=!0;break;}}while(m>(v|y));if(_)break;do{if(v=n-s(x[h],t,i,n,n-1,e),0!==v){for(d-=v,u-=v,n-=v,g=d+1,f=u+1,l=v-1;l>=0;l--){t[g+l]=t[f+l];}if(0===n){_=!0;break;}}if(t[d--]=x[h--],1===--o){_=!0;break;}if(y=o-a(t[u],x,0,o,o-1,e),0!==y){for(d-=y,h-=y,o-=y,g=d+1,f=h+1,l=0;y>l;l++){t[g+l]=x[f+l];}if(1>=o){_=!0;break;}}if(t[d--]=t[u--],0===--n){_=!0;break;}m--;}while(v>=c||y>=c);if(_)break;0>m&&(m=0),m+=2;}if(p=m,1>p&&(p=1),1===o){for(d-=n,u-=n,g=d+1,f=u+1,l=n-1;l>=0;l--){t[g+l]=t[f+l];}t[d]=x[h];}else{if(0===o)throw new Error();for(f=d-(o-1),l=0;o>l;l++){t[f+l]=x[l];}}}else for(f=d-(o-1),l=0;o>l;l++){t[f+l]=x[l];}}var h,f,p=c,g=0,m=d,v=0,y=0;g=t.length,2*d>g&&(m=g>>>1);var x=[];v=120>g?5:1542>g?10:119151>g?19:40,h=[],f=[],this.mergeRuns=n,this.forceMergeRuns=r,this.pushRun=i;}function u(t,e,r,a){r||(r=0),a||(a=t.length);var s=a-r;if(!(2>s)){var u=0;if(h>s)return u=n(t,r,a,e),void o(t,r,a,r+u,e);var c=new l(t,e),d=i(s);do{if(u=n(t,r,a,e),d>u){var f=s;f>d&&(f=d),o(t,r,r+f,r+u,e),u=f;}c.pushRun(r,u),c.mergeRuns(),s-=u,r+=u;}while(0!==s);c.forceMergeRuns();}}var h=32,c=7,d=256;t.exports=u;},function(t,e,i){"use strict";var n=i(4),r=i(87).Dispatcher,o=i(88),a=i(36),s=function s(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,r.call(this);};s.prototype={constructor:s,addClip:function addClip(t){this._clips.push(t);},addAnimator:function addAnimator(t){t.animation=this;for(var e=t.getClips(),i=0;i<e.length;i++){this.addClip(e[i]);}},removeClip:function removeClip(t){var e=n.indexOf(this._clips,t);e>=0&&this._clips.splice(e,1);},removeAnimator:function removeAnimator(t){for(var e=t.getClips(),i=0;i<e.length;i++){this.removeClip(e[i]);}t.animation=null;},_update:function _update(){for(var t=new Date().getTime()-this._pausedTime,e=t-this._time,i=this._clips,n=i.length,r=[],o=[],a=0;n>a;a++){var s=i[a],l=s.step(t);l&&(r.push(l),o.push(s));}for(var a=0;n>a;){i[a]._needsRemove?(i[a]=i[n-1],i.pop(),n--):a++;}n=r.length;for(var a=0;n>a;a++){o[a].fire(r[a]);}this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update();},_startLoop:function _startLoop(){function t(){e._running&&(o(t),!e._paused&&e._update());}var e=this;this._running=!0,o(t);},start:function start(){this._time=new Date().getTime(),this._pausedTime=0,this._startLoop();},stop:function stop(){this._running=!1;},pause:function pause(){this._paused||(this._pauseStart=new Date().getTime(),this._paused=!0);},resume:function resume(){this._paused&&(this._pausedTime+=new Date().getTime()-this._pauseStart,this._paused=!1);},clear:function clear(){this._clips=[];},animate:function animate(t,e){e=e||{};var i=new a(t,e.loop,e.getter,e.setter);return i;}},n.mixin(s,r),t.exports=s;},function(t,e,i){"use strict";function n(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0};}function r(t,e,i,n){if(i=i||{},n)o(t,e,i);else if(h.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX)i.zrX=e.layerX,i.zrY=e.layerY;else if(null!=e.offsetX){var r=window._echartDomZoom;i.zrX=e.offsetX/r,i.zrY=e.offsetY/r;}else o(t,e,i);return i;}function o(t,e,i){var r=window._echartDomZoom,o=n(t);i.zrX=e.clientX/r-o.left,i.zrY=e.clientY/r-o.top;}function a(t,e,i){if(e=e||window.event,null!=e.zrX)return e;var n=e.type,o=n&&n.indexOf("touch")>=0;if(o){var a="touchend"!=n?e.targetTouches[0]:e.changedTouches[0];a&&r(t,a,e,i);}else r(t,e,e,i),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;return e;}function s(t,e,i){c?t.addEventListener(e,i):t.attachEvent("on"+e,i);}function l(t,e,i){c?t.removeEventListener(e,i):t.detachEvent("on"+e,i);}var u=i(33),h=i(2),c="undefined"!=typeof window&&!!window.addEventListener,d=c?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0;}:function(t){t.returnValue=!1,t.cancelBubble=!0;};t.exports={clientToLocal:r,normalizeEvent:a,addEventListener:s,removeEventListener:l,stop:d,Dispatcher:u};},function(t,e){t.exports="undefined"!=typeof window&&(window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16);};},function(t,e,i){function n(t){return"mousewheel"===t&&d.browser.firefox?"DOMMouseScroll":t;}function r(t,e,i){var n=t._gestureMgr;"start"===i&&n.clear();var r=n.recognize(e,t.handler.findHover(e.zrX,e.zrY,null),t.dom);if("end"===i&&n.clear(),r){var o=r.type;e.gestureEvent=o,t.handler.dispatchToElement(r.target,o,r.event);}}function o(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1;},700);}function a(){return d.touchEventsSupported;}function s(t){function e(t,e){return function(){return e._touching?void 0:t.apply(e,arguments);};}for(var i=0;i<x.length;i++){var n=x[i];t._handlers[n]=h.bind(_[n],t);}for(var i=0;i<y.length;i++){var n=y[i];t._handlers[n]=e(_[n],t);}}function l(t){function e(e,i){h.each(e,function(e){p(t,n(e),i._handlers[e]);},i);}c.call(this),this.dom=t,this._touching=!1,this._touchTimer,this._gestureMgr=new f(),this._handlers={},s(this),a()&&e(x,this),e(y,this);}var u=i(87),h=i(4),c=i(33),d=i(2),f=i(90),p=u.addEventListener,g=u.removeEventListener,m=u.normalizeEvent,v=300,y=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],x=["touchstart","touchend","touchmove"],_={mousemove:function mousemove(t){t=m(this.dom,t),this.trigger("mousemove",t);},mouseout:function mouseout(t){t=m(this.dom,t);var e=t.toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode;}this.trigger("mouseout",t);},touchstart:function touchstart(t){t=m(this.dom,t),this._lastTouchMoment=new Date(),r(this,t,"start"),_.mousemove.call(this,t),_.mousedown.call(this,t),o(this);},touchmove:function touchmove(t){t=m(this.dom,t),r(this,t,"change"),_.mousemove.call(this,t),o(this);},touchend:function touchend(t){t=m(this.dom,t),r(this,t,"end"),_.mouseup.call(this,t),+new Date()-this._lastTouchMoment<v&&_.click.call(this,t),o(this);}};h.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){_[t]=function(e){e=m(this.dom,e),this.trigger(t,e);};});var b=l.prototype;b.dispose=function(){for(var t=y.concat(x),e=0;e<t.length;e++){var i=t[e];g(this.dom,n(i),this._handlers[i]);}},b.setCursor=function(t){this.dom.style.cursor=t||"default";},h.mixin(l,c),t.exports=l;},function(t,e,i){"use strict";function n(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i);}function r(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2];}var o=i(87),a=function a(){this._track=[];};a.prototype={constructor:a,recognize:function recognize(t,e,i){return this._doTrack(t,e,i),this._recognize(t);},clear:function clear(){return this._track.length=0,this;},_doTrack:function _doTrack(t,e,i){var n=t.touches;if(n){for(var r={points:[],touches:[],target:e,event:t},a=0,s=n.length;s>a;a++){var l=n[a],u=o.clientToLocal(i,l,{});r.points.push([u.zrX,u.zrY]),r.touches.push(l);}this._track.push(r);}},_recognize:function _recognize(t){for(var e in s){if(s.hasOwnProperty(e)){var i=s[e](this._track,t);if(i)return i;}}}};var s={pinch:function pinch(t,e){var i=t.length;if(i){var o=(t[i-1]||{}).points,a=(t[i-2]||{}).points||o;if(a&&a.length>1&&o&&o.length>1){var s=n(o)/n(a);!isFinite(s)&&(s=1),e.pinchScale=s;var l=r(o);return e.pinchX=l[0],e.pinchY=l[1],{type:"pinch",target:t[0].target,event:e};}}}};t.exports=a;},function(t,e,i){"use strict";function n(t){return parseInt(t,10);}function r(t){return t?t.isBuildin?!0:"function"!=typeof t.resize||"function"!=typeof t.refresh?!1:!0:!1;}function o(t){t.__unusedCount++;}function a(t){1==t.__unusedCount&&t.clear();}function s(t,e,i){return x.copy(t.getBoundingRect()),t.transform&&x.applyTransform(t.transform),_.width=e,_.height=i,!x.intersect(_);}function l(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++){if(t[i]!==e[i])return!0;}}function u(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=n.path;n.setTransform(e),r.beginPath(e),n.buildPath(r,n.shape),e.clip(),n.restoreTransform(e);}}function h(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",i;}var c=i(41),d=i(4),f=i(40),p=i(9),g=i(85),m=i(92),v=i(88),y=5,x=new p(0,0,0,0),_=new p(0,0,0,0),b=function b(t,e,i){var n=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=d.extend({},i||{}),this.dpr=i.devicePixelRatio||c.devicePixelRatio,this._singleCanvas=n,this.root=t;var r=t.style;r&&(r["-webkit-tap-highlight-color"]="transparent",r["-webkit-user-select"]=r["user-select"]=r["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],a=this._layers={};if(this._layerConfig={},n){var s=t.width,l=t.height;this._width=s,this._height=l;var u=new m(t,this,1);u.initContext(),a[0]=u,o.push(0);}else{this._width=this._getSize(0),this._height=this._getSize(1);var f=this._domRoot=h(this._width,this._height);t.appendChild(f);}this.pathToImage=this._createPathToImage(),this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[];};b.prototype={constructor:b,isSingleCanvas:function isSingleCanvas(){return this._singleCanvas;},getViewportRoot:function getViewportRoot(){return this._singleCanvas?this._layers[0].dom:this._domRoot;},refresh:function refresh(t){var e=this.storage.getDisplayList(!0),i=this._zlevelList;this._paintList(e,t);for(var n=0;n<i.length;n++){var r=i[n],o=this._layers[r];!o.isBuildin&&o.refresh&&o.refresh();}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this;},addHover:function addHover(t,e){if(!t.__hoverMir){var i=new t.constructor({style:t.style,shape:t.shape});i.__from=t,t.__hoverMir=i,i.setStyle(e),this._hoverElements.push(i);}},removeHover:function removeHover(t){var e=t.__hoverMir,i=this._hoverElements,n=d.indexOf(i,e);n>=0&&i.splice(n,1),t.__hoverMir=null;},clearHover:function clearHover(t){for(var e=this._hoverElements,i=0;i<e.length;i++){var n=e[i].__from;n&&(n.__hoverMir=null);}e.length=0;},refreshHover:function refreshHover(){var t=this._hoverElements,e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){g(t,this.storage.displayableSortFunc),i||(i=this._hoverlayer=this.getLayer(1e5));var n={};i.ctx.save();for(var r=0;e>r;){var o=t[r],a=o.__from;a&&a.__zr?(r++,a.invisible||(o.transform=a.transform,o.invTransform=a.invTransform,o.__clipPaths=a.__clipPaths,this._doPaintEl(o,i,!0,n))):(t.splice(r,1),a.__hoverMir=null,e--);}i.ctx.restore();}},_startProgessive:function _startProgessive(){function t(){i===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,v(t)):e._progressiveToken=-1);}var e=this;if(e._furtherProgressive){var i=e._progressiveToken=+new Date();e._progress++,v(t);}},_clearProgressive:function _clearProgressive(){this._progressiveToken=-1,this._progress=0,d.each(this._progressiveLayers,function(t){t.__dirty&&t.clear();});},_paintList:function _paintList(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuildinLayer(o),this._doPaintList(t,e),this.eachBuildinLayer(a);},_doPaintList:function _doPaintList(t,e){function i(t){var e=o.dpr||1;o.save(),o.globalAlpha=1,o.shadowBlur=0,n.__dirty=!0,o.setTransform(1,0,0,1,0,0),o.drawImage(t.dom,0,0,h*e,c*e),o.restore();}for(var n,r,o,a,s,l,u=0,h=this._width,c=this._height,p=this._progress,g=0,m=t.length;m>g;g++){var v=t[g],x=this._singleCanvas?0:v.zlevel,_=v.__frame;if(0>_&&s&&(i(s),s=null),r!==x&&(o&&o.restore(),a={},r=x,n=this.getLayer(r),n.isBuildin||f("ZLevel "+r+" has been used by unkown layer "+n.id),o=n.ctx,o.save(),n.__unusedCount=0,(n.__dirty||e)&&n.clear()),n.__dirty||e){if(_>=0){if(!s){if(s=this._progressiveLayers[Math.min(u++,y-1)],s.ctx.save(),s.renderScope={},s&&s.__progress>s.__maxProgress){g=s.__nextIdxNotProg-1;continue;}l=s.__progress,s.__dirty||(p=l),s.__progress=p+1;}_===p&&this._doPaintEl(v,s,!0,s.renderScope);}else this._doPaintEl(v,n,e,a);v.__dirty=!1;}}s&&i(s),o&&o.restore(),this._furtherProgressive=!1,d.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0);},this);},_doPaintEl:function _doPaintEl(t,e,i,n){var r=e.ctx,o=t.transform;if((e.__dirty||i)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!s(t,this._width,this._height))){var a=t.__clipPaths;(n.prevClipLayer!==e||l(a,n.prevElClipPaths))&&(n.prevElClipPaths&&(n.prevClipLayer.ctx.restore(),n.prevClipLayer=n.prevElClipPaths=null,n.prevEl=null),a&&(r.save(),u(a,r),n.prevClipLayer=e,n.prevElClipPaths=a)),t.beforeBrush&&t.beforeBrush(r),t.brush(r,n.prevEl||null),n.prevEl=t,t.afterBrush&&t.afterBrush(r);}},getLayer:function getLayer(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||(e=new m("zr_"+t,this,this.dpr),e.isBuildin=!0,this._layerConfig[t]&&d.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e;},insertLayer:function insertLayer(t,e){var i=this._layers,n=this._zlevelList,o=n.length,a=null,s=-1,l=this._domRoot;if(i[t])return void f("ZLevel "+t+" has been used already");if(!r(e))return void f("Layer of zlevel "+t+" is not valid");if(o>0&&t>n[0]){for(s=0;o-1>s&&!(n[s]<t&&n[s+1]>t);s++){}a=i[n[s]];}if(n.splice(s+1,0,t),a){var u=a.dom;u.nextSibling?l.insertBefore(e.dom,u.nextSibling):l.appendChild(e.dom);}else l.firstChild?l.insertBefore(e.dom,l.firstChild):l.appendChild(e.dom);i[t]=e;},eachLayer:function eachLayer(t,e){var i,n,r=this._zlevelList;for(n=0;n<r.length;n++){i=r[n],t.call(e,this._layers[i],i);}},eachBuildinLayer:function eachBuildinLayer(t,e){var i,n,r,o=this._zlevelList;for(r=0;r<o.length;r++){n=o[r],i=this._layers[n],i.isBuildin&&t.call(e,i,n);}},eachOtherLayer:function eachOtherLayer(t,e){var i,n,r,o=this._zlevelList;for(r=0;r<o.length;r++){n=o[r],i=this._layers[n],i.isBuildin||t.call(e,i,n);}},getLayers:function getLayers(){return this._layers;},_updateLayerStatus:function _updateLayerStatus(t){var e=this._layers,i=this._progressiveLayers,n={},r={};this.eachBuildinLayer(function(t,e){n[e]=t.elCount,t.elCount=0,t.__dirty=!1;}),d.each(i,function(t,e){r[e]=t.elCount,t.elCount=0,t.__dirty=!1;});for(var o,a,s=0,l=0,u=0,h=t.length;h>u;u++){var c=t[u],f=this._singleCanvas?0:c.zlevel,p=e[f],g=c.progressive;if(p&&(p.elCount++,p.__dirty=p.__dirty||c.__dirty),g>=0){a!==g&&(a=g,l++);var v=c.__frame=l-1;if(!o){var x=Math.min(s,y-1);o=i[x],o||(o=i[x]=new m("progressive",this,this.dpr),o.initContext()),o.__maxProgress=0;}o.__dirty=o.__dirty||c.__dirty,o.elCount++,o.__maxProgress=Math.max(o.__maxProgress,v),o.__maxProgress>=o.__progress&&(p.__dirty=!0);}else c.__frame=-1,o&&(o.__nextIdxNotProg=u,s++,o=null);}o&&(s++,o.__nextIdxNotProg=u),this.eachBuildinLayer(function(t,e){n[e]!==t.elCount&&(t.__dirty=!0);}),i.length=Math.min(s,y),d.each(i,function(t,e){r[e]!==t.elCount&&(c.__dirty=!0),t.__dirty&&(t.__progress=0);});},clear:function clear(){return this.eachBuildinLayer(this._clearLayer),this;},_clearLayer:function _clearLayer(t){t.clear();},configLayer:function configLayer(t,e){if(e){var i=this._layerConfig;i[t]?d.merge(i[t],e,!0):i[t]=e;var n=this._layers[t];n&&d.merge(n,i[t],!0);}},delLayer:function delLayer(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(d.indexOf(i,t),1));},resize:function resize(t,e){var i=this._domRoot;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!=t||e!=this._height){i.style.width=t+"px",i.style.height=e+"px";for(var r in this._layers){this._layers.hasOwnProperty(r)&&this._layers[r].resize(t,e);}d.each(this._progressiveLayers,function(i){i.resize(t,e);}),this.refresh(!0);}return this._width=t,this._height=e,this;},clearLayer:function clearLayer(t){var e=this._layers[t];e&&e.clear();},dispose:function dispose(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null;},getRenderedCanvas:function getRenderedCanvas(t){if(t=t||{},this._singleCanvas)return this._layers[0].dom;var e=new m("image",this,t.pixelRatio||this.dpr);e.initContext(),e.clearColor=t.backgroundColor,e.clear();for(var i=this.storage.getDisplayList(!0),n={},r=0;r<i.length;r++){var o=i[r];this._doPaintEl(o,e,!0,n);}return e.dom;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},_getSize:function _getSize(t){var e=this._opts,i=["width","height"][t],r=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],a=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var s=this.root,l=document.defaultView.getComputedStyle(s);return(s[r]||n(l[i])||n(s.style[i]))-(n(l[o])||0)-(n(l[a])||0)|0;},_pathToImage:function _pathToImage(t,e,n,r,o){var a=document.createElement("canvas"),s=a.getContext("2d");a.width=n*o,a.height=r*o,s.clearRect(0,0,n*o,r*o);var l={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[0,0,0],e.rotation=0,e.scale=[1,1],e&&e.brush(s);var u=i(62),h=new u({id:t,style:{x:0,y:0,image:a}});return null!=l.position&&(h.position=e.position=l.position),null!=l.rotation&&(h.rotation=e.rotation=l.rotation),null!=l.scale&&(h.scale=e.scale=l.scale),h;},_createPathToImage:function _createPathToImage(){var t=this;return function(e,i,n,r){return t._pathToImage(e,i,n,r,t.dpr);};}},t.exports=b;},function(t,e,i){function n(){return!1;}function r(t,e,i,n){var r=document.createElement(e),o=i.getWidth(),a=i.getHeight(),s=r.style;return s.position="absolute",s.left=0,s.top=0,s.width=o+"px",s.height=a+"px",r.width=o*n,r.height=a*n,r.setAttribute("data-zr-dom-id",t),r;}var o=i(4),a=i(41),s=i(47),l=i(59),u=function u(t,e,i){var s;i=i||a.devicePixelRatio,"string"==typeof t?s=r(t,"canvas",e,i):o.isObject(t)&&(s=t,t=s.id),this.id=t,this.dom=s;var l=s.style;l&&(s.onselectstart=n,l["-webkit-user-select"]="none",l["user-select"]="none",l["-webkit-touch-callout"]="none",l["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",l.padding=0,l.margin=0,l["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=i;};u.prototype={constructor:u,elCount:0,__dirty:!0,initContext:function initContext(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr;},createBackBuffer:function createBackBuffer(){var t=this.dpr;this.domBack=r("back-"+this.id,"canvas",this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!=t&&this.ctxBack.scale(t,t);},resize:function resize(t,e){var i=this.dpr,n=this.dom,r=n.style,o=this.domBack;r.width=t+"px",r.height=e+"px",n.width=t*i,n.height=e*i,o&&(o.width=t*i,o.height=e*i,1!=i&&this.ctxBack.scale(i,i));},clear:function clear(t){var e=this.dom,i=this.ctx,n=e.width,r=e.height,o=this.clearColor,a=this.motionBlur&&!t,u=this.lastFrameAlpha,h=this.dpr;if(a&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(e,0,0,n/h,r/h)),i.clearRect(0,0,n,r),o){var c;o.colorStops?(c=o.__canvasGradient||s.getGradient(i,o,{x:0,y:0,width:n,height:r}),o.__canvasGradient=c):o.image&&(c=l.prototype.getCanvasPattern.call(o,i)),i.save(),i.fillStyle=c||o,i.fillRect(0,0,n,r),i.restore();}if(a){var d=this.domBack;i.save(),i.globalAlpha=u,i.drawImage(d,0,0,n,r),i.restore();}}},t.exports=u;},function(t,e,i){var n=i(61);t.exports=function(t){function e(e){var i=(e.visualColorAccessPath||"itemStyle.normal.color").split("."),r=e.getData(),o=e.get(i)||e.getColorFromPalette(e.get("name"));r.setVisual("color",o),t.isSeriesFiltered(e)||("function"!=typeof o||o instanceof n||r.each(function(t){r.setItemVisual(t,"color",o(e.getDataParams(t)));}),r.each(function(t){var e=r.getItemModel(t),n=e.get(i,!0);null!=n&&r.setItemVisual(t,"color",n);}));}t.eachRawSeries(e);};},function(t,e,i){function n(t,e){e=e.split(",");for(var i=t,n=0;n<e.length&&(i=i&&i[e[n]],null!=i);n++){}return i;}function r(t,e,i,n){e=e.split(",");for(var r,o=t,a=0;a<e.length-1;a++){r=e[a],null==o[r]&&(o[r]={}),o=o[r];}(n||null==o[e[a]])&&(o[e[a]]=i);}function o(t){c(l,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]]);});}var a=i(4),s=i(95),l=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],u=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],h=["bar","boxplot","candlestick","chord","effectScatter","funnel","gauge","lines","graph","heatmap","line","map","parallel","pie","radar","sankey","scatter","treemap"],c=a.each;t.exports=function(t){c(t.series,function(t){if(a.isObject(t)){var e=t.type;if(s(t),("pie"===e||"gauge"===e)&&null!=t.clockWise&&(t.clockwise=t.clockWise),"gauge"===e){var i=n(t,"pointer.color");null!=i&&r(t,"itemStyle.normal.color",i);}for(var l=0;l<h.length;l++){if(h[l]===t.type){o(t);break;}}}}),t.dataRange&&(t.visualMap=t.dataRange),c(u,function(e){var i=t[e];i&&(a.isArray(i)||(i=[i]),c(i,function(t){o(t);}));});};},function(t,e,i){function n(t){var e=t&&t.itemStyle;e&&r.each(o,function(i){var n=e.normal,o=e.emphasis;n&&n[i]&&(t[i]=t[i]||{},t[i].normal?r.merge(t[i].normal,n[i]):t[i].normal=n[i],n[i]=null),o&&o[i]&&(t[i]=t[i]||{},t[i].emphasis?r.merge(t[i].emphasis,o[i]):t[i].emphasis=o[i],o[i]=null);});}var r=i(4),o=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];t.exports=function(t){if(t){n(t),n(t.markPoint),n(t.markLine);var e=t.data;if(e){for(var i=0;i<e.length;i++){n(e[i]);}var o=t.markPoint;if(o&&o.data)for(var a=o.data,i=0;i<a.length;i++){n(a[i]);}var s=t.markLine;if(s&&s.data)for(var l=s.data,i=0;i<l.length;i++){r.isArray(l[i])?(n(l[i][0]),n(l[i][1])):n(l[i]);}}}};},function(t,e,i){var n=i(43),r=i(4),o=Math.PI;t.exports=function(t,e){e=e||{},r.defaults(e,{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var i=new n.Rect({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4}),a=new n.Arc({shape:{startAngle:-o/2,endAngle:-o/2+.1,r:10},style:{stroke:e.color,lineCap:"round",lineWidth:5},zlevel:e.zlevel,z:10001}),s=new n.Rect({style:{fill:"none",text:e.text,textPosition:"right",textDistance:10,textFill:e.textColor},zlevel:e.zlevel,z:10001});a.animateShape(!0).when(1e3,{endAngle:3*o/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*o/2}).delay(300).start("circularInOut");var l=new n.Group();return l.add(a),l.add(s),l.add(i),l.resize=function(){var e=t.getWidth()/2,n=t.getHeight()/2;a.setShape({cx:e,cy:n});var r=a.shape.r;s.setShape({x:e-r,y:n-r,width:2*r,height:2*r}),i.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()});},l.resize(),l;};},function(t,e,i){(function(e){function n(t){return d.isArray(t)||(t=[t]),t;}function r(t,e){var i=t.dimensions,n=new v(d.map(i,t.getDimensionInfo,t),t.hostModel);m(n,t);for(var r=n._storage={},o=t._storage,a=0;a<i.length;a++){var s=i[a],l=o[s];d.indexOf(e,s)>=0?r[s]=new l.constructor(o[s].length):r[s]=o[s];}return n;}var o="undefined",a="undefined"==typeof window?e:window,s=_typeof(a.Float64Array)===o?Array:a.Float64Array,l=_typeof(a.Int32Array)===o?Array:a.Int32Array,u={"float":s,"int":l,ordinal:Array,number:Array,time:Array},h=i(12),c=i(98),d=i(4),f=i(5),p=d.isObject,g=["stackedOn","hasItemOption","_nameList","_idList","_rawData"],m=function m(t,e){d.each(g.concat(e.__wrappedMethods||[]),function(i){e.hasOwnProperty(i)&&(t[i]=e[i]);}),t.__wrappedMethods=e.__wrappedMethods;},v=function v(t,e){t=t||["x","y"];for(var i={},n=[],r=0;r<t.length;r++){var o,a={};"string"==typeof t[r]?(o=t[r],a={name:o,stackable:!1,type:"number"}):(a=t[r],o=a.name,a.type=a.type||"number"),n.push(o),i[o]=a;}this.dimensions=n,this._dimensionInfos=i,this.hostModel=e,this.dataType,this.indices=[],this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this.stackedOn=null,this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._rawData,this._extent;},y=v.prototype;y.type="list",y.hasItemOption=!0,y.getDimension=function(t){return isNaN(t)||(t=this.dimensions[t]||t),t;},y.getDimensionInfo=function(t){return d.clone(this._dimensionInfos[this.getDimension(t)]);},y.initData=function(t,e,i){if(t=t||[],!d.isArray(t))throw new Error("Invalid data.");this._rawData=t;var n=this._storage={},r=this.indices=[],o=this.dimensions,a=t.length,s=this._dimensionInfos,l=[],h={};e=e||[];for(var c=0;c<o.length;c++){var p=s[o[c]],g=u[p.type];n[o[c]]=new g(a);}var m=this;i||(m.hasItemOption=!1),i=i||function(t,e,i,n){var r=f.getDataItemValue(t);return f.isDataItemOption(t)&&(m.hasItemOption=!0),f.converDataValue(r instanceof Array?r[n]:r,s[e]);};for(var v=0;v<t.length;v++){for(var y=t[v],x=0;x<o.length;x++){var _=o[x],b=n[_];b[v]=i(y,_,v,x);}r.push(v);}for(var c=0;c<t.length;c++){e[c]||t[c]&&null!=t[c].name&&(e[c]=t[c].name);var w=e[c]||"",S=t[c]&&t[c].id;!S&&w&&(h[w]=h[w]||0,S=w,h[w]>0&&(S+="__ec__"+h[w]),h[w]++),S&&(l[c]=S);}this._nameList=e,this._idList=l;},y.count=function(){return this.indices.length;},y.get=function(t,e,i){var n=this._storage,r=this.indices[e];if(null==r)return NaN;var o=n[t]&&n[t][r];if(i){var a=this._dimensionInfos[t];if(a&&a.stackable)for(var s=this.stackedOn;s;){var l=s.get(t,e);(o>=0&&l>0||0>=o&&0>l)&&(o+=l),s=s.stackedOn;}}return o;},y.getValues=function(t,e,i){var n=[];d.isArray(t)||(i=e,e=t,t=this.dimensions);for(var r=0,o=t.length;o>r;r++){n.push(this.get(t[r],e,i));}return n;},y.hasValue=function(t){for(var e=this.dimensions,i=this._dimensionInfos,n=0,r=e.length;r>n;n++){if("ordinal"!==i[e[n]].type&&isNaN(this.get(e[n],t)))return!1;}return!0;},y.getDataExtent=function(t,e){t=this.getDimension(t);var i=this._storage[t],n=this.getDimensionInfo(t);e=n&&n.stackable&&e;var r,o=(this._extent||(this._extent={}))[t+!!e];if(o)return o;if(i){for(var a=1/0,s=-(1/0),l=0,u=this.count();u>l;l++){r=this.get(t,l,e),a>r&&(a=r),r>s&&(s=r);}return this._extent[t+!!e]=[a,s];}return[1/0,-(1/0)];},y.getSum=function(t,e){var i=this._storage[t],n=0;if(i)for(var r=0,o=this.count();o>r;r++){var a=this.get(t,r,e);isNaN(a)||(n+=a);}return n;},y.indexOf=function(t,e){var i=this._storage,n=i[t],r=this.indices;if(n)for(var o=0,a=r.length;a>o;o++){var s=r[o];if(n[s]===e)return o;}return-1;},y.indexOfName=function(t){for(var e=this.indices,i=this._nameList,n=0,r=e.length;r>n;n++){var o=e[n];if(i[o]===t)return n;}return-1;},y.indexOfRawIndex=function(t){var e=this.indices,i=e[t];if(null!=i&&i===t)return t;for(var n=0,r=e.length-1;r>=n;){var o=(n+r)/2|0;if(e[o]<t)n=o+1;else{if(!(e[o]>t))return o;r=o-1;}}return-1;},y.indexOfNearest=function(t,e,i,n){var r=this._storage,o=r[t];null==n&&(n=1/0);var a=-1;if(o)for(var s=Number.MAX_VALUE,l=0,u=this.count();u>l;l++){var h=e-this.get(t,l,i),c=Math.abs(h);n>=h&&(s>c||c===s&&h>0)&&(s=c,a=l);}return a;},y.getRawIndex=function(t){var e=this.indices[t];return null==e?-1:e;},y.getRawDataItem=function(t){return this._rawData[this.getRawIndex(t)];},y.getName=function(t){return this._nameList[this.indices[t]]||"";},y.getId=function(t){return this._idList[this.indices[t]]||this.getRawIndex(t)+"";},y.each=function(t,e,i,r){"function"==typeof t&&(r=i,i=e,e=t,t=[]),t=d.map(n(t),this.getDimension,this);var o=[],a=t.length,s=this.indices;r=r||this;for(var l=0;l<s.length;l++){switch(a){case 0:e.call(r,l);break;case 1:e.call(r,this.get(t[0],l,i),l);break;case 2:e.call(r,this.get(t[0],l,i),this.get(t[1],l,i),l);break;default:for(var u=0;a>u;u++){o[u]=this.get(t[u],l,i);}o[u]=l,e.apply(r,o);}}},y.filterSelf=function(t,e,i,r){"function"==typeof t&&(r=i,i=e,e=t,t=[]),t=d.map(n(t),this.getDimension,this);var o=[],a=[],s=t.length,l=this.indices;r=r||this;for(var u=0;u<l.length;u++){var h;if(1===s)h=e.call(r,this.get(t[0],u,i),u);else{for(var c=0;s>c;c++){a[c]=this.get(t[c],u,i);}a[c]=u,h=e.apply(r,a);}h&&o.push(l[u]);}return this.indices=o,this._extent={},this;},y.mapArray=function(t,e,i,n){"function"==typeof t&&(n=i,i=e,e=t,t=[]);var r=[];return this.each(t,function(){r.push(e&&e.apply(this,arguments));},i,n),r;},y.map=function(t,e,i,o){t=d.map(n(t),this.getDimension,this);var a=r(this,t),s=a.indices=this.indices,l=a._storage,u=[];return this.each(t,function(){var i=arguments[arguments.length-1],n=e&&e.apply(this,arguments);if(null!=n){"number"==typeof n&&(u[0]=n,n=u);for(var r=0;r<n.length;r++){var o=t[r],a=l[o],h=s[i];a&&(a[h]=n[r]);}}},i,o),a;},y.downSample=function(t,e,i,n){for(var o=r(this,[t]),a=this._storage,s=o._storage,l=this.indices,u=o.indices=[],h=[],c=[],d=Math.floor(1/e),f=s[t],p=this.count(),g=0;g<a[t].length;g++){s[t][g]=a[t][g];}for(var g=0;p>g;g+=d){d>p-g&&(d=p-g,h.length=d);for(var m=0;d>m;m++){var v=l[g+m];h[m]=f[v],c[m]=v;}var y=i(h),v=c[n(h,y)||0];f[v]=y,u.push(v);}return o;},y.getItemModel=function(t){var e=this.hostModel;return t=this.indices[t],new h(this._rawData[t],e,e&&e.ecModel);},y.diff=function(t){var e=this._idList,i=t&&t._idList;return new c(t?t.indices:[],this.indices,function(t){return i[t]||t+"";},function(t){return e[t]||t+"";});},y.getVisual=function(t){var e=this._visual;return e&&e[t];},y.setVisual=function(t,e){if(p(t))for(var i in t){t.hasOwnProperty(i)&&this.setVisual(i,t[i]);}else this._visual=this._visual||{},this._visual[t]=e;},y.setLayout=function(t,e){if(p(t))for(var i in t){t.hasOwnProperty(i)&&this.setLayout(i,t[i]);}else this._layout[t]=e;},y.getLayout=function(t){return this._layout[t];},y.getItemLayout=function(t){return this._itemLayouts[t];},y.setItemLayout=function(t,e,i){this._itemLayouts[t]=i?d.extend(this._itemLayouts[t]||{},e):e;},y.clearItemLayouts=function(){this._itemLayouts.length=0;},y.getItemVisual=function(t,e,i){var n=this._itemVisuals[t],r=n&&n[e];return null!=r||i?r:this.getVisual(e);},y.setItemVisual=function(t,e,i){var n=this._itemVisuals[t]||{};if(this._itemVisuals[t]=n,p(e))for(var r in e){e.hasOwnProperty(r)&&(n[r]=e[r]);}else n[e]=i;},y.clearAllVisual=function(){this._visual={},this._itemVisuals=[];};var x=function x(t){t.seriesIndex=this.seriesIndex,t.dataIndex=this.dataIndex,t.dataType=this.dataType;};y.setItemGraphicEl=function(t,e){var i=this.hostModel;e&&(e.dataIndex=t,e.dataType=this.dataType,e.seriesIndex=i&&i.seriesIndex,"group"===e.type&&e.traverse(x,e)),this._graphicEls[t]=e;},y.getItemGraphicEl=function(t){return this._graphicEls[t];},y.eachItemGraphicEl=function(t,e){d.each(this._graphicEls,function(i,n){i&&t&&t.call(e,i,n);});},y.cloneShallow=function(){var t=d.map(this.dimensions,this.getDimensionInfo,this),e=new v(t,this.hostModel);return e._storage=this._storage,m(e,this),e.indices=this.indices.slice(),this._extent&&(e._extent=d.extend({},this._extent)),e;},y.wrapMethod=function(t,e){var i=this[t];"function"==typeof i&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=i.apply(this,arguments);return e.apply(this,[t].concat(d.slice(arguments)));});},y.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],y.CHANGABLE_METHODS=["filterSelf"],t.exports=v;}).call(e,function(){return this;}());},function(t,e){"use strict";function i(t){return t;}function n(t,e,n,r){this._old=t,this._new=e,this._oldKeyGetter=n||i,this._newKeyGetter=r||i;}function r(t,e,i,n){for(var r=0;r<t.length;r++){var o=n(t[r],r),a=e[o];null==a?(i.push(o),e[o]=r):(a.length||(e[o]=a=[a]),a.push(r));}}n.prototype={constructor:n,add:function add(t){return this._add=t,this;},update:function update(t){return this._update=t,this;},remove:function remove(t){return this._remove=t,this;},execute:function execute(){var t,e=this._old,i=this._new,n=this._oldKeyGetter,o=this._newKeyGetter,a={},s={},l=[],u=[];for(r(e,a,l,n),r(i,s,u,o),t=0;t<e.length;t++){var h=l[t],c=s[h];if(null!=c){var d=c.length;d?(1===d&&(s[h]=null),c=c.unshift()):s[h]=null,this._update&&this._update(c,t);}else this._remove&&this._remove(t);}for(var t=0;t<u.length;t++){var h=u[t];if(s.hasOwnProperty(h)){var c=s[h];if(null==c)continue;if(c.length)for(var f=0,d=c.length;d>f;f++){this._add&&this._add(c[f]);}else this._add&&this._add(c);}}}},t.exports=n;},function(t,e,i){var n=i(4),r=i(1),o=r.PRIORITY;i(100),i(103),r.registerVisual(n.curry(i(109),"line","circle","line")),r.registerLayout(n.curry(i(110),"line")),r.registerProcessor(o.PROCESSOR.STATISTIC,n.curry(i(111),"line")),i(112);},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=t.coordinateSystem;if("polar"!==i&&"cartesian2d"!==i)throw new Error("Line not support coordinateSystem besides cartesian and polar");return n(t.data,this,e);},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clipOverflow:!0,label:{normal:{position:"top"}},lineStyle:{normal:{width:2,type:"solid"}},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:!1,connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});},function(t,e,i){"use strict";function n(t){for(var e=0;e<t.length&&null==t[e];){e++;}return t[e];}function r(t){var e=n(t);return null!=e&&!c.isArray(p(e));}function o(t,e,i){if(t=t||[],!c.isArray(t))throw new Error("Invalid data.");var n=e.get("coordinateSystem"),o=m[n],a=f.get(n),s=o&&o(t,e,i),v=s&&s.dimensions;v||(v=a&&a.dimensions||["x","y"],v=h(v,t,v.concat(["value"])));var y=s?s.categoryIndex:-1,x=new u(v,e),_=l(s,t),b={},w=y>=0&&r(t)?function(t,e,i,n){return d.isDataItemOption(t)&&(x.hasItemOption=!0),n===y?i:g(p(t),v[n]);}:function(t,e,i,n){var r=p(t),o=g(r&&r[n],v[n]);d.isDataItemOption(t)&&(x.hasItemOption=!0);var a=s&&s.categoryAxesModels;return a&&a[e]&&"string"==typeof o&&(b[e]=b[e]||a[e].getCategories(),o=c.indexOf(b[e],o),0>o&&!isNaN(o)&&(o=+o)),o;};return x.hasItemOption=!1,x.initData(t,_,w),x;}function a(t){return"category"!==t&&"time"!==t;}function s(t){return"category"===t?"ordinal":"time"===t?"time":"float";}function l(t,e){var i,n=[],r=t&&t.dimensions[t.categoryIndex];if(r&&(i=t.categoryAxesModels[r.name]),i){var o=i.getCategories();if(o){var a=e.length;if(c.isArray(e[0])&&e[0].length>1){n=[];for(var s=0;a>s;s++){n[s]=o[e[s][t.categoryIndex||0]];}}else n=o.slice(0);}}return n;}var u=i(97),h=i(102),c=i(4),d=i(5),f=i(26),p=d.getDataItemValue,g=d.converDataValue,m={cartesian2d:function cartesian2d(t,e,i){var n=c.map(["xAxis","yAxis"],function(t){return i.queryComponents({mainType:t,index:e.get(t+"Index"),id:e.get(t+"Id")})[0];}),r=n[0],o=n[1];if(!r)throw new Error('xAxis "'+c.retrieve(e.get("xAxisIndex"),e.get("xAxisId"),0)+'" not found');if(!o)throw new Error('yAxis "'+c.retrieve(e.get("xAxisIndex"),e.get("yAxisId"),0)+'" not found');var l=r.get("type"),u=o.get("type"),d=[{name:"x",type:s(l),stackable:a(l)},{name:"y",type:s(u),stackable:a(u)}],f="category"===l,p="category"===u;h(d,t,["x","y","z"]);var g={};return f&&(g.x=r),p&&(g.y=o),{dimensions:d,categoryIndex:f?0:p?1:-1,categoryAxesModels:g};},polar:function polar(t,e,i){var n=i.queryComponents({mainType:"polar",index:e.get("polarIndex"),id:e.get("polarId")})[0],r=n.findAxisModel("angleAxis"),o=n.findAxisModel("radiusAxis");if(!r)throw new Error("angleAxis option not found");if(!o)throw new Error("radiusAxis option not found");var l=o.get("type"),u=r.get("type"),c=[{name:"radius",type:s(l),stackable:a(l)},{name:"angle",type:s(u),stackable:a(u)}],d="category"===u,f="category"===l;h(c,t,["radius","angle","value"]);var p={};return f&&(p.radius=o),d&&(p.angle=r),{dimensions:c,categoryIndex:d?1:f?0:-1,categoryAxesModels:p};},geo:function geo(t,e,i){return{dimensions:h([{name:"lng"},{name:"lat"}],t,["lng","lat","value"])};}};t.exports=o;},function(t,e,i){function n(t,e,i,n){if(!e)return t;var s=r(e[0]),l=o.isArray(s)&&s.length||1;i=i||[],n=n||"extra";for(var u=0;l>u;u++){if(!t[u]){var h=i[u]||n+(u-i.length);t[u]=a(e,u)?{type:"ordinal",name:h}:h;}}return t;}function r(t){return o.isArray(t)?t:o.isObject(t)?t.value:t;}var o=i(4),a=n.guessOrdinal=function(t,e){for(var i=0,n=t.length;n>i;i++){var a=r(t[i]);if(!o.isArray(a))return!1;var a=a[e];if(null!=a&&isFinite(a))return!1;if(o.isString(a)&&"-"!==a)return!0;}return!1;};t.exports=n;},function(t,e,i){"use strict";function n(t,e){if(t.length===e.length){for(var i=0;i<t.length;i++){var n=t[i],r=e[i];if(n[0]!==r[0]||n[1]!==r[1])return;}return!0;}}function r(t){return"number"==typeof t?t:t?.3:0;}function o(t){var e=t.getGlobalExtent();if(t.onBand){var i=t.getBandWidth()/2-1,n=e[1]>e[0]?1:-1;e[0]+=n*i,e[1]-=n*i;}return e;}function a(t){return t>=0?1:-1;}function s(t,e){var i=t.getBaseAxis(),n=t.getOtherAxis(i),r=i.onZero?0:n.scale.getExtent()[0],o=n.dim,s="x"===o||"radius"===o?1:0;return e.mapArray([o],function(n,l){for(var u,h=e.stackedOn;h&&a(h.get(o,l))===a(n);){u=h;break;}var c=[];return c[s]=e.get(i.dim,l),c[1-s]=u?u.get(o,l,!0):r,t.dataToPoint(c);},!0);}function l(t,e,i){var n=o(t.getAxis("x")),r=o(t.getAxis("y")),a=t.getBaseAxis().isHorizontal(),s=Math.min(n[0],n[1]),l=Math.min(r[0],r[1]),u=Math.max(n[0],n[1])-s,h=Math.max(r[0],r[1])-l,c=i.get("lineStyle.normal.width")||2,d=i.get("clipOverflow")?c/2:Math.max(u,h);a?(l-=d,h+=2*d):(s-=d,u+=2*d);var f=new y.Rect({shape:{x:s,y:l,width:u,height:h}});return e&&(f.shape[a?"width":"height"]=0,y.initProps(f,{shape:{width:u,height:h}},i)),f;}function u(t,e,i){var n=t.getAngleAxis(),r=t.getRadiusAxis(),o=r.getExtent(),a=n.getExtent(),s=Math.PI/180,l=new y.Sector({shape:{cx:t.cx,cy:t.cy,r0:o[0],r:o[1],startAngle:-a[0]*s,endAngle:-a[1]*s,clockwise:n.inverse}});return e&&(l.shape.endAngle=-a[0]*s,y.initProps(l,{shape:{endAngle:-a[1]*s}},i)),l;}function h(t,e,i){return"polar"===t.type?u(t,e,i):l(t,e,i);}function c(t,e,i){for(var n=e.getBaseAxis(),r="x"===n.dim||"radius"===n.dim?0:1,o=[],a=0;a<t.length-1;a++){var s=t[a+1],l=t[a];o.push(l);var u=[];switch(i){case"end":u[r]=s[r],u[1-r]=l[1-r],o.push(u);break;case"middle":var h=(l[r]+s[r])/2,c=[];u[r]=c[r]=h,u[1-r]=l[1-r],c[1-r]=s[1-r],o.push(u),o.push(c);break;default:u[r]=l[r],u[1-r]=s[1-r],o.push(u);}}return t[a]&&o.push(t[a]),o;}function d(t,e){return Math.max(Math.min(t,e[1]),e[0]);}function f(t,e){var i=t.getVisual("visualMeta");if(i&&i.length&&t.count()){for(var n,r=i.length-1;r>=0;r--){if(i[r].dimension<2){n=i[r];break;}}if(!n||"cartesian2d"!==e.type)return void console.warn("Visual map on line style only support x or y dimension.");var o=n.dimension,a=t.dimensions[o],s=t.getDataExtent(a),l=n.stops,u=[];l[0].interval&&l.sort(function(t,e){return t.interval[0]-e.interval[0];});var h=l[0],c=l[l.length-1],f=h.interval?d(h.interval[0],s):h.value,p=c.interval?d(c.interval[1],s):c.value,g=p-f;if(0===g)return t.getItemVisual(0,"color");for(var r=0;r<l.length;r++){if(l[r].interval){if(l[r].interval[1]===l[r].interval[0])continue;u.push({offset:(d(l[r].interval[0],s)-f)/g,color:l[r].color},{offset:(d(l[r].interval[1],s)-f)/g,color:l[r].color});}else u.push({offset:(l[r].value-f)/g,color:l[r].color});}var m=new y.LinearGradient(0,0,0,0,u,!0),v=e.getAxis(a),x=v.toGlobalCoord(v.dataToCoord(f)),_=v.toGlobalCoord(v.dataToCoord(p));return m[a]=x,m[a+"2"]=_,m;}}var p=i(4),g=i(104),m=i(105),v=i(107),y=i(43),x=i(5),_=i(108),b=i(42);t.exports=b.extend({type:"line",init:function init(){var t=new y.Group(),e=new g();this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t;},render:function render(t,e,i){var o=t.coordinateSystem,a=this.group,l=t.getData(),u=t.getModel("lineStyle.normal"),d=t.getModel("areaStyle.normal"),g=l.mapArray(l.getItemLayout,!0),m="polar"===o.type,v=this._coordSys,y=this._symbolDraw,x=this._polyline,_=this._polygon,b=this._lineGroup,w=t.get("animation"),S=!d.isEmpty(),M=s(o,l),I=t.get("showSymbol"),T=I&&!m&&!t.get("showAllSymbol")&&this._getSymbolIgnoreFunc(l,o),A=this._data;A&&A.eachItemGraphicEl(function(t,e){t.__temp&&(a.remove(t),A.setItemGraphicEl(e,null));}),I||y.remove(),a.add(b);var L=!m&&t.get("step");x&&v.type===o.type&&L===this._step?(S&&!_?_=this._newPolygon(g,M,o,w):_&&!S&&(b.remove(_),_=this._polygon=null),b.setClipPath(h(o,!1,t)),I&&y.updateData(l,T),l.eachItemGraphicEl(function(t){t.stopAnimation(!0);}),n(this._stackedOnPoints,M)&&n(this._points,g)||(w?this._updateAnimation(l,M,o,i,L):(L&&(g=c(g,o,L),M=c(M,o,L)),x.setShape({points:g}),_&&_.setShape({points:g,stackedOnPoints:M})))):(I&&y.updateData(l,T),L&&(g=c(g,o,L),M=c(M,o,L)),x=this._newPolyline(g,o,w),S&&(_=this._newPolygon(g,M,o,w)),b.setClipPath(h(o,!0,t)));var C=f(l,o)||l.getVisual("color");x.useStyle(p.defaults(u.getLineStyle(),{fill:"none",stroke:C,lineJoin:"bevel"}));var D=t.get("smooth");if(D=r(t.get("smooth")),x.setShape({smooth:D,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")}),_){var P=l.stackedOn,k=0;if(_.useStyle(p.defaults(d.getAreaStyle(),{fill:C,opacity:.7,lineJoin:"bevel"})),P){var z=P.hostModel;k=r(z.get("smooth"));}_.setShape({smooth:D,stackedOnSmooth:k,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")});}this._data=l,this._coordSys=o,this._stackedOnPoints=M,this._points=g,this._step=L;},dispose:function dispose(){},highlight:function highlight(t,e,i,n){var r=t.getData(),o=x.queryDataIndex(r,n);if(!(o instanceof Array)&&null!=o&&o>=0){var a=r.getItemGraphicEl(o);if(!a){var s=r.getItemLayout(o);a=new m(r,o),a.position=s,a.setZ(t.get("zlevel"),t.get("z")),a.ignore=isNaN(s[0])||isNaN(s[1]),a.__temp=!0,r.setItemGraphicEl(o,a),a.stopSymbolAnimation(!0),this.group.add(a);}a.highlight();}else b.prototype.highlight.call(this,t,e,i,n);},downplay:function downplay(t,e,i,n){var r=t.getData(),o=x.queryDataIndex(r,n);if(null!=o&&o>=0){var a=r.getItemGraphicEl(o);a&&(a.__temp?(r.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay());}else b.prototype.downplay.call(this,t,e,i,n);},_newPolyline:function _newPolyline(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new _.Polyline({shape:{points:t},silent:!0,z2:10}),this._lineGroup.add(e),this._polyline=e,e;},_newPolygon:function _newPolygon(t,e){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new _.Polygon({shape:{points:t,stackedOnPoints:e},silent:!0}),this._lineGroup.add(i),this._polygon=i,i;},_getSymbolIgnoreFunc:function _getSymbolIgnoreFunc(t,e){var i=e.getAxesByScale("ordinal")[0];return i&&i.isLabelIgnored?p.bind(i.isLabelIgnored,i):void 0;},_updateAnimation:function _updateAnimation(t,e,i,n,r){var o=this._polyline,a=this._polygon,s=t.hostModel,l=v(this._data,t,this._stackedOnPoints,e,this._coordSys,i),u=l.current,h=l.stackedOnCurrent,d=l.next,f=l.stackedOnNext;r&&(u=c(l.current,i,r),h=c(l.stackedOnCurrent,i,r),d=c(l.next,i,r),f=c(l.stackedOnNext,i,r)),o.shape.__points=l.current,o.shape.points=u,y.updateProps(o,{shape:{points:d}},s),a&&(a.setShape({points:u,stackedOnPoints:h}),y.updateProps(a,{shape:{points:d,stackedOnPoints:f}},s));for(var p=[],g=l.status,m=0;m<g.length;m++){var x=g[m].cmd;if("="===x){var _=t.getItemGraphicEl(g[m].idx1);_&&p.push({el:_,ptIdx:m});}}o.animators&&o.animators.length&&o.animators[0].during(function(){for(var t=0;t<p.length;t++){var e=p[t].el;e.attr("position",o.shape.__points[p[t].ptIdx]);}});},remove:function remove(t){var e=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(t,n){t.__temp&&(e.remove(t),i.setItemGraphicEl(n,null));}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null;}});},function(t,e,i){function n(t){this.group=new o.Group(),this._symbolCtor=t||a;}function r(t,e,i){var n=t.getItemLayout(e);return n&&!isNaN(n[0])&&!isNaN(n[1])&&!(i&&i(e))&&"none"!==t.getItemVisual(e,"symbol");}var o=i(43),a=i(105),s=n.prototype;s.updateData=function(t,e){var i=this.group,n=t.hostModel,a=this._data,s=this._symbolCtor,l={itemStyle:n.getModel("itemStyle.normal").getItemStyle(["color"]),hoverItemStyle:n.getModel("itemStyle.emphasis").getItemStyle(),symbolRotate:n.get("symbolRotate"),symbolOffset:n.get("symbolOffset"),hoverAnimation:n.get("hoverAnimation"),labelModel:n.getModel("label.normal"),hoverLabelModel:n.getModel("label.emphasis")};t.diff(a).add(function(n){var o=t.getItemLayout(n);if(r(t,n,e)){var a=new s(t,n,l);a.attr("position",o),t.setItemGraphicEl(n,a),i.add(a);}}).update(function(u,h){var c=a.getItemGraphicEl(h),d=t.getItemLayout(u);return r(t,u,e)?(c?(c.updateData(t,u,l),o.updateProps(c,{position:d},n)):(c=new s(t,u),c.attr("position",d)),i.add(c),void t.setItemGraphicEl(u,c)):void i.remove(c);}).remove(function(t){var e=a.getItemGraphicEl(t);e&&e.fadeOut(function(){i.remove(e);});}).execute(),this._data=t;},s.updateLayout=function(){var t=this._data;t&&t.eachItemGraphicEl(function(e,i){var n=t.getItemLayout(i);e.attr("position",n);});},s.remove=function(t){var e=this.group,i=this._data;i&&(t?i.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t);});}):e.removeAll());},t.exports=n;},function(t,e,i){function n(t){return t=t instanceof Array?t.slice():[+t,+t],t[0]/=2,t[1]/=2,t;}function r(t,e,i){l.Group.call(this),this.updateData(t,e,i);}function o(t,e){this.parent.drift(t,e);}var a=i(4),s=i(106),l=i(43),u=i(7),h=r.prototype;h._createSymbol=function(t,e,i){this.removeAll();var r=e.hostModel,a=e.getItemVisual(i,"color"),u=s.createSymbol(t,-1,-1,2,2,a);u.attr({z2:100,culling:!0,scale:[0,0]}),u.drift=o;var h=n(e.getItemVisual(i,"symbolSize"));l.initProps(u,{scale:h},r,i),this._symbolType=t,this.add(u);},h.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(t);},h.getSymbolPath=function(){return this.childAt(0);},h.getScale=function(){return this.childAt(0).scale;},h.highlight=function(){this.childAt(0).trigger("emphasis");},h.downplay=function(){this.childAt(0).trigger("normal");},h.setZ=function(t,e){var i=this.childAt(0);i.zlevel=t,i.z=e;},h.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":"pointer";},h.updateData=function(t,e,i){this.silent=!1;var r=t.getItemVisual(e,"symbol")||"circle",o=t.hostModel,a=n(t.getItemVisual(e,"symbolSize"));if(r!==this._symbolType)this._createSymbol(r,t,e);else{var s=this.childAt(0);l.updateProps(s,{scale:a},o,e);}this._updateCommon(t,e,a,i),this._seriesModel=o;};var c=["itemStyle","normal"],d=["itemStyle","emphasis"],f=["label","normal"],p=["label","emphasis"];h._updateCommon=function(t,e,i,r){var o=this.childAt(0),s=t.hostModel,h=t.getItemVisual(e,"color");"image"!==o.type&&o.useStyle({strokeNoScale:!0}),r=r||null;var g=r&&r.itemStyle,m=r&&r.hoverItemStyle,v=r&&r.symbolRotate,y=r&&r.symbolOffset,x=r&&r.labelModel,_=r&&r.hoverLabelModel,b=r&&r.hoverAnimation;if(!r||t.hasItemOption){var w=t.getItemModel(e);g=w.getModel(c).getItemStyle(["color"]),m=w.getModel(d).getItemStyle(),v=w.getShallow("symbolRotate"),y=w.getShallow("symbolOffset"),x=w.getModel(f),_=w.getModel(p),b=w.getShallow("hoverAnimation");}else m=a.extend({},m);var S=o.style;o.attr("rotation",(v||0)*Math.PI/180||0),y&&o.attr("position",[u.parsePercent(y[0],i[0]),u.parsePercent(y[1],i[1])]),o.setColor(h),o.setStyle(g);var M=t.getItemVisual(e,"opacity");null!=M&&(S.opacity=M);for(var I,T,A=t.dimensions.slice();A.length&&(I=A.pop(),T=t.getDimensionInfo(I).type,"ordinal"===T||"time"===T);){}null!=I&&x.getShallow("show")?(l.setText(S,x,h),S.text=a.retrieve(s.getFormattedLabel(e,"normal"),t.get(I,e))):S.text="",null!=I&&_.getShallow("show")?(l.setText(m,_,h),m.text=a.retrieve(s.getFormattedLabel(e,"emphasis"),t.get(I,e))):m.text="";var L=n(t.getItemVisual(e,"symbolSize"));if(o.off("mouseover").off("mouseout").off("emphasis").off("normal"),o.hoverStyle=m,l.setHoverStyle(o),b&&s.ifEnableAnimation()){var C=function C(){var t=L[1]/L[0];this.animateTo({scale:[Math.max(1.1*L[0],L[0]+3),Math.max(1.1*L[1],L[1]+3*t)]},400,"elasticOut");},D=function D(){this.animateTo({scale:L},400,"elasticOut");};o.on("mouseover",C).on("mouseout",D).on("emphasis",C).on("normal",D);}},h.fadeOut=function(t){var e=this.childAt(0);this.silent=!0,e.style.text="",l.updateProps(e,{scale:[0,0]},this._seriesModel,this.dataIndex,t);},a.inherits(r,l.Group),t.exports=r;},function(t,e,i){"use strict";var n=i(43),r=i(9),o=n.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n+o),t.lineTo(i-r,n+o),t.closePath();}}),a=n.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n),t.lineTo(i,n+o),t.lineTo(i-r,n),t.closePath();}}),s=n.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.x,n=e.y,r=e.width/5*3,o=Math.max(r,e.height),a=r/2,s=a*a/(o-a),l=n-o+a+s,u=Math.asin(s/a),h=Math.cos(u)*a,c=Math.sin(u),d=Math.cos(u);t.arc(i,l,a,Math.PI-u,2*Math.PI+u);var f=.6*a,p=.7*a;t.bezierCurveTo(i+h-c*f,l+s+d*f,i,n-p,i,n),t.bezierCurveTo(i,n-p,i-h+c*f,l+s+d*f,i-h,l+s),t.closePath();}}),l=n.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.height,n=e.width,r=e.x,o=e.y,a=n/3*2;t.moveTo(r,o),t.lineTo(r+a,o+i),t.lineTo(r,o+i/4*3),t.lineTo(r-a,o+i),t.lineTo(r,o),t.closePath();}}),u={line:n.Line,rect:n.Rect,roundRect:n.Rect,square:n.Rect,circle:n.Circle,diamond:a,pin:s,arrow:l,triangle:o},h={line:function line(t,e,i,n,r){r.x1=t,r.y1=e+n/2,r.x2=t+i,r.y2=e+n/2;},rect:function rect(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n;},roundRect:function roundRect(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n,r.r=Math.min(i,n)/4;},square:function square(t,e,i,n,r){var o=Math.min(i,n);r.x=t,r.y=e,r.width=o,r.height=o;},circle:function circle(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.r=Math.min(i,n)/2;},diamond:function diamond(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n;},pin:function pin(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n;},arrow:function arrow(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n;},triangle:function triangle(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n;}},c={};for(var d in u){u.hasOwnProperty(d)&&(c[d]=new u[d]());}var f=n.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function beforeBrush(){var t=this.style,e=this.shape;"pin"===e.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle");},buildPath:function buildPath(t,e,i){var n=e.symbolType,r=c[n];"none"!==e.symbolType&&(r||(n="rect",r=c[n]),h[n](e.x,e.y,e.width,e.height,r.shape),r.buildPath(t,r.shape,i));}}),p=function p(t){if("image"!==this.type){var e=this.style,i=this.shape;i&&"line"===i.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty(!1);}},g={createSymbol:function createSymbol(t,e,i,o,a,s){var l=0===t.indexOf("empty");l&&(t=t.substr(5,1).toLowerCase()+t.substr(6));var u;return u=0===t.indexOf("image://")?new n.Image({style:{image:t.slice(8),x:e,y:i,width:o,height:a}}):0===t.indexOf("path://")?n.makePath(t.slice(7),{},new r(e,i,o,a)):new f({shape:{symbolType:t,x:e,y:i,width:o,height:a}}),u.__isEmptyBrush=l,u.setColor=p,u.setColor(s),u;}};t.exports=g;},function(t,e){function i(t){return t>=0?1:-1;}function n(t,e,n){for(var r,o=t.getBaseAxis(),a=t.getOtherAxis(o),s=o.onZero?0:a.scale.getExtent()[0],l=a.dim,u="x"===l||"radius"===l?1:0,h=e.stackedOn,c=e.get(l,n);h&&i(h.get(l,n))===i(c);){r=h;break;}var d=[];return d[u]=e.get(o.dim,n),d[1-u]=r?r.get(l,n,!0):s,t.dataToPoint(d);}function r(t,e){var i=[];return e.diff(t).add(function(t){i.push({cmd:"+",idx:t});}).update(function(t,e){i.push({cmd:"=",idx:e,idx1:t});}).remove(function(t){i.push({cmd:"-",idx:t});}).execute(),i;}t.exports=function(t,e,i,o,a,s){for(var l=r(t,e),u=[],h=[],c=[],d=[],f=[],p=[],g=[],m=s.dimensions,v=0;v<l.length;v++){var y=l[v],x=!0;switch(y.cmd){case"=":var _=t.getItemLayout(y.idx),b=e.getItemLayout(y.idx1);(isNaN(_[0])||isNaN(_[1]))&&(_=b.slice()),u.push(_),h.push(b),c.push(i[y.idx]),d.push(o[y.idx1]),g.push(e.getRawIndex(y.idx1));break;case"+":var w=y.idx;u.push(a.dataToPoint([e.get(m[0],w,!0),e.get(m[1],w,!0)])),h.push(e.getItemLayout(w).slice()),c.push(n(a,e,w)),d.push(o[w]),g.push(e.getRawIndex(w));break;case"-":var w=y.idx,S=t.getRawIndex(w);S!==w?(u.push(t.getItemLayout(w)),h.push(s.dataToPoint([t.get(m[0],w,!0),t.get(m[1],w,!0)])),c.push(i[w]),d.push(n(s,t,w)),g.push(S)):x=!1;}x&&(f.push(y),p.push(p.length));}p.sort(function(t,e){return g[t]-g[e];});for(var M=[],I=[],T=[],A=[],L=[],v=0;v<p.length;v++){var w=p[v];M[v]=u[w],I[v]=h[w],T[v]=c[w],A[v]=d[w],L[v]=f[w];}return{current:M,next:I,stackedOnCurrent:T,stackedOnNext:A,status:L};};},function(t,e,i){function n(t){return isNaN(t[0])||isNaN(t[1]);}function r(t,e,i,r,o,a,g,m,v,y,x){for(var _=0,b=i,w=0;r>w;w++){var S=e[b];if(b>=o||0>b)break;if(n(S)){if(x){b+=a;continue;}break;}if(b===i)t[a>0?"moveTo":"lineTo"](S[0],S[1]),c(f,S);else if(v>0){var M=b+a,I=e[M];if(x)for(;I&&n(e[M]);){M+=a,I=e[M];}var T=.5,A=e[_],I=e[M];if(!I||n(I))c(p,S);else{n(I)&&!x&&(I=S),s.sub(d,I,A);var L,C;if("x"===y||"y"===y){var D="x"===y?0:1;L=Math.abs(S[D]-A[D]),C=Math.abs(S[D]-I[D]);}else L=s.dist(S,A),C=s.dist(S,I);T=C/(C+L),h(p,S,d,-v*(1-T));}l(f,f,m),u(f,f,g),l(p,p,m),u(p,p,g),t.bezierCurveTo(f[0],f[1],p[0],p[1],S[0],S[1]),h(f,S,d,v*T);}else t.lineTo(S[0],S[1]);_=b,b+=a;}return w;}function o(t,e){var i=[1/0,1/0],n=[-(1/0),-(1/0)];if(e)for(var r=0;r<t.length;r++){var o=t[r];o[0]<i[0]&&(i[0]=o[0]),o[1]<i[1]&&(i[1]=o[1]),o[0]>n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1]);}return{min:e?i:n,max:e?n:i};}var a=i(45),s=i(10),l=s.min,u=s.max,h=s.scaleAndAdd,c=s.copy,d=[],f=[],p=[];t.exports={Polyline:a.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},buildPath:function buildPath(t,e){var i=e.points,a=0,s=i.length,l=o(i,e.smoothConstraint);if(e.connectNulls){for(;s>0&&n(i[s-1]);s--){}for(;s>a&&n(i[a]);a++){}}for(;s>a;){a+=r(t,i,a,s,s,1,l.min,l.max,e.smooth,e.smoothMonotone,e.connectNulls)+1;}}}),Polygon:a.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},buildPath:function buildPath(t,e){var i=e.points,a=e.stackedOnPoints,s=0,l=i.length,u=e.smoothMonotone,h=o(i,e.smoothConstraint),c=o(a,e.smoothConstraint);if(e.connectNulls){for(;l>0&&n(i[l-1]);l--){}for(;l>s&&n(i[s]);s++){}}for(;l>s;){var d=r(t,i,s,l,l,1,h.min,h.max,e.smooth,u,e.connectNulls);r(t,a,s+d-1,d,l,-1,c.min,c.max,e.stackedOnSmooth,u,e.connectNulls),s+=d+1,t.closePath();}}})};},function(t,e){t.exports=function(t,e,i,n,r){n.eachRawSeriesByType(t,function(t){var r=t.getData(),o=t.get("symbol")||e,a=t.get("symbolSize");r.setVisual({legendSymbol:i||o,symbol:o,symbolSize:a}),n.isSeriesFiltered(t)||("function"==typeof a&&r.each(function(e){var i=t.getRawValue(e),n=t.getDataParams(e);r.setItemVisual(e,"symbolSize",a(i,n));}),r.each(function(t){var e=r.getItemModel(t),i=e.getShallow("symbol",!0),n=e.getShallow("symbolSize",!0);null!=i&&r.setItemVisual(t,"symbol",i),null!=n&&r.setItemVisual(t,"symbolSize",n);}));});};},function(t,e){t.exports=function(t,e){e.eachSeriesByType(t,function(t){var e=t.getData(),i=t.coordinateSystem;if(i){var n=i.dimensions;"singleAxis"===i.type?e.each(n[0],function(t,n){e.setItemLayout(n,isNaN(t)?[NaN,NaN]:i.dataToPoint(t));}):e.each(n,function(t,n,r){e.setItemLayout(r,isNaN(t)||isNaN(n)?[NaN,NaN]:i.dataToPoint([t,n]));},!0);}});};},function(t,e){var i={average:function average(t){for(var e=0,i=0,n=0;n<t.length;n++){isNaN(t[n])||(e+=t[n],i++);}return 0===i?NaN:e/i;},sum:function sum(t){for(var e=0,i=0;i<t.length;i++){e+=t[i]||0;}return e;},max:function max(t){for(var e=-(1/0),i=0;i<t.length;i++){t[i]>e&&(e=t[i]);}return e;},min:function min(t){for(var e=1/0,i=0;i<t.length;i++){t[i]<e&&(e=t[i]);}return e;},nearest:function nearest(t){return t[0];}},n=function n(t,e){return Math.round(t.length/2);};t.exports=function(t,e,r){e.eachSeriesByType(t,function(t){var e=t.getData(),r=t.get("sampling"),o=t.coordinateSystem;if("cartesian2d"===o.type&&r){var a=o.getBaseAxis(),s=o.getOtherAxis(a),l=a.getExtent(),u=l[1]-l[0],h=Math.round(e.count()/u);if(h>1){var c;"string"==typeof r?c=i[r]:"function"==typeof r&&(c=r),c&&(e=e.downSample(s.dim,1/h,c,n),t.setData(e));}}},this);};},function(t,e,i){"use strict";var n=i(43),r=i(4),o=i(1);i(113),i(131),o.extendComponentView({type:"grid",render:function render(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new n.Rect({shape:t.coordinateSystem.getRect(),style:r.defaults({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}));}}),o.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={});});},function(t,e,i){function n(t,e,i){return t.findGridModel()===e;}function r(t){var e,i=t.model,n=i.getFormattedLabels(),r=1,o=n.length;o>40&&(r=Math.ceil(o/40));for(var a=0;o>a;a+=r){if(!t.isLabelIgnored(a)){var s=i.getTextRect(n[a]);e?e.union(s):e=s;}}return e;}function o(t,e,i){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(t,e,i),this._model=t;}function a(t,e){var i=t.getExtent(),n=i[0]+i[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord="x"===t.dim?function(t){return t-e;}:function(t){return n-t+e;};}function s(t,e){return c.map(y,function(e){var i=t.getReferringComponents(e)[0];if(!i)throw new Error(e+' "'+c.retrieve(t.get(e+"Index"),t.get(e+"Id"),0)+'" not found');return i;});}function l(t){return"cartesian2d"===t.get("coordinateSystem");}var u=i(21),h=i(114),c=i(4),d=i(120),f=i(122),p=c.each,g=h.ifAxisCrossZero,m=h.niceScaleExtent;i(125);var v=o.prototype;v.type="grid",v.getRect=function(){return this._rect;},v.update=function(t,e){function i(t){var e=n[t];for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r&&("category"===r.type||!g(r)))return!0;}}return!1;}var n=this._axesMap;this._updateScale(t,this._model),p(n.x,function(t){m(t,t.model);}),p(n.y,function(t){m(t,t.model);}),p(n.x,function(t){i("y")&&(t.onZero=!1);}),p(n.y,function(t){i("x")&&(t.onZero=!1);}),this.resize(this._model,e);},v.resize=function(t,e){function i(){p(o,function(t){var e=t.isHorizontal(),i=e?[0,n.width]:[0,n.height],r=t.inverse?1:0;t.setExtent(i[r],i[1-r]),a(t,e?n.x:n.y);});}var n=u.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});this._rect=n;var o=this._axesList;i(),t.get("containLabel")&&(p(o,function(t){if(!t.model.get("axisLabel.inside")){var e=r(t);if(e){var i=t.isHorizontal()?"height":"width",o=t.model.get("axisLabel.margin");n[i]-=e[i]+o,"top"===t.position?n.y+=e.height+o:"left"===t.position&&(n.x+=e.width+o);}}}),i());},v.getAxis=function(t,e){var i=this._axesMap[t];if(null!=i){if(null==e)for(var n in i){if(i.hasOwnProperty(n))return i[n];}return i[e];}},v.getCartesian=function(t,e){if(null!=t&&null!=e){var i="x"+t+"y"+e;return this._coordsMap[i];}for(var n=0,r=this._coordsList;n<r.length;n++){if(r[n].getAxis("x").index===t||r[n].getAxis("y").index===e)return r[n];}},v.convertToPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.dataToPoint(i):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(i)):null;},v.convertFromPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.pointToData(i):n.axis?n.axis.coordToData(n.axis.toLocalCoord(i)):null;},v._findConvertTarget=function(t,e){var i,n,r=e.seriesModel,o=e.xAxisModel||r&&r.getReferringComponents("xAxis")[0],a=e.yAxisModel||r&&r.getReferringComponents("yAxis")[0],s=e.gridModel,l=this._coordsList;if(r)i=r.coordinateSystem,c.indexOf(l,i)<0&&(i=null);else if(o&&a)i=this.getCartesian(o.componentIndex,a.componentIndex);else if(o)n=this.getAxis("x",o.componentIndex);else if(a)n=this.getAxis("y",a.componentIndex);else if(s){var u=s.coordinateSystem;u===this&&(i=this._coordsList[0]);}return{cartesian:i,axis:n};},v.containPoint=function(t){var e=this._coordsList[0];return e?e.containPoint(t):void 0;},v._initCartesian=function(t,e,i){function r(i){return function(r,l){if(n(r,t,e)){var u=r.get("position");"x"===i?"top"!==u&&"bottom"!==u&&(u="bottom",o[u]&&(u="top"===u?"bottom":"top")):"left"!==u&&"right"!==u&&(u="left",o[u]&&(u="left"===u?"right":"left")),o[u]=!0;var c=new f(i,h.createScaleByModel(r),[0,0],r.get("type"),u),d="category"===c.type;c.onBand=d&&r.get("boundaryGap"),c.inverse=r.get("inverse"),c.onZero=r.get("axisLine.onZero"),r.axis=c,c.model=r,c.grid=this,c.index=l,this._axesList.push(c),a[i][l]=c,s[i]++;}};}var o={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},s={x:0,y:0};return e.eachComponent("xAxis",r("x"),this),e.eachComponent("yAxis",r("y"),this),s.x&&s.y?(this._axesMap=a,void p(a.x,function(t,e){p(a.y,function(i,n){var r="x"+e+"y"+n,o=new d(r);o.grid=this,this._coordsMap[r]=o,this._coordsList.push(o),o.addAxis(t),o.addAxis(i);},this);},this)):(this._axesMap={},void(this._axesList=[]));},v._updateScale=function(t,e){function i(t,e,i){p(i.coordDimToDataDim(e.dim),function(i){e.scale.unionExtent(t.getDataExtent(i,"ordinal"!==e.scale.type));});}c.each(this._axesList,function(t){t.scale.setExtent(1/0,-(1/0));}),t.eachSeries(function(r){if(l(r)){var o=s(r,t),a=o[0],u=o[1];if(!n(a,e,t)||!n(u,e,t))return;var h=this.getCartesian(a.componentIndex,u.componentIndex),c=r.getData(),d=h.getAxis("x"),f=h.getAxis("y");"list"===c.type&&(i(c,d,r),i(c,f,r));}},this);};var y=["xAxis","yAxis"];o.create=function(t,e){var i=[];return t.eachComponent("grid",function(n,r){var a=new o(n,t,e);a.name="grid_"+r,a.resize(n,e),n.coordinateSystem=a,i.push(a);}),t.eachSeries(function(e){if(l(e)){var i=s(e,t),n=i[0],r=i[1],o=n.findGridModel();if(!o)throw new Error('Grid "'+c.retrieve(n.get("gridIndex"),n.get("gridId"),0)+'" not found');if(n.findGridModel()!==r.findGridModel())throw new Error("xAxis and yAxis must use the same grid");var a=o.coordinateSystem;e.coordinateSystem=a.getCartesian(n.componentIndex,r.componentIndex);}}),i;},o.dimensions=d.prototype.dimensions,i(26).register("cartesian2d",o),t.exports=o;},function(t,e,i){var n=i(115),r=i(117);i(118),i(119);var o=i(116),a=i(7),s=i(4),l=i(8),u={};u.getScaleExtent=function(t,e){var i=t.scale,n=i.getExtent(),r=n[1]-n[0];if("ordinal"===i.type)return isFinite(r)?n:[0,0];var o=e.getMin?e.getMin():e.get("min"),l=e.getMax?e.getMax():e.get("max"),u=e.getNeedCrossZero?e.getNeedCrossZero():!e.get("scale"),h=e.get("boundaryGap");s.isArray(h)||(h=[h||0,h||0]),h[0]=a.parsePercent(h[0],1),h[1]=a.parsePercent(h[1],1);var c=!0,d=!0;return null==o&&(o=n[0]-h[0]*r,c=!1),null==l&&(l=n[1]+h[1]*r,d=!1),"dataMin"===o&&(o=n[0]),"dataMax"===l&&(l=n[1]),u&&(o>0&&l>0&&!c&&(o=0),0>o&&0>l&&!d&&(l=0)),[o,l];},u.niceScaleExtent=function(t,e){var i=t.scale,n=u.getScaleExtent(t,e),r=null!=(e.getMin?e.getMin():e.get("min")),o=null!=(e.getMax?e.getMax():e.get("max")),a=e.get("splitNumber");"log"===i.type&&(i.base=e.get("logBase")),i.setExtent(n[0],n[1]),i.niceExtent(a,r,o);var s=e.get("minInterval");if(isFinite(s)&&!r&&!o&&"interval"===i.type){var l=i.getInterval(),h=Math.max(Math.abs(l),s)/l;n=i.getExtent();var c=(n[1]+n[0])/2;i.setExtent(h*(n[0]-c)+c,h*(n[1]-c)+c),i.niceExtent(a);}var l=e.get("interval");null!=l&&i.setInterval&&i.setInterval(l);},u.createScaleByModel=function(t,e){if(e=e||t.get("type"))switch(e){case"category":return new n(t.getCategories(),[1/0,-(1/0)]);case"value":return new r();default:return(o.getClass(e)||r).create(t);}},u.ifAxisCrossZero=function(t){var e=t.scale.getExtent(),i=e[0],n=e[1];return!(i>0&&n>0||0>i&&0>n);},u.getAxisLabelInterval=function(t,e,i,n){var r,o=0,a=0,s=1;e.length>40&&(s=Math.floor(e.length/40));for(var u=0;u<t.length;u+=s){var h=t[u],c=l.getBoundingRect(e[u],i,"center","top");c[n?"x":"y"]+=h,c[n?"width":"height"]*=1.3,r?r.intersect(c)?(a++,o=Math.max(o,a)):(r.union(c),a=0):r=c.clone();}return 0===o&&s>1?s:(o+1)*s-1;},u.getFormattedLabels=function(t,e){var i=t.scale,n=i.getTicksLabels(),r=i.getTicks();return"string"==typeof e?(e=function(t){return function(e){return t.replace("{value}",e);};}(e),s.map(n,e)):"function"==typeof e?s.map(r,function(n,r){return e("category"===t.type?i.getLabel(n):n,r);},this):n;},t.exports=u;},function(t,e,i){var n=i(4),r=i(116),o=r.prototype,a=r.extend({type:"ordinal",init:function init(t,e){this._data=t,this._extent=e||[0,t.length-1];},parse:function parse(t){return"string"==typeof t?n.indexOf(this._data,t):Math.round(t);},contain:function contain(t){return t=this.parse(t),o.contain.call(this,t)&&null!=this._data[t];},normalize:function normalize(t){return o.normalize.call(this,this.parse(t));},scale:function scale(t){return Math.round(o.scale.call(this,t));},getTicks:function getTicks(){for(var t=[],e=this._extent,i=e[0];i<=e[1];){t.push(i),i++;}return t;},getLabel:function getLabel(t){return this._data[t];},count:function count(){return this._extent[1]-this._extent[0]+1;},niceTicks:n.noop,niceExtent:n.noop});a.create=function(){return new a();},t.exports=a;},function(t,e,i){function n(){this._extent=[1/0,-(1/0)],this._interval=0,this.init&&this.init.apply(this,arguments);}var r=i(13),o=n.prototype;o.parse=function(t){return t;},o.contain=function(t){var e=this._extent;return t>=e[0]&&t<=e[1];},o.normalize=function(t){var e=this._extent;return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0]);},o.scale=function(t){var e=this._extent;return t*(e[1]-e[0])+e[0];},o.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]);},o.getExtent=function(){return this._extent.slice();},o.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=t),isNaN(e)||(i[1]=e);},o.getTicksLabels=function(){for(var t=[],e=this.getTicks(),i=0;i<e.length;i++){t.push(this.getLabel(e[i]));}return t;},r.enableClassExtend(n),r.enableClassManagement(n,{registerWhenExtend:!0}),t.exports=n;},function(t,e,i){var n=i(7),r=i(6),o=i(116),a=Math.floor,s=Math.ceil,l=n.getPrecisionSafe,u=n.round,h=o.extend({type:"interval",_interval:0,setExtent:function setExtent(t,e){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(e)||(i[1]=parseFloat(e));},unionExtent:function unionExtent(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),h.prototype.setExtent.call(this,e[0],e[1]);},getInterval:function getInterval(){return this._interval||this.niceTicks(),this._interval;},setInterval:function setInterval(t){this._interval=t,this._niceExtent=this._extent.slice();},getTicks:function getTicks(){this._interval||this.niceTicks();var t=this._interval,e=this._extent,i=[],n=1e4;if(t){var r=this._niceExtent,o=l(t)+2;e[0]<r[0]&&i.push(e[0]);for(var a=r[0];a<=r[1];){if(i.push(a),a=u(a+t,o),i.length>n)return[];}e[1]>(i.length?i[i.length-1]:r[1])&&i.push(e[1]);}return i;},getTicksLabels:function getTicksLabels(){for(var t=[],e=this.getTicks(),i=0;i<e.length;i++){t.push(this.getLabel(e[i]));}return t;},getLabel:function getLabel(t){return r.addCommas(t);},niceTicks:function niceTicks(t){t=t||5;var e=this._extent,i=e[1]-e[0];if(isFinite(i)){0>i&&(i=-i,e.reverse());var r=u(n.nice(i/t,!0),Math.max(l(e[0]),l(e[1]))+2),o=l(r)+2,h=[u(s(e[0]/r)*r,o),u(a(e[1]/r)*r,o)];this._interval=r,this._niceExtent=h;}},niceExtent:function niceExtent(t,e,i){var n=this._extent;if(n[0]===n[1])if(0!==n[0]){var r=n[0];i?n[0]-=r/2:(n[1]+=r/2,n[0]-=r/2);}else n[1]=1;var o=n[1]-n[0];isFinite(o)||(n[0]=0,n[1]=1),this.niceTicks(t);var l=this._interval;e||(n[0]=u(a(n[0]/l)*l)),i||(n[1]=u(s(n[1]/l)*l));}});h.create=function(){return new h();},t.exports=h;},function(t,e,i){var n=i(4),r=i(7),o=i(6),a=i(117),s=a.prototype,l=Math.ceil,u=Math.floor,h=1e3,c=60*h,d=60*c,f=24*d,p=function p(t,e,i,n){for(;n>i;){var r=i+n>>>1;t[r][2]<e?i=r+1:n=r;}return i;},g=a.extend({type:"time",getLabel:function getLabel(t){var e=this._stepLvl,i=new Date(t);return o.formatTime(e[0],i);},niceExtent:function niceExtent(t,e,i){var n=this._extent;if(n[0]===n[1]&&(n[0]-=f,n[1]+=f),n[1]===-(1/0)&&n[0]===1/0){var o=new Date();n[1]=new Date(o.getFullYear(),o.getMonth(),o.getDate()),n[0]=n[1]-f;}this.niceTicks(t);var a=this._interval;e||(n[0]=r.round(u(n[0]/a)*a)),i||(n[1]=r.round(l(n[1]/a)*a));},niceTicks:function niceTicks(t){t=t||10;var e=this._extent,i=e[1]-e[0],n=i/t,o=m.length,a=p(m,n,0,o),s=m[Math.min(a,o-1)],h=s[2];if("year"===s[0]){var c=i/h,d=r.nice(c/t,!0);h*=d;}var f=[l(e[0]/h)*h,u(e[1]/h)*h];this._stepLvl=s,this._interval=h,this._niceExtent=f;},parse:function parse(t){return+r.parseDate(t);}});n.each(["contain","normalize"],function(t){g.prototype[t]=function(e){return s[t].call(this,this.parse(e));};});var m=[["hh:mm:ss",1,h],["hh:mm:ss",5,5*h],["hh:mm:ss",10,10*h],["hh:mm:ss",15,15*h],["hh:mm:ss",30,30*h],["hh:mm\nMM-dd",1,c],["hh:mm\nMM-dd",5,5*c],["hh:mm\nMM-dd",10,10*c],["hh:mm\nMM-dd",15,15*c],["hh:mm\nMM-dd",30,30*c],["hh:mm\nMM-dd",1,d],["hh:mm\nMM-dd",2,2*d],["hh:mm\nMM-dd",6,6*d],["hh:mm\nMM-dd",12,12*d],["MM-dd\nyyyy",1,f],["week",7,7*f],["month",1,31*f],["quarter",3,380*f/4],["half-year",6,380*f/2],["year",1,380*f]];g.create=function(){return new g();},t.exports=g;},function(t,e,i){function n(t,e){return c(t,h(e));}var r=i(4),o=i(116),a=i(7),s=i(117),l=o.prototype,u=s.prototype,h=a.getPrecisionSafe,c=a.round,d=Math.floor,f=Math.ceil,p=Math.pow,g=Math.log,m=o.extend({type:"log",base:10,$constructor:function $constructor(){o.apply(this,arguments),this._originalScale=new s();},getTicks:function getTicks(){var t=this._originalScale,e=this._extent,i=t.getExtent();return r.map(u.getTicks.call(this),function(r){var o=a.round(p(this.base,r));return o=r===e[0]&&t.__fixMin?n(o,i[0]):o,o=r===e[1]&&t.__fixMax?n(o,i[1]):o;},this);},getLabel:u.getLabel,scale:function scale(t){return t=l.scale.call(this,t),p(this.base,t);},setExtent:function setExtent(t,e){var i=this.base;t=g(t)/g(i),e=g(e)/g(i),u.setExtent.call(this,t,e);},getExtent:function getExtent(){var t=this.base,e=l.getExtent.call(this);e[0]=p(t,e[0]),e[1]=p(t,e[1]);var i=this._originalScale,r=i.getExtent();return i.__fixMin&&(e[0]=n(e[0],r[0])),i.__fixMax&&(e[1]=n(e[1],r[1])),e;},unionExtent:function unionExtent(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=g(t[0])/g(e),t[1]=g(t[1])/g(e),l.unionExtent.call(this,t);},niceTicks:function niceTicks(t){t=t||10;var e=this._extent,i=e[1]-e[0];if(!(i===1/0||0>=i)){var n=a.quantity(i),r=t/i*n;for(.5>=r&&(n*=10);!isNaN(n)&&Math.abs(n)<1&&Math.abs(n)>0;){n*=10;}var o=[a.round(f(e[0]/n)*n),a.round(d(e[1]/n)*n)];this._interval=n,this._niceExtent=o;}},niceExtent:function niceExtent(t,e,i){u.niceExtent.call(this,t,e,i);var n=this._originalScale;n.__fixMin=e,n.__fixMax=i;}});r.each(["contain","normalize"],function(t){m.prototype[t]=function(e){return e=g(e)/g(this.base),l[t].call(this,e);};}),m.create=function(){return new m();},t.exports=m;},function(t,e,i){"use strict";function n(t){o.call(this,t);}var r=i(4),o=i(121);n.prototype={constructor:n,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x");},containPoint:function containPoint(t){var e=this.getAxis("x"),i=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]));},containData:function containData(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1]);},dataToPoints:function dataToPoints(t,e){return t.mapArray(["x","y"],function(t,e){return this.dataToPoint([t,e]);},e,this);},dataToPoint:function dataToPoint(t,e){var i=this.getAxis("x"),n=this.getAxis("y");return[i.toGlobalCoord(i.dataToCoord(t[0],e)),n.toGlobalCoord(n.dataToCoord(t[1],e))];},pointToData:function pointToData(t,e){var i=this.getAxis("x"),n=this.getAxis("y");return[i.coordToData(i.toLocalCoord(t[0]),e),n.coordToData(n.toLocalCoord(t[1]),e)];},getOtherAxis:function getOtherAxis(t){return this.getAxis("x"===t.dim?"y":"x");}},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";function n(t){return this._axes[t];}var r=i(4),o=function o(t){this._axes={},this._dimList=[],this.name=t||"";};o.prototype={constructor:o,type:"cartesian",getAxis:function getAxis(t){return this._axes[t];},getAxes:function getAxes(){return r.map(this._dimList,n,this);},getAxesByScale:function getAxesByScale(t){return t=t.toLowerCase(),r.filter(this.getAxes(),function(e){return e.scale.type===t;});},addAxis:function addAxis(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e);},dataToCoord:function dataToCoord(t){return this._dataCoordConvert(t,"dataToCoord");},coordToData:function coordToData(t){return this._dataCoordConvert(t,"coordToData");},_dataCoordConvert:function _dataCoordConvert(t,e){for(var i=this._dimList,n=t instanceof Array?[]:{},r=0;r<i.length;r++){var o=i[r],a=this._axes[o];n[o]=a[e](t[o]);}return n;}},t.exports=o;},function(t,e,i){var n=i(4),r=i(123),o=i(124),a=function a(t,e,i,n,o){r.call(this,t,e,i),this.type=n||"value",this.position=o||"bottom";};a.prototype={constructor:a,index:0,onZero:!1,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},getGlobalExtent:function getGlobalExtent(){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),t;},getLabelInterval:function getLabelInterval(){var t=this._labelInterval;return t||(t=this._labelInterval=o(this)),t;},isLabelIgnored:function isLabelIgnored(t){if("category"===this.type){var e=this.getLabelInterval();return"function"==typeof e&&!e(t,this.scale.getLabel(t))||t%(e+1);}},toLocalCoord:null,toGlobalCoord:null},n.inherits(a,r),t.exports=a;},function(t,e,i){function n(t,e){var i=t[1]-t[0],n=e,r=i/n/2;t[0]+=r,t[1]-=r;}var r=i(7),o=r.linearMap,a=i(4),s=[0,1],l=function l(t,e,i){this.dim=t,this.scale=e,this._extent=i||[0,0],this.inverse=!1,this.onBand=!1;};l.prototype={constructor:l,contain:function contain(t){var e=this._extent,i=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]);return t>=i&&n>=t;},containData:function containData(t){return this.contain(this.dataToCoord(t));},getExtent:function getExtent(){var t=this._extent.slice();return t;},getPixelPrecision:function getPixelPrecision(t){return r.getPixelPrecision(t||this.scale.getExtent(),this._extent);},setExtent:function setExtent(t,e){var i=this._extent;i[0]=t,i[1]=e;},dataToCoord:function dataToCoord(t,e){var i=this._extent,r=this.scale;return t=r.normalize(t),this.onBand&&"ordinal"===r.type&&(i=i.slice(),n(i,r.count())),o(t,s,i,e);},coordToData:function coordToData(t,e){var i=this._extent,r=this.scale;this.onBand&&"ordinal"===r.type&&(i=i.slice(),n(i,r.count()));var a=o(t,i,s,e);return this.scale.scale(a);},getTicksCoords:function getTicksCoords(t){if(this.onBand&&!t){for(var e=this.getBands(),i=[],n=0;n<e.length;n++){i.push(e[n][0]);}return e[n-1]&&i.push(e[n-1][1]),i;}return a.map(this.scale.getTicks(),this.dataToCoord,this);},getLabelsCoords:function getLabelsCoords(){return a.map(this.scale.getTicks(),this.dataToCoord,this);},getBands:function getBands(){for(var t=this.getExtent(),e=[],i=this.scale.count(),n=t[0],r=t[1],o=r-n,a=0;i>a;a++){e.push([o*a/i+n,o*(a+1)/i+n]);}return e;},getBandWidth:function getBandWidth(){var t=this._extent,e=this.scale.getExtent(),i=e[1]-e[0]+(this.onBand?1:0);0===i&&(i=1);var n=Math.abs(t[1]-t[0]);return Math.abs(n)/i;}},t.exports=l;},function(t,e,i){"use strict";var n=i(4),r=i(114);t.exports=function(t){var e=t.model,i=e.getModel("axisLabel"),o=i.get("interval");return"category"!==t.type||"auto"!==o?"auto"===o?0:o:r.getAxisLabelInterval(n.map(t.scale.getTicks(),t.dataToCoord,t),e.getFormattedLabels(),i.getModel("textStyle").getFont(),t.isHorizontal());};},function(t,e,i){"use strict";i(126);var n=i(19);t.exports=n.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});},function(t,e,i){"use strict";function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(4),a=i(127),s=r.extend({type:"cartesian2dAxis",axis:null,init:function init(){s.superApply(this,"init",arguments),this.resetRange();},mergeOption:function mergeOption(){s.superApply(this,"mergeOption",arguments),this.resetRange();},restoreData:function restoreData(){s.superApply(this,"restoreData",arguments),this.resetRange();},findGridModel:function findGridModel(){return this.ecModel.queryComponents({mainType:"grid",index:this.get("gridIndex"),id:this.get("gridId")})[0];}});o.merge(s.prototype,i(129)),o.merge(s.prototype,i(130));var l={offset:0};a("x",s,n,l),a("y",s,n,l),t.exports=s;},function(t,e,i){var n=i(128),r=i(4),o=i(19),a=i(21),s=["value","category","time","log"];t.exports=function(t,e,i,l){r.each(s,function(o){e.extend({type:t+"Axis."+o,mergeDefaultAndTheme:function mergeDefaultAndTheme(e,n){var s=this.layoutMode,l=s?a.getLayoutParams(e):{},u=n.getTheme();r.merge(e,u.get(o+"Axis")),r.merge(e,this.getDefaultOption()),e.type=i(t,e),s&&a.mergeLayoutParam(e,l,s);},defaultOption:r.mergeAll([{},n[o+"Axis"],l],!0)});}),o.registerSubTypeDefaulter(t+"Axis",r.curry(i,t));};},function(t,e,i){var n=i(4),r={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisLine:{show:!0,onZero:!0,lineStyle:{color:"#333",width:1,type:"solid"}},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},o=n.merge({boundaryGap:!0,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},r),a=n.merge({boundaryGap:[0,0],splitNumber:5},r),s=n.defaults({scale:!0,min:"dataMin",max:"dataMax"},a),l=n.defaults({logBase:10},a);l.scale=!0,t.exports={categoryAxis:o,valueAxis:a,timeAxis:s,logAxis:l};},function(t,e,i){function n(t){return a.isObject(t)&&null!=t.value?t.value:t;}function r(){return"category"===this.get("type")&&a.map(this.get("data"),n);}function o(){return s.getFormattedLabels(this.axis,this.get("axisLabel.formatter"));}var a=i(4),s=i(114);t.exports={getFormattedLabels:o,getCategories:r};},function(t,e){t.exports={getMin:function getMin(){var t=this.option,e=null!=t.rangeStart?t.rangeStart:t.min;return e instanceof Date&&(e=+e),e;},getMax:function getMax(){var t=this.option,e=null!=t.rangeEnd?t.rangeEnd:t.max;return e instanceof Date&&(e=+e),e;},getNeedCrossZero:function getNeedCrossZero(){var t=this.option;return null!=t.rangeStart||null!=t.rangeEnd?!1:!t.scale;},setRange:function setRange(t,e){this.option.rangeStart=t,this.option.rangeEnd=e;},resetRange:function resetRange(){this.option.rangeStart=this.option.rangeEnd=null;}};},function(t,e,i){"use strict";i(126),i(132);},function(t,e,i){function n(t,e){function i(t,e){var i=n.getAxis(t);return i.toGlobalCoord(i.dataToCoord(0));}var n=t.coordinateSystem,r=e.axis,o={},a=r.position,s=r.onZero?"onZero":a,l=r.dim,u=n.getRect(),h=[u.x,u.x+u.width,u.y,u.y+u.height],c=e.get("offset")||0,d={x:{top:h[2]-c,bottom:h[3]+c},y:{left:h[0]-c,right:h[1]+c}};d.x.onZero=Math.max(Math.min(i("y"),d.x.bottom),d.x.top),d.y.onZero=Math.max(Math.min(i("x"),d.y.right),d.y.left),o.position=["y"===l?d.y[s]:h[0],"x"===l?d.x[s]:h[3]],o.rotation=Math.PI/2*("x"===l?0:1);var f={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=f[a],r.onZero&&(o.labelOffset=d[l][a]-d[l].onZero),e.getModel("axisTick").get("inside")&&(o.tickDirection=-o.tickDirection),e.getModel("axisLabel").get("inside")&&(o.labelDirection=-o.labelDirection);var p=e.getModel("axisLabel").get("rotate");return o.labelRotation="top"===s?-p:p,o.labelInterval=r.getLabelInterval(),o.z2=1,o;}var r=i(4),o=i(43),a=i(133),s=a.ifIgnoreOnTick,l=a.getInterval,u=["axisLine","axisLabel","axisTick","axisName"],h=["splitArea","splitLine"],c=i(1).extendComponentView({type:"axis",render:function render(t,e){this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new o.Group(),this.group.add(this._axisGroup),t.get("show")){var s=t.findGridModel(),l=n(s,t),c=new a(t,l);r.each(u,c.add,c),this._axisGroup.add(c.getGroup()),r.each(h,function(e){t.get(e+".show")&&this["_"+e](t,s,l.labelInterval);},this),o.groupTransition(i,this._axisGroup,t);}},_splitLine:function _splitLine(t,e,i){var n=t.axis,a=t.getModel("splitLine"),u=a.getModel("lineStyle"),h=u.get("color"),c=l(a,i);h=r.isArray(h)?h:[h];for(var d=e.coordinateSystem.getRect(),f=n.isHorizontal(),p=0,g=n.getTicksCoords(),m=n.scale.getTicks(),v=[],y=[],x=u.getLineStyle(),_=0;_<g.length;_++){if(!s(n,_,c)){var b=n.toGlobalCoord(g[_]);f?(v[0]=b,v[1]=d.y,y[0]=b,y[1]=d.y+d.height):(v[0]=d.x,v[1]=b,y[0]=d.x+d.width,y[1]=b);var w=p++%h.length;this._axisGroup.add(new o.Line(o.subPixelOptimizeLine({anid:"line_"+m[_],shape:{x1:v[0],y1:v[1],x2:y[0],y2:y[1]},style:r.defaults({stroke:h[w]},x),silent:!0})));}}},_splitArea:function _splitArea(t,e,i){var n=t.axis,a=t.getModel("splitArea"),u=a.getModel("areaStyle"),h=u.get("color"),c=e.coordinateSystem.getRect(),d=n.getTicksCoords(),f=n.scale.getTicks(),p=n.toGlobalCoord(d[0]),g=n.toGlobalCoord(d[0]),m=0,v=l(a,i),y=u.getAreaStyle();h=r.isArray(h)?h:[h];for(var x=1;x<d.length;x++){if(!s(n,x,v)){var _,b,w,S,M=n.toGlobalCoord(d[x]);n.isHorizontal()?(_=p,b=c.y,w=M-_,S=c.height):(_=c.x,b=g,w=c.width,S=M-b);var I=m++%h.length;this._axisGroup.add(new o.Rect({anid:"area_"+f[x],shape:{x:_,y:b,width:w,height:S},style:r.defaults({fill:h[I]},y),silent:!0})),p=_+w,g=b+S;}}}});c.extend({type:"xAxis"}),c.extend({type:"yAxis"});},function(t,e,i){function n(t){var e={componentType:t.mainType};return e[t.mainType+"Index"]=t.componentIndex,e;}function r(t,e,i){var n,r,o=d(e-t.rotation);return f(o)?(r=i>0?"top":"bottom",n="center"):f(o-v)?(r=i>0?"bottom":"top",n="center"):(r="middle",n=o>0&&v>o?i>0?"right":"left":i>0?"left":"right"),{rotation:o,textAlign:n,verticalAlign:r};}function o(t,e,i,n){var r,o,a=d(i-t.rotation),s=n[0]>n[1],l="start"===e&&!s||"start"!==e&&s;return f(a-v/2)?(o=l?"bottom":"top",r="center"):f(a-1.5*v)?(o=l?"top":"bottom",r="center"):(o="middle",r=1.5*v>a&&a>v/2?l?"left":"right":l?"right":"left"),{rotation:a,textAlign:r,verticalAlign:o};}function a(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show);}var s=i(4),l=i(6),u=i(43),h=i(12),c=i(7),d=c.remRadian,f=c.isRadianAroundZero,p=i(10),g=p.applyTransform,m=s.retrieve,v=Math.PI,y=function y(t,e){this.opt=e,this.axisModel=t,s.defaults(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new u.Group();var i=new u.Group({position:e.position.slice(),rotation:e.rotation});i.updateTransform(),this._transform=i.transform,this._dumbGroup=i;};y.prototype={constructor:y,hasBuilder:function hasBuilder(t){return!!x[t];},add:function add(t){x[t].call(this);},getGroup:function getGroup(){return this.group;}};var x={axisLine:function axisLine(){var t=this.opt,e=this.axisModel;if(e.get("axisLine.show")){var i=this.axisModel.axis.getExtent(),n=this._transform,r=[i[0],0],o=[i[1],0];n&&(g(r,r,n),g(o,o,n)),this.group.add(new u.Line(u.subPixelOptimizeLine({anid:"line",shape:{x1:r[0],y1:r[1],x2:o[0],y2:o[1]},style:s.extend({lineCap:"round"},e.getModel("axisLine.lineStyle").getLineStyle()),strokeContainThreshold:t.strokeContainThreshold||5,silent:!0,z2:1})));}},axisTick:function axisTick(){var t=this.axisModel;if(t.get("axisTick.show"))for(var e=t.axis,i=t.getModel("axisTick"),n=this.opt,r=i.getModel("lineStyle"),o=i.get("length"),a=b(i,n.labelInterval),l=e.getTicksCoords(i.get("alignWithLabel")),h=e.scale.getTicks(),c=[],d=[],f=this._transform,p=0;p<l.length;p++){if(!_(e,p,a)){var m=l[p];c[0]=m,c[1]=0,d[0]=m,d[1]=n.tickDirection*o,f&&(g(c,c,f),g(d,d,f)),this.group.add(new u.Line(u.subPixelOptimizeLine({anid:"tick_"+h[p],shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:s.defaults(r.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),z2:2,silent:!0})));}}},axisLabel:function axisLabel(){function t(t,e){var i=t&&t.getBoundingRect().clone(),n=e&&e.getBoundingRect().clone();return i&&n?(i.applyTransform(t.getLocalTransform()),n.applyTransform(e.getLocalTransform()),i.intersect(n)):void 0;}var e=this.opt,i=this.axisModel,o=m(e.axisLabelShow,i.get("axisLabel.show"));if(o){var s=i.axis,l=i.getModel("axisLabel"),c=l.getModel("textStyle"),d=l.get("margin"),f=s.scale.getTicks(),p=i.getFormattedLabels(),g=m(e.labelRotation,l.get("rotate"))||0;g=g*v/180;for(var y=r(e,g,e.labelDirection),x=i.get("data"),b=[],w=a(i),S=i.get("triggerEvent"),M=0;M<f.length;M++){if(!_(s,M,e.labelInterval)){var I=c;x&&x[M]&&x[M].textStyle&&(I=new h(x[M].textStyle,c,i.ecModel));var T=I.getTextColor()||i.get("axisLine.lineStyle.color"),A=s.dataToCoord(f[M]),L=[A,e.labelOffset+e.labelDirection*d],C=s.scale.getLabel(f[M]),D=new u.Text({anid:"label_"+f[M],style:{text:p[M],textAlign:I.get("align",!0)||y.textAlign,textVerticalAlign:I.get("baseline",!0)||y.verticalAlign,textFont:I.getFont(),fill:"function"==typeof T?T(C):T},position:L,rotation:y.rotation,silent:w,z2:10});S&&(D.eventData=n(i),D.eventData.targetType="axisLabel",D.eventData.value=C),this._dumbGroup.add(D),D.updateTransform(),b.push(D),this.group.add(D),D.decomposeTransform();}}if("category"!==s.type){if(i.getMin?i.getMin():i.get("min")){var P=b[0],k=b[1];t(P,k)&&(P.ignore=!0);}if(i.getMax?i.getMax():i.get("max")){var z=b[b.length-1],O=b[b.length-2];t(O,z)&&(z.ignore=!0);}}}},axisName:function axisName(){var t=this.opt,e=this.axisModel,i=m(t.axisName,e.get("name"));if(i){var h,c=e.get("nameLocation"),d=t.nameDirection,f=e.getModel("nameTextStyle"),p=e.get("nameGap")||0,g=this.axisModel.axis.getExtent(),y=g[0]>g[1]?-1:1,x=["start"===c?g[0]-y*p:"end"===c?g[1]+y*p:(g[0]+g[1])/2,"middle"===c?t.labelOffset+d*p:0],_=e.get("nameRotate");null!=_&&(_=_*v/180);var b;"middle"===c?h=r(t,null!=_?_:t.rotation,d):(h=o(t,c,_||0,g),b=t.axisNameAvailableWidth,null!=b&&(b=Math.abs(b/Math.sin(h.rotation)),!isFinite(b)&&(b=null)));var w=f.getFont(),S=e.get("nameTruncate",!0)||{},M=S.ellipsis,I=m(S.maxWidth,b),T=null!=M&&null!=I?l.truncateText(i,I,w,M,{minChar:2,placeholder:S.placeholder}):i,A=e.get("tooltip",!0),L=e.mainType,C={componentType:L,name:i,$vars:["name"]};C[L+"Index"]=e.componentIndex;var D=new u.Text({anid:"name",__fullText:i,__truncatedText:T,style:{text:T,textFont:w,fill:f.getTextColor()||e.get("axisLine.lineStyle.color"),textAlign:h.textAlign,textVerticalAlign:h.verticalAlign},position:x,rotation:h.rotation,silent:a(e),z2:1,tooltip:A&&A.show?s.extend({content:i,formatter:function formatter(){return i;},formatterParams:C},A):null});e.get("triggerEvent")&&(D.eventData=n(e),D.eventData.targetType="axisName",D.eventData.name=i),this._dumbGroup.add(D),D.updateTransform(),this.group.add(D),D.decomposeTransform();}}},_=y.ifIgnoreOnTick=function(t,e,i){var n,r=t.scale;return"ordinal"===r.type&&("function"==typeof i?(n=r.getTicks()[e],!i(n,r.getLabel(n))):e%(i+1));},b=y.getInterval=function(t,e){var i=t.get("interval");return(null==i||"auto"==i)&&(i=e),i;};t.exports=y;},function(t,e,i){var n=i(4);i(113),i(135),i(136);var r=i(138),o=i(1);o.registerLayout(n.curry(r,"bar")),o.registerVisual(function(t){t.eachSeriesByType("bar",function(t){var e=t.getData();e.setVisual("legendSymbol","roundRect");});}),i(112);},function(t,e,i){"use strict";var n=i(28),r=i(101);t.exports=n.extend({type:"series.bar",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=t.coordinateSystem;if("cartesian2d"!==i)throw new Error("Bar only support cartesian2d coordinateSystem");return r(t.data,this,e);},getMarkerPosition:function getMarkerPosition(t){var e=this.coordinateSystem;if(e){var i=e.dataToPoint(t,!0),n=this.getData(),r=n.getLayout("offset"),o=n.getLayout("size"),a=e.getBaseAxis().isHorizontal()?0:1;return i[a]+=r+o/2,i;}return[NaN,NaN];},brushSelector:"rect",defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,itemStyle:{normal:{},emphasis:{}}}});},function(t,e,i){"use strict";function n(t,e){var i=t.width>0?1:-1,n=t.height>0?1:-1;e=Math.min(e,Math.abs(t.width),Math.abs(t.height)),t.x+=i*e/2,t.y+=n*e/2,t.width-=i*e,t.height-=n*e;}var r=i(4),o=i(43);r.extend(i(12).prototype,i(137)),t.exports=i(1).extendChartView({type:"bar",render:function render(t,e,i){var n=t.get("coordinateSystem");return"cartesian2d"===n&&this._renderOnCartesian(t,e,i),this.group;},dispose:r.noop,_renderOnCartesian:function _renderOnCartesian(t,e,i){function a(e,i){var a=l.getItemLayout(e),s=l.getItemModel(e).get(p)||0;n(a,s);var u=new o.Rect({shape:r.extend({},a)});if(f){var h=u.shape,c=d?"height":"width",g={};h[c]=0,g[c]=a[c],o[i?"updateProps":"initProps"](u,{shape:g},t,e);}return u;}var s=this.group,l=t.getData(),u=this._data,h=t.coordinateSystem,c=h.getBaseAxis(),d=c.isHorizontal(),f=t.get("animation"),p=["itemStyle","normal","barBorderWidth"];l.diff(u).add(function(t){if(l.hasValue(t)){var e=a(t);l.setItemGraphicEl(t,e),s.add(e);}}).update(function(e,i){var r=u.getItemGraphicEl(i);if(!l.hasValue(e))return void s.remove(r);r||(r=a(e,!0));var h=l.getItemLayout(e),c=l.getItemModel(e).get(p)||0;n(h,c),o.updateProps(r,{shape:h},t,e),l.setItemGraphicEl(e,r),s.add(r);}).remove(function(e){var i=u.getItemGraphicEl(e);i&&(i.style.text="",o.updateProps(i,{shape:{width:0}},t,e,function(){s.remove(i);}));}).execute(),this._updateStyle(t,l,d),this._data=l;},_updateStyle:function _updateStyle(t,e,i){function n(t,e,i,n,r){o.setText(t,e,i),t.text=n,"outside"===t.textPosition&&(t.textPosition=r);}e.eachItemGraphicEl(function(a,s){var l=e.getItemModel(s),u=e.getItemVisual(s,"color"),h=e.getItemVisual(s,"opacity"),c=e.getItemLayout(s),d=l.getModel("itemStyle.normal"),f=l.getModel("itemStyle.emphasis").getBarItemStyle();a.setShape("r",d.get("barBorderRadius")||0),a.useStyle(r.defaults({fill:u,opacity:h},d.getBarItemStyle()));var p=i?c.height>0?"bottom":"top":c.width>0?"left":"right",g=l.getModel("label.normal"),m=l.getModel("label.emphasis"),v=a.style;g.get("show")?n(v,g,u,r.retrieve(t.getFormattedLabel(s,"normal"),t.getRawValue(s)),p):v.text="",m.get("show")?n(f,m,u,r.retrieve(t.getFormattedLabel(s,"emphasis"),t.getRawValue(s)),p):f.text="",o.setHoverStyle(a,f);});},remove:function remove(t,e){var i=this.group;t.get("animation")?this._data&&this._data.eachItemGraphicEl(function(e){e.style.text="",o.updateProps(e,{shape:{width:0}},t,e.dataIndex,function(){i.remove(e);});}):i.removeAll();}});},function(t,e,i){var n=i(15)([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);t.exports={getBarItemStyle:function getBarItemStyle(t){var e=n.call(this,t);if(this.getBorderLineDash){var i=this.getBorderLineDash();i&&(e.lineDash=i);}return e;}};},function(t,e,i){"use strict";function n(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex;}function r(t){return t.dim+t.index;}function o(t,e){var i={};s.each(t,function(t,e){var o=t.getData(),a=t.coordinateSystem,s=a.getBaseAxis(),l=s.getExtent(),h="category"===s.type?s.getBandWidth():Math.abs(l[1]-l[0])/o.count(),c=i[r(s)]||{bandWidth:h,remainedWidth:h,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},d=c.stacks;i[r(s)]=c;var f=n(t);d[f]||c.autoWidthCount++,d[f]=d[f]||{width:0,maxWidth:0};var p=u(t.get("barWidth"),h),g=u(t.get("barMaxWidth"),h),m=t.get("barGap"),v=t.get("barCategoryGap");p&&!d[f].width&&(p=Math.min(c.remainedWidth,p),d[f].width=p,c.remainedWidth-=p),g&&(d[f].maxWidth=g),null!=m&&(c.gap=m),null!=v&&(c.categoryGap=v);});var o={};return s.each(i,function(t,e){o[e]={};var i=t.stacks,n=t.bandWidth,r=u(t.categoryGap,n),a=u(t.gap,1),l=t.remainedWidth,h=t.autoWidthCount,c=(l-r)/(h+(h-1)*a);c=Math.max(c,0),s.each(i,function(t,e){var i=t.maxWidth;!t.width&&i&&c>i&&(i=Math.min(i,l),l-=i,t.width=i,h--);}),c=(l-r)/(h+(h-1)*a),c=Math.max(c,0);var d,f=0;s.each(i,function(t,e){t.width||(t.width=c),d=t,f+=t.width*(1+a);}),d&&(f-=d.width*a);var p=-f/2;s.each(i,function(t,i){o[e][i]=o[e][i]||{offset:p,width:t.width},p+=t.width*(1+a);});}),o;}function a(t,e,i){var a=o(s.filter(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type;})),l={},u={};e.eachSeriesByType(t,function(t){var e=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),s=n(t),h=a[r(o)][s],c=h.offset,d=h.width,f=i.getOtherAxis(o),p=t.get("barMinHeight")||0,g=o.onZero?f.toGlobalCoord(f.dataToCoord(0)):f.getGlobalExtent()[0],m=i.dataToPoints(e,!0);l[s]=l[s]||[],u[s]=u[s]||[],e.setLayout({offset:c,size:d}),e.each(f.dim,function(t,i){if(!isNaN(t)){l[s][i]||(l[s][i]={p:g,n:g},u[s][i]={p:g,n:g});var n,r,o,a,h=t>=0?"p":"n",v=m[i],y=l[s][i][h],x=u[s][i][h];f.isHorizontal()?(n=y,r=v[1]+c,o=v[0]-x,a=d,u[s][i][h]+=o,Math.abs(o)<p&&(o=(0>o?-1:1)*p),l[s][i][h]+=o):(n=v[0]+c,r=y,o=d,a=v[1]-x,u[s][i][h]+=a,Math.abs(a)<p&&(a=(0>=a?-1:1)*p),l[s][i][h]+=a),e.setItemLayout(i,{x:n,y:r,width:o,height:a});}},!0);},this);}var s=i(4),l=i(7),u=l.parsePercent;t.exports=a;},function(t,e,i){var n=i(4),r=i(1);i(140),i(142),i(143)("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),r.registerVisual(n.curry(i(144),"pie")),r.registerLayout(n.curry(i(145),"pie")),r.registerProcessor(n.curry(i(147),"pie"));},function(t,e,i){"use strict";var n=i(97),r=i(4),o=i(5),a=i(102),s=i(141),l=i(1).extendSeriesModel({type:"series.pie",init:function init(t){l.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;},this.updateSelectedMap(t.data),this._defaultLabelLine(t);},mergeOption:function mergeOption(t){l.superCall(this,"mergeOption",t),this.updateSelectedMap(this.option.data);},getInitialData:function getInitialData(t,e){var i=a(["value"],t.data),r=new n(i,this);return r.initData(t.data),r;},getDataParams:function getDataParams(t){var e=this._data,i=l.superCall(this,"getDataParams",t),n=e.getSum("value");return i.percent=n?+(e.get("value",t)/n*100).toFixed(2):0,i.$vars.push("percent"),i;},_defaultLabelLine:function _defaultLabelLine(t){o.defaultEmphasis(t.labelLine,["show"]);var e=t.labelLine.normal,i=t.labelLine.emphasis;e.show=e.show&&t.label.normal.show,i.show=i.show&&t.label.emphasis.show;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,selectedOffset:10,avoidLabelOverlap:!0,label:{normal:{rotate:!1,show:!0,position:"outer"},emphasis:{}},labelLine:{normal:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}}},itemStyle:{normal:{borderWidth:1},emphasis:{}},animationEasing:"cubicOut",data:[]}});r.mixin(l,s),t.exports=l;},function(t,e,i){var n=i(4);t.exports={updateSelectedMap:function updateSelectedMap(t){this._selectTargetMap=n.reduce(t||[],function(t,e){return t[e.name]=e,t;},{});},select:function select(t){var e=this._selectTargetMap,i=e[t],r=this.get("selectedMode");"single"===r&&n.each(e,function(t){t.selected=!1;}),i&&(i.selected=!0);},unSelect:function unSelect(t){var e=this._selectTargetMap[t];e&&(e.selected=!1);},toggleSelected:function toggleSelected(t){var e=this._selectTargetMap[t];return null!=e?(this[e.selected?"unSelect":"select"](t),e.selected):void 0;},isSelected:function isSelected(t){var e=this._selectTargetMap[t];return e&&e.selected;}};},function(t,e,i){function n(t,e,i,n){var o=e.getData(),a=this.dataIndex,s=o.getName(a),l=e.get("selectedOffset");n.dispatchAction({type:"pieToggleSelect",from:t,name:s,seriesId:e.id}),o.each(function(t){r(o.getItemGraphicEl(t),o.getItemLayout(t),e.isSelected(o.getName(t)),l,i);});}function r(t,e,i,n,r){var o=(e.startAngle+e.endAngle)/2,a=Math.cos(o),s=Math.sin(o),l=i?n:0,u=[a*l,s*l];r?t.animate().when(200,{position:u}).start("bounceOut"):t.attr("position",u);}function o(t,e){function i(){o.ignore=o.hoverIgnore,a.ignore=a.hoverIgnore;}function n(){o.ignore=o.normalIgnore,a.ignore=a.normalIgnore;}s.Group.call(this);var r=new s.Sector({z2:2}),o=new s.Polyline(),a=new s.Text();this.add(r),this.add(o),this.add(a),this.updateData(t,e,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n);}function a(t,e,i,n,r){var o=n.getModel("textStyle"),a="inside"===r||"inner"===r;return{fill:o.getTextColor()||(a?"#fff":t.getItemVisual(e,"color")),opacity:t.getItemVisual(e,"opacity"),textFont:o.getFont(),text:l.retrieve(t.hostModel.getFormattedLabel(e,i),t.getName(e))};}var s=i(43),l=i(4),u=o.prototype;u.updateData=function(t,e,i){function n(){a.stopAnimation(!0),a.animateTo({shape:{r:c.r+10}},300,"elasticOut");}function o(){a.stopAnimation(!0),a.animateTo({shape:{r:c.r}},300,"elasticOut");}var a=this.childAt(0),u=t.hostModel,h=t.getItemModel(e),c=t.getItemLayout(e),d=l.extend({},c);d.label=null,i?(a.setShape(d),a.shape.endAngle=c.startAngle,s.updateProps(a,{shape:{endAngle:c.endAngle}},u,e)):s.updateProps(a,{shape:d},u,e);var f=h.getModel("itemStyle"),p=t.getItemVisual(e,"color");a.useStyle(l.defaults({lineJoin:"bevel",fill:p},f.getModel("normal").getItemStyle())),a.hoverStyle=f.getModel("emphasis").getItemStyle(),r(this,t.getItemLayout(e),h.get("selected"),u.get("selectedOffset"),u.get("animation")),a.off("mouseover").off("mouseout").off("emphasis").off("normal"),h.get("hoverAnimation")&&u.ifEnableAnimation()&&a.on("mouseover",n).on("mouseout",o).on("emphasis",n).on("normal",o),this._updateLabel(t,e),s.setHoverStyle(this);},u._updateLabel=function(t,e){var i=this.childAt(1),n=this.childAt(2),r=t.hostModel,o=t.getItemModel(e),l=t.getItemLayout(e),u=l.label,h=t.getItemVisual(e,"color");s.updateProps(i,{shape:{points:u.linePoints||[[u.x,u.y],[u.x,u.y],[u.x,u.y]]}},r,e),s.updateProps(n,{style:{x:u.x,y:u.y}},r,e),n.attr({style:{textVerticalAlign:u.verticalAlign,textAlign:u.textAlign,textFont:u.font},rotation:u.rotation,origin:[u.x,u.y],z2:10});var c=o.getModel("label.normal"),d=o.getModel("label.emphasis"),f=o.getModel("labelLine.normal"),p=o.getModel("labelLine.emphasis"),g=c.get("position")||d.get("position");n.setStyle(a(t,e,"normal",c,g)),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),i.ignore=i.normalIgnore=!f.get("show"),i.hoverIgnore=!p.get("show"),i.setStyle({stroke:h,opacity:t.getItemVisual(e,"opacity")}),i.setStyle(f.getModel("lineStyle").getLineStyle()),n.hoverStyle=a(t,e,"emphasis",d,g),i.hoverStyle=p.getModel("lineStyle").getLineStyle();var m=f.get("smooth");m&&m===!0&&(m=.4),i.setShape({smooth:m});},l.inherits(o,s.Group);var h=i(42).extend({type:"pie",init:function init(){var t=new s.Group();this._sectorGroup=t;},render:function render(t,e,i,r){if(!r||r.from!==this.uid){var a=t.getData(),s=this._data,u=this.group,h=e.get("animation"),c=!s,d=l.curry(n,this.uid,t,h,i),f=t.get("selectedMode");if(a.diff(s).add(function(t){var e=new o(a,t);c&&e.eachChild(function(t){t.stopAnimation(!0);}),f&&e.on("click",d),a.setItemGraphicEl(t,e),u.add(e);}).update(function(t,e){var i=s.getItemGraphicEl(e);i.updateData(a,t),i.off("click"),f&&i.on("click",d),u.add(i),a.setItemGraphicEl(t,i);}).remove(function(t){var e=s.getItemGraphicEl(t);u.remove(e);}).execute(),h&&c&&a.count()>0){var p=a.getItemLayout(0),g=Math.max(i.getWidth(),i.getHeight())/2,m=l.bind(u.removeClipPath,u);u.setClipPath(this._createClipPath(p.cx,p.cy,g,p.startAngle,p.clockwise,m,t));}this._data=a;}},dispose:function dispose(){},_createClipPath:function _createClipPath(t,e,i,n,r,o,a){var l=new s.Sector({shape:{cx:t,cy:e,r0:0,r:i,startAngle:n,endAngle:n,clockwise:r}});return s.initProps(l,{shape:{endAngle:n+(r?1:-1)*Math.PI*2}},a,o),l;},containPoint:function containPoint(t,e){var i=e.getData(),n=i.getItemLayout(0);if(n){var r=t[0]-n.cx,o=t[1]-n.cy,a=Math.sqrt(r*r+o*o);return a<=n.r&&a>=n.r0;}}});t.exports=h;},function(t,e,i){var n=i(1),r=i(4);t.exports=function(t,e){r.each(e,function(e){e.update="updateView",n.registerAction(e,function(i,n){var r={};return n.eachComponent({mainType:"series",subType:t,query:i},function(t){t[e.method]&&t[e.method](i.name);var n=t.getData();n.each(function(e){var i=n.getName(e);r[i]=t.isSelected(i)||!1;});}),{name:i.name,selected:r};});});};},function(t,e){t.exports=function(t,e){var i={};e.eachRawSeriesByType(t,function(t){var n=t.getRawData(),r={};if(!e.isSeriesFiltered(t)){var o=t.getData();o.each(function(t){var e=o.getRawIndex(t);r[e]=t;}),n.each(function(e){var a=n.getItemModel(e),s=r[e],l=null!=s&&o.getItemVisual(s,"color",!0);if(l)n.setItemVisual(e,"color",l);else{var u=a.get("itemStyle.normal.color")||t.getColorFromPalette(n.getName(e),i);n.setItemVisual(e,"color",u),null!=s&&o.setItemVisual(s,"color",u);}});}});};},function(t,e,i){var n=i(7),r=n.parsePercent,o=i(146),a=i(4),s=2*Math.PI,l=Math.PI/180;t.exports=function(t,e,i,u){e.eachSeriesByType(t,function(t){var e=t.get("center"),u=t.get("radius");a.isArray(u)||(u=[0,u]),a.isArray(e)||(e=[e,e]);var h=i.getWidth(),c=i.getHeight(),d=Math.min(h,c),f=r(e[0],h),p=r(e[1],c),g=r(u[0],d/2),m=r(u[1],d/2),v=t.getData(),y=-t.get("startAngle")*l,x=t.get("minAngle")*l,_=v.getSum("value"),b=Math.PI/(_||v.count())*2,w=t.get("clockwise"),S=t.get("roseType"),M=v.getDataExtent("value");M[0]=0;var I=s,T=0,A=y,L=w?1:-1;if(v.each("value",function(t,e){var i;i="area"!==S?0===_?b:t*b:s/(v.count()||1),x>i?(i=x,I-=x):T+=t;var r=A+L*i;v.setItemLayout(e,{angle:i,startAngle:A,endAngle:r,clockwise:w,cx:f,cy:p,r0:g,r:S?n.linearMap(t,M,[g,m]):m}),A=r;},!0),s>I)if(.001>=I){var C=s/v.count();v.each(function(t){var e=v.getItemLayout(t);e.startAngle=y+L*t*C,e.endAngle=y+L*(t+1)*C;});}else b=I/T,A=y,v.each("value",function(t,e){var i=v.getItemLayout(e),n=i.angle===x?x:t*b;i.startAngle=A,i.endAngle=A+L*n,A+=n;});o(t,m,h,c);});};},function(t,e,i){"use strict";function n(t,e,i,n,r,o,a){function s(e,i,n,r){for(var o=e;i>o;o++){if(t[o].y+=n,o>e&&i>o+1&&t[o+1].y>t[o].y+t[o].height)return void l(o,n/2);}l(i-1,n/2);}function l(e,i){for(var n=e;n>=0&&(t[n].y-=i,!(n>0&&t[n].y>t[n-1].y+t[n-1].height));n--){}}function u(t,e,i,n,r,o){for(var a=o>0?e?Number.MAX_VALUE:0:e?Number.MAX_VALUE:0,s=0,l=t.length;l>s;s++){if("center"!==t[s].position){var u=Math.abs(t[s].y-n),h=t[s].len,c=t[s].len2,d=r+h>u?Math.sqrt((r+h+c)*(r+h+c)-u*u):Math.abs(t[s].x-i);e&&d>=a&&(d=a-10),!e&&a>=d&&(d=a+10),t[s].x=i+d*o,a=d;}}}t.sort(function(t,e){return t.y-e.y;});for(var h,c=0,d=t.length,f=[],p=[],g=0;d>g;g++){h=t[g].y-c,0>h&&s(g,d,-h,r),c=t[g].y+t[g].height;}0>a-c&&l(d-1,c-a);for(var g=0;d>g;g++){t[g].y>=i?p.push(t[g]):f.push(t[g]);}u(f,!1,e,i,n,r),u(p,!0,e,i,n,r);}function r(t,e,i,r,o,a){for(var s=[],l=[],u=0;u<t.length;u++){t[u].x<e?s.push(t[u]):l.push(t[u]);}n(l,e,i,r,1,o,a),n(s,e,i,r,-1,o,a);for(var u=0;u<t.length;u++){var h=t[u].linePoints;if(h){var c=h[1][0]-h[2][0];t[u].x<e?h[2][0]=t[u].x+3:h[2][0]=t[u].x-3,h[1][1]=h[2][1]=t[u].y,h[1][0]=h[2][0]+c;}}}var o=i(8);t.exports=function(t,e,i,n){var a,s,l=t.getData(),u=[],h=!1;l.each(function(i){var n,r,c,d,f=l.getItemLayout(i),p=l.getItemModel(i),g=p.getModel("label.normal"),m=g.get("position")||p.get("label.emphasis.position"),v=p.getModel("labelLine.normal"),y=v.get("length"),x=v.get("length2"),_=(f.startAngle+f.endAngle)/2,b=Math.cos(_),w=Math.sin(_);a=f.cx,s=f.cy;var S="inside"===m||"inner"===m;if("center"===m)n=f.cx,r=f.cy,d="center";else{var M=(S?(f.r+f.r0)/2*b:f.r*b)+a,I=(S?(f.r+f.r0)/2*w:f.r*w)+s;if(n=M+3*b,r=I+3*w,!S){var T=M+b*(y+e-f.r),A=I+w*(y+e-f.r),L=T+(0>b?-1:1)*x,C=A;n=L+(0>b?-5:5),r=C,c=[[M,I],[T,A],[L,C]];}d=S?"center":b>0?"left":"right";}var D=g.getModel("textStyle").getFont(),P=g.get("rotate")?0>b?-_+Math.PI:-_:0,k=t.getFormattedLabel(i,"normal")||l.getName(i),z=o.getBoundingRect(k,D,d,"top");h=!!P,f.label={x:n,y:r,position:m,height:z.height,len:y,len2:x,linePoints:c,textAlign:d,verticalAlign:"middle",font:D,rotation:P},S||u.push(f.label);}),!h&&t.get("avoidLabelOverlap")&&r(u,a,s,e,i,n);};},function(t,e){t.exports=function(t,e){var i=e.findComponents({mainType:"legend"});i&&i.length&&e.eachSeriesByType(t,function(t){var e=t.getData();e.filterSelf(function(t){for(var n=e.getName(t),r=0;r<i.length;r++){if(!i[r].isSelected(n))return!1;}return!0;},this);},this);};},function(t,e,i){var n=i(4),r=i(1);i(149),i(150),r.registerVisual(n.curry(i(109),"scatter","circle",null)),r.registerLayout(n.curry(i(110),"scatter")),i(112);},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.scatter",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=n(t.data,this,e);return i;},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{normal:{opacity:.8}}}});},function(t,e,i){var n=i(104),r=i(151);i(1).extendChartView({type:"scatter",init:function init(){this._normalSymbolDraw=new n(),this._largeSymbolDraw=new r();},render:function render(t,e,i){var n=t.getData(),r=this._largeSymbolDraw,o=this._normalSymbolDraw,a=this.group,s=t.get("large")&&n.count()>t.get("largeThreshold")?r:o;this._symbolDraw=s,s.updateData(n),a.add(s.group),a.remove(s===r?o.group:r.group);},updateLayout:function updateLayout(t){this._symbolDraw.updateLayout(t);},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(e,!0);},dispose:function dispose(){}});},function(t,e,i){function n(){this.group=new r.Group(),this._symbolEl=new a({});}var r=i(43),o=i(106),a=r.extendShape({shape:{points:null,sizes:null},symbolProxy:null,buildPath:function buildPath(t,e){for(var i=e.points,n=e.sizes,r=this.symbolProxy,o=r.shape,a=0;a<i.length;a++){var s=i[a],l=n[a];l[0]<4?t.rect(s[0]-l[0]/2,s[1]-l[1]/2,l[0],l[1]):(o.x=s[0]-l[0]/2,o.y=s[1]-l[1]/2,o.width=l[0],o.height=l[1],r.buildPath(t,o,!0));}},findDataIndex:function findDataIndex(t,e){for(var i=this.shape,n=i.points,r=i.sizes,o=n.length-1;o>=0;o--){var a=n[o],s=r[o],l=a[0]-s[0]/2,u=a[1]-s[1]/2;if(t>=l&&e>=u&&t<=l+s[0]&&e<=u+s[1])return o;}return-1;}}),s=n.prototype;s.updateData=function(t){this.group.removeAll();var e=this._symbolEl,i=t.hostModel;e.setShape({points:t.mapArray(t.getItemLayout),sizes:t.mapArray(function(e){var i=t.getItemVisual(e,"symbolSize");return i instanceof Array||(i=[i,i]),i;})}),e.symbolProxy=o.createSymbol(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor,e.useStyle(i.getModel("itemStyle.normal").getItemStyle(["color"]));var n=t.getVisual("color");n&&e.setColor(n),e.seriesIndex=i.seriesIndex,e.on("mousemove",function(t){e.dataIndex=null;var i=e.findDataIndex(t.offsetX,t.offsetY);i>0&&(e.dataIndex=i);}),this.group.add(e);},s.updateLayout=function(t){var e=t.getData();this._symbolEl.setShape({points:e.mapArray(e.getItemLayout)});},s.remove=function(){this.group.removeAll();},t.exports=n;},function(t,e,i){var n=i(4),r=i(1);i(153),i(158),i(159),r.registerVisual(n.curry(i(144),"radar")),r.registerVisual(n.curry(i(109),"radar","circle",null)),r.registerLayout(i(160)),r.registerProcessor(n.curry(i(147),"radar")),r.registerPreprocessor(i(161));},function(t,e,i){i(154),i(156),i(157);},function(t,e,i){function n(t,e,i){this._model=t,this.dimensions=[],this._indicatorAxes=r.map(t.getIndicatorModels(),function(t,e){var i="indicator_"+e,n=new o(i,new a());return n.name=t.get("name"),n.model=t,t.axis=n,this.dimensions.push(i),n;},this),this.resize(t,i),this.cx,this.cy,this.r,this.startAngle;}var r=i(4),o=i(155),a=i(117),s=i(7),l=i(114);n.prototype.getIndicatorAxes=function(){return this._indicatorAxes;},n.prototype.dataToPoint=function(t,e){var i=this._indicatorAxes[e];return this.coordToPoint(i.dataToCoord(t),e);},n.prototype.coordToPoint=function(t,e){var i=this._indicatorAxes[e],n=i.angle,r=this.cx+t*Math.cos(n),o=this.cy-t*Math.sin(n);return[r,o];},n.prototype.pointToData=function(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=Math.sqrt(e*e+i*i);e/=n,i/=n;for(var r,o=Math.atan2(-i,e),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],h=Math.abs(o-u.angle);a>h&&(r=u,s=l,a=h);}return[s,+(r&&r.coodToData(n))];},n.prototype.resize=function(t,e){var i=t.get("center"),n=e.getWidth(),o=e.getHeight(),a=Math.min(n,o)/2;this.cx=s.parsePercent(i[0],n),this.cy=s.parsePercent(i[1],o),this.startAngle=t.get("startAngle")*Math.PI/180,this.r=s.parsePercent(t.get("radius"),a),r.each(this._indicatorAxes,function(t,e){t.setExtent(0,this.r);var i=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;i=Math.atan2(Math.sin(i),Math.cos(i)),t.angle=i;},this);},n.prototype.update=function(t,e){function i(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),i=t/e;return 2===i?i=5:i*=2,i*e;}var n=this._indicatorAxes,o=this._model;r.each(n,function(t){t.scale.setExtent(1/0,-(1/0));}),t.eachSeriesByType("radar",function(e,i){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===o){var a=e.getData();r.each(n,function(t){t.scale.unionExtent(a.getDataExtent(t.dim));});}},this);var a=o.get("splitNumber");r.each(n,function(t,e){var n=l.getScaleExtent(t,t.model);l.niceScaleExtent(t,t.model);var r=t.model,o=t.scale,u=r.get("min"),h=r.get("max"),c=o.getInterval();if(null!=u&&null!=h)o.setInterval((h-u)/a);else if(null!=u){var d;do{d=u+c*a,o.setExtent(+u,d),o.setInterval(c),c=i(c);}while(d<n[1]&&isFinite(d)&&isFinite(n[1]));}else if(null!=h){var f;do{f=h-c*a,o.setExtent(f,+h),o.setInterval(c),c=i(c);}while(f>n[0]&&isFinite(f)&&isFinite(n[0]));}else{var p=o.getTicks().length-1;p>a&&(c=i(c));var g=Math.round((n[0]+n[1])/2/c)*c,m=Math.round(a/2);o.setExtent(s.round(g-m*c),s.round(g+(a-m)*c)),o.setInterval(c);}});},n.dimensions=[],n.create=function(t,e){var i=[];return t.eachComponent("radar",function(r){var o=new n(r,t,e);i.push(o),r.coordinateSystem=o;}),t.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0]);}),i;},i(26).register("radar",n),t.exports=n;},function(t,e,i){function n(t,e,i){o.call(this,t,e,i),this.type="value",this.angle=0,this.name="",this.model;}var r=i(4),o=i(123);r.inherits(n,o),t.exports=n;},function(t,e,i){function n(t,e){return s.defaults({show:e},t);}var r=i(128),o=r.valueAxis,a=i(12),s=i(4),l=i(129),u=i(1).extendComponentModel({type:"radar",optionUpdated:function optionUpdated(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),i=this.get("scale"),n=this.get("axisLine"),r=this.get("axisTick"),o=this.get("axisLabel"),u=this.get("name.textStyle"),h=this.get("name.show"),c=this.get("name.formatter"),d=this.get("nameGap"),f=this.get("triggerEvent"),p=s.map(this.get("indicator")||[],function(p){null!=p.max&&p.max>0&&!p.min?p.min=0:null!=p.min&&p.min<0&&!p.max&&(p.max=0),p=s.merge(s.clone(p),{boundaryGap:t,splitNumber:e,scale:i,axisLine:n,axisTick:r,axisLabel:o,name:p.text,nameLocation:"end",nameGap:d,nameTextStyle:u,triggerEvent:f},!1),h||(p.name=""),"string"==typeof c?p.name=c.replace("{value}",p.name):"function"==typeof c&&(p.name=c(p.name,p));var g=s.extend(new a(p,null,this.ecModel),l);return g.mainType="radar",g.componentIndex=this.componentIndex,g;},this);this.getIndicatorModels=function(){return p;};},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:s.merge({lineStyle:{color:"#bbb"}},o.axisLine),axisLabel:n(o.axisLabel,!1),axisTick:n(o.axisTick,!1),splitLine:n(o.splitLine,!0),splitArea:n(o.splitArea,!0),indicator:[]}});t.exports=u;},function(t,e,i){var n=i(133),r=i(4),o=i(43),a=["axisLine","axisLabel","axisTick","axisName"];t.exports=i(1).extendComponentView({type:"radar",render:function render(t,e,i){var n=this.group;n.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t);},_buildAxes:function _buildAxes(t){var e=t.coordinateSystem,i=e.getIndicatorAxes(),o=r.map(i,function(t){var i=new n(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return i;});r.each(o,function(t){r.each(a,t.add,t),this.group.add(t.getGroup());},this);},_buildSplitLineAndArea:function _buildSplitLineAndArea(t){function e(t,e,i){var n=i%e.length;return t[n]=t[n]||[],n;}var i=t.coordinateSystem,n=t.get("splitNumber"),a=i.getIndicatorAxes();if(a.length){var s=t.get("shape"),l=t.getModel("splitLine"),u=t.getModel("splitArea"),h=l.getModel("lineStyle"),c=u.getModel("areaStyle"),d=l.get("show"),f=u.get("show"),p=h.get("color"),g=c.get("color");p=r.isArray(p)?p:[p],g=r.isArray(g)?g:[g];var m=[],v=[];if("circle"===s)for(var y=a[0].getTicksCoords(),x=i.cx,_=i.cy,b=0;b<y.length;b++){if(d){var w=e(m,p,b);m[w].push(new o.Circle({shape:{cx:x,cy:_,r:y[b]}}));}if(f&&b<y.length-1){var w=e(v,g,b);v[w].push(new o.Ring({shape:{cx:x,cy:_,r0:y[b],r:y[b+1]}}));}}else for(var S=r.map(a,function(t,e){var n=t.getTicksCoords();return r.map(n,function(t){return i.coordToPoint(t,e);});}),M=[],b=0;n>=b;b++){for(var I=[],T=0;T<a.length;T++){I.push(S[T][b]);}if(I[0]?I.push(I[0].slice()):console.error("Can't draw value axis "+b),d){var w=e(m,p,b);m[w].push(new o.Polyline({shape:{points:I}}));}if(f&&M){var w=e(v,g,b-1);v[w].push(new o.Polygon({shape:{points:I.concat(M)}}));}M=I.slice().reverse();}var A=h.getLineStyle(),L=c.getAreaStyle();r.each(v,function(t,e){this.group.add(o.mergePath(t,{style:r.defaults({stroke:"none",fill:g[e%g.length]},L),silent:!0}));},this),r.each(m,function(t,e){this.group.add(o.mergePath(t,{style:r.defaults({fill:"none",stroke:p[e%p.length]},A),silent:!0}));},this);}}});},function(t,e,i){"use strict";var n=i(28),r=i(97),o=i(102),a=i(4),s=n.extend({type:"series.radar",dependencies:["radar"],init:function init(t){s.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;};},getInitialData:function getInitialData(t,e){var i=t.data||[],n=o([],i,[],"indicator_"),a=new r(n,this);return a.initData(i),a;},formatTooltip:function formatTooltip(t){var e=this.getRawValue(t),i=this.coordinateSystem,n=i.getIndicatorAxes();return(""==this._data.getName(t)?this.name:this._data.getName(t))+"<br/>"+a.map(n,function(t,i){return t.name+" : "+e[i];}).join("<br />");},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{normal:{width:2,type:"solid"}},label:{normal:{position:"top"}},symbol:"emptyCircle",symbolSize:4}});t.exports=s;},function(t,e,i){function n(t){return o.isArray(t)||(t=[+t,+t]),t;}var r=i(43),o=i(4),a=i(106);t.exports=i(1).extendChartView({type:"radar",render:function render(t,e,i){function s(t,e){var i=t.getItemVisual(e,"symbol")||"circle",r=t.getItemVisual(e,"color");if("none"!==i){var o=a.createSymbol(i,-.5,-.5,1,1,r);return o.attr({style:{strokeNoScale:!0},z2:100,scale:n(t.getItemVisual(e,"symbolSize"))}),o;}}function l(e,i,n,o,a,l){n.removeAll();for(var u=0;u<i.length-1;u++){var h=s(o,a);h&&(h.__dimIdx=u,e[u]?(h.attr("position",e[u]),r[l?"initProps":"updateProps"](h,{position:i[u]},t,a)):h.attr("position",i[u]),n.add(h));}}function u(t){return o.map(t,function(t){return[h.cx,h.cy];});}var h=t.coordinateSystem,c=this.group,d=t.getData(),f=this._data;d.diff(f).add(function(e){var i=d.getItemLayout(e);if(i){var n=new r.Polygon(),o=new r.Polyline(),a={shape:{points:i}};n.shape.points=u(i),o.shape.points=u(i),r.initProps(n,a,t,e),r.initProps(o,a,t,e);var s=new r.Group(),h=new r.Group();s.add(o),s.add(n),s.add(h),l(o.shape.points,i,h,d,e,!0),d.setItemGraphicEl(e,s);}}).update(function(e,i){var n=f.getItemGraphicEl(i),o=n.childAt(0),a=n.childAt(1),s=n.childAt(2),u={shape:{points:d.getItemLayout(e)}};u.shape.points&&(l(o.shape.points,u.shape.points,s,d,e,!1),r.updateProps(o,u,t),r.updateProps(a,u,t),d.setItemGraphicEl(e,n));}).remove(function(t){c.remove(f.getItemGraphicEl(t));}).execute(),d.eachItemGraphicEl(function(e,i){function n(){u.attr("ignore",v);}function a(){u.attr("ignore",m);}var s=d.getItemModel(i),l=e.childAt(0),u=e.childAt(1),h=e.childAt(2),f=d.getItemVisual(i,"color");c.add(e),l.useStyle(o.defaults(s.getModel("lineStyle.normal").getLineStyle(),{fill:"none",stroke:f})),l.hoverStyle=s.getModel("lineStyle.emphasis").getLineStyle();var p=s.getModel("areaStyle.normal"),g=s.getModel("areaStyle.emphasis"),m=p.isEmpty()&&p.parentModel.isEmpty(),v=g.isEmpty()&&g.parentModel.isEmpty();v=v&&m,u.ignore=m,u.useStyle(o.defaults(p.getAreaStyle(),{fill:f,opacity:.7})),u.hoverStyle=g.getAreaStyle();var y=s.getModel("itemStyle.normal").getItemStyle(["color"]),x=s.getModel("itemStyle.emphasis").getItemStyle(),_=s.getModel("label.normal"),b=s.getModel("label.emphasis");h.eachChild(function(e){e.setStyle(y),e.hoverStyle=o.clone(x);var n=d.get(d.dimensions[e.__dimIdx],i);r.setText(e.style,_,f),e.setStyle({text:_.get("show")?o.retrieve(t.getFormattedLabel(i,"normal",null,e.__dimIdx),n):""}),r.setText(e.hoverStyle,b,f),e.hoverStyle.text=b.get("show")?o.retrieve(t.getFormattedLabel(i,"emphasis",null,e.__dimIdx),n):"";}),e.off("mouseover").off("mouseout").off("normal").off("emphasis"),e.on("emphasis",n).on("mouseover",n).on("normal",a).on("mouseout",a),r.setHoverStyle(e);}),this._data=d;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});},function(t,e){t.exports=function(t){t.eachSeriesByType("radar",function(t){function e(t,e){n[e]=n[e]||[],n[e][o]=r.dataToPoint(t,o);}var i=t.getData(),n=[],r=t.coordinateSystem;if(r){for(var o=0;o<r.getIndicatorAxes().length;o++){var a=i.dimensions[o];i.each(a,e);}i.each(function(t){n[t][0]&&n[t].push(n[t][0].slice()),i.setItemLayout(t,n[t]);});}});};},function(t,e,i){var n=i(4);t.exports=function(t){var e=t.polar;if(e){n.isArray(e)||(e=[e]);var i=[];n.each(e,function(e,r){e.indicator?(e.type&&!e.shape&&(e.shape=e.type),t.radar=t.radar||[],n.isArray(t.radar)||(t.radar=[t.radar]),t.radar.push(e)):i.push(e);}),t.polar=i;}n.each(t.series,function(t){"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex);});};},function(t,e,i){var n=i(1),r=n.PRIORITY;i(163),i(173),i(177),i(164),n.registerLayout(i(179)),n.registerVisual(i(180)),n.registerProcessor(r.PROCESSOR.STATISTIC,i(181)),n.registerPreprocessor(i(182)),i(143)("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);},function(t,e,i){var n=i(97),r=i(28),o=i(4),a=i(102),s=i(6),l=s.encodeHTML,u=s.addCommas,h=i(141),c=i(164),d=r.extend({type:"series.map",layoutMode:"box",needsDrawMap:!1,seriesGroup:[],init:function init(t){t=this._fillOption(t,t.map),this.option=t,d.superApply(this,"init",arguments),this.updateSelectedMap(t.data);},getInitialData:function getInitialData(t){var e=a(["value"],t.data||[]),i=new n(e,this);return i.initData(t.data),i;},mergeOption:function mergeOption(t){t.data&&(t=this._fillOption(t,this.option.map)),d.superCall(this,"mergeOption",t),this.updateSelectedMap(this.option.data);},_fillOption:function _fillOption(t,e){return t=o.extend({},t),t.data=c.getFilledRegions(t.data,e),t;},getRawValue:function getRawValue(t){return this._data.get("value",t);},getRegionModel:function getRegionModel(t){var e=this.getData();return e.getItemModel(e.indexOfName(t));},formatTooltip:function formatTooltip(t){for(var e=this.getData(),i=u(this.getRawValue(t)),n=e.getName(t),r=this.seriesGroup,o=[],a=0;a<r.length;a++){var s=r[a].originalData.indexOfName(n);isNaN(r[a].originalData.get("value",s))||o.push(l(r[a].name));}return o.join(", ")+"<br />"+n+" : "+i;},getTooltipPosition:function getTooltipPosition(t){if(null!=t){var e=this.getData().getName(t),i=this.coordinateSystem,n=i.getRegion(e);return n&&i.dataToPoint(n.center);}},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"china",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,textStyle:{color:"#000"}},emphasis:{show:!0,textStyle:{color:"rgb(100,0,0)"}}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{areaColor:"rgba(255,215,0,0.8)"}}}});o.mixin(d,h),t.exports=d;},function(t,e,i){function n(t,e){var i,n=this.getBoundingRect(),r=t.get("layoutCenter"),o=t.get("layoutSize"),s=e.getWidth(),u=e.getHeight(),h=t.get("aspectScale")||.75,c=n.width/n.height*h,d=!1;r&&o&&(r=[l.parsePercent(r[0],s),l.parsePercent(r[1],u)],o=l.parsePercent(o,Math.min(s,u)),isNaN(r[0])||isNaN(r[1])||isNaN(o)?console.warn("Given layoutCenter or layoutSize data are invalid. Use left/top/width/height instead."):d=!0);var f;if(d){var f={};c>1?(f.width=o,f.height=o/c):(f.height=o,f.width=o*c),f.y=r[1]-f.height/2,f.x=r[0]-f.width/2;}else i=t.getBoxLayoutParams(),i.aspect=c,f=a.getLayoutRect(i,{width:s,height:u});this.setViewRect(f.x,f.y,f.width,f.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"));}function r(t,e){s.each(e.get("geoCoord"),function(e,i){t.addGeoCoord(i,e);});}var o=i(165),a=i(21),s=i(4),l=i(7),u={},h=function h(t){console.error("Map "+t+" not exists. You can download map file on http://echarts.baidu.com/download-map.html");},c={dimensions:o.prototype.dimensions,create:function create(t,e){var i=[];t.eachComponent("geo",function(t,a){var s=t.get("map"),l=u[s];l||h(s);var c=new o(s+a,s,l&&l.geoJson,l&&l.specialAreas,t.get("nameMap"));c.zoomLimit=t.get("scaleLimit"),i.push(c),r(c,t),t.coordinateSystem=c,c.model=t,c.resize=n,c.resize(t,e);}),t.eachSeries(function(t){var e=t.get("coordinateSystem");if("geo"===e){var n=t.get("geoIndex")||0;t.coordinateSystem=i[n];}});var a={};return t.eachSeriesByType("map",function(t){var e=t.get("map");a[e]=a[e]||[],a[e].push(t);}),s.each(a,function(t,a){var l=u[a];l||h(t[0].get("map"));var c=s.map(t,function(t){return t.get("nameMap");}),d=new o(a,a,l&&l.geoJson,l&&l.specialAreas,s.mergeAll(c));d.zoomLimit=s.retrieve.apply(null,s.map(t,function(t){return t.get("scaleLimit");})),i.push(d),d.resize=n,d.resize(t[0],e),s.each(t,function(t){t.coordinateSystem=d,r(d,t);});}),i;},registerMap:function registerMap(t,e,i){e.geoJson&&!e.features&&(i=e.specialAreas,e=e.geoJson),"string"==typeof e&&(e="undefined"!=typeof JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")()),u[t]={geoJson:e,specialAreas:i};},getMap:function getMap(t){return u[t];},getFilledRegions:function getFilledRegions(t,e){var i=(t||[]).slice(),n=c.getMap(e),r=n&&n.geoJson;if(!r)return h(e),t;for(var o={},a=r.features,s=0;s<i.length;s++){o[i[s].name]=i[s];}for(var s=0;s<a.length;s++){var l=a[s].properties.name;o[l]||i.push({name:l});}return i;}},d=i(1);d.registerMap=c.registerMap,d.getMap=c.getMap,d.loadMap=function(){},d.registerCoordinateSystem("geo",c),t.exports=c;},function(t,e,i){function n(t,e,i,n,r){l.call(this,t),this.map=e,this._nameCoordMap={},this.loadGeoJson(i,n,r);}function r(t,e,i,n){var r=i.geoModel,o=i.seriesModel,a=r?r.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return a===this?a[t](n):null;}var o=i(166),a=i(4),s=i(9),l=i(169),u=[i(170),i(171),i(172)];n.prototype={constructor:n,type:"geo",dimensions:["lng","lat"],containCoord:function containCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return!0;}return!1;},loadGeoJson:function loadGeoJson(t,e,i){try{this.regions=t?o(t):[];}catch(n){throw"Invalid geoJson format\n"+n;}e=e||{},i=i||{};for(var r=this.regions,s={},l=0;l<r.length;l++){var h=r[l].name;h=i[h]||h,r[l].name=h,s[h]=r[l],this.addGeoCoord(h,r[l].center);var c=e[h];c&&r[l].transformTo(c.left,c.top,c.width,c.height);}this._regionsMap=s,this._rect=null,a.each(u,function(t){t(this);},this);},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect();r=r.clone(),r.y=-r.y-r.height;var o=this._viewTransform;o.transform=r.calculateTransform(new s(t,e,i,n)),o.decomposeTransform();var a=o.scale;a[1]=-a[1],o.updateTransform(),this._updateTransform();},getRegion:function getRegion(t){return this._regionsMap[t];},getRegionByCoord:function getRegionByCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return e[i];}},addGeoCoord:function addGeoCoord(t,e){this._nameCoordMap[t]=e;},getGeoCoord:function getGeoCoord(t){return this._nameCoordMap[t];},getBoundingRect:function getBoundingRect(){if(this._rect)return this._rect;for(var t,e=this.regions,i=0;i<e.length;i++){var n=e[i].getBoundingRect();t=t||n.clone(),t.union(n);}return this._rect=t||new s(0,0,0,0);},dataToPoints:function dataToPoints(t){var e=[];return t.mapArray(["lng","lat"],function(t,i){return e[0]=t,e[1]=i,this.dataToPoint(e);},this);},dataToPoint:function dataToPoint(t){return"string"==typeof t&&(t=this.getGeoCoord(t)),t?l.prototype.dataToPoint.call(this,t):void 0;},convertToPixel:a.curry(r,"dataToPoint"),convertFromPixel:a.curry(r,"pointToData")},a.mixin(n,l),t.exports=n;},function(t,e,i){function n(t){if(!t.UTF8Encoding)return t;for(var e=t.features,i=0;i<e.length;i++){for(var n=e[i],o=n.geometry,a=o.coordinates,s=o.encodeOffsets,l=0;l<a.length;l++){var u=a[l];if("Polygon"===o.type)a[l]=r(u,s[l]);else if("MultiPolygon"===o.type)for(var h=0;h<u.length;h++){var c=u[h];u[h]=r(c,s[l][h]);}}}return t.UTF8Encoding=!1,t;}function r(t,e){for(var i=[],n=e[0],r=e[1],o=0;o<t.length;o+=2){var a=t.charCodeAt(o)-64,s=t.charCodeAt(o+1)-64;a=a>>1^-(1&a),s=s>>1^-(1&s),a+=n,s+=r,n=a,r=s,i.push([a/1024,s/1024]);}return i;}function o(t){for(var e=[],i=0;i<t.length;i++){for(var n=0;n<t[i].length;n++){e.push(t[i][n]);}}return e;}var a=i(4),s=i(167);t.exports=function(t){return n(t),a.map(a.filter(t.features,function(t){return t.geometry&&t.properties;}),function(t){var e=t.properties,i=t.geometry,n=i.coordinates;return"MultiPolygon"===i.type&&(n=o(n)),new s(e.name,n,e.cp);});};},function(t,e,i){function n(t,e,i){if(this.name=t,this.contours=e,i)i=[i[0],i[1]];else{var n=this.getBoundingRect();i=[n.x+n.width/2,n.y+n.height/2];}this.center=i;}var r=i(168),o=i(9),a=i(51),s=i(10);n.prototype={constructor:n,getBoundingRect:function getBoundingRect(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,i=[e,e],n=[-e,-e],r=[],l=[],u=this.contours,h=0;h<u.length;h++){a.fromPoints(u[h],r,l),s.min(i,i,r),s.max(n,n,l);}return 0===h&&(i[0]=i[1]=n[0]=n[1]=0),this._rect=new o(i[0],i[1],n[0]-i[0],n[1]-i[1]);},contain:function contain(t){var e=this.getBoundingRect(),i=this.contours;if(e.contain(t[0],t[1]))for(var n=0,o=i.length;o>n;n++){if(r.contain(i[n],t[0],t[1]))return!0;}return!1;},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect(),a=r.width/r.height;i?n||(n=i/a):i=a*n;for(var l=new o(t,e,i,n),u=r.calculateTransform(l),h=this.contours,c=0;c<h.length;c++){for(var d=0;d<h[c].length;d++){s.applyTransform(h[c][d],h[c][d],u);}}r=this._rect,r.copy(l),this.center=[r.x+r.width/2,r.y+r.height/2];}},t.exports=n;},function(t,e,i){function n(t,e){return Math.abs(t-e)<a;}function r(t,e,i){var r=0,a=t[0];if(!a)return!1;for(var s=1;s<t.length;s++){var l=t[s];r+=o(a[0],a[1],l[0],l[1],e,i),a=l;}var u=t[0];return n(a[0],u[0])&&n(a[1],u[1])||(r+=o(a[0],a[1],u[0],u[1],e,i)),0!==r;}var o=i(58),a=1e-8;t.exports={contain:r};},function(t,e,i){function n(){l.call(this);}function r(t){this.name=t,this.zoomLimit,l.call(this),this._roamTransform=new n(),this._viewTransform=new n(),this._center,this._zoom;}function o(t,e,i,n){var r=i.seriesModel,o=r?r.coordinateSystem:null;return o===this?o[t](n):null;}var a=i(10),s=i(11),l=i(34),u=i(4),h=i(9),c=a.applyTransform;u.mixin(n,l),r.prototype={constructor:r,type:"view",dimensions:["x","y"],setBoundingRect:function setBoundingRect(t,e,i,n){return this._rect=new h(t,e,i,n),this._rect;},getBoundingRect:function getBoundingRect(){return this._rect;},setViewRect:function setViewRect(t,e,i,n){this.transformTo(t,e,i,n),this._viewRect=new h(t,e,i,n);},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect(),o=this._viewTransform;o.transform=r.calculateTransform(new h(t,e,i,n)),o.decomposeTransform(),this._updateTransform();},setCenter:function setCenter(t){t&&(this._center=t,this._updateCenterAndZoom());},setZoom:function setZoom(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom();},getDefaultCenter:function getDefaultCenter(){var t=this.getBoundingRect(),e=t.x+t.width/2,i=t.y+t.height/2;return[e,i];},getCenter:function getCenter(){return this._center||this.getDefaultCenter();},getZoom:function getZoom(){return this._zoom||1;},getRoamTransform:function getRoamTransform(){return this._roamTransform;},_updateCenterAndZoom:function _updateCenterAndZoom(){var t=this._viewTransform.getLocalTransform(),e=this._roamTransform,i=this.getDefaultCenter(),n=this.getCenter(),r=this.getZoom();n=a.applyTransform([],n,t),i=a.applyTransform([],i,t),e.origin=n,e.position=[i[0]-n[0],i[1]-n[1]],e.scale=[r,r],this._updateTransform();},_updateTransform:function _updateTransform(){var t=this._roamTransform,e=this._viewTransform;e.parent=t,t.updateTransform(),e.updateTransform(),e.transform&&s.copy(this.transform||(this.transform=[]),e.transform),this.transform?(this.invTransform=this.invTransform||[],s.invert(this.invTransform,this.transform)):this.invTransform=null,this.decomposeTransform();},getViewRect:function getViewRect(){return this._viewRect;},getViewRectAfterRoam:function getViewRectAfterRoam(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t;},dataToPoint:function dataToPoint(t){var e=this.transform;return e?c([],t,e):[t[0],t[1]];},pointToData:function pointToData(t){var e=this.invTransform;return e?c([],t,e):[t[0],t[1]];},convertToPixel:u.curry(o,"dataToPoint"),convertFromPixel:u.curry(o,"pointToData"),containPoint:function containPoint(t){return this.getViewRect().contain(t[0],t[1]);}},u.mixin(r,l),t.exports=r;},function(t,e,i){for(var n=i(167),r=[126,25],o=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],a=0;a<o.length;a++){for(var s=0;s<o[a].length;s++){o[a][s][0]/=10.5,o[a][s][1]/=-14,o[a][s][0]+=r[0],o[a][s][1]+=r[1];}}t.exports=function(t){"china"===t.map&&t.regions.push(new n("",o,r));};},function(t,e,i){var n=i(4),r={"":[32,80],"":[0,-10],"":[10,5],"":[-10,10],"":[5,5]};t.exports=function(t){n.each(t.regions,function(t){var e=r[t.name];if(e){var i=t.center;i[0]+=e[0]/10.5,i[1]+=-e[1]/14;}});};},function(t,e,i){var n=i(4),r={Russia:[100,60],"United States of America":[-99,38]};t.exports=function(t){n.each(t.regions,function(t){var e=r[t.name];if(e){var i=t.center;i[0]=e[0],i[1]=e[1];}});};},function(t,e,i){var n=i(43),r=i(174);i(1).extendChartView({type:"map",render:function render(t,e,i,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var o=this.group;if(o.removeAll(),n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===t.id){var a=this._mapDraw;a&&o.add(a.group);}else if(t.needsDrawMap){var a=this._mapDraw||new r(i,!0);o.add(a.group),a.draw(t,e,i,this,n),this._mapDraw=a;}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,i);}},remove:function remove(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll();},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;},_renderSymbols:function _renderSymbols(t,e,i){var r=t.originalData,o=this.group;r.each("value",function(e,i){if(!isNaN(e)){var a=r.getItemLayout(i);if(a&&a.point){var s=a.point,l=a.offset,u=new n.Circle({style:{fill:t.getData().getVisual("color")},shape:{cx:s[0]+9*l,cy:s[1],r:3},silent:!0,z2:10});if(!l){var h=t.mainSeries.getData(),c=r.getName(i),d=c,f=h.indexOfName(c),p=r.getItemModel(i),g=p.getModel("label.normal"),m=p.getModel("label.emphasis"),v=g.getModel("textStyle"),y=m.getModel("textStyle"),x=h.getItemGraphicEl(f);u.setStyle({textPosition:"bottom"});var _=function _(){u.setStyle({text:m.get("show")?d:"",textFill:y.getTextColor(),textFont:y.getFont()});},b=function b(){u.setStyle({text:g.get("show")?d:"",textFill:v.getTextColor(),textFont:v.getFont()});};x.on("mouseover",_).on("mouseout",b).on("emphasis",_).on("normal",b),b();}o.add(u);}}});}});},function(t,e,i){function n(t,e){var i=t.getItemStyle(),n=t.get("areaColor");return n&&(i.fill=n),i;}function r(t,e,i,n){e.off("click"),t.get("selectedMode")&&e.on("click",function(r){for(var a=r.target;!a.__region;){a=a.parent;}if(a){var s=a.__region,l={type:("geo"===t.mainType?"geo":"map")+"ToggleSelect",name:s.name,from:n.uid};l[t.mainType+"Id"]=t.id,i.dispatchAction(l),o(t,e);}});}function o(t,e){e.eachChild(function(e){e.__region&&e.trigger(t.isSelected(e.__region.name)?"emphasis":"normal");});}function a(t,e){var i=new l.Group();this._controller=new s(t.getZr(),e?i:null,null),this.group=i,this._updateGroup=e;}var s=i(175),l=i(43),u=i(4);a.prototype={constructor:a,draw:function draw(t,e,i,a,s){var h=t.getData&&t.getData(),c=t.coordinateSystem,d=this.group,f=c.scale,p={position:c.position,scale:f};!d.childAt(0)||s?d.attr(p):l.updateProps(d,p,t),d.removeAll();var g=["itemStyle","normal"],m=["itemStyle","emphasis"],v=["label","normal"],y=["label","emphasis"];u.each(c.regions,function(e){var i=new l.Group(),r=new l.CompoundPath({shape:{paths:[]}});i.add(r);var o,a=t.getRegionModel(e.name)||t,s=a.getModel(g),c=a.getModel(m),p=n(s,f),x=n(c,f),_=a.getModel(v),b=a.getModel(y);if(h){o=h.indexOfName(e.name);var w=h.getItemVisual(o,"color",!0);w&&(p.fill=w);}var S=_.getModel("textStyle"),M=b.getModel("textStyle");u.each(e.contours,function(t){var e=new l.Polygon({shape:{points:t}});r.shape.paths.push(e);}),r.setStyle(p),r.style.strokeNoScale=!0,r.culling=!0;var I=_.get("show"),T=b.get("show"),A=h&&isNaN(h.get("value",o)),L=h&&h.getItemLayout(o);if(!h||A&&(I||T)||L&&L.showLabel){var C=h?o:e.name,D=t.getFormattedLabel(C,"normal"),P=t.getFormattedLabel(C,"emphasis"),k=new l.Text({style:{text:I?D||e.name:"",fill:S.getTextColor(),textFont:S.getFont(),textAlign:"center",textVerticalAlign:"middle"},hoverStyle:{text:T?P||e.name:"",fill:M.getTextColor(),textFont:M.getFont()},position:e.center.slice(),scale:[1/f[0],1/f[1]],z2:10,silent:!0});i.add(k);}if(h)h.setItemGraphicEl(o,i);else{var a=t.getRegionModel(e.name);r.eventData={componentType:"geo",geoIndex:t.componentIndex,name:e.name,region:a&&a.option||{}};}i.__region=e,l.setHoverStyle(i,x),d.add(i);}),this._updateController(t,e,i),r(t,d,i,a),o(t,d);},remove:function remove(){this.group.removeAll(),this._controller.dispose();},_updateController:function _updateController(t,e,i){function n(){var e={type:"geoRoam",componentType:a};return e[a+"Id"]=t.id,e;}var r=t.coordinateSystem,o=this._controller;o.zoomLimit=t.get("scaleLimit"),o.zoom=r.getZoom(),o.enable(t.get("roam")||!1);var a=t.mainType;o.off("pan").on("pan",function(t,e){i.dispatchAction(u.extend(n(),{dx:t,dy:e}));}),o.off("zoom").on("zoom",function(t,e,r){if(i.dispatchAction(u.extend(n(),{zoom:t,originX:e,originY:r})),this._updateGroup){var o=this.group,a=o.scale;o.traverse(function(t){"text"===t.type&&t.attr("scale",[1/a[0],1/a[1]]);});}},this),o.setContainsPoint(function(t,e){return r.getViewRectAfterRoam().contain(t,e);});}},t.exports=a;},function(t,e,i){function n(t){if(!t.target||!t.target.draggable){var e=t.offsetX,i=t.offsetY;this.containsPoint&&this.containsPoint(e,i)&&(this._x=e,this._y=i,this._dragging=!0);}}function r(t){if(this._dragging&&(d.stop(t.event),"pinch"!==t.gestureEvent)){if(f.isTaken(this._zr,"globalPan"))return;var e=t.offsetX,i=t.offsetY,n=this._x,r=this._y,o=e-n,a=i-r;this._x=e,this._y=i;var s=this.target;if(s){var l=s.position;l[0]+=o,l[1]+=a,s.dirty();}d.stop(t.event),this.trigger("pan",o,a,n,r,e,i);}}function o(t){this._dragging=!1;}function a(t){var e=t.wheelDelta>0?1.1:1/1.1;l.call(this,t,e,t.offsetX,t.offsetY);}function s(t){if(!f.isTaken(this._zr,"globalPan")){var e=t.pinchScale>1?1.1:1/1.1;l.call(this,t,e,t.pinchX,t.pinchY);}}function l(t,e,i,n){if(this.containsPoint&&this.containsPoint(i,n)){d.stop(t.event);var r=this.target,o=this.zoomLimit;if(r){var a=r.position,s=r.scale,l=this.zoom=this.zoom||1;if(l*=e,o){var u=o.min||0,h=o.max||1/0;l=Math.max(Math.min(h,l),u);}var c=l/this.zoom;this.zoom=l,a[0]-=(i-a[0])*(c-1),a[1]-=(n-a[1])*(c-1),s[0]*=c,s[1]*=c,r.dirty();}this.trigger("zoom",e,i,n);}}function u(t,e){this.target=e,this.containsPoint,this.zoomLimit,this.zoom,this._zr=t;var i=c.bind,l=i(n,this),u=i(r,this),d=i(o,this),f=i(a,this),p=i(s,this);h.call(this),this.setContainsPoint=function(t){this.containsPoint=t;},this.enable=function(e){this.disable(),null==e&&(e=!0),(e===!0||"move"===e||"pan"===e)&&(t.on("mousedown",l),t.on("mousemove",u),t.on("mouseup",d)),(e===!0||"scale"===e||"zoom"===e)&&(t.on("mousewheel",f),t.on("pinch",p));},this.disable=function(){t.off("mousedown",l),t.off("mousemove",u),t.off("mouseup",d),t.off("mousewheel",f),t.off("pinch",p);},this.dispose=this.disable,this.isDragging=function(){return this._dragging;},this.isPinching=function(){return this._pinching;};}var h=i(33),c=i(4),d=i(87),f=i(176);c.mixin(u,h),t.exports=u;},function(t,e,i){function n(t){return t[r]||(t[r]={});}var r="\x00_ec_interaction_mutex",o={take:function take(t,e,i){var r=n(t);r[e]=i;},release:function release(t,e,i){var r=n(t),o=r[e];o===i&&(r[e]=null);},isTaken:function isTaken(t,e){return!!n(t)[e];}};i(1).registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),t.exports=o;},function(t,e,i){var n=i(4),r=i(178),o=i(1);o.registerAction({type:"geoRoam",event:"geoRoam",update:"updateLayout"},function(t,e){var i=t.componentType||"series";e.eachComponent({mainType:i,query:t},function(e){var o=e.coordinateSystem;if("geo"===o.type){var a=r.updateCenterAndZoom(o,t,e.get("scaleLimit"));e.setCenter&&e.setCenter(a.center),e.setZoom&&e.setZoom(a.zoom),"series"===i&&n.each(e.seriesGroup,function(t){t.setCenter(a.center),t.setZoom(a.zoom);});}});});},function(t,e){var i={};i.updateCenterAndZoom=function(t,e,i){var n=t.getZoom(),r=t.getCenter(),o=e.zoom,a=t.dataToPoint(r);if(null!=e.dx&&null!=e.dy){a[0]-=e.dx,a[1]-=e.dy;var r=t.pointToData(a);t.setCenter(r);}if(null!=o){if(i){var s=i.min||0,l=i.max||1/0;o=Math.max(Math.min(n*o,l),s)/n;}t.scale[0]*=o,t.scale[1]*=o;var u=t.position,h=(e.originX-u[0])*(o-1),c=(e.originY-u[1])*(o-1);u[0]-=h,u[1]-=c,t.updateTransform();var r=t.pointToData(a);t.setCenter(r),t.setZoom(o*n);}return{center:t.getCenter(),zoom:t.getZoom()};},t.exports=i;},function(t,e,i){var n=i(4);t.exports=function(t){var e={};t.eachSeriesByType("map",function(i){var r=i.get("map");if(!e[r]){var o={};n.each(i.seriesGroup,function(e){var i=e.coordinateSystem,n=e.originalData;e.get("showLegendSymbol")&&t.getComponent("legend")&&n.each("value",function(t,e){var r=n.getName(e),a=i.getRegion(r);if(a&&!isNaN(t)){var s=o[r]||0,l=i.dataToPoint(a.center);o[r]=s+1,n.setItemLayout(e,{point:l,offset:s});}});});var a=i.getData();a.each(function(t){var e=a.getName(t),i=a.getItemLayout(t)||{};i.showLabel=!o[e],a.setItemLayout(t,i);}),e[r]=!0;}});};},function(t,e){t.exports=function(t){t.eachSeriesByType("map",function(t){var e=t.get("color"),i=t.getModel("itemStyle.normal"),n=i.get("areaColor"),r=i.get("color")||e[t.seriesIndex%e.length];t.getData().setVisual({areaColor:n,color:r});});};},function(t,e,i){function n(t,e){for(var i={},n=["value"],r=0;r<t.length;r++){t[r].each(n,function(e,n){var o=t[r].getName(n);i[o]=i[o]||[],isNaN(e)||i[o].push(e);});}return t[0].map(n,function(n,r){for(var o=t[0].getName(r),a=0,s=1/0,l=-(1/0),u=i[o].length,h=0;u>h;h++){s=Math.min(s,i[o][h]),l=Math.max(l,i[o][h]),a+=i[o][h];}var c;return c="min"===e?s:"max"===e?l:"average"===e?a/u:a,0===u?NaN:c;});}var r=i(4);t.exports=function(t){var e={};t.eachSeriesByType("map",function(t){var i=t.get("map");e[i]=e[i]||[],e[i].push(t);}),r.each(e,function(t,e){for(var i=n(r.map(t,function(t){return t.getData();}),t[0].get("mapValueCalculation")),o=0;o<t.length;o++){t[o].originalData=t[o].getData();}for(var o=0;o<t.length;o++){t[o].seriesGroup=t,t[o].needsDrawMap=0===o,t[o].setData(i.cloneShallow()),t[o].mainSeries=t[0];}});};},function(t,e,i){var n=i(4);t.exports=function(t){var e=[];n.each(t.series,function(t){"map"===t.type&&e.push(t);}),n.each(e,function(t){t.map=t.map||t.mapType,n.defaults(t,t.mapLocation);});};},function(t,e,i){var n=i(1);i(184),i(188),i(191),n.registerVisual(i(192)),n.registerLayout(i(194));},function(t,e,i){function n(t,e){var i=0;s.each(t.children,function(t){n(t,e);var r=t.value;s.isArray(r)&&(r=r[0]),i+=r;});var r=t.value;e>=0&&(s.isArray(r)?r=r[0]:t.value=new Array(e)),(null==r||isNaN(r))&&(r=i),0>r&&(r=0),e>=0?t.value[0]=r:t.value=r;}function r(t,e){var i=e.get("color");if(i){t=t||[];var n;if(s.each(t,function(t){var e=new l(t),i=e.get("color");(e.get("itemStyle.normal.color")||i&&"none"!==i)&&(n=!0);}),!n){var r=t[0]||(t[0]={});r.color=i.slice();}return t;}}var o=i(28),a=i(185),s=i(4),l=i(12),u=i(6),h=i(187),c=u.encodeHTML,d=u.addCommas;t.exports=o.extend({type:"series.treemap",dependencies:["grid","polar"],_viewRoot:null,defaultOption:{progressive:0,hoverLayerThreshold:1/0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"",visualDimension:0,zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{normal:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}}},label:{normal:{show:!0,position:"inside",textStyle:{color:"#fff",ellipsis:!0}}},itemStyle:{normal:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{}},color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function getInitialData(t,e){var i=t.data||[],o=t.name;null==o&&(o=t.name);var l={name:o,children:t.data},u=(i[0]||{}).value;n(l,s.isArray(u)?u.length:-1);var h=t.levels||[];return h=t.levels=r(h,e),a.createTree(l,this,h).data;},optionUpdated:function optionUpdated(){this.resetViewRoot();},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=d(s.isArray(i)?i[0]:i),r=e.getName(t);return c(r)+": "+n;},getDataParams:function getDataParams(t){var e=o.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=h.wrapTreePathInfo(i,this),e;},setLayoutInfo:function setLayoutInfo(t){this.layoutInfo=this.layoutInfo||{},s.extend(this.layoutInfo,t);},mapIdToIndex:function mapIdToIndex(t){var e=this._idIndexMap;e||(e=this._idIndexMap={},this._idIndexMapCount=0);var i=e[t];return null==i&&(e[t]=i=this._idIndexMapCount++),i;},getViewRoot:function getViewRoot(){return this._viewRoot;},resetViewRoot:function resetViewRoot(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getData().tree.root;(!t||t!==e&&!e.contains(t))&&(this._viewRoot=e);}});},function(t,e,i){function n(t,e){this.root,this.data,this._nodes=[],this.hostModel=t,this.levelModels=o.map(e||[],function(e){return new a(e,t,t.ecModel);});}function r(t,e){var i=e.children;t.parentNode!==e&&(i.push(t),t.parentNode=e);}var o=i(4),a=i(12),s=i(97),l=i(186),u=i(102),h=function h(t,e){this.name=t||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=e;};h.prototype={constructor:h,isRemoved:function isRemoved(){return this.dataIndex<0;},eachNode:function eachNode(t,e,i){"function"==typeof t&&(i=e,e=t,t=null),t=t||{},o.isString(t)&&(t={order:t});var n,r=t.order||"preorder",a=this[t.attr||"children"];"preorder"===r&&(n=e.call(i,this));for(var s=0;!n&&s<a.length;s++){a[s].eachNode(t,e,i);}"postorder"===r&&e.call(i,this);},updateDepthAndHeight:function updateDepthAndHeight(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height);}this.height=e+1;},getNodeById:function getNodeById(t){if(this.getId()===t)return this;for(var e=0,i=this.children,n=i.length;n>e;e++){var r=i[e].getNodeById(t);if(r)return r;}},contains:function contains(t){if(t===this)return!0;for(var e=0,i=this.children,n=i.length;n>e;e++){var r=i[e].contains(t);if(r)return r;}},getAncestors:function getAncestors(t){for(var e=[],i=t?this:this.parentNode;i;){e.push(i),i=i.parentNode;}return e.reverse(),e;},getValue:function getValue(t){var e=this.hostTree.data;return e.get(e.getDimension(t||"value"),this.dataIndex);},setLayout:function setLayout(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e);},getLayout:function getLayout(){return this.hostTree.data.getItemLayout(this.dataIndex);},getModel:function getModel(t){if(!(this.dataIndex<0)){var e=this.hostTree,i=e.data.getItemModel(this.dataIndex),n=this.getLevelModel();return i.getModel(t,(n||e.hostModel).getModel(t));}},getLevelModel:function getLevelModel(){return(this.hostTree.levelModels||[])[this.depth];},setVisual:function setVisual(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e);},getVisual:function getVisual(t,e){return this.hostTree.data.getItemVisual(this.dataIndex,t,e);},getRawIndex:function getRawIndex(){return this.hostTree.data.getRawIndex(this.dataIndex);},getId:function getId(){return this.hostTree.data.getId(this.dataIndex);}},n.prototype={constructor:n,type:"tree",eachNode:function eachNode(t,e,i){this.root.eachNode(t,e,i);},getNodeByDataIndex:function getNodeByDataIndex(t){var e=this.data.getRawIndex(t);return this._nodes[e];},getNodeByName:function getNodeByName(t){return this.root.getNodeByName(t);},update:function update(){for(var t=this.data,e=this._nodes,i=0,n=e.length;n>i;i++){e[i].dataIndex=-1;}for(var i=0,n=t.count();n>i;i++){e[t.getRawIndex(i)].dataIndex=i;}},clearLayouts:function clearLayouts(){this.data.clearItemLayouts();}},n.createTree=function(t,e,i){function o(t,e){c.push(t);var i=new h(t.name,a);e?r(i,e):a.root=i,a._nodes.push(i);var n=t.children;if(n)for(var s=0;s<n.length;s++){o(n[s],i);}}var a=new n(e,i),c=[];o(t),a.root.updateDepthAndHeight(0);var d=u([{name:"value"}],c),f=new s(d,e);return f.initData(c),l({mainData:f,struct:a,structAttr:"tree"}),a.update(),a;},t.exports=n;},function(t,e,i){function n(t){var e=t.mainData,i=t.datas;i||(i={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,u(e,i,t),d(i,function(i){d(e.TRANSFERABLE_METHODS,function(e){i.wrapMethod(e,c.curry(r,t));});}),e.wrapMethod("cloneShallow",c.curry(a,t)),d(e.CHANGABLE_METHODS,function(i){e.wrapMethod(i,c.curry(o,t));}),c.assert(i[e.dataType]===e);}function r(t,e){if(l(this)){var i=c.extend({},this[f]);i[this.dataType]=e,u(e,i,t);}else h(e,this.dataType,this[p],t);return e;}function o(t,e){return t.struct&&t.struct.update(this),e;}function a(t,e){return d(e[f],function(i,n){i!==e&&h(i.cloneShallow(),n,e,t);}),e;}function s(t){var e=this[p];return null==t||null==e?e:e[f][t];}function l(t){return t[p]===t;}function u(t,e,i){t[f]={},d(e,function(e,n){h(e,n,t,i);});}function h(t,e,i,n){i[f][e]=t,t[p]=i,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=s;}var c=i(4),d=c.each,f="\x00__link_datas",p="\x00__link_mainData";t.exports=n;},function(t,e,i){var n=i(4),r={retrieveTargetInfo:function retrieveTargetInfo(t,e){if(t&&("treemapZoomToNode"===t.type||"treemapRootToNode"===t.type)){var i=e.getData().tree.root,n=t.targetNode;if(n&&i.contains(n))return{node:n};var r=t.targetNodeId;if(null!=r&&(n=i.getNodeById(r)))return{node:n};}},getPathToRoot:function getPathToRoot(t){for(var e=[];t;){t=t.parentNode,t&&e.push(t);}return e.reverse();},aboveViewRoot:function aboveViewRoot(t,e){var i=r.getPathToRoot(t);return n.indexOf(i,e)>=0;},wrapTreePathInfo:function wrapTreePathInfo(t,e){for(var i=[];t;){var n=t.dataIndex;i.push({name:t.name,dataIndex:n,value:e.getRawValue(n)}),t=t.parentNode;}return i.reverse(),i;}};t.exports=r;},function(t,e,i){function n(){return{nodeGroup:[],background:[],content:[]};}function r(t,e,i,n,r,l,u,h,c,d){function f(e){E.dataIndex=u.dataIndex,E.seriesIndex=t.seriesIndex;var i=T.borderWidth,n=Math.max(A-2*i,0),r=Math.max(L-2*i,0);E.culling=!0,E.setShape({x:i,y:i,width:n,height:r});var o=u.getVisual("color",!0);p(E,function(){var t={fill:o},e=u.getModel("itemStyle.emphasis").getItemStyle();g(t,e,o,n,r),E.setStyle(t),s.setHoverStyle(E,e);}),e.add(E);}function p(t,e){C?!t.invisible&&l.push(t):(e(),t.__tmWillVisible||(t.invisible=!1));}function g(e,i,n,r,o){var a=u.getModel(),s=a.get("name");if(T.isLeafRoot){var l=t.get("drillDownIcon",!0);s=l?l+" "+s:s;}y(s,e,a,_,n,r,o),y(s,i,a,b,n,r,o);}function y(t,e,i,n,r,o,a){var l=i.getModel(n),u=l.getModel("textStyle");s.setText(e,l,r),e.textAlign=u.get("align"),e.textVerticalAlign=u.get("baseline");var h=u.getTextRect(t);!l.getShallow("show")||h.height>a?e.text="":h.width>o?e.text=u.get("ellipsis")?u.truncateText(t,o,null,{minChar:2}):"":e.text=t;}function x(t,n,a,s){var l=null!=P&&i[t][P],u=r[t];return l?(i[t][P]=null,w(u,l,t)):C||(l=new n({z:o(a,s)}),l.__tmDepth=a,l.__tmStorageName=t,I(u,l,t)),e[t][D]=l;}function w(t,e,i){var n=t[D]={};n.old="nodeGroup"===i?e.position.slice():a.extend({},e.shape);}function I(t,e,i){var o=t[D]={},a=u.parentNode;if(a&&(!n||"drillDown"===n.direction)){var s=0,l=0,h=r.background[a.getRawIndex()];!n&&h&&h.old&&(s=h.old.width,l=h.old.height),o.old="nodeGroup"===i?[0,l]:{x:s,y:l,width:0,height:0};}o.fadein="nodeGroup"!==i;}if(u){var T=u.getLayout();if(T&&T.isInView){var A=T.width,L=T.height,C=T.invisible,D=u.getRawIndex(),P=h&&h.getRawIndex(),k=x("nodeGroup",m);if(k){if(c.add(k),k.attr("position",[T.x||0,T.y||0]),k.__tmNodeWidth=A,k.__tmNodeHeight=L,T.isAboveViewRoot)return k;var z=x("background",v,d,S);z&&(z.setShape({x:0,y:0,width:A,height:L}),p(z,function(){z.setStyle("fill",u.getVisual("borderColor",!0));}),k.add(z));var O=u.viewChildren;if(!O||!O.length){var E=x("content",v,d,M);E&&f(k);}return k;}}}}function o(t,e){var i=t*w+e;return(i-1)/i;}var a=i(4),s=i(43),l=i(98),u=i(187),h=i(189),c=i(175),d=i(9),f=i(11),p=i(190),g=a.bind,m=s.Group,v=s.Rect,y=a.each,x=3,_=["label","normal"],b=["label","emphasis"],w=10,S=1,M=2;t.exports=i(1).extendChartView({type:"treemap",init:function init(t,e){this._containerGroup,this._storage=n(),this._oldTree,this._breadcrumb,this._controller,this._state="ready",this._mayClick;},render:function render(t,e,i,n){var r=e.findComponents({mainType:"series",subType:"treemap",query:n});if(!(a.indexOf(r,t)<0)){this.seriesModel=t,this.api=i,this.ecModel=e;var o=u.retrieveTargetInfo(n,t),s=n&&n.type,l=t.layoutInfo,h=!this._oldTree,c=this._storage,d="treemapRootToNode"===s&&o&&c?{rootNodeGroup:c.nodeGroup[o.node.getRawIndex()],direction:n.direction}:null,f=this._giveContainerGroup(l),p=this._doRender(f,t,d);h||s&&"treemapZoomToNode"!==s&&"treemapRootToNode"!==s?p.renderFinally():this._doAnimation(f,p,t,d),this._resetController(i),this._renderBreadcrumb(t,i,o);}},_giveContainerGroup:function _giveContainerGroup(t){var e=this._containerGroup;return e||(e=this._containerGroup=new m(),this._initEvents(e),this.group.add(e)),e.attr("position",[t.x,t.y]),e;},_doRender:function _doRender(t,e,i){function o(t,e,i,n,r){function s(t){return t.getId();}function u(a,s){var l=null!=a?t[a]:null,u=null!=s?e[s]:null,h=m(l,u,i,r);h&&o(l&&l.viewChildren||[],u&&u.viewChildren||[],h,n,r+1);}n?(e=t,y(t,function(t,e){!t.isRemoved()&&u(e,e);})):new l(e,t,s,s).add(u).update(u).remove(a.curry(u,null)).execute();}function s(t){var e=n();return t&&y(t,function(t,i){var n=e[i];y(t,function(t){t&&(n.push(t),t.__tmWillDelete=1);});}),e;}function u(){y(v,function(t){y(t,function(t){t.parent&&t.parent.remove(t);});}),y(g,function(t){t.invisible=!0,t.dirty();});}var h=e.getData().tree,c=this._oldTree,d=n(),f=n(),p=this._storage,g=[],m=a.curry(r,e,f,p,i,d,g);o(h.root?[h.root]:[],c&&c.root?[c.root]:[],t,h===c||!c,0);var v=s(p);return this._oldTree=h,this._storage=f,{lastsForAnimation:d,willDeleteEls:v,renderFinally:u};},_doAnimation:function _doAnimation(t,e,i,n){if(i.get("animation")){var r=i.get("animationDurationUpdate"),o=i.get("animationEasing"),s=p.createWrap();y(e.willDeleteEls,function(t,e){y(t,function(t,i){if(!t.invisible){var a,l=t.parent;if(n&&"drillDown"===n.direction)a=l===n.rootNodeGroup?{shape:{x:0,y:0,width:l.__tmNodeWidth,height:l.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var u=0,h=0;l.__tmWillDelete||(u=l.__tmNodeWidth/2,h=l.__tmNodeHeight/2),a="nodeGroup"===e?{position:[u,h],style:{opacity:0}}:{shape:{x:u,y:h,width:0,height:0},style:{opacity:0}};}a&&s.add(t,a,r,o);}});}),y(this._storage,function(t,i){y(t,function(t,n){var l=e.lastsForAnimation[i][n],u={};l&&("nodeGroup"===i?l.old&&(u.position=t.position.slice(),t.attr("position",l.old)):(l.old&&(u.shape=a.extend({},t.shape),t.setShape(l.old)),l.fadein?(t.setStyle("opacity",0),u.style={opacity:1}):1!==t.style.opacity&&(u.style={opacity:1})),s.add(t,u,r,o));});},this),this._state="animating",s.done(g(function(){this._state="ready",e.renderFinally();},this)).start();}},_resetController:function _resetController(t){var e=this._controller;e||(e=this._controller=new c(t.getZr()),e.enable(this.seriesModel.get("roam")),e.on("pan",g(this._onPan,this)),e.on("zoom",g(this._onZoom,this)));var i=new d(0,0,t.getWidth(),t.getHeight());e.setContainsPoint(function(t,e){return i.contain(t,e);});},_clearController:function _clearController(){var t=this._controller;t&&(t.dispose(),t=null);},_onPan:function _onPan(t,e){if(this._mayClick=!1,"animating"!==this._state&&(Math.abs(t)>x||Math.abs(e)>x)){var i=this.seriesModel.getData().tree.root;if(!i)return;var n=i.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+t,y:n.y+e,width:n.width,height:n.height}});}},_onZoom:function _onZoom(t,e,i){if(this._mayClick=!1,"animating"!==this._state){var n=this.seriesModel.getData().tree.root;if(!n)return;var r=n.getLayout();if(!r)return;var o=new d(r.x,r.y,r.width,r.height),a=this.seriesModel.layoutInfo;e-=a.x,i-=a.y;var s=f.create();f.translate(s,s,[-e,-i]),f.scale(s,s,[t,t]),f.translate(s,s,[e,i]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}});}},_initEvents:function _initEvents(t){function e(t){var e=this.seriesModel.get("nodeClick",!0);if(e){var i=this.findTarget(t.offsetX,t.offsetY);if(i){var n=i.node;if(n.getLayout().isLeafRoot)this._rootToNode(i);else if("zoomToNode"===e)this._zoomToNode(i);else if("link"===e){var r=n.hostTree.data.getItemModel(n.dataIndex),o=r.get("link",!0),a=r.get("target",!0)||"blank";o&&window.open(o,a);}}}}t.on("mousedown",function(t){"ready"===this._state&&(this._mayClick=!0);},this),t.on("mouseup",function(t){this._mayClick&&(this._mayClick=!1,"ready"===this._state&&e.call(this,t));},this);},_renderBreadcrumb:function _renderBreadcrumb(t,e,i){function n(e){"animating"!==this._state&&(u.aboveViewRoot(t.getViewRoot(),e)?this._rootToNode({node:e}):this._zoomToNode({node:e}));}i||(i=null!=t.get("leafDepth",!0)?{node:t.getViewRoot()}:this.findTarget(e.getWidth()/2,e.getHeight()/2),i||(i={node:t.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new h(this.group))).render(t,e,i.node,g(n,this));},remove:function remove(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=n(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove();},dispose:function dispose(){this._clearController();},_zoomToNode:function _zoomToNode(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},_rootToNode:function _rootToNode(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},findTarget:function findTarget(t,e){var i,n=this.seriesModel.getViewRoot();return n.eachNode({attr:"viewChildren",order:"preorder"},function(n){var r=this._storage.background[n.getRawIndex()];if(r){var o=r.transformCoordToLocal(t,e),a=r.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;i={node:n,offsetX:o[0],offsetY:o[1]};}},this),i;}});},function(t,e,i){function n(t){this.group=new a.Group(),t.add(this.group);}function r(t,e,i,n,r,o){var a=[[r?t:t-d,e],[t+i,e],[t+i,e+n],[r?t:t-d,e+n]];return!o&&a.splice(2,0,[t+i+d,e+n/2]),!r&&a.push([t,e+n/2]),a;}function o(t,e,i){t.eventData={componentType:"series",componentSubType:"treemap",seriesIndex:e.componentIndex,seriesName:e.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:i&&i.dataIndex,name:i&&i.name},treePathInfo:i&&u.wrapTreePathInfo(i,e)};}var a=i(43),s=i(21),l=i(4),u=i(187),h=8,c=8,d=5;n.prototype={constructor:n,render:function render(t,e,i,n){var r=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),r.get("show")&&i){var a=r.getModel("itemStyle.normal"),l=a.getModel("textStyle"),u={pos:{left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(i,u,l),this._renderContent(t,u,a,l,n),s.positionGroup(o,u.pos,u.box);}},_prepare:function _prepare(t,e,i){for(var n=t;n;n=n.parentNode){var r=n.getModel().get("name"),o=i.getTextRect(r),a=Math.max(o.width+2*h,e.emptyItemWidth);e.totalWidth+=a+c,e.renderList.push({node:n,text:r,width:a});}},_renderContent:function _renderContent(t,e,i,n,u){for(var h=0,d=e.emptyItemWidth,f=t.get("breadcrumb.height"),p=s.getAvailableSize(e.pos,e.box),g=e.totalWidth,m=e.renderList,v=m.length-1;v>=0;v--){var y=m[v],x=y.node,_=y.width,b=y.text;g>p.width&&(g-=_-d,_=d,b="");var w=new a.Polygon({shape:{points:r(h,0,_,f,v===m.length-1,0===v)},style:l.defaults(i.getItemStyle(),{lineJoin:"bevel",text:b,textFill:n.getTextColor(),textFont:n.getFont()}),z:10,onclick:l.curry(u,x)});this.group.add(w),o(w,t,x),h+=_+c;}},remove:function remove(){this.group.removeAll();}},t.exports=n;},function(t,e,i){function n(){var t,e=[],i={};return{add:function add(t,n,o,a,s){return r.isString(a)&&(s=a,a=0),i[t.id]?!1:(i[t.id]=1,e.push({el:t,target:n,time:o,delay:a,easing:s}),!0);},done:function done(e){return t=e,this;},start:function start(){function n(){r--,r||(e.length=0,i={},t&&t());}for(var r=e.length,o=0,a=e.length;a>o;o++){var s=e[o];s.el.animateTo(s.target,s.time,s.delay,s.easing,n);}return this;}};}var r=i(4);t.exports={createWrap:n};},function(t,e,i){for(var n=i(1),r=i(187),o=function o(){},a=["treemapZoomToNode","treemapRender","treemapMove"],s=0;s<a.length;s++){n.registerAction({type:a[s],update:"updateView"},o);}n.registerAction({type:"treemapRootToNode",update:"updateView"},function(t,e){function i(e,i){var n=r.retrieveTargetInfo(t,e);if(n){var o=e.getViewRoot();o&&(t.direction=r.aboveViewRoot(o,n.node)?"rollUp":"drillDown"),e.resetViewRoot(n.node);}}e.eachComponent({mainType:"series",subType:"treemap",query:t},i);});},function(t,e,i){function n(t,e,i,s,u,c){var d=t.getModel(),p=t.getLayout();if(p&&!p.invisible&&p.isInView){var m,v=t.getModel(g),y=i[t.depth],x=r(v,e,y,s),_=v.get("borderColor"),b=v.get("borderColorSaturation");null!=b&&(m=o(x,t),_=a(b,m)),t.setVisual("borderColor",_);var w=t.viewChildren;if(w&&w.length){var S=l(t,d,p,v,x,w);f.each(w,function(t,e){if(t.depth>=u.length||t===u[t.depth]){var r=h(d,x,t,e,S,c);n(t,r,i,s,u,c);}});}else m=o(x,t),t.setVisual("color",m);}}function r(t,e,i,n){var r=f.extend({},e);return f.each(["color","colorAlpha","colorSaturation"],function(o){var a=t.get(o,!0);null==a&&i&&(a=i[o]),null==a&&(a=e[o]),null==a&&(a=n.get(o)),null!=a&&(r[o]=a);}),r;}function o(t){var e=s(t,"color");if(e){var i=s(t,"colorAlpha"),n=s(t,"colorSaturation");return n&&(e=d.modifyHSL(e,null,null,n)),i&&(e=d.modifyAlpha(e,i)),e;}}function a(t,e){return null!=e?d.modifyHSL(e,null,null,t):null;}function s(t,e){var i=t[e];return null!=i&&"none"!==i?i:void 0;}function l(t,e,i,n,r,o){if(o&&o.length){var a=u(e,"color")||null!=r.color&&"none"!==r.color&&(u(e,"colorAlpha")||u(e,"colorSaturation"));if(a){var s=e.get("colorMappingBy"),l={type:a.name,dataExtent:i.dataExtent,visual:a.range};"color"!==l.type||"index"!==s&&"id"!==s?l.mappingMethod="linear":(l.mappingMethod="category",l.loop=!0);var h=new c(l);return h.__drColorMappingBy=s,h;}}}function u(t,e){var i=t.get(e);return p(i)&&i.length?{name:e,range:i}:null;}function h(t,e,i,n,r,o){var a=f.extend({},e);if(r){var s=r.type,l="color"===s&&r.__drColorMappingBy,u="index"===l?n:"id"===l?o.mapIdToIndex(i.getId()):i.getValue(t.get("visualDimension"));a[s]=r.mapValueToVisual(u);}return a;}var c=i(193),d=i(39),f=i(4),p=f.isArray,g="itemStyle.normal";t.exports=function(t,e,i){var r={mainType:"series",subType:"treemap",query:i};t.eachComponent(r,function(t){var e=t.getData().tree,i=e.root,r=t.getModel(g);if(!i.isRemoved()){var o=f.map(e.levelModels,function(t){return t?t.get(g):null;});n(i,{},o,r,t.getViewRoot().getAncestors(),t);}});};},function(t,e,i){function n(t){var e=t.pieceList;t.hasSpecialVisual=!1,p.each(e,function(e,i){e.originIndex=i,null!=e.visual&&(t.hasSpecialVisual=!0);});}function r(t){var e=t.categories,i=t.visual,n=t.categoryMap={};if(v(e,function(t,e){n[t]=e;}),!p.isArray(i)){var r=[];p.isObject(i)?v(i,function(t,e){var i=n[e];r[null!=i?i:x]=t;}):r[x]=i,i=t.visual=r;}for(var o=e.length-1;o>=0;o--){null==i[o]&&(delete n[e[o]],e.pop());}}function o(t,e){var i=t.visual,n=[];p.isObject(i)?v(i,function(t){n.push(t);}):null!=i&&n.push(i);var r={color:1,symbol:1};e||1!==n.length||r.hasOwnProperty(t.type)||(n[1]=n[0]),t.visual=n;}function a(t){return{applyVisual:function applyVisual(e,i,n){e=this.mapValueToVisual(e),n("color",t(i("color"),e));},_doMap:c([0,1])};}function s(t,e){var i=this.option.visual;return i[Math.round(m(e,[0,1],[0,i.length-1],!0))]||{};}function l(t){return function(e,i,n){n(t,this.mapValueToVisual(e));};}function u(t){var e=this.option.visual;return e[this.option.loop&&t!==x?t%e.length:t];}function h(){return this.option.visual[0];}function c(t){return{linear:function linear(e){return m(e,t,this.option.visual,!0);},category:u,piecewise:function piecewise(e,i){var n=d.call(this,i);return null==n&&(n=m(e,t,this.option.visual,!0)),n;},fixed:h};}function d(t){var e=this.option,i=e.pieceList;if(e.hasSpecialVisual){var n=_.findPieceIndex(t,i),r=i[n];if(r&&r.visual)return r.visual[this.type];}}function f(t,e,i){return t?i>=e:i>e;}var p=i(4),g=i(39),m=i(7).linearMap,v=p.each,y=p.isObject,x=-1,_=function _(t){var e=t.mappingMethod,i=t.type,a=this.option=p.clone(t);this.type=i,this.mappingMethod=e,this._normalizeData=w[e];var s=b[i];this.applyVisual=s.applyVisual,this.getColorMapper=s.getColorMapper,this._doMap=s._doMap[e],"piecewise"===e?(o(a),n(a)):"category"===e?a.categories?r(a):o(a,!0):(p.assert("linear"!==e||a.dataExtent),o(a));};_.prototype={constructor:_,mapValueToVisual:function mapValueToVisual(t){var e=this._normalizeData(t);return this._doMap(e,t);},getNormalizer:function getNormalizer(){return p.bind(this._normalizeData,this);}};var b=_.visualHandlers={color:{applyVisual:l("color"),getColorMapper:function getColorMapper(){var t=this.option,e=p.map(t.visual,g.parse);return p.bind("category"===t.mappingMethod?function(t,e){return!e&&(t=this._normalizeData(t)),u(this,t);}:function(t,i,n){var r=!!n;return!i&&(t=this._normalizeData(t)),n=g.fastMapToColor(t,e,n),r?n:p.stringify(n,"rgba");},this);},_doMap:{linear:function linear(t){return g.mapToColor(t,this.option.visual);},category:u,piecewise:function piecewise(t,e){var i=d.call(this,e);return null==i&&(i=g.mapToColor(t,this.option.visual)),i;},fixed:h}},colorHue:a(function(t,e){return g.modifyHSL(t,e);}),colorSaturation:a(function(t,e){return g.modifyHSL(t,null,e);}),colorLightness:a(function(t,e){return g.modifyHSL(t,null,null,e);}),colorAlpha:a(function(t,e){return g.modifyAlpha(t,e);}),opacity:{applyVisual:l("opacity"),_doMap:c([0,1])},symbol:{applyVisual:function applyVisual(t,e,i){var n=this.mapValueToVisual(t);if(p.isString(n))i("symbol",n);else if(y(n))for(var r in n){n.hasOwnProperty(r)&&i(r,n[r]);}},_doMap:{linear:s,category:u,piecewise:function piecewise(t,e){var i=d.call(this,e);return null==i&&(i=s.call(this,t)),i;},fixed:h}},symbolSize:{applyVisual:l("symbolSize"),_doMap:c([0,1])}},w={linear:function linear(t){return m(t,this.option.dataExtent,[0,1],!0);},piecewise:function piecewise(t){var e=this.option.pieceList,i=_.findPieceIndex(t,e,!0);return null!=i?m(i,[0,e.length-1],[0,1],!0):void 0;},category:function category(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?x:e;},fixed:p.noop};_.addVisualHandler=function(t,e){b[t]=e;},_.isValidType=function(t){return b.hasOwnProperty(t);},_.eachVisual=function(t,e,i){p.isObject(t)?p.each(t,e,i):e.call(i,t);},_.mapVisual=function(t,e,i){var n,r=p.isArray(t)?[]:p.isObject(t)?{}:(n=!0,null);return _.eachVisual(t,function(t,o){var a=e.call(i,t,o);n?r=a:r[o]=a;}),r;},_.retrieveVisuals=function(t){var e,i={};return t&&v(b,function(n,r){t.hasOwnProperty(r)&&(i[r]=t[r],e=!0);}),e?i:null;},_.prepareVisualTypes=function(t){if(y(t)){var e=[];v(t,function(t,i){e.push(i);}),t=e;}else{if(!p.isArray(t))return[];t=t.slice();}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1;}),t;},_.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e;},_.findPieceIndex=function(t,e,i){function n(e,i){var n=Math.abs(e-t);o>n&&(o=n,r=i);}for(var r,o=1/0,a=0,s=e.length;s>a;a++){var l=e[a].value;if(null!=l){if(l===t)return a;i&&n(l,a);}}for(var a=0,s=e.length;s>a;a++){var u=e[a],h=u.interval,c=u.close;if(h){if(h[0]===-(1/0)){if(f(c[1],t,h[1]))return a;}else if(h[1]===1/0){if(f(c[0],h[0],t))return a;}else if(f(c[0],h[0],t)&&f(c[1],t,h[1]))return a;i&&n(h[0],a),i&&n(h[1],a);}}return i?t===1/0?e.length-1:t===-(1/0)?0:r:void 0;},t.exports=_;},function(t,e,i){function n(t,e,i){var n={mainType:"series",subType:"treemap",query:i};t.eachComponent(n,function(t){var n=e.getWidth(),o=e.getHeight(),a=t.option,s=a.size||[],l=b(w(a.width,s[0]),n),u=b(w(a.height,s[1]),o),h=m.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),g=i&&i.type,x=v.retrieveTargetInfo(i,t),_="treemapRender"===g||"treemapMove"===g?i.rootRect:null,M=t.getViewRoot(),I=v.getPathToRoot(M);if("treemapMove"!==g){var T="treemapZoomToNode"===g?c(t,x,M,l,u):_?[_.width,_.height]:[l,u],A=a.sort;A&&"asc"!==A&&"desc"!==A&&(A="desc");var L={squareRatio:a.squareRatio,sort:A,leafDepth:a.leafDepth};M.hostTree.clearLayouts();var C={x:0,y:0,width:T[0],height:T[1],area:T[0]*T[1]};M.setLayout(C),r(M,L,!1,0);var C=M.getLayout();S(I,function(t,e){var i=(I[e+1]||M).getValue();t.setLayout(p.extend({dataExtent:[i,i],borderWidth:0},C));});}var D=t.getData().tree.root;D.setLayout(d(h,_,x),!0),t.setLayoutInfo(h),f(D,new y(-h.x,-h.y,n,o),I,M,0);});}function r(t,e,i,n){var a,s;if(!t.isRemoved()){var l=t.getLayout();a=l.width,s=l.height;var c=t.getModel("itemStyle.normal"),d=c.get("borderWidth"),f=c.get("gapWidth")/2,p=d-f,g=t.getModel();t.setLayout({borderWidth:d},!0),a=x(a-2*p,0),s=x(s-2*p,0);var m=a*s,v=o(t,g,m,e,i,n);if(v.length){var y={x:p,y:p,width:a,height:s},b=_(a,s),w=1/0,S=[];S.area=0;for(var M=0,I=v.length;I>M;){var T=v[M];S.push(T),S.area+=T.getLayout().area;var A=u(S,b,e.squareRatio);w>=A?(M++,w=A):(S.area-=S.pop().getLayout().area,h(S,b,y,f,!1),b=_(y.width,y.height),S.length=S.area=0,w=1/0);}if(S.length&&h(S,b,y,f,!0),!i){var L=g.get("childrenVisibleMin");null!=L&&L>m&&(i=!0);}for(var M=0,I=v.length;I>M;M++){r(v[M],e,i,n+1);}}}}function o(t,e,i,n,r,o){var u=t.children||[],h=n.sort;"asc"!==h&&"desc"!==h&&(h=null);var c=null!=n.leafDepth&&n.leafDepth<=o;if(r&&!c)return t.viewChildren=[];u=p.filter(u,function(t){return!t.isRemoved();}),s(u,h);var d=l(e,u,h);if(0===d.sum)return t.viewChildren=[];if(d.sum=a(e,i,d.sum,h,u),0===d.sum)return t.viewChildren=[];for(var f=0,g=u.length;g>f;f++){var m=u[f].getValue()/d.sum*i;u[f].setLayout({area:m});}return c&&(u.length&&t.setLayout({isLeafRoot:!0},!0),u.length=0),t.viewChildren=u,t.setLayout({dataExtent:d.dataExtent},!0),u;}function a(t,e,i,n,r){if(!n)return i;for(var o=t.get("visibleMin"),a=r.length,s=a,l=a-1;l>=0;l--){var u=r["asc"===n?a-l-1:l].getValue();o>u/i*e&&(s=l,i-=u);}return"asc"===n?r.splice(0,a-s):r.splice(s,a-s),i;}function s(t,e){return e&&t.sort(function(t,i){return"asc"===e?t.getValue()-i.getValue():i.getValue()-t.getValue();}),t;}function l(t,e,i){for(var n=0,r=0,o=e.length;o>r;r++){n+=e[r].getValue();}var a,s=t.get("visualDimension");if(e&&e.length){if("value"===s&&i)a=[e[e.length-1].getValue(),e[0].getValue()],"asc"===i&&a.reverse();else{var a=[1/0,-(1/0)];S(e,function(t){var e=t.getValue(s);e<a[0]&&(a[0]=e),e>a[1]&&(a[1]=e);});}}else a=[NaN,NaN];return{sum:n,dataExtent:a};}function u(t,e,i){for(var n,r=0,o=1/0,a=0,s=t.length;s>a;a++){n=t[a].getLayout().area,n&&(o>n&&(o=n),n>r&&(r=n));}var l=t.area*t.area,u=e*e*i;return l?x(u*r/l,l/(u*o)):1/0;}function h(t,e,i,n,r){var o=e===i.width?0:1,a=1-o,s=["x","y"],l=["width","height"],u=i[s[o]],h=e?t.area/e:0;(r||h>i[l[a]])&&(h=i[l[a]]);for(var c=0,d=t.length;d>c;c++){var f=t[c],p={},g=h?f.getLayout().area/h:0,m=p[l[a]]=x(h-2*n,0),v=i[s[o]]+i[l[o]]-u,y=c===d-1||g>v?v:g,b=p[l[o]]=x(y-2*n,0);p[s[a]]=i[s[a]]+_(n,m/2),p[s[o]]=u+_(n,b/2),u+=y,f.setLayout(p,!0);}i[s[a]]+=h,i[l[a]]-=h;}function c(t,e,i,n,r){var o=(e||{}).node,a=[n,r];if(!o||o===i)return a;for(var s,l=n*r,u=l*t.option.zoomToNodeRatio;s=o.parentNode;){for(var h=0,c=s.children,d=0,f=c.length;f>d;d++){h+=c[d].getValue();}var p=o.getValue();if(0===p)return a;u*=h/p;var m=s.getModel("itemStyle.normal").get("borderWidth");isFinite(m)&&(u+=4*m*m+4*m*Math.pow(u,.5)),u>g.MAX_SAFE_INTEGER&&(u=g.MAX_SAFE_INTEGER),o=s;}l>u&&(u=l);var v=Math.pow(u/l,.5);return[n*v,r*v];}function d(t,e,i){if(e)return{x:e.x,y:e.y};var n={x:0,y:0};if(!i)return n;var r=i.node,o=r.getLayout();if(!o)return n;for(var a=[o.width/2,o.height/2],s=r;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode;}return{x:t.width/2-a[0],y:t.height/2-a[1]};}function f(t,e,i,n,r){var o=t.getLayout(),a=i[r],s=a&&a===t;if(!(a&&!s||r===i.length&&t!==n)){t.setLayout({isInView:!0,invisible:!s&&!e.intersect(o),isAboveViewRoot:s},!0);var l=new y(e.x-o.x,e.y-o.y,e.width,e.height);S(t.viewChildren||[],function(t){f(t,l,i,n,r+1);});}}var p=i(4),g=i(7),m=i(21),v=i(187),y=i(9),v=i(187),x=Math.max,_=Math.min,b=g.parsePercent,w=p.retrieve,S=p.each;t.exports=n;},function(t,e,i){var n=i(1),r=i(4);i(196),i(199),i(204),n.registerProcessor(i(205)),n.registerVisual(r.curry(i(109),"graph","circle",null)),n.registerVisual(i(206)),n.registerVisual(i(207)),n.registerLayout(i(208)),n.registerLayout(i(211)),n.registerLayout(i(213)),n.registerCoordinateSystem("graphView",{create:i(215)});},function(t,e,i){"use strict";var n=i(97),r=i(4),o=i(5),a=i(12),s=i(197),l=i(1).extendSeriesModel({type:"series.graph",init:function init(t){l.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData;},this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeOption:function mergeOption(t){l.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeDefaultAndTheme:function mergeDefaultAndTheme(t){l.superApply(this,"mergeDefaultAndTheme",arguments),o.defaultEmphasis(t.edgeLabel,o.LABEL_OPTIONS);},getInitialData:function getInitialData(t,e){function i(t,e){t.wrapMethod("getItemModel",function(t){var e=o._categoriesModels,i=t.getShallow("category"),n=e[i];return n&&(n.parentModel=t.parentModel,t.parentModel=n),t;});var i=o.getModel("edgeLabel"),n=function n(t,e){var r=(t||"").split(".");"label"===r[0]&&(e=e||i.getModel(r.slice(1)));var o=a.prototype.getModel.call(this,r,e);return o.getModel=n,o;};e.wrapMethod("getItemModel",function(t){return t.getModel=n,t;});}var n=t.edges||t.links||[],r=t.data||t.nodes||[],o=this;return r&&n?s(r,n,this,!0,i).data:void 0;},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},getCategoriesData:function getCategoriesData(){return this._categoriesData;},formatTooltip:function formatTooltip(t,e,i){if("edge"===i){var n=this.getData(),r=this.getDataParams(t,i),o=n.graph.getEdgeByIndex(t),a=n.getName(o.node1.dataIndex),s=n.getName(o.node2.dataIndex),u=a+" > "+s;return r.value&&(u+=" : "+r.value),u;}return l.superApply(this,"formatTooltip",arguments);},_updateCategoriesData:function _updateCategoriesData(){var t=r.map(this.option.categories||[],function(t){return null!=t.value?t:r.extend({value:0},t);}),e=new n(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t,!0);});},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},ifEnableAnimation:function ifEnableAnimation(){return l.superCall(this,"ifEnableAnimation")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"));},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{normal:{position:"middle"},emphasis:{}},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{normal:{show:!1,formatter:"{b}"},emphasis:{show:!0}},itemStyle:{normal:{},emphasis:{}},lineStyle:{normal:{color:"#aaa",width:1,curveness:0,opacity:.5},emphasis:{}}}});t.exports=l;},function(t,e,i){var n=i(97),r=i(198),o=i(186),a=i(102),s=i(26),l=i(4),u=i(101);t.exports=function(t,e,i,h,c){for(var d=new r(h),f=0;f<t.length;f++){d.addNode(l.retrieve(t[f].id,t[f].name,f),f);}for(var p=[],g=[],m=0,f=0;f<e.length;f++){var v=e[f],y=v.source,x=v.target;d.addEdge(y,x,m)&&(g.push(v),p.push(l.retrieve(v.id,y+" > "+x)),m++);}var _,b=i.get("coordinateSystem");if("cartesian2d"===b||"polar"===b)_=u(t,i,i.ecModel);else{var w=s.get(b),S=a((w&&"view"!==w.type?w.dimensions||[]:[]).concat(["value"]),t);_=new n(S,i),_.initData(t);}var M=new n(["value"],i);return M.initData(g,p),c&&c(_,M),o({mainData:_,struct:d,structAttr:"graph",datas:{node:_,edge:M},datasAttr:{node:"data",edge:"edgeData"}}),d.update(),d;};},function(t,e,i){"use strict";function n(t,e){this.id=null==t?"":t,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==e?-1:e;}function r(t,e,i){this.node1=t,this.node2=e,this.dataIndex=null==i?-1:i;}var o=i(4),a=function a(t){this._directed=t||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData;},s=a.prototype;s.type="graph",s.isDirected=function(){return this._directed;},s.addNode=function(t,e){t=t||""+e;var i=this._nodesMap;if(!i[t]){var r=new n(t,e);return r.hostGraph=this,this.nodes.push(r),i[t]=r,r;}},s.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e];},s.getNodeById=function(t){return this._nodesMap[t];},s.addEdge=function(t,e,i){var o=this._nodesMap,a=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),t instanceof n||(t=o[t]),e instanceof n||(e=o[e]),t&&e){var s=t.id+"-"+e.id;if(!a[s]){var l=new r(t,e,i);return l.hostGraph=this,this._directed&&(t.outEdges.push(l),e.inEdges.push(l)),t.edges.push(l),t!==e&&e.edges.push(l),this.edges.push(l),a[s]=l,l;}}},s.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e];},s.getEdge=function(t,e){t instanceof n&&(t=t.id),e instanceof n&&(e=e.id);var i=this._edgesMap;return this._directed?i[t+"-"+e]:i[t+"-"+e]||i[e+"-"+t];},s.eachNode=function(t,e){for(var i=this.nodes,n=i.length,r=0;n>r;r++){i[r].dataIndex>=0&&t.call(e,i[r],r);}},s.eachEdge=function(t,e){for(var i=this.edges,n=i.length,r=0;n>r;r++){i[r].dataIndex>=0&&i[r].node1.dataIndex>=0&&i[r].node2.dataIndex>=0&&t.call(e,i[r],r);}},s.breadthFirstTraverse=function(t,e,i,r){if(e instanceof n||(e=this._nodesMap[e]),e){for(var o="out"===i?"outEdges":"in"===i?"inEdges":"edges",a=0;a<this.nodes.length;a++){this.nodes[a].__visited=!1;}if(!t.call(r,e,null))for(var s=[e];s.length;){for(var l=s.shift(),u=l[o],a=0;a<u.length;a++){var h=u[a],c=h.node1===l?h.node2:h.node1;if(!c.__visited){if(t.call(c,c,l))return;s.push(c),c.__visited=!0;}}}}},s.update=function(){for(var t=this.data,e=this.edgeData,i=this.nodes,n=this.edges,r=0,o=i.length;o>r;r++){i[r].dataIndex=-1;}for(var r=0,o=t.count();o>r;r++){i[t.getRawIndex(r)].dataIndex=r;}e.filterSelf(function(t){var i=n[e.getRawIndex(t)];return i.node1.dataIndex>=0&&i.node2.dataIndex>=0;});for(var r=0,o=n.length;o>r;r++){n[r].dataIndex=-1;}for(var r=0,o=e.count();o>r;r++){n[e.getRawIndex(r)].dataIndex=r;}},s.clone=function(){for(var t=new a(this._directed),e=this.nodes,i=this.edges,n=0;n<e.length;n++){t.addNode(e[n].id,e[n].dataIndex);}for(var n=0;n<i.length;n++){var r=i[n];t.addEdge(r.node1.id,r.node2.id,r.dataIndex);}return t;},n.prototype={constructor:n,degree:function degree(){return this.edges.length;},inDegree:function inDegree(){return this.inEdges.length;},outDegree:function outDegree(){return this.outEdges.length;},getModel:function getModel(t){if(!(this.dataIndex<0)){var e=this.hostGraph,i=e.data.getItemModel(this.dataIndex);return i.getModel(t);}}},r.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,i=e.edgeData.getItemModel(this.dataIndex);return i.getModel(t);}};var l=function l(t,e){return{getValue:function getValue(i){var n=this[t][e];return n.get(n.getDimension(i||"value"),this.dataIndex);},setVisual:function setVisual(i,n){this.dataIndex>=0&&this[t][e].setItemVisual(this.dataIndex,i,n);},getVisual:function getVisual(i,n){return this[t][e].getItemVisual(this.dataIndex,i,n);},setLayout:function setLayout(i,n){this.dataIndex>=0&&this[t][e].setItemLayout(this.dataIndex,i,n);},getLayout:function getLayout(){return this[t][e].getItemLayout(this.dataIndex);},getGraphicEl:function getGraphicEl(){return this[t][e].getItemGraphicEl(this.dataIndex);},getRawIndex:function getRawIndex(){return this[t][e].getRawIndex(this.dataIndex);}};};o.mixin(n,l("hostGraph","data")),o.mixin(r,l("hostGraph","edgeData")),a.Node=n,a.Edge=r,t.exports=a;},function(t,e,i){function n(t,e){return t.getVisual("opacity")||t.getModel().get(e);}var r=i(104),o=i(200),a=i(175),s=i(43),l=i(203),u=i(4),h=["itemStyle","normal","opacity"],c=["lineStyle","normal","opacity"];i(1).extendChartView({type:"graph",init:function init(t,e){var i=new r(),n=new o(),s=this.group,l=new a(e.getZr(),s);s.add(i.group),s.add(n.group),this._symbolDraw=i,this._lineDraw=n,this._controller=l,this._firstRender=!0;},render:function render(t,e,i){var n=t.coordinateSystem;this._model=t,this._nodeScaleRatio=t.get("nodeScaleRatio");var r=this._symbolDraw,o=this._lineDraw,a=this.group;if("view"===n.type){var u={position:n.position,scale:n.scale};this._firstRender?a.attr(u):s.updateProps(a,u,t);}l(t.getGraph(),this._getNodeGlobalScale(t));var h=t.getData();r.updateData(h);var c=t.getEdgeData();o.updateData(c),this._updateNodeAndLinkScale(),this._updateController(t,i),clearTimeout(this._layoutTimeout);var d=t.forceLayout,f=t.get("force.layoutAnimation");d&&this._startForceLayoutIteration(d,f),h.eachItemGraphicEl(function(t,e){var i=h.getItemModel(e);t.off("drag").off("dragend");var n=h.getItemModel(e).get("draggable");n&&t.on("drag",function(){d&&(d.warmUp(),!this._layouting&&this._startForceLayoutIteration(d,f),d.setFixed(e),h.setItemLayout(e,t.position));},this).on("dragend",function(){d&&d.setUnfixed(e);},this),t.setDraggable(n&&d),t.off("mouseover",this._focusNodeAdjacency),t.off("mouseout",this._unfocusAll),i.get("focusNodeAdjacency")&&(t.on("mouseover",this._focusNodeAdjacency,this),t.on("mouseout",this._unfocusAll,this));},this);var p="circular"===t.get("layout")&&t.get("circular.rotateLabel"),g=h.getLayout("cx"),m=h.getLayout("cy");h.eachItemGraphicEl(function(t,e){var i=t.getSymbolPath();if(p){var n=h.getItemLayout(e),r=Math.atan2(n[1]-m,n[0]-g);0>r&&(r=2*Math.PI+r);var o=n[0]<g;o&&(r-=Math.PI);var a=o?"left":"right";i.setStyle({textRotation:r,textPosition:a}),i.hoverStyle&&(i.hoverStyle.textPosition=a);}else i.setStyle({textRotation:0});}),this._firstRender=!1;},dispose:function dispose(){this._controller&&this._controller.dispose();},_focusNodeAdjacency:function _focusNodeAdjacency(t){function e(t,e){var i=n(t,e),r=t.getGraphicEl();null==i&&(i=1),r.traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",.1*i);});}function i(t,e){var i=n(t,e),r=t.getGraphicEl();r.traverse(function(t){t.trigger("emphasis"),"group"!==t.type&&t.setStyle("opacity",i);});}var r=this._model.getData(),o=r.graph,a=t.target,s=a.dataIndex,l=a.dataType;if(null!==s&&"edge"!==l){o.eachNode(function(t){e(t,h);}),o.eachEdge(function(t){e(t,c);});var d=o.getNodeByIndex(s);i(d,h),u.each(d.edges,function(t){t.dataIndex<0||(i(t,c),i(t.node1,h),i(t.node2,h));});}},_unfocusAll:function _unfocusAll(){var t=this._model.getData(),e=t.graph;e.eachNode(function(t){var e=n(t,h);t.getGraphicEl().traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",e);});}),e.eachEdge(function(t){var e=n(t,c);t.getGraphicEl().traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",e);});});},_startForceLayoutIteration:function _startForceLayoutIteration(t,e){var i=this;!function n(){t.step(function(t){i.updateLayout(i._model),(i._layouting=!t)&&(e?i._layoutTimeout=setTimeout(n,16):n());});}();},_updateController:function _updateController(t,e){var i=this._controller,n=this.group;return i.setContainsPoint(function(t,e){var i=n.getBoundingRect();return i.applyTransform(n.transform),i.contain(t,e);}),"view"!==t.coordinateSystem.type?void i.disable():(i.enable(t.get("roam")),i.zoomLimit=t.get("scaleLimit"),i.zoom=t.coordinateSystem.getZoom(),void i.off("pan").off("zoom").on("pan",function(i,n){e.dispatchAction({seriesId:t.id,type:"graphRoam",dx:i,dy:n});}).on("zoom",function(i,n,r){e.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:i,originX:n,originY:r}),this._updateNodeAndLinkScale(),l(t.getGraph(),this._getNodeGlobalScale(t)),this._lineDraw.updateLayout();},this));},_updateNodeAndLinkScale:function _updateNodeAndLinkScale(){var t=this._model,e=t.getData(),i=this._getNodeGlobalScale(t),n=[i,i];e.eachItemGraphicEl(function(t,e){t.attr("scale",n);});},_getNodeGlobalScale:function _getNodeGlobalScale(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=this._nodeScaleRatio,n=e.scale,r=n&&n[0]||1,o=e.getZoom(),a=(o-1)*i+1;return a/r;},updateLayout:function updateLayout(t){l(t.getGraph(),this._getNodeGlobalScale(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout();},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove();}});},function(t,e,i){function n(t){return isNaN(t[0])||isNaN(t[1]);}function r(t){return!n(t[0])&&!n(t[1]);}function o(t){this._ctor=t||s,this.group=new a.Group();}var a=i(43),s=i(201),l=o.prototype;l.updateData=function(t){var e=this._lineData,i=this.group,n=this._ctor,o=t.hostModel,a={lineStyle:o.getModel("lineStyle.normal").getLineStyle(),hoverLineStyle:o.getModel("lineStyle.emphasis").getLineStyle(),labelModel:o.getModel("label.normal"),hoverLabelModel:o.getModel("label.emphasis")};t.diff(e).add(function(e){if(r(t.getItemLayout(e))){var o=new n(t,e,a);t.setItemGraphicEl(e,o),i.add(o);}}).update(function(o,s){var l=e.getItemGraphicEl(s);return r(t.getItemLayout(o))?(l?l.updateData(t,o,a):l=new n(t,o,a),t.setItemGraphicEl(o,l),void i.add(l)):void i.remove(l);}).remove(function(t){i.remove(e.getItemGraphicEl(t));}).execute(),this._lineData=t;},l.updateLayout=function(){var t=this._lineData;t.eachItemGraphicEl(function(e,i){e.updateLayout(t,i);},this);},l.remove=function(){this.group.removeAll();},t.exports=o;},function(t,e,i){function n(t){return"_"+t+"Type";}function r(t,e,i){var n=e.getItemVisual(i,"color"),r=e.getItemVisual(i,t),o=e.getItemVisual(i,t+"Size");if(r&&"none"!==r){f.isArray(o)||(o=[o,o]);var a=u.createSymbol(r,-o[0]/2,-o[1]/2,o[0],o[1],n);return a.name=t,a;}}function o(t){var e=new c({name:"line"});return a(e.shape,t),e;}function a(t,e){var i=e[0],n=e[1],r=e[2];t.x1=i[0],t.y1=i[1],t.x2=n[0],t.y2=n[1],t.percent=1,r?(t.cpx1=r[0],t.cpy1=r[1]):(t.cpx1=NaN,t.cpy1=NaN);}function s(){var t=this,e=t.childOfName("fromSymbol"),i=t.childOfName("toSymbol"),n=t.childOfName("label");if(e||i||!n.ignore){for(var r=1,o=this.parent;o;){o.scale&&(r/=o.scale[0]),o=o.parent;}var a=t.childOfName("line");if(this.__dirty||a.__dirty){var s=a.shape.percent,l=a.pointAt(0),u=a.pointAt(s),c=h.sub([],u,l);if(h.normalize(c,c),e){e.attr("position",l);var d=a.tangentAt(0);e.attr("rotation",Math.PI/2-Math.atan2(d[1],d[0])),e.attr("scale",[r*s,r*s]);}if(i){i.attr("position",u);var d=a.tangentAt(1);i.attr("rotation",-Math.PI/2-Math.atan2(d[1],d[0])),i.attr("scale",[r*s,r*s]);}if(!n.ignore){n.attr("position",u);var f,p,g,m=5*r;if("end"===n.__position)f=[c[0]*m+u[0],c[1]*m+u[1]],p=c[0]>.8?"left":c[0]<-.8?"right":"center",g=c[1]>.8?"top":c[1]<-.8?"bottom":"middle";else if("middle"===n.__position){var v=s/2,d=a.tangentAt(v),y=[d[1],-d[0]],x=a.pointAt(v);y[1]>0&&(y[0]=-y[0],y[1]=-y[1]),f=[x[0]+y[0]*m,x[1]+y[1]*m],p="center",g="bottom";var _=-Math.atan2(d[1],d[0]);u[0]<l[0]&&(_=Math.PI+_),n.attr("rotation",_);}else f=[-c[0]*m+l[0],-c[1]*m+l[1]],p=c[0]>.8?"right":c[0]<-.8?"left":"center",g=c[1]>.8?"bottom":c[1]<-.8?"top":"middle";n.attr({style:{textVerticalAlign:n.__verticalAlign||g,textAlign:n.__textAlign||p},position:f,scale:[r,r]});}}}}function l(t,e,i){d.Group.call(this),this._createLine(t,e,i);}var u=i(106),h=i(10),c=i(202),d=i(43),f=i(4),p=i(7),g=["fromSymbol","toSymbol"],m=l.prototype;m.beforeUpdate=s,m._createLine=function(t,e,i){var a=t.hostModel,s=t.getItemLayout(e),l=o(s);l.shape.percent=0,d.initProps(l,{shape:{percent:1}},a,e),this.add(l);var u=new d.Text({name:"label"});this.add(u),f.each(g,function(i){var o=r(i,t,e);this.add(o),this[n(i)]=t.getItemVisual(e,i);},this),this._updateCommonStl(t,e,i);},m.updateData=function(t,e,i){var o=t.hostModel,s=this.childOfName("line"),l=t.getItemLayout(e),u={shape:{}};a(u.shape,l),d.updateProps(s,u,o,e),f.each(g,function(i){var o=t.getItemVisual(e,i),a=n(i);if(this[a]!==o){this.remove(this.childOfName(i));var s=r(i,t,e);this.add(s);}this[a]=o;},this),this._updateCommonStl(t,e,i);},m._updateCommonStl=function(t,e,i){var n=t.hostModel,r=this.childOfName("line"),o=i&&i.lineStyle,a=i&&i.hoverLineStyle,s=i&&i.labelModel,l=i&&i.hoverLabelModel;if(!i||t.hasItemOption){var u=t.getItemModel(e);o=u.getModel("lineStyle.normal").getLineStyle(),a=u.getModel("lineStyle.emphasis").getLineStyle(),s=u.getModel("label.normal"),l=u.getModel("label.emphasis");}var h=t.getItemVisual(e,"color"),c=f.retrieve(t.getItemVisual(e,"opacity"),o.opacity,1);r.useStyle(f.defaults({strokeNoScale:!0,fill:"none",stroke:h,opacity:c},o)),r.hoverStyle=a,f.each(g,function(t){var e=this.childOfName(t);e&&(e.setColor(h),e.setStyle({opacity:c}));},this);var m,v,y=s.getShallow("show"),x=l.getShallow("show"),_=this.childOfName("label");if(y||x){var b=n.getRawValue(e);v=null==b?v=t.getName(e):isFinite(b)?p.round(b):b,m=h||"#000";}if(y){var w=s.getModel("textStyle");_.setStyle({text:f.retrieve(n.getFormattedLabel(e,"normal",t.dataType),v),textFont:w.getFont(),fill:w.getTextColor()||m}),_.__textAlign=w.get("align"),_.__verticalAlign=w.get("baseline"),_.__position=s.get("position");}else _.setStyle("text","");if(x){var S=l.getModel("textStyle");_.hoverStyle={text:f.retrieve(n.getFormattedLabel(e,"emphasis",t.dataType),v),textFont:S.getFont(),fill:S.getTextColor()||m};}else _.hoverStyle={text:""};_.ignore=!y&&!x,d.setHoverStyle(this);},m.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e));},m.setLinePoints=function(t){var e=this.childOfName("line");a(e.shape,t),e.dirty();},f.inherits(l,d.Group),t.exports=l;},function(t,e,i){function n(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1);}var r=i(43),o=i(10),a=r.Line.prototype,s=r.BezierCurve.prototype;t.exports=r.extendShape({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function buildPath(t,e){(n(e)?a:s).buildPath(t,e);},pointAt:function pointAt(t){return n(this.shape)?a.pointAt.call(this,t):s.pointAt.call(this,t);},tangentAt:function tangentAt(t){var e=this.shape,i=n(e)?[e.x2-e.x1,e.y2-e.y1]:s.tangentAt.call(this,t);return o.normalize(i,i);}});},function(t,e,i){function n(t,e,i){for(var n,r=t[0],o=t[1],d=t[2],f=1/0,p=i*i,g=.1,m=.1;.9>=m;m+=.1){a[0]=u(r[0],o[0],d[0],m),a[1]=u(r[1],o[1],d[1],m);var v=c(h(a,e)-p);f>v&&(f=v,n=m);}for(var y=0;32>y;y++){var x=n+g;s[0]=u(r[0],o[0],d[0],n),s[1]=u(r[1],o[1],d[1],n),l[0]=u(r[0],o[0],d[0],x),l[1]=u(r[1],o[1],d[1],x);var v=h(s,e)-p;if(c(v)<.01)break;var _=h(l,e)-p;g/=2,0>v?_>=0?n+=g:n-=g:_>=0?n-=g:n+=g;}return n;}var r=i(50),o=i(10),a=[],s=[],l=[],u=r.quadraticAt,h=o.distSquare,c=Math.abs;t.exports=function(t,e){function i(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),e;}var a=[],s=r.quadraticSubdivide,l=[[],[],[]],u=[[],[]],h=[];e/=2,t.eachEdge(function(t,r){var c=t.getLayout(),d=t.getVisual("fromSymbol"),f=t.getVisual("toSymbol");c.__original||(c.__original=[o.clone(c[0]),o.clone(c[1])],c[2]&&c.__original.push(o.clone(c[2])));var p=c.__original;if(null!=c[2]){if(o.copy(l[0],p[0]),o.copy(l[1],p[2]),o.copy(l[2],p[1]),d&&"none"!=d){var g=i(t.node1),m=n(l,p[0],g*e);s(l[0][0],l[1][0],l[2][0],m,a),l[0][0]=a[3],l[1][0]=a[4],s(l[0][1],l[1][1],l[2][1],m,a),l[0][1]=a[3],l[1][1]=a[4];}if(f&&"none"!=f){var g=i(t.node2),m=n(l,p[1],g*e);s(l[0][0],l[1][0],l[2][0],m,a),l[1][0]=a[1],l[2][0]=a[2],s(l[0][1],l[1][1],l[2][1],m,a),l[1][1]=a[1],l[2][1]=a[2];}o.copy(c[0],l[0]),o.copy(c[1],l[2]),o.copy(c[2],l[1]);}else{if(o.copy(u[0],p[0]),o.copy(u[1],p[1]),o.sub(h,u[1],u[0]),o.normalize(h,h),d&&"none"!=d){var g=i(t.node1);o.scaleAndAdd(u[0],u[0],h,g*e);}if(f&&"none"!=f){var g=i(t.node2);o.scaleAndAdd(u[1],u[1],h,-g*e);}o.copy(c[0],u[0]),o.copy(c[1],u[1]);}});};},function(t,e,i){var n=i(1),r=i(178),o={type:"graphRoam",event:"graphRoam",update:"none"};n.registerAction(o,function(t,e){e.eachComponent({mainType:"series",query:t},function(e){var i=e.coordinateSystem,n=r.updateCenterAndZoom(i,t);e.setCenter&&e.setCenter(n.center),e.setZoom&&e.setZoom(n.zoom);});});},function(t,e){t.exports=function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getGraph(),r=n.data,o=i.mapArray(i.getName);r.filterSelf(function(t){var i=r.getItemModel(t),n=i.getShallow("category");if(null!=n){"number"==typeof n&&(n=o[n]);for(var a=0;a<e.length;a++){if(!e[a].isSelected(n))return!1;}}return!0;});},this);};},function(t,e){t.exports=function(t){var e={};t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getData(),r={};i.each(function(n){var o=i.getName(n);r[o]=n;var a=i.getItemModel(n),s=a.get("itemStyle.normal.color")||t.getColorFromPalette(o,e);i.setItemVisual(n,"color",s);}),i.count()&&n.each(function(t){var e=n.getItemModel(t),o=e.getShallow("category");null!=o&&("string"==typeof o&&(o=r[o]),n.getItemVisual(t,"color",!0)||n.setItemVisual(t,"color",i.getItemVisual(o,"color")));});});};},function(t,e){function i(t){return t instanceof Array||(t=[t,t]),t;}t.exports=function(t){t.eachSeriesByType("graph",function(t){var e=t.getGraph(),n=t.getEdgeData(),r=i(t.get("edgeSymbol")),o=i(t.get("edgeSymbolSize")),a="lineStyle.normal.color".split("."),s="lineStyle.normal.opacity".split(".");n.setVisual("fromSymbol",r&&r[0]),n.setVisual("toSymbol",r&&r[1]),n.setVisual("fromSymbolSize",o&&o[0]),n.setVisual("toSymbolSize",o&&o[1]),n.setVisual("color",t.get(a)),n.setVisual("opacity",t.get(s)),n.each(function(t){var r=n.getItemModel(t),o=e.getEdgeByIndex(t),l=i(r.getShallow("symbol",!0)),u=i(r.getShallow("symbolSize",!0)),h=r.get(a),c=r.get(s);switch(h){case"source":h=o.node1.getVisual("color");break;case"target":h=o.node2.getVisual("color");}l[0]&&o.setVisual("fromSymbol",l[0]),l[1]&&o.setVisual("toSymbol",l[1]),u[0]&&o.setVisual("fromSymbolSize",u[0]),u[1]&&o.setVisual("toSymbolSize",u[1]),o.setVisual("color",h),o.setVisual("opacity",c);});});};},function(t,e,i){var n=i(209),r=i(210);t.exports=function(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),i=t.coordinateSystem;if(i&&"view"!==i.type){var o=t.getData();o.each(i.dimensions,function(t,e,n){isNaN(t)||isNaN(e)?o.setItemLayout(n,[NaN,NaN]):o.setItemLayout(n,i.dataToPoint([t,e]));}),r(o.graph);}else e&&"none"!==e||n(t);});};},function(t,e,i){var n=i(210);t.exports=function(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=t.getGraph();i.eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")]);}),n(i);}};},function(t,e,i){var n=i(10);t.exports=function(t){t.eachEdge(function(t){var e=t.getModel().get("lineStyle.normal.curveness")||0,i=n.clone(t.node1.getLayout()),r=n.clone(t.node2.getLayout()),o=[i,r];+e&&o.push([(i[0]+r[0])/2-(i[1]-r[1])*e,(i[1]+r[1])/2-(r[0]-i[0])*e]),t.setLayout(o);});};},function(t,e,i){var n=i(212);t.exports=function(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&n(t);});};},function(t,e,i){var n=i(10);t.exports=function(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=e.getBoundingRect(),r=t.getData(),o=r.graph,a=0,s=r.getSum("value"),l=2*Math.PI/(s||r.count()),u=i.width/2+i.x,h=i.height/2+i.y,c=Math.min(i.width,i.height)/2;o.eachNode(function(t){var e=t.getValue("value");a+=l*(s?e:1)/2,t.setLayout([c*Math.cos(a)+u,c*Math.sin(a)+h]),a+=l*(s?e:1)/2;}),r.setLayout({cx:u,cy:h}),o.eachEdge(function(t){var e,i=t.getModel().get("lineStyle.normal.curveness")||0,r=n.clone(t.node1.getLayout()),o=n.clone(t.node2.getLayout()),a=(r[0]+o[0])/2,s=(r[1]+o[1])/2;+i&&(i*=3,e=[u*i+a*(1-i),h*i+s*(1-i)]),t.setLayout([r,o,e]);});}};},function(t,e,i){var n=i(214),r=i(7),o=i(209),a=i(212),s=i(10),l=i(4);t.exports=function(t){t.eachSeriesByType("graph",function(t){var e=t.coordinateSystem;if(!e||"view"===e.type)if("force"===t.get("layout")){var i=t.preservedPoints||{},u=t.getGraph(),h=u.data,c=u.edgeData,d=t.getModel("force"),f=d.get("initLayout");t.preservedPoints?h.each(function(t){var e=h.getId(t);h.setItemLayout(t,i[e]||[NaN,NaN]);}):f&&"none"!==f?"circular"===f&&a(t):o(t);var p=h.getDataExtent("value"),g=c.getDataExtent("value"),m=d.get("repulsion"),v=d.get("edgeLength");l.isArray(m)||(m=[m,m]),l.isArray(v)||(v=[v,v]),v=[v[1],v[0]];var y=h.mapArray("value",function(t,e){var i=h.getItemLayout(e),n=r.linearMap(t,p,m);return isNaN(n)&&(n=(m[0]+m[1])/2),{w:n,rep:n,p:!i||isNaN(i[0])||isNaN(i[1])?null:i};}),x=c.mapArray("value",function(t,e){var i=u.getEdgeByIndex(e),n=r.linearMap(t,g,v);return isNaN(n)&&(n=(v[0]+v[1])/2),{n1:y[i.node1.dataIndex],n2:y[i.node2.dataIndex],d:n,curveness:i.getModel().get("lineStyle.normal.curveness")||0};}),e=t.coordinateSystem,_=e.getBoundingRect(),b=n(y,x,{rect:_,gravity:d.get("gravity")}),w=b.step;b.step=function(t){for(var e=0,n=y.length;n>e;e++){y[e].fixed&&s.copy(y[e].p,u.getNodeByIndex(e).getLayout());}w(function(e,n,r){for(var o=0,a=e.length;a>o;o++){e[o].fixed||u.getNodeByIndex(o).setLayout(e[o].p),i[h.getId(o)]=e[o].p;}for(var o=0,a=n.length;a>o;o++){var l=n[o],c=u.getEdgeByIndex(o),d=l.n1.p,f=l.n2.p,p=c.getLayout();p=p?p.slice():[],p[0]=p[0]||[],p[1]=p[1]||[],s.copy(p[0],d),s.copy(p[1],f),+l.curveness&&(p[2]=[(d[0]+f[0])/2-(d[1]-f[1])*l.curveness,(d[1]+f[1])/2-(f[0]-d[0])*l.curveness]),c.setLayout(p);}t&&t(r);});},t.forceLayout=b,t.preservedPoints=i,b.step();}else t.forceLayout=null;});};},function(t,e,i){var n=i(10),r=n.scaleAndAdd;t.exports=function(t,e,i){for(var o=i.rect,a=o.width,s=o.height,l=[o.x+a/2,o.y+s/2],u=null==i.gravity?.1:i.gravity,h=0;h<t.length;h++){var c=t[h];c.p||(c.p=n.create(a*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),c.pp=n.clone(c.p),c.edges=null;}var d=.6;return{warmUp:function warmUp(){d=.5;},setFixed:function setFixed(e){t[e].fixed=!0;},setUnfixed:function setUnfixed(e){t[e].fixed=!1;},step:function step(i){for(var o=[],a=t.length,s=0;s<e.length;s++){var h=e[s],c=h.n1,f=h.n2;n.sub(o,f.p,c.p);var p=n.len(o)-h.d,g=f.w/(c.w+f.w);n.normalize(o,o),!c.fixed&&r(c.p,c.p,o,g*p*d),!f.fixed&&r(f.p,f.p,o,-(1-g)*p*d);}for(var s=0;a>s;s++){var m=t[s];m.fixed||(n.sub(o,l,m.p),n.scaleAndAdd(m.p,m.p,o,u*d));}for(var s=0;a>s;s++){for(var c=t[s],v=s+1;a>v;v++){var f=t[v];n.sub(o,f.p,c.p);var p=n.len(o);0===p&&(n.set(o,Math.random()-.5,Math.random()-.5),p=1);var y=(c.rep+f.rep)/p/p;!c.fixed&&r(c.pp,c.pp,o,y),!f.fixed&&r(f.pp,f.pp,o,-y);}}for(var x=[],s=0;a>s;s++){var m=t[s];m.fixed||(n.sub(x,m.p,m.pp),n.scaleAndAdd(m.p,m.p,x,d),n.copy(m.pp,m.p));}d=.992*d,i&&i(t,e,.01>d);}};};},function(t,e,i){function n(t,e,i){var n=t.getBoxLayoutParams();return n.aspect=i,o.getLayoutRect(n,{width:e.getWidth(),height:e.getHeight()});}var r=i(169),o=i(21),a=i(51);t.exports=function(t,e){var i=[];return t.eachSeriesByType("graph",function(t){var o=t.get("coordinateSystem");if(!o||"view"===o){var s=t.getData(),l=s.mapArray(function(t){var e=s.getItemModel(t);return[+e.get("x"),+e.get("y")];}),u=[],h=[];a.fromPoints(l,u,h),h[0]-u[0]===0&&(h[0]+=1,u[0]-=1),h[1]-u[1]===0&&(h[1]+=1,u[1]-=1);var c=(h[0]-u[0])/(h[1]-u[1]),d=n(t,e,c);isNaN(c)&&(u=[d.x,d.y],h=[d.x+d.width,d.y+d.height]);var f=h[0]-u[0],p=h[1]-u[1],g=d.width,m=d.height,v=t.coordinateSystem=new r();v.zoomLimit=t.get("scaleLimit"),v.setBoundingRect(u[0],u[1],f,p),v.setViewRect(d.x,d.y,g,m),v.setCenter(t.get("center")),v.setZoom(t.get("zoom")),i.push(v);}}),i;};},function(t,e,i){i(217),i(218);},function(t,e,i){var n=i(97),r=i(28),o=i(4),a=r.extend({type:"series.gauge",getInitialData:function getInitialData(t,e){var i=new n(["value"],this),r=t.data||[];return o.isArray(r)||(r=[r]),i.initData(r),i;},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,textStyle:{color:"auto"}},pointer:{show:!0,length:"80%",width:8},itemStyle:{normal:{color:"auto"}},title:{show:!0,offsetCenter:[0,"-40%"],textStyle:{color:"#333",fontSize:15}},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:40,offsetCenter:[0,"40%"],textStyle:{color:"auto",fontSize:30}}}});t.exports=a;},function(t,e,i){function n(t,e){var i=t.get("center"),n=e.getWidth(),r=e.getHeight(),o=Math.min(n,r),a=l(i[0],e.getWidth()),s=l(i[1],e.getHeight()),u=l(t.get("radius"),o/2);return{cx:a,cy:s,r:u};}function r(t,e){return e&&("string"==typeof e?t=e.replace("{value}",t):"function"==typeof e&&(t=e(t))),t;}var o=i(219),a=i(43),s=i(7),l=s.parsePercent,u=2*Math.PI,h=i(42).extend({type:"gauge",render:function render(t,e,i){this.group.removeAll();var r=t.get("axisLine.lineStyle.color"),o=n(t,i);this._renderMain(t,e,i,r,o);},dispose:function dispose(){},_renderMain:function _renderMain(t,e,i,n,r){for(var o=this.group,s=t.getModel("axisLine"),l=s.getModel("lineStyle"),h=t.get("clockwise"),c=-t.get("startAngle")/180*Math.PI,d=-t.get("endAngle")/180*Math.PI,f=(d-c)%u,p=c,g=l.get("width"),m=0;m<n.length;m++){var v=Math.min(Math.max(n[m][0],0),1),d=c+f*v,y=new a.Sector({shape:{startAngle:p,endAngle:d,cx:r.cx,cy:r.cy,clockwise:h,r0:r.r-g,r:r.r},silent:!0});y.setStyle({fill:n[m][1]}),y.setStyle(l.getLineStyle(["color","borderWidth","borderColor"])),o.add(y),p=d;}var x=function x(t){if(0>=t)return n[0][1];for(var e=0;e<n.length;e++){if(n[e][0]>=t&&(0===e?0:n[e-1][0])<t)return n[e][1];}return n[e-1][1];};if(!h){var _=c;c=d,d=_;}this._renderTicks(t,e,i,x,r,c,d,h),this._renderPointer(t,e,i,x,r,c,d,h),this._renderTitle(t,e,i,x,r),this._renderDetail(t,e,i,x,r);},_renderTicks:function _renderTicks(t,e,i,n,o,u,h,c){for(var d=this.group,f=o.cx,p=o.cy,g=o.r,m=t.get("min"),v=t.get("max"),y=t.getModel("splitLine"),x=t.getModel("axisTick"),_=t.getModel("axisLabel"),b=t.get("splitNumber"),w=x.get("splitNumber"),S=l(y.get("length"),g),M=l(x.get("length"),g),I=u,T=(h-u)/b,A=T/w,L=y.getModel("lineStyle").getLineStyle(),C=x.getModel("lineStyle").getLineStyle(),D=_.getModel("textStyle"),P=0;b>=P;P++){var k=Math.cos(I),z=Math.sin(I);if(y.get("show")){var O=new a.Line({shape:{x1:k*g+f,y1:z*g+p,x2:k*(g-S)+f,y2:z*(g-S)+p},style:L,silent:!0});"auto"===L.stroke&&O.setStyle({stroke:n(P/b)}),d.add(O);}if(_.get("show")){var E=r(s.round(P/b*(v-m)+m),_.get("formatter")),R=_.get("distance"),N=new a.Text({style:{text:E,x:k*(g-S-R)+f,y:z*(g-S-R)+p,fill:D.getTextColor(),textFont:D.getFont(),textVerticalAlign:-.4>z?"top":z>.4?"bottom":"middle",textAlign:-.4>k?"left":k>.4?"right":"center"},silent:!0});"auto"===N.style.fill&&N.setStyle({fill:n(P/b)}),d.add(N);}if(x.get("show")&&P!==b){for(var V=0;w>=V;V++){var k=Math.cos(I),z=Math.sin(I),B=new a.Line({shape:{x1:k*g+f,y1:z*g+p,x2:k*(g-M)+f,y2:z*(g-M)+p},silent:!0,style:C});"auto"===C.stroke&&B.setStyle({stroke:n((P+V/w)/b)}),d.add(B),I+=A;}I-=A;}else I+=T;}},_renderPointer:function _renderPointer(t,e,i,n,r,u,h,c){var d=[+t.get("min"),+t.get("max")],f=[u,h],p=t.getData(),g=this._data,m=this.group;p.diff(g).add(function(e){var i=new o({shape:{angle:u}});a.updateProps(i,{shape:{angle:s.linearMap(p.get("value",e),d,f,!0)}},t),m.add(i),p.setItemGraphicEl(e,i);}).update(function(e,i){var n=g.getItemGraphicEl(i);a.updateProps(n,{shape:{angle:s.linearMap(p.get("value",e),d,f,!0)}},t),m.add(n),p.setItemGraphicEl(e,n);}).remove(function(t){var e=g.getItemGraphicEl(t);m.remove(e);}).execute(),p.eachItemGraphicEl(function(t,e){var i=p.getItemModel(e),o=i.getModel("pointer");t.setShape({x:r.cx,y:r.cy,width:l(o.get("width"),r.r),r:l(o.get("length"),r.r)}),t.useStyle(i.getModel("itemStyle.normal").getItemStyle()),"auto"===t.style.fill&&t.setStyle("fill",n((p.get("value",e)-d[0])/(d[1]-d[0]))),a.setHoverStyle(t,i.getModel("itemStyle.emphasis").getItemStyle());}),this._data=p;},_renderTitle:function _renderTitle(t,e,i,n,r){var o=t.getModel("title");if(o.get("show")){var s=o.getModel("textStyle"),u=o.get("offsetCenter"),h=r.cx+l(u[0],r.r),c=r.cy+l(u[1],r.r),d=new a.Text({style:{x:h,y:c,text:t.getData().getName(0),fill:s.getTextColor(),textFont:s.getFont(),textAlign:"center",textVerticalAlign:"middle"}});this.group.add(d);}},_renderDetail:function _renderDetail(t,e,i,n,o){var u=t.getModel("detail"),h=t.get("min"),c=t.get("max");if(u.get("show")){var d=u.getModel("textStyle"),f=u.get("offsetCenter"),p=o.cx+l(f[0],o.r),g=o.cy+l(f[1],o.r),m=l(u.get("width"),o.r),v=l(u.get("height"),o.r),y=t.getData().get("value",0),x=new a.Rect({shape:{x:p-m/2,y:g-v/2,width:m,height:v},style:{text:r(y,u.get("formatter")),fill:u.get("backgroundColor"),textFill:d.getTextColor(),textFont:d.getFont()}});"auto"===x.style.textFill&&x.setStyle("textFill",n(s.linearMap(y,[h,c],[0,1],!0))),x.setStyle(u.getItemStyle(["color"])),this.group.add(x);}}});t.exports=h;},function(t,e,i){t.exports=i(45).extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function buildPath(t,e){var i=Math.cos,n=Math.sin,r=e.r,o=e.width,a=e.angle,s=e.x-i(a)*o*(o>=r/3?1:2),l=e.y-n(a)*o*(o>=r/3?1:2);a=e.angle-Math.PI/2,t.moveTo(s,l),t.lineTo(e.x+i(a)*o,e.y+n(a)*o),t.lineTo(e.x+i(e.angle)*r,e.y+n(e.angle)*r),t.lineTo(e.x-i(a)*o,e.y-n(a)*o),t.lineTo(s,l);}});},function(t,e,i){var n=i(4),r=i(1);i(221),i(222),r.registerVisual(n.curry(i(144),"funnel")),r.registerLayout(i(223)),r.registerProcessor(n.curry(i(147),"funnel"));},function(t,e,i){"use strict";var n=i(97),r=i(5),o=i(102),a=i(1).extendSeriesModel({type:"series.funnel",init:function init(t){a.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;},this._defaultLabelLine(t);},getInitialData:function getInitialData(t,e){var i=o(["value"],t.data),r=new n(i,this);return r.initData(t.data),r;},_defaultLabelLine:function _defaultLabelLine(t){r.defaultEmphasis(t.labelLine,["show"]);var e=t.labelLine.normal,i=t.labelLine.emphasis;e.show=e.show&&t.label.normal.show,i.show=i.show&&t.label.emphasis.show;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",gap:0,funnelAlign:"center",label:{normal:{show:!0,position:"outer"},emphasis:{show:!0}},labelLine:{normal:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},emphasis:{}},itemStyle:{normal:{borderColor:"#fff",borderWidth:1},emphasis:{}}}});t.exports=a;},function(t,e,i){function n(t,e){function i(){a.ignore=a.hoverIgnore,s.ignore=s.hoverIgnore;}function n(){a.ignore=a.normalIgnore,s.ignore=s.normalIgnore;}o.Group.call(this);var r=new o.Polygon(),a=new o.Polyline(),s=new o.Text();this.add(r),this.add(a),this.add(s),this.updateData(t,e,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n);}function r(t,e,i,n){var r=n.getModel("textStyle"),o=n.get("position"),s="inside"===o||"inner"===o||"center"===o;return{fill:r.getTextColor()||(s?"#fff":t.getItemVisual(e,"color")),textFont:r.getFont(),text:a.retrieve(t.hostModel.getFormattedLabel(e,i),t.getName(e))};}var o=i(43),a=i(4),s=n.prototype,l=["itemStyle","normal","opacity"];s.updateData=function(t,e,i){var n=this.childAt(0),r=t.hostModel,s=t.getItemModel(e),u=t.getItemLayout(e),h=t.getItemModel(e).get(l);h=null==h?1:h,n.useStyle({}),i?(n.setShape({points:u.points}),n.setStyle({opacity:0}),o.initProps(n,{style:{opacity:h}},r,e)):o.updateProps(n,{style:{opacity:h},shape:{points:u.points}},r,e);var c=s.getModel("itemStyle"),d=t.getItemVisual(e,"color");n.setStyle(a.defaults({lineJoin:"round",fill:d},c.getModel("normal").getItemStyle(["opacity"]))),n.hoverStyle=c.getModel("emphasis").getItemStyle(),this._updateLabel(t,e),o.setHoverStyle(this);},s._updateLabel=function(t,e){var i=this.childAt(1),n=this.childAt(2),a=t.hostModel,s=t.getItemModel(e),l=t.getItemLayout(e),u=l.label,h=t.getItemVisual(e,"color");o.updateProps(i,{shape:{points:u.linePoints||u.linePoints}},a,e),o.updateProps(n,{style:{x:u.x,y:u.y}},a,e),n.attr({style:{textAlign:u.textAlign,textVerticalAlign:u.verticalAlign,textFont:u.font},rotation:u.rotation,origin:[u.x,u.y],z2:10});var c=s.getModel("label.normal"),d=s.getModel("label.emphasis"),f=s.getModel("labelLine.normal"),p=s.getModel("labelLine.emphasis");n.setStyle(r(t,e,"normal",c)),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),i.ignore=i.normalIgnore=!f.get("show"),i.hoverIgnore=!p.get("show"),i.setStyle({stroke:h}),i.setStyle(f.getModel("lineStyle").getLineStyle()),n.hoverStyle=r(t,e,"emphasis",d),i.hoverStyle=p.getModel("lineStyle").getLineStyle();},a.inherits(n,o.Group);var u=i(42).extend({type:"funnel",render:function render(t,e,i){var r=t.getData(),o=this._data,a=this.group;r.diff(o).add(function(t){var e=new n(r,t);r.setItemGraphicEl(t,e),a.add(e);}).update(function(t,e){var i=o.getItemGraphicEl(e);i.updateData(r,t),a.add(i),r.setItemGraphicEl(t,i);}).remove(function(t){var e=o.getItemGraphicEl(t);a.remove(e);}).execute(),this._data=r;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});t.exports=u;},function(t,e,i){function n(t,e){return a.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}function r(t,e){for(var i=t.mapArray("value",function(t){return t;}),n=[],r="ascending"===e,o=0,a=t.count();a>o;o++){n[o]=o;}return n.sort(function(t,e){return r?i[t]-i[e]:i[e]-i[t];}),n;}function o(t){t.each(function(e){var i,n,r,o,a=t.getItemModel(e),s=a.getModel("label.normal"),l=s.get("position"),u=a.getModel("labelLine.normal"),h=t.getItemLayout(e),c=h.points,d="inner"===l||"inside"===l||"center"===l;if(d)n=(c[0][0]+c[1][0]+c[2][0]+c[3][0])/4,r=(c[0][1]+c[1][1]+c[2][1]+c[3][1])/4,i="center",o=[[n,r],[n,r]];else{var f,p,g,m=u.get("length");"left"===l?(f=(c[3][0]+c[0][0])/2,p=(c[3][1]+c[0][1])/2,g=f-m,n=g-5,i="right"):(f=(c[1][0]+c[2][0])/2,p=(c[1][1]+c[2][1])/2,g=f+m,n=g+5,i="left");var v=p;o=[[f,p],[g,v]],r=v;}h.label={linePoints:o,x:n,y:r,verticalAlign:"middle",textAlign:i,inside:d};});}var a=i(21),s=i(7),l=s.parsePercent;t.exports=function(t,e,i){t.eachSeriesByType("funnel",function(t){var i=t.getData(),a=t.get("sort"),u=n(t,e),h=r(i,a),c=[l(t.get("minSize"),u.width),l(t.get("maxSize"),u.width)],d=i.getDataExtent("value"),f=t.get("min"),p=t.get("max");null==f&&(f=Math.min(d[0],0)),null==p&&(p=d[1]);var g=t.get("funnelAlign"),m=t.get("gap"),v=(u.height-m*(i.count()-1))/i.count(),y=u.y,x=function x(t,e){var n,r=i.get("value",t)||0,o=s.linearMap(r,[f,p],c,!0);switch(g){case"left":n=u.x;break;case"center":n=u.x+(u.width-o)/2;break;case"right":n=u.x+u.width-o;}return[[n,e],[n+o,e]];};"ascending"===a&&(v=-v,m=-m,y+=u.height,h=h.reverse());for(var _=0;_<h.length;_++){var b=h[_],w=h[_+1],S=x(b,y),M=x(w,y+v);y+=v+m,i.setItemLayout(b,{points:S.concat(M.slice().reverse())});}o(i);});};},function(t,e,i){var n=i(1);i(225),i(236),i(237),n.registerVisual(i(238));},function(t,e,i){i(226),i(229),i(231);var n=i(1),r=i(4),o=5;n.extendComponentView({type:"parallel",render:function render(t,e,i){var n=i.getZr();if(!this.__onMouseDown){var a;n.on("mousedown",this.__onMouseDown=function(t){a=[t.offsetX,t.offsetY];}),n.on("mouseup",this.__onMouseUp=function(e){var n=[e.offsetX,e.offsetY],s=Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2);if(t.get("axisExpandable")&&!(s>o)){var l=t.coordinateSystem,u=l.findClosestAxisDim(n);if(u){var h=r.indexOf(l.dimensions,u);i.dispatchAction({type:"parallelAxisExpand",axisExpandCenter:h});}}});}},dispose:function dispose(t,e){e.getZr().off(this.__onMouseDown),e.getZr().off(this.__onMouseUp);}}),n.registerPreprocessor(i(235));},function(t,e,i){function n(t,e){var i=[];return t.eachComponent("parallel",function(n,o){var a=new r(n,t,e);a.name="parallel_"+o,a.resize(n,e),n.coordinateSystem=a,a.model=n,i.push(a);}),t.eachSeries(function(e){if("parallel"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"parallel",index:e.get("parallelIndex"),id:e.get("parallelId")})[0];e.coordinateSystem=i.coordinateSystem;}}),i;}var r=i(227);i(26).register("parallel",{create:n});},function(t,e,i){function n(t,e,i){this._axesMap={},this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,e,i);}var r=i(21),o=i(114),a=i(4),s=i(228),l=i(43),u=i(11),h=a.each,c=Math.PI;n.prototype={type:"parallel",constructor:n,_init:function _init(t,e,i){var n=t.dimensions,r=t.parallelAxisIndex;h(n,function(t,i){var n=r[i],a=e.getComponent("parallelAxis",n),l=this._axesMap[t]=new s(t,o.createScaleByModel(a),[0,0],a.get("type"),n),u="category"===l.type;l.onBand=u&&a.get("boundaryGap"),l.inverse=a.get("inverse"),a.axis=l,l.model=a;},this);},update:function update(t,e){this._updateAxesFromSeries(this._model,t);},_updateAxesFromSeries:function _updateAxesFromSeries(t,e){e.eachSeries(function(i){if(t.contains(i,e)){var n=i.getData();h(this.dimensions,function(t){var e=this._axesMap[t];e.scale.unionExtent(n.getDataExtent(t)),o.niceScaleExtent(e,e.model);},this);}},this);},resize:function resize(t,e){this._rect=r.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes(t);},getRect:function getRect(){return this._rect;},_layoutAxes:function _layoutAxes(t){var e=this._rect,i=t.get("layout"),n=this._axesMap,r=this.dimensions,o=[e.width,e.height],a="horizontal"===i?0:1,s=o[a],l=o[1-a],d=[0,l];h(n,function(t){var e=t.inverse?1:0;t.setExtent(d[e],d[1-e]);});var f,p=t.get("axisExpandable"),g=t.get("axisExpandWidth"),m=t.get("axisExpandCenter"),v=t.get("axisExpandCount")||0;if(null!=m){var y=Math.max(0,Math.floor(m-(v-1)/2)),x=y+v-1;x>=r.length&&(x=r.length-1,y=Math.max(0,Math.floor(x-v+1))),f=[y,x];}var _=p&&f&&g?function(t,e,i){var n,r=f[1]-f[0],o=(e-g*r)/(i-1-r);return n=t<f[0]?(t-1)*o:t<=f[1]?f[0]*o+(t-f[0])*g:t===i-1?e:f[0]*o+r*g+(t-f[1])*o,{position:n,axisNameAvailableWidth:f[0]<t&&t<f[1]?g:o};}:function(t,e,i){var n=e/(i-1);return{position:n*t,axisNameAvailableWidth:n};};h(r,function(t,n){var o=_(n,s,r.length),a={horizontal:{x:o.position,y:l},vertical:{x:0,y:o.position}},h={horizontal:c/2,vertical:0},d=[a[i].x+e.x,a[i].y+e.y],p=h[i],g=u.create();u.rotate(g,g,p),u.translate(g,g,d),this._axesLayout[t]={position:d,rotation:p,transform:g,axisNameAvailableWidth:o.axisNameAvailableWidth,tickDirection:1,labelDirection:1,axisExpandWindow:f};},this);},getAxis:function getAxis(t){return this._axesMap[t];},dataToPoint:function dataToPoint(t,e){return this.axisCoordToPoint(this._axesMap[e].dataToCoord(t),e);},eachActiveState:function eachActiveState(t,e,i){for(var n=this.dimensions,r=this._axesMap,o=this.hasAxisbrushed(),a=0,s=t.count();s>a;a++){var l,u=t.getValues(n,a);if(o){l="active";for(var h=0,c=n.length;c>h;h++){var d=n[h],f=r[d].model.getActiveState(u[h],h);if("inactive"===f){l="inactive";break;}}}else l="normal";e.call(i,l,a);}},hasAxisbrushed:function hasAxisbrushed(){for(var t=this.dimensions,e=this._axesMap,i=!1,n=0,r=t.length;r>n;n++){"normal"!==e[t[n]].model.getActiveState()&&(i=!0);}return i;},axisCoordToPoint:function axisCoordToPoint(t,e){var i=this._axesLayout[e];return l.applyTransform([t,0],i.transform);},getAxisLayout:function getAxisLayout(t){return a.clone(this._axesLayout[t]);},findClosestAxisDim:function findClosestAxisDim(t){var e,i=1/0;return a.each(this._axesLayout,function(n,r){var o=l.applyTransform(t,n.transform,!0),a=this._axesMap[r].getExtent();if(!(o[0]<a[0]||o[0]>a[1])){var s=Math.abs(o[1]);i>s&&(i=s,e=r);}},this),e;}},t.exports=n;},function(t,e,i){var n=i(4),r=i(123),o=function o(t,e,i,n,_o3){r.call(this,t,e,i),this.type=n||"value",this.axisIndex=_o3;};o.prototype={constructor:o,model:null},n.inherits(o,r),t.exports=o;},function(t,e,i){var n=i(4),r=i(19);i(230),r.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,parallelAxisDefault:null},init:function init(){r.prototype.init.apply(this,arguments),this.mergeOption({});},mergeOption:function mergeOption(t){var e=this.option;t&&n.merge(e,t,!0),this._initDimensions();},contains:function contains(t,e){var i=t.get("parallelIndex");return null!=i&&e.getComponent("parallel",i)===this;},setAxisExpand:function setAxisExpand(t){n.each(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth"],function(e){t.hasOwnProperty(e)&&(this.option[e]=t[e]);},this);},_initDimensions:function _initDimensions(){var t=this.dimensions=[],e=this.parallelAxisIndex=[],i=n.filter(this.dependentModels.parallelAxis,function(t){return t.get("parallelIndex")===this.componentIndex;});n.each(i,function(i){t.push("dim"+i.get("dim")),e.push(i.componentIndex);});}});},function(t,e,i){function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(4),a=i(15),s=i(127),l=i(7),u=r.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function getAreaSelectStyle(){return a([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]]).call(this.getModel("areaSelectStyle"));},setActiveIntervals:function setActiveIntervals(t){var e=this.activeIntervals=o.clone(t);if(e)for(var i=e.length-1;i>=0;i--){l.asc(e[i]);}},getActiveState:function getActiveState(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t)return"inactive";for(var i=0,n=e.length;n>i;i++){if(e[i][0]<=t&&t<=e[i][1])return"active";}return"inactive";}}),h={type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};o.merge(u.prototype,i(129)),s("parallel",u,n,h),t.exports=u;},function(t,e,i){i(226),i(232),i(233);},function(t,e,i){var n=i(1),r={type:"axisAreaSelect",event:"axisAreaSelected",update:"updateVisual"};n.registerAction(r,function(t,e){e.eachComponent({mainType:"parallelAxis",query:t},function(e){e.axis.model.setActiveIntervals(t.intervals);});}),n.registerAction("parallelAxisExpand",function(t,e){e.eachComponent({mainType:"parallel",query:t},function(e){e.setAxisExpand(t);});});},function(t,e,i){function n(t,e,i){return i&&"axisAreaSelect"===i.type&&e.findComponents({mainType:"parallelAxis",query:i})[0]===t;}var r=i(4),o=i(133),a=i(234),s=i(43),l=["axisLine","axisLabel","axisTick","axisName"],u=i(1).extendComponentView({type:"parallelAxis",init:function init(t,e){u.superApply(this,"init",arguments),(this._brushController=new a(e.getZr())).on("brush",r.bind(this._onBrush,this));},render:function render(t,e,i,a){if(!n(t,e,a)){this.axisModel=t,this.api=i,this.group.removeAll();var u=this._axisGroup;if(this._axisGroup=new s.Group(),this.group.add(this._axisGroup),t.get("show")){var h,c=e.getComponent("parallel",t.get("parallelIndex")).coordinateSystem,d=t.getAreaSelectStyle(),f=d.width,p=t.axis.dim,g=c.getAxisLayout(p),m=r.indexOf(c.dimensions,p),v=g.axisExpandWindow;v&&(m<=v[0]||m>=v[1])&&(h=!1);var y=r.extend({axisLabelShow:h,strokeContainThreshold:f},g),x=new o(t,y);r.each(l,x.add,x),this._axisGroup.add(x.getGroup()),this._refreshBrushController(y,d,t,f),s.groupTransition(u,this._axisGroup,t);}}},_refreshBrushController:function _refreshBrushController(t,e,i,n){var o=i.axis,a=r.map(i.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[o.dataToCoord(t[0],!0),o.dataToCoord(t[1],!0)]};}),l=o.getExtent(),u=l[1]-l[0],h=Math.min(30,.1*Math.abs(u)),c=s.BoundingRect.create({x:l[0],y:-n/2,width:u,height:n});c.x-=h,c.width+=2*h,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,position:t.position}).setPanels([{panelId:"pl",rect:c}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers(a);},_onBrush:function _onBrush(t,e){var i=this.axisModel,n=i.axis,o=r.map(t,function(t){return[n.coordToData(t.range[0],!0),n.coordToData(t.range[1],!0)];});(!i.option.realtime===e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:o});},dispose:function dispose(){this._brushController.dispose();}});t.exports=u;},function(t,e,i){function n(t){V.assert(t),N.call(this),this._zr=t,this.group=new G.Group(),this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,this._mounted,this._uid="brushController_"+it++,this._handlers={},Z(nt,function(t,e){this._handlers[e]=V.bind(t,this);},this);}function r(t,e){var i=t._zr;t._enableGlobalPan||F.take(i,K,t._uid),Z(t._handlers,function(t,e){i.on(e,t);}),t._brushType=e.brushType,t._brushOption=V.merge(V.clone(et),e,!0);}function o(t){var e=t._zr;F.release(e,K,t._uid),Z(t._handlers,function(t,i){e.off(i,t);}),t._brushType=t._brushOption=null;}function a(t,e){var i=rt[e.brushType].createCover(t,e);return u(i),i.__brushOption=e,t.group.add(i),i;}function s(t,e){var i=c(e);return i.endCreating&&(i.endCreating(t,e),u(e)),e;}function l(t,e){var i=e.__brushOption;c(e).updateCoverShape(t,e,i.range,i);}function u(t){t.traverse(function(t){t.z=Y,t.z2=Y;});}function h(t,e){c(e).updateCommon(t,e),l(t,e);}function c(t){return rt[t.__brushOption.brushType];}function d(t,e,i){var n=t._panels;if(!n)return!0;var r;return Z(n,function(t){t.contain(e,i)&&(r=t);}),r;}function f(t,e){var i=t._panels;if(!i)return!0;var n=e.__brushOption.panelId;return null!=n?i[n]:!0;}function p(t){var e=t._covers,i=e.length;return Z(e,function(e){t.group.remove(e);},t),e.length=0,!!i;}function g(t,e){var i=q(t._covers,function(t){var e=t.__brushOption,i=V.clone(e.range);return{brushType:e.brushType,panelId:e.panelId,range:i};});t.trigger("brush",i,{isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick});}function m(t){var e=t._track;if(!e.length)return!1;var i=e[e.length-1],n=e[0],r=i[0]-n[0],o=i[1]-n[1],a=X(r*r+o*o,.5);return a>$;}function v(t){var e=t.length-1;return 0>e&&(e=0),[t[0],t[e]];}function y(t,e,i,n){var r=new G.Group();return r.add(new G.Rect({name:"main",style:w(i),silent:!0,draggable:!0,cursor:"move",drift:W(t,e,r,"nswe"),ondragend:W(g,e,{isEnd:!0})})),Z(n,function(i){r.add(new G.Rect({name:i,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:W(t,e,r,i),ondragend:W(g,e,{isEnd:!0})}));}),r;}function x(t,e,i,n){var r=n.brushStyle.lineWidth||0,o=j(r,Q),a=i[0][0],s=i[1][0],l=a-r/2,u=s-r/2,h=i[0][1],c=i[1][1],d=h-o+r/2,f=c-o+r/2,p=h-a,g=c-s,m=p+r,v=g+r;b(t,e,"main",a,s,p,g),n.transformable&&(b(t,e,"w",l,u,o,v),b(t,e,"e",d,u,o,v),b(t,e,"n",l,u,m,o),b(t,e,"s",l,f,m,o),b(t,e,"nw",l,u,o,o),b(t,e,"ne",d,u,o,o),b(t,e,"sw",l,f,o,o),b(t,e,"se",d,f,o,o));}function _(t,e){var i=e.__brushOption,n=i.transformable,r=e.childAt(0);r.useStyle(w(i)),r.attr({silent:!n,cursor:n?"move":"default"}),Z(["w","e","n","s","se","sw","ne","nw"],function(i){var r=e.childOfName(i),o=I(t,i);r&&r.attr({silent:!n,invisible:!n,cursor:n?tt[o]+"-resize":null});});}function b(t,e,i,n,r,o,a){var s=e.childOfName(i);s&&s.setShape(D(C(t,e,[[n,r],[n+o,r+a]])));}function w(t){return V.defaults({strokeNoScale:!0},t.brushStyle);}function S(t,e,i,n){var r=[U(t,i),U(e,n)],o=[j(t,i),j(e,n)];return[[r[0],o[0]],[r[1],o[1]]];}function M(t){return G.getTransform(t.group);}function I(t,e){if(e.length>1){e=e.split("");var i=[I(t,e[0]),I(t,e[1])];return("e"===i[0]||"w"===i[0])&&i.reverse(),i.join("");}var n={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},i=G.transformDirection(n[e],M(t));return r[i];}function T(t,e,i,n,r,o,a,s){var l=n.__brushOption,u=t(l.range),c=L(i,o,a);Z(r.split(""),function(t){var e=J[t];u[e[0]][e[1]]+=c[e[0]];}),l.range=e(S(u[0][0],u[1][0],u[0][1],u[1][1])),h(i,n),g(i,{isEnd:!1});}function A(t,e,i,n,r){var o=e.__brushOption.range,a=L(t,i,n);Z(o,function(t){t[0]+=a[0],t[1]+=a[1];}),h(t,e),g(t,{isEnd:!1});}function L(t,e,i){var n=t.group,r=n.transformCoordToLocal(e,i),o=n.transformCoordToLocal(0,0);return[r[0]-o[0],r[1]-o[1]];}function C(t,e,i){var n=f(t,e);if(n===!0)return V.clone(i);var r=n.getBoundingRect();return V.map(i,function(t){var e=t[0];e=j(e,r.x),e=U(e,r.x+r.width);var i=t[1];return i=j(i,r.y),i=U(i,r.y+r.height),[e,i];});}function D(t){var e=U(t[0][0],t[1][0]),i=U(t[0][1],t[1][1]),n=j(t[0][0],t[1][0]),r=j(t[0][1],t[1][1]);return{x:e,y:i,width:n-e,height:r-i};}function P(t,e){var i=e.offsetX,n=e.offsetY,r=t._zr;if(t._brushType){for(var o,a=t._panels,s=t._covers,l=0;l<s.length;l++){if(rt[s[l].__brushOption.brushType].contain(s[l],i,n)){o=!0;break;}}o||(a?Z(a,function(t){t.contain(i,n)&&r.setCursorStyle("crosshair");}):r.setCursorStyle("crosshair"));}}function k(t){var e=t.event;e.preventDefault&&e.preventDefault();}function z(t,e,i){return t.childOfName("main").contain(e,i);}function O(t,e,i){var n,r=e.offsetX,o=e.offsetY,u=t._creatingCover,h=t._creatingPanel,c=t._brushOption;if(t._track.push(t.group.transformCoordToLocal(r,o)),m(t)||u){if(h&&!u){"single"===c.brushMode&&p(t);var f=V.clone(c);f.panelId=h===!0?null:h.__brushPanelId,u=t._creatingCover=a(t,f),t._covers.push(u);}if(u){var g=rt[t._brushType],v=u.__brushOption;v.range=g.getCreatingRange(C(t,u,t._track)),i&&(s(t,u),g.updateCommon(t,u)),l(t,u),n={isEnd:i};}}else i&&"single"===c.brushMode&&c.removeOnClick&&d(t,r,o)&&p(t)&&(n={isEnd:i,removeOnClick:!0});return n;}function E(t){if(this._dragging){k(t);var e=O(this,t,!0);this._dragging=!1,this._track=[],this._creatingCover=null,e&&g(this,e);}}function R(t){return{createCover:function createCover(e,i){return y(W(T,function(e){var i=[e,[0,100]];return t&&i.reverse(),i;},function(e){return e[t];}),e,i,[["w","e"],["n","s"]][t]);},getCreatingRange:function getCreatingRange(e){var i=v(e),n=U(i[0][t],i[1][t]),r=j(i[0][t],i[1][t]);return[n,r];},updateCoverShape:function updateCoverShape(e,i,n,r){var o,a=r.brushStyle.width;if(null==a){var s=f(e,i),l=0;if(s!==!0){var u=s.getBoundingRect();a=t?u.width:u.height,l=t?u.x:u.y;}o=[l,l+(a||0)];}else o=[-a/2,a/2];var h=[n,o];t&&h.reverse(),x(e,i,h,r);},updateCommon:_,contain:z};}var N=i(33),V=i(4),B=i(9),G=i(43),F=i(176),H=i(98),W=V.curry,Z=V.each,q=V.map,U=Math.min,j=Math.max,X=Math.pow,Y=1e4,$=6,Q=6,K="globalPan",J={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},tt={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},et={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},it=0;n.prototype={constructor:n,enableBrush:function enableBrush(t){return V.assert(this._mounted),this._brushType&&o(this),t.brushType&&r(this,t),this;},setPanels:function setPanels(t){var e=this._panels||{},i=this._panels=t&&t.length&&{},n=this.group;return i&&Z(t,function(t){var r=t.panelId,o=e[r];o||(o=new G.Rect({silent:!0,invisible:!0}),n.add(o));var a=t.rect;a instanceof B||(a=B.create(a)),o.attr("shape",a.plain()),o.__brushPanelId=r,i[r]=o,e[r]=null;}),Z(e,function(t){t&&n.remove(t);}),this;},mount:function mount(t){t=t||{},this._mounted=!0,this._enableGlobalPan=t.enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({position:t.position||[0,0],rotation:t.rotation||0,scale:t.scale||[1,1]}),this;},eachCover:function eachCover(t,e){Z(this._covers,t,e);},updateCovers:function updateCovers(t){function e(t,e){return(null!=t.id?t.id:o+e)+"-"+t.brushType;}function i(t,i){return e(t.__brushOption,i);}function n(e,i){var n=t[e];if(null!=i&&l[i]===d)u[e]=l[i];else{var r=u[e]=null!=i?(l[i].__brushOption=n,l[i]):s(c,a(c,n));h(c,r);}}function r(t){l[t]!==d&&c.group.remove(l[t]);}V.assert(this._mounted),t=V.map(t,function(t){return V.merge(V.clone(et),t,!0);});var o="\x00-brush-index-",l=this._covers,u=this._covers=[],c=this,d=this._creatingCover;return new H(l,t,i,e).add(n).update(n).remove(r).execute(),this;},unmount:function unmount(){return this.enableBrush(!1),p(this),this._zr.remove(this.group),this._mounted=!1,this;},dispose:function dispose(){this.unmount(),this.off();}},V.mixin(n,N);var nt={mousedown:function mousedown(t){if(this._dragging)E.call(this,t);else if(!t.target||!t.target.draggable){k(t);var e=t.offsetX,i=t.offsetY;this._creatingCover=null;var n=this._creatingPanel=d(this,e,i);n&&(this._dragging=!0,this._track=[this.group.transformCoordToLocal(e,i)]);}},mousemove:function mousemove(t){if(P(this,t),this._dragging){k(t);var e=O(this,t,!1);e&&g(this,e);}},mouseup:E},rt={lineX:R(0),lineY:R(1),rect:{createCover:function createCover(t,e){return y(W(T,function(t){return t;},function(t){return t;}),t,e,["w","e","n","s","se","sw","ne","nw"]);},getCreatingRange:function getCreatingRange(t){var e=v(t);return S(e[1][0],e[1][1],e[0][0],e[0][1]);},updateCoverShape:function updateCoverShape(t,e,i,n){x(t,e,i,n);},updateCommon:_,contain:z},polygon:{createCover:function createCover(t,e){var i=new G.Group();return i.add(new G.Polyline({name:"main",style:w(e),silent:!0})),i;},getCreatingRange:function getCreatingRange(t){return t;},endCreating:function endCreating(t,e){e.remove(e.childAt(0)),e.add(new G.Polygon({name:"main",draggable:!0,drift:W(A,t,e),ondragend:W(g,t,{isEnd:!0})}));},updateCoverShape:function updateCoverShape(t,e,i,n){e.childAt(0).setShape({points:C(t,e,i)});},updateCommon:_,contain:z}};t.exports=n;},function(t,e,i){function n(t){if(!t.parallel){var e=!1;o.each(t.series,function(t){t&&"parallel"===t.type&&(e=!0);}),e&&(t.parallel=[{}]);}}function r(t){var e=a.normalizeToArray(t.parallelAxis);o.each(e,function(e){if(o.isObject(e)){var i=e.parallelIndex||0,n=a.normalizeToArray(t.parallel)[i];n&&n.parallelAxisDefault&&o.merge(e,n.parallelAxisDefault,!1);}});}var o=i(4),a=i(5);t.exports=function(t){n(t),r(t);};},function(t,e,i){function n(t,e,i){var n=t.get("data"),o=r(e);n&&n.length&&s.each(i,function(t){if(t){var e=s.indexOf(n,t[o]);t[o]=e>=0?e:NaN;}});}function r(t){return+t.replace("dim","");}function o(t,e){var i=0;s.each(t,function(t){var e=r(t);e>i&&(i=e);});var n=e[0];n&&n.length-1>i&&(i=n.length-1);for(var o=[],a=0;i>=a;a++){o.push("dim"+a);}return o;}var a=i(97),s=i(4),l=i(28),u=i(102);t.exports=l.extend({type:"series.parallel",dependencies:["parallel"],getInitialData:function getInitialData(t,e){var i=e.getComponent("parallel",this.get("parallelIndex")),r=i.parallelAxisIndex,l=t.data,h=i.dimensions,c=o(h,l),d=s.map(c,function(t,i){var o=s.indexOf(h,t),a=o>=0&&e.getComponent("parallelAxis",r[o]);return a&&"category"===a.get("type")?(n(a,t,l),{name:t,type:"ordinal"}):0>o&&u.guessOrdinal(l,i)?{name:t,type:"ordinal"}:t;}),f=new a(d,this);return f.initData(l),this.option.progressive&&(this.option.animation=!1),f;},getRawIndicesByActiveState:function getRawIndicesByActiveState(t){var e=this.coordinateSystem,i=this.getData(),n=[];return e.eachActiveState(i,function(e,r){t===e&&n.push(i.getRawIndex(r));}),n;},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{normal:{show:!1},emphasis:{show:!1}},inactiveOpacity:.05,activeOpacity:1,lineStyle:{normal:{width:1,opacity:.45,type:"solid"}},progressive:!1,smooth:!1,animationEasing:"linear"}});},function(t,e,i){function n(t,e,i){var n=t.model,r=t.getRect(),o=new l.Rect({shape:{x:r.x,y:r.y,width:r.width,height:r.height}}),a="horizontal"===n.get("layout")?"width":"height";return o.setShape(a,0),l.initProps(o,{shape:{width:r.width,height:r.height}},e,i),o;}function r(t,e,i,n){for(var r=[],o=0;o<i.length;o++){var a=i[o],l=t.get(a,e);s(l,n.getAxis(a).type)||r.push(n.dataToPoint(l,a));}return r;}function o(t,e,i,n,o){var a=r(t,i,n,o),s=new l.Polyline({shape:{points:a},silent:!0,z2:10});e.add(s),t.setItemGraphicEl(i,s);}function a(t,e){var i=t.hostModel.getModel("lineStyle.normal"),n=i.getLineStyle();t.eachItemGraphicEl(function(r,o){if(t.hasItemOption){var a=t.getItemModel(o),s=a.getModel("lineStyle.normal",i);n=s.getLineStyle();}r.useStyle(u.extend(n,{fill:null,stroke:t.getItemVisual(o,"color"),opacity:t.getItemVisual(o,"opacity")})),r.shape.smooth=e;});}function s(t,e){return"category"===e?null==t:null==t||isNaN(t);}var l=i(43),u=i(4),h=.3,c=i(42).extend({type:"parallel",init:function init(){this._dataGroup=new l.Group(),this.group.add(this._dataGroup),this._data;},render:function render(t,e,i,n){this._renderForNormal(t);},dispose:function dispose(){},_renderForNormal:function _renderForNormal(t){function e(t){o(c,u,t,p,f,null,m);}function i(e,i){var n=d.getItemGraphicEl(i),o=r(c,e,p,f);c.setItemGraphicEl(e,n),l.updateProps(n,{shape:{points:o}},t,e);}function s(t){var e=d.getItemGraphicEl(t);u.remove(e);}var u=this._dataGroup,c=t.getData(),d=this._data,f=t.coordinateSystem,p=f.dimensions,g=t.option,m=g.smooth?h:null;if(c.diff(d).add(e).update(i).remove(s).execute(),a(c,m),!this._data){var v=n(f,t,function(){setTimeout(function(){u.removeClipPath();});});u.setClipPath(v);}this._data=c;},remove:function remove(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null;}});t.exports=c;},function(t,e){t.exports=function(t){t.eachSeriesByType("parallel",function(e){var i=e.getModel("itemStyle.normal"),n=e.getModel("lineStyle.normal"),r=t.get("color"),o=n.get("color")||i.get("color")||r[e.seriesIndex%r.length],a=e.get("inactiveOpacity"),s=e.get("activeOpacity"),l=e.getModel("lineStyle.normal").getLineStyle(),u=e.coordinateSystem,h=e.getData(),c={normal:l.opacity,active:s,inactive:a};u.eachActiveState(h,function(t,e){h.setItemVisual(e,"opacity",c[t]);}),h.setVisual("color",o);});};},function(t,e,i){var n=i(1);i(240),i(241),n.registerLayout(i(242)),n.registerVisual(i(244));},function(t,e,i){var n=i(28),r=i(197),o=n.extend({type:"series.sankey",layoutInfo:null,getInitialData:function getInitialData(t){var e=t.edges||t.links,i=t.data||t.nodes;if(i&&e){var n=r(i,e,this,!0);return n.data;}},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},formatTooltip:function formatTooltip(t,e,i){if("edge"===i){var n=this.getDataParams(t,i),r=n.data,a=r.source+" -- "+r.target;return n.value&&(a+=" : "+n.value),a;}return o.superCall(this,"formatTooltip",t,e);},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",nodeWidth:20,nodeGap:8,layoutIterations:32,label:{normal:{show:!0,position:"right",textStyle:{color:"#000",fontSize:12}},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:1,borderColor:"#333"}},lineStyle:{normal:{color:"#314656",opacity:.2,curveness:.5},emphasis:{opacity:.6}},animationEasing:"linear",animationDuration:1e3}});t.exports=o;},function(t,e,i){function n(t,e,i){var n=new r.Rect({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return r.initProps(n,{shape:{width:t.width+20,height:t.height+20}},e,i),n;}var r=i(43),o=i(4),a=r.extendShape({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0},buildPath:function buildPath(t,e){var i=e.extent/2;t.moveTo(e.x1,e.y1-i),t.bezierCurveTo(e.cpx1,e.cpy1-i,e.cpx2,e.cpy2-i,e.x2,e.y2-i),t.lineTo(e.x2,e.y2+i),t.bezierCurveTo(e.cpx2,e.cpy2+i,e.cpx1,e.cpy1+i,e.x1,e.y1+i),t.closePath();}});t.exports=i(1).extendChartView({type:"sankey",_model:null,render:function render(t,e,i){var s=t.getGraph(),l=this.group,u=t.layoutInfo,h=t.getData(),c=t.getData("edge");this._model=t,l.removeAll(),l.position=[u.x,u.y],s.eachEdge(function(e){var i=new a();i.dataIndex=e.dataIndex,i.seriesIndex=t.seriesIndex,i.dataType="edge";var n=e.getModel("lineStyle.normal"),o=n.get("curveness"),s=e.node1.getLayout(),u=e.node2.getLayout(),h=e.getLayout();i.shape.extent=Math.max(1,h.dy);var d=s.x+s.dx,f=s.y+h.sy+h.dy/2,p=u.x,g=u.y+h.ty+h.dy/2,m=d*(1-o)+p*o,v=f,y=d*o+p*(1-o),x=g;switch(i.setShape({x1:d,y1:f,x2:p,y2:g,cpx1:m,cpy1:v,cpx2:y,cpy2:x}),i.setStyle(n.getItemStyle()),i.style.fill){case"source":i.style.fill=e.node1.getVisual("color");break;case"target":i.style.fill=e.node2.getVisual("color");}r.setHoverStyle(i,e.getModel("lineStyle.emphasis").getItemStyle()),l.add(i),c.setItemGraphicEl(e.dataIndex,i);}),s.eachNode(function(e){var i=e.getLayout(),n=e.getModel(),a=n.getModel("label.normal"),s=a.getModel("textStyle"),u=n.getModel("label.emphasis"),c=u.getModel("textStyle"),d=new r.Rect({shape:{x:i.x,y:i.y,width:e.getLayout().dx,height:e.getLayout().dy},style:{text:a.get("show")?t.getFormattedLabel(e.dataIndex,"normal")||e.id:"",textFont:s.getFont(),textFill:s.getTextColor(),textPosition:a.get("position")}});d.setStyle(o.defaults({fill:e.getVisual("color")},n.getModel("itemStyle.normal").getItemStyle())),r.setHoverStyle(d,o.extend(e.getModel("itemStyle.emphasis"),{text:u.get("show")?t.getFormattedLabel(e.dataIndex,"emphasis")||e.id:"",textFont:c.getFont(),textFill:c.getTextColor(),textPosition:u.get("position")})),l.add(d),h.setItemGraphicEl(e.dataIndex,d),d.dataType="node";}),!this._data&&t.get("animation")&&l.setClipPath(n(l.getBoundingRect(),t,function(){l.removeClipPath();})),this._data=t.getData();},dispose:function dispose(){}});},function(t,e,i){function n(t,e){return M.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}function r(t,e,i,n,r,o,s){a(t,i,r),u(t,e,o,n,s),m(t);}function o(t){T.each(t,function(t){var e=x(t.outEdges,S),i=x(t.inEdges,S),n=Math.max(e,i);t.setLayout({value:n},!0);});}function a(t,e,i){for(var n=t,r=null,o=0,a=0;n.length;){r=[];for(var u=0,h=n.length;h>u;u++){var c=n[u];c.setLayout({x:o},!0),c.setLayout({dx:e},!0);for(var d=0,f=c.outEdges.length;f>d;d++){r.push(c.outEdges[d].node2);}}n=r,++o;}s(t,o),a=(i-e)/(o-1),l(t,a);}function s(t,e){T.each(t,function(t){t.outEdges.length||t.setLayout({x:e-1},!0);});}function l(t,e){T.each(t,function(t){var i=t.getLayout().x*e;t.setLayout({x:i},!0);});}function u(t,e,i,n,r){var o=I().key(function(t){return t.getLayout().x;}).sortKeys(w).entries(t).map(function(t){return t.values;});h(t,o,e,i,n),c(o,n,i);for(var a=1;r>0;r--){a*=.99,d(o,a),c(o,n,i),p(o,a),c(o,n,i);}}function h(t,e,i,n,r){var o=[];T.each(e,function(t){var e=t.length,i=0;T.each(t,function(t){i+=t.getLayout().value;});var a=(n-(e-1)*r)/i;o.push(a);}),o.sort(function(t,e){return t-e;});var a=o[0];T.each(e,function(t){T.each(t,function(t,e){t.setLayout({y:e},!0);var i=t.getLayout().value*a;t.setLayout({dy:i},!0);});}),T.each(i,function(t){var e=+t.getValue()*a;t.setLayout({dy:e},!0);});}function c(t,e,i){T.each(t,function(t){var n,r,o,a=0,s=t.length;for(t.sort(b),o=0;s>o;o++){if(n=t[o],r=a-n.getLayout().y,r>0){var l=n.getLayout().y+r;n.setLayout({y:l},!0);}a=n.getLayout().y+n.getLayout().dy+e;}if(r=a-e-i,r>0){var l=n.getLayout().y-r;for(n.setLayout({y:l},!0),a=n.getLayout().y,o=s-2;o>=0;--o){n=t[o],r=n.getLayout().y+n.getLayout().dy+e-a,r>0&&(l=n.getLayout().y-r,n.setLayout({y:l},!0)),a=n.getLayout().y;}}});}function d(t,e){T.each(t.slice().reverse(),function(t){T.each(t,function(t){if(t.outEdges.length){var i=x(t.outEdges,f)/x(t.outEdges,S),n=t.getLayout().y+(i-_(t))*e;t.setLayout({y:n},!0);}});});}function f(t){return _(t.node2)*t.getValue();}function p(t,e){T.each(t,function(t){T.each(t,function(t){if(t.inEdges.length){var i=x(t.inEdges,g)/x(t.inEdges,S),n=t.getLayout().y+(i-_(t))*e;t.setLayout({y:n},!0);}});});}function g(t){return _(t.node1)*t.getValue();}function m(t){T.each(t,function(t){t.outEdges.sort(v),t.inEdges.sort(y);}),T.each(t,function(t){var e=0,i=0;T.each(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy;}),T.each(t.inEdges,function(t){t.setLayout({ty:i},!0),i+=t.getLayout().dy;});});}function v(t,e){return t.node2.getLayout().y-e.node2.getLayout().y;}function y(t,e){return t.node1.getLayout().y-e.node1.getLayout().y;}function x(t,e){for(var i=0,n=t.length,r=-1;++r<n;){var o=+e.call(t,t[r],r);isNaN(o)||(i+=o);}return i;}function _(t){return t.getLayout().y+t.getLayout().dy/2;}function b(t,e){return t.getLayout().y-e.getLayout().y;}function w(t,e){return e>t?-1:t>e?1:t===e?0:NaN;}function S(t){return t.getValue();}var M=i(21),I=i(243),T=i(4);t.exports=function(t,e,i){t.eachSeriesByType("sankey",function(t){var i=t.get("nodeWidth"),a=t.get("nodeGap"),s=n(t,e);t.layoutInfo=s;var l=s.width,u=s.height,h=t.getGraph(),c=h.nodes,d=h.edges;o(c);var f=c.filter(function(t){return 0===t.getLayout().value;}),p=0!==f.length?0:t.get("layoutIterations");r(c,d,i,a,l,u,p);});};},function(t,e,i){function n(){function t(e,n){if(n>=i.length)return e;for(var o=-1,a=e.length,s=i[n++],l={},u={};++o<a;){var h=s(e[o]),c=u[h];c?c.push(e[o]):u[h]=[e[o]];}return r.each(u,function(e,i){l[i]=t(e,n);}),l;}function e(t,o){if(o>=i.length)return t;var a=[],s=n[o++];return r.each(t,function(t,i){a.push({key:i,values:e(t,o)});}),s?a.sort(function(t,e){return s(t.key,e.key);}):a;}var i=[],n=[];return{key:function key(t){return i.push(t),this;},sortKeys:function sortKeys(t){return n[i.length-1]=t,this;},entries:function entries(i){return e(t(i,0),0);}};}var r=i(4);t.exports=n;},function(t,e,i){var n=i(193);t.exports=function(t,e){t.eachSeriesByType("sankey",function(t){var e=t.getGraph(),i=e.nodes;i.sort(function(t,e){return t.getLayout().value-e.getLayout().value;});var r=i[0].getLayout().value,o=i[i.length-1].getLayout().value;i.forEach(function(e){var i=new n({type:"color",mappingMethod:"linear",dataExtent:[r,o],visual:t.get("color")}),a=i.mapValueToVisual(e.getLayout().value);e.setVisual("color",a);var s=e.getModel(),l=s.get("itemStyle.normal.color");null!=l&&e.setVisual("color",l);});});};},function(t,e,i){var n=i(1);i(246),i(249),n.registerVisual(i(250)),n.registerLayout(i(251));},function(t,e,i){"use strict";var n=i(4),r=i(28),o=i(247),a=r.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],valueDimensions:["min","Q1","median","Q3","max"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{normal:{color:"#fff",borderWidth:1},emphasis:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}});n.mixin(a,o.seriesModelMixin,!0),t.exports=a;},function(t,e,i){"use strict";function n(t){return null==t.value?t:t.value;}var r=i(97),o=i(102),a=i(248),s=i(4),l={_baseAxisDim:null,getInitialData:function getInitialData(t,e){var i,a,s=e.getComponent("xAxis",this.get("xAxisIndex")),l=e.getComponent("yAxis",this.get("yAxisIndex")),u=s.get("type"),h=l.get("type");"category"===u?(t.layout="horizontal",i=s.getCategories(),a=!0):"category"===h?(t.layout="vertical",i=l.getCategories(),a=!0):t.layout=t.layout||"horizontal",this._baseAxisDim="horizontal"===t.layout?"x":"y";var c=t.data,d=this.dimensions=["base"].concat(this.valueDimensions);o(d,c);var f=new r(d,this);return f.initData(c,i?i.slice():null,function(t,e,i,r){var o=n(t);return a?"base"===e?i:o[r-1]:o[r];}),f;},coordDimToDataDim:function coordDimToDataDim(t){var e=this.valueDimensions.slice(),i=["base"],n={horizontal:{x:i,y:e},vertical:{x:e,y:i}};return n[this.get("layout")][t];},dataDimToCoordDim:function dataDimToCoordDim(t){var e;return s.each(["x","y"],function(i,n){var r=this.coordDimToDataDim(i);s.indexOf(r,t)>=0&&(e=i);},this),e;},getBaseAxis:function getBaseAxis(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis;}},u={init:function init(){var t=this._whiskerBoxDraw=new a(this.getStyleUpdater());this.group.add(t.group);},render:function render(t,e,i){this._whiskerBoxDraw.updateData(t.getData());},remove:function remove(t){this._whiskerBoxDraw.remove();}};t.exports={seriesModelMixin:l,viewMixin:u};},function(t,e,i){function n(t,e,i,n){l.Group.call(this),this.bodyIndex,this.whiskerIndex,this.styleUpdater=i,this._createContent(t,e,n),this.updateData(t,e,n),this._seriesModel;}function r(t,e,i){return s.map(t,function(t){return t=t.slice(),t[e]=i.initBaseline,t;});}function o(t){var e={};return s.each(t,function(t,i){e["ends"+i]=t;}),e;}function a(t){this.group=new l.Group(),this.styleUpdater=t;}var s=i(4),l=i(43),u=i(45),h=u.extend({type:"whiskerInBox",shape:{},buildPath:function buildPath(t,e){for(var i in e){if(e.hasOwnProperty(i)&&0===i.indexOf("ends")){var n=e[i];t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]);}}}}),c=n.prototype;c._createContent=function(t,e,i){var n=t.getItemLayout(e),a="horizontal"===n.chartLayout?1:0,u=0;this.add(new l.Polygon({shape:{points:i?r(n.bodyEnds,a,n):n.bodyEnds},style:{strokeNoScale:!0},z2:100})),this.bodyIndex=u++;var c=s.map(n.whiskerEnds,function(t){return i?r(t,a,n):t;});this.add(new h({shape:o(c),style:{strokeNoScale:!0},z2:100})),this.whiskerIndex=u++;},c.updateData=function(t,e,i){var n=this._seriesModel=t.hostModel,r=t.getItemLayout(e),a=l[i?"initProps":"updateProps"];a(this.childAt(this.bodyIndex),{shape:{points:r.bodyEnds}},n,e),a(this.childAt(this.whiskerIndex),{shape:o(r.whiskerEnds)},n,e),this.styleUpdater.call(null,this,t,e);},s.inherits(n,l.Group);var d=a.prototype;d.updateData=function(t){var e=this.group,i=this._data,r=this.styleUpdater;t.diff(i).add(function(i){if(t.hasValue(i)){var o=new n(t,i,r,!0);t.setItemGraphicEl(i,o),e.add(o);}}).update(function(o,a){var s=i.getItemGraphicEl(a);return t.hasValue(o)?(s?s.updateData(t,o):s=new n(t,o,r),e.add(s),void t.setItemGraphicEl(o,s)):void e.remove(s);}).remove(function(t){var n=i.getItemGraphicEl(t);n&&e.remove(n);}).execute(),this._data=t;},d.remove=function(){var t=this.group,e=this._data;this._data=null,e&&e.eachItemGraphicEl(function(e){e&&t.remove(e);});},t.exports=a;},function(t,e,i){"use strict";function n(t,e,i){var n=e.getItemModel(i),r=n.getModel(u),o=e.getItemVisual(i,"color"),s=r.getItemStyle(["borderColor"]),l=t.childAt(t.whiskerIndex);l.style.set(s),l.style.stroke=o,l.dirty();var c=t.childAt(t.bodyIndex);c.style.set(s),c.style.stroke=o,c.dirty();var d=n.getModel(h).getItemStyle();a.setHoverStyle(t,d);}var r=i(4),o=i(42),a=i(43),s=i(247),l=o.extend({type:"boxplot",getStyleUpdater:function getStyleUpdater(){return n;},dispose:r.noop});r.mixin(l,s.viewMixin,!0);var u=["itemStyle","normal"],h=["itemStyle","emphasis"];t.exports=l;},function(t,e){var i=["itemStyle","normal","borderColor"];t.exports=function(t,e){var n=t.get("color");t.eachRawSeriesByType("boxplot",function(e){var r=n[e.seriesIndex%n.length],o=e.getData();o.setVisual({legendSymbol:"roundRect",color:e.get(i)||r}),t.isSeriesFiltered(e)||o.each(function(t){var e=o.getItemModel(t);o.setItemVisual(t,{color:e.get(i,!0)});});});};},function(t,e,i){function n(t){var e=[],i=[];return t.eachSeriesByType("boxplot",function(t){var n=t.getBaseAxis(),r=a.indexOf(i,n);0>r&&(r=i.length,i[r]=n,e[r]={axis:n,seriesModels:[]}),e[r].seriesModels.push(t);}),e;}function r(t){var e,i,n=t.axis,r=t.seriesModels,o=r.length,s=t.boxWidthList=[],h=t.boxOffsetList=[],c=[];if("category"===n.type)i=n.getBandWidth();else{var d=0;u(r,function(t){d=Math.max(d,t.getData().count());}),e=n.getExtent(),Math.abs(e[1]-e[0])/d;}u(r,function(t){var e=t.get("boxWidth");a.isArray(e)||(e=[e,e]),c.push([l(e[0],i)||0,l(e[1],i)||0]);});var f=.8*i-2,p=f/o*.3,g=(f-p*(o-1))/o,m=g/2-f/2;u(r,function(t,e){h.push(m),m+=p+g,s.push(Math.min(Math.max(g,c[e][0]),c[e][1]));});}function o(t,e,i){var n=t.coordinateSystem,r=t.getData(),o=t.dimensions,a=t.get("layout"),s=i/2;r.each(o,function(){function t(t){var i=[];i[f]=c,i[p]=t;var r;return isNaN(c)||isNaN(t)?r=[NaN,NaN]:(r=n.dataToPoint(i),r[f]+=e),r;}function i(t,e){var i=t.slice(),n=t.slice();i[f]+=s,n[f]-=s,e?x.push(i,n):x.push(n,i);}function l(t){var e=[t.slice(),t.slice()];e[0][f]-=s,e[1][f]+=s,y.push(e);}var u=arguments,h=o.length,c=u[0],d=u[h],f="horizontal"===a?0:1,p=1-f,g=t(u[3]),m=t(u[1]),v=t(u[5]),y=[[m,t(u[2])],[v,t(u[4])]];l(m),l(v),l(g);var x=[];i(y[0][1],0),i(y[1][1],1),r.setItemLayout(d,{chartLayout:a,initBaseline:g[p],median:g,bodyEnds:x,whiskerEnds:y});});}var a=i(4),s=i(7),l=s.parsePercent,u=a.each;t.exports=function(t){var e=n(t);u(e,function(t){var e=t.seriesModels;e.length&&(r(t),u(e,function(e,i){o(e,t.boxOffsetList[i],t.boxWidthList[i]);}));});};},function(t,e,i){var n=i(1);i(253),i(254),n.registerPreprocessor(i(255)),n.registerVisual(i(256)),n.registerLayout(i(257));},function(t,e,i){"use strict";var n=i(4),r=i(28),o=i(247),a=i(6),s=a.encodeHTML,l=a.addCommas,u=r.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],valueDimensions:["open","close","lowest","highest"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,itemStyle:{normal:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{borderWidth:2}},animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function getShadowDim(){return"open";},formatTooltip:function formatTooltip(t,e){var i=n.map(this.valueDimensions,function(e){return e+": "+l(this._data.get(e,t));},this);return s(this.name)+"<br />"+i.join("<br />");},brushSelector:function brushSelector(t,e){return e.rect(t.brushRect);}});n.mixin(u,o.seriesModelMixin,!0),t.exports=u;},function(t,e,i){"use strict";function n(t,e,i){var n=e.getItemModel(i),r=n.getModel(u),o=e.getItemVisual(i,"color"),s=e.getItemVisual(i,"borderColor")||o,l=r.getItemStyle(["color","color0","borderColor","borderColor0"]),c=t.childAt(t.whiskerIndex);c.useStyle(l),c.style.stroke=s;var d=t.childAt(t.bodyIndex);d.useStyle(l),d.style.fill=o,d.style.stroke=s;var f=n.getModel(h).getItemStyle();a.setHoverStyle(t,f);}var r=i(4),o=i(42),a=i(43),s=i(247),l=o.extend({type:"candlestick",getStyleUpdater:function getStyleUpdater(){return n;},dispose:r.noop});r.mixin(l,s.viewMixin,!0);var u=["itemStyle","normal"],h=["itemStyle","emphasis"];t.exports=l;},function(t,e,i){var n=i(4);t.exports=function(t){t&&n.isArray(t.series)&&n.each(t.series,function(t){n.isObject(t)&&"k"===t.type&&(t.type="candlestick");});};},function(t,e){var i=["itemStyle","normal","borderColor"],n=["itemStyle","normal","borderColor0"],r=["itemStyle","normal","color"],o=["itemStyle","normal","color0"];t.exports=function(t,e){t.eachRawSeriesByType("candlestick",function(e){var a=e.getData();a.setVisual({legendSymbol:"roundRect"}),t.isSeriesFiltered(e)||a.each(function(t){var e=a.getItemModel(t),s=a.getItemLayout(t).sign;a.setItemVisual(t,{color:e.get(s>0?r:o),borderColor:e.get(s>0?i:n)});});});};},function(t,e){function i(t,e){var i,a=t.getBaseAxis(),s="category"===a.type?a.getBandWidth():(i=a.getExtent(),Math.abs(i[1]-i[0])/e.count());return s/2-2>r?s/2-2:s-r>o?r:Math.max(s-o,n);}var n=2,r=5,o=4;t.exports=function(t){t.eachSeriesByType("candlestick",function(t){var e=t.coordinateSystem,n=t.getData(),r=t.dimensions,o=t.get("layout"),a=i(t,n);n.each(r,function(){function t(t){var i=[];return i[d]=h,i[f]=t,isNaN(h)||isNaN(t)?[NaN,NaN]:e.dataToPoint(i);}function i(t,e){var i=t.slice(),n=t.slice();i[d]+=a/2,n[d]-=a/2,e?I.push(i,n):I.push(n,i);}function s(){var e=t(Math.min(p,g,m,v)),i=t(Math.max(p,g,m,v));return e[d]-=a/2,i[d]-=a/2,{x:e[0],y:e[1],width:f?a:i[0]-e[0],height:f?i[1]-e[1]:a};}var l=arguments,u=r.length,h=l[0],c=l[u],d="horizontal"===o?0:1,f=1-d,p=l[1],g=l[2],m=l[3],v=l[4],y=Math.min(p,g),x=Math.max(p,g),_=t(y),b=t(x),w=t(m),S=t(v),M=[[S,b],[w,_]],I=[];i(b,0),i(_,1),n.setItemLayout(c,{chartLayout:o,sign:p>g?-1:g>p?1:0,initBaseline:p>g?b[f]:_[f],bodyEnds:I,whiskerEnds:M,brushRect:s()});},!0);});};},function(t,e,i){var n=i(4),r=i(1);i(259),i(260),r.registerVisual(n.curry(i(109),"effectScatter","circle",null)),r.registerLayout(n.curry(i(110),"effectScatter"));},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=n(t.data,this,e);return i;},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});},function(t,e,i){var n=i(104),r=i(261);i(1).extendChartView({type:"effectScatter",init:function init(){this._symbolDraw=new n(r);},render:function render(t,e,i){var n=t.getData(),r=this._symbolDraw;r.updateData(n),this.group.add(r.group);},updateLayout:function updateLayout(){this._symbolDraw.updateLayout();},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(e);},dispose:function dispose(){}});},function(t,e,i){function n(t){return a.isArray(t)||(t=[+t,+t]),t;}function r(t,e){t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?e.color:null,fill:"fill"===e.brushType?e.color:null}});});}function o(t,e){c.call(this);var i=new h(t,e),n=new c();this.add(i),this.add(n),n.beforeUpdate=function(){this.attr(i.getScale());},this.updateData(t,e);}var a=i(4),s=i(106),l=i(43),u=i(7),h=i(105),c=l.Group,d=3,f=o.prototype;f.stopEffectAnimation=function(){this.childAt(1).removeAll();},f.startEffectAnimation=function(t){for(var e=t.symbolType,i=t.color,n=this.childAt(1),o=0;d>o;o++){var a=s.createSymbol(e,-1,-1,2,2,i);a.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var l=-o/d*t.period+t.effectOffset;a.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(l).start(),a.animateStyle(!0).when(t.period,{opacity:0}).delay(l).start(),n.add(a);}r(n,t);},f.updateEffectAnimation=function(t){for(var e=this._effectCfg,i=this.childAt(1),n=["symbolType","period","rippleScale"],o=0;n>o;o++){var a=n[o];if(e[a]!==t[a])return this.stopEffectAnimation(),void this.startEffectAnimation(t);}r(i,t);},f.highlight=function(){this.trigger("emphasis");},f.downplay=function(){this.trigger("normal");},f.updateData=function(t,e){var i=t.hostModel;this.childAt(0).updateData(t,e);var r=this.childAt(1),o=t.getItemModel(e),a=t.getItemVisual(e,"symbol"),s=n(t.getItemVisual(e,"symbolSize")),l=t.getItemVisual(e,"color");r.attr("scale",s),r.traverse(function(t){t.attr({fill:l});});var h=o.getShallow("symbolOffset");if(h){var c=r.position;c[0]=u.parsePercent(h[0],s[0]),c[1]=u.parsePercent(h[1],s[1]);}r.rotation=(o.getShallow("symbolRotate")||0)*Math.PI/180||0;var d={};if(d.showEffectOn=i.get("showEffectOn"),d.rippleScale=o.get("rippleEffect.scale"),d.brushType=o.get("rippleEffect.brushType"),d.period=1e3*o.get("rippleEffect.period"),d.effectOffset=e/t.count(),d.z=o.getShallow("z")||0,d.zlevel=o.getShallow("zlevel")||0,d.symbolType=a,d.color=l,this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===d.showEffectOn)this._effectCfg?this.updateEffectAnimation(d):this.startEffectAnimation(d),this._effectCfg=d;else{this._effectCfg=null,this.stopEffectAnimation();var f=this.childAt(0),p=function p(){f.trigger("emphasis"),"render"!==d.showEffectOn&&this.startEffectAnimation(d);},g=function g(){f.trigger("normal"),"render"!==d.showEffectOn&&this.stopEffectAnimation();};this.on("mouseover",p,this).on("mouseout",g,this).on("emphasis",p,this).on("normal",g,this);}this._effectCfg=d;},f.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t();},a.inherits(o,c),t.exports=o;},function(t,e,i){i(263),i(264);var n=i(1);n.registerLayout(i(269));},function(t,e,i){"use strict";function n(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(console.warn("Lines data configuration has been changed to { coords:[[1,2],[2,3]] }"),t.data=a.map(e,function(t){var e=[t[0].coord,t[1].coord],i={coords:e};return t[0].name&&(i.fromName=t[0].name),t[1].name&&(i.toName=t[1].name),a.mergeAll([i,t[0],t[1]]);}));}var r=i(28),o=i(97),a=i(4),s=i(26),l=r.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.normal.color",init:function init(t){n(t),l.superApply(this,"init",arguments);},mergeOption:function mergeOption(t){n(t),l.superApply(this,"mergeOption",arguments);},getInitialData:function getInitialData(t,e){var i=s.get(t.coordinateSystem);if(!i)throw new Error("Unkown coordinate system "+t.coordinateSystem);var n=new o(["value"],this);return n.hasItemOption=!1,n.initData(t.data,[],function(t,e,i,r){if(t instanceof Array)return NaN;n.hasItemOption=!0;var o=t.value;return null!=o?o instanceof Array?o[r]:o:void 0;}),n;},formatTooltip:function formatTooltip(t){var e=this.getData(),i=e.getItemModel(t),n=i.get("name");if(n)return n;var r=i.get("fromName"),o=i.get("toName");return r+" > "+o;},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,label:{normal:{show:!1,position:"end"}},lineStyle:{normal:{opacity:.5}}}});},function(t,e,i){var n=i(200),r=i(265),o=i(201),a=i(266),s=i(267),l=i(268);i(1).extendChartView({type:"lines",init:function init(){},render:function render(t,e,i){var u=t.getData(),h=this._lineDraw,c=t.get("effect.show"),d=t.get("polyline"),f=t.get("large")&&u.count()>=t.get("largeThreshold");c&&f&&console.warn("Large lines not support effect"),(c!==this._hasEffet||d!==this._isPolyline||f!==this._isLarge)&&(h&&h.remove(),h=this._lineDraw=f?new l():new n(d?c?s:a:c?r:o),this._hasEffet=c,this._isPolyline=d,this._isLarge=f);var p=t.get("zlevel"),g=t.get("effect.trailLength"),m=i.getZr();if(m.painter.getLayer(p).clear(!0),null!=this._lastZlevel&&m.configLayer(this._lastZlevel,{motionBlur:!1}),c&&g){var v=!1;e.eachSeries(function(e){e!==t&&e.get("zlevel")===p&&(v=!0);}),v&&console.warn("Lines with trail effect should have an individual zlevel"),m.configLayer(p,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(g/10+.9,1),0)});}this.group.add(h.group),h.updateData(u),this._lastZlevel=p;},updateLayout:function updateLayout(t,e,i){this._lineDraw.updateLayout(t);var n=i.getZr();n.painter.getLayer(this._lastZlevel).clear(!0);},remove:function remove(t,e){this._lineDraw&&this._lineDraw.remove(e,!0);},dispose:function dispose(){}});},function(t,e,i){function n(t,e,i){r.Group.call(this),this.add(this.createLine(t,e,i)),this._updateEffectSymbol(t,e);}var r=i(43),o=i(201),a=i(4),s=i(106),l=i(10),u=i(50),h=n.prototype;h.createLine=function(t,e,i){return new o(t,e,i);},h._updateEffectSymbol=function(t,e){var i=t.getItemModel(e),n=i.getModel("effect"),r=n.get("symbolSize"),o=n.get("symbol");a.isArray(r)||(r=[r,r]);var l=n.get("color")||t.getItemVisual(e,"color"),u=this.childAt(1);this._symbolType!==o&&(this.remove(u),u=s.createSymbol(o,-.5,-.5,1,1,l),u.z2=100,u.culling=!0,this.add(u)),u&&(u.setStyle("shadowColor",l),u.setStyle(n.getItemStyle(["color"])),u.attr("scale",r),u.setColor(l),u.attr("scale",r),this._symbolType=o,this._updateEffectAnimation(t,n,e));},h._updateEffectAnimation=function(t,e,i){var n=this.childAt(1);if(n){var r=this,o=t.getItemLayout(i),s=1e3*e.get("period"),l=e.get("loop"),u=e.get("constantSpeed"),h=a.retrieve(e.get("delay"),function(e){return e/t.count()*s/3;}),c="function"==typeof h;if(n.ignore=!0,this.updateAnimationPoints(n,o),u>0&&(s=this.getLineLength(n)/u*1e3),s!==this._period||l!==this._loop){n.stopAnimation();var d=h;c&&(d=h(i)),n.__t>0&&(d=-s*n.__t),n.__t=0;var f=n.animate("",l).when(s,{__t:1}).delay(d).during(function(){r.updateSymbolPosition(n);});l||f.done(function(){r.remove(n);}),f.start();}this._period=s,this._loop=l;}},h.getLineLength=function(t){return l.dist(t.__p1,t.__cp1)+l.dist(t.__cp1,t.__p2);},h.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];},h.updateData=function(t,e,i){this.childAt(0).updateData(t,e,i),this._updateEffectSymbol(t,e);},h.updateSymbolPosition=function(t){var e=t.__p1,i=t.__p2,n=t.__cp1,r=t.__t,o=t.position,a=u.quadraticAt,s=u.quadraticDerivativeAt;o[0]=a(e[0],n[0],i[0],r),o[1]=a(e[1],n[1],i[1],r);var l=s(e[0],n[0],i[0],r),h=s(e[1],n[1],i[1],r);t.rotation=-Math.atan2(h,l)-Math.PI/2,t.ignore=!1;},h.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var i=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,i,e);},a.inherits(n,r.Group),t.exports=n;},function(t,e,i){function n(t,e,i){r.Group.call(this),this._createPolyline(t,e,i);}var r=i(43),o=i(4),a=n.prototype;a._createPolyline=function(t,e,i){var n=t.getItemLayout(e),o=new r.Polyline({shape:{points:n}});this.add(o),this._updateCommonStl(t,e,i);},a.updateData=function(t,e,i){var n=t.hostModel,o=this.childAt(0),a={shape:{points:t.getItemLayout(e)}};r.updateProps(o,a,n,e),this._updateCommonStl(t,e,i);},a._updateCommonStl=function(t,e,i){var n=this.childAt(0),a=t.getItemModel(e),s=t.getItemVisual(e,"color"),l=i&&i.lineStyle,u=i&&i.hoverLineStyle;(!i||t.hasItemOption)&&(l=a.getModel("lineStyle.normal").getLineStyle(),u=a.getModel("lineStyle.emphasis").getLineStyle()),n.useStyle(o.defaults({strokeNoScale:!0,fill:"none",stroke:s},l)),n.hoverStyle=u,r.setHoverStyle(this);},a.updateLayout=function(t,e){var i=this.childAt(0);i.setShape("points",t.getItemLayout(e));},o.inherits(n,r.Group),t.exports=n;},function(t,e,i){function n(t,e,i){a.call(this,t,e,i),this._lastFrame=0,this._lastFramePercent=0;}var r=i(266),o=i(4),a=i(265),s=i(10),l=n.prototype;l.createLine=function(t,e,i){return new r(t,e,i);},l.updateAnimationPoints=function(t,e){this._points=e;for(var i=[0],n=0,r=1;r<e.length;r++){var o=e[r-1],a=e[r];n+=s.dist(o,a),i.push(n);}if(0!==n){for(var r=0;r<i.length;r++){i[r]/=n;}this._offsets=i,this._length=n;}},l.getLineLength=function(t){return this._length;},l.updateSymbolPosition=function(t){var e=t.__t,i=this._points,n=this._offsets,r=i.length;if(n){var o,a=this._lastFrame;if(e<this._lastFramePercent){var l=Math.min(a+1,r-1);for(o=l;o>=0&&!(n[o]<=e);o--){}o=Math.min(o,r-2);}else{for(var o=a;r>o&&!(n[o]>e);o++){}o=Math.min(o-1,r-2);}s.lerp(t.position,i[o],i[o+1],(e-n[o])/(n[o+1]-n[o]));var u=i[o+1][0]-i[o][0],h=i[o+1][1]-i[o][1];t.rotation=-Math.atan2(h,u)-Math.PI/2,this._lastFrame=o,this._lastFramePercent=e,t.ignore=!1;}},o.inherits(n,a),t.exports=n;},function(t,e,i){function n(){this.group=new r.Group(),this._lineEl=new s();}var r=i(43),o=i(55),a=i(53),s=r.extendShape({shape:{polyline:!1,segs:[]},buildPath:function buildPath(t,e){for(var i=e.segs,n=e.polyline,r=0;r<i.length;r++){var o=i[r];if(n){t.moveTo(o[0][0],o[0][1]);for(var a=1;a<o.length;a++){t.lineTo(o[a][0],o[a][1]);}}else t.moveTo(o[0][0],o[0][1]),o.length>2?t.quadraticCurveTo(o[2][0],o[2][1],o[1][0],o[1][1]):t.lineTo(o[1][0],o[1][1]);}},findDataIndex:function findDataIndex(t,e){for(var i=this.shape,n=i.segs,r=i.polyline,s=Math.max(this.style.lineWidth,1),l=0;l<n.length;l++){var u=n[l];if(r){for(var h=1;h<u.length;h++){if(a.containStroke(u[h-1][0],u[h-1][1],u[h][0],u[h][1],s,t,e))return l;}}else if(u.length>2){if(o.containStroke(u[0][0],u[0][1],u[2][0],u[2][1],u[1][0],u[1][1],s,t,e))return l;}else if(a.containStroke(u[0][0],u[0][1],u[1][0],u[1][1],s,t,e))return l;}return-1;}}),l=n.prototype;l.updateData=function(t){this.group.removeAll();var e=this._lineEl,i=t.hostModel;e.setShape({segs:t.mapArray(t.getItemLayout),polyline:i.get("polyline")}),e.useStyle(i.getModel("lineStyle.normal").getLineStyle());var n=t.getVisual("color");n&&e.setStyle("stroke",n),e.setStyle("fill"),e.seriesIndex=i.seriesIndex,e.on("mousemove",function(t){e.dataIndex=null;var i=e.findDataIndex(t.offsetX,t.offsetY);i>0&&(e.dataIndex=i);}),this.group.add(e);},l.updateLayout=function(t){var e=t.getData();this._lineEl.setShape({segs:e.mapArray(e.getItemLayout)});},l.remove=function(){this.group.removeAll();},t.exports=n;},function(t,e,i){t.exports=function(t){t.eachSeriesByType("lines",function(t){var e=t.coordinateSystem,i=t.getData();i.each(function(n){var r=i.getItemModel(n),o=r.option instanceof Array?r.option:r.get("coords");if(!(o instanceof Array&&o.length>0&&o[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(o)+". Lines must have 2d coords array in data item.");var a=[];if(t.get("polyline"))for(var s=0;s<o.length;s++){a.push(e.dataToPoint(o[s]));}else{a[0]=e.dataToPoint(o[0]),a[1]=e.dataToPoint(o[1]);var l=r.get("lineStyle.normal.curveness");+l&&(a[2]=[(a[0][0]+a[1][0])/2-(a[0][1]-a[1][1])*l,(a[0][1]+a[1][1])/2-(a[1][0]-a[0][0])*l]);}i.setItemLayout(n,a);});});};},function(t,e,i){i(271),i(272);},function(t,e,i){var n=i(28),r=i(101);t.exports=n.extend({type:"series.heatmap",getInitialData:function getInitialData(t,e){return r(t.data,this,e);},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}});},function(t,e,i){function n(t,e,i){var n=t[1]-t[0];e=l.map(e,function(e){return{interval:[(e.interval[0]-t[0])/n,(e.interval[1]-t[0])/n]};});var r=e.length,o=0;return function(t){for(var n=o;r>n;n++){var a=e[n].interval;if(a[0]<=t&&t<=a[1]){o=n;break;}}if(n===r)for(var n=o-1;n>=0;n--){var a=e[n].interval;if(a[0]<=t&&t<=a[1]){o=n;break;}}return n>=0&&r>n&&i[n];};}function r(t,e){var i=t[1]-t[0];return e=[(e[0]-t[0])/i,(e[1]-t[0])/i],function(t){return t>=e[0]&&t<=e[1];};}function o(t){var e=t.dimensions;return"lng"===e[0]&&"lat"===e[1];}var a=i(43),s=i(273),l=i(4);t.exports=i(1).extendChartView({type:"heatmap",render:function render(t,e,i){var n;if(e.eachComponent("visualMap",function(e){e.eachTargetSeries(function(i){i===t&&(n=e);});}),!n)throw new Error("Heatmap must use with visualMap");this.group.removeAll();var r=t.coordinateSystem;"cartesian2d"===r.type?this._renderOnCartesian(r,t,i):o(r)&&this._renderOnGeo(r,t,n,i);},dispose:function dispose(){},_renderOnCartesian:function _renderOnCartesian(t,e,i){var n=t.getAxis("x"),r=t.getAxis("y"),o=this.group;if("category"!==n.type||"category"!==r.type)throw new Error("Heatmap on cartesian must have two category axes");if(!n.onBand||!r.onBand)throw new Error("Heatmap on cartesian must have two axes with boundaryGap true");var s=n.getBandWidth(),u=r.getBandWidth(),h=e.getData(),c="itemStyle.normal",d="itemStyle.emphasis",f="label.normal",p="label.emphasis",g=e.getModel(c).getItemStyle(["color"]),m=e.getModel(d).getItemStyle(),v=e.getModel("label.normal"),y=e.getModel("label.emphasis");h.each(["x","y","z"],function(i,n,r,x){var _=h.getItemModel(x),b=t.dataToPoint([i,n]);if(!isNaN(r)){var w=new a.Rect({shape:{x:b[0]-s/2,y:b[1]-u/2,width:s,height:u},style:{fill:h.getItemVisual(x,"color"),opacity:h.getItemVisual(x,"opacity")}});h.hasItemOption&&(g=_.getModel(c).getItemStyle(["color"]),m=_.getModel(d).getItemStyle(),v=_.getModel(f),y=_.getModel(p));var S=e.getRawValue(x),M="-";S&&null!=S[2]&&(M=S[2]),v.getShallow("show")&&(a.setText(g,v),g.text=e.getFormattedLabel(x,"normal")||M),y.getShallow("show")&&(a.setText(m,y),m.text=e.getFormattedLabel(x,"emphasis")||M),w.setStyle(g),a.setHoverStyle(w,h.hasItemOption?m:l.extend({},m)),o.add(w),h.setItemGraphicEl(x,w);}});},_renderOnGeo:function _renderOnGeo(t,e,i,o){var l=i.targetVisuals.inRange,u=i.targetVisuals.outOfRange,h=e.getData(),c=this._hmLayer||this._hmLayer||new s();c.blurSize=e.get("blurSize"),c.pointSize=e.get("pointSize"),c.minOpacity=e.get("minOpacity"),c.maxOpacity=e.get("maxOpacity");var d=t.getViewRect().clone(),f=t.getRoamTransform().transform;d.applyTransform(f);var p=Math.max(d.x,0),g=Math.max(d.y,0),m=Math.min(d.width+d.x,o.getWidth()),v=Math.min(d.height+d.y,o.getHeight()),y=m-p,x=v-g,_=h.mapArray(["lng","lat","value"],function(e,i,n){var r=t.dataToPoint([e,i]);return r[0]-=p,r[1]-=g,r.push(n),r;}),b=i.getExtent(),w="visualMap.continuous"===i.type?r(b,i.option.range):n(b,i.getPieceList(),i.option.selected);c.update(_,y,x,l.color.getNormalizer(),{inRange:l.color.getColorMapper(),outOfRange:u.color.getColorMapper()},w);var S=new a.Image({style:{width:y,height:x,x:p,y:g,image:c.canvas},silent:!0});this.group.add(S);}});},function(t,e,i){function n(){var t=o.createCanvas();this.canvas=t,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={};}var r=256,o=i(4);n.prototype={update:function update(t,e,i,n,o,a){var s=this._getBrush(),l=this._getGradient(t,o,"inRange"),u=this._getGradient(t,o,"outOfRange"),h=this.pointSize+this.blurSize,c=this.canvas,d=c.getContext("2d"),f=t.length;c.width=e,c.height=i;for(var p=0;f>p;++p){var g=t[p],m=g[0],v=g[1],y=g[2],x=n(y);d.globalAlpha=x,d.drawImage(s,m-h,v-h);}for(var _=d.getImageData(0,0,c.width,c.height),b=_.data,w=0,S=b.length,M=this.minOpacity,I=this.maxOpacity,T=I-M;S>w;){var x=b[w+3]/256,A=4*Math.floor(x*(r-1));if(x>0){var L=a(x)?l:u;x>0&&(x=x*T+M),b[w++]=L[A],b[w++]=L[A+1],b[w++]=L[A+2],b[w++]=L[A+3]*x*256;}else w+=4;}return d.putImageData(_,0,0),c;},_getBrush:function _getBrush(){var t=this._brushCanvas||(this._brushCanvas=o.createCanvas()),e=this.pointSize+this.blurSize,i=2*e;t.width=i,t.height=i;var n=t.getContext("2d");return n.clearRect(0,0,i,i),n.shadowOffsetX=i,n.shadowBlur=this.blurSize,n.shadowColor="#000",n.beginPath(),n.arc(-e,e,this.pointSize,0,2*Math.PI,!0),n.closePath(),n.fill(),t;},_getGradient:function _getGradient(t,e,i){for(var n=this._gradientPixels,r=n[i]||(n[i]=new Uint8ClampedArray(1024)),o=[],a=0,s=0;256>s;s++){e[i](s/255,!0,o),r[a++]=o[0],r[a++]=o[1],r[a++]=o[2],r[a++]=o[3];}return r;}},t.exports=n;},function(t,e,i){i(275),i(276),i(277);var n=i(1);n.registerProcessor(i(279));},function(t,e,i){"use strict";var n=i(4),r=i(12),o=i(1).extendComponentModel({type:"legend",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function init(t,e,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{};},mergeOption:function mergeOption(t){o.superCall(this,"mergeOption",t);},optionUpdated:function optionUpdated(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,i=0;i<t.length;i++){var n=t[i].get("name");if(this.isSelected(n)){this.select(n),e=!0;break;}}!e&&this.select(t[0].get("name"));}},_updateData:function _updateData(t){var e=n.map(this.get("data")||[],function(t){return("string"==typeof t||"number"==typeof t)&&(t={name:t}),new r(t,this,this.ecModel);},this);this._data=e;var i=n.map(t.getSeries(),function(t){return t.name;});t.eachSeries(function(t){if(t.legendDataProvider){var e=t.legendDataProvider();i=i.concat(e.mapArray(e.getName));}}),this._availableNames=i;},getData:function getData(){return this._data;},select:function select(t){var e=this.option.selected,i=this.get("selectedMode");if("single"===i){var r=this._data;n.each(r,function(t){e[t.get("name")]=!1;});}e[t]=!0;},unSelect:function unSelect(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1);},toggleSelected:function toggleSelected(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t);},isSelected:function isSelected(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&n.indexOf(this._availableNames,t)>=0;},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:"top",align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",textStyle:{color:"#333"},selectedMode:!0,tooltip:{show:!1}}});t.exports=o;},function(t,e,i){function n(t,e,i){var n,r={},a="toggleSelected"===t;return i.eachComponent("legend",function(i){a&&null!=n?i[n?"select":"unSelect"](e.name):(i[t](e.name),n=i.isSelected(e.name));var s=i.getData();o.each(s,function(t){var e=t.get("name");if("\n"!==e&&""!==e){var n=i.isSelected(e);e in r?r[e]=r[e]&&n:r[e]=n;}});}),{name:e.name,selected:r};}var r=i(1),o=i(4);r.registerAction("legendToggleSelect","legendselectchanged",o.curry(n,"toggleSelected")),r.registerAction("legendSelect","legendselected",o.curry(n,"select")),r.registerAction("legendUnSelect","legendunselected",o.curry(n,"unSelect"));},function(t,e,i){function n(t,e){e.dispatchAction({type:"legendToggleSelect",name:t});}function r(t,e,i){var n=i.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||t.get("legendHoverLink")&&i.dispatchAction({type:"highlight",seriesName:t.name,name:e});}function o(t,e,i){var n=i.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||t.get("legendHoverLink")&&i.dispatchAction({type:"downplay",seriesName:t.name,name:e});}var a=i(4),s=i(106),l=i(43),u=i(278),h=a.curry;t.exports=i(1).extendComponentView({type:"legend",init:function init(){this._symbolTypeStore={};},render:function render(t,e,i){var s=this.group;if(s.removeAll(),t.get("show")){var c=t.get("selectedMode"),d=t.get("align");"auto"===d&&(d="right"===t.get("left")&&"vertical"===t.get("orient")?"right":"left");var f={};a.each(t.getData(),function(a){var u=a.get("name");if(""===u||"\n"===u)return void s.add(new l.Group({newline:!0}));var p=e.getSeriesByName(u)[0];if(!f[u]){if(p){var g=p.getData(),m=g.getVisual("color");"function"==typeof m&&(m=m(p.getDataParams(0)));var v=g.getVisual("legendSymbol")||"roundRect",y=g.getVisual("symbol"),x=this._createItem(u,a,t,v,y,d,m,c);x.on("click",h(n,u,i)).on("mouseover",h(r,p,null,i)).on("mouseout",h(o,p,null,i)),f[u]=!0;}else e.eachRawSeries(function(e){if(!f[u]&&e.legendDataProvider){var s=e.legendDataProvider(),l=s.indexOfName(u);if(0>l)return;var p=s.getItemVisual(l,"color"),g="roundRect",m=this._createItem(u,a,t,g,null,d,p,c);m.on("click",h(n,u,i)).on("mouseover",h(r,e,u,i)).on("mouseout",h(o,e,u,i)),f[u]=!0;}},this);f[u]||console.warn(u+" series not exists. Legend data should be same with series name or data name.");}},this),u.layout(s,t,i),u.addBackground(s,t);}},_createItem:function _createItem(t,e,i,n,r,o,u,h){var c=i.get("itemWidth"),d=i.get("itemHeight"),f=i.get("inactiveColor"),p=i.isSelected(t),g=new l.Group(),m=e.getModel("textStyle"),v=e.get("icon"),y=e.getModel("tooltip"),x=y.parentModel;if(n=v||n,g.add(s.createSymbol(n,0,0,c,d,p?u:f)),!v&&r&&(r!==n||"none"==r)){var _=.8*d;"none"===r&&(r="circle"),g.add(s.createSymbol(r,(c-_)/2,(d-_)/2,_,_,p?u:f));}var b="left"===o?c+5:-5,w=o,S=i.get("formatter"),M=t;"string"==typeof S&&S?M=S.replace("{name}",t):"function"==typeof S&&(M=S(t));var I=new l.Text({style:{text:M,x:b,y:d/2,fill:p?m.getTextColor():f,textFont:m.getFont(),textAlign:w,textVerticalAlign:"middle"}});g.add(I);var T=new l.Rect({shape:g.getBoundingRect(),invisible:!0,tooltip:y.get("show")?a.extend({content:t,formatter:x.get("formatter",!0)||function(){return t;},formatterParams:{componentType:"legend",legendIndex:i.componentIndex,name:t,$vars:["name"]}},y.option):null});return g.add(T),g.eachChild(function(t){t.silent=!0;}),T.silent=!h,this.group.add(g),l.setHoverStyle(g),g;}});},function(t,e,i){function n(t,e,i){r.positionGroup(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()},e.get("padding"));}var r=i(21),o=i(6),a=i(43);t.exports={layout:function layout(t,e,i){var o=r.getLayoutRect(e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()},e.get("padding"));r.box(e.get("orient"),t,e.get("itemGap"),o.width,o.height),n(t,e,i);},addBackground:function addBackground(t,e){var i=o.normalizeCssArray(e.get("padding")),n=t.getBoundingRect(),r=e.getItemStyle(["color","opacity"]);r.fill=e.get("backgroundColor");var s=new a.Rect({shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[1]+i[3],height:n.height+i[0]+i[2]},style:r,silent:!0,z2:-1});a.subPixelOptimizeRect(s),t.add(s);}};},function(t,e){t.exports=function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(t){for(var i=0;i<e.length;i++){if(!e[i].isSelected(t.name))return!1;}return!0;});};},function(t,e,i){i(281),i(282),i(1).registerAction({type:"showTip",event:"showTip",update:"none"},function(){}),i(1).registerAction({type:"hideTip",event:"hideTip",update:"none"},function(){});},function(t,e,i){i(1).extendComponentModel({type:"tooltip",defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove",alwaysShowContent:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:!0,animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",lineStyle:{color:"#555",width:1,type:"solid"},crossStyle:{color:"#555",width:1,type:"dashed",textStyle:{}},shadowStyle:{color:"rgba(150,150,150,0.3)"}},textStyle:{color:"#fff",fontSize:14}}});},function(t,e,i){function n(t,e){if(!t||!e)return!1;var i=g.round;return i(t[0])===i(e[0])&&i(t[1])===i(e[1]);}function r(t,e,i,n){return{x1:t,y1:e,x2:i,y2:n};}function o(t,e,i,n){return{x:t,y:e,width:i,height:n};}function a(t,e,i,n,r,o){return{cx:t,cy:e,r0:i,r:n,startAngle:r,endAngle:o,clockwise:!0};}function s(t,e,i,n,r){var o=i.clientWidth,a=i.clientHeight,s=20;return t+o+s>n?t-=o+s:t+=s,e+a+s>r?e-=a+s:e+=s,[t,e];}function l(t,e,i){var n=i.clientWidth,r=i.clientHeight,o=5,a=0,s=0,l=e.width,u=e.height;switch(t){case"inside":a=e.x+l/2-n/2,s=e.y+u/2-r/2;break;case"top":a=e.x+l/2-n/2,s=e.y-r-o;break;case"bottom":a=e.x+l/2-n/2,s=e.y+u+o;break;case"left":a=e.x-n-o,s=e.y+u/2-r/2;break;case"right":a=e.x+l+o,s=e.y+u/2-r/2;}return[a,s];}function u(t,e,i,n,r,o,a){var u=a.getWidth(),h=a.getHeight(),c=o&&o.getBoundingRect().clone();if(o&&c.applyTransform(o.transform),"function"==typeof t&&(t=t([e,i],r,n.el,c)),f.isArray(t))e=v(t[0],u),i=v(t[1],h);else if("string"==typeof t&&o){var d=l(t,c,n.el);e=d[0],i=d[1];}else{var d=s(e,i,n.el,u,h);e=d[0],i=d[1];}n.moveTo(e,i);}function h(t){var e=t.coordinateSystem,i=t.get("tooltip.trigger",!0);return!(!e||"cartesian2d"!==e.type&&"polar"!==e.type&&"singleAxis"!==e.type||"item"===i);}var c=i(283),d=i(43),f=i(4),p=i(6),g=i(7),m=i(5),v=g.parsePercent,y=i(2),x=i(12);i(1).extendComponentView({type:"tooltip",_axisPointers:{},init:function init(t,e){if(!y.node){var i=new c(e.getDom(),e);this._tooltipContent=i,e.on("showTip",this._manuallyShowTip,this),e.on("hideTip",this._manuallyHideTip,this);}},render:function render(t,e,i){if(!y.node){this.group.removeAll(),this._axisPointers={},this._tooltipModel=t,this._ecModel=e,this._api=i,this._lastHover={};var n=this._tooltipContent;n.update(),n.enterable=t.get("enterable"),this._alwaysShowContent=t.get("alwaysShowContent"),this._seriesGroupByAxis=this._prepareAxisTriggerData(t,e);var r=this._crossText;r&&this.group.add(r);var o=t.get("triggerOn");if(null!=this._lastX&&null!=this._lastY&&"none"!==o){var a=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){a._manuallyShowTip({x:a._lastX,y:a._lastY});});}var s=this._api.getZr();s.off("click",this._tryShow),s.off("mousemove",this._mousemove),s.off("mouseout",this._hide),s.off("globalout",this._hide),"click"===o?s.on("click",this._tryShow,this):"mousemove"===o&&(s.on("mousemove",this._mousemove,this),s.on("mouseout",this._hide,this),s.on("globalout",this._hide,this));}},_mousemove:function _mousemove(t){var e=this._tooltipModel.get("showDelay"),i=this;clearTimeout(this._showTimeout),e>0?this._showTimeout=setTimeout(function(){i._tryShow(t);},e):this._tryShow(t);},_manuallyShowTip:function _manuallyShowTip(t){if(t.from!==this.uid){var e=this._ecModel,i=t.seriesIndex,n=e.getSeriesByIndex(i),r=this._api;if(null==t.x||null==t.y){if(n||e.eachSeries(function(t){h(t)&&!n&&(n=t);}),n){var o=n.getData(),a=m.queryDataIndex(o,t);if(null==a||f.isArray(a))return;var s,l,u=o.getItemGraphicEl(a),c=n.coordinateSystem;if(n.getTooltipPosition){var d=n.getTooltipPosition(a)||[];s=d[0],l=d[1];}else if(c&&c.dataToPoint){var d=c.dataToPoint(o.getValues(f.map(c.dimensions,function(t){return n.coordDimToDataDim(t)[0];}),a,!0));s=d&&d[0],l=d&&d[1];}else if(u){var p=u.getBoundingRect().clone();p.applyTransform(u.transform),s=p.x+p.width/2,l=p.y+p.height/2;}null!=s&&null!=l&&this._tryShow({offsetX:s,offsetY:l,position:t.position,target:u,event:{}});}}else{var u=r.getZr().handler.findHover(t.x,t.y);this._tryShow({offsetX:t.x,offsetY:t.y,position:t.position,target:u,event:{}});}}},_manuallyHideTip:function _manuallyHideTip(t){t.from!==this.uid&&this._hide();},_prepareAxisTriggerData:function _prepareAxisTriggerData(t,e){var i={};return e.eachSeries(function(t){if(h(t)){var e,n,r=t.coordinateSystem;"cartesian2d"===r.type?(e=r.getBaseAxis(),n=e.dim+e.index):"singleAxis"===r.type?(e=r.getAxis(),n=e.dim+e.type):(e=r.getBaseAxis(),n=e.dim+r.name),i[n]=i[n]||{coordSys:[],series:[]},i[n].coordSys.push(r),i[n].series.push(t);}},this),i;},_tryShow:function _tryShow(t){var e=t.target,i=this._tooltipModel,n=i.get("trigger"),r=this._ecModel,o=this._api;if(i)if(this._lastX=t.offsetX,this._lastY=t.offsetY,e&&null!=e.dataIndex){var a=e.dataModel||r.getSeriesByIndex(e.seriesIndex),s=e.dataIndex,l=a.getData().getItemModel(s);"axis"===(l.get("tooltip.trigger")||n)?this._showAxisTooltip(i,r,t):(this._ticket="",this._hideAxisPointer(),this._resetLastHover(),this._showItemTooltipContent(a,s,e.dataType,t)),o.dispatchAction({type:"showTip",from:this.uid,dataIndexInside:e.dataIndex,seriesIndex:e.seriesIndex});}else if(e&&e.tooltip){var u=e.tooltip;if("string"==typeof u){var h=u;u={content:h,formatter:h};}var c=new x(u,i),d=c.get("content"),f=Math.random();this._showTooltipContent(c,d,c.get("formatterParams")||{},f,t.offsetX,t.offsetY,t.position,e,o);}else"item"===n?this._hide():this._showAxisTooltip(i,r,t),"cross"===i.get("axisPointer.type")&&o.dispatchAction({type:"showTip",from:this.uid,x:t.offsetX,y:t.offsetY});},_showAxisTooltip:function _showAxisTooltip(t,e,i){var r=t.getModel("axisPointer"),o=r.get("type");if("cross"===o){var a=i.target;if(a&&null!=a.dataIndex){var s=e.getSeriesByIndex(a.seriesIndex),l=a.dataIndex;this._showItemTooltipContent(s,l,a.dataType,i);}}this._showAxisPointer();var u=!0;f.each(this._seriesGroupByAxis,function(t){var e=t.coordSys,a=e[0],s=[i.offsetX,i.offsetY];if(!a.containPoint(s))return void this._hideAxisPointer(a.name);u=!1;var l=a.dimensions,h=a.pointToData(s,!0);s=a.dataToPoint(h);var c=a.getBaseAxis(),d=r.get("axis");"auto"===d&&(d=c.dim);var p=!1,g=this._lastHover;if("cross"===o)n(g.data,h)&&(p=!0),g.data=h;else{var m=f.indexOf(l,d);g.data===h[m]&&(p=!0),g.data=h[m];}"cartesian2d"!==a.type||p?"polar"!==a.type||p?"singleAxis"!==a.type||p||this._showSinglePointer(r,a,d,s):this._showPolarPointer(r,a,d,s):this._showCartesianPointer(r,a,d,s),"cross"!==o&&this._dispatchAndShowSeriesTooltipContent(a,t.series,s,h,p,i.position);},this),this._tooltipModel.get("show")||this._hideAxisPointer(),u&&this._hide();},_showCartesianPointer:function _showCartesianPointer(t,e,i,n){function a(i,n,o){var a="x"===i?r(n[0],o[0],n[0],o[1]):r(o[0],n[1],o[1],n[1]),s=l._getPointerElement(e,t,i,a);d.subPixelOptimizeLine({shape:a,style:s.style}),c?d.updateProps(s,{shape:a},t):s.attr({shape:a});}function s(i,n,r){var a=e.getAxis(i),s=a.getBandWidth(),u=r[1]-r[0],h="x"===i?o(n[0]-s/2,r[0],s,u):o(r[0],n[1]-s/2,u,s),f=l._getPointerElement(e,t,i,h);c?d.updateProps(f,{shape:h},t):f.attr({shape:h});}var l=this,u=t.get("type"),h=e.getBaseAxis(),c="cross"!==u&&"category"===h.type&&h.getBandWidth()>20;if("cross"===u)a("x",n,e.getAxis("y").getGlobalExtent()),a("y",n,e.getAxis("x").getGlobalExtent()),this._updateCrossText(e,n,t);else{var f=e.getAxis("x"===i?"y":"x"),p=f.getGlobalExtent();"cartesian2d"===e.type&&("line"===u?a:s)(i,n,p);}},_showSinglePointer:function _showSinglePointer(t,e,i,n){function o(i,n,o){var s=e.getAxis(),u=s.orient,h="horizontal"===u?r(n[0],o[0],n[0],o[1]):r(o[0],n[1],o[1],n[1]),c=a._getPointerElement(e,t,i,h);l?d.updateProps(c,{shape:h},t):c.attr({shape:h});}var a=this,s=t.get("type"),l="cross"!==s&&"category"===e.getBaseAxis().type,u=e.getRect(),h=[u.y,u.y+u.height];o(i,n,h);},_showPolarPointer:function _showPolarPointer(t,e,i,n){function o(i,n,o){var a,s=e.pointToCoord(n);if("angle"===i){var u=e.coordToPoint([o[0],s[1]]),h=e.coordToPoint([o[1],s[1]]);a=r(u[0],u[1],h[0],h[1]);}else a={cx:e.cx,cy:e.cy,r:s[0]};var c=l._getPointerElement(e,t,i,a);f?d.updateProps(c,{shape:a},t):c.attr({shape:a});}function s(i,n,r){var o,s=e.getAxis(i),u=s.getBandWidth(),h=e.pointToCoord(n),c=Math.PI/180;o="angle"===i?a(e.cx,e.cy,r[0],r[1],(-h[1]-u/2)*c,(-h[1]+u/2)*c):a(e.cx,e.cy,h[0]-u/2,h[0]+u/2,0,2*Math.PI);var p=l._getPointerElement(e,t,i,o);f?d.updateProps(p,{shape:o},t):p.attr({shape:o});}var l=this,u=t.get("type"),h=e.getAngleAxis(),c=e.getRadiusAxis(),f="cross"!==u&&"category"===e.getBaseAxis().type;if("cross"===u)o("angle",n,c.getExtent()),o("radius",n,h.getExtent()),this._updateCrossText(e,n,t);else{var p=e.getAxis("radius"===i?"angle":"radius"),g=p.getExtent();("line"===u?o:s)(i,n,g);}},_updateCrossText:function _updateCrossText(t,e,i){var n=i.getModel("crossStyle"),r=n.getModel("textStyle"),o=this._tooltipModel,a=this._crossText;a||(a=this._crossText=new d.Text({style:{textAlign:"left",textVerticalAlign:"bottom"}}),this.group.add(a));var s=t.pointToData(e),l=t.dimensions;s=f.map(s,function(e,i){var n=t.getAxis(l[i]);return e="category"===n.type||"time"===n.type?n.scale.getLabel(e):p.addCommas(e.toFixed(n.getPixelPrecision()));}),a.setStyle({fill:r.getTextColor()||n.get("color"),textFont:r.getFont(),text:s.join(", "),x:e[0]+5,y:e[1]-5}),a.z=o.get("z"),a.zlevel=o.get("zlevel");},_getPointerElement:function _getPointerElement(t,e,i,n){var r=this._tooltipModel,o=r.get("z"),a=r.get("zlevel"),s=this._axisPointers,l=t.name;if(s[l]=s[l]||{},s[l][i])return s[l][i];var u=e.get("type"),h=e.getModel(u+"Style"),c="shadow"===u,f=h[c?"getAreaStyle":"getLineStyle"](),p="polar"===t.type?c?"Sector":"radius"===i?"Circle":"Line":c?"Rect":"Line";c?f.stroke=null:f.fill=null;var g=s[l][i]=new d[p]({style:f,z:o,zlevel:a,silent:!0,shape:n});return this.group.add(g),g;},_dispatchAndShowSeriesTooltipContent:function _dispatchAndShowSeriesTooltipContent(t,e,i,n,r,o){var a=this._tooltipModel,s=t.getBaseAxis(),l="x"===s.dim||"radius"===s.dim?0:1,h=f.map(e,function(t){return{seriesIndex:t.seriesIndex,dataIndexInside:t.getAxisTooltipDataIndex?t.getAxisTooltipDataIndex(t.coordDimToDataDim(s.dim),n,s):t.getData().indexOfNearest(t.coordDimToDataDim(s.dim)[0],n[l],!1,"category"===s.type?.5:null)};}),c=this._lastHover,d=this._api;if(c.payloadBatch&&!r&&d.dispatchAction({type:"downplay",batch:c.payloadBatch}),r||(d.dispatchAction({type:"highlight",batch:h}),c.payloadBatch=h),d.dispatchAction({type:"showTip",dataIndexInside:h[0].dataIndexInside,seriesIndex:h[0].seriesIndex,from:this.uid}),s&&a.get("showContent")&&a.get("show")){var p=f.map(e,function(t,e){return t.getDataParams(h[e].dataIndexInside);});if(r)u(o||a.get("position"),i[0],i[1],this._tooltipContent,p,null,d);else{var g=h[0].dataIndexInside,m="time"===s.type?s.scale.getLabel(n[l]):e[0].getData().getName(g),v=(m?m+"<br />":"")+f.map(e,function(t,e){return t.formatTooltip(h[e].dataIndexInside,!0);}).join("<br />"),y="axis_"+t.name+"_"+g;this._showTooltipContent(a,v,p,y,i[0],i[1],o,null,d);}}},_showItemTooltipContent:function _showItemTooltipContent(t,e,i,n){var r=this._api,o=t.getData(i),a=o.getItemModel(e),s=a.get("tooltip",!0);if("string"==typeof s){var l=s;s={formatter:l};}var u=this._tooltipModel,h=t.getModel("tooltip",u),c=new x(s,h,h.ecModel),d=t.getDataParams(e,i),f=t.formatTooltip(e,!1,i),p="item_"+t.name+"_"+e;this._showTooltipContent(c,f,d,p,n.offsetX,n.offsetY,n.position,n.target,r);},_showTooltipContent:function _showTooltipContent(t,e,i,n,r,o,a,s,l){if(this._ticket="",t.get("showContent")&&t.get("show")){var h=this._tooltipContent,c=t.get("formatter");a=a||t.get("position");var d=e;if(c)if("string"==typeof c)d=p.formatTpl(c,i);else if("function"==typeof c){var f=this,g=n,m=function m(t,e){t===f._ticket&&(h.setContent(e),u(a,r,o,h,i,s,l));};f._ticket=g,d=c(i,g,m);}h.show(t),h.setContent(d),u(a,r,o,h,i,s,l);}},_showAxisPointer:function _showAxisPointer(t){if(t){var e=this._axisPointers[t];e&&f.each(e,function(t){t.show();});}else this.group.eachChild(function(t){t.show();}),this.group.show();},_resetLastHover:function _resetLastHover(){var t=this._lastHover;t.payloadBatch&&this._api.dispatchAction({type:"downplay",batch:t.payloadBatch}),this._lastHover={};},_hideAxisPointer:function _hideAxisPointer(t){if(t){var e=this._axisPointers[t];e&&f.each(e,function(t){t.hide();});}else this.group.children().length&&this.group.hide();},_hide:function _hide(){clearTimeout(this._showTimeout),this._hideAxisPointer(),this._resetLastHover(),this._alwaysShowContent||this._tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._api.dispatchAction({type:"hideTip",from:this.uid}),this._lastX=this._lastY=null;},dispose:function dispose(t,e){if(!y.node){var i=e.getZr();this._tooltipContent.hide(),i.off("click",this._tryShow),i.off("mousemove",this._mousemove),i.off("mouseout",this._hide),i.off("globalout",this._hide),e.off("showTip",this._manuallyShowTip),e.off("hideTip",this._manuallyHideTip);}}});},function(t,e,i){function n(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",i="left "+t+"s "+e+",top "+t+"s "+e;return l.map(g,function(t){return t+"transition:"+i;}).join(";");}function r(t){var e=[],i=t.get("fontSize"),n=t.getTextColor();return n&&e.push("color:"+n),e.push("font:"+t.getFont()),i&&e.push("line-height:"+Math.round(3*i/2)+"px"),d(["decoration","align"],function(i){var n=t.get(i);n&&e.push("text-"+i+":"+n);}),e.join(";");}function o(t){t=t;var e=[],i=t.get("transitionDuration"),o=t.get("backgroundColor"),a=t.getModel("textStyle"),s=t.get("padding");return i&&e.push(n(i)),o&&(p.canvasSupported?e.push("background-Color:"+o):(e.push("background-Color:#"+u.toHex(o)),e.push("filter:alpha(opacity=70)"))),d(["width","color","radius"],function(i){var n="border-"+i,r=f(n),o=t.get(r);null!=o&&e.push(n+":"+o+("color"===i?"":"px"));}),e.push(r(a)),null!=s&&e.push("padding:"+c.normalizeCssArray(s).join("px ")+"px"),e.join(";")+";";}function a(t,e){var i=document.createElement("div"),n=e.getZr();this.el=i,this._x=e.getWidth()/2,this._y=e.getHeight()/2,t.appendChild(i),this._container=t,this._show=!1,this._hideTimeout;var r=this;i.onmouseenter=function(){r.enterable&&(clearTimeout(r._hideTimeout),r._show=!0),r._inContent=!0;},i.onmousemove=function(e){if(e=e||window.event,!r.enterable){var i=n.handler;h.normalizeEvent(t,e,!0),i.dispatch("mousemove",e);}},i.onmouseleave=function(){r.enterable&&r._show&&r.hideLater(r._hideDelay),r._inContent=!1;},s(i,t);}function s(t,e){function i(t){n(t.target)||t.preventDefault();}function n(i){for(;i&&i!==e;){if(i===t)return!0;i=i.parentNode;}}h.addEventListener(e,"touchstart",i),h.addEventListener(e,"touchmove",i),h.addEventListener(e,"touchend",i);}var l=i(4),u=i(39),h=i(87),c=i(6),d=l.each,f=c.toCamelCase,p=i(2),g=["","-webkit-","-moz-","-o-"],m="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;";a.prototype={constructor:a,enterable:!0,update:function update(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),i=t.style;"absolute"!==i.position&&"absolute"!==e.position&&(i.position="relative");},show:function show(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText=m+o(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",this._show=!0;},setContent:function setContent(t){var e=this.el;e.innerHTML=t,e.style.display=t?"block":"none";},moveTo:function moveTo(t,e){var i=this.el.style;i.left=t+"px",i.top=e+"px",this._x=t,this._y=e;},hide:function hide(){this.el.style.display="none",this._show=!1;},hideLater:function hideLater(t){!this._show||this._inContent&&this.enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(l.bind(this.hide,this),t)):this.hide());},isShow:function isShow(){return this._show;}},t.exports=a;},function(t,e,i){"use strict";i(285),i(291),i(293),i(1).extendComponentView({type:"polar"});},function(t,e,i){function n(t,e){var i=t.get("center"),n=t.get("radius"),r=e.getWidth(),o=e.getHeight(),a=s.parsePercent;this.cx=a(i[0],r),this.cy=a(i[1],o);var l=this.getRadiusAxis(),u=Math.min(r,o)/2;l.setExtent(0,a(n,u));}function r(t,e){var i=this,n=i.getAngleAxis(),r=i.getRadiusAxis();if(n.scale.setExtent(1/0,-(1/0)),r.scale.setExtent(1/0,-(1/0)),t.eachSeries(function(t){if(t.coordinateSystem===i){var e=t.getData();r.scale.unionExtent(e.getDataExtent("radius","category"!==r.type)),n.scale.unionExtent(e.getDataExtent("angle","category"!==n.type));}}),h(n,n.model),h(r,r.model),"category"===n.type&&!n.onBand){var o=n.getExtent(),a=360/n.scale.count();n.inverse?o[1]+=a:o[1]-=a,n.setExtent(o[0],o[1]);}}function o(t,e){if(t.type=e.get("type"),t.scale=u.createScaleByModel(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,"angleAxis"===e.mainType){var i=e.get("startAngle");t.inverse=e.get("inverse")^e.get("clockwise"),t.setExtent(i,i+(t.inverse?-360:360));}e.axis=t,t.model=e;}var a=i(286),s=i(7),l=i(4),u=i(114),h=u.niceScaleExtent;i(289);var c={dimensions:a.prototype.dimensions,create:function create(t,e){var i=[];return t.eachComponent("polar",function(t,s){var l=new a(s);l.resize=n,l.update=r;var u=l.getRadiusAxis(),h=l.getAngleAxis(),c=t.findAxisModel("radiusAxis"),d=t.findAxisModel("angleAxis");o(u,c),o(h,d),l.resize(t,e),i.push(l),t.coordinateSystem=l;}),t.eachSeries(function(e){if("polar"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"polar",index:e.get("polarIndex"),id:e.get("polarId")})[0];if(!i)throw new Error('Polar "'+l.retrieve(e.get("polarIndex"),e.get("polarId"),0)+'" not found');e.coordinateSystem=i.coordinateSystem;}}),i;}};i(26).register("polar",c);},function(t,e,i){"use strict";var n=i(287),r=i(288),o=function o(t){this.name=t||"",this.cx=0,this.cy=0,this._radiusAxis=new n(),this._angleAxis=new r();};o.prototype={constructor:o,type:"polar",dimensions:["radius","angle"],containPoint:function containPoint(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1]);},containData:function containData(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1]);},getAxis:function getAxis(t){return this["_"+t+"Axis"];},getAxesByScale:function getAxesByScale(t){var e=[],i=this._angleAxis,n=this._radiusAxis;return i.scale.type===t&&e.push(i),n.scale.type===t&&e.push(n),e;},getAngleAxis:function getAngleAxis(){return this._angleAxis;},getRadiusAxis:function getRadiusAxis(){return this._radiusAxis;},getOtherAxis:function getOtherAxis(t){var e=this._angleAxis;return t===e?this._radiusAxis:e;},getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis();},dataToPoints:function dataToPoints(t){return t.mapArray(this.dimensions,function(t,e){return this.dataToPoint([t,e]);},this);},dataToPoint:function dataToPoint(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)]);},pointToData:function pointToData(t,e){var i=this.pointToCoord(t);return[this._radiusAxis.radiusToData(i[0],e),this._angleAxis.angleToData(i[1],e)];},pointToCoord:function pointToCoord(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=this.getAngleAxis(),r=n.getExtent(),o=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);n.inverse?o=a-360:a=o+360;var s=Math.sqrt(e*e+i*i);e/=s,i/=s;for(var l=Math.atan2(-i,e)/Math.PI*180,u=o>l?1:-1;o>l||l>a;){l+=360*u;}return[s,l];},coordToPoint:function coordToPoint(t){var e=t[0],i=t[1]/180*Math.PI,n=Math.cos(i)*e+this.cx,r=-Math.sin(i)*e+this.cy;return[n,r];}},t.exports=o;},function(t,e,i){"use strict";function n(t,e){o.call(this,"radius",t,e),this.type="category";}var r=i(4),o=i(123);n.prototype={constructor:n,dataToRadius:o.prototype.dataToCoord,radiusToData:o.prototype.coordToData},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";function n(t,e){e=e||[0,360],o.call(this,"angle",t,e),this.type="category";}var r=i(4),o=i(123);n.prototype={constructor:n,dataToAngle:o.prototype.dataToCoord,angleToData:o.prototype.coordToData},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";i(290),i(1).extendComponentModel({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function findAxisModel(t){var e,i=this.ecModel;return i.eachComponent(t,function(t){var n=i.queryComponents({mainType:"polar",index:t.getShallow("polarIndex"),id:t.getShallow("polarId")})[0];n===this&&(e=t);},this),e;},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}});},function(t,e,i){"use strict";function n(t,e){return e.type||(e.data?"category":"value");}var r=i(4),o=i(19),a=i(127),s=o.extend({type:"polarAxis",axis:null});r.merge(s.prototype,i(129)),r.merge(s.prototype,i(130));var l={angle:{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}},radius:{splitNumber:5}};a("angle",s,n,l.angle),a("radius",s,n,l.radius);},function(t,e,i){"use strict";i(285),i(292);},function(t,e,i){"use strict";function n(t,e,i,n){var r=t.coordToPoint([e,n]),o=t.coordToPoint([i,n]);return{x1:r[0],y1:r[1],x2:o[0],y2:o[1]};}var r=i(4),o=i(43),a=i(12),s=["axisLine","axisLabel","axisTick","splitLine","splitArea"];i(1).extendComponentView({type:"angleAxis",render:function render(t,e){if(this.group.removeAll(),t.get("show")){var i=e.getComponent("polar",t.get("polarIndex")),n=t.axis,o=i.coordinateSystem,a=o.getRadiusAxis().getExtent(),l=n.getTicksCoords();"category"!==n.type&&l.pop(),r.each(s,function(e){t.get(e+".show")&&this["_"+e](t,o,l,a);},this);}},_axisLine:function _axisLine(t,e,i,n){var r=t.getModel("axisLine.lineStyle"),a=new o.Circle({shape:{cx:e.cx,cy:e.cy,r:n[1]},style:r.getLineStyle(),z2:1,silent:!0});a.style.fill=null,this.group.add(a);},_axisTick:function _axisTick(t,e,i,a){var s=t.getModel("axisTick"),l=(s.get("inside")?-1:1)*s.get("length"),u=r.map(i,function(t){return new o.Line({shape:n(e,a[1],a[1]+l,t)});});this.group.add(o.mergePath(u,{style:r.defaults(s.getModel("lineStyle").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})}));},_axisLabel:function _axisLabel(t,e,i,n){for(var r=t.axis,s=t.get("data"),l=t.getModel("axisLabel"),u=l.getModel("textStyle"),h=t.getFormattedLabels(),c=l.get("margin"),d=r.getLabelsCoords(),f=0;f<i.length;f++){var p=n[1],g=e.coordToPoint([p+c,d[f]]),m=e.cx,v=e.cy,y=Math.abs(g[0]-m)/p<.3?"center":g[0]>m?"left":"right",x=Math.abs(g[1]-v)/p<.3?"middle":g[1]>v?"top":"bottom",_=u;s&&s[f]&&s[f].textStyle&&(_=new a(s[f].textStyle,u)),this.group.add(new o.Text({style:{x:g[0],y:g[1],fill:_.getTextColor()||t.get("axisLine.lineStyle.color"),text:h[f],textAlign:y,textVerticalAlign:x,textFont:_.getFont()},silent:!0}));}},_splitLine:function _splitLine(t,e,i,a){var s=t.getModel("splitLine"),l=s.getModel("lineStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=0;d<i.length;d++){var f=h++%u.length;c[f]=c[f]||[],c[f].push(new o.Line({shape:n(e,a[0],a[1],i[d])}));}for(var d=0;d<c.length;d++){this.group.add(o.mergePath(c[d],{style:r.defaults({stroke:u[d%u.length]},l.getLineStyle()),silent:!0,z:t.get("z")}));}},_splitArea:function _splitArea(t,e,i,n){var a=t.getModel("splitArea"),s=a.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var h=[],c=Math.PI/180,d=-i[0]*c,f=Math.min(n[0],n[1]),p=Math.max(n[0],n[1]),g=t.get("clockwise"),m=1;m<i.length;m++){var v=u++%l.length;h[v]=h[v]||[],h[v].push(new o.Sector({shape:{cx:e.cx,cy:e.cy,r0:f,r:p,startAngle:d,endAngle:-i[m]*c,clockwise:g},silent:!0})),d=-i[m]*c;}for(var m=0;m<h.length;m++){this.group.add(o.mergePath(h[m],{style:r.defaults({fill:l[m%l.length]},s.getAreaStyle()),silent:!0}));}}});},function(t,e,i){i(285),i(294);},function(t,e,i){"use strict";function n(t,e,i){return{position:[t.cx,t.cy],rotation:i/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotation:e.getModel("axisLabel").get("rotate"),z2:1};}var r=i(4),o=i(43),a=i(133),s=["axisLine","axisLabel","axisTick","axisName"],l=["splitLine","splitArea"];i(1).extendComponentView({type:"radiusAxis",render:function render(t,e){if(this.group.removeAll(),t.get("show")){var i=e.getComponent("polar",t.get("polarIndex")),o=i.coordinateSystem.getAngleAxis(),u=t.axis,h=i.coordinateSystem,c=u.getTicksCoords(),d=o.getExtent()[0],f=u.getExtent(),p=n(h,t,d),g=new a(t,p);r.each(s,g.add,g),this.group.add(g.getGroup()),r.each(l,function(e){t.get(e+".show")&&this["_"+e](t,h,d,f,c);},this);}},_splitLine:function _splitLine(t,e,i,n,a){var s=t.getModel("splitLine"),l=s.getModel("lineStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=0;d<a.length;d++){var f=h++%u.length;c[f]=c[f]||[],c[f].push(new o.Circle({shape:{cx:e.cx,cy:e.cy,r:a[d]},silent:!0}));}for(var d=0;d<c.length;d++){this.group.add(o.mergePath(c[d],{style:r.defaults({stroke:u[d%u.length],fill:null},l.getLineStyle()),silent:!0}));}},_splitArea:function _splitArea(t,e,i,n,a){var s=t.getModel("splitArea"),l=s.getModel("areaStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=a[0],f=1;f<a.length;f++){var p=h++%u.length;c[p]=c[p]||[],c[p].push(new o.Sector({shape:{cx:e.cx,cy:e.cy,r0:d,r:a[f],startAngle:0,endAngle:2*Math.PI},silent:!0})),d=a[f];}for(var f=0;f<c.length;f++){this.group.add(o.mergePath(c[f],{style:r.defaults({fill:u[f%u.length]},l.getAreaStyle()),silent:!0}));}}});},function(t,e,i){function n(t,e){e.update="updateView",r.registerAction(e,function(e,i){var n={};return i.eachComponent({mainType:"geo",query:e},function(i){i[t](e.name);var r=i.coordinateSystem;o.each(r.regions,function(t){n[t.name]=i.isSelected(t.name)||!1;});}),{selected:n,name:e.name};});}i(296),i(164),i(297),i(177);var r=i(1),o=i(4);n("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),n("select",{type:"geoSelect",event:"geoselected"}),n("unSelect",{type:"geoUnSelect",event:"geounselected"});},function(t,e,i){"use strict";var n=i(5),r=i(19),o=i(12),a=i(4),s=i(141),l=i(164),u=r.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function init(t){r.prototype.init.apply(this,arguments),n.defaultEmphasis(t.label,["position","show","textStyle","distance","formatter"]);},optionUpdated:function optionUpdated(){var t=this.option,e=this;t.regions=l.getFilledRegions(t.regions,t.map),this._optionModelMap=a.reduce(t.regions||[],function(t,i){return i.name&&(t[i.name]=new o(i,e)),t;},{}),this.updateSelectedMap(t.regions);},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:.75,silent:!1,map:"",center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,textStyle:{color:"#000"}},emphasis:{show:!0,textStyle:{color:"rgb(100,0,0)"}}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function getRegionModel(t){return this._optionModelMap[t];},getFormattedLabel:function getFormattedLabel(t,e){var i=this.get("label."+e+".formatter"),n={name:t};return"function"==typeof i?(n.status=e,i(n)):"string"==typeof i?i.replace("{a}",n.seriesName):void 0;},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;}});a.mixin(u,s),t.exports=u;},function(t,e,i){"use strict";var n=i(174);t.exports=i(1).extendComponentView({type:"geo",init:function init(t,e){var i=new n(e,!0);this._mapDraw=i,this.group.add(i.group);},render:function render(t,e,i,n){if(!n||"geoToggleSelect"!==n.type||n.from!==this.uid){var r=this._mapDraw;t.get("show")?r.draw(t,e,i,this,n):this._mapDraw.group.removeAll(),this.group.silent=t.get("silent");}},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove();}});},function(t,e,i){i(299),i(302),i(303);var n=i(1);n.extendComponentView({type:"single"});},function(t,e,i){function n(t,e){var i=[];return t.eachComponent("singleAxis",function(n,o){var a=new r(n,t,e);a.name="single_"+o,a.resize(n,e),n.coordinateSystem=a,i.push(a);}),t.eachSeries(function(e){if("singleAxis"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"singleAxis",index:e.get("singleAxisIndex"),id:e.get("singleAxisId")})[0];e.coordinateSystem=i.coordinateSystem;}}),i;}var r=i(300);i(26).register("single",{create:n,dimensions:r.prototype.dimensions});},function(t,e,i){function n(t,e,i){this.dimension="x",this.dimensions=["x"],this._axis=null,this._rect,this._init(t,e,i),this._model=t;}var r=i(301),o=i(114),a=i(21);n.prototype={type:"singleAxis",constructor:n,_init:function _init(t,e,i){var n=this.dimension,a=new r(n,o.createScaleByModel(t),[0,0],t.get("type"),t.get("position")),s="category"===a.type;a.onBand=s&&t.get("boundaryGap"),a.inverse=t.get("inverse"),a.orient=t.get("orient"),t.axis=a,a.model=t,this._axis=a;},update:function update(t,e){this._updateAxisFromSeries(t);},_updateAxisFromSeries:function _updateAxisFromSeries(t){t.eachSeries(function(t){var e=t.getData(),i=this.dimension;this._axis.scale.unionExtent(e.getDataExtent(t.coordDimToDataDim(i))),o.niceScaleExtent(this._axis,this._axis.model);},this);},resize:function resize(t,e){this._rect=a.getLayoutRect({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis();},getRect:function getRect(){return this._rect;},_adjustAxis:function _adjustAxis(){var t=this._rect,e=this._axis,i=e.isHorizontal(),n=i?[0,t.width]:[0,t.height],r=e.reverse?1:0;e.setExtent(n[r],n[1-r]),this._updateAxisTransform(e,i?t.x:t.y);},_updateAxisTransform:function _updateAxisTransform(t,e){var i=t.getExtent(),n=i[0]+i[1],r=t.isHorizontal();t.toGlobalCoord=r?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord=r?function(t){return t-e;}:function(t){return n-t+e;};},getAxis:function getAxis(){return this._axis;},getBaseAxis:function getBaseAxis(){return this._axis;},containPoint:function containPoint(t){var e=this.getRect(),i=this.getAxis(),n=i.orient;return"horizontal"===n?i.contain(i.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:i.contain(i.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height;},pointToData:function pointToData(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))];},dataToPoint:function dataToPoint(t){var e=this.getAxis(),i=this.getRect(),n=[],r="horizontal"===e.orient?0:1;return n[r]=e.toGlobalCoord(e.dataToCoord(+t)),n[1-r]=0===r?i.y+i.height/2:i.x+i.width/2,n;}},t.exports=n;},function(t,e,i){var n=i(4),r=i(123),o=i(114),a=function a(t,e,i,n,o){r.call(this,t,e,i),this.type=n||"value",this.position=o||"bottom",this.orient=null,this._labelInterval=null;};a.prototype={constructor:a,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},getLabelInterval:function getLabelInterval(){var t=this._labelInterval;if(!t){var e=this.model,i=e.getModel("axisLabel"),r=i.get("interval");if("category"!==this.type||"auto"!==r)return t=this._labelInterval="auto"===r?0:r;t=this._labelInterval=o.getAxisLabelInterval(n.map(this.scale.getTicks(),this.dataToCoord,this),e.getFormattedLabels(),i.getModel("textStyle").getFont(),this.isHorizontal());}return t;},toGlobalCoord:null,toLocalCoord:null},n.inherits(a,r),t.exports=a;},function(t,e,i){function n(t){var e=t.coordinateSystem,i=t.axis,n={},r=i.position,o=i.orient,a=e.getRect(),s=[a.x,a.x+a.width,a.y,a.y+a.height],l={horizontal:{top:s[2],bottom:s[3]},vertical:{left:s[0],right:s[1]}};n.position=["vertical"===o?l.vertical[r]:s[0],"horizontal"===o?l.horizontal[r]:s[3]];var u={horizontal:0,vertical:1};n.rotation=Math.PI/2*u[o];var h={top:-1,bottom:1,right:1,left:-1};n.labelDirection=n.tickDirection=n.nameDirection=h[r],t.getModel("axisTick").get("inside")&&(n.tickDirection=-n.tickDirection),t.getModel("axisLabel").get("inside")&&(n.labelDirection=-n.labelDirection);var c=t.getModel("axisLabel").get("rotate");return n.labelRotation="top"===r?-c:c,n.labelInterval=i.getLabelInterval(),n.z2=1,n;}var r=i(133),o=i(4),a=i(43),s=r.getInterval,l=r.ifIgnoreOnTick,u=["axisLine","axisLabel","axisTick","axisName"],h="splitLine",c=i(1).extendComponentView({type:"singleAxis",render:function render(t,e){var i=this.group;i.removeAll();var a=n(t),s=new r(t,a);o.each(u,s.add,s),i.add(s.getGroup()),t.get(h+".show")&&this["_"+h](t,a.labelInterval);},_splitLine:function _splitLine(t,e){var i=t.axis,n=t.getModel("splitLine"),r=n.getModel("lineStyle"),o=r.get("width"),u=r.get("color"),h=s(n,e);u=u instanceof Array?u:[u];for(var c=t.coordinateSystem.getRect(),d=i.isHorizontal(),f=[],p=0,g=i.getTicksCoords(),m=[],v=[],y=0;y<g.length;++y){if(!l(i,y,h)){var x=i.toGlobalCoord(g[y]);d?(m[0]=x,m[1]=c.y,v[0]=x,v[1]=c.y+c.height):(m[0]=c.x,m[1]=x,v[0]=c.x+c.width,v[1]=x);var _=p++%u.length;f[_]=f[_]||[],f[_].push(new a.Line(a.subPixelOptimizeLine({shape:{x1:m[0],y1:m[1],x2:v[0],y2:v[1]},style:{lineWidth:o},silent:!0})));}}for(var y=0;y<f.length;++y){this.group.add(a.mergePath(f[y],{style:{stroke:u[y%u.length],lineDash:r.getLineDash(o),lineWidth:o},silent:!0}));}}});t.exports=c;},function(t,e,i){function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(127),a=i(4),s=r.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null}),l={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:2,type:"solid"}},axisTick:{show:!0,length:6,lineStyle:{width:2}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}};a.merge(s.prototype,i(129)),o("single",s,n,l),t.exports=s;},function(t,e,i){i(1).registerPreprocessor(i(305)),i(306),i(311),i(312),i(313),i(314);},function(t,e,i){function n(t){var e={};r.each(t,function(t){e[t]=1;}),t.length=0,r.each(e,function(e,i){t.push(i);});}var r=i(4),o=["rect","polygon","keep","clear"];t.exports=function(t,e){var i=t&&t.brush;if(r.isArray(i)||(i=i?[i]:[]),i.length){var a=[];r.each(i,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(a=a.concat(e));});var s=t&&t.toolbox;r.isArray(s)&&(s=s[0]),s||(s={feature:{}},t.toolbox=[s]);var l=s.feature||(s.feature={}),u=l.brush||(l.brush={}),h=u.type||(u.type=[]);h.push.apply(h,a),n(h),e&&!h.length&&h.push.apply(h,o);}};},function(t,e,i){function n(t,e,i,n,o){if(o){var a=t.getZr();if(!a[x]){a[y]||(a[y]=r);var s=g.createOrUpdate(a,y,i,e);s(t,n);}}}function r(t,e){if(!t.isDisposed()){var i=t.getZr();i[x]=!0,t.dispatchAction({type:"brushSelect",batch:e}),i[x]=!1;}}function o(t,e,i,n){for(var r=i.getItemLayout(n),o=0,a=e.length;a>o;o++){var s=e[o];if(t[s.brushType](r,s.selectors,s))return!0;}}function a(t){var e=t.brushSelector;if(d.isString(e)){var i=[];return d.each(p,function(t,n){i[n]=t[e];}),i;}if(d.isFunction(e)){var n={};return d.each(p,function(t,i){n[i]=e;}),n;}return e;}function s(t,e){var i=t.option.seriesIndex;return null!=i&&"all"!==i&&(d.isArray(i)?d.indexOf(i,e)<0:e!==i);}function l(t){var e=t.selectors={};return d.each(p[t.brushType],function(i,n){e[n]=function(n){return i(n,e,t);};}),t;}function u(t){return new f(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0]);}var h=i(1),c=i(307),d=i(4),f=i(9),p=i(308),g=i(309),m=i(310),v=["inBrush","outOfBrush"],y="__ecBrushSelect",x="__ecInBrushSelectEvent",_=h.PRIORITY.VISUAL.BRUSH;h.registerLayout(_,function(t,e,i){t.eachComponent({mainType:"brush"},function(e){i&&"takeGlobalCursor"===i.type&&e.setBrushOption("brush"===i.key?i.brushOption:{brushType:!1}),e.coordInfoList=m.makeCoordInfoList(e.option,t),m.parseInputRanges(e,t);});}),h.registerVisual(_,function(t,e,i){var r,u,h=[];t.eachComponent({mainType:"brush"},function(e,i){function n(t){return"all"===_||w[t];}function f(t){return!!t.length;}function p(t,e){var i=t.coordinateSystem;I|=i.hasAxisbrushed(),n(e)&&i.eachActiveState(t.getData(),function(t,e){"active"===t&&(S[e]=1);});}function g(t,i,r){var l=a(t);if(l&&!s(e,i)&&(d.each(T,function(i){l[i.brushType]&&m.controlSeries(i,e,t)&&r.push(i),I|=f(r);}),n(i)&&f(r))){var u=t.getData();u.each(function(t){o(l,r,u,t)&&(S[t]=1);});}}var y={brushId:e.id,brushIndex:i,brushName:e.name,areas:d.clone(e.areas),selected:[]};h.push(y);var x=e.option,_=x.brushLink,w=[],S=[],M=[],I=0;i||(r=x.throttleType,u=x.throttleDelay);var T=d.map(e.areas,function(t){return l(d.defaults({boundingRect:b[t.brushType](t)},t));}),A=c.createVisualMappings(e.option,v,function(t){t.mappingMethod="fixed";});d.isArray(_)&&d.each(_,function(t){w[t]=1;}),t.eachSeries(function(t,e){var i=M[e]=[];"parallel"===t.subType?p(t,e,i):g(t,e,i);}),t.eachSeries(function(t,e){var i={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};y.selected.push(i);var r=a(t),s=M[e],l=t.getData(),u=n(e)?function(t){return S[t]?(i.dataIndex.push(l.getRawIndex(t)),"inBrush"):"outOfBrush";}:function(t){return o(r,s,l,t)?(i.dataIndex.push(l.getRawIndex(t)),"inBrush"):"outOfBrush";};(n(e)?I:f(s))&&c.applyVisual(v,A,l,u);});}),n(e,r,u,h,i);});var b={lineX:d.noop,lineY:d.noop,rect:function rect(t){return u(t.range);},polygon:function polygon(t){for(var e,i=t.range,n=0,r=i.length;r>n;n++){e=e||[[1/0,-(1/0)],[1/0,-(1/0)]];var o=i[n];o[0]<e[0][0]&&(e[0][0]=o[0]),o[0]>e[0][1]&&(e[0][1]=o[0]),o[1]<e[1][0]&&(e[1][0]=o[1]),o[1]>e[1][1]&&(e[1][1]=o[1]);}return e&&u(e);}};},function(t,e,i){function n(t){if(t)for(var e in t){if(t.hasOwnProperty(e))return!0;}}var r=i(4),o=i(193),a=r.each,s={createVisualMappings:function createVisualMappings(t,e,i){function n(){var t=function t(){};t.prototype.__hidden=t.prototype;var e=new t();return e;}var s={};return a(e,function(e){var l=s[e]=n();a(t[e],function(t,n){if(o.isValidType(n)){var a={type:n,visual:t};i&&i(a,e),l[n]=new o(a),"opacity"===n&&(a=r.clone(a),a.type="colorAlpha",l.__hidden.__alphaForOpacity=new o(a));}});}),s;},replaceVisualOption:function replaceVisualOption(t,e,i){var o;r.each(i,function(t){e.hasOwnProperty(t)&&n(e[t])&&(o=!0);}),o&&r.each(i,function(i){e.hasOwnProperty(i)&&n(e[i])?t[i]=r.clone(e[i]):delete t[i];});},applyVisual:function applyVisual(t,e,i,n,a,s){function l(t){return i.getItemVisual(d,t);}function u(t,e){i.setItemVisual(d,t,e);}function h(t,i){d=null==s?t:i;for(var r=n.call(a,t),o=e[r],h=c[r],f=0,p=h.length;p>f;f++){var g=h[f];o[g]&&o[g].applyVisual(t,l,u);}}var c={};r.each(t,function(t){var i=o.prepareVisualTypes(e[t]);c[t]=i;});var d;null==s?i.each(h,!0):i.each([s],h,!0);}};t.exports=s;},function(t,e,i){function n(t){var e=["x","y"],i=["width","height"];return{point:function point(e,i,n){var o=n.range,a=e[t];return r(a,o);},rect:function rect(n,o,a){var s=a.range;return r(n[e[t]],s)||r(n[e[t]]+n[i[t]],s);}};}function r(t,e){return e[0]<=t&&t<=e[1];}function o(t,e,i,n,r){for(var o=0,s=r[r.length-1];o<r.length;o++){var l=r[o];if(a(t,e,i,n,l[0],l[1],s[0],s[1]))return!0;s=l;}}function a(t,e,i,n,r,o,a,u){var h=l(i-t,r-a,n-e,o-u);if(s(h))return!1;var c=l(r-t,r-a,o-e,o-u)/h;if(0>c||c>1)return!1;var d=l(i-t,r-t,n-e,o-e)/h;return 0>d||d>1?!1:!0;}function s(t){return 1e-6>=t&&t>=-1e-6;}function l(t,e,i,n){return t*n-e*i;}var u=i(168).contain,h=i(9),c={lineX:n(0),lineY:n(1),rect:{point:function point(t,e,i){return i.boundingRect.contain(t[0],t[1]);},rect:function rect(t,e,i){return i.boundingRect.intersect(t);}},polygon:{point:function point(t,e,i){return i.boundingRect.contain(t[0],t[1])&&u(i.range,t[0],t[1]);},rect:function rect(t,e,i){var n=i.range;if(n.length<=1)return!1;var r=t.x,a=t.y,s=t.width,l=t.height,c=n[0];return u(n,r,a)||u(n,r+s,a)||u(n,r,a+l)||u(n,r+s,a+l)||h.create(t).contain(c[0],c[1])||o(r,a,r+s,a,n)||o(r,a,r,a+l,n)||o(r+s,a,r+s,a+l,n)||o(r,a+l,r+s,a+l,n)?!0:void 0;}}};t.exports=c;},function(t,e){var i={},n="\x00__throttleOriginMethod",r="\x00__throttleRate",o="\x00__throttleType";i.throttle=function(t,e,i){function n(){u=new Date().getTime(),h=null,t.apply(a,s||[]);}var r,o,a,s,l=0,u=0,h=null;e=e||0;var c=function c(){r=new Date().getTime(),a=this,s=arguments,o=r-(i?l:u)-e,clearTimeout(h),i?h=setTimeout(n,e):o>=0?n():h=setTimeout(n,-o),l=r;};return c.clear=function(){h&&(clearTimeout(h),h=null);},c;},i.createOrUpdate=function(t,e,a,s){var l=t[e];if(l){var u=l[n]||l,h=l[o],c=l[r];if(c!==a||h!==s){if(null==a||!s)return t[e]=u;l=t[e]=i.throttle(u,a,"debounce"===s),l[n]=u,l[o]=s,l[r]=a;}return l;}},i.clear=function(t,e){var i=t[e];i&&i[n]&&(t[e]=i[n]);},t.exports=i;},function(t,e,i){function n(t){return t[0]>t[1]&&t.reverse(),t;}function r(t,e){for(var i=!0,n=0;n<h.length;n++){var r=h[n]+"Index";if(t[r]>=0){i=!1;for(var o=0;o<e.length;o++){if(e[o][r]===t[r])return e[o];}}}return i;}function o(t,e,i,r){var o=i.coordSys.getAxis(t);return a.assert(o,"line brush is only available in cartesian (grid)."),n(a.map([0,1],function(t){return e?o.coordToData(o.toLocalCoord(r[t])):o.toGlobalCoord(o.dataToCoord(r[t]));}));}var a=i(4),s=i(43),l=a.each,u={},h=["geo","xAxis","yAxis"],c="--",d=["dataToPoint","pointToData"];u.parseOutputRanges=function(t,e,i,n){l(t,function(t,i){var o=t.panelId;if(o){o=o.split(c),t[o[0]+"Index"]=+o[1];var a=r(t,e);t.coordRange=f[t.brushType](1,a,t.range),n&&(n[i]=a);}});},u.parseInputRanges=function(t,e){l(t.areas,function(e){var i=r(e,t.coordInfoList);a.assert(!i||i===!0||e.coordRange,"coordRange must be specified when coord index specified."),a.assert(!i||i!==!0||e.range,"range must be specified."),e.range=e.range||[],i&&i!==!0&&(e.range=f[e.brushType](0,i,e.coordRange),e.panelId=i.panelId);});},u.makePanelOpts=function(t){var e=[];return l(t,function(t){var i,n=t.coordSys;t.geoIndex>=0?(i=n.getBoundingRect().clone(),i.applyTransform(s.getTransform(n))):i=n.grid.getRect().clone(),e.push({panelId:t.panelId,rect:i});}),e;},u.makeCoordInfoList=function(t,e){var i=[];return l(h,function(n){var r=t[n+"Index"];null!=r&&"none"!==r&&("all"===r||a.isArray(r)||(r=[r]),e.eachComponent({mainType:n},function(t,e){if(!("all"!==r&&a.indexOf(r,e)<0)){var o,s;"xAxis"===n||"yAxis"===n?o=t.axis.grid:s=t.coordinateSystem;for(var l,u=0,h=i.length;h>u;u++){var d=i[u];if(a.assert(d[n+"Index"]!=e,"Coord should not be defined duplicately: "+n+e),"yAxis"===n&&!d.yAxis&&d.xAxis){var f=o.getCartesian(d.xAxisIndex,e);if(f){s=f,l=d;break;}}}!l&&i.push(l={}),l[n]=t,l[n+"Index"]=e,l.panelId=n+c+e,l.coordSys=s||o.getCartesian(l.xAxisIndex,l.yAxisIndex),l.coordSys?i[n+"Has"]=!0:i.pop();}}));}),i;},u.controlSeries=function(t,e,i){var n=r(t,e.coordInfoList);return n===!0||n&&n.coordSys===i.coordinateSystem;};var f={lineX:a.curry(o,"x"),lineY:a.curry(o,"y"),rect:function rect(t,e,i){var r=e.coordSys,o=r[d[t]]([i[0][0],i[1][0]]),a=r[d[t]]([i[0][1],i[1][1]]);return[n([o[0],a[0]]),n([o[1],a[1]])];},polygon:function polygon(t,e,i){var n=e.coordSys;return a.map(i,n[d[t]],n);}};t.exports=u;},function(t,e,i){var n=i(1),r=i(4),o=i(307),a=i(12),s=["#ddd"],l=n.extendComponentModel({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)",width:null},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function optionUpdated(t,e){var i=this.option;!e&&o.replaceVisualOption(i,t,["inBrush","outOfBrush"]),i.inBrush=i.inBrush||{},i.outOfBrush=i.outOfBrush||{color:s};},setAreas:function setAreas(t){r.assert(r.isArray(t)),r.each(t,function(t){r.assert(t.brushType,"Illegal areas");}),t&&(this.areas=r.map(t,function(t){return this._mergeBrushOption(t);},this));},setBrushOption:function setBrushOption(t){this.brushOption=this._mergeBrushOption(t),this.brushType=this.brushOption.brushType;},_mergeBrushOption:function _mergeBrushOption(t){var e=this.option;return r.merge({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new a(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick},t,!0);}});t.exports=l;},function(t,e,i){function n(t,e,i,n){(!n||n.$from!==t.id)&&this._brushController.setPanels(s.makePanelOpts(t.coordInfoList)).enableBrush(t.brushOption).updateCovers(t.areas.slice());}var r=i(4),o=i(234),a=i(1),s=i(310);t.exports=a.extendComponentView({type:"brush",init:function init(t,e){this.ecModel=t,this.api=e,this.model,(this._brushController=new o(e.getZr())).on("brush",r.bind(this._onBrush,this)).mount();},render:function render(t){return this.model=t,n.apply(this,arguments);},updateView:n,updateLayout:n,updateVisual:n,dispose:function dispose(){this._brushController.dispose();},_onBrush:function _onBrush(t,e){var i=this.model.id;s.parseOutputRanges(t,this.model.coordInfoList,this.ecModel),(!e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:i,areas:r.clone(t),$from:i});}});},function(t,e,i){var n=i(1);n.registerAction({type:"brush",event:"brush",update:"updateView"},function(t,e){e.eachComponent({mainType:"brush",query:t},function(e){e.setAreas(t.areas);});}),n.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},function(){});},function(t,e,i){"use strict";function n(t,e,i){this.model=t,this.ecModel=e,this.api=i,this._brushType,this._brushMode;}var r=i(315),o=i(4);n.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}};var a=n.prototype;a.render=a.updateView=a.updateLayout=function(t,e,i){var n,r,a;e.eachComponent({mainType:"brush"},function(t){n=t.brushType,r=t.brushOption.brushMode||"single",a|=t.areas.length;}),this._brushType=n,this._brushMode=r,o.each(t.get("type",!0),function(e){t.setIconStatus(e,("keep"===e?"multiple"===r:"clear"===e?a:e===n)?"emphasis":"normal");});},a.getIcons=function(){var t=this.model,e=t.get("icon",!0),i={};return o.each(t.get("type",!0),function(t){e[t]&&(i[t]=e[t]);}),i;},a.onclick=function(t,e,i){var e=this.api,n=this._brushType,r=this._brushMode;"clear"===i?e.dispatchAction({type:"brush",areas:[]}):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===i?n:n===i?!1:i,brushMode:"keep"===i?"multiple"===r?"single":"multiple":r}});},r.register("brush",n),t.exports=n;},function(t,e){"use strict";var i={};t.exports={register:function register(t,e){i[t]=e;},get:function get(t){return i[t];}};},function(t,e,i){"use strict";var n=i(1),r=i(43),o=i(21);n.extendComponentModel({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),n.extendComponentView({type:"title",render:function render(t,e,i){if(this.group.removeAll(),t.get("show")){var n=this.group,a=t.getModel("textStyle"),s=t.getModel("subtextStyle"),l=t.get("textAlign"),u=t.get("textBaseline"),h=new r.Text({style:{text:t.get("text"),textFont:a.getFont(),fill:a.getTextColor()},z2:10}),c=h.getBoundingRect(),d=t.get("subtext"),f=new r.Text({style:{text:d,textFont:s.getFont(),fill:s.getTextColor(),y:c.height+t.get("itemGap"),textBaseline:"top"},z2:10}),p=t.get("link"),g=t.get("sublink");h.silent=!p,f.silent=!g,p&&h.on("click",function(){window.open(p,"_"+t.get("target"));}),g&&f.on("click",function(){window.open(g,"_"+t.get("subtarget"));}),n.add(h),d&&n.add(f);var m=n.getBoundingRect(),v=t.getBoxLayoutParams();v.width=m.width,v.height=m.height;var y=o.getLayoutRect(v,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));l||(l=t.get("left")||t.get("right"),"middle"===l&&(l="center"),"right"===l?y.x+=y.width:"center"===l&&(y.x+=y.width/2)),u||(u=t.get("top")||t.get("bottom"),"center"===u&&(u="middle"),"bottom"===u?y.y+=y.height:"middle"===u&&(y.y+=y.height/2),u=u||"top"),n.attr("position",[y.x,y.y]);var x={textAlign:l,textVerticalAlign:u};h.setStyle(x),f.setStyle(x),m=n.getBoundingRect();var _=y.margin,b=t.getItemStyle(["color","opacity"]);b.fill=t.get("backgroundColor");var w=new r.Rect({shape:{x:m.x-_[3],y:m.y-_[0],width:m.width+_[1]+_[3],height:m.height+_[0]+_[2]},style:b,silent:!0});r.subPixelOptimizeRect(w),n.add(w);}}});},function(t,e,i){i(318),i(319),i(322),i(323),i(324),i(326),i(327),i(329),i(330);},function(t,e,i){i(19).registerSubTypeDefaulter("dataZoom",function(t){return"slider";});},function(t,e,i){function n(t){var e={};return c(["start","end","startValue","endValue","throttle"],function(i){t.hasOwnProperty(i)&&(e[i]=t[i]);}),e;}function r(t,e,i,n){null!=i[e]&&null==i[t]&&(n[t]=null);}var o=i(4),a=i(2),s=i(1),l=i(5),u=i(320),h=i(321),c=o.each,d=u.eachAxisDim,f=s.extendComponentModel({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null},init:function init(t,e,i){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0;var r=n(t);this.mergeDefaultAndTheme(t,i),this.doInit(r);},mergeOption:function mergeOption(t){var e=n(t);o.merge(this.option,t,!0),this.doInit(e);},doInit:function doInit(t){var e=this.option;a.canvasSupported||(e.realtime=!1),this._setDefaultThrottle(t),r("start","startValue",t,e),r("end","endValue",t,e),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies();},_giveAxisProxies:function _giveAxisProxies(){var t=this._axisProxies;this.eachTargetAxis(function(e,i,n,r){var o=this.dependentModels[e.axis][i],a=o.__dzAxisProxy||(o.__dzAxisProxy=new h(e.name,i,this,r));t[e.name+"_"+i]=a;},this);},_resetTarget:function _resetTarget(){var t=this.option,e=this._judgeAutoMode();d(function(e){var i=e.axisIndex;t[i]=l.normalizeToArray(t[i]);},this),"axisIndex"===e?this._autoSetAxisIndex():"orient"===e&&this._autoSetOrient();},_judgeAutoMode:function _judgeAutoMode(){var t=this.option,e=!1;d(function(i){null!=t[i.axisIndex]&&(e=!0);},this);var i=t.orient;return null==i&&e?"orient":e?void 0:(null==i&&(t.orient="horizontal"),"axisIndex");},_autoSetAxisIndex:function _autoSetAxisIndex(){var t=!0,e=this.get("orient",!0),i=this.option;if(t){var n="vertical"===e?{dim:"y",axisIndex:"yAxisIndex",axis:"yAxis"}:{dim:"x",axisIndex:"xAxisIndex",axis:"xAxis"};this.dependentModels[n.axis].length&&(i[n.axisIndex]=[0],t=!1);}t&&d(function(e){if(t){var n=[],r=this.dependentModels[e.axis];if(r.length&&!n.length)for(var o=0,a=r.length;a>o;o++){"category"===r[o].get("type")&&n.push(o);}i[e.axisIndex]=n,n.length&&(t=!1);}},this),t&&this.ecModel.eachSeries(function(t){this._isSeriesHasAllAxesTypeOf(t,"value")&&d(function(e){var n=i[e.axisIndex],r=t.get(e.axisIndex),a=t.get(e.axisId),s=t.ecModel.queryComponents({mainType:e.axis,index:r,id:a})[0];if(!s)throw new Error(e.axis+' "'+o.retrieve(r,a,0)+'" not found');r=s.componentIndex,o.indexOf(n,r)<0&&n.push(r);});},this);},_autoSetOrient:function _autoSetOrient(){var t;this.eachTargetAxis(function(e){!t&&(t=e.name);},this),this.option.orient="y"===t?"vertical":"horizontal";},_isSeriesHasAllAxesTypeOf:function _isSeriesHasAllAxesTypeOf(t,e){var i=!0;return d(function(n){var r=t.get(n.axisIndex),o=this.dependentModels[n.axis][r];o&&o.get("type")===e||(i=!1);},this),i;},_setDefaultThrottle:function _setDefaultThrottle(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&e.animationDurationUpdate>0?100:20;}},getFirstTargetAxisModel:function getFirstTargetAxisModel(){var t;return d(function(e){if(null==t){var i=this.get(e.axisIndex);i.length&&(t=this.dependentModels[e.axis][i[0]]);}},this),t;},eachTargetAxis:function eachTargetAxis(t,e){var i=this.ecModel;d(function(n){c(this.get(n.axisIndex),function(r){t.call(e,n,r,this,i);},this);},this);},getAxisProxy:function getAxisProxy(t,e){return this._axisProxies[t+"_"+e];},setRawRange:function setRawRange(t){c(["start","end","startValue","endValue"],function(e){this.option[e]=t[e];},this);},getPercentRange:function getPercentRange(){var t=this.findRepresentativeAxisProxy();return t?t.getDataPercentWindow():void 0;},getValueRange:function getValueRange(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var i=this.findRepresentativeAxisProxy();return i?i.getDataValueWindow():void 0;},findRepresentativeAxisProxy:function findRepresentativeAxisProxy(){var t=this._axisProxies;for(var e in t){if(t.hasOwnProperty(e)&&t[e].hostedBy(this))return t[e];}for(var e in t){if(t.hasOwnProperty(e)&&!t[e].hostedBy(this))return t[e];}}});t.exports=f;},function(t,e,i){var n=i(6),r=i(4),o={},a=["x","y","z","radius","angle"];o.createNameEach=function(t,e){t=t.slice();var i=r.map(t,n.capitalFirst);e=(e||[]).slice();var o=r.map(e,n.capitalFirst);return function(n,a){r.each(t,function(t,r){for(var s={name:t,capital:i[r]},l=0;l<e.length;l++){s[e[l]]=t+o[l];}n.call(a,s);});};},o.eachAxisDim=o.createNameEach(a,["axisIndex","axis","index","id"]),o.createLinkedNodesFinder=function(t,e,i){function n(t,e){return r.indexOf(e.nodes,t)>=0;}function o(t,n){var o=!1;return e(function(e){r.each(i(t,e)||[],function(t){n.records[e.name][t]&&(o=!0);});}),o;}function a(t,n){n.nodes.push(t),e(function(e){r.each(i(t,e)||[],function(t){n.records[e.name][t]=!0;});});}return function(i){function r(t){!n(t,s)&&o(t,s)&&(a(t,s),l=!0);}var s={nodes:[],records:{}};if(e(function(t){s.records[t.name]={};}),!i)return s;a(i,s);var l;do{l=!1,t(r);}while(l);return s;};},t.exports=o;},function(t,e,i){function n(t,e){var i=[1/0,-(1/0)];return u(e,function(e){var n=e.getData();n&&u(e.coordDimToDataDim(t),function(t){var e=n.getDataExtent(t);e[0]<i[0]&&(i[0]=e[0]),e[1]>i[1]&&(i[1]=e[1]);});},this),i;}function r(t,e,i){var n=i.getAxisModel(),r=n.axis.scale,a=[0,100],s=[t.start,t.end],c=[];return e=e.slice(),o(e,n,r),u(["startValue","endValue"],function(e){c.push(null!=t[e]?r.parse(t[e]):null);}),u([0,1],function(t){var i=c[t],n=s[t];null!=n||null==i?(null==n&&(n=a[t]),i=r.parse(l.linearMap(n,a,e,!0))):n=l.linearMap(i,e,a,!0),c[t]=i,s[t]=n;}),{valueWindow:h(c),percentWindow:h(s)};}function o(t,e,i){return u(["min","max"],function(n,r){var o=e.get(n,!0);null!=o&&(o+"").toLowerCase()!=="data"+n&&(t[r]=i.parse(o));}),e.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t;}function a(t,e){var i=t.getAxisModel(),n=t._percentWindow,r=t._valueWindow;if(n){var o=e||0===n[0]&&100===n[1],a=!e&&l.getPixelPrecision(r,[0,500]),s=!(e||20>a&&a>=0),u=e||o||s;i.setRange&&i.setRange(u?null:+r[0].toFixed(a),u?null:+r[1].toFixed(a));}}var s=i(4),l=i(7),u=s.each,h=l.asc,c=function c(t,e,i,n){this._dimName=t,this._axisIndex=e,this._valueWindow,this._percentWindow,this._dataExtent,this.ecModel=n,this._dataZoomModel=i;};c.prototype={constructor:c,hostedBy:function hostedBy(t){return this._dataZoomModel===t;},getDataExtent:function getDataExtent(){return this._dataExtent.slice();},getDataValueWindow:function getDataValueWindow(){return this._valueWindow.slice();},getDataPercentWindow:function getDataPercentWindow(){return this._percentWindow.slice();},getTargetSeriesModels:function getTargetSeriesModels(){var t=[],e=this.ecModel;return e.eachSeries(function(i){var n=i.get("coordinateSystem");if("cartesian2d"===n||"polar"===n){var r=this._dimName,o=e.queryComponents({mainType:r+"Axis",index:i.get(r+"AxisIndex"),id:i.get(r+"AxisId")})[0];this._axisIndex===(o&&o.componentIndex)&&t.push(i);}},this),t;},getAxisModel:function getAxisModel(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex);},getOtherAxisModel:function getOtherAxisModel(){var t,e,i=this._dimName,n=this.ecModel,r=this.getAxisModel(),o="x"===i||"y"===i;o?(e="gridIndex",t="x"===i?"y":"x"):(e="polarIndex",t="angle"===i?"radius":"angle");var a;return n.eachComponent(t+"Axis",function(t){(t.get(e)||0)===(r.get(e)||0)&&(a=t);}),a;},reset:function reset(t){if(t===this._dataZoomModel){var e=this._dataExtent=n(this._dimName,this.getTargetSeriesModels()),i=r(t.option,e,this);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,a(this);}},restore:function restore(t){t===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,a(this,!0));},filterData:function filterData(t){function e(t){return t>=o[0]&&t<=o[1];}if(t===this._dataZoomModel){var i=this._dimName,n=this.getTargetSeriesModels(),r=t.get("filterMode"),o=this._valueWindow,a=this.getOtherAxisModel();t.get("$fromToolbox")&&a&&"category"===a.get("type")&&(r="empty"),u(n,function(t){var n=t.getData();n&&u(t.coordDimToDataDim(i),function(i){"empty"===r?t.setData(n.map(i,function(t){return e(t)?t:NaN;})):n.filterSelf(i,e);});});}}},t.exports=c;},function(t,e,i){var n=i(29);t.exports=n.extend({type:"dataZoom",render:function render(t,e,i,n){this.dataZoomModel=t,this.ecModel=e,this.api=i;},getTargetInfo:function getTargetInfo(){function t(t,e,i,n){for(var r,o=0;o<i.length;o++){if(i[o].model===t){r=i[o];break;}}r||i.push(r={model:t,axisModels:[],coordIndex:n}),r.axisModels.push(e);}var e=this.dataZoomModel,i=this.ecModel,n=[],r=[],o=[];return e.eachTargetAxis(function(e,a){var s=i.getComponent(e.axis,a);if(s){o.push(s);var l,u=e.axis;"xAxis"===u||"yAxis"===u?l="grid":("angleAxis"===u||"radiusAxis"===u)&&(l="polar");var h=l?i.queryComponents({mainType:l,index:s.get(l+"Index"),id:s.get(l+"Id")})[0]:null;null!=h&&t(h,s,"grid"===l?n:r,h.componentIndex);}},this),{cartesians:n,polars:r,axisModels:o};}});},function(t,e,i){var n=i(319),r=n.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});t.exports=r;},function(t,e,i){function n(t){return"x"===t?"y":"x";}var r=i(4),o=i(43),a=i(309),s=i(322),l=o.Rect,u=i(7),h=u.linearMap,c=i(21),d=i(325),f=u.asc,p=r.bind,g=r.each,m=7,v=1,y=30,x="horizontal",_="vertical",b=5,w=["line","bar","candlestick","scatter"],S=s.extend({type:"dataZoom.slider",init:function init(t,e){this._displayables={},this._orient,this._range,this._handleEnds,this._size,this._handleWidth,this._handleHeight,this._location,this._dragging,this._dataShadowInfo,this.api=e;},render:function render(t,e,i,n){return S.superApply(this,"render",arguments),a.createOrUpdate(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=t.get("orient"),this.dataZoomModel.get("show")===!1?void this.group.removeAll():(n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),void this._updateView());},remove:function remove(){S.superApply(this,"remove",arguments),a.clear(this,"_dispatchZoomAction");},dispose:function dispose(){S.superApply(this,"dispose",arguments),a.clear(this,"_dispatchZoomAction");},_buildView:function _buildView(){var t=this.group;t.removeAll(),this._resetLocation(),this._resetInterval();var e=this._displayables.barGroup=new o.Group();this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup();},_resetLocation:function _resetLocation(){var t=this.dataZoomModel,e=this.api,i=this._findCoordRect(),n={width:e.getWidth(),height:e.getHeight()},o=this._orient===x?{right:n.width-i.x-i.width,top:n.height-y-m,width:i.width,height:y}:{right:m,top:i.y,width:y,height:i.height},a=c.getLayoutParams(t.option);r.each(["right","top","width","height"],function(t){"ph"===a[t]&&(a[t]=o[t]);});var s=c.getLayoutRect(a,n,t.padding);this._location={x:s.x,y:s.y},this._size=[s.width,s.height],this._orient===_&&this._size.reverse();},_positionGroup:function _positionGroup(){var t=this.group,e=this._location,i=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),r=n&&n.get("inverse"),o=this._displayables.barGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(i!==x||r?i===x&&r?{scale:a?[-1,1]:[-1,-1]}:i!==_||r?{scale:a?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:a?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:a?[1,1]:[1,-1]});var s=t.getBoundingRect([o]);t.attr("position",[e.x-s.x,e.y-s.y]);},_getViewExtent:function _getViewExtent(){return[0,this._size[0]];},_renderBackground:function _renderBackground(){var t=this.dataZoomModel,e=this._size;this._displayables.barGroup.add(new l({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40}));},_renderDataShadow:function _renderDataShadow(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(t){var e=this._size,i=t.series,n=i.getRawData(),a=i.getShadowDim?i.getShadowDim():t.otherDim,s=n.getDataExtent(a),l=.3*(s[1]-s[0]);s=[s[0]-l,s[1]+l];var u,c=[0,e[1]],d=[0,e[0]],f=[[e[0],0],[0,0]],p=[],g=d[1]/(n.count()-1),m=0,v=Math.round(n.count()/e[0]);n.each([a],function(t,e){if(v>0&&e%v)return void(m+=g);var i=null==t||isNaN(t)||""===t,n=i?0:h(t,s,c,!0);i&&!u&&e?(f.push([f[f.length-1][0],0]),p.push([p[p.length-1][0],0])):!i&&u&&(f.push([m,0]),p.push([m,0])),f.push([m,n]),p.push([m,n]),m+=g,u=i;});var y=this.dataZoomModel;this._displayables.barGroup.add(new o.Polygon({shape:{points:f},style:r.defaults({fill:y.get("dataBackgroundColor")},y.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new o.Polyline({shape:{points:p},style:y.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}));}},_prepareDataShadowInfo:function _prepareDataShadowInfo(){var t=this.dataZoomModel,e=t.get("showDataShadow");if(e!==!1){var i,o=this.ecModel;return t.eachTargetAxis(function(a,s){var l=t.getAxisProxy(a.name,s).getTargetSeriesModels();r.each(l,function(t){if(!(i||e!==!0&&r.indexOf(w,t.get("type"))<0)){var l=n(a.name),u=o.getComponent(a.axis,s).axis;i={thisAxis:u,series:t,thisDim:a.name,otherDim:l,otherAxisInverse:t.coordinateSystem.getOtherAxis(u).inverse};}},this);},this),i;}},_renderHandle:function _renderHandle(){var t=this._displayables,e=t.handles=[],i=t.handleLabels=[],n=this._displayables.barGroup,r=this._size,a=this.dataZoomModel;n.add(t.filler=new l({draggable:!0,cursor:"move",drift:p(this._onDragMove,this,"all"),ondragstart:p(this._showDataInfo,this,!0),ondragend:p(this._onDragEnd,this),onmouseover:p(this._showDataInfo,this,!0),onmouseout:p(this._showDataInfo,this,!1),style:{fill:a.get("fillerColor"),textPosition:"inside"}})),n.add(new l(o.subPixelOptimizeRect({silent:!0,shape:{x:0,y:0,width:r[0],height:r[1]},style:{stroke:a.get("dataBackgroundColor")||a.get("borderColor"),lineWidth:v,fill:"rgba(0,0,0,0)"}})));var s=a.get("handleIcon");g([0,1],function(t){var r=o.makePath(s,{style:{strokeNoScale:!0},rectHover:!0,cursor:"vertical"===this._orient?"ns-resize":"ew-resize",draggable:!0,drift:p(this._onDragMove,this,t),ondragend:p(this._onDragEnd,this),onmouseover:p(this._showDataInfo,this,!0),onmouseout:p(this._showDataInfo,this,!1)},{x:-.5,y:0,width:1,height:1},"center"),l=r.getBoundingRect();this._handleHeight=u.parsePercent(a.get("handleSize"),this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,r.setStyle(a.getModel("handleStyle").getItemStyle());var h=a.get("handleColor");null!=h&&(r.style.fill=h),n.add(e[t]=r);var c=a.textStyleModel;this.group.add(i[t]=new o.Text({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",fill:c.getTextColor(),textFont:c.getFont()},z2:10}));},this);},_resetInterval:function _resetInterval(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[h(t[0],[0,100],e,!0),h(t[1],[0,100],e,!0)];},_updateInterval:function _updateInterval(t,e){var i=this._handleEnds,n=this._getViewExtent();d(e,i,n,"all"===t||this.dataZoomModel.get("zoomLock")?"rigid":"cross",t),this._range=f([h(i[0],n,[0,100],!0),h(i[1],n,[0,100],!0)]);},_updateView:function _updateView(){var t=this._displayables,e=this._handleEnds,i=f(e.slice()),n=this._size;g([0,1],function(i){var r=t.handles[i],o=this._handleHeight;r.attr({scale:[o,o],position:[e[i],n[1]/2-o/2]});},this),t.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:n[1]}),this._updateDataInfo();},_updateDataInfo:function _updateDataInfo(){function t(t){var e=o.getTransform(i.handles[t].parent,this.group),s=o.transformDirection(0===t?"right":"left",e),l=this._handleWidth/2+b,h=o.applyTransform([u[t]+(0===t?-l:l),this._size[1]/2],e);n[t].setStyle({x:h[0],y:h[1],textVerticalAlign:r===x?"middle":s,textAlign:r===x?s:"center",text:a[t]});}var e=this.dataZoomModel,i=this._displayables,n=i.handleLabels,r=this._orient,a=["",""];if(e.get("showDetail")){var s,l;e.eachTargetAxis(function(t,i){s||(s=e.getAxisProxy(t.name,i).getDataValueWindow(),l=this.ecModel.getComponent(t.axis,i).axis);},this),s&&(a=[this._formatLabel(s[0],l),this._formatLabel(s[1],l)]);}var u=f(this._handleEnds.slice());t.call(this,0),t.call(this,1);},_formatLabel:function _formatLabel(t,e){var i=this.dataZoomModel,n=i.get("labelFormatter"),o=i.get("labelPrecision");(null==o||"auto"===o)&&(o=e.getPixelPrecision());var a=null==t&&isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel(Math.round(t)):t.toFixed(Math.min(o,20));return r.isFunction(n)?n(t,a):r.isString(n)?n.replace("{value}",a):a;},_showDataInfo:function _showDataInfo(t){t=this._dragging||t;var e=this._displayables.handleLabels;e[0].attr("invisible",!t),e[1].attr("invisible",!t);},_onDragMove:function _onDragMove(t,e,i){this._dragging=!0;var n=this._applyBarTransform([e,i],!0);this._updateInterval(t,n[0]),this._updateView(),this.dataZoomModel.get("realtime")&&this._dispatchZoomAction();},_onDragEnd:function _onDragEnd(){this._dragging=!1,this._showDataInfo(!1),this._dispatchZoomAction();},_dispatchZoomAction:function _dispatchZoomAction(){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:t[0],end:t[1]});},_applyBarTransform:function _applyBarTransform(t,e){var i=this._displayables.barGroup.getLocalTransform();return o.applyTransform(t,i,e);},_findCoordRect:function _findCoordRect(){var t,e=this.getTargetInfo();if(e.cartesians.length)t=e.cartesians[0].model.coordinateSystem.getRect();else{var i=this.api.getWidth(),n=this.api.getHeight();t={x:.2*i,y:.2*n,width:.6*i,height:.6*n};}return t;}});t.exports=S;},function(t,e){t.exports=function(t,e,i,n,r){function o(t,e,i){var n=e.length?e.slice():[e,e];return e[0]>e[1]&&n.reverse(),0>t&&n[0]+t<i[0]&&(t=i[0]-n[0]),t>0&&n[1]+t>i[1]&&(t=i[1]-n[1]),t;}return t?("rigid"===n?(t=o(t,e,i),e[0]+=t,e[1]+=t):(t=o(t,e[r],i),e[r]+=t,"push"===n&&e[0]>e[1]&&(e[1-r]=e[r])),e):e;};},function(t,e,i){t.exports=i(319).extend({type:"dataZoom.inside",defaultOption:{silent:!1,zoomLock:!1}});},function(t,e,i){function n(t){var e=[0,100];return!(t[0]<=e[1])&&(t[0]=e[1]),!(t[1]<=e[1])&&(t[1]=e[1]),!(t[0]>=e[0])&&(t[0]=e[0]),!(t[1]>=e[0])&&(t[1]=e[0]),t;}var r=i(322),o=i(4),a=i(325),s=i(328),l=o.bind,u=r.extend({type:"dataZoom.inside",init:function init(t,e){this._range;},render:function render(t,e,i,n){u.superApply(this,"render",arguments),s.shouldRecordRange(n,t.id)&&(this._range=t.getPercentRange());var r=this.getTargetInfo();o.each(["cartesians","polars"],function(e){var n=r[e],a=o.map(n,function(t){return s.generateCoordId(t.model);});o.each(n,function(n){var r=n.model,o=r.coordinateSystem;s.register(i,{coordId:s.generateCoordId(r),allCoordIds:a,coordinateSystem:o,containsPoint:l(h[e].containsPoint,this,o),dataZoomId:t.id,throttleRate:t.get("throttle",!0),panGetRange:l(this._onPan,this,n,e),zoomGetRange:l(this._onZoom,this,n,e)});},this);},this);},dispose:function dispose(){s.unregister(this.api,this.dataZoomModel.id),u.superApply(this,"dispose",arguments),this._range=null;},_onPan:function _onPan(t,e,i,n,r,o,s,l,u){if(this.dataZoomModel.option.silent)return this._range;var c=this._range.slice(),d=t.axisModels[0];if(d){var f=h[e].getDirectionInfo([o,s],[l,u],d,i,t),p=f.signal*(c[1]-c[0])*f.pixel/f.pixelLength;return a(p,c,[0,100],"rigid"),this._range=c;}},_onZoom:function _onZoom(t,e,i,r,o,a){var s=this.dataZoomModel.option;if(s.silent||s.zoomLock)return this._range;var l=this._range.slice(),u=t.axisModels[0];if(u){var c=h[e].getDirectionInfo(null,[o,a],u,i,t),d=(c.pixel-c.pixelStart)/c.pixelLength*(l[1]-l[0])+l[0];return r=Math.max(1/r,0),l[0]=(l[0]-d)*r+d,l[1]=(l[1]-d)*r+d,this._range=n(l);}}}),h={cartesians:{getDirectionInfo:function getDirectionInfo(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(a.pixel=e[0]-t[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a;},containsPoint:function containsPoint(t,e,i){return t.getRect().contain(e,i);}},polars:{getDirectionInfo:function getDirectionInfo(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===i.mainType?(a.pixel=e[0]-t[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=u[1]-u[0],a.pixelStart=u[0],a.signal=o.inverse?-1:1),a;},containsPoint:function containsPoint(t,e,i){var n=t.getRadiusAxis().getExtent()[1],r=t.cx,o=t.cy;return Math.pow(e-r,2)+Math.pow(i-o,2)<=Math.pow(n,2);}}};t.exports=u;},function(t,e,i){function n(t){var e=t.getZr();return e[p]||(e[p]={});}function r(t,e,i){var n=new c(t.getZr());return n.enable(),n.on("pan",f(a,i)),n.on("zoom",f(s,i)),n;}function o(t){h.each(t,function(e,i){e.count||(e.controller.dispose(),delete t[i]);});}function a(t,e,i,n,r,o,a){l(t,function(s){return s.panGetRange(t.controller,e,i,n,r,o,a);});}function s(t,e,i,n){l(t,function(r){return r.zoomGetRange(t.controller,e,i,n);});}function l(t,e){var i=[];h.each(t.dataZoomInfos,function(t){var n=e(t);n&&i.push({dataZoomId:t.dataZoomId,start:n[0],end:n[1]});}),t.dispatchAction(i);}function u(t,e){t.dispatchAction({type:"dataZoom",batch:e});}var h=i(4),c=i(175),d=i(309),f=h.curry,p="\x00_ec_dataZoom_roams",g={register:function register(t,e){var i=n(t),a=e.dataZoomId,s=e.coordId;h.each(i,function(t,i){var n=t.dataZoomInfos;n[a]&&h.indexOf(e.allCoordIds,s)<0&&(delete n[a],t.count--);}),o(i);var l=i[s];l||(l=i[s]={coordId:s,dataZoomInfos:{},count:0},l.controller=r(t,e,l),l.dispatchAction=h.curry(u,t)),l.controller.setContainsPoint(e.containsPoint),d.createOrUpdate(l,"dispatchAction",e.throttleRate,"fixRate"),!l.dataZoomInfos[a]&&l.count++,l.dataZoomInfos[a]=e;},unregister:function unregister(t,e){var i=n(t);h.each(i,function(t){t.controller.dispose();var i=t.dataZoomInfos;i[e]&&(delete i[e],t.count--);}),o(i);},shouldRecordRange:function shouldRecordRange(t,e){if(t&&"dataZoom"===t.type&&t.batch)for(var i=0,n=t.batch.length;n>i;i++){if(t.batch[i].dataZoomId===e)return!1;}return!0;},generateCoordId:function generateCoordId(t){return t.type+"\x00_"+t.id;}};t.exports=g;},function(t,e,i){function n(t,e,i){i.getAxisProxy(t.name,e).reset(i);}function r(t,e,i){i.getAxisProxy(t.name,e).filterData(i);}var o=i(1);o.registerProcessor(function(t,e){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(n),t.eachTargetAxis(r);}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy(),i=e.getDataPercentWindow(),n=e.getDataValueWindow();t.setRawRange({start:i[0],end:i[1],startValue:n[0],endValue:n[1]});});});},function(t,e,i){var n=i(4),r=i(320),o=i(1);o.registerAction("dataZoom",function(t,e){var i=r.createLinkedNodesFinder(n.bind(e.eachComponent,e,"dataZoom"),r.eachAxisDim,function(t,e){return t.get(e.axisIndex);}),o=[];e.eachComponent({mainType:"dataZoom",query:t},function(t,e){o.push.apply(o,i(t).nodes);}),n.each(o,function(e,i){e.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue});});});},function(t,e,i){i(332),i(343);},function(t,e,i){i(1).registerPreprocessor(i(333)),i(334),i(335),i(336),i(339),i(342);},function(t,e,i){function n(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e);}var r=i(4),o=r.each;t.exports=function(t){var e=t&&t.visualMap;r.isArray(e)||(e=e?[e]:[]),o(e,function(t){if(t){n(t,"splitList")&&!n(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var e=t.pieces;e&&r.isArray(e)&&o(e,function(t){r.isObject(t)&&(n(t,"start")&&!n(t,"min")&&(t.min=t.start),n(t,"end")&&!n(t,"max")&&(t.max=t.end));});}});};},function(t,e,i){i(19).registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?t.pieces.length>0:t.splitNumber>0)&&!t.calculable?"piecewise":"continuous";});},function(t,e,i){function n(t,e){t.eachTargetSeries(function(e){var i=e.getData();s.applyVisual(t.stateList,t.targetVisuals,i,t.getValueState,t,t.getDataDimension(i));});}function r(t){t.eachSeries(function(e){var i=e.getData(),n=[];t.eachComponent("visualMap",function(t){if(t.isTargetSeries(e)){var r={};n.push(r),r.stops=t.getStops(e,o),r.dimension=t.getDataDimension(i);}}),e.getData().setVisual("visualMeta",n);});}function o(t,e,i){function n(t){return s[t];}function r(t,e){s[t]=e;}for(var o=t.targetVisuals[i],a=l.prepareVisualTypes(o),s={},u=0,h=a.length;h>u;u++){var c=a[u],d=o["colorAlpha"===c?"__alphaForOpacity":c];d&&d.applyVisual(e,n,r);}return s.color;}var a=i(1),s=i(307),l=i(193);a.registerVisual(a.PRIORITY.VISUAL.COMPONENT,function(t){t.eachComponent("visualMap",function(e){n(e,t);}),r(t);});},function(t,e,i){function n(t,e,i){var n=t.targetVisuals[e].color;if(!n)return i.slice();var r=n.option.visual.length;if(1>=r||i[0]===i[1])return i.slice();for(var o=(i[1]-i[0])/(r-1),a=i[0],s=[],l=0;r>l&&a<i[1];l++){s.push(a),a+=o;}return s.push(i[1]),s;}function r(t,e,i,r){var o=n(t,e,i);a.each(o,function(t){for(var i={value:t,valueState:e},n=0,o=0;o<r.length;o++){if(n|="inRange"===r[o].valueState,t<r[o].value)return void r.splice(o,0,i);n&&(r[o].valueState="inRange");}r.push(i);});}var o=i(337),a=i(4),s=i(7),l=[20,140],u=o.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:!0},optionUpdated:function optionUpdated(t,e){u.superApply(this,"optionUpdated",arguments),this.resetTargetSeries(),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent();}),this._resetRange();},resetItemSize:function resetItemSize(){u.superApply(this,"resetItemSize",arguments);var t=this.itemSize;"horizontal"===this._orient&&t.reverse(),(null==t[0]||isNaN(t[0]))&&(t[0]=l[0]),(null==t[1]||isNaN(t[1]))&&(t[1]=l[1]);},_resetRange:function _resetRange(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):a.isArray(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]));},completeVisualOption:function completeVisualOption(){o.prototype.completeVisualOption.apply(this,arguments),a.each(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=0);},this);},setSelected:function setSelected(t){this.option.range=t.slice(),this._resetRange();},getSelected:function getSelected(){var t=this.getExtent(),e=s.asc((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e;},getValueState:function getValueState(t){var e=this.option.range,i=this.getExtent();return(e[0]<=i[0]||e[0]<=t)&&(e[1]>=i[1]||t<=e[1])?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(t){var e=[];return this.eachTargetSeries(function(i){var n=[],r=i.getData();r.each(this.getDataDimension(r),function(e,i){t[0]<=e&&e<=t[1]&&n.push(i);},!0,this),e.push({seriesId:i.id,dataIndex:n});},this),e;},getStops:function getStops(t,e){var i=[];return r(this,"outOfRange",this.getExtent(),i),r(this,"inRange",this.option.range.slice(),i),a.each(i,function(t){t.color=e(this,t.value,t.valueState);},this),i;}});t.exports=u;},function(t,e,i){var n=i(1),r=i(4),o=i(2),a=i(338),s=i(193),l=i(307),u=s.mapVisual,h=i(5),c=s.eachVisual,d=i(7),f=r.isArray,p=r.each,g=d.asc,m=d.linearMap,v=r.noop,y=["#f6efa6","#d88273","#bf444c"],x=n.extendComponentModel({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-(1/0),1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:null,min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function init(t,e,i){this._dataExtent,this.targetVisuals={},this.controllerVisuals={},this.textStyleModel,this.itemSize,this.mergeDefaultAndTheme(t,i);},optionUpdated:function optionUpdated(t,e){var i=this.option;o.canvasSupported||(i.realtime=!1),!e&&l.replaceVisualOption(i,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption();},resetVisual:function resetVisual(t){var e=this.stateList;t=r.bind(t,this),this.controllerVisuals=l.createVisualMappings(this.option.controller,e,t),this.targetVisuals=l.createVisualMappings(this.option.target,e,t);},resetTargetSeries:function resetTargetSeries(){var t=this.option,e=null==t.seriesIndex;t.seriesIndex=e?[]:h.normalizeToArray(t.seriesIndex),e&&this.ecModel.eachSeries(function(e,i){t.seriesIndex.push(i);});},eachTargetSeries:function eachTargetSeries(t,e){r.each(this.option.seriesIndex,function(i){t.call(e,this.ecModel.getSeriesByIndex(i));},this);},isTargetSeries:function isTargetSeries(t){var e=!1;return this.eachTargetSeries(function(i){i===t&&(e=!0);}),e;},formatValueText:function formatValueText(t,e,i){function n(t){return t===u[0]?"min":t===u[1]?"max":(+t).toFixed(l);}var o,a,s=this.option,l=s.precision,u=this.dataBound,h=s.formatter;return i=i||["<",">"],r.isArray(t)&&(t=t.slice(),o=!0),a=e?t:o?[n(t[0]),n(t[1])]:n(t),r.isString(h)?h.replace("{value}",o?a[0]:a).replace("{value2}",o?a[1]:a):r.isFunction(h)?o?h(t[0],t[1]):h(t):o?t[0]===u[0]?i[0]+" "+a[1]:t[1]===u[1]?i[1]+" "+a[0]:a[0]+" - "+a[1]:a;},resetExtent:function resetExtent(){var t=this.option,e=g([t.min,t.max]);this._dataExtent=e;},getDataDimension:function getDataDimension(t){var e=this.option.dimension;return null!=e?e:t.dimensions.length-1;},getExtent:function getExtent(){return this._dataExtent.slice();},completeVisualOption:function completeVisualOption(){function t(t){f(n.color)&&!t.inRange&&(t.inRange={color:n.color.slice().reverse()}),t.inRange=t.inRange||{color:y},p(this.stateList,function(e){var i=t[e];if(r.isString(i)){var n=a.get(i,"active",d);n?(t[e]={},t[e][i]=n):delete t[e];}},this);}function e(t,e,i){var n=t[e],r=t[i];n&&!r&&(r=t[i]={},p(n,function(t,e){if(s.isValidType(e)){var i=a.get(e,"inactive",d);null!=i&&(r[e]=i,"color"!==e||r.hasOwnProperty("opacity")||r.hasOwnProperty("colorAlpha")||(r.opacity=[0,0]));}}));}function i(t){var e=(t.inRange||{}).symbol||(t.outOfRange||{}).symbol,i=(t.inRange||{}).symbolSize||(t.outOfRange||{}).symbolSize,n=this.get("inactiveColor");p(this.stateList,function(o){var a=this.itemSize,s=t[o];s||(s=t[o]={color:d?n:[n]}),null==s.symbol&&(s.symbol=e&&r.clone(e)||(d?"roundRect":["roundRect"])),null==s.symbolSize&&(s.symbolSize=i&&r.clone(i)||(d?a[0]:[a[0],a[0]])),s.symbol=u(s.symbol,function(t){return"none"===t||"square"===t?"roundRect":t;});var l=s.symbolSize;if(null!=l){var h=-(1/0);c(l,function(t){t>h&&(h=t);}),s.symbolSize=u(l,function(t){return m(t,[0,h],[0,a[0]],!0);});}},this);}var n=this.option,o={inRange:n.inRange,outOfRange:n.outOfRange},l=n.target||(n.target={}),h=n.controller||(n.controller={});r.merge(l,o),r.merge(h,o);var d=this.isCategory();t.call(this,l),t.call(this,h),e.call(this,l,"inRange","outOfRange"),i.call(this,h);},resetItemSize:function resetItemSize(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))];},isCategory:function isCategory(){return!!this.option.categories;},setSelected:v,getValueState:v});t.exports=x;},function(t,e,i){var n=i(4),r={get:function get(t,e,i){var r=n.clone((o[t]||{})[e]);return i&&n.isArray(r)?r[r.length-1]:r;}},o={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}};t.exports=r;},function(t,e,i){function n(t,e,i,n){return new u.Polygon({shape:{points:t},draggable:!!i,cursor:e,drift:i,ondragend:n});}function r(t,e){return 0===t?[[0,0],[e,0],[e,-e]]:[[0,0],[e,0],[e,e]];}function o(t,e,i,n){return t?[[0,-y(e,x(i,0))],[b,0],[0,y(e,x(n-i,0))]]:[[0,0],[5,-5],[5,5]];}function a(t,e,i){var n=_/2,r=t.get("hoverLinkDataSize");return r&&(n=m(r,e,i,!0)/2),n;}function s(t){return!t.get("realtime")&&t.get("hoverLinkOnHandle");}var l=i(340),u=i(43),h=i(4),c=i(7),d=i(325),f=i(79),p=i(341),g=i(5),m=c.linearMap,v=h.each,y=Math.min,x=Math.max,_=12,b=6,w=l.extend({type:"visualMap.continuous",init:function init(){w.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._orient,this._useHandle,this._hoverLinkDataIndices=[],this._dragging,this._hovering;},doRender:function doRender(t,e,i,n){n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView();},_buildView:function _buildView(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var i=t.get("text");this._renderEndsText(e,i,0),this._renderEndsText(e,i,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e);},_renderEndsText:function _renderEndsText(t,e,i){if(e){var n=e[1-i];n=null!=n?n+"":"";var r=this.visualMapModel,o=r.get("textGap"),a=r.itemSize,s=this._shapes.barGroup,l=this._applyTransform([a[0]/2,0===i?-o:a[1]+o],s),h=this._applyTransform(0===i?"bottom":"top",s),c=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new u.Text({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===c?"middle":h,textAlign:"horizontal"===c?h:"center",text:n,textFont:d.getFont(),fill:d.getTextColor()}}));}},_renderBar:function _renderBar(t){var e=this.visualMapModel,i=this._shapes,r=e.itemSize,o=this._orient,a=this._useHandle,s=p.getItemAlign(e,this.api,r),l=i.barGroup=this._createBarGroup(s);l.add(i.outOfRange=n()),l.add(i.inRange=n(null,a?"move":null,h.bind(this._dragHandle,this,"all",!1),h.bind(this._dragHandle,this,"all",!0)));var u=e.textStyleModel.getTextRect(""),c=x(u.width,u.height);a&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(l,0,r,c,o,s),this._createHandle(l,1,r,c,o,s)),this._createIndicator(l,r,c,o),t.add(l);},_createHandle:function _createHandle(t,e,i,o,a){var s=h.bind(this._dragHandle,this,e,!1),l=h.bind(this._dragHandle,this,e,!0),c=n(r(e,o),"move",s,l);c.position[0]=i[0],t.add(c);var d=this.visualMapModel.textStyleModel,f=new u.Text({draggable:!0,drift:s,ondragend:l,style:{x:0,y:0,text:"",textFont:d.getFont(),fill:d.getTextColor()}});this.group.add(f);var p=["horizontal"===a?o/2:1.5*o,"horizontal"===a?0===e?-(1.5*o):1.5*o:0===e?-o/2:o/2],g=this._shapes;g.handleThumbs[e]=c,g.handleLabelPoints[e]=p,g.handleLabels[e]=f;},_createIndicator:function _createIndicator(t,e,i,r){var o=n([[0,0]],"move");o.position[0]=e[0],o.attr({invisible:!0,silent:!0}),t.add(o);var a=this.visualMapModel.textStyleModel,s=new u.Text({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:a.getFont(),fill:a.getTextColor()}});this.group.add(s);var l=["horizontal"===r?i/2:b+3,0],h=this._shapes;h.indicator=o,h.indicatorLabel=s,h.indicatorLabelPoint=l;},_dragHandle:function _dragHandle(t,e,i,n){if(this._useHandle){if(this._dragging=!e,!e){var r=this._applyTransform([i,n],this._shapes.barGroup,!0);this._updateInterval(t,r[1]),this._updateView();}e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?!this._hovering&&this._clearHoverLinkToSeries():s(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1);}},_resetInterval:function _resetInterval(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),i=t.getExtent(),n=[0,t.itemSize[1]];this._handleEnds=[m(e[0],i,n,!0),m(e[1],i,n,!0)];},_updateInterval:function _updateInterval(t,e){e=e||0;var i=this.visualMapModel,n=this._handleEnds;d(e,n,[0,i.itemSize[1]],"all"===t?"rigid":"push",t);var r=i.getExtent(),o=[0,i.itemSize[1]];this._dataInterval=[m(n[0],o,r,!0),m(n[1],o,r,!0)];},_updateView:function _updateView(t){var e=this.visualMapModel,i=e.getExtent(),n=this._shapes,r=[0,e.itemSize[1]],o=t?r:this._handleEnds,a=this._createBarVisual(this._dataInterval,i,o,"inRange"),s=this._createBarVisual(i,i,r,"outOfRange");n.inRange.setStyle({fill:a.barColor,opacity:a.opacity}).setShape("points",a.barPoints),n.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(o,a);},_createBarVisual:function _createBarVisual(t,e,i,n){var r={forceState:n,convertOpacityToAlpha:!0},o=this._makeColorGradient(t,r),a=[this.getControllerVisual(t[0],"symbolSize",r),this.getControllerVisual(t[1],"symbolSize",r)],s=this._createBarPoints(i,a);return{barColor:new f(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]};},_makeColorGradient:function _makeColorGradient(t,e){var i=100,n=[],r=(t[1]-t[0])/i;n.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var o=1;i>o;o++){var a=t[0]+r*o;if(a>t[1])break;n.push({color:this.getControllerVisual(a,"color",e),offset:o/i});}return n.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),n;},_createBarPoints:function _createBarPoints(t,e){var i=this.visualMapModel.itemSize;return[[i[0]-e[0],t[0]],[i[0],t[0]],[i[0],t[1]],[i[0]-e[1],t[1]]];},_createBarGroup:function _createBarGroup(t){var e=this._orient,i=this.visualMapModel.get("inverse");return new u.Group("horizontal"!==e||i?"horizontal"===e&&i?{scale:"bottom"===t?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==e||i?{scale:"left"===t?[1,1]:[-1,1]}:{scale:"left"===t?[1,-1]:[-1,-1]}:{scale:"bottom"===t?[1,1]:[-1,1],rotation:Math.PI/2});},_updateHandle:function _updateHandle(t,e){if(this._useHandle){var i=this._shapes,n=this.visualMapModel,r=i.handleThumbs,o=i.handleLabels;v([0,1],function(a){var s=r[a];s.setStyle("fill",e.handlesColor[a]),s.position[1]=t[a];var l=u.applyTransform(i.handleLabelPoints[a],u.getTransform(s,this.group));o[a].setStyle({x:l[0],y:l[1],text:n.formatValueText(this._dataInterval[a]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===a?"bottom":"top":"left",i.barGroup)});},this);}},_showIndicator:function _showIndicator(t,e,i,n){var r=this.visualMapModel,a=r.getExtent(),s=r.itemSize,l=[0,s[1]],h=m(t,a,l,!0),c=this._shapes,d=c.indicator;if(d){d.position[1]=h,d.attr("invisible",!1),d.setShape("points",o(!!i,n,h,s[1]));var f={convertOpacityToAlpha:!0},p=this.getControllerVisual(t,"color",f);d.setStyle("fill",p);var g=u.applyTransform(c.indicatorLabelPoint,u.getTransform(d,this.group)),v=c.indicatorLabel;v.attr("invisible",!1);var y=this._applyTransform("left",c.barGroup),x=this._orient;v.setStyle({text:(i?i:"")+r.formatValueText(e),textVerticalAlign:"horizontal"===x?y:"middle",textAlign:"horizontal"===x?"center":y,x:g[0],y:g[1]});}},_enableHoverLinkToSeries:function _enableHoverLinkToSeries(){var t=this;this._shapes.barGroup.on("mousemove",function(e){if(t._hovering=!0,!t._dragging){var i=t.visualMapModel.itemSize,n=t._applyTransform([e.offsetX,e.offsetY],t._shapes.barGroup,!0,!0);n[1]=y(x(0,n[1]),i[1]),t._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=i[0]);}}).on("mouseout",function(){t._hovering=!1,!t._dragging&&t._clearHoverLinkToSeries();});},_enableHoverLinkFromSeries:function _enableHoverLinkFromSeries(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries();},_doHoverLinkToSeries:function _doHoverLinkToSeries(t,e){var i=this.visualMapModel,n=i.itemSize;if(i.option.hoverLink){var r=[0,n[1]],o=i.getExtent();t=y(x(r[0],t),r[1]);var l=a(i,o,r),u=[t-l,t+l],h=m(t,r,o,!0),c=[m(u[0],r,o,!0),m(u[1],r,o,!0)];u[0]<r[0]&&(c[0]=-(1/0)),u[1]>r[1]&&(c[1]=1/0),e&&(c[0]===-(1/0)?this._showIndicator(h,c[1],"< ",l):c[1]===1/0?this._showIndicator(h,c[0],"> ",l):this._showIndicator(h,h," ",l));var d=this._hoverLinkDataIndices,f=[];(e||s(i))&&(f=this._hoverLinkDataIndices=i.findTargetDataIndices(c));var v=g.compressBatches(d,f);this._dispatchHighDown("downplay",p.convertDataIndex(v[0])),this._dispatchHighDown("highlight",p.convertDataIndex(v[1]));}},_hoverLinkFromSeriesMouseOver:function _hoverLinkFromSeriesMouseOver(t){var e=t.target;if(e&&null!=e.dataIndex){var i=e.dataModel||this.ecModel.getSeriesByIndex(e.seriesIndex),n=i.getData(e.dataType),r=n.getDimension(this.visualMapModel.getDataDimension(n)),o=n.get(r,e.dataIndex,!0);isNaN(o)||this._showIndicator(o,o);}},_hideIndicator:function _hideIndicator(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0);},_clearHoverLinkToSeries:function _clearHoverLinkToSeries(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",p.convertDataIndex(t)),t.length=0;},_clearHoverLinkFromSeries:function _clearHoverLinkFromSeries(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator);},_applyTransform:function _applyTransform(t,e,i,n){var r=u.getTransform(e,n?null:this.group);return u[h.isArray(t)?"applyTransform":"transformDirection"](t,r,i);},_dispatchHighDown:function _dispatchHighDown(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e});},dispose:function dispose(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();},remove:function remove(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();}});t.exports=w;},function(t,e,i){var n=i(4),r=i(43),o=i(6),a=i(21),s=i(1),l=i(193);t.exports=s.extendComponentView({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function init(t,e){this.ecModel=t,this.api=e,this.visualMapModel;},render:function render(t,e,i,n){return this.visualMapModel=t,t.get("show")===!1?void this.group.removeAll():void this.doRender.apply(this,arguments);},renderBackground:function renderBackground(t){var e=this.visualMapModel,i=o.normalizeCssArray(e.get("padding")||0),n=t.getBoundingRect();t.add(new r.Rect({z2:-1,silent:!0,shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[3]+i[1],height:n.height+i[0]+i[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}));},getControllerVisual:function getControllerVisual(t,e,i){function r(t){return u[t];}function o(t,e){u[t]=e;}i=i||{};var a=i.forceState,s=this.visualMapModel,u={};if("symbol"===e&&(u.symbol=s.get("itemSymbol")),"color"===e){var h=s.get("contentColor");u.color=h;}var c=s.controllerVisuals[a||s.getValueState(t)],d=l.prepareVisualTypes(c);return n.each(d,function(n){var a=c[n];i.convertOpacityToAlpha&&"opacity"===n&&(n="colorAlpha",a=c.__alphaForOpacity),l.dependsOn(n,e)&&a&&a.applyVisual(t,r,o);}),u[e];},positionGroup:function positionGroup(t){var e=this.visualMapModel,i=this.api;a.positionGroup(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()});},doRender:n.noop});},function(t,e,i){var n=i(4),r=i(21),o={getItemAlign:function getItemAlign(t,e,i){var n=t.option,o=n.align;if(null!=o&&"auto"!==o)return o;for(var a={width:e.getWidth(),height:e.getHeight()},s="horizontal"===n.orient?1:0,l=[["left","right","width"],["top","bottom","height"]],u=l[s],h=[0,null,10],c={},d=0;3>d;d++){c[l[1-s][d]]=h[d],c[u[d]]=2===d?i[0]:n[u[d]];}var f=[["x","width",3],["y","height",0]][s],p=r.getLayoutRect(c,a,n.padding);return u[(p.margin[f[2]]||0)+p[f[0]]+.5*p[f[1]]<.5*a[f[1]]?0:1];},convertDataIndex:function convertDataIndex(t){return n.each(t||[],function(e){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null);}),t;}};t.exports=o;},function(t,e,i){var n=i(1),r={type:"selectDataRange",event:"dataRangeSelected",update:"update"};n.registerAction(r,function(t,e){e.eachComponent({mainType:"visualMap",query:t},function(e){e.setSelected(t.selected);});});},function(t,e,i){i(1).registerPreprocessor(i(333)),i(334),i(335),i(344),i(345),i(342);},function(t,e,i){function n(t,e){var i=t.inverse;("vertical"===t.orient?!i:i)&&e.reverse();}function r(t){function e(t,i,n){return n=n||0,t.interval[n]<i.interval[n]||t.interval[n]===i.interval[n]&&(+t.close[n]>i.close[n]||e(t,i,1));}t.sort(function(t,i){return e(t,i)?-1:1;});for(var i=-(1/0),n=0;n<t.length;n++){for(var r=t[n].interval,o=t[n].close,a=0;2>a;a++){r[a]<i&&(r[a]=i,o[a]=1-a),i=r[a];}}}var o=i(337),a=i(4),s=i(193),l=o.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0},optionUpdated:function optionUpdated(t,e){l.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetTargetSeries(),this.resetExtent();var i=this._mode=this._determineMode();u[this._mode].call(this),this._resetSelected(t,e);var n=this.option.categories;this.resetVisual(function(t,e){"categories"===i?(t.mappingMethod="category",t.categories=a.clone(n)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=a.map(this._pieceList,function(t){var t=a.clone(t);return"inRange"!==e&&(t.visual=null),t;}));});},_resetSelected:function _resetSelected(t,e){var i=this.option,n=this._pieceList,r=(e?i:t).selected||{};if(i.selected=r,a.each(n,function(t,e){var i=this.getSelectedMapKey(t);r.hasOwnProperty(i)||(r[i]=!0);},this),"single"===i.selectedMode){var o=!1;a.each(n,function(t,e){var i=this.getSelectedMapKey(t);r[i]&&(o?r[i]=!1:o=!0);},this);}},getSelectedMapKey:function getSelectedMapKey(t){return"categories"===this._mode?t.value+"":t.index+"";},getPieceList:function getPieceList(){return this._pieceList;},_determineMode:function _determineMode(){var t=this.option;return t.pieces&&t.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber";},setSelected:function setSelected(t){this.option.selected=a.clone(t);},getValueState:function getValueState(t){var e=s.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(t){var e=[];return this.eachTargetSeries(function(i){var n=[],r=i.getData();r.each(this.getDataDimension(r),function(e,i){var r=s.findPieceIndex(e,this._pieceList);r===t&&n.push(i);},!0,this),e.push({seriesId:i.id,dataIndex:n});},this),e;},getRepresentValue:function getRepresentValue(t){var e;if(this.isCategory())e=t.value;else if(null!=t.value)e=t.value;else{var i=t.interval||[];e=(i[0]+i[1])/2;}return e;},getStops:function getStops(t,e){function i(t){n.push(t),t.color=e(r,r.getRepresentValue(t),t.valueState);}var n=[],r=this,o=-(1/0);return a.each(this._pieceList,function(t){var e=t.interval;e&&(e[0]>o&&i({interval:[o,e[0]],valueState:"outOfRange"}),i({interval:e.slice(),valueState:this.getValueState((e[0]+e[1])/2)}),o=e[1]);},this),n;}}),u={splitNumber:function splitNumber(){var t=this.option,e=this._pieceList,i=t.precision,n=this.getExtent(),o=t.splitNumber;o=Math.max(parseInt(o,10),1),t.splitNumber=o;for(var s=(n[1]-n[0])/o;+s.toFixed(i)!==s&&5>i;){i++;}t.precision=i,s=+s.toFixed(i);var l=0;t.minOpen&&e.push({index:l++,interval:[-(1/0),n[0]],close:[0,0]});for(var u=n[0],h=l+o;h>l;u+=s){var c=l===o-1?n[1]:u+s;e.push({index:l++,interval:[u,c],close:[1,1]});}t.maxOpen&&e.push({index:l++,interval:[n[1],1/0],close:[0,0]}),r(e),a.each(e,function(t){t.text=this.formatValueText(t.interval);},this);},categories:function categories(){var t=this.option;a.each(t.categories,function(t){this._pieceList.push({text:this.formatValueText(t,!0),value:t});},this),n(t,this._pieceList);},pieces:function pieces(){var t=this.option,e=this._pieceList;a.each(t.pieces,function(t,i){a.isObject(t)||(t={value:t});var n={text:"",index:i};if(null!=t.label&&(n.text=t.label),t.hasOwnProperty("value")){var r=n.value=t.value;n.interval=[r,r],n.close=[1,1];}else{for(var o=n.interval=[],l=n.close=[0,0],u=[1,0,1],h=[-(1/0),1/0],c=[],d=0;2>d;d++){for(var f=[["gte","gt","min"],["lte","lt","max"]][d],p=0;3>p&&null==o[d];p++){o[d]=t[f[p]],l[d]=u[p],c[d]=2===p;}null==o[d]&&(o[d]=h[d]);}c[0]&&o[1]===1/0&&(l[0]=0),c[1]&&o[0]===-(1/0)&&(l[1]=0),o[0]>o[1]&&console.warn("Piece "+i+"is illegal: "+o+" lower bound should not greater then uppper bound."),o[0]===o[1]&&l[0]&&l[1]&&(n.value=o[0]);}n.visual=s.retrieveVisuals(t),e.push(n);},this),n(t,e),r(e),a.each(e,function(t){var e=t.close,i=[["<",""][e[1]],[">",""][e[0]]];t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,i);},this);}};t.exports=l;},function(t,e,i){var n=i(340),r=i(4),o=i(43),a=i(106),s=i(21),l=i(341),u=n.extend({type:"visualMap.piecewise",doRender:function doRender(){function t(t){var a=t.piece,s=new o.Group();s.onclick=r.bind(this._onItemClick,this,a),this._enableHoverLink(s,t.indexInModelPieceList);var d=i.getRepresentValue(a);if(this._createItemSymbol(s,d,[0,0,c[0],c[1]]),f){var p=this.visualMapModel.getValueState(d);s.add(new o.Text({style:{x:"right"===h?-n:c[0]+n,y:c[1]/2,text:a.text,textVerticalAlign:"middle",textAlign:h,textFont:l,fill:u,opacity:"outOfRange"===p?.5:1}}));}e.add(s);}var e=this.group;e.removeAll();var i=this.visualMapModel,n=i.get("textGap"),a=i.textStyleModel,l=a.getFont(),u=a.getTextColor(),h=this._getItemAlign(),c=i.itemSize,d=this._getViewData(),f=!d.endsText,p=!f;p&&this._renderEndsText(e,d.endsText[0],c),r.each(d.viewPieceList,t,this),p&&this._renderEndsText(e,d.endsText[1],c),s.box(i.get("orient"),e,i.get("itemGap")),this.renderBackground(e),this.positionGroup(e);},_enableHoverLink:function _enableHoverLink(t,e){function i(t){var i=this.visualMapModel;i.option.hoverLink&&this.api.dispatchAction({type:t,batch:l.convertDataIndex(i.findTargetDataIndices(e))});}t.on("mouseover",r.bind(i,this,"highlight")).on("mouseout",r.bind(i,this,"downplay"));},_getItemAlign:function _getItemAlign(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return l.getItemAlign(t,this.api,t.itemSize);var i=e.align;return i&&"auto"!==i||(i="left"),i;},_renderEndsText:function _renderEndsText(t,e,i){if(e){var n=new o.Group(),r=this.visualMapModel.textStyleModel;n.add(new o.Text({style:{x:i[0]/2,y:i[1]/2,textVerticalAlign:"middle",textAlign:"center",text:e,textFont:r.getFont(),fill:r.getTextColor()}})),t.add(n);}},_getViewData:function _getViewData(){var t=this.visualMapModel,e=r.map(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e};}),i=t.get("text"),n=t.get("orient"),o=t.get("inverse");return("horizontal"===n?o:!o)?e.reverse():i&&(i=i.slice().reverse()),{viewPieceList:e,endsText:i};},_createItemSymbol:function _createItemSymbol(t,e,i){t.add(a.createSymbol(this.getControllerVisual(e,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(e,"color")));},_onItemClick:function _onItemClick(t){var e=this.visualMapModel,i=e.option,n=r.clone(i.selected),o=e.getSelectedMapKey(t);"single"===i.selectedMode?(n[o]=!0,r.each(n,function(t,e){n[e]=e===o;})):n[o]=!n[o],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:n});}});t.exports=u;},function(t,e,i){i(347),i(349),i(1).registerPreprocessor(function(t){t.markPoint=t.markPoint||{};});},function(t,e,i){t.exports=i(348).extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"inside"},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:2}}}});},function(t,e,i){function n(t){r.defaultEmphasis(t.label,r.LABEL_OPTIONS);}var r=i(5),o=i(4),a=i(2),s=i(6),l=s.addCommas,u=s.encodeHTML,h=i(1).extendComponentModel({type:"marker",dependencies:["series","grid","polar","geo"],init:function init(t,e,i,n){if("marker"===this.type)throw new Error("Marker component is abstract component. Use markLine, markPoint, markArea instead.");this.mergeDefaultAndTheme(t,i),this.mergeOption(t,i,n.createdBySelf,!0);},ifEnableAnimation:function ifEnableAnimation(){if(a.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.ifEnableAnimation();},mergeOption:function mergeOption(t,e,i,r){var a=this.constructor,s=this.mainType+"Model";i||e.eachSeries(function(t){var i=t.get(this.mainType),l=t[s];return i&&i.data?(l?l.mergeOption(i,e,!0):(r&&n(i),o.each(i.data,function(t){t instanceof Array?(n(t[0]),n(t[1])):n(t);}),l=new a(i,this,e),o.extend(l,{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),l.__hostSeries=t),void(t[s]=l)):void(t[s]=null);},this);},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=o.isArray(i)?o.map(i,l).join(", "):l(i),r=e.getName(t),a=this.name;return(null!=i||r)&&(a+="<br />"),r&&(a+=u(r),null!=i&&(a+=" : ")),null!=i&&(a+=n),a;},getData:function getData(){return this._data;},setData:function setData(t){this._data=t;}});o.mixin(h,r.dataFormatMixin),t.exports=h;},function(t,e,i){function n(t,e,i){var n=e.coordinateSystem;t.each(function(r){var o,a=t.getItemModel(r),l=s.parsePercent(a.get("x"),i.getWidth()),u=s.parsePercent(a.get("y"),i.getHeight());if(isNaN(l)||isNaN(u)){if(e.getMarkerPosition)o=e.getMarkerPosition(t.getValues(t.dimensions,r));else if(n){var h=t.get(n.dimensions[0],r),c=t.get(n.dimensions[1],r);o=n.dataToPoint([h,c]);}}else o=[l,u];isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u),t.setItemLayout(r,o);});}function r(t,e,i){var n;n=t?a.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}):[{name:"value",type:"float"}];var r=new l(n,i),o=a.map(i.get("data"),a.curry(u.dataTransform,e));return t&&(o=a.filter(o,a.curry(u.dataFilter,t))),r.initData(o,null,t?u.dimValueGetter:function(t){return t.value;}),r;}var o=i(104),a=i(4),s=i(7),l=i(97),u=i(350);i(351).extend({type:"markPoint",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markPointModel;e&&(n(e.getData(),t,i),this.markerGroupMap[t.name].updateLayout(e));},this);},renderSeries:function renderSeries(t,e,i,a){var s=t.coordinateSystem,l=t.name,u=t.getData(),h=this.markerGroupMap,c=h[l];c||(c=h[l]=new o());var d=r(s,t,e);e.setData(d),n(e.getData(),t,a),d.each(function(t){var i=d.getItemModel(t),n=i.getShallow("symbolSize");"function"==typeof n&&(n=n(e.getRawValue(t),e.getDataParams(t))),d.setItemVisual(t,{symbolSize:n,color:i.get("itemStyle.normal.color")||u.getVisual("color"),symbol:i.getShallow("symbol")});}),c.updateData(d),this.group.add(c.group),d.eachItemGraphicEl(function(t){t.traverse(function(t){t.dataModel=e;});}),c.__keep=!0,c.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){function n(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)));}function r(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y));}function o(t,e,i){var n=-1;do{n=Math.max(l.getPrecision(t.get(e,i)),n),t=t.stackedOn;}while(t);return n;}function a(t,e,i,n,r,a){var s=[],l=m(e,n,t),u=e.indexOfNearest(n,l,!0);s[r]=e.get(i,u,!0),s[a]=e.get(n,u,!0);var h=o(e,n,u);return h>=0&&(s[a]=+s[a].toFixed(h)),s;}var s=i(4),l=i(7),u=s.indexOf,h=s.curry,c={min:h(a,"min"),max:h(a,"max"),average:h(a,"average")},d=function d(t,e){var i=t.getData(),n=t.coordinateSystem;if(e&&!r(e)&&!s.isArray(e.coord)&&n){var o=n.dimensions,a=f(e,i,n,t);if(e=s.clone(e),e.type&&c[e.type]&&a.baseAxis&&a.valueAxis){var l=u(o,a.baseAxis.dim),h=u(o,a.valueAxis.dim);e.coord=c[e.type](i,a.baseDataDim,a.valueDataDim,l,h),e.value=e.coord[h];}else{for(var d=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],p=0;2>p;p++){if(c[d[p]]){var g=t.coordDimToDataDim(o[p])[0];d[p]=m(i,g,d[p]);}}e.coord=d;}}return e;},f=function f(t,e,i,n){var r={};return null!=t.valueIndex||null!=t.valueDim?(r.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,r.valueAxis=i.getAxis(n.dataDimToCoordDim(r.valueDataDim)),r.baseAxis=i.getOtherAxis(r.valueAxis),r.baseDataDim=n.coordDimToDataDim(r.baseAxis.dim)[0]):(r.baseAxis=n.getBaseAxis(),r.valueAxis=i.getOtherAxis(r.baseAxis),r.baseDataDim=n.coordDimToDataDim(r.baseAxis.dim)[0],r.valueDataDim=n.coordDimToDataDim(r.valueAxis.dim)[0]),r;},p=function p(t,e){return t&&t.containData&&e.coord&&!n(e)?t.containData(e.coord):!0;},g=function g(t,e,i,n){return 2>n?t.coord&&t.coord[n]:t.value;},m=function m(t,e,i){if("average"===i){var n=0,r=0;return t.each(e,function(t,e){isNaN(t)||(n+=t,r++);},!0),n/r;}return t.getDataExtent(e,!0)["max"===i?1:0];};t.exports={dataTransform:d,dataFilter:p,dimValueGetter:g,getAxisInfo:f,numCalculate:m};},function(t,e,i){t.exports=i(1).extendComponentView({type:"marker",init:function init(){this.markerGroupMap={};},render:function render(t,e,i){var n=this.markerGroupMap;for(var r in n){n.hasOwnProperty(r)&&(n[r].__keep=!1);}var o=this.type+"Model";e.eachSeries(function(t){var n=t[o];n&&this.renderSeries(t,n,e,i);},this);for(var r in n){n.hasOwnProperty(r)&&!n[r].__keep&&this.group.remove(n[r].group);}},renderSeries:function renderSeries(){}});},function(t,e,i){i(353),i(354),i(1).registerPreprocessor(function(t){t.markLine=t.markLine||{};});},function(t,e,i){t.exports=i(348).extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"end"},emphasis:{show:!0}},lineStyle:{normal:{type:"dashed"},emphasis:{width:3}},animationEasing:"linear"}});},function(t,e,i){function n(t){return!isNaN(t)&&!isFinite(t);}function r(t,e,i,r){var o=1-t,a=r.dimensions[t];return n(e[o])&&n(i[o])&&e[t]===i[t]&&r.getAxis(a).containData(e[t]);}function o(t,e){if("cartesian2d"===t.type){var i=e[0].coord,n=e[1].coord;if(i&&n&&(r(1,i,n,t)||r(0,i,n,t)))return!0;}return c.dataFilter(t,e[0])&&c.dataFilter(t,e[1]);}function a(t,e,i,r,o){var a,s=r.coordinateSystem,l=t.getItemModel(e),u=h.parsePercent(l.get("x"),o.getWidth()),c=h.parsePercent(l.get("y"),o.getHeight());if(isNaN(u)||isNaN(c)){if(r.getMarkerPosition)a=r.getMarkerPosition(t.getValues(t.dimensions,e));else{var d=s.dimensions,f=t.get(d[0],e),p=t.get(d[1],e);a=s.dataToPoint([f,p]);}if("cartesian2d"===s.type){var g=s.getAxis("x"),m=s.getAxis("y"),d=s.dimensions;n(t.get(d[0],e))?a[0]=g.toGlobalCoord(g.getExtent()[i?0:1]):n(t.get(d[1],e))&&(a[1]=m.toGlobalCoord(m.getExtent()[i?0:1]));}isNaN(u)||(a[0]=u),isNaN(c)||(a[1]=c);}else a=[u,c];t.setItemLayout(e,a);}function s(t,e,i){var n;n=t?l.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}):[{name:"value",type:"float"}];var r=new u(n,i),a=new u(n,i),s=new u([],i),h=l.map(i.get("data"),l.curry(f,e,t,i));t&&(h=l.filter(h,l.curry(o,t)));var d=t?c.dimValueGetter:function(t){return t.value;};return r.initData(l.map(h,function(t){return t[0];}),null,d),a.initData(l.map(h,function(t){return t[1];}),null,d),s.initData(l.map(h,function(t){return t[2];})),s.hasItemOption=!0,{from:r,to:a,line:s};}var l=i(4),u=i(97),h=i(7),c=i(350),d=i(200),f=function f(t,e,i,n){var r=t.getData(),o=n.type;if(!l.isArray(n)&&("min"===o||"max"===o||"average"===o||null!=n.xAxis||null!=n.yAxis)){var a,s,u;if(null!=n.yAxis||null!=n.xAxis)s=null!=n.yAxis?"y":"x",a=e.getAxis(s),u=l.retrieve(n.yAxis,n.xAxis);else{var h=c.getAxisInfo(n,r,e,t);s=h.valueDataDim,a=h.valueAxis,u=c.numCalculate(r,s,o);}var d="x"===s?0:1,f=1-d,p=l.clone(n),g={};p.type=null,p.coord=[],g.coord=[],p.coord[f]=-(1/0),g.coord[f]=1/0;var m=i.get("precision");m>=0&&"number"==typeof u&&(u=+u.toFixed(m)),p.coord[d]=g.coord[d]=u,n=[p,g,{type:o,valueIndex:n.valueIndex,value:u}];}return n=[c.dataTransform(t,n[0]),c.dataTransform(t,n[1]),l.extend({},n[2])],n[2].type=n[2].type||"",l.merge(n[2],n[0]),l.merge(n[2],n[1]),n;};i(351).extend({type:"markLine",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markLineModel;if(e){var n=e.getData(),r=e.__from,o=e.__to;r.each(function(e){a(r,e,!0,t,i),a(o,e,!1,t,i);}),n.each(function(t){n.setItemLayout(t,[r.getItemLayout(t),o.getItemLayout(t)]);}),this.markerGroupMap[t.name].updateLayout();}},this);},renderSeries:function renderSeries(t,e,i,n){function r(e,i,r){var o=e.getItemModel(i);a(e,i,r,t,n),e.setItemVisual(i,{symbolSize:o.get("symbolSize")||x[r?0:1],symbol:o.get("symbol",!0)||y[r?0:1],color:o.get("itemStyle.normal.color")||h.getVisual("color")});}var o=t.coordinateSystem,u=t.name,h=t.getData(),c=this.markerGroupMap,f=c[u];f||(f=c[u]=new d()),this.group.add(f.group);var p=s(o,t,e),g=p.from,m=p.to,v=p.line;e.__from=g,e.__to=m,e.setData(v);var y=e.get("symbol"),x=e.get("symbolSize");l.isArray(y)||(y=[y,y]),"number"==typeof x&&(x=[x,x]),p.from.each(function(t){r(g,t,!0),r(m,t,!1);}),v.each(function(t){var e=v.getItemModel(t).get("lineStyle.normal.color");v.setItemVisual(t,{color:e||g.getItemVisual(t,"color")}),v.setItemLayout(t,[g.getItemLayout(t),m.getItemLayout(t)]),v.setItemVisual(t,{fromSymbolSize:g.getItemVisual(t,"symbolSize"),fromSymbol:g.getItemVisual(t,"symbol"),toSymbolSize:m.getItemVisual(t,"symbolSize"),toSymbol:m.getItemVisual(t,"symbol")});}),f.updateData(v),p.line.eachItemGraphicEl(function(t,i){t.traverse(function(t){t.dataModel=e;});}),f.__keep=!0,f.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){i(356),i(357),i(1).registerPreprocessor(function(t){t.markArea=t.markArea||{};});},function(t,e,i){t.exports=i(348).extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{normal:{show:!0,position:"top"},emphasis:{show:!0,position:"top"}},itemStyle:{normal:{borderWidth:0}}}});},function(t,e,i){function n(t){return!isNaN(t)&&!isFinite(t);}function r(t,e,i,r){var o=1-t;return n(e[o])&&n(i[o]);}function o(t,e){var i=e.coord[0],n=e.coord[1];return"cartesian2d"===t.type&&i&&n&&(r(1,i,n,t)||r(0,i,n,t))?!0:f.dataFilter(t,{coord:i,x:e.x0,y:e.y0})||f.dataFilter(t,{coord:n,x:e.x1,y:e.y1});}function a(t,e,i,r,o){var a,s=r.coordinateSystem,l=t.getItemModel(e),u=h.parsePercent(l.get(i[0]),o.getWidth()),c=h.parsePercent(l.get(i[1]),o.getHeight());if(isNaN(u)||isNaN(c)){if(r.getMarkerPosition)a=r.getMarkerPosition(t.getValues(i,e));else{var d=t.get(i[0],e),f=t.get(i[1],e);a=s.dataToPoint([d,f],!0);}if("cartesian2d"===s.type){var p=s.getAxis("x"),g=s.getAxis("y"),d=t.get(i[0],e),f=t.get(i[1],e);n(d)?a[0]=p.toGlobalCoord(p.getExtent()["x0"===i[0]?0:1]):n(f)&&(a[1]=g.toGlobalCoord(g.getExtent()["y0"===i[1]?0:1]));}isNaN(u)||(a[0]=u),isNaN(c)||(a[1]=c);}else a=[u,c];return a;}function s(t,e,i){var n,r,a=["x0","y0","x1","y1"];t?(n=l.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}),r=new u(l.map(a,function(t,e){return{name:t,type:n[e%2].type};}),i)):(n=[{name:"value",type:"float"}],r=new u(n,i));var s=l.map(i.get("data"),l.curry(p,e,t,i));t&&(s=l.filter(s,l.curry(o,t)));var h=t?function(t,e,i,n){return t.coord[Math.floor(n/2)][n%2];}:function(t){return t.value;};return r.initData(s,null,h),r.hasItemOption=!0,r;}var l=i(4),u=i(97),h=i(7),c=i(43),d=i(39),f=i(350),p=function p(t,e,i,n){var r=f.dataTransform(t,n[0]),o=f.dataTransform(t,n[1]),a=l.retrieve,s=r.coord,u=o.coord;s[0]=a(s[0],-(1/0)),s[1]=a(s[1],-(1/0)),u[0]=a(u[0],1/0),u[1]=a(u[1],1/0);var h=l.mergeAll([{},r,o]);return h.coord=[r.coord,o.coord],h.x0=r.x,h.y0=r.y,h.x1=o.x,h.y1=o.y,h;},g=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];i(351).extend({type:"markArea",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markAreaModel;if(e){var n=e.getData();n.each(function(e){var r=l.map(g,function(r){return a(n,e,r,t,i);});n.setItemLayout(e,r);var o=n.getItemGraphicEl(e);o.setShape("points",r);});}},this);},renderSeries:function renderSeries(t,e,i,n){var r=t.coordinateSystem,o=t.name,u=t.getData(),h=this.markerGroupMap,f=h[o];f||(f=h[o]={group:new c.Group()}),this.group.add(f.group),f.__keep=!0;var p=s(r,t,e);e.setData(p),p.each(function(e){p.setItemLayout(e,l.map(g,function(i){return a(p,e,i,t,n);})),p.setItemVisual(e,{color:u.getVisual("color")});}),p.diff(f.__data).add(function(t){var e=new c.Polygon({shape:{points:p.getItemLayout(t)}});p.setItemGraphicEl(t,e),f.group.add(e);}).update(function(t,i){var n=f.__data.getItemGraphicEl(i);c.updateProps(n,{shape:{points:p.getItemLayout(t)}},e,t),f.group.add(n),p.setItemGraphicEl(t,n);}).remove(function(t){var e=f.__data.getItemGraphicEl(t);f.group.remove(e);}).execute(),p.eachItemGraphicEl(function(t,i){var n=p.getItemModel(i),r=n.getModel("label.normal"),o=n.getModel("label.emphasis"),a=p.getItemVisual(i,"color");t.useStyle(l.defaults(n.getModel("itemStyle.normal").getItemStyle(),{fill:d.modifyAlpha(a,.4),stroke:a})),t.hoverStyle=n.getModel("itemStyle.normal").getItemStyle();var s=p.getName(i)||"",u=a||t.style.fill;c.setText(t.style,r,u),t.style.text=l.retrieve(e.getFormattedLabel(i,"normal"),s),c.setText(t.hoverStyle,o,u),t.hoverStyle.text=l.retrieve(e.getFormattedLabel(i,"emphasis"),s),c.setHoverStyle(t,{}),t.dataModel=e;}),f.__data=p,f.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){var n=i(1);n.registerPreprocessor(i(359)),i(360),i(361),i(362),i(364);},function(t,e,i){function n(t){var e=t.type,i={number:"value",time:"time"};if(i[e]&&(t.axisType=i[e],delete t.type),r(t),o(t,"controlPosition")){var n=t.controlStyle||(t.controlStyle={});o(n,"position")||(n.position=t.controlPosition),"none"!==n.position||o(n,"show")||(n.show=!1,delete n.position),delete t.controlPosition;}a.each(t.data||[],function(t){a.isObject(t)&&!a.isArray(t)&&(!o(t,"value")&&o(t,"name")&&(t.value=t.name),r(t));});}function r(t){var e=t.itemStyle||(t.itemStyle={}),i=e.emphasis||(e.emphasis={}),n=t.label||t.label||{},r=n.normal||(n.normal={}),s={normal:1,emphasis:1};a.each(n,function(t,e){s[e]||o(r,e)||(r[e]=t);}),i.label&&!o(n,"emphasis")&&(n.emphasis=i.label,delete i.label);}function o(t,e){return t.hasOwnProperty(e);}var a=i(4);t.exports=function(t){var e=t&&t.timeline;a.isArray(e)||(e=e?[e]:[]),a.each(e,function(t){t&&n(t);});};},function(t,e,i){i(19).registerSubTypeDefaulter("timeline",function(){return"slider";});},function(t,e,i){var n=i(1),r=i(4);n.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e){var i=e.getComponent("timeline");return i&&null!=t.currentIndex&&(i.setCurrentIndex(t.currentIndex),!i.get("loop",!0)&&i.isIndexMax()&&i.setPlayState(!1)),e.resetOption("timeline"),r.defaults({currentIndex:i.option.currentIndex},t);}),n.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var i=e.getComponent("timeline");i&&null!=t.playState&&i.setPlayState(t.playState);});},function(t,e,i){var n=i(363),r=i(4),o=i(5),a=n.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",normal:{show:!0,interval:"auto",rotate:0,textStyle:{color:"#304654"}},emphasis:{show:!0,textStyle:{color:"#c23531"}}},itemStyle:{normal:{color:"#304654",borderWidth:1},emphasis:{color:"#c23531"}},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",normal:{color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}});r.mixin(a,o.dataFormatMixin),t.exports=a;},function(t,e,i){var n=i(19),r=i(97),o=i(4),a=i(5),s=n.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{normal:{},emphasis:{}},label:{normal:{textStyle:{color:"#000"}},emphasis:{}},data:[]},init:function init(t,e,i){this._data,this._names,this.mergeDefaultAndTheme(t,i),this._initData();},mergeOption:function mergeOption(t){s.superApply(this,"mergeOption",arguments),this._initData();},setCurrentIndex:function setCurrentIndex(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(t>=e&&(t=e-1),0>t&&(t=0)),this.option.currentIndex=t;},getCurrentIndex:function getCurrentIndex(){return this.option.currentIndex;},isIndexMax:function isIndexMax(){return this.getCurrentIndex()>=this._data.count()-1;},setPlayState:function setPlayState(t){this.option.autoPlay=!!t;},getPlayState:function getPlayState(){return!!this.option.autoPlay;},_initData:function _initData(){var t=this.option,e=t.data||[],i=t.axisType,n=this._names=[];if("category"===i){var s=[];o.each(e,function(t,e){var i,r=a.getDataItemValue(t);o.isObject(t)?(i=o.clone(t),i.value=e):i=e,s.push(i),o.isString(r)||null!=r&&!isNaN(r)||(r=""),n.push(r+"");}),e=s;}var l={category:"ordinal",time:"time"}[i]||"number",u=this._data=new r([{name:"value",type:l}],this);u.initData(e,n);},getData:function getData(){return this._data;},getCategories:function getCategories(){return"category"===this.get("axisType")?this._names.slice():void 0;}});t.exports=s;},function(t,e,i){function n(t,e){return u.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"));}function r(t,e,i,n){var r=l.makePath(t.get(e).replace(/^path:\/\//,""),s.clone(n||{}),new p(i[0],i[1],i[2],i[3]),"center");return r;}function o(t,e,i,n,r,o){var a=e.get("color");if(r)r.setColor(a),i.add(r),o&&o.onUpdate(r);else{var l=t.get("symbol");r=d.createSymbol(l,-1,-1,2,2,a),r.setStyle("strokeNoScale",!0),i.add(r),o&&o.onCreate(r);}var u=e.getItemStyle(["color","symbol","symbolSize"]);r.setStyle(u),n=s.merge({rectHover:!0,z2:100},n,!0);var h=t.get("symbolSize");h=h instanceof Array?h.slice():[+h,+h],h[0]/=2,h[1]/=2,n.scale=h;var c=t.get("symbolOffset");if(c){var f=n.position=n.position||[0,0];f[0]+=m.parsePercent(c[0],h[0]),f[1]+=m.parsePercent(c[1],h[1]);}var p=t.get("symbolRotate");return n.rotation=(p||0)*Math.PI/180||0,r.attr(n),r.updateTransform(),r;}function a(t,e,i,n,r){if(!t.dragging){var o=n.getModel("checkpointStyle"),a=i.dataToCoord(n.getData().get(["value"],e));r||!o.get("animation",!0)?t.attr({position:[a,0]}):(t.stopAnimation(!0),t.animateTo({position:[a,0]},o.get("animationDuration",!0),o.get("animationEasing",!0)));}}var s=i(4),l=i(43),u=i(21),h=i(365),c=i(366),d=i(106),f=i(114),p=i(9),g=i(11),m=i(7),v=i(6),y=v.encodeHTML,x=s.bind,_=s.each,b=Math.PI;t.exports=h.extend({type:"timeline.slider",init:function init(t,e){this.api=e,this._axis,this._viewRect,this._timer,this._currentPointer,this._mainGroup,this._labelGroup;},render:function render(t,e,i,n){if(this.model=t,this.api=i,this.ecModel=e,this.group.removeAll(),t.get("show",!0)){var r=this._layout(t,i),o=this._createGroup("mainGroup"),a=this._createGroup("labelGroup"),s=this._axis=this._createAxis(r,t);t.formatTooltip=function(t){return y(s.scale.getLabel(t));},_(["AxisLine","AxisTick","Control","CurrentPointer"],function(e){this["_render"+e](r,o,s,t);},this),this._renderAxisLabel(r,a,s,t),this._position(r,t);}this._doPlayStop();},remove:function remove(){this._clearTimer(),this.group.removeAll();},dispose:function dispose(){this._clearTimer();},_layout:function _layout(t,e){var i=t.get("label.normal.position"),r=t.get("orient"),o=n(t,e);null==i||"auto"===i?i="horizontal"===r?o.y+o.height/2<e.getHeight()/2?"-":"+":o.x+o.width/2<e.getWidth()/2?"+":"-":isNaN(i)&&(i={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[r][i]);var a={horizontal:"center",vertical:i>=0||"+"===i?"left":"right"},s={horizontal:i>=0||"+"===i?"top":"bottom",vertical:"middle"},l={horizontal:0,vertical:b/2},u="vertical"===r?o.height:o.width,h=t.getModel("controlStyle"),c=h.get("show"),d=c?h.get("itemSize"):0,f=c?h.get("itemGap"):0,p=d+f,g=t.get("label.normal.rotate")||0;g=g*b/180;var m,v,y,x,_=h.get("position",!0),c=h.get("show",!0),w=c&&h.get("showPlayBtn",!0),S=c&&h.get("showPrevBtn",!0),M=c&&h.get("showNextBtn",!0),I=0,T=u;return"left"===_||"bottom"===_?(w&&(m=[0,0],I+=p),S&&(v=[I,0],I+=p),M&&(y=[T-d,0],T-=p)):(w&&(m=[T-d,0],T-=p),S&&(v=[0,0],I+=p),M&&(y=[T-d,0],T-=p)),x=[I,T],t.get("inverse")&&x.reverse(),{viewRect:o,mainLength:u,orient:r,rotation:l[r],labelRotation:g,labelPosOpt:i,labelAlign:a[r],labelBaseline:s[r],playPosition:m,prevBtnPosition:v,nextBtnPosition:y,axisExtent:x,controlSize:d,controlGap:f};},_position:function _position(t,e){function i(t){var e=t.position;t.origin=[c[0][0]-e[0],c[1][0]-e[1]];}function n(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]];}function r(t,e,i,n,r){t[n]+=i[n][r]-e[n][r];}var o=this._mainGroup,a=this._labelGroup,s=t.viewRect;if("vertical"===t.orient){var l=g.create(),u=s.x,h=s.y+s.height;g.translate(l,l,[-u,-h]),g.rotate(l,l,-b/2),g.translate(l,l,[u,h]),s=s.clone(),s.applyTransform(l);}var c=n(s),d=n(o.getBoundingRect()),f=n(a.getBoundingRect()),p=o.position,m=a.position;m[0]=p[0]=c[0][0];var v=t.labelPosOpt;if(isNaN(v)){var y="+"===v?0:1;r(p,d,c,1,y),r(m,f,c,1,1-y);}else{var y=v>=0?0:1;r(p,d,c,1,y),m[1]=p[1]+v;}o.attr("position",p),a.attr("position",m),o.rotation=a.rotation=t.rotation,i(o),i(a);},_createAxis:function _createAxis(t,e){var i=e.getData(),n=e.get("axisType"),r=f.createScaleByModel(e,n),o=i.getDataExtent("value");r.setExtent(o[0],o[1]),this._customizeScale(r,i),r.niceTicks();var a=new c("value",r,t.axisExtent,n);return a.model=e,a;},_customizeScale:function _customizeScale(t,e){t.getTicks=function(){return e.mapArray(["value"],function(t){return t;});},t.getTicksLabels=function(){return s.map(this.getTicks(),t.getLabel,t);};},_createGroup:function _createGroup(t){var e=this["_"+t]=new l.Group();return this.group.add(e),e;},_renderAxisLine:function _renderAxisLine(t,e,i,n){var r=i.getExtent();n.get("lineStyle.show")&&e.add(new l.Line({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:s.extend({lineCap:"round"},n.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}));},_renderAxisTick:function _renderAxisTick(t,e,i,n){var r=n.getData(),a=i.scale.getTicks();_(a,function(t,a){var s=i.dataToCoord(t),u=r.getItemModel(a),h=u.getModel("itemStyle.normal"),c=u.getModel("itemStyle.emphasis"),d={position:[s,0],onclick:x(this._changeTimeline,this,a)},f=o(u,h,e,d);l.setHoverStyle(f,c.getItemStyle()),u.get("tooltip")?(f.dataIndex=a,f.dataModel=n):f.dataIndex=f.dataModel=null;},this);},_renderAxisLabel:function _renderAxisLabel(t,e,i,n){var r=n.getModel("label.normal");if(r.get("show")){var o=n.getData(),a=i.scale.getTicks(),s=f.getFormattedLabels(i,r.get("formatter")),u=i.getLabelInterval();_(a,function(n,r){if(!i.isLabelIgnored(r,u)){var a=o.getItemModel(r),h=a.getModel("label.normal.textStyle"),c=a.getModel("label.emphasis.textStyle"),d=i.dataToCoord(n),f=new l.Text({style:{text:s[r],textAlign:t.labelAlign,textVerticalAlign:t.labelBaseline,textFont:h.getFont(),fill:h.getTextColor()},position:[d,0],rotation:t.labelRotation-t.rotation,onclick:x(this._changeTimeline,this,r),silent:!1});e.add(f),l.setHoverStyle(f,c.getItemStyle());}},this);}},_renderControl:function _renderControl(t,e,i,n){function o(t,i,o,d){if(t){var f={position:t,origin:[a/2,0],rotation:d?-s:0,rectHover:!0,style:u,onclick:o},p=r(n,i,c,f);e.add(p),l.setHoverStyle(p,h);}}var a=t.controlSize,s=t.rotation,u=n.getModel("controlStyle.normal").getItemStyle(),h=n.getModel("controlStyle.emphasis").getItemStyle(),c=[0,-a/2,a,a],d=n.getPlayState(),f=n.get("inverse",!0);o(t.nextBtnPosition,"controlStyle.nextIcon",x(this._changeTimeline,this,f?"-":"+")),o(t.prevBtnPosition,"controlStyle.prevIcon",x(this._changeTimeline,this,f?"+":"-")),o(t.playPosition,"controlStyle."+(d?"stopIcon":"playIcon"),x(this._handlePlayClick,this,!d),!0);},_renderCurrentPointer:function _renderCurrentPointer(t,e,i,n){var r=n.getData(),s=n.getCurrentIndex(),l=r.getItemModel(s).getModel("checkpointStyle"),u=this,h={onCreate:function onCreate(t){t.draggable=!0,t.drift=x(u._handlePointerDrag,u),t.ondragend=x(u._handlePointerDragend,u),a(t,s,i,n,!0);},onUpdate:function onUpdate(t){a(t,s,i,n);}};this._currentPointer=o(l,l,this._mainGroup,{},this._currentPointer,h);},_handlePlayClick:function _handlePlayClick(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid});},_handlePointerDrag:function _handlePointerDrag(t,e,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY]);},_handlePointerDragend:function _handlePointerDragend(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0);},_pointerChangeTimeline:function _pointerChangeTimeline(t,e){var i=this._toAxisCoord(t)[0],n=this._axis,r=m.asc(n.getExtent().slice());i>r[1]&&(i=r[1]),i<r[0]&&(i=r[0]),this._currentPointer.position[0]=i,this._currentPointer.dirty();var o=this._findNearestTick(i),a=this.model;(e||o!==a.getCurrentIndex()&&a.get("realtime"))&&this._changeTimeline(o);},_doPlayStop:function _doPlayStop(){function t(){var t=this.model;this._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1));}this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(x(t,this),this.model.get("playInterval")));},_toAxisCoord:function _toAxisCoord(t){var e=this._mainGroup.getLocalTransform();return l.applyTransform(t,e,!0);},_findNearestTick:function _findNearestTick(t){var e,i=this.model.getData(),n=1/0,r=this._axis;return i.each(["value"],function(i,o){var a=r.dataToCoord(i),s=Math.abs(a-t);n>s&&(n=s,e=o);}),e;},_clearTimer:function _clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null);},_changeTimeline:function _changeTimeline(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid});}});},function(t,e,i){var n=i(29);t.exports=n.extend({type:"timeline"});},function(t,e,i){var n=i(4),r=i(123),o=i(114),a=function a(t,e,i,n){r.call(this,t,e,i),this.type=n||"value",this._autoLabelInterval,this.model=null;};a.prototype={constructor:a,getLabelInterval:function getLabelInterval(){var t=this.model,e=t.getModel("label.normal"),i=e.get("interval");if(null!=i&&"auto"!=i)return i;var i=this._autoLabelInterval;return i||(i=this._autoLabelInterval=o.getAxisLabelInterval(n.map(this.scale.getTicks(),this.dataToCoord,this),o.getFormattedLabels(this,e.get("formatter")),e.getModel("textStyle").getFont(),"horizontal"===t.get("orient"))),i;},isLabelIgnored:function isLabelIgnored(t){if("category"===this.type){var e=this.getLabelInterval();return"function"==typeof e&&!e(t,this.scale.getLabel(t))||t%(e+1);}}},n.inherits(a,r),t.exports=a;},function(t,e,i){i(368),i(369),i(371),i(372),i(373),i(374),i(379);},function(t,e,i){var n=i(315),r=i(4),o=i(1).extendComponentModel({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},mergeDefaultAndTheme:function mergeDefaultAndTheme(t){o.superApply(this,"mergeDefaultAndTheme",arguments),r.each(this.option.feature,function(t,e){var i=n.get(e);i&&r.merge(t,i.defaultOption);});},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{normal:{borderColor:"#666",color:"none"},emphasis:{borderColor:"#3E98C5"}}}});t.exports=o;},function(t,e,i){(function(e){function n(t){return 0===t.indexOf("my");}var r=i(315),o=i(4),a=i(43),s=i(12),l=i(98),u=i(278),h=i(8);t.exports=i(1).extendComponentView({type:"toolbox",render:function render(t,e,i,c){function d(o,a){var l,u=y[o],h=y[a],d=m[u],p=new s(d,t,t.ecModel);if(u&&!h){if(n(u))l={model:p,onclick:p.option.onclick,featureName:u};else{var g=r.get(u);if(!g)return;l=new g(p,e,i);}v[u]=l;}else{if(l=v[h],!l)return;l.model=p,l.ecModel=e,l.api=i;}return!u&&h?void(l.dispose&&l.dispose(e,i)):!p.get("show")||l.unusable?void(l.remove&&l.remove(e,i)):(f(p,l,u),p.setIconStatus=function(t,e){var i=this.option,n=this.iconPaths;i.iconStatus=i.iconStatus||{},i.iconStatus[t]=e,n[t]&&n[t].trigger(e);},void(l.render&&l.render(p,e,i,c)));}function f(n,r,s){var l=n.getModel("iconStyle"),u=r.getIcons?r.getIcons():n.get("icon"),h=n.get("title")||{};if("string"==typeof u){var c=u,d=h;u={},h={},u[s]=c,h[s]=d;}var f=n.iconPaths={};o.each(u,function(s,u){var c=l.getModel("normal").getItemStyle(),d=l.getModel("emphasis").getItemStyle(),m={x:-g/2,y:-g/2,width:g,height:g},v=0===s.indexOf("image://")?(m.image=s.slice(8),new a.Image({style:m})):a.makePath(s.replace("path://",""),{style:c,hoverStyle:d,rectHover:!0},m,"center");a.setHoverStyle(v),t.get("showTitle")&&(v.__title=h[u],v.on("mouseover",function(){var t=l.getModel("emphasis").getItemStyle();v.setStyle({text:h[u],textPosition:t.textPosition||"bottom",textFill:t.fill||t.stroke||"#000",textAlign:t.textAlign||"center"});}).on("mouseout",function(){v.setStyle({textFill:null});})),v.trigger(n.get("iconStatus."+u)||"normal"),p.add(v),v.on("click",o.bind(r.onclick,r,e,i,u)),f[u]=v;});}var p=this.group;if(p.removeAll(),t.get("show")){var g=+t.get("itemSize"),m=t.get("feature")||{},v=this._features||(this._features={}),y=[];o.each(m,function(t,e){y.push(e);}),new l(this._featureNames||[],y).add(d).update(d).remove(o.curry(d,null)).execute(),this._featureNames=y,u.layout(p,t,i),u.addBackground(p,t),p.eachChild(function(t){var e=t.__title,n=t.hoverStyle;if(n&&e){var r=h.getBoundingRect(e,n.font),o=t.position[0]+p.position[0],a=t.position[1]+p.position[1]+g,s=!1;a+r.height>i.getHeight()&&(n.textPosition="top",s=!0);var l=s?-5-r.height:g+8;o+r.width/2>i.getWidth()?(n.textPosition=["100%",l],n.textAlign="right"):o-r.width/2<0&&(n.textPosition=[0,l],n.textAlign="left");}});}},updateView:function updateView(t,e,i,n){o.each(this._features,function(t){t.updateView&&t.updateView(t.model,e,i,n);});},updateLayout:function updateLayout(t,e,i,n){o.each(this._features,function(t){t.updateLayout&&t.updateLayout(t.model,e,i,n);});},remove:function remove(t,e){o.each(this._features,function(i){i.remove&&i.remove(t,e);}),this.group.removeAll();},dispose:function dispose(t,e){o.each(this._features,function(i){i.dispose&&i.dispose(t,e);});}});}).call(e,i(370));},function(t,e){function i(){throw new Error("setTimeout has not been defined");}function n(){throw new Error("clearTimeout has not been defined");}function r(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0);}catch(e){try{return h.call(null,t,0);}catch(e){return h.call(this,t,0);}}}function o(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t);}catch(e){try{return c.call(null,t);}catch(e){return c.call(this,t);}}}function a(){g&&f&&(g=!1,f.length?p=f.concat(p):m=-1,p.length&&s());}function s(){if(!g){var t=r(a);g=!0;for(var e=p.length;e;){for(f=p,p=[];++m<e;){f&&f[m].run();}m=-1,e=p.length;}f=null,g=!1,o(t);}}function l(t,e){this.fun=t,this.array=e;}function u(){}var h,c,d=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i;}catch(t){h=i;}try{c="function"==typeof clearTimeout?clearTimeout:n;}catch(t){c=n;}}();var f,p=[],g=!1,m=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i];}p.push(new l(t,e)),1!==p.length||g||r(s);},l.prototype.run=function(){this.fun.apply(null,this.array);},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.binding=function(t){throw new Error("process.binding is not supported");},d.cwd=function(){return"/";},d.chdir=function(t){throw new Error("process.chdir is not supported");},d.umask=function(){return 0;};},function(t,e,i){function n(t){this.model=t;}var r=i(2);n.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:"",type:"png",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:[""]},n.prototype.unusable=!r.canvasSupported;var o=n.prototype;o.onclick=function(t,e){var i=this.model,n=i.get("name")||t.get("title.0.text")||"echarts",r=document.createElement("a"),o=i.get("type",!0)||"png";r.download=n+"."+o,r.target="_blank";var a=e.getConnectedDataURL({type:o,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")});if(r.href=a,"function"==typeof MouseEvent){var s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});r.dispatchEvent(s);}else{var l=i.get("lang"),u='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(l&&l[0]||"")+'" /></body>',h=window.open();h.document.write(u);}},i(315).register("saveAsImage",n),t.exports=n;},function(t,e,i){"use strict";function n(t){this.model=t;}var r=i(4);n.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z",tiled:"M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z"},title:{line:"",bar:"",stack:"",tiled:""},option:{},seriesIndex:{}};var o=n.prototype;o.getIcons=function(){var t=this.model,e=t.get("icon"),i={};return r.each(t.get("type"),function(t){e[t]&&(i[t]=e[t]);}),i;};var a={line:function line(t,e,i,n){return"bar"===t?r.merge({id:e,type:"line",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.line")||{},!0):void 0;},bar:function bar(t,e,i,n){return"line"===t?r.merge({id:e,type:"bar",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.bar")||{},!0):void 0;},stack:function stack(t,e,i,n){return"line"===t||"bar"===t?r.merge({id:e,stack:"__ec_magicType_stack__"},n.get("option.stack")||{},!0):void 0;},tiled:function tiled(t,e,i,n){return"line"===t||"bar"===t?r.merge({id:e,stack:""},n.get("option.tiled")||{},!0):void 0;}},s=[["line","bar"],["stack","tiled"]];o.onclick=function(t,e,i){var n=this.model,o=n.get("seriesIndex."+i);if(a[i]){var l={series:[]},u=function u(e){var o=e.subType,s=e.id,u=a[i](o,s,e,n);u&&(r.defaults(u,e.option),l.series.push(u));var h=e.coordinateSystem;if(h&&"cartesian2d"===h.type&&("line"===i||"bar"===i)){var c=h.getAxesByScale("ordinal")[0];if(c){var d=c.dim,f=d+"Axis",p=t.queryComponents({mainType:f,index:e.get(name+"Index"),id:e.get(name+"Id")})[0],g=p.componentIndex;l[f]=l[f]||[];for(var m=0;g>=m;m++){l[f][g]=l[f][g]||{};}l[f][g].boundaryGap="bar"===i?!0:!1;}}};r.each(s,function(t){r.indexOf(t,i)>=0&&r.each(t,function(t){n.setIconStatus(t,"normal");});}),n.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:null==o?null:{seriesIndex:o}},u),e.dispatchAction({type:"changeMagicType",currentType:i,newOption:l});}};var l=i(1);l.registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption);}),i(315).register("magicType",n),t.exports=n;},function(t,e,i){function n(t){var e={},i=[],n=[];return t.eachRawSeries(function(t){var r=t.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)i.push(t);else{var o=r.getBaseAxis();if("category"===o.type){var a=o.dim+"_"+o.index;e[a]||(e[a]={categoryAxis:o,valueAxis:r.getOtherAxis(o),series:[]},n.push({axisDim:o.dim,axisIndex:o.index})),e[a].series.push(t);}else i.push(t);}}),{seriesGroupByCategoryAxis:e,other:i,meta:n};}function r(t){var e=[];return p.each(t,function(t,i){var n=t.categoryAxis,r=t.valueAxis,o=r.dim,a=[" "].concat(p.map(t.series,function(t){return t.name;})),s=[n.model.getCategories()];p.each(t.series,function(t){s.push(t.getRawData().mapArray(o,function(t){return t;}));});for(var l=[a.join(v)],u=0;u<s[0].length;u++){for(var h=[],c=0;c<s.length;c++){h.push(s[c][u]);}l.push(h.join(v));}e.push(l.join("\n"));}),e.join("\n\n"+m+"\n\n");}function o(t){return p.map(t,function(t){var e=t.getRawData(),i=[t.name],n=[];return e.each(e.dimensions,function(){for(var t=arguments.length,r=arguments[t-1],o=e.getName(r),a=0;t-1>a;a++){n[a]=arguments[a];}i.push((o?o+v:"")+n.join(v));}),i.join("\n");}).join("\n\n"+m+"\n\n");}function a(t){var e=n(t);return{value:p.filter([r(e.seriesGroupByCategoryAxis),o(e.other)],function(t){return t.replace(/[\n\t\s]/g,"");}).join("\n\n"+m+"\n\n"),meta:e.meta};}function s(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function l(t){var e=t.slice(0,t.indexOf("\n"));return e.indexOf(v)>=0?!0:void 0;}function u(t){for(var e=t.split(/\n+/g),i=s(e.shift()).split(y),n=[],r=p.map(i,function(t){return{name:t,data:[]};}),o=0;o<e.length;o++){var a=s(e[o]).split(y);n.push(a.shift());for(var l=0;l<a.length;l++){r[l]&&(r[l].data[o]=a[l]);}}return{series:r,categories:n};}function h(t){for(var e=t.split(/\n+/g),i=s(e.shift()),n=[],r=0;r<e.length;r++){var o,a=s(e[r]).split(y),l="",u=!1;isNaN(a[0])?(u=!0,l=a[0],a=a.slice(1),n[r]={name:l,value:[]},o=n[r].value):o=n[r]=[];for(var h=0;h<a.length;h++){o.push(+a[h]);}1===o.length&&(u?n[r].value=o[0]:n[r]=o[0]);}return{name:i,data:n};}function c(t,e){var i=t.split(new RegExp("\n*"+m+"\n*","g")),n={series:[]};return p.each(i,function(t,i){if(l(t)){var r=u(t),o=e[i],a=o.axisDim+"Axis";o&&(n[a]=n[a]||[],n[a][o.axisIndex]={data:r.categories},n.series=n.series.concat(r.series));}else{var r=h(t);n.series.push(r);}}),n;}function d(t){this._dom=null,this.model=t;}function f(t,e){return p.map(t,function(t,i){var n=e&&e[i];return p.isObject(n)&&!p.isArray(n)?(p.isObject(t)&&!p.isArray(t)&&(t=t.value),p.defaults({value:t},n)):t;});}var p=i(4),g=i(87),m=new Array(60).join("-"),v="	",y=new RegExp("["+v+"]+","g");d.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:"",lang:["","",""],backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},d.prototype.onclick=function(t,e){function i(){n.removeChild(o),M._dom=null;}var n=e.getDom(),r=this.model;this._dom&&n.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",o.style.backgroundColor=r.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=r.get("lang")||[];s.innerHTML=l[0]||r.get("title"),s.style.cssText="margin: 10px 20px;",s.style.color=r.get("textColor");var u=document.createElement("div"),h=document.createElement("textarea");u.style.cssText="display:block;width:100%;overflow:hidden;";var d=r.get("optionToContent"),f=r.get("contentToOption"),m=a(t);if("function"==typeof d){var y=d(e.getOption());"string"==typeof y?u.innerHTML=y:p.isDom(y)&&u.appendChild(y);}else u.appendChild(h),h.readOnly=r.get("readOnly"),h.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",h.style.color=r.get("textColor"),h.style.borderColor=r.get("textareaBorderColor"),h.style.backgroundColor=r.get("textareaColor"),h.value=m.value;var x=m.meta,_=document.createElement("div");_.style.cssText="position:absolute;bottom:0;left:0;right:0;";var b="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",w=document.createElement("div"),S=document.createElement("div");b+=";background-color:"+r.get("buttonColor"),b+=";color:"+r.get("buttonTextColor");var M=this;g.addEventListener(w,"click",i),g.addEventListener(S,"click",function(){var t;try{t="function"==typeof f?f(u,e.getOption()):c(h.value,x);}catch(n){throw i(),new Error("Data view format error "+n);}t&&e.dispatchAction({type:"changeDataView",newOption:t}),i();}),w.innerHTML=l[1],S.innerHTML=l[2],S.style.cssText=b,w.style.cssText=b,!r.get("readOnly")&&_.appendChild(S),_.appendChild(w),g.addEventListener(h,"keydown",function(t){if(9===(t.keyCode||t.which)){var e=this.value,i=this.selectionStart,n=this.selectionEnd;this.value=e.substring(0,i)+v+e.substring(n),this.selectionStart=this.selectionEnd=i+1,g.stop(t);}}),o.appendChild(s),o.appendChild(u),o.appendChild(_),u.style.height=n.clientHeight-80+"px",n.appendChild(o),this._dom=o;},d.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom);},d.prototype.dispose=function(t,e){this.remove(t,e);},i(315).register("dataView",d),i(1).registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,e){var i=[];p.each(t.newOption.series,function(t){var n=e.getSeriesByName(t.name)[0];if(n){var r=n.get("data");i.push({name:t.name,data:f(t.data,r)});}else i.push(p.extend({type:"scatter"},t));}),e.mergeOption(p.defaults({series:i},t.newOption));}),t.exports=d;},function(t,e,i){"use strict";function n(t,e,i){(this._brushController=new l(i.getZr())).on("brush",s.bind(this._onBrush,this)).mount(),this._isZoomActive;}function r(t){var e={};return s.each(["xAxisIndex","yAxisIndex"],function(i){e[i]=t[i],null==e[i]&&(e[i]="all"),(e[i]===!1||"none"===e[i])&&(e[i]=[]);}),e;}function o(t,e){t.setIconStatus("back",h.count(e)>1?"emphasis":"normal");}function a(t,e,i,n){var o=i._isZoomActive;n&&"takeGlobalCursor"===n.type&&(o="dataZoomSelect"===n.key?n.dataZoomSelectActive:!1),i._isZoomActive=o,t.setIconStatus("zoom",o?"emphasis":"normal");var a=u.makeCoordInfoList(r(t.option),e),s=a.xAxisHas&&!a.yAxisHas?"lineX":!a.xAxisHas&&a.yAxisHas?"lineY":"rect";i._brushController.setPanels(u.makePanelOpts(a)).enableBrush(o?{brushType:s,brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}}:!1);}var s=i(4),l=i(234),u=i(310),h=i(375),c=s.each;i(376);var d="\x00_ec_\x00toolbox-dataZoom_";n.defaultOption={show:!0,icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:{zoom:"",back:""}};var f=n.prototype;f.render=function(t,e,i,n){this.model=t,this.ecModel=e,this.api=i,a(t,e,this,n),o(t,e);},f.onclick=function(t,e,i){p[i].call(this);},f.remove=function(t,e){this._brushController.unmount();},f.dispose=function(t,e){this._brushController.dispose();};var p={zoom:function zoom(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t});},back:function back(){this._dispatchZoomAction(h.pop(this.ecModel));}};f._onBrush=function(t,e){function i(t,e,i){var r=n(t,i[t],a);r&&(o[r.id]={dataZoomId:r.id,startValue:e[0],endValue:e[1]});}function n(t,e,i){var n;return i.eachComponent({mainType:"dataZoom",subType:"select"},function(r,o){var a=r.get(t+"Index");null!=a&&i.getComponent(t,a)===e&&(n=r);}),n;}if(e.isEnd&&t.length){var o={},a=this.ecModel;this._brushController.updateCovers([]);var s=u.makeCoordInfoList(r(this.model.option),a),l=[];u.parseOutputRanges(t,s,a,l);var c=t[0],d=l[0],f=c.coordRange,p=c.brushType;if(d&&f)if("rect"===p)i("xAxis",f[0],d),i("yAxis",f[1],d);else{var g={lineX:"xAxis",lineY:"yAxis"};i(g[p],f,d);}h.push(a,o),this._dispatchZoomAction(o);}},f._dispatchZoomAction=function(t){var e=[];c(t,function(t,i){e.push(s.clone(t));}),e.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:e});},i(315).register("dataZoom",n),i(1).registerPreprocessor(function(t){function e(t,e){if(e){var r=t+"Index",o=e[r];null==o||"all"==o||s.isArray(o)||(o=o===!1||"none"===o?[]:[o]),i(t,function(e,i){if(null==o||"all"==o||-1!==s.indexOf(o,i)){var a={type:"select",$fromToolbox:!0,id:d+t+i};a[r]=i,n.push(a);}});}}function i(e,i){var n=t[e];s.isArray(n)||(n=n?[n]:[]),c(n,i);}if(t){var n=t.dataZoom||(t.dataZoom=[]);s.isArray(n)||(t.dataZoom=n=[n]);var r=t.toolbox;if(r&&(s.isArray(r)&&(r=r[0]),r&&r.feature)){var o=r.feature.dataZoom;e("xAxis",o),e("yAxis",o);}}}),t.exports=n;},function(t,e,i){function n(t){var e=t[a];return e||(e=t[a]=[{}]),e;}var r=i(4),o=r.each,a="\x00_ec_hist_store",s={push:function push(t,e){var i=n(t);o(e,function(e,n){for(var r=i.length-1;r>=0;r--){var o=i[r];if(o[n])break;}if(0>r){var a=t.queryComponents({mainType:"dataZoom",subType:"select",id:n})[0];if(a){var s=a.getPercentRange();i[0][n]={dataZoomId:n,start:s[0],end:s[1]};}}}),i.push(e);},pop:function pop(t){var e=n(t),i=e[e.length-1];e.length>1&&e.pop();var r={};return o(i,function(t,i){for(var n=e.length-1;n>=0;n--){var t=e[n][i];if(t){r[i]=t;break;}}}),r;},clear:function clear(t){t[a]=null;},count:function count(t){return n(t).length;}};t.exports=s;},function(t,e,i){i(318),i(319),i(322),i(377),i(378),i(329),i(330);},function(t,e,i){var n=i(319);t.exports=n.extend({type:"dataZoom.select"});},function(t,e,i){t.exports=i(322).extend({type:"dataZoom.select"});},function(t,e,i){"use strict";function n(t){this.model=t;}var r=i(375);n.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:""};var o=n.prototype;o.onclick=function(t,e,i){r.clear(t),e.dispatchAction({type:"restore",from:this.uid});},i(315).register("restore",n),i(1).registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate");}),t.exports=n;},function(t,e,i){i(381),i(81).registerPainter("vml",i(383));},function(t,e,i){if(!i(2).canvasSupported){var n=i(10),r=i(9),o=i(49).CMD,a=i(39),s=i(8),l=i(48),u=i(46),h=i(62),c=i(64),d=i(45),f=i(61),p=i(382),g=Math.round,m=Math.sqrt,v=Math.abs,y=Math.cos,x=Math.sin,_=Math.max,b=n.applyTransform,w=",",S="progid:DXImageTransform.Microsoft",M=21600,I=M/2,T=1e5,A=1e3,L=function L(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=M+","+M,t.coordorigin="0,0";},C=function C(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;");},D=function D(t,e,i){return"rgb("+[t,e,i].join(",")+")";},P=function P(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e);},k=function k(t,e){e&&t&&e.parentNode===t&&t.removeChild(e);},z=function z(t,e,i){return(parseFloat(t)||0)*T+(parseFloat(e)||0)*A+i;},O=function O(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t;},E=function E(t,e,i){var n=a.parse(e);i=+i,isNaN(i)&&(i=1),n&&(t.color=D(n[0],n[1],n[2]),t.opacity=i*n[3]);},R=function R(t){var e=a.parse(t);return[D(e[0],e[1],e[2]),e[3]];},N=function N(t,e,i){var n=e.fill;if(null!=n)if(n instanceof f){var r,o=0,a=[0,0],s=0,l=1,u=i.getBoundingRect(),h=u.width,c=u.height;if("linear"===n.type){r="gradient";var d=i.transform,p=[n.x*h,n.y*c],g=[n.x2*h,n.y2*c];d&&(b(p,p,d),b(g,g,d));var m=g[0]-p[0],v=g[1]-p[1];o=180*Math.atan2(m,v)/Math.PI,0>o&&(o+=360),1e-6>o&&(o=0);}else{r="gradientradial";var p=[n.x*h,n.y*c],d=i.transform,y=i.scale,x=h,w=c;a=[(p[0]-u.x)/x,(p[1]-u.y)/w],d&&b(p,p,d),x/=y[0]*M,w/=y[1]*M;var S=_(x,w);s=0/S,l=2*n.r/S-s;}var I=n.colorStops.slice();I.sort(function(t,e){return t.offset-e.offset;});for(var T=I.length,A=[],L=[],C=0;T>C;C++){var D=I[C],P=R(D.color);L.push(D.offset*l+s+" "+P[0]),(0===C||C===T-1)&&A.push(P);}if(T>=2){var k=A[0][0],z=A[1][0],O=A[0][1]*e.opacity,N=A[1][1]*e.opacity;t.type=r,t.method="none",t.focus="100%",t.angle=o,t.color=k,t.color2=z,t.colors=L.join(","),t.opacity=N,t.opacity2=O;}"radial"===r&&(t.focusposition=a.join(","));}else E(t,n,e.opacity);},V=function V(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof f||E(t,e.stroke,e.opacity);},B=function B(t,e,i,n){var r="fill"==e,o=t.getElementsByTagName(e)[0];null!=i[e]&&"none"!==i[e]&&(r||!r&&i.lineWidth)?(t[r?"filled":"stroked"]="true",i[e]instanceof f&&k(t,o),o||(o=p.createNode(e)),r?N(o,i,n):V(o,i),P(t,o)):(t[r?"filled":"stroked"]="false",k(t,o));},G=[[],[],[]],F=function F(t,e){var i,n,r,a,s,l,u=o.M,h=o.C,c=o.L,d=o.A,f=o.Q,p=[];for(a=0;a<t.length;){switch(r=t[a++],n="",i=0,r){case u:n=" m ",i=1,s=t[a++],l=t[a++],G[0][0]=s,G[0][1]=l;break;case c:n=" l ",i=1,s=t[a++],l=t[a++],G[0][0]=s,G[0][1]=l;break;case f:case h:n=" c ",i=3;var v,_,S=t[a++],T=t[a++],A=t[a++],L=t[a++];r===f?(v=A,_=L,A=(A+2*S)/3,L=(L+2*T)/3,S=(s+2*S)/3,T=(l+2*T)/3):(v=t[a++],_=t[a++]),G[0][0]=S,G[0][1]=T,G[1][0]=A,G[1][1]=L,G[2][0]=v,G[2][1]=_,s=v,l=_;break;case d:var C=0,D=0,P=1,k=1,z=0;e&&(C=e[4],D=e[5],P=m(e[0]*e[0]+e[1]*e[1]),k=m(e[2]*e[2]+e[3]*e[3]),z=Math.atan2(-e[1]/k,e[0]/P));var O=t[a++],E=t[a++],R=t[a++],N=t[a++],V=t[a++]+z,B=t[a++]+V+z;a++;var F=t[a++],H=O+y(V)*R,W=E+x(V)*N,S=O+y(B)*R,T=E+x(B)*N,Z=F?" wa ":" at ";Math.abs(H-S)<1e-10&&(Math.abs(B-V)>.01?F&&(H+=270/M):Math.abs(W-E)<1e-10?F&&O>H||!F&&H>O?T-=270/M:T+=270/M:F&&E>W||!F&&W>E?S+=270/M:S-=270/M),p.push(Z,g(((O-R)*P+C)*M-I),w,g(((E-N)*k+D)*M-I),w,g(((O+R)*P+C)*M-I),w,g(((E+N)*k+D)*M-I),w,g((H*P+C)*M-I),w,g((W*k+D)*M-I),w,g((S*P+C)*M-I),w,g((T*k+D)*M-I)),s=S,l=T;break;case o.R:var q=G[0],U=G[1];q[0]=t[a++],q[1]=t[a++],U[0]=q[0]+t[a++],U[1]=q[1]+t[a++],e&&(b(q,q,e),b(U,U,e)),q[0]=g(q[0]*M-I),U[0]=g(U[0]*M-I),q[1]=g(q[1]*M-I),U[1]=g(U[1]*M-I),p.push(" m ",q[0],w,q[1]," l ",U[0],w,q[1]," l ",U[0],w,U[1]," l ",q[0],w,U[1]);break;case o.Z:p.push(" x ");}if(i>0){p.push(n);for(var j=0;i>j;j++){var X=G[j];e&&b(X,X,e),p.push(g(X[0]*M-I),w,g(X[1]*M-I),i-1>j?w:"");}}}return p.join("");};d.prototype.brushVML=function(t){var e=this.style,i=this._vmlEl;i||(i=p.createNode("shape"),L(i),this._vmlEl=i),B(i,"fill",e,this),B(i,"stroke",e,this);var n=this.transform,r=null!=n,o=i.getElementsByTagName("stroke")[0];if(o){var a=e.lineWidth;if(r&&!e.strokeNoScale){var s=n[0]*n[3]-n[1]*n[2];a*=m(v(s));}o.weight=a+"px";}var l=this.path;this.__dirtyPath&&(l.beginPath(),this.buildPath(l,this.shape),l.toStatic(),this.__dirtyPath=!1),i.path=F(l.data,this.transform),i.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,i),e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t);},d.prototype.onRemove=function(t){k(t,this._vmlEl),this.removeRectText(t);},d.prototype.onAdd=function(t){P(t,this._vmlEl),this.appendRectText(t);};var H=function H(t){return"object"==(typeof t==="undefined"?"undefined":_typeof(t))&&t.tagName&&"IMG"===t.tagName.toUpperCase();};h.prototype.brushVML=function(t){var e,i,n=this.style,r=n.image;if(H(r)){var o=r.src;if(o===this._imageSrc)e=this._imageWidth,i=this._imageHeight;else{var a=r.runtimeStyle,s=a.width,l=a.height;a.width="auto",a.height="auto",e=r.width,i=r.height,a.width=s,a.height=l,this._imageSrc=o,this._imageWidth=e,this._imageHeight=i;}r=o;}else r===this._imageSrc&&(e=this._imageWidth,i=this._imageHeight);if(r){var u=n.x||0,h=n.y||0,c=n.width,d=n.height,f=n.sWidth,v=n.sHeight,y=n.sx||0,x=n.sy||0,M=f&&v,I=this._vmlEl;I||(I=p.doc.createElement("div"),L(I),this._vmlEl=I);var T,A=I.style,C=!1,D=1,k=1;if(this.transform&&(T=this.transform,D=m(T[0]*T[0]+T[1]*T[1]),k=m(T[2]*T[2]+T[3]*T[3]),C=T[1]||T[2]),C){var O=[u,h],E=[u+c,h],R=[u,h+d],N=[u+c,h+d];b(O,O,T),b(E,E,T),b(R,R,T),b(N,N,T);var V=_(O[0],E[0],R[0],N[0]),B=_(O[1],E[1],R[1],N[1]),G=[];G.push("M11=",T[0]/D,w,"M12=",T[2]/k,w,"M21=",T[1]/D,w,"M22=",T[3]/k,w,"Dx=",g(u*D+T[4]),w,"Dy=",g(h*k+T[5])),A.padding="0 "+g(V)+"px "+g(B)+"px 0",A.filter=S+".Matrix("+G.join("")+", SizingMethod=clip)";}else T&&(u=u*D+T[4],h=h*k+T[5]),A.filter="",A.left=g(u)+"px",A.top=g(h)+"px";var F=this._imageEl,W=this._cropEl;F||(F=p.doc.createElement("div"),this._imageEl=F);var Z=F.style;if(M){if(e&&i)Z.width=g(D*e*c/f)+"px",Z.height=g(k*i*d/v)+"px";else{var q=new Image(),U=this;q.onload=function(){q.onload=null,e=q.width,i=q.height,Z.width=g(D*e*c/f)+"px",Z.height=g(k*i*d/v)+"px",U._imageWidth=e,U._imageHeight=i,U._imageSrc=r;},q.src=r;}W||(W=p.doc.createElement("div"),W.style.overflow="hidden",this._cropEl=W);var j=W.style;j.width=g((c+y*c/f)*D),j.height=g((d+x*d/v)*k),j.filter=S+".Matrix(Dx="+-y*c/f*D+",Dy="+-x*d/v*k+")",W.parentNode||I.appendChild(W),F.parentNode!=W&&W.appendChild(F);}else Z.width=g(D*c)+"px",Z.height=g(k*d)+"px",I.appendChild(F),W&&W.parentNode&&(I.removeChild(W),this._cropEl=null);var X="",Y=n.opacity;1>Y&&(X+=".Alpha(opacity="+g(100*Y)+") "),X+=S+".AlphaImageLoader(src="+r+", SizingMethod=scale)",Z.filter=X,I.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,I),n.text&&this.drawRectText(t,this.getBoundingRect());}},h.prototype.onRemove=function(t){k(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t);},h.prototype.onAdd=function(t){P(t,this._vmlEl),this.appendRectText(t);};var W,Z="normal",q={},U=0,j=100,X=document.createElement("div"),Y=function Y(t){var e=q[t];if(!e){U>j&&(U=0,q={});var i,n=X.style;try{n.font=t,i=n.fontFamily.split(",")[0];}catch(r){}e={style:n.fontStyle||Z,variant:n.fontVariant||Z,weight:n.fontWeight||Z,size:0|parseFloat(n.fontSize||12),family:i||"Microsoft YaHei"},q[t]=e,U++;}return e;};s.measureText=function(t,e){var i=p.doc;W||(W=i.createElement("div"),W.style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",p.doc.body.appendChild(W));try{W.style.font=e;}catch(n){}return W.innerHTML="",W.appendChild(i.createTextNode(t)),{width:W.offsetWidth};};for(var $=new r(),Q=function Q(t,e,i,n){var r=this.style,o=r.text;if(o){var a,l,u=r.textAlign,h=Y(r.textFont),c=h.style+" "+h.variant+" "+h.weight+" "+h.size+'px "'+h.family+'"',d=r.textBaseline,f=r.textVerticalAlign;i=i||s.getBoundingRect(o,c,u,d);var m=this.transform;if(m&&!n&&($.copy(e),$.applyTransform(m),e=$),n)a=e.x,l=e.y;else{var v=r.textPosition,y=r.textDistance;if(v instanceof Array)a=e.x+O(v[0],e.width),l=e.y+O(v[1],e.height),u=u||"left",d=d||"top";else{var x=s.adjustTextPositionOnRect(v,e,i,y);a=x.x,l=x.y,u=u||x.textAlign,d=d||x.textBaseline;}}if(f){switch(f){case"middle":l-=i.height/2;break;case"bottom":l-=i.height;}d="top";}var _=h.size;switch(d){case"hanging":case"top":l+=_/1.75;break;case"middle":break;default:l-=_/2.25;}switch(u){case"left":break;case"center":a-=i.width/2;break;case"right":a-=i.width;}var S,M,I,T=p.createNode,A=this._textVmlEl;A?(I=A.firstChild,S=I.nextSibling,M=S.nextSibling):(A=T("line"),S=T("path"),M=T("textpath"),I=T("skew"),M.style["v-text-align"]="left",L(A),S.textpathok=!0,M.on=!0,A.from="0 0",A.to="1000 0.05",P(A,I),P(A,S),P(A,M),this._textVmlEl=A);var D=[a,l],k=A.style;m&&n?(b(D,D,m),I.on=!0,I.matrix=m[0].toFixed(3)+w+m[2].toFixed(3)+w+m[1].toFixed(3)+w+m[3].toFixed(3)+",0,0",I.offset=(g(D[0])||0)+","+(g(D[1])||0),I.origin="0 0",k.left="0px",k.top="0px"):(I.on=!1,k.left=g(a)+"px",k.top=g(l)+"px"),M.string=C(o);try{M.style.font=c;}catch(E){}B(A,"fill",{fill:n?r.fill:r.textFill,opacity:r.opacity},this),B(A,"stroke",{stroke:n?r.stroke:r.textStroke,opacity:r.opacity,lineDash:r.lineDash},this),A.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,A);}},K=function K(t){k(t,this._textVmlEl),this._textVmlEl=null;},J=function J(t){P(t,this._textVmlEl);},tt=[l,u,h,d,c],et=0;et<tt.length;et++){var it=tt[et].prototype;it.drawRectText=Q,it.removeRectText=K,it.appendRectText=J;}c.prototype.brushVML=function(t){var e=this.style;e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t);},c.prototype.onRemove=function(t){this.removeRectText(t);},c.prototype.onAdd=function(t){this.appendRectText(t);};}},function(t,e,i){if(!i(2).canvasSupported){var n,r="urn:schemas-microsoft-com:vml",o=window,a=o.document,s=!1;try{!a.namespaces.zrvml&&a.namespaces.add("zrvml",r),n=function n(t){return a.createElement("<zrvml:"+t+' class="zrvml">');};}catch(l){n=function n(t){return a.createElement("<"+t+' xmlns="'+r+'" class="zrvml">');};}var u=function u(){if(!s){s=!0;var t=a.styleSheets;t.length<31?a.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)");}};t.exports={doc:a,initVML:u,createNode:n};}},function(t,e,i){function n(t){return parseInt(t,10);}function r(t,e){s.initVML(),this.root=t,this.storage=e;var i=document.createElement("div"),n=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",n.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=n,this._vmlViewport=i,this.resize();var r=e.delFromMap,o=e.addToMap;e.delFromMap=function(t){var i=e.get(t);r.call(e,t),i&&i.onRemove&&i.onRemove(n);},e.addToMap=function(t){t.onAdd&&t.onAdd(n),o.call(e,t);},this._firstPaint=!0;}function o(t){return function(){a('In IE8.0 VML mode painter not support method "'+t+'"');};}var a=i(40),s=i(382);r.prototype={constructor:r,getViewportRoot:function getViewportRoot(){return this._vmlViewport;},refresh:function refresh(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t);},_paintList:function _paintList(t){for(var e=this._vmlRoot,i=0;i<t.length;i++){var n=t[i];n.invisible||n.ignore?(n.__alreadyNotVisible||n.onRemove(e),n.__alreadyNotVisible=!0):(n.__alreadyNotVisible&&n.onAdd(e),n.__alreadyNotVisible=!1,n.__dirty&&(n.beforeBrush&&n.beforeBrush(),(n.brushVML||n.brush).call(n,e),n.afterBrush&&n.afterBrush())),n.__dirty=!1;}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1);},resize:function resize(t,e){var t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var i=this._vmlViewport.style;i.width=t+"px",i.height=e+"px";}},dispose:function dispose(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},clear:function clear(){this._vmlViewport&&this.root.removeChild(this._vmlViewport);},_getWidth:function _getWidth(){var t=this.root,e=t.currentStyle;return(t.clientWidth||n(e.width))-n(e.paddingLeft)-n(e.paddingRight)|0;},_getHeight:function _getHeight(){var t=this.root,e=t.currentStyle;return(t.clientHeight||n(e.height))-n(e.paddingTop)-n(e.paddingBottom)|0;}};for(var l=["getLayer","insertLayer","eachLayer","eachBuildinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],u=0;u<l.length;u++){var h=l[u];r.prototype[h]=o(h);}t.exports=r;}]);});(function(){window.UEDITOR_HOME_URL='/static/scripts/lib/ueditor/';var URL=window.UEDITOR_HOME_URL||getUEBasePath();window.UEDITOR_CONFIG={UEDITOR_HOME_URL:URL,serverUrl:URL+"jsp/controller.jsp",toolbars:[['source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','|','imagenone','imageleft','imageright','|','simpleupload','emotion','map','gmap','pagebreak','background','|','horizontal','date','time','spechars','snapscreen','|','inserttable','deletetable','insertparagraphbeforetable','insertrow','deleterow','insertcol','deletecol','mergecells','mergeright','mergedown','splittocells','splittorows','splittocols','charts','|','print','preview','searchreplace','drafts']],zIndex:1100,enableAutoSave:false,saveInterval:50000000000,autoHeightEnabled:false,wordCount:false};function getUEBasePath(docUrl,confUrl){return getBasePath(docUrl||self.document.URL||self.location.href,confUrl||getConfigFilePath());}
function getConfigFilePath(){var configPath=document.getElementsByTagName('script');return configPath[configPath.length-1].src;}
function getBasePath(docUrl,confUrl){var basePath=confUrl;if(/^(\/|\\\\)/.test(confUrl)){basePath=/^.+?\w(\/|\\\\)/.exec(docUrl)[0]+confUrl.replace(/^(\/|\\\\)/,'');}else if(!/^[a-z]+:/i.test(confUrl)){docUrl=docUrl.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,'');basePath=docUrl+""+confUrl;}
return optimizationPath(basePath);}
function optimizationPath(path){var protocol=/^[a-z]+:\/\//.exec(path)[0],tmp=null,res=[];path=path.replace(protocol,"").split("?")[0].split("#")[0];path=path.replace(/\\/g,'/').split(/\//);path[path.length-1]="";while(path.length){if((tmp=path.shift())===".."){res.pop();}else if(tmp!=="."){res.push(tmp);}}
return protocol+res.join("/");}
window.UE={getUEBasePath:getUEBasePath};})();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor=window.UE||{};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE._customizeUI={};UE.version="1.4.3";var dom=UE.dom={};var browser=UE.browser=function(){var agent=navigator.userAgent.toLowerCase(),opera=window.opera,browser={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(agent),opera:!!opera&&opera.version,webkit:agent.indexOf(' applewebkit/')>-1,mac:agent.indexOf('macintosh')>-1,quirks:document.compatMode=='BackCompat'};browser.gecko=navigator.product=='Gecko'&&!browser.webkit&&!browser.opera&&!browser.ie;var version=0;if(browser.ie){var v1=agent.match(/(?:msie\s([\w.]+))/);var v2=agent.match(/(?:trident.*rv:([\w.]+))/);if(v1&&v2&&v1[1]&&v2[1]){version=Math.max(v1[1]*1,v2[1]*1);}else if(v1&&v1[1]){version=v1[1]*1;}else if(v2&&v2[1]){version=v2[1]*1;}else{version=0;}browser.ie11Compat=document.documentMode==11;browser.ie9Compat=document.documentMode==9;browser.ie8=!!document.documentMode;browser.ie8Compat=document.documentMode==8;browser.ie7Compat=version==7&&!document.documentMode||document.documentMode==7;browser.ie6Compat=version<7||browser.quirks;browser.ie9above=version>8;browser.ie9below=version<9;browser.ie11above=version>10;browser.ie11below=version<11;}
if(browser.gecko){var geckoRelease=agent.match(/rv:([\d\.]+)/);if(geckoRelease){geckoRelease=geckoRelease[1].split('.');version=geckoRelease[0]*10000+(geckoRelease[1]||0)*100+(geckoRelease[2]||0)*1;}}if(/chrome\/(\d+\.\d)/i.test(agent)){browser.chrome=+RegExp['\x241'];}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(agent)&&!/chrome/i.test(agent)){browser.safari=+(RegExp['\x241']||RegExp['\x242']);}
if(browser.opera)version=parseFloat(opera.version());if(browser.webkit)version=parseFloat(agent.match(/ applewebkit\/(\d+)/)[1]);browser.version=version;browser.isCompatible=!browser.mobile&&(browser.ie&&version>=6||browser.gecko&&version>=10801||browser.opera&&version>=9.5||browser.air&&version>=1||browser.webkit&&version>=522||false);return browser;}();var ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;var utils=UE.utils={each:function each(obj,iterator,context){if(obj==null)return;if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===false)return false;}}else{for(var key in obj){if(obj.hasOwnProperty(key)){if(iterator.call(context,obj[key],key,obj)===false)return false;}}}},makeInstance:function makeInstance(obj){var noop=new Function();noop.prototype=obj;obj=new noop();noop.prototype=null;return obj;},extend:function extend(t,s,b){if(s){for(var k in s){if(!b||!t.hasOwnProperty(k)){t[k]=s[k];}}}return t;},extend2:function extend2(t){var a=arguments;for(var i=1;i<a.length;i++){var x=a[i];for(var k in x){if(!t.hasOwnProperty(k)){t[k]=x[k];}}}return t;},inherits:function inherits(subClass,superClass){var oldP=subClass.prototype,newP=utils.makeInstance(superClass.prototype);utils.extend(newP,oldP,true);subClass.prototype=newP;return newP.constructor=subClass;},bind:function bind(fn,context){return function(){return fn.apply(context,arguments);};},defer:function defer(fn,delay,exclusion){var timerID;return function(){if(exclusion){clearTimeout(timerID);}timerID=setTimeout(fn,delay);};},indexOf:function indexOf(array,item,start){var index=-1;start=this.isNumber(start)?start:0;this.each(array,function(v,i){if(i>=start&&v===item){index=i;return false;}});return index;},removeItem:function removeItem(array,item){for(var i=0,l=array.length;i<l;i++){if(array[i]===item){array.splice(i,1);i--;}}},trim:function trim(str){return str.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,'');},listToMap:function listToMap(list){if(!list)return{};list=utils.isArray(list)?list:list.split(',');for(var i=0,ci,obj={};ci=list[i++];){obj[ci.toUpperCase()]=obj[ci]=1;}return obj;},unhtml:function unhtml(str,reg){return str?str.replace(reg||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(a,b){if(b){return a;}else{return{'<':'&lt;','&':'&amp;','"':'&quot;','>':'&gt;',"'":'&#39;'}[a];}}):'';},html:function html(str){return str?str.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(m){return{'&lt;':'<','&amp;':'&','&quot;':'"','&gt;':'>','&#39;':"'",'&nbsp;':' '}[m];}):'';},cssStyleToDomStyle:function(){var test=document.createElement('div').style,cache={'float':test.cssFloat!=undefined?'cssFloat':test.styleFloat!=undefined?'styleFloat':'float'};return function(cssName){return cache[cssName]||(cache[cssName]=cssName.toLowerCase().replace(/-./g,function(match){return match.charAt(1).toUpperCase();}));};}(),loadFile:function(){var tmpList=[];function getItem(doc,obj){try{for(var i=0,ci;ci=tmpList[i++];){if(ci.doc===doc&&ci.url==(obj.src||obj.href)){return ci;}}}catch(e){return null;}}return function(doc,obj,fn){var item=getItem(doc,obj);if(item){if(item.ready){fn&&fn();}else{item.funs.push(fn);}return;}tmpList.push({doc:doc,url:obj.src||obj.href,funs:[fn]});if(!doc.body){var html=[];for(var p in obj){if(p=='tag')continue;html.push(p+'="'+obj[p]+'"');}doc.write('<'+obj.tag+' '+html.join(' ')+' ></'+obj.tag+'>');return;}if(obj.id&&doc.getElementById(obj.id)){return;}var element=doc.createElement(obj.tag);delete obj.tag;for(var p in obj){element.setAttribute(p,obj[p]);}element.onload=element.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){item=getItem(doc,obj);if(item.funs.length>0){item.ready=1;for(var fi;fi=item.funs.pop();){fi();}}element.onload=element.onreadystatechange=null;}};element.onerror=function(){throw Error('The load '+(obj.href||obj.src)+' fails,check the url settings of file ueditor.config.js ');};doc.getElementsByTagName("head")[0].appendChild(element);};}(),isEmptyObject:function isEmptyObject(obj){if(obj==null)return true;if(this.isArray(obj)||this.isString(obj))return obj.length===0;for(var key in obj){if(obj.hasOwnProperty(key))return false;}return true;},fixColor:function fixColor(name,value){if(/color/i.test(name)&&/rgba?/.test(value)){var array=value.split(",");if(array.length>3)return"";value="#";for(var i=0,color;color=array[i++];){color=parseInt(color.replace(/[^\d]/gi,''),10).toString(16);value+=color.length==1?"0"+color:color;}value=value.toUpperCase();}return value;},optCss:function optCss(val){var padding,margin,border;val=val.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(str,key,name,val){if(val.split(' ').length==1){switch(key){case'padding':!padding&&(padding={});padding[name]=val;return'';case'margin':!margin&&(margin={});margin[name]=val;return'';case'border':return val=='initial'?'':str;}}return str;});function opt(obj,name){if(!obj){return'';}var t=obj.top,b=obj.bottom,l=obj.left,r=obj.right,val='';if(!t||!l||!b||!r){for(var p in obj){val+=';'+name+'-'+p+':'+obj[p]+';';}}else{val+=';'+name+':'+(t==b&&b==l&&l==r?t:t==b&&l==r?t+' '+l:l==r?t+' '+l+' '+b:t+' '+r+' '+b+' '+l)+';';}return val;}val+=opt(padding,'padding')+opt(margin,'margin');return val.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,'').replace(/;([ \n\r\t]+)|\1;/g,';').replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(a,b){return b?b+";;":';';});},clone:function clone(source,target){var tmp;target=target||{};for(var i in source){if(source.hasOwnProperty(i)){tmp=source[i];if((typeof tmp==='undefined'?'undefined':_typeof(tmp))=='object'){target[i]=utils.isArray(tmp)?[]:{};utils.clone(source[i],target[i]);}else{target[i]=tmp;}}}return target;},transUnitToPx:function transUnitToPx(val){if(!/(pt|cm)/.test(val)){return val;}var unit;val.replace(/([\d.]+)(\w+)/,function(str,v,u){val=v;unit=u;});switch(unit){case'cm':val=parseFloat(val)*25;break;case'pt':val=Math.round(parseFloat(val)*96/72);}return val+(val?'px':'');},domReady:function(){var fnArr=[];function doReady(doc){doc.isReady=true;for(var ci;ci=fnArr.pop();ci()){}}return function(onready,win){win=win||window;var doc=win.document;onready&&fnArr.push(onready);if(doc.readyState==="complete"){doReady(doc);}else{doc.isReady&&doReady(doc);if(browser.ie&&browser.version!=11){(function(){if(doc.isReady)return;try{doc.documentElement.doScroll("left");}catch(error){setTimeout(arguments.callee,0);return;}doReady(doc);})();win.attachEvent('onload',function(){doReady(doc);});}else{doc.addEventListener("DOMContentLoaded",function(){doc.removeEventListener("DOMContentLoaded",arguments.callee,false);doReady(doc);},false);win.addEventListener('load',function(){doReady(doc);},false);}}};}(),cssRule:browser.ie&&browser.version!=11?function(key,style,doc){var indexList,index;if(style===undefined||style&&style.nodeType&&style.nodeType==9){doc=style&&style.nodeType&&style.nodeType==9?style:doc||document;indexList=doc.indexList||(doc.indexList={});index=indexList[key];if(index!==undefined){return doc.styleSheets[index].cssText;}return undefined;}doc=doc||document;indexList=doc.indexList||(doc.indexList={});index=indexList[key];if(style===''){if(index!==undefined){doc.styleSheets[index].cssText='';delete indexList[key];return true;}return false;}
if(index!==undefined){sheetStyle=doc.styleSheets[index];}else{sheetStyle=doc.createStyleSheet('',index=doc.styleSheets.length);indexList[key]=index;}sheetStyle.cssText=style;}:function(key,style,doc){var head,node;if(style===undefined||style&&style.nodeType&&style.nodeType==9){doc=style&&style.nodeType&&style.nodeType==9?style:doc||document;node=doc.getElementById(key);return node?node.innerHTML:undefined;}doc=doc||document;node=doc.getElementById(key);if(style===''){if(node){node.parentNode.removeChild(node);return true;}return false;}
if(node){node.innerHTML=style;}else{node=doc.createElement('style');node.id=key;node.innerHTML=style;doc.getElementsByTagName('head')[0].appendChild(node);}},sort:function sort(array,compareFn){compareFn=compareFn||function(item1,item2){return item1.localeCompare(item2);};for(var i=0,len=array.length;i<len;i++){for(var j=i,length=array.length;j<length;j++){if(compareFn(array[i],array[j])>0){var t=array[i];array[i]=array[j];array[j]=t;}}}return array;},serializeParam:function serializeParam(json){var strArr=[];for(var i in json){if(i=="method"||i=="timeout"||i=="async")continue;if(!(_typeof(json[i]).toLowerCase()=="function"||_typeof(json[i]).toLowerCase()=="object")){strArr.push(encodeURIComponent(i)+"="+encodeURIComponent(json[i]));}else if(utils.isArray(json[i])){for(var j=0;j<json[i].length;j++){strArr.push(encodeURIComponent(i)+"[]="+encodeURIComponent(json[i][j]));}}}return strArr.join("&");},formatUrl:function formatUrl(url){var u=url.replace(/&&/g,'&');u=u.replace(/\?&/g,'?');u=u.replace(/&$/g,'');u=u.replace(/&#/g,'#');u=u.replace(/&+/g,'&');return u;},isCrossDomainUrl:function isCrossDomainUrl(url){var a=document.createElement('a');a.href=url;if(browser.ie){a.href=a.href;}return!(a.protocol==location.protocol&&a.hostname==location.hostname&&(a.port==location.port||a.port=='80'&&location.port==''||a.port==''&&location.port=='80'));},clearEmptyAttrs:function clearEmptyAttrs(obj){for(var p in obj){if(obj[p]===''){delete obj[p];}}return obj;},str2json:function str2json(s){if(!utils.isString(s))return null;if(window.JSON){return JSON.parse(s);}else{return new Function("return "+utils.trim(s||''))();}},json2str:function(){if(window.JSON){return JSON.stringify;}else{var escapeMap;var _ret=function(){var encodeString=function encodeString(source){if(/["\\\x00-\x1f]/.test(source)){source=source.replace(/["\\\x00-\x1f]/g,function(match){var c=escapeMap[match];if(c){return c;}c=match.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);});}return'"'+source+'"';};var encodeArray=function encodeArray(source){var result=["["],l=source.length,preComma,i,item;for(i=0;i<l;i++){item=source[i];switch(typeof item==='undefined'?'undefined':_typeof(item)){case"undefined":case"function":case"unknown":break;default:if(preComma){result.push(',');}result.push(utils.json2str(item));preComma=1;}}result.push("]");return result.join("");};var pad=function pad(source){return source<10?'0'+source:source;};var encodeDate=function encodeDate(source){return'"'+source.getFullYear()+"-"+pad(source.getMonth()+1)+"-"+pad(source.getDate())+"T"+pad(source.getHours())+":"+pad(source.getMinutes())+":"+pad(source.getSeconds())+'"';};escapeMap={"\b":'\\b',"\t":'\\t',"\n":'\\n',"\f":'\\f',"\r":'\\r','"':'\\"',"\\":'\\\\'};return{v:function v(value){switch(typeof value==='undefined'?'undefined':_typeof(value)){case'undefined':return'undefined';case'number':return isFinite(value)?String(value):"null";case'string':return encodeString(value);case'boolean':return String(value);default:if(value===null){return'null';}else if(utils.isArray(value)){return encodeArray(value);}else if(utils.isDate(value)){return encodeDate(value);}else{var result=['{'],encode=utils.json2str,preComma,item;for(var key in value){if(Object.prototype.hasOwnProperty.call(value,key)){item=value[key];switch(typeof item==='undefined'?'undefined':_typeof(item)){case'undefined':case'unknown':case'function':break;default:if(preComma){result.push(',');}preComma=1;result.push(encode(key)+':'+encode(item));}}}result.push('}');return result.join('');}}}};}();if((typeof _ret==='undefined'?'undefined':_typeof(_ret))==="object")return _ret.v;}}()};utils.each(['String','Function','Array','Number','RegExp','Object','Date'],function(v){UE.utils['is'+v]=function(obj){return Object.prototype.toString.apply(obj)=='[object '+v+']';};});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function addListener(types,listener){types=utils.trim(types).split(/\s+/);for(var i=0,ti;ti=types[i++];){getListener(this,ti,true).push(listener);}},on:function on(types,listener){return this.addListener(types,listener);},off:function off(types,listener){return this.removeListener(types,listener);},trigger:function trigger(){return this.fireEvent.apply(this,arguments);},removeListener:function removeListener(types,listener){types=utils.trim(types).split(/\s+/);for(var i=0,ti;ti=types[i++];){utils.removeItem(getListener(this,ti)||[],listener);}},fireEvent:function fireEvent(){var types=arguments[0];types=utils.trim(types).split(' ');for(var i=0,ti;ti=types[i++];){var listeners=getListener(this,ti),r,t,k;if(listeners){k=listeners.length;while(k--){if(!listeners[k])continue;t=listeners[k].apply(this,arguments);if(t===true){return t;}if(t!==undefined){r=t;}}}if(t=this['on'+ti.toLowerCase()]){r=t.apply(this,arguments);}}return r;}};function getListener(obj,type,force){var allListeners;type=type.toLowerCase();return(allListeners=obj.__allListeners||force&&(obj.__allListeners={}))&&(allListeners[type]||force&&(allListeners[type]=[]));}
var dtd=dom.dtd=function(){function _(s){for(var k in s){s[k.toUpperCase()]=s[k];}return s;}var X=utils.extend2;var A=_({isindex:1,fieldset:1}),B=_({input:1,button:1,select:1,textarea:1,label:1}),C=X(_({a:1}),B),D=X({iframe:1},C),E=_({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),F=_({ins:1,del:1,script:1,style:1}),G=X(_({b:1,acronym:1,bdo:1,'var':1,'#':1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),F),H=X(_({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),G),I=X(_({p:1}),H),J=X(_({iframe:1}),H,B),K=_({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,'#':1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,'var':1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),L=X(_({a:0}),J),M=_({tr:1}),N=_({'#':1}),O=X(_({param:1}),K),P=X(_({form:1}),A,D,E,I),Q=_({li:1,ol:1,ul:1}),R=_({style:1,script:1}),S=_({base:1,link:1,meta:1,title:1}),T=X(S,R),U=_({head:1,body:1}),V=_({html:1});var block=_({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),empty=_({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return _({$nonBodyContent:X(V,U,S),$block:block,$inline:L,$inlineWithA:X(_({a:1}),L),$body:X(_({script:1,style:1}),block),$cdata:_({script:1,style:1}),$empty:empty,$nonChild:_({iframe:1,textarea:1}),$listItem:_({dd:1,dt:1,li:1}),$list:_({ul:1,ol:1,dl:1}),$isNotEmpty:_({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:_({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,'var':1}),$removeEmptyBlock:_({'p':1,'div':1}),$tableContent:_({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:_({pre:1,script:1,style:1,textarea:1}),html:U,head:T,style:N,script:N,body:P,base:{},link:{},meta:{},title:N,col:{},tr:_({td:1,th:1}),img:{},embed:{},colgroup:_({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:P,td:P,br:{},th:P,center:P,kbd:L,button:X(I,E),basefont:{},h5:L,h4:L,samp:L,h6:L,ol:Q,h1:L,h3:L,option:N,h2:L,form:X(A,D,E,I),select:_({optgroup:1,option:1}),font:L,ins:L,menu:Q,abbr:L,label:L,table:_({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:L,tfoot:M,cite:L,li:P,input:{},iframe:P,strong:L,textarea:N,noframes:P,big:L,small:L,span:_({'#':1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:L,dt:L,sub:L,optgroup:_({option:1}),param:{},bdo:L,'var':L,div:P,object:O,sup:L,dd:P,strike:L,area:{},dir:Q,map:X(_({area:1,form:1,p:1}),A,F,E),applet:O,dl:_({dt:1,dd:1}),del:L,isindex:{},fieldset:X(_({legend:1}),K),thead:M,ul:Q,acronym:L,b:L,a:X(_({a:1}),J),blockquote:X(_({td:1,tr:1,tbody:1,li:1}),P),caption:L,i:L,u:L,tbody:M,s:L,address:X(D,I),tt:L,legend:L,q:L,pre:X(G,C),p:X(_({'a':1}),L),em:L,dfn:L});}();function getDomNode(node,start,ltr,startFromChild,fn,guard){var tmpNode=startFromChild&&node[start],parent;!tmpNode&&(tmpNode=node[ltr]);while(!tmpNode&&(parent=(parent||node).parentNode)){if(parent.tagName=='BODY'||guard&&!guard(parent)){return null;}tmpNode=parent[ltr];}if(tmpNode&&fn&&!fn(tmpNode)){return getDomNode(tmpNode,start,ltr,false,fn);}return tmpNode;}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(['-webkit-box','-moz-box','block','list-item','table','table-row-group','table-header-group','table-footer-group','table-row','table-column-group','table-column','table-cell','table-caption']);var domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=='6'?'\uFEFF':'\u200B',keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function getPosition(nodeA,nodeB){if(nodeA===nodeB){return 0;}var node,parentsA=[nodeA],parentsB=[nodeB];node=nodeA;while(node=node.parentNode){if(node===nodeB){return 10;}parentsA.push(node);}node=nodeB;while(node=node.parentNode){if(node===nodeA){return 20;}parentsB.push(node);}parentsA.reverse();parentsB.reverse();if(parentsA[0]!==parentsB[0]){return 1;}var i=-1;while(i++,parentsA[i]===parentsB[i]){}nodeA=parentsA[i];nodeB=parentsB[i];while(nodeA=nodeA.nextSibling){if(nodeA===nodeB){return 4;}}
return 2;},getNodeIndex:function getNodeIndex(node,ignoreTextNode){var preNode=node,i=0;while(preNode=preNode.previousSibling){if(ignoreTextNode&&preNode.nodeType==3){if(preNode.nodeType!=preNode.nextSibling.nodeType){i++;}continue;}i++;}return i;},inDoc:function inDoc(node,doc){return domUtils.getPosition(node,doc)==10;},findParent:function findParent(node,filterFn,includeSelf){if(node&&!domUtils.isBody(node)){node=includeSelf?node:node.parentNode;while(node){if(!filterFn||filterFn(node)||domUtils.isBody(node)){return filterFn&&!filterFn(node)&&domUtils.isBody(node)?null:node;}node=node.parentNode;}}return null;},findParentByTagName:function findParentByTagName(node,tagNames,includeSelf,excludeFn){tagNames=utils.listToMap(utils.isArray(tagNames)?tagNames:[tagNames]);return domUtils.findParent(node,function(node){return tagNames[node.tagName]&&!(excludeFn&&excludeFn(node));},includeSelf);},findParents:function findParents(node,includeSelf,filterFn,closerFirst){var parents=includeSelf&&(filterFn&&filterFn(node)||!filterFn)?[node]:[];while(node=domUtils.findParent(node,filterFn)){parents.push(node);}return closerFirst?parents:parents.reverse();},insertAfter:function insertAfter(node,newNode){return node.nextSibling?node.parentNode.insertBefore(newNode,node.nextSibling):node.parentNode.appendChild(newNode);},remove:function remove(node,keepChildren){var parent=node.parentNode,child;if(parent){if(keepChildren&&node.hasChildNodes()){while(child=node.firstChild){parent.insertBefore(child,node);}}parent.removeChild(node);}return node;},getNextDomNode:function getNextDomNode(node,startFromChild,filterFn,guard){return getDomNode(node,'firstChild','nextSibling',startFromChild,filterFn,guard);},getPreDomNode:function getPreDomNode(node,startFromChild,filterFn,guard){return getDomNode(node,'lastChild','previousSibling',startFromChild,filterFn,guard);},isBookmarkNode:function isBookmarkNode(node){return node.nodeType==1&&node.id&&/^_baidu_bookmark_/i.test(node.id);},getWindow:function getWindow(node){var doc=node.ownerDocument||node;return doc.defaultView||doc.parentWindow;},getCommonAncestor:function getCommonAncestor(nodeA,nodeB){if(nodeA===nodeB)return nodeA;var parentsA=[nodeA],parentsB=[nodeB],parent=nodeA,i=-1;while(parent=parent.parentNode){if(parent===nodeB){return parent;}parentsA.push(parent);}parent=nodeB;while(parent=parent.parentNode){if(parent===nodeA)return parent;parentsB.push(parent);}parentsA.reverse();parentsB.reverse();while(i++,parentsA[i]===parentsB[i]){}return i==0?null:parentsA[i-1];},clearEmptySibling:function clearEmptySibling(node,ignoreNext,ignorePre){function clear(next,dir){var tmpNode;while(next&&!domUtils.isBookmarkNode(next)&&(domUtils.isEmptyInlineElement(next)||!new RegExp('[^\t\n\r'+domUtils.fillChar+']').test(next.nodeValue))){tmpNode=next[dir];domUtils.remove(next);next=tmpNode;}}!ignoreNext&&clear(node.nextSibling,'nextSibling');!ignorePre&&clear(node.previousSibling,'previousSibling');},split:function split(node,offset){var doc=node.ownerDocument;if(browser.ie&&offset==node.nodeValue.length){var next=doc.createTextNode('');return domUtils.insertAfter(node,next);}var retval=node.splitText(offset);if(browser.ie8){var tmpNode=doc.createTextNode('');domUtils.insertAfter(retval,tmpNode);domUtils.remove(tmpNode);}return retval;},isWhitespace:function isWhitespace(node){return!new RegExp('[^ \t\n\r'+domUtils.fillChar+']').test(node.nodeValue);},getXY:function getXY(element){var x=0,y=0;while(element.offsetParent){y+=element.offsetTop;x+=element.offsetLeft;element=element.offsetParent;}return{'x':x,'y':y};},on:function on(element,type,handler){var types=utils.isArray(type)?type:utils.trim(type).split(/\s+/),k=types.length;if(k)while(k--){type=types[k];if(element.addEventListener){element.addEventListener(type,handler,false);}else{if(!handler._d){handler._d={els:[]};}var key=type+handler.toString(),index=utils.indexOf(handler._d.els,element);if(!handler._d[key]||index==-1){if(index==-1){handler._d.els.push(element);}if(!handler._d[key]){handler._d[key]=function(evt){return handler.call(evt.srcElement,evt||window.event);};}element.attachEvent('on'+type,handler._d[key]);}}}element=null;},un:function un(element,type,handler){var types=utils.isArray(type)?type:utils.trim(type).split(/\s+/),k=types.length;if(k)while(k--){type=types[k];if(element.removeEventListener){element.removeEventListener(type,handler,false);}else{var key=type+handler.toString();try{element.detachEvent('on'+type,handler._d?handler._d[key]:handler);}catch(e){}if(handler._d&&handler._d[key]){var index=utils.indexOf(handler._d.els,element);if(index!=-1){handler._d.els.splice(index,1);}handler._d.els.length==0&&delete handler._d[key];}}}},isSameElement:function isSameElement(nodeA,nodeB){if(nodeA.tagName!=nodeB.tagName){return false;}var thisAttrs=nodeA.attributes,otherAttrs=nodeB.attributes;if(!ie&&thisAttrs.length!=otherAttrs.length){return false;}var attrA,attrB,al=0,bl=0;for(var i=0;attrA=thisAttrs[i++];){if(attrA.nodeName=='style'){if(attrA.specified){al++;}if(domUtils.isSameStyle(nodeA,nodeB)){continue;}else{return false;}}if(ie){if(attrA.specified){al++;attrB=otherAttrs.getNamedItem(attrA.nodeName);}else{continue;}}else{attrB=nodeB.attributes[attrA.nodeName];}if(!attrB.specified||attrA.nodeValue!=attrB.nodeValue){return false;}}
if(ie){for(i=0;attrB=otherAttrs[i++];){if(attrB.specified){bl++;}}if(al!=bl){return false;}}return true;},isSameStyle:function isSameStyle(nodeA,nodeB){var styleA=nodeA.style.cssText.replace(/( ?; ?)/g,';').replace(/( ?: ?)/g,':'),styleB=nodeB.style.cssText.replace(/( ?; ?)/g,';').replace(/( ?: ?)/g,':');if(browser.opera){styleA=nodeA.style;styleB=nodeB.style;if(styleA.length!=styleB.length)return false;for(var p in styleA){if(/^(\d+|csstext)$/i.test(p)){continue;}if(styleA[p]!=styleB[p]){return false;}}return true;}if(!styleA||!styleB){return styleA==styleB;}styleA=styleA.split(';');styleB=styleB.split(';');if(styleA.length!=styleB.length){return false;}for(var i=0,ci;ci=styleA[i++];){if(utils.indexOf(styleB,ci)==-1){return false;}}return true;},isBlockElm:function isBlockElm(node){return node.nodeType==1&&(dtd.$block[node.tagName]||styleBlock[domUtils.getComputedStyle(node,'display')])&&!dtd.$nonChild[node.tagName];},isBody:function isBody(node){return node&&node.nodeType==1&&node.tagName.toLowerCase()=='body';},breakParent:function breakParent(node,parent){var tmpNode,parentClone=node,clone=node,leftNodes,rightNodes;do{parentClone=parentClone.parentNode;if(leftNodes){tmpNode=parentClone.cloneNode(false);tmpNode.appendChild(leftNodes);leftNodes=tmpNode;tmpNode=parentClone.cloneNode(false);tmpNode.appendChild(rightNodes);rightNodes=tmpNode;}else{leftNodes=parentClone.cloneNode(false);rightNodes=leftNodes.cloneNode(false);}while(tmpNode=clone.previousSibling){leftNodes.insertBefore(tmpNode,leftNodes.firstChild);}while(tmpNode=clone.nextSibling){rightNodes.appendChild(tmpNode);}clone=parentClone;}while(parent!==parentClone);tmpNode=parent.parentNode;tmpNode.insertBefore(leftNodes,parent);tmpNode.insertBefore(rightNodes,parent);tmpNode.insertBefore(node,rightNodes);domUtils.remove(parent);return node;},isEmptyInlineElement:function isEmptyInlineElement(node){if(node.nodeType!=1||!dtd.$removeEmpty[node.tagName]){return 0;}node=node.firstChild;while(node){if(domUtils.isBookmarkNode(node)){return 0;}if(node.nodeType==1&&!domUtils.isEmptyInlineElement(node)||node.nodeType==3&&!domUtils.isWhitespace(node)){return 0;}node=node.nextSibling;}return 1;},trimWhiteTextNode:function trimWhiteTextNode(node){function remove(dir){var child;while((child=node[dir])&&child.nodeType==3&&domUtils.isWhitespace(child)){node.removeChild(child);}}remove('firstChild');remove('lastChild');},mergeChild:function mergeChild(node,tagName,attrs){var list=domUtils.getElementsByTagName(node,node.tagName.toLowerCase());for(var i=0,ci;ci=list[i++];){if(!ci.parentNode||domUtils.isBookmarkNode(ci)){continue;}
if(ci.tagName.toLowerCase()=='span'){if(node===ci.parentNode){domUtils.trimWhiteTextNode(node);if(node.childNodes.length==1){node.style.cssText=ci.style.cssText+";"+node.style.cssText;domUtils.remove(ci,true);continue;}}ci.style.cssText=node.style.cssText+';'+ci.style.cssText;if(attrs){var style=attrs.style;if(style){style=style.split(';');for(var j=0,s;s=style[j++];){ci.style[utils.cssStyleToDomStyle(s.split(':')[0])]=s.split(':')[1];}}}if(domUtils.isSameStyle(ci,node)){domUtils.remove(ci,true);}continue;}if(domUtils.isSameElement(node,ci)){domUtils.remove(ci,true);}}},getElementsByTagName:function getElementsByTagName(node,name,filter){if(filter&&utils.isString(filter)){var className=filter;filter=function filter(node){return domUtils.hasClass(node,className);};}name=utils.trim(name).replace(/[ ]{2,}/g,' ').split(' ');var arr=[];for(var n=0,ni;ni=name[n++];){var list=node.getElementsByTagName(ni);for(var i=0,ci;ci=list[i++];){if(!filter||filter(ci))arr.push(ci);}}return arr;},mergeToParent:function mergeToParent(node){var parent=node.parentNode;while(parent&&dtd.$removeEmpty[parent.tagName]){if(parent.tagName==node.tagName||parent.tagName=='A'){domUtils.trimWhiteTextNode(parent);if(parent.tagName=='SPAN'&&!domUtils.isSameStyle(parent,node)||parent.tagName=='A'&&node.tagName=='SPAN'){if(parent.childNodes.length>1||parent!==node.parentNode){node.style.cssText=parent.style.cssText+";"+node.style.cssText;parent=parent.parentNode;continue;}else{parent.style.cssText+=";"+node.style.cssText;if(parent.tagName=='A'){parent.style.textDecoration='underline';}}}if(parent.tagName!='A'){parent===node.parentNode&&domUtils.remove(node,true);break;}}parent=parent.parentNode;}},mergeSibling:function mergeSibling(node,ignorePre,ignoreNext){function merge(rtl,start,node){var next;if((next=node[rtl])&&!domUtils.isBookmarkNode(next)&&next.nodeType==1&&domUtils.isSameElement(node,next)){while(next.firstChild){if(start=='firstChild'){node.insertBefore(next.lastChild,node.firstChild);}else{node.appendChild(next.firstChild);}}domUtils.remove(next);}}!ignorePre&&merge('previousSibling','firstChild',node);!ignoreNext&&merge('nextSibling','lastChild',node);},unSelectable:ie&&browser.ie9below||browser.opera?function(node){node.onselectstart=function(){return false;};node.onclick=node.onkeyup=node.onkeydown=function(){return false;};node.unselectable='on';node.setAttribute("unselectable","on");for(var i=0,ci;ci=node.all[i++];){switch(ci.tagName.toLowerCase()){case'iframe':case'textarea':case'input':case'select':break;default:ci.unselectable='on';node.setAttribute("unselectable","on");}}}:function(node){node.style.MozUserSelect=node.style.webkitUserSelect=node.style.msUserSelect=node.style.KhtmlUserSelect='none';},removeAttributes:function removeAttributes(node,attrNames){attrNames=utils.isArray(attrNames)?attrNames:utils.trim(attrNames).replace(/[ ]{2,}/g,' ').split(' ');for(var i=0,ci;ci=attrNames[i++];){ci=attrFix[ci]||ci;switch(ci){case'className':node[ci]='';break;case'style':node.style.cssText='';var val=node.getAttributeNode('style');!browser.ie&&val&&node.removeAttributeNode(val);}node.removeAttribute(ci);}},createElement:function createElement(doc,tag,attrs){return domUtils.setAttributes(doc.createElement(tag),attrs);},setAttributes:function setAttributes(node,attrs){for(var attr in attrs){if(attrs.hasOwnProperty(attr)){var value=attrs[attr];switch(attr){case'class':node.className=value;break;case'style':node.style.cssText=node.style.cssText+";"+value;break;case'innerHTML':node[attr]=value;break;case'value':node.value=value;break;default:node.setAttribute(attrFix[attr]||attr,value);}}}return node;},getComputedStyle:function getComputedStyle(element,styleName){var pros='width height top left';if(pros.indexOf(styleName)>-1){return element['offset'+styleName.replace(/^\w/,function(s){return s.toUpperCase();})]+'px';}
if(element.nodeType==3){element=element.parentNode;}
if(browser.ie&&browser.version<9&&styleName=='font-size'&&!element.style.fontSize&&!dtd.$empty[element.tagName]&&!dtd.$nonChild[element.tagName]){var span=element.ownerDocument.createElement('span');span.style.cssText='padding:0;border:0;font-family:simsun;';span.innerHTML='.';element.appendChild(span);var result=span.offsetHeight;element.removeChild(span);span=null;return result+'px';}try{var value=domUtils.getStyle(element,styleName)||(window.getComputedStyle?domUtils.getWindow(element).getComputedStyle(element,'').getPropertyValue(styleName):(element.currentStyle||element.style)[utils.cssStyleToDomStyle(styleName)]);}catch(e){return"";}return utils.transUnitToPx(utils.fixColor(styleName,value));},removeClasses:function removeClasses(elm,classNames){classNames=utils.isArray(classNames)?classNames:utils.trim(classNames).replace(/[ ]{2,}/g,' ').split(' ');for(var i=0,ci,cls=elm.className;ci=classNames[i++];){cls=cls.replace(new RegExp('\\b'+ci+'\\b'),'');}cls=utils.trim(cls).replace(/[ ]{2,}/g,' ');if(cls){elm.className=cls;}else{domUtils.removeAttributes(elm,['class']);}},addClass:function addClass(elm,classNames){if(!elm)return;classNames=utils.trim(classNames).replace(/[ ]{2,}/g,' ').split(' ');for(var i=0,ci,cls=elm.className;ci=classNames[i++];){if(!new RegExp('\\b'+ci+'\\b').test(cls)){cls+=' '+ci;}}elm.className=utils.trim(cls);},hasClass:function hasClass(element,className){if(utils.isRegExp(className)){return className.test(element.className);}className=utils.trim(className).replace(/[ ]{2,}/g,' ').split(' ');for(var i=0,ci,cls=element.className;ci=className[i++];){if(!new RegExp('\\b'+ci+'\\b','i').test(cls)){return false;}}return i-1==className.length;},preventDefault:function preventDefault(evt){evt.preventDefault?evt.preventDefault():evt.returnValue=false;},removeStyle:function removeStyle(element,name){if(browser.ie){if(name=='color'){name='(^|;)'+name;}element.style.cssText=element.style.cssText.replace(new RegExp(name+'[^:]*:[^;]+;?','ig'),'');}else{if(element.style.removeProperty){element.style.removeProperty(name);}else{element.style.removeAttribute(utils.cssStyleToDomStyle(name));}}if(!element.style.cssText){domUtils.removeAttributes(element,['style']);}},getStyle:function getStyle(element,name){var value=element.style[utils.cssStyleToDomStyle(name)];return utils.fixColor(name,value);},setStyle:function setStyle(element,name,value){element.style[utils.cssStyleToDomStyle(name)]=value;if(!utils.trim(element.style.cssText)){this.removeAttributes(element,'style');}},setStyles:function setStyles(element,styles){for(var name in styles){if(styles.hasOwnProperty(name)){domUtils.setStyle(element,name,styles[name]);}}},removeDirtyAttr:function removeDirtyAttr(node){for(var i=0,ci,nodes=node.getElementsByTagName('*');ci=nodes[i++];){ci.removeAttribute('_moz_dirty');}node.removeAttribute('_moz_dirty');},getChildCount:function getChildCount(node,fn){var count=0,first=node.firstChild;fn=fn||function(){return 1;};while(first){if(fn(first)){count++;}first=first.nextSibling;}return count;},isEmptyNode:function isEmptyNode(node){return!node.firstChild||domUtils.getChildCount(node,function(node){return!domUtils.isBr(node)&&!domUtils.isBookmarkNode(node)&&!domUtils.isWhitespace(node);})==0;},clearSelectedArr:function clearSelectedArr(nodes){var node;while(node=nodes.pop()){domUtils.removeAttributes(node,['class']);}},scrollToView:function scrollToView(node,win,offsetTop){var getViewPaneSize=function getViewPaneSize(){var doc=win.document,mode=doc.compatMode=='CSS1Compat';return{width:(mode?doc.documentElement.clientWidth:doc.body.clientWidth)||0,height:(mode?doc.documentElement.clientHeight:doc.body.clientHeight)||0};},getScrollPosition=function getScrollPosition(win){if('pageXOffset'in win){return{x:win.pageXOffset||0,y:win.pageYOffset||0};}else{var doc=win.document;return{x:doc.documentElement.scrollLeft||doc.body.scrollLeft||0,y:doc.documentElement.scrollTop||doc.body.scrollTop||0};}};var winHeight=getViewPaneSize().height,offset=winHeight*-1+offsetTop;offset+=node.offsetHeight||0;var elementPosition=domUtils.getXY(node);offset+=elementPosition.y;var currentScroll=getScrollPosition(win).y;if(offset>currentScroll||offset<currentScroll-winHeight){win.scrollTo(0,offset+(offset<0?-20:20));}},isBr:function isBr(node){return node.nodeType==1&&node.tagName=='BR';},isFillChar:function isFillChar(node,isInStart){if(node.nodeType!=3)return false;var text=node.nodeValue;if(isInStart){return new RegExp('^'+domUtils.fillChar).test(text);}return!text.replace(new RegExp(domUtils.fillChar,'g'),'').length;},isStartInblock:function isStartInblock(range){var tmpRange=range.cloneRange(),flag=0,start=tmpRange.startContainer,tmp;if(start.nodeType==1&&start.childNodes[tmpRange.startOffset]){start=start.childNodes[tmpRange.startOffset];var pre=start.previousSibling;while(pre&&domUtils.isFillChar(pre)){start=pre;pre=pre.previousSibling;}}if(this.isFillChar(start,true)&&tmpRange.startOffset==1){tmpRange.setStartBefore(start);start=tmpRange.startContainer;}while(start&&domUtils.isFillChar(start)){tmp=start;start=start.previousSibling;}if(tmp){tmpRange.setStartBefore(tmp);start=tmpRange.startContainer;}if(start.nodeType==1&&domUtils.isEmptyNode(start)&&tmpRange.startOffset==1){tmpRange.setStart(start,0).collapse(true);}while(!tmpRange.startOffset){start=tmpRange.startContainer;if(domUtils.isBlockElm(start)||domUtils.isBody(start)){flag=1;break;}var pre=tmpRange.startContainer.previousSibling,tmpNode;if(!pre){tmpRange.setStartBefore(tmpRange.startContainer);}else{while(pre&&domUtils.isFillChar(pre)){tmpNode=pre;pre=pre.previousSibling;}if(tmpNode){tmpRange.setStartBefore(tmpNode);}else{tmpRange.setStartBefore(tmpRange.startContainer);}}}return flag&&!domUtils.isBody(tmpRange.startContainer)?1:0;},isEmptyBlock:function isEmptyBlock(node,reg){if(node.nodeType!=1)return 0;reg=reg||new RegExp('[ \xa0\t\r\n'+domUtils.fillChar+']','g');if(node[browser.ie?'innerText':'textContent'].replace(reg,'').length>0){return 0;}for(var n in dtd.$isNotEmpty){if(node.getElementsByTagName(n).length){return 0;}}return 1;},setViewportOffset:function setViewportOffset(element,offset){var left=parseInt(element.style.left)|0;var top=parseInt(element.style.top)|0;var rect=element.getBoundingClientRect();var offsetLeft=offset.left-rect.left;var offsetTop=offset.top-rect.top;if(offsetLeft){element.style.left=left+offsetLeft+'px';}if(offsetTop){element.style.top=top+offsetTop+'px';}},fillNode:function fillNode(doc,node){var tmpNode=browser.ie?doc.createTextNode(domUtils.fillChar):doc.createElement('br');node.innerHTML='';node.appendChild(tmpNode);},moveChild:function moveChild(src,tag,dir){while(src.firstChild){if(dir&&tag.firstChild){tag.insertBefore(src.lastChild,tag.firstChild);}else{tag.appendChild(src.firstChild);}}},hasNoAttributes:function hasNoAttributes(node){return browser.ie?/^<\w+\s*?>/.test(node.outerHTML):node.attributes.length==0;},isCustomeNode:function isCustomeNode(node){return node.nodeType==1&&node.getAttribute('_ue_custom_node_');},isTagNode:function isTagNode(node,tagNames){return node.nodeType==1&&new RegExp('\\b'+node.tagName+'\\b','i').test(tagNames);},filterNodeList:function filterNodeList(nodelist,filter,forAll){var results=[];if(!utils.isFunction(filter)){var str=filter;filter=function filter(n){return utils.indexOf(utils.isArray(str)?str:str.split(' '),n.tagName.toLowerCase())!=-1;};}utils.each(nodelist,function(n){filter(n)&&results.push(n);});return results.length==0?null:results.length==1||!forAll?results[0]:results;},isInNodeEndBoundary:function isInNodeEndBoundary(rng,node){var start=rng.startContainer;if(start.nodeType==3&&rng.startOffset!=start.nodeValue.length){return 0;}if(start.nodeType==1&&rng.startOffset!=start.childNodes.length){return 0;}while(start!==node){if(start.nextSibling){return 0;};start=start.parentNode;}return 1;},isBoundaryNode:function isBoundaryNode(node,dir){var tmp;while(!domUtils.isBody(node)){tmp=node;node=node.parentNode;if(tmp!==node[dir]){return false;}}return true;},fillHtml:browser.ie11below?'&nbsp;':'<br/>'};var fillCharReg=new RegExp(domUtils.fillChar,'g');(function(){var guid=0,fillChar=domUtils.fillChar,fillData;function updateCollapse(range){range.collapsed=range.startContainer&&range.endContainer&&range.startContainer===range.endContainer&&range.startOffset==range.endOffset;}function selectOneNode(rng){return!rng.collapsed&&rng.startContainer.nodeType==1&&rng.startContainer===rng.endContainer&&rng.endOffset-rng.startOffset==1;}function setEndPoint(toStart,node,offset,range){if(node.nodeType==1&&(dtd.$empty[node.tagName]||dtd.$nonChild[node.tagName])){offset=domUtils.getNodeIndex(node)+(toStart?0:1);node=node.parentNode;}if(toStart){range.startContainer=node;range.startOffset=offset;if(!range.endContainer){range.collapse(true);}}else{range.endContainer=node;range.endOffset=offset;if(!range.startContainer){range.collapse(false);}}updateCollapse(range);return range;}function execContentsAction(range,action){var start=range.startContainer,end=range.endContainer,startOffset=range.startOffset,endOffset=range.endOffset,doc=range.document,frag=doc.createDocumentFragment(),tmpStart,tmpEnd;if(start.nodeType==1){start=start.childNodes[startOffset]||(tmpStart=start.appendChild(doc.createTextNode('')));}if(end.nodeType==1){end=end.childNodes[endOffset]||(tmpEnd=end.appendChild(doc.createTextNode('')));}if(start===end&&start.nodeType==3){frag.appendChild(doc.createTextNode(start.substringData(startOffset,endOffset-startOffset)));if(action){start.deleteData(startOffset,endOffset-startOffset);range.collapse(true);}return frag;}var current,currentLevel,clone=frag,startParents=domUtils.findParents(start,true),endParents=domUtils.findParents(end,true);for(var i=0;startParents[i]==endParents[i];){i++;}for(var j=i,si;si=startParents[j];j++){current=si.nextSibling;if(si==start){if(!tmpStart){if(range.startContainer.nodeType==3){clone.appendChild(doc.createTextNode(start.nodeValue.slice(startOffset)));if(action){start.deleteData(startOffset,start.nodeValue.length-startOffset);}}else{clone.appendChild(!action?start.cloneNode(true):start);}}}else{currentLevel=si.cloneNode(false);clone.appendChild(currentLevel);}while(current){if(current===end||current===endParents[j]){break;}si=current.nextSibling;clone.appendChild(!action?current.cloneNode(true):current);current=si;}clone=currentLevel;}clone=frag;if(!startParents[i]){clone.appendChild(startParents[i-1].cloneNode(false));clone=clone.firstChild;}for(var j=i,ei;ei=endParents[j];j++){current=ei.previousSibling;if(ei==end){if(!tmpEnd&&range.endContainer.nodeType==3){clone.appendChild(doc.createTextNode(end.substringData(0,endOffset)));if(action){end.deleteData(0,endOffset);}}}else{currentLevel=ei.cloneNode(false);clone.appendChild(currentLevel);}
if(j!=i||!startParents[i]){while(current){if(current===start){break;}ei=current.previousSibling;clone.insertBefore(!action?current.cloneNode(true):current,clone.firstChild);current=ei;}}clone=currentLevel;}if(action){range.setStartBefore(!endParents[i]?endParents[i-1]:!startParents[i]?startParents[i-1]:endParents[i]).collapse(true);}tmpStart&&domUtils.remove(tmpStart);tmpEnd&&domUtils.remove(tmpEnd);return frag;}var Range=dom.Range=function(document){var me=this;me.startContainer=me.startOffset=me.endContainer=me.endOffset=null;me.document=document;me.collapsed=true;};function removeFillData(doc,excludeNode){try{if(fillData&&domUtils.inDoc(fillData,doc)){if(!fillData.nodeValue.replace(fillCharReg,'').length){var tmpNode=fillData.parentNode;domUtils.remove(fillData);while(tmpNode&&domUtils.isEmptyInlineElement(tmpNode)&&(browser.safari?!(domUtils.getPosition(tmpNode,excludeNode)&domUtils.POSITION_CONTAINS):!tmpNode.contains(excludeNode))){fillData=tmpNode.parentNode;domUtils.remove(tmpNode);tmpNode=fillData;}}else{fillData.nodeValue=fillData.nodeValue.replace(fillCharReg,'');}}}catch(e){}}function mergeSibling(node,dir){var tmpNode;node=node[dir];while(node&&domUtils.isFillChar(node)){tmpNode=node[dir];domUtils.remove(node);node=tmpNode;}}Range.prototype={cloneContents:function cloneContents(){return this.collapsed?null:execContentsAction(this,0);},deleteContents:function deleteContents(){var txt;if(!this.collapsed){execContentsAction(this,1);}if(browser.webkit){txt=this.startContainer;if(txt.nodeType==3&&!txt.nodeValue.length){this.setStartBefore(txt).collapse(true);domUtils.remove(txt);}}return this;},extractContents:function extractContents(){return this.collapsed?null:execContentsAction(this,2);},setStart:function setStart(node,offset){return setEndPoint(true,node,offset,this);},setEnd:function setEnd(node,offset){return setEndPoint(false,node,offset,this);},setStartAfter:function setStartAfter(node){return this.setStart(node.parentNode,domUtils.getNodeIndex(node)+1);},setStartBefore:function setStartBefore(node){return this.setStart(node.parentNode,domUtils.getNodeIndex(node));},setEndAfter:function setEndAfter(node){return this.setEnd(node.parentNode,domUtils.getNodeIndex(node)+1);},setEndBefore:function setEndBefore(node){return this.setEnd(node.parentNode,domUtils.getNodeIndex(node));},setStartAtFirst:function setStartAtFirst(node){return this.setStart(node,0);},setStartAtLast:function setStartAtLast(node){return this.setStart(node,node.nodeType==3?node.nodeValue.length:node.childNodes.length);},setEndAtFirst:function setEndAtFirst(node){return this.setEnd(node,0);},setEndAtLast:function setEndAtLast(node){return this.setEnd(node,node.nodeType==3?node.nodeValue.length:node.childNodes.length);},selectNode:function selectNode(node){return this.setStartBefore(node).setEndAfter(node);},selectNodeContents:function selectNodeContents(node){return this.setStart(node,0).setEndAtLast(node);},cloneRange:function cloneRange(){var me=this;return new Range(me.document).setStart(me.startContainer,me.startOffset).setEnd(me.endContainer,me.endOffset);},collapse:function collapse(toStart){var me=this;if(toStart){me.endContainer=me.startContainer;me.endOffset=me.startOffset;}else{me.startContainer=me.endContainer;me.startOffset=me.endOffset;}me.collapsed=true;return me;},shrinkBoundary:function shrinkBoundary(ignoreEnd){var me=this,child,collapsed=me.collapsed;function check(node){return node.nodeType==1&&!domUtils.isBookmarkNode(node)&&!dtd.$empty[node.tagName]&&!dtd.$nonChild[node.tagName];}while(me.startContainer.nodeType==1&&(child=me.startContainer.childNodes[me.startOffset])&&check(child)){me.setStart(child,0);}if(collapsed){return me.collapse(true);}if(!ignoreEnd){while(me.endContainer.nodeType==1&&me.endOffset>0&&(child=me.endContainer.childNodes[me.endOffset-1])&&check(child)){me.setEnd(child,child.childNodes.length);}}return me;},getCommonAncestor:function getCommonAncestor(includeSelf,ignoreTextNode){var me=this,start=me.startContainer,end=me.endContainer;if(start===end){if(includeSelf&&selectOneNode(this)){start=start.childNodes[me.startOffset];if(start.nodeType==1)return start;}
return ignoreTextNode&&start.nodeType==3?start.parentNode:start;}return domUtils.getCommonAncestor(start,end);},trimBoundary:function trimBoundary(ignoreEnd){this.txtToElmBoundary();var start=this.startContainer,offset=this.startOffset,collapsed=this.collapsed,end=this.endContainer;if(start.nodeType==3){if(offset==0){this.setStartBefore(start);}else{if(offset>=start.nodeValue.length){this.setStartAfter(start);}else{var textNode=domUtils.split(start,offset);if(start===end){this.setEnd(textNode,this.endOffset-offset);}else if(start.parentNode===end){this.endOffset+=1;}this.setStartBefore(textNode);}}if(collapsed){return this.collapse(true);}}if(!ignoreEnd){offset=this.endOffset;end=this.endContainer;if(end.nodeType==3){if(offset==0){this.setEndBefore(end);}else{offset<end.nodeValue.length&&domUtils.split(end,offset);this.setEndAfter(end);}}}return this;},txtToElmBoundary:function txtToElmBoundary(ignoreCollapsed){function adjust(r,c){var container=r[c+'Container'],offset=r[c+'Offset'];if(container.nodeType==3){if(!offset){r['set'+c.replace(/(\w)/,function(a){return a.toUpperCase();})+'Before'](container);}else if(offset>=container.nodeValue.length){r['set'+c.replace(/(\w)/,function(a){return a.toUpperCase();})+'After'](container);}}}if(ignoreCollapsed||!this.collapsed){adjust(this,'start');adjust(this,'end');}return this;},insertNode:function insertNode(node){var first=node,length=1;if(node.nodeType==11){first=node.firstChild;length=node.childNodes.length;}this.trimBoundary(true);var start=this.startContainer,offset=this.startOffset;var nextNode=start.childNodes[offset];if(nextNode){start.insertBefore(node,nextNode);}else{start.appendChild(node);}if(first.parentNode===this.endContainer){this.endOffset=this.endOffset+length;}return this.setStartBefore(first);},setCursor:function setCursor(toEnd,noFillData){return this.collapse(!toEnd).select(noFillData);},createBookmark:function createBookmark(serialize,same){var endNode,startNode=this.document.createElement('span');startNode.style.cssText='display:none;line-height:0px;';startNode.appendChild(this.document.createTextNode('\u200D'));startNode.id='_baidu_bookmark_start_'+(same?'':guid++);if(!this.collapsed){endNode=startNode.cloneNode(true);endNode.id='_baidu_bookmark_end_'+(same?'':guid++);}this.insertNode(startNode);if(endNode){this.collapse().insertNode(endNode).setEndBefore(endNode);}this.setStartAfter(startNode);return{start:serialize?startNode.id:startNode,end:endNode?serialize?endNode.id:endNode:null,id:serialize};},moveToBookmark:function moveToBookmark(bookmark){var start=bookmark.id?this.document.getElementById(bookmark.start):bookmark.start,end=bookmark.end&&bookmark.id?this.document.getElementById(bookmark.end):bookmark.end;this.setStartBefore(start);domUtils.remove(start);if(end){this.setEndBefore(end);domUtils.remove(end);}else{this.collapse(true);}return this;},enlarge:function enlarge(toBlock,stopFn){var isBody=domUtils.isBody,pre,node,tmp=this.document.createTextNode('');if(toBlock){node=this.startContainer;if(node.nodeType==1){if(node.childNodes[this.startOffset]){pre=node=node.childNodes[this.startOffset];}else{node.appendChild(tmp);pre=node=tmp;}}else{pre=node;}while(1){if(domUtils.isBlockElm(node)){node=pre;while((pre=node.previousSibling)&&!domUtils.isBlockElm(pre)){node=pre;}this.setStartBefore(node);break;}pre=node;node=node.parentNode;}node=this.endContainer;if(node.nodeType==1){if(pre=node.childNodes[this.endOffset]){node.insertBefore(tmp,pre);}else{node.appendChild(tmp);}pre=node=tmp;}else{pre=node;}while(1){if(domUtils.isBlockElm(node)){node=pre;while((pre=node.nextSibling)&&!domUtils.isBlockElm(pre)){node=pre;}this.setEndAfter(node);break;}pre=node;node=node.parentNode;}if(tmp.parentNode===this.endContainer){this.endOffset--;}domUtils.remove(tmp);}
if(!this.collapsed){while(this.startOffset==0){if(stopFn&&stopFn(this.startContainer)){break;}if(isBody(this.startContainer)){break;}this.setStartBefore(this.startContainer);}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(stopFn&&stopFn(this.endContainer)){break;}if(isBody(this.endContainer)){break;}this.setEndAfter(this.endContainer);}}return this;},enlargeToBlockElm:function enlargeToBlockElm(ignoreEnd){while(!domUtils.isBlockElm(this.startContainer)){this.setStartBefore(this.startContainer);}if(!ignoreEnd){while(!domUtils.isBlockElm(this.endContainer)){this.setEndAfter(this.endContainer);}}return this;},adjustmentBoundary:function adjustmentBoundary(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?'nodeValue':'childNodes'].length&&this.startContainer[this.startContainer.nodeType==3?'nodeValue':'childNodes'].length){this.setStartAfter(this.startContainer);}while(!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?'nodeValue':'childNodes'].length){this.setEndBefore(this.endContainer);}}return this;},applyInlineStyle:function applyInlineStyle(tagName,attrs,list){if(this.collapsed)return this;this.trimBoundary().enlarge(false,function(node){return node.nodeType==1&&domUtils.isBlockElm(node);}).adjustmentBoundary();var bookmark=this.createBookmark(),end=bookmark.end,filterFn=function filterFn(node){return node.nodeType==1?node.tagName.toLowerCase()!='br':!domUtils.isWhitespace(node);},current=domUtils.getNextDomNode(bookmark.start,false,filterFn),node,pre,range=this.cloneRange();while(current&&domUtils.getPosition(current,end)&domUtils.POSITION_PRECEDING){if(current.nodeType==3||dtd[tagName][current.tagName]){range.setStartBefore(current);node=current;while(node&&(node.nodeType==3||dtd[tagName][node.tagName])&&node!==end){pre=node;node=domUtils.getNextDomNode(node,node.nodeType==1,null,function(parent){return dtd[tagName][parent.tagName];});}var frag=range.setEndAfter(pre).extractContents(),elm;if(list&&list.length>0){var level,top;top=level=list[0].cloneNode(false);for(var i=1,ci;ci=list[i++];){level.appendChild(ci.cloneNode(false));level=level.firstChild;}elm=level;}else{elm=range.document.createElement(tagName);}if(attrs){domUtils.setAttributes(elm,attrs);}elm.appendChild(frag);range.insertNode(list?top:elm);var aNode;if(tagName=='span'&&attrs.style&&/text\-decoration/.test(attrs.style)&&(aNode=domUtils.findParentByTagName(elm,'a',true))){domUtils.setAttributes(aNode,attrs);domUtils.remove(elm,true);elm=aNode;}else{domUtils.mergeSibling(elm);domUtils.clearEmptySibling(elm);}
domUtils.mergeChild(elm,attrs);current=domUtils.getNextDomNode(elm,false,filterFn);domUtils.mergeToParent(elm);if(node===end){break;}}else{current=domUtils.getNextDomNode(current,true,filterFn);}}return this.moveToBookmark(bookmark);},removeInlineStyle:function removeInlineStyle(tagNames){if(this.collapsed)return this;tagNames=utils.isArray(tagNames)?tagNames:[tagNames];this.shrinkBoundary().adjustmentBoundary();var start=this.startContainer,end=this.endContainer;while(1){if(start.nodeType==1){if(utils.indexOf(tagNames,start.tagName.toLowerCase())>-1){break;}if(start.tagName.toLowerCase()=='body'){start=null;break;}}start=start.parentNode;}while(1){if(end.nodeType==1){if(utils.indexOf(tagNames,end.tagName.toLowerCase())>-1){break;}if(end.tagName.toLowerCase()=='body'){end=null;break;}}end=end.parentNode;}var bookmark=this.createBookmark(),frag,tmpRange;if(start){tmpRange=this.cloneRange().setEndBefore(bookmark.start).setStartBefore(start);frag=tmpRange.extractContents();tmpRange.insertNode(frag);domUtils.clearEmptySibling(start,true);start.parentNode.insertBefore(bookmark.start,start);}if(end){tmpRange=this.cloneRange().setStartAfter(bookmark.end).setEndAfter(end);frag=tmpRange.extractContents();tmpRange.insertNode(frag);domUtils.clearEmptySibling(end,false,true);end.parentNode.insertBefore(bookmark.end,end.nextSibling);}var current=domUtils.getNextDomNode(bookmark.start,false,function(node){return node.nodeType==1;}),next;while(current&&current!==bookmark.end){next=domUtils.getNextDomNode(current,true,function(node){return node.nodeType==1;});if(utils.indexOf(tagNames,current.tagName.toLowerCase())>-1){domUtils.remove(current,true);}current=next;}return this.moveToBookmark(bookmark);},getClosedNode:function getClosedNode(){var node;if(!this.collapsed){var range=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(selectOneNode(range)){var child=range.startContainer.childNodes[range.startOffset];if(child&&child.nodeType==1&&(dtd.$empty[child.tagName]||dtd.$nonChild[child.tagName])){node=child;}}}return node;},select:browser.ie?function(noFillData,textRange){var nativeRange;if(!this.collapsed)this.shrinkBoundary();var node=this.getClosedNode();if(node&&!textRange){try{nativeRange=this.document.body.createControlRange();nativeRange.addElement(node);nativeRange.select();}catch(e){}return this;}var bookmark=this.createBookmark(),start=bookmark.start,end;nativeRange=this.document.body.createTextRange();nativeRange.moveToElementText(start);nativeRange.moveStart('character',1);if(!this.collapsed){var nativeRangeEnd=this.document.body.createTextRange();end=bookmark.end;nativeRangeEnd.moveToElementText(end);nativeRange.setEndPoint('EndToEnd',nativeRangeEnd);}else{if(!noFillData&&this.startContainer.nodeType!=3){var tmpText=this.document.createTextNode(fillChar),tmp=this.document.createElement('span');tmp.appendChild(this.document.createTextNode(fillChar));start.parentNode.insertBefore(tmp,start);start.parentNode.insertBefore(tmpText,start);removeFillData(this.document,tmpText);fillData=tmpText;mergeSibling(tmp,'previousSibling');mergeSibling(start,'nextSibling');nativeRange.moveStart('character',-1);nativeRange.collapse(true);}}this.moveToBookmark(bookmark);tmp&&domUtils.remove(tmp);try{nativeRange.select();}catch(e){}return this;}:function(notInsertFillData){function checkOffset(rng){function check(node,offset,dir){if(node.nodeType==3&&node.nodeValue.length<offset){rng[dir+'Offset']=node.nodeValue.length;}}check(rng.startContainer,rng.startOffset,'start');check(rng.endContainer,rng.endOffset,'end');}var win=domUtils.getWindow(this.document),sel=win.getSelection(),txtNode;browser.gecko?this.document.body.focus():win.focus();if(sel){sel.removeAllRanges();if(this.collapsed&&!notInsertFillData){var start=this.startContainer,child=start;if(start.nodeType==1){child=start.childNodes[this.startOffset];}if(!(start.nodeType==3&&this.startOffset)&&(child?!child.previousSibling||child.previousSibling.nodeType!=3:!start.lastChild||start.lastChild.nodeType!=3)){txtNode=this.document.createTextNode(fillChar);this.insertNode(txtNode);removeFillData(this.document,txtNode);mergeSibling(txtNode,'previousSibling');mergeSibling(txtNode,'nextSibling');fillData=txtNode;this.setStart(txtNode,browser.webkit?1:0).collapse(true);}}var nativeRange=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var child=this.startContainer.childNodes[this.startOffset];if(!child){child=this.startContainer.lastChild;if(child&&domUtils.isBr(child)){this.setStartBefore(child).collapse(true);}}else{while(child&&domUtils.isBlockElm(child)){if(child.nodeType==1&&child.childNodes[0]){child=child.childNodes[0];}else{break;}}child&&this.setStartBefore(child).collapse(true);}}
checkOffset(this);nativeRange.setStart(this.startContainer,this.startOffset);nativeRange.setEnd(this.endContainer,this.endOffset);sel.addRange(nativeRange);}return this;},scrollToView:function scrollToView(win,offset){win=win?window:domUtils.getWindow(this.document);var me=this,span=me.document.createElement('span');span.innerHTML='&nbsp;';me.cloneRange().insertNode(span);domUtils.scrollToView(span,win,offset);domUtils.remove(span);return me;},inFillChar:function inFillChar(){var start=this.startContainer;if(this.collapsed&&start.nodeType==3&&start.nodeValue.replace(new RegExp('^'+domUtils.fillChar),'').length+1==start.nodeValue.length){return true;}return false;},createAddress:function createAddress(ignoreEnd,ignoreTxt){var addr={},me=this;function getAddress(isStart){var node=isStart?me.startContainer:me.endContainer;var parents=domUtils.findParents(node,true,function(node){return!domUtils.isBody(node);}),addrs=[];for(var i=0,ci;ci=parents[i++];){addrs.push(domUtils.getNodeIndex(ci,ignoreTxt));}var firstIndex=0;if(ignoreTxt){if(node.nodeType==3){var tmpNode=node.previousSibling;while(tmpNode&&tmpNode.nodeType==3){firstIndex+=tmpNode.nodeValue.replace(fillCharReg,'').length;tmpNode=tmpNode.previousSibling;}firstIndex+=isStart?me.startOffset:me.endOffset;}else{node=node.childNodes[isStart?me.startOffset:me.endOffset];if(node){firstIndex=domUtils.getNodeIndex(node,ignoreTxt);}else{node=isStart?me.startContainer:me.endContainer;var first=node.firstChild;while(first){if(domUtils.isFillChar(first)){first=first.nextSibling;continue;}firstIndex++;if(first.nodeType==3){while(first&&first.nodeType==3){first=first.nextSibling;}}else{first=first.nextSibling;}}}}}else{firstIndex=isStart?domUtils.isFillChar(node)?0:me.startOffset:me.endOffset;}if(firstIndex<0){firstIndex=0;}addrs.push(firstIndex);return addrs;}addr.startAddress=getAddress(true);if(!ignoreEnd){addr.endAddress=me.collapsed?[].concat(addr.startAddress):getAddress();}return addr;},moveToAddress:function moveToAddress(addr,ignoreEnd){var me=this;function getNode(address,isStart){var tmpNode=me.document.body,parentNode,offset;for(var i=0,ci,l=address.length;i<l;i++){ci=address[i];parentNode=tmpNode;tmpNode=tmpNode.childNodes[ci];if(!tmpNode){offset=ci;break;}}if(isStart){if(tmpNode){me.setStartBefore(tmpNode);}else{me.setStart(parentNode,offset);}}else{if(tmpNode){me.setEndBefore(tmpNode);}else{me.setEnd(parentNode,offset);}}}getNode(addr.startAddress,true);!ignoreEnd&&addr.endAddress&&getNode(addr.endAddress);return me;},equals:function equals(rng){for(var p in this){if(this.hasOwnProperty(p)){if(this[p]!==rng[p])return false;}}return true;},traversal:function traversal(doFn,filterFn){if(this.collapsed)return this;var bookmark=this.createBookmark(),end=bookmark.end,current=domUtils.getNextDomNode(bookmark.start,false,filterFn);while(current&&current!==end&&domUtils.getPosition(current,end)&domUtils.POSITION_PRECEDING){var tmpNode=domUtils.getNextDomNode(current,false,filterFn);doFn(current);current=tmpNode;}return this.moveToBookmark(bookmark);}};})();(function(){function getBoundaryInformation(range,start){var getIndex=domUtils.getNodeIndex;range=range.duplicate();range.collapse(start);var parent=range.parentElement();if(!parent.hasChildNodes()){return{container:parent,offset:0};}var siblings=parent.children,child,testRange=range.duplicate(),startIndex=0,endIndex=siblings.length-1,index=-1,distance;while(startIndex<=endIndex){index=Math.floor((startIndex+endIndex)/2);child=siblings[index];testRange.moveToElementText(child);var position=testRange.compareEndPoints('StartToStart',range);if(position>0){endIndex=index-1;}else if(position<0){startIndex=index+1;}else{return{container:parent,offset:getIndex(child)};}}if(index==-1){testRange.moveToElementText(parent);testRange.setEndPoint('StartToStart',range);distance=testRange.text.replace(/(\r\n|\r)/g,'\n').length;siblings=parent.childNodes;if(!distance){child=siblings[siblings.length-1];return{container:child,offset:child.nodeValue.length};}var i=siblings.length;while(distance>0){distance-=siblings[--i].nodeValue.length;}return{container:siblings[i],offset:-distance};}testRange.collapse(position>0);testRange.setEndPoint(position>0?'StartToStart':'EndToStart',range);distance=testRange.text.replace(/(\r\n|\r)/g,'\n').length;if(!distance){return dtd.$empty[child.tagName]||dtd.$nonChild[child.tagName]?{container:parent,offset:getIndex(child)+(position>0?0:1)}:{container:child,offset:position>0?0:child.childNodes.length};}while(distance>0){try{var pre=child;child=child[position>0?'previousSibling':'nextSibling'];distance-=child.nodeValue.length;}catch(e){return{container:parent,offset:getIndex(pre)};}}return{container:child,offset:position>0?-distance:child.nodeValue.length+distance};}function transformIERangeToRange(ieRange,range){if(ieRange.item){range.selectNode(ieRange.item(0));}else{var bi=getBoundaryInformation(ieRange,true);range.setStart(bi.container,bi.offset);if(ieRange.compareEndPoints('StartToEnd',ieRange)!=0){bi=getBoundaryInformation(ieRange,false);range.setEnd(bi.container,bi.offset);}}return range;}function _getIERange(sel){var ieRange;try{ieRange=sel.getNative().createRange();}catch(e){return null;}var el=ieRange.item?ieRange.item(0):ieRange.parentElement();if((el.ownerDocument||el)===sel.document){return ieRange;}return null;}var Selection=dom.Selection=function(doc){var me=this,iframe;me.document=doc;if(browser.ie9below){iframe=domUtils.getWindow(doc).frameElement;domUtils.on(iframe,'beforedeactivate',function(){me._bakIERange=me.getIERange();});domUtils.on(iframe,'activate',function(){try{if(!_getIERange(me)&&me._bakIERange){me._bakIERange.select();}}catch(ex){}me._bakIERange=null;});}iframe=doc=null;};Selection.prototype={rangeInBody:function rangeInBody(rng,txtRange){var node=browser.ie9below||txtRange?rng.item?rng.item():rng.parentElement():rng.startContainer;return node===this.document.body||domUtils.inDoc(node,this.document);},getNative:function getNative(){var doc=this.document;try{return!doc?null:browser.ie9below?doc.selection:domUtils.getWindow(doc).getSelection();}catch(e){return null;}},getIERange:function getIERange(){var ieRange=_getIERange(this);if(!ieRange){if(this._bakIERange){return this._bakIERange;}}return ieRange;},cache:function cache(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath();},getStartElementPath:function getStartElementPath(){if(this._cachedStartElementPath){return this._cachedStartElementPath;}var start=this.getStart();if(start){return domUtils.findParents(start,true,null,true);}return[];},clear:function clear(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null;},isFocus:function isFocus(){try{if(browser.ie9below){var nativeRange=_getIERange(this);return!!(nativeRange&&this.rangeInBody(nativeRange));}else{return!!this.getNative().rangeCount;}}catch(e){return false;}},getRange:function getRange(){var me=this;function optimze(range){var child=me.document.body.firstChild,collapsed=range.collapsed;while(child&&child.firstChild){range.setStart(child,0);child=child.firstChild;}if(!range.startContainer){range.setStart(me.document.body,0);}if(collapsed){range.collapse(true);}}if(me._cachedRange!=null){return this._cachedRange;}var range=new baidu.editor.dom.Range(me.document);if(browser.ie9below){var nativeRange=me.getIERange();if(nativeRange){try{transformIERangeToRange(nativeRange,range);}catch(e){optimze(range);}}else{optimze(range);}}else{var sel=me.getNative();if(sel&&sel.rangeCount){var firstRange=sel.getRangeAt(0);var lastRange=sel.getRangeAt(sel.rangeCount-1);range.setStart(firstRange.startContainer,firstRange.startOffset).setEnd(lastRange.endContainer,lastRange.endOffset);if(range.collapsed&&domUtils.isBody(range.startContainer)&&!range.startOffset){optimze(range);}}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange;}optimze(range);}}return this._bakRange=range;},getStart:function getStart(){if(this._cachedStartElement){return this._cachedStartElement;}var range=browser.ie9below?this.getIERange():this.getRange(),tmpRange,start,tmp,parent;if(browser.ie9below){if(!range){return this.document.body.firstChild;}
if(range.item){return range.item(0);}tmpRange=range.duplicate();tmpRange.text.length>0&&tmpRange.moveStart('character',1);tmpRange.collapse(1);start=tmpRange.parentElement();parent=tmp=range.parentElement();while(tmp=tmp.parentNode){if(tmp==start){start=parent;break;}}}else{range.shrinkBoundary();start=range.startContainer;if(start.nodeType==1&&start.hasChildNodes()){start=start.childNodes[Math.min(start.childNodes.length-1,range.startOffset)];}if(start.nodeType==3){return start.parentNode;}}return start;},getText:function getText(){var nativeSel,nativeRange;if(this.isFocus()&&(nativeSel=this.getNative())){nativeRange=browser.ie9below?nativeSel.createRange():nativeSel.getRangeAt(0);return browser.ie9below?nativeRange.text:nativeRange.toString();}return'';},clearRange:function clearRange(){this.getNative()[browser.ie9below?'empty':'removeAllRanges']();}};})();(function(){var uid=0,_selectionChangeTimer;function setValue(form,editor){var textarea;if(editor.textarea){if(utils.isString(editor.textarea)){for(var i=0,ti,tis=domUtils.getElementsByTagName(form,'textarea');ti=tis[i++];){if(ti.id=='ueditor_textarea_'+editor.options.textarea){textarea=ti;break;}}}else{textarea=editor.textarea;}}if(!textarea){form.appendChild(textarea=domUtils.createElement(document,'textarea',{'name':editor.options.textarea,'id':'ueditor_textarea_'+editor.options.textarea,'style':"display:none"}));editor.textarea=textarea;}!textarea.getAttribute('name')&&textarea.setAttribute('name',editor.options.textarea);textarea.value=editor.hasContents()?editor.options.allHtmlEnabled?editor.getAllHtml():editor.getContent(null,null,true):'';}function loadPlugins(me){for(var pi in UE.plugins){UE.plugins[pi].call(me);}}function checkCurLang(I18N){for(var lang in I18N){return lang;}}function langReadied(me){me.langIsReady=true;me.fireEvent("langReady");}var Editor=UE.Editor=function(options){var me=this;me.uid=uid++;EventBase.call(me);me.commands={};me.options=utils.extend(utils.clone(options||{}),UEDITOR_CONFIG,true);me.shortcutkeys={};me.inputRules=[];me.outputRules=[];me.setOpt(Editor.defaultOptions(me));me.loadServerConfig();if(!utils.isEmptyObject(UE.I18N)){me.options.lang=checkCurLang(UE.I18N);UE.plugin.load(me);langReadied(me);}else{utils.loadFile(document,{src:me.options.langPath+me.options.lang+"/"+me.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(me);langReadied(me);});}UE.instants['ueditorInstant'+me.uid]=me;};Editor.prototype={registerCommand:function registerCommand(name,obj){this.commands[name]=obj;},ready:function ready(fn){var me=this;if(fn){me.isReady?fn.apply(me):me.addListener('ready',fn);}},setOpt:function setOpt(key,val){var obj={};if(utils.isString(key)){obj[key]=val;}else{obj=key;}utils.extend(this.options,obj,true);},getOpt:function getOpt(key){return this.options[key];},destroy:function destroy(){var me=this;me.fireEvent('destroy');var container=me.container.parentNode;var textarea=me.textarea;if(!textarea){textarea=document.createElement('textarea');container.parentNode.insertBefore(textarea,container);}else{textarea.style.display='';}textarea.style.width=me.iframe.offsetWidth+'px';textarea.style.height=me.iframe.offsetHeight+'px';textarea.value=me.getContent();textarea.id=me.key;container.innerHTML='';domUtils.remove(container);var key=me.key;for(var p in me){if(me.hasOwnProperty(p)){delete this[p];}}UE.delEditor(key);},render:function render(container){var me=this,options=me.options,getStyleValue=function getStyleValue(attr){return parseInt(domUtils.getComputedStyle(container,attr));};if(utils.isString(container)){container=document.getElementById(container);}if(container){if(options.initialFrameWidth){options.minFrameWidth=options.initialFrameWidth;}else{options.minFrameWidth=options.initialFrameWidth=container.offsetWidth;}if(options.initialFrameHeight){options.minFrameHeight=options.initialFrameHeight;}else{options.initialFrameHeight=options.minFrameHeight=container.offsetHeight;}container.style.width=/%$/.test(options.initialFrameWidth)?'100%':options.initialFrameWidth-getStyleValue("padding-left")-getStyleValue("padding-right")+'px';container.style.height=/%$/.test(options.initialFrameHeight)?'100%':options.initialFrameHeight-getStyleValue("padding-top")-getStyleValue("padding-bottom")+'px';container.style.zIndex=options.zIndex;var html=(ie&&browser.version<9?'':'<!DOCTYPE html>')+'<html xmlns=\'http://www.w3.org/1999/xhtml\' class=\'view\' ><head>'+'<style type=\'text/css\'>'+'.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\n'+'body{margin:8px;font-family:sans-serif;font-size:16px;}'+'p{margin:5px 0;}</style>'+(options.iframeCssUrl?'<link rel=\'stylesheet\' type=\'text/css\' href=\''+utils.unhtml(options.iframeCssUrl)+'\'/>':'')+(options.initialStyle?'<style>'+options.initialStyle+'</style>':'')+'</head><body class=\'view\' ></body>'+'<script type=\'text/javascript\' '+(ie?'defer=\'defer\'':'')+' id=\'_initialScript\'>'+'setTimeout(function(){editor = window.parent.UE.instants[\'ueditorInstant'+me.uid+'\'];editor._setup(document);},0);'+'var _tmpScript = document.getElementById(\'_initialScript\');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>';container.appendChild(domUtils.createElement(document,'iframe',{id:'ueditor_'+me.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();'+(options.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':'')+'document.write("'+html+'");document.close();}())'}));container.style.overflow='hidden';setTimeout(function(){if(/%$/.test(options.initialFrameWidth)){options.minFrameWidth=options.initialFrameWidth=container.offsetWidth;}if(/%$/.test(options.initialFrameHeight)){options.minFrameHeight=options.initialFrameHeight=container.offsetHeight;container.style.height=options.initialFrameHeight+'px';}});}},_setup:function _setup(doc){var me=this,options=me.options;if(ie){doc.body.disabled=true;doc.body.contentEditable=true;doc.body.disabled=false;}else{doc.body.contentEditable=true;}doc.body.spellcheck=false;me.document=doc;me.window=doc.defaultView||doc.parentWindow;me.iframe=me.window.frameElement;me.body=doc.body;me.selection=new dom.Selection(doc);var geckoSel;if(browser.gecko&&(geckoSel=this.selection.getNative())){geckoSel.removeAllRanges();}this._initEvents();for(var form=this.iframe.parentNode;!domUtils.isBody(form);form=form.parentNode){if(form.tagName=='FORM'){me.form=form;if(me.options.autoSyncData){domUtils.on(me.window,'blur',function(){setValue(form,me);});}else{domUtils.on(form,'submit',function(){setValue(this,me);});}break;}}if(options.initialContent){if(options.autoClearinitialContent){var oldExecCommand=me.execCommand;me.execCommand=function(){me.fireEvent('firstBeforeExecCommand');return oldExecCommand.apply(me,arguments);};this._setDefaultContent(options.initialContent);}else this.setContent(options.initialContent,false,true);}
if(domUtils.isEmptyNode(me.body)){me.body.innerHTML='<p>'+(browser.ie?'':'<br/>')+'</p>';}
if(options.focus){setTimeout(function(){me.focus(me.options.focusInEnd);!me.options.autoClearinitialContent&&me._selectionChange();},0);}if(!me.container){me.container=this.iframe.parentNode;}if(options.fullscreen&&me.ui){me.ui.setFullScreen(true);}try{me.document.execCommand('2D-position',false,false);}catch(e){}try{me.document.execCommand('enableInlineTableEditing',false,false);}catch(e){}try{me.document.execCommand('enableObjectResizing',false,false);}catch(e){}
me._bindshortcutKeys();me.isReady=1;me.fireEvent('ready');options.onready&&options.onready.call(me);if(!browser.ie9below){domUtils.on(me.window,['blur','focus'],function(e){if(e.type=='blur'){me._bakRange=me.selection.getRange();try{me._bakNativeRange=me.selection.getNative().getRangeAt(0);me.selection.getNative().removeAllRanges();}catch(e){me._bakNativeRange=null;}}else{try{me._bakRange&&me._bakRange.select();}catch(e){}}});}
if(browser.gecko&&browser.version<=10902){me.body.contentEditable=false;setTimeout(function(){me.body.contentEditable=true;},100);setInterval(function(){me.body.style.height=me.iframe.offsetHeight-20+'px';},100);}!options.isShow&&me.setHide();options.readonly&&me.setDisabled();},sync:function sync(formId){var me=this,form=formId?document.getElementById(formId):domUtils.findParent(me.iframe.parentNode,function(node){return node.tagName=='FORM';},true);form&&setValue(form,me);},setHeight:function setHeight(height,notSetHeight){if(height!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=height+'px';}!notSetHeight&&(this.options.minFrameHeight=this.options.initialFrameHeight=height);this.body.style.height=height+'px';!notSetHeight&&this.trigger('setHeight');},addshortcutkey:function addshortcutkey(cmd,keys){var obj={};if(keys){obj[cmd]=keys;}else{obj=cmd;}utils.extend(this.shortcutkeys,obj);},_bindshortcutKeys:function _bindshortcutKeys(){var me=this,shortcutkeys=this.shortcutkeys;me.addListener('keydown',function(type,e){var keyCode=e.keyCode||e.which;for(var i in shortcutkeys){var tmp=shortcutkeys[i].split(',');for(var t=0,ti;ti=tmp[t++];){ti=ti.split(':');var key=ti[0],param=ti[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(key.toLowerCase())||/^(\d+)$/.test(key)){if((RegExp.$1=='ctrl'?e.ctrlKey||e.metaKey:0)&&(RegExp.$2!=""?e[RegExp.$2.slice(1)+"Key"]:1)&&keyCode==RegExp.$3||keyCode==RegExp.$1){if(me.queryCommandState(i,param)!=-1)me.execCommand(i,param);domUtils.preventDefault(e);}}}}});},getContent:function getContent(cmd,fn,notSetCursor,ignoreBlank,formatter){var me=this;if(cmd&&utils.isFunction(cmd)){fn=cmd;cmd='';}if(fn?!fn():!this.hasContents()){return'';}me.fireEvent('beforegetcontent');var root=UE.htmlparser(me.body.innerHTML,ignoreBlank);me.filterOutputRule(root);me.fireEvent('aftergetcontent',cmd,root);return root.toHtml(formatter);},getAllHtml:function getAllHtml(){var me=this,headHtml=[],html='';me.fireEvent('getAllHtml',headHtml);if(browser.ie&&browser.version>8){var headHtmlForIE9='';utils.each(me.document.styleSheets,function(si){headHtmlForIE9+=si.href?'<link rel="stylesheet" type="text/css" href="'+si.href+'" />':'<style>'+si.cssText+'</style>';});utils.each(me.document.getElementsByTagName('script'),function(si){headHtmlForIE9+=si.outerHTML;});}return'<html><head>'+(me.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+me.options.charset+'"/>':'')+(headHtmlForIE9||me.document.getElementsByTagName('head')[0].innerHTML)+headHtml.join('\n')+'</head>'+'<body '+(ie&&browser.version<9?'class="view"':'')+'>'+me.getContent(null,null,true)+'</body></html>';},getPlainTxt:function getPlainTxt(){var reg=new RegExp(domUtils.fillChar,'g'),html=this.body.innerHTML.replace(/[\n\r]/g,'');html=html.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,'\n').replace(/<br\/?>/gi,'\n').replace(/<[^>/]+>/g,'').replace(/(\n)?<\/([^>]+)>/g,function(a,b,c){return dtd.$block[c]?'\n':b?b:'';});return html.replace(reg,'').replace(/\u00a0/g,' ').replace(/&nbsp;/g,' ');},getContentTxt:function getContentTxt(){var reg=new RegExp(domUtils.fillChar,'g');return this.body[browser.ie?'innerText':'textContent'].replace(reg,'').replace(/\u00a0/g,' ');},setContent:function setContent(html,isAppendTo,notFireSelectionchange){var me=this;me.fireEvent('beforesetcontent',html);var root=UE.htmlparser(html);me.filterInputRule(root);html=root.toHtml();me.body.innerHTML=(isAppendTo?me.body.innerHTML:'')+html;function isCdataDiv(node){return node.tagName=='DIV'&&node.getAttribute('cdata_tag');}
if(me.options.enterTag=='p'){var child=this.body.firstChild,tmpNode;if(!child||child.nodeType==1&&(dtd.$cdata[child.tagName]||isCdataDiv(child)||domUtils.isCustomeNode(child))&&child===this.body.lastChild){this.body.innerHTML='<p>'+(browser.ie?'&nbsp;':'<br/>')+'</p>'+this.body.innerHTML;}else{var p=me.document.createElement('p');while(child){while(child&&(child.nodeType==3||child.nodeType==1&&dtd.p[child.tagName]&&!dtd.$cdata[child.tagName])){tmpNode=child.nextSibling;p.appendChild(child);child=tmpNode;}if(p.firstChild){if(!child){me.body.appendChild(p);break;}else{child.parentNode.insertBefore(p,child);p=me.document.createElement('p');}}child=child.nextSibling;}}}me.fireEvent('aftersetcontent');me.fireEvent('contentchange');!notFireSelectionchange&&me._selectionChange();me._bakRange=me._bakIERange=me._bakNativeRange=null;var geckoSel;if(browser.gecko&&(geckoSel=this.selection.getNative())){geckoSel.removeAllRanges();}if(me.options.autoSyncData){me.form&&setValue(me.form,me);}},focus:function focus(toEnd){try{var me=this,rng=me.selection.getRange();if(toEnd){var node=me.body.lastChild;if(node&&node.nodeType==1&&!dtd.$empty[node.tagName]){if(domUtils.isEmptyBlock(node)){rng.setStartAtFirst(node);}else{rng.setStartAtLast(node);}rng.collapse(true);}rng.setCursor(true);}else{if(!rng.collapsed&&domUtils.isBody(rng.startContainer)&&rng.startOffset==0){var node=me.body.firstChild;if(node&&node.nodeType==1&&!dtd.$empty[node.tagName]){rng.setStartAtFirst(node).collapse(true);}}rng.select(true);}this.fireEvent('focus selectionchange');}catch(e){}},isFocus:function isFocus(){return this.selection.isFocus();},blur:function blur(){var sel=this.selection.getNative();if(sel.empty&&browser.ie){var nativeRng=document.body.createTextRange();nativeRng.moveToElementText(document.body);nativeRng.collapse(true);nativeRng.select();sel.empty();}else{sel.removeAllRanges();}},_initEvents:function _initEvents(){var me=this,doc=me.document,win=me.window;me._proxyDomEvent=utils.bind(me._proxyDomEvent,me);domUtils.on(doc,['click','contextmenu','mousedown','keydown','keyup','keypress','mouseup','mouseover','mouseout','selectstart'],me._proxyDomEvent);domUtils.on(win,['focus','blur'],me._proxyDomEvent);domUtils.on(me.body,'drop',function(e){if(browser.gecko&&e.stopPropagation){e.stopPropagation();}me.fireEvent('contentchange');});domUtils.on(doc,['mouseup','keydown'],function(evt){if(evt.type=='keydown'&&(evt.ctrlKey||evt.metaKey||evt.shiftKey||evt.altKey)){return;}if(evt.button==2)return;me._selectionChange(250,evt);});},_proxyDomEvent:function _proxyDomEvent(evt){if(this.fireEvent('before'+evt.type.replace(/^on/,'').toLowerCase())===false){return false;}if(this.fireEvent(evt.type.replace(/^on/,''),evt)===false){return false;}return this.fireEvent('after'+evt.type.replace(/^on/,'').toLowerCase());},_selectionChange:function _selectionChange(delay,evt){var me=this;var hackForMouseUp=false;var mouseX,mouseY;if(browser.ie&&browser.version<9&&evt&&evt.type=='mouseup'){var range=this.selection.getRange();if(!range.collapsed){hackForMouseUp=true;mouseX=evt.clientX;mouseY=evt.clientY;}}clearTimeout(_selectionChangeTimer);_selectionChangeTimer=setTimeout(function(){if(!me.selection||!me.selection.getNative()){return;}
var ieRange;if(hackForMouseUp&&me.selection.getNative().type=='None'){ieRange=me.document.body.createTextRange();try{ieRange.moveToPoint(mouseX,mouseY);}catch(ex){ieRange=null;}}var bakGetIERange;if(ieRange){bakGetIERange=me.selection.getIERange;me.selection.getIERange=function(){return ieRange;};}me.selection.cache();if(bakGetIERange){me.selection.getIERange=bakGetIERange;}if(me.selection._cachedRange&&me.selection._cachedStartElement){me.fireEvent('beforeselectionchange');me.fireEvent('selectionchange',!!evt);me.fireEvent('afterselectionchange');me.selection.clear();}},delay||50);},_callCmdFn:function _callCmdFn(fnName,args){var cmdName=args[0].toLowerCase(),cmd,cmdFn;cmd=this.commands[cmdName]||UE.commands[cmdName];cmdFn=cmd&&cmd[fnName];if((!cmd||!cmdFn)&&fnName=='queryCommandState'){return 0;}else if(cmdFn){return cmdFn.apply(this,args);}},execCommand:function execCommand(cmdName){cmdName=cmdName.toLowerCase();var me=this,result,cmd=me.commands[cmdName]||UE.commands[cmdName];if(!cmd||!cmd.execCommand){return null;}if(!cmd.notNeedUndo&&!me.__hasEnterExecCommand){me.__hasEnterExecCommand=true;if(me.queryCommandState.apply(me,arguments)!=-1){me.fireEvent('saveScene');me.fireEvent.apply(me,['beforeexeccommand',cmdName].concat(arguments));result=this._callCmdFn('execCommand',arguments);me.fireEvent.apply(me,['afterexeccommand',cmdName].concat(arguments));me.fireEvent('saveScene');}me.__hasEnterExecCommand=false;}else{result=this._callCmdFn('execCommand',arguments);!me.__hasEnterExecCommand&&!cmd.ignoreContentChange&&!me._ignoreContentChange&&me.fireEvent('contentchange');}!me.__hasEnterExecCommand&&!cmd.ignoreContentChange&&!me._ignoreContentChange&&me._selectionChange();return result;},queryCommandState:function queryCommandState(cmdName){return this._callCmdFn('queryCommandState',arguments);},queryCommandValue:function queryCommandValue(cmdName){return this._callCmdFn('queryCommandValue',arguments);},hasContents:function hasContents(tags){if(tags){for(var i=0,ci;ci=tags[i++];){if(this.document.getElementsByTagName(ci).length>0){return true;}}}if(!domUtils.isEmptyBlock(this.body)){return true;}
tags=['div'];for(i=0;ci=tags[i++];){var nodes=domUtils.getElementsByTagName(this.document,ci);for(var n=0,cn;cn=nodes[n++];){if(domUtils.isCustomeNode(cn)){return true;}}}return false;},reset:function reset(){this.fireEvent('reset');},setEnabled:function setEnabled(){var me=this,range;if(me.body.contentEditable=='false'){me.body.contentEditable=true;range=me.selection.getRange();try{range.moveToBookmark(me.lastBk);delete me.lastBk;}catch(e){range.setStartAtFirst(me.body).collapse(true);}range.select(true);if(me.bkqueryCommandState){me.queryCommandState=me.bkqueryCommandState;delete me.bkqueryCommandState;}if(me.bkqueryCommandValue){me.queryCommandValue=me.bkqueryCommandValue;delete me.bkqueryCommandValue;}me.fireEvent('selectionchange');}},enable:function enable(){return this.setEnabled();},setDisabled:function setDisabled(except){var me=this;except=except?utils.isArray(except)?except:[except]:[];if(me.body.contentEditable=='true'){if(!me.lastBk){me.lastBk=me.selection.getRange().createBookmark(true);}me.body.contentEditable=false;me.bkqueryCommandState=me.queryCommandState;me.bkqueryCommandValue=me.queryCommandValue;me.queryCommandState=function(type){if(utils.indexOf(except,type)!=-1){return me.bkqueryCommandState.apply(me,arguments);}return-1;};me.queryCommandValue=function(type){if(utils.indexOf(except,type)!=-1){return me.bkqueryCommandValue.apply(me,arguments);}return null;};me.fireEvent('selectionchange');}},disable:function disable(except){return this.setDisabled(except);},_setDefaultContent:function(){function clear(){var me=this;if(me.document.getElementById('initContent')){me.body.innerHTML='<p>'+(ie?'':'<br/>')+'</p>';me.removeListener('firstBeforeExecCommand focus',clear);setTimeout(function(){me.focus();me._selectionChange();},0);}}return function(cont){var me=this;me.body.innerHTML='<p id="initContent">'+cont+'</p>';me.addListener('firstBeforeExecCommand focus',clear);};}(),setShow:function setShow(){var me=this,range=me.selection.getRange();if(me.container.style.display=='none'){try{range.moveToBookmark(me.lastBk);delete me.lastBk;}catch(e){range.setStartAtFirst(me.body).collapse(true);}
setTimeout(function(){range.select(true);},100);me.container.style.display='';}},show:function show(){return this.setShow();},setHide:function setHide(){var me=this;if(!me.lastBk){me.lastBk=me.selection.getRange().createBookmark(true);}me.container.style.display='none';},hide:function hide(){return this.setHide();},getLang:function getLang(path){var lang=UE.I18N[this.options.lang];if(!lang){throw Error("not import language file");}path=(path||"").split(".");for(var i=0,ci;ci=path[i++];){lang=lang[ci];if(!lang)break;}return lang;},getContentLength:function getContentLength(ingoneHtml,tagNames){var count=this.getContent(false,false,true).length;if(ingoneHtml){tagNames=(tagNames||[]).concat(['hr','img','iframe']);count=this.getContentTxt().replace(/[\t\r\n]+/g,'').length;for(var i=0,ci;ci=tagNames[i++];){count+=this.document.getElementsByTagName(ci).length;}}return count;},addInputRule:function addInputRule(rule){this.inputRules.push(rule);},filterInputRule:function filterInputRule(root){for(var i=0,ci;ci=this.inputRules[i++];){ci.call(this,root);}},addOutputRule:function addOutputRule(rule){this.outputRules.push(rule);},filterOutputRule:function filterOutputRule(root){for(var i=0,ci;ci=this.outputRules[i++];){ci.call(this,root);}},getActionUrl:function getActionUrl(action){var actionName=this.getOpt(action)||action,imageUrl=this.getOpt('imageUrl'),serverUrl=this.getOpt('serverUrl');if(!serverUrl&&imageUrl){serverUrl=imageUrl.replace(/^(.*[\/]).+([\.].+)$/,'$1controller$2');}if(serverUrl){serverUrl=serverUrl+(serverUrl.indexOf('?')==-1?'?':'&')+'action='+(actionName||'');return utils.formatUrl(serverUrl);}else{return'';}}};utils.inherits(Editor,EventBase);})();UE.Editor.defaultOptions=function(editor){var _url=editor.options.UEDITOR_HOME_URL;return{isShow:true,initialContent:'',initialStyle:'',autoClearinitialContent:false,iframeCssUrl:_url+'themes/iframe.css',textarea:'editorValue',focus:false,focusInEnd:true,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:'p',customDomain:false,lang:'zh-cn',langPath:_url+'lang/',theme:'default',themePath:_url+'themes/',allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false,autoSyncData:true,fileNameFormat:'{time}{rand:6}'};};(function(){UE.Editor.prototype.loadServerConfig=function(){var me=this;setTimeout(function(){try{me.options.imageUrl&&me.setOpt('serverUrl',me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,'$1controller$2'));var configUrl=me.getActionUrl('config'),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=false;configUrl&&UE.ajax.request(configUrl,{'method':'GET','dataType':isJsonp?'jsonp':'','onsuccess':function onsuccess(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config);me.fireEvent('serverConfigLoaded');me._serverConfigLoaded=true;}catch(e){showErrorMsg(me.getLang('loadconfigFormatError'));}},'onerror':function onerror(){showErrorMsg(me.getLang('loadconfigHttpError'));}});}catch(e){showErrorMsg(me.getLang('loadconfigError'));}});function showErrorMsg(msg){console&&console.error(msg);}};UE.Editor.prototype.isServerConfigLoaded=function(){var me=this;return me._serverConfigLoaded||false;};UE.Editor.prototype.afterConfigReady=function(handler){if(!handler||!utils.isFunction(handler))return;var me=this;var readyHandler=function readyHandler(){handler.apply(me,arguments);me.removeListener('serverConfigLoaded',readyHandler);};if(me.isServerConfigLoaded()){handler.call(me,'serverConfigLoaded');}else{me.addListener('serverConfigLoaded',readyHandler);}};})();UE.ajax=function(){var fnStr='XMLHttpRequest()';try{new ActiveXObject("Msxml2.XMLHTTP");fnStr='ActiveXObject(\'Msxml2.XMLHTTP\')';}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP");fnStr='ActiveXObject(\'Microsoft.XMLHTTP\')';}catch(e){}}var creatAjaxRequest=new Function('return new '+fnStr);function json2str(json){var strArr=[];for(var i in json){if(i=="method"||i=="timeout"||i=="async"||i=="dataType"||i=="callback")continue;if(json[i]==undefined||json[i]==null)continue;if(!(_typeof(json[i]).toLowerCase()=="function"||_typeof(json[i]).toLowerCase()=="object")){strArr.push(encodeURIComponent(i)+"="+encodeURIComponent(json[i]));}else if(utils.isArray(json[i])){for(var j=0;j<json[i].length;j++){strArr.push(encodeURIComponent(i)+"[]="+encodeURIComponent(json[i][j]));}}}return strArr.join("&");}function doAjax(url,ajaxOptions){}function doJsonp(url,opts){var successhandler=opts.onsuccess||function(){},scr=document.createElement('SCRIPT'),options=opts||{},charset=options['charset'],callbackField=options['jsonp']||'callback',callbackFnName,timeOut=options['timeOut']||0,timer,reg=new RegExp('(\\?|&)'+callbackField+'=([^&]*)'),matches;if(utils.isFunction(successhandler)){callbackFnName='bd__editor__'+Math.floor(Math.random()*2147483648).toString(36);window[callbackFnName]=getCallBack(0);}else if(utils.isString(successhandler)){callbackFnName=successhandler;}else{if(matches=reg.exec(url)){callbackFnName=matches[2];}}url=url.replace(reg,'\x241'+callbackField+'='+callbackFnName);if(url.search(reg)<0){url+=(url.indexOf('?')<0?'?':'&')+callbackField+'='+callbackFnName;}var queryStr=json2str(opts);if(!utils.isEmptyObject(opts.data)){queryStr+=(queryStr?"&":"")+json2str(opts.data);}if(queryStr){url=url.replace(/\?/,'?'+queryStr+'&');}scr.onerror=getCallBack(1);if(timeOut){timer=setTimeout(getCallBack(1),timeOut);}createScriptTag(scr,url,charset);function createScriptTag(scr,url,charset){scr.setAttribute('type','text/javascript');scr.setAttribute('defer','defer');charset&&scr.setAttribute('charset',charset);scr.setAttribute('src',url);document.getElementsByTagName('head')[0].appendChild(scr);}function getCallBack(onTimeOut){return function(){try{if(onTimeOut){options.onerror&&options.onerror();}else{try{clearTimeout(timer);successhandler.apply(window,arguments);}catch(e){}}}catch(exception){options.onerror&&options.onerror.call(window,exception);}finally{options.oncomplete&&options.oncomplete.apply(window,arguments);scr.parentNode&&scr.parentNode.removeChild(scr);window[callbackFnName]=null;try{delete window[callbackFnName];}catch(e){}}};}}return{request:function request(url,opts){if(opts&&opts.dataType=='jsonp'){doJsonp(url,opts);}else{doAjax(url,opts);}},getJSONP:function getJSONP(url,data,fn){var opts={'data':data,'oncomplete':fn};doJsonp(url,opts);}};}();var filterWord=UE.filterWord=function(){function isWordDocument(str){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(str);}
function transUnit(v){v=v.replace(/[\d.]+\w+/g,function(m){return utils.transUnitToPx(m);});return v;}function filterPasteWord(str){return str.replace(/[\t\r\n]+/g,' ').replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(str){if(browser.opera){return'';}try{if(/Bitmap/i.test(str)){return'';}var width=str.match(/width:([ \d.]*p[tx])/i)[1],height=str.match(/height:([ \d.]*p[tx])/i)[1],src=str.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+transUnit(width)+'" height="'+transUnit(height)+'" src="'+src+'" />';}catch(e){return'';}}).replace(/<\/?div[^>]*>/g,'').replace(/v:\w+=(["']?)[^'"]+\1/g,'').replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(str,name,marks,val){return name=='class'&&val=='MsoListParagraph'?str:'';}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(a,b,c){return c.replace(/[\t\r\n ]+/g,' ');}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(str,tag,tmp,style){var n=[],s=style.replace(/^\s+|\s+$/,'').replace(/&#39;/g,'\'').replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(str){return utils.transUnitToPx(str);}).split(/;\s*/g);for(var i=0,v;v=s[i];i++){var name,value,parts=v.split(":");if(parts.length==2){name=parts[0].toLowerCase();value=parts[1].toLowerCase();if(/^(background)\w*/.test(name)&&value.replace(/(initial|\s)/g,'').length==0||/^(margin)\w*/.test(name)&&/^0\w+$/.test(value)){continue;}switch(name){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(tag))n[i]=name.replace(/^mso-|-alt$/g,"")+":"+transUnit(value);continue;case"horiz-align":n[i]="text-align:"+value;continue;case"vert-align":n[i]="vertical-align:"+value;continue;case"font-color":case"mso-foreground":n[i]="color:"+value;continue;case"mso-background":case"mso-highlight":n[i]="background:"+value;continue;case"mso-default-height":n[i]="min-height:"+transUnit(value);continue;case"mso-default-width":n[i]="min-width:"+transUnit(value);continue;case"mso-padding-between-alt":n[i]="border-collapse:separate;border-spacing:"+transUnit(value);continue;case"text-line-through":if(value=="single"||value=="double"){n[i]="text-decoration:line-through";}continue;case"mso-zero-height":if(value=="yes"){n[i]="display:none";}continue;case'margin':if(!/[1-9]/.test(value)){continue;}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(name)||/text\-indent|padding|margin/.test(name)&&/\-[\d.]+/.test(value)){continue;}n[i]=name+":"+parts[1];}}return tag+(n.length?' style="'+n.join(';').replace(/;{2,}/g,';')+'"':'');});}return function(html){return isWordDocument(html)?filterPasteWord(html):html;};}();(function(){var uNode=UE.uNode=function(obj){this.type=obj.type;this.data=obj.data;this.tagName=obj.tagName;this.parentNode=obj.parentNode;this.attrs=obj.attrs||{};this.children=obj.children;};var notTransAttrs={'href':1,'src':1,'_src':1,'_href':1,'cdata_data':1};var notTransTagName={style:1,script:1};var indentChar='    ',breakChar='\n';function insertLine(arr,current,begin){arr.push(breakChar);return current+(begin?1:-1);}function insertIndent(arr,current){for(var i=0;i<current;i++){arr.push(indentChar);}}
uNode.createElement=function(html){if(/[<>]/.test(html)){return UE.htmlparser(html).children[0];}else{return new uNode({type:'element',children:[],tagName:html});}};uNode.createText=function(data,noTrans){return new UE.uNode({type:'text','data':noTrans?data:utils.unhtml(data||'')});};function nodeToHtml(node,arr,formatter,current){switch(node.type){case'root':for(var i=0,ci;ci=node.children[i++];){if(formatter&&ci.type=='element'&&!dtd.$inlineWithA[ci.tagName]&&i>1){insertLine(arr,current,true);insertIndent(arr,current);}nodeToHtml(ci,arr,formatter,current);}break;case'text':isText(node,arr);break;case'element':isElement(node,arr,formatter,current);break;case'comment':isComment(node,arr,formatter);}return arr;}function isText(node,arr){if(node.parentNode.tagName=='pre'){arr.push(node.data);}else{arr.push(notTransTagName[node.parentNode.tagName]?utils.html(node.data):node.data.replace(/[ ]{2}/g,' &nbsp;'));}}function isElement(node,arr,formatter,current){var attrhtml='';if(node.attrs){attrhtml=[];var attrs=node.attrs;for(var a in attrs){attrhtml.push(a+(attrs[a]!==undefined?'="'+(notTransAttrs[a]?utils.html(attrs[a]).replace(/["]/g,function(a){return'&quot;';}):utils.unhtml(attrs[a]))+'"':''));}attrhtml=attrhtml.join(' ');}arr.push('<'+node.tagName+(attrhtml?' '+attrhtml:'')+(dtd.$empty[node.tagName]?'\/':'')+'>');if(formatter&&!dtd.$inlineWithA[node.tagName]&&node.tagName!='pre'){if(node.children&&node.children.length){current=insertLine(arr,current,true);insertIndent(arr,current);}}if(node.children&&node.children.length){for(var i=0,ci;ci=node.children[i++];){if(formatter&&ci.type=='element'&&!dtd.$inlineWithA[ci.tagName]&&i>1){insertLine(arr,current);insertIndent(arr,current);}nodeToHtml(ci,arr,formatter,current);}}if(!dtd.$empty[node.tagName]){if(formatter&&!dtd.$inlineWithA[node.tagName]&&node.tagName!='pre'){if(node.children&&node.children.length){current=insertLine(arr,current);insertIndent(arr,current);}}arr.push('<\/'+node.tagName+'>');}}function isComment(node,arr){arr.push('<!--'+node.data+'-->');}function _getNodeById(root,id){var node;if(root.type=='element'&&root.getAttr('id')==id){return root;}if(root.children&&root.children.length){for(var i=0,ci;ci=root.children[i++];){if(node=_getNodeById(ci,id)){return node;}}}}function _getNodesByTagName(node,tagName,arr){if(node.type=='element'&&node.tagName==tagName){arr.push(node);}if(node.children&&node.children.length){for(var i=0,ci;ci=node.children[i++];){_getNodesByTagName(ci,tagName,arr);}}}function nodeTraversal(root,fn){if(root.children&&root.children.length){for(var i=0,ci;ci=root.children[i];){nodeTraversal(ci,fn);if(ci.parentNode){if(ci.children&&ci.children.length){fn(ci);}if(ci.parentNode)i++;}}}else{fn(root);}}uNode.prototype={toHtml:function toHtml(formatter){var arr=[];nodeToHtml(this,arr,formatter,0);return arr.join('');},innerHTML:function innerHTML(htmlstr){if(this.type!='element'||dtd.$empty[this.tagName]){return this;}if(utils.isString(htmlstr)){if(this.children){for(var i=0,ci;ci=this.children[i++];){ci.parentNode=null;}}this.children=[];var tmpRoot=UE.htmlparser(htmlstr);for(var i=0,ci;ci=tmpRoot.children[i++];){this.children.push(ci);ci.parentNode=this;}return this;}else{var tmpRoot=new UE.uNode({type:'root',children:this.children});return tmpRoot.toHtml();}},innerText:function innerText(textStr,noTrans){if(this.type!='element'||dtd.$empty[this.tagName]){return this;}if(textStr){if(this.children){for(var i=0,ci;ci=this.children[i++];){ci.parentNode=null;}}this.children=[];this.appendChild(uNode.createText(textStr,noTrans));return this;}else{return this.toHtml().replace(/<[^>]+>/g,'');}},getData:function getData(){if(this.type=='element')return'';return this.data;},firstChild:function firstChild(){return this.children?this.children[0]:null;},lastChild:function lastChild(){return this.children?this.children[this.children.length-1]:null;},previousSibling:function previousSibling(){var parent=this.parentNode;for(var i=0,ci;ci=parent.children[i];i++){if(ci===this){return i==0?null:parent.children[i-1];}}},nextSibling:function nextSibling(){var parent=this.parentNode;for(var i=0,ci;ci=parent.children[i++];){if(ci===this){return parent.children[i];}}},replaceChild:function replaceChild(target,source){if(this.children){if(target.parentNode){target.parentNode.removeChild(target);}for(var i=0,ci;ci=this.children[i];i++){if(ci===source){this.children.splice(i,1,target);source.parentNode=null;target.parentNode=this;return target;}}}},appendChild:function appendChild(node){if(this.type=='root'||this.type=='element'&&!dtd.$empty[this.tagName]){if(!this.children){this.children=[];}if(node.parentNode){node.parentNode.removeChild(node);}for(var i=0,ci;ci=this.children[i];i++){if(ci===node){this.children.splice(i,1);break;}}this.children.push(node);node.parentNode=this;return node;}},insertBefore:function insertBefore(target,source){if(this.children){if(target.parentNode){target.parentNode.removeChild(target);}for(var i=0,ci;ci=this.children[i];i++){if(ci===source){this.children.splice(i,0,target);target.parentNode=this;return target;}}}},insertAfter:function insertAfter(target,source){if(this.children){if(target.parentNode){target.parentNode.removeChild(target);}for(var i=0,ci;ci=this.children[i];i++){if(ci===source){this.children.splice(i+1,0,target);target.parentNode=this;return target;}}}},removeChild:function removeChild(node,keepChildren){if(this.children){for(var i=0,ci;ci=this.children[i];i++){if(ci===node){this.children.splice(i,1);ci.parentNode=null;if(keepChildren&&ci.children&&ci.children.length){for(var j=0,cj;cj=ci.children[j];j++){this.children.splice(i+j,0,cj);cj.parentNode=this;}}return ci;}}}},getAttr:function getAttr(attrName){return this.attrs&&this.attrs[attrName.toLowerCase()];},setAttr:function setAttr(attrName,attrVal){if(!attrName){delete this.attrs;return;}if(!this.attrs){this.attrs={};}if(utils.isObject(attrName)){for(var a in attrName){if(!attrName[a]){delete this.attrs[a];}else{this.attrs[a.toLowerCase()]=attrName[a];}}}else{if(!attrVal){delete this.attrs[attrName];}else{this.attrs[attrName.toLowerCase()]=attrVal;}}},getIndex:function getIndex(){var parent=this.parentNode;for(var i=0,ci;ci=parent.children[i];i++){if(ci===this){return i;}}return-1;},getNodeById:function getNodeById(id){var node;if(this.children&&this.children.length){for(var i=0,ci;ci=this.children[i++];){if(node=_getNodeById(ci,id)){return node;}}}},getNodesByTagName:function getNodesByTagName(tagNames){tagNames=utils.trim(tagNames).replace(/[ ]{2,}/g,' ').split(' ');var arr=[],me=this;utils.each(tagNames,function(tagName){if(me.children&&me.children.length){for(var i=0,ci;ci=me.children[i++];){_getNodesByTagName(ci,tagName,arr);}}});return arr;},getStyle:function getStyle(name){var cssStyle=this.getAttr('style');if(!cssStyle){return'';}var reg=new RegExp('(^|;)\\s*'+name+':([^;]+)','i');var match=cssStyle.match(reg);if(match&&match[0]){return match[2];}return'';},setStyle:function setStyle(name,val){function exec(name,val){var reg=new RegExp('(^|;)\\s*'+name+':([^;]+;?)','gi');cssStyle=cssStyle.replace(reg,'$1');if(val){cssStyle=name+':'+utils.unhtml(val)+';'+cssStyle;}}var cssStyle=this.getAttr('style');if(!cssStyle){cssStyle='';}if(utils.isObject(name)){for(var a in name){exec(a,name[a]);}}else{exec(name,val);}this.setAttr('style',utils.trim(cssStyle));},traversal:function traversal(fn){if(this.children&&this.children.length){nodeTraversal(this,fn);}return this;}};})();var htmlparser=UE.htmlparser=function(htmlstr,ignoreBlank){var re_tag=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,re_attr=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g;var allowEmptyTags={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};htmlstr=htmlstr.replace(new RegExp(domUtils.fillChar,'g'),'');if(!ignoreBlank){htmlstr=htmlstr.replace(new RegExp('[\\r\\t\\n'+(ignoreBlank?'':' ')+']*<\/?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n'+(ignoreBlank?'':' ')+']*','g'),function(a,b){if(b&&allowEmptyTags[b.toLowerCase()]){return a.replace(/(^[\n\r]+)|([\n\r]+$)/g,'');}return a.replace(new RegExp('^[\\r\\n'+(ignoreBlank?'':' ')+']+'),'').replace(new RegExp('[\\r\\n'+(ignoreBlank?'':' ')+']+$'),'');});}var notTransAttrs={'href':1,'src':1};var uNode=UE.uNode,needParentNode={'td':'tr','tr':['tbody','thead','tfoot'],'tbody':'table','th':'tr','thead':'table','tfoot':'table','caption':'table','li':['ul','ol'],'dt':'dl','dd':'dl','option':'select'},needChild={'ol':'li','ul':'li'};function text(parent,data){if(needChild[parent.tagName]){var tmpNode=uNode.createElement(needChild[parent.tagName]);parent.appendChild(tmpNode);tmpNode.appendChild(uNode.createText(data));parent=tmpNode;}else{parent.appendChild(uNode.createText(data));}}function element(parent,tagName,htmlattr){var needParentTag;if(needParentTag=needParentNode[tagName]){var tmpParent=parent,hasParent;while(tmpParent.type!='root'){if(utils.isArray(needParentTag)?utils.indexOf(needParentTag,tmpParent.tagName)!=-1:needParentTag==tmpParent.tagName){parent=tmpParent;hasParent=true;break;}tmpParent=tmpParent.parentNode;}if(!hasParent){parent=element(parent,utils.isArray(needParentTag)?needParentTag[0]:needParentTag);}}
var elm=new uNode({parentNode:parent,type:'element',tagName:tagName.toLowerCase(),children:dtd.$empty[tagName]?null:[]});if(htmlattr){var attrs={},match;while(match=re_attr.exec(htmlattr)){attrs[match[1].toLowerCase()]=notTransAttrs[match[1].toLowerCase()]?match[2]||match[3]||match[4]:utils.unhtml(match[2]||match[3]||match[4]);}elm.attrs=attrs;}
parent.children.push(elm);return dtd.$empty[tagName]?parent:elm;}function comment(parent,data){parent.children.push(new uNode({type:'comment',data:data,parentNode:parent}));}var match,currentIndex=0,nextIndex=0;var root=new uNode({type:'root',children:[]});var currentParent=root;while(match=re_tag.exec(htmlstr)){currentIndex=match.index;try{if(currentIndex>nextIndex){text(currentParent,htmlstr.slice(nextIndex,currentIndex));}if(match[3]){if(dtd.$cdata[currentParent.tagName]){text(currentParent,match[0]);}else{currentParent=element(currentParent,match[3].toLowerCase(),match[4]);}}else if(match[1]){if(currentParent.type!='root'){if(dtd.$cdata[currentParent.tagName]&&!dtd.$cdata[match[1]]){text(currentParent,match[0]);}else{var tmpParent=currentParent;while(currentParent.type=='element'&&currentParent.tagName!=match[1].toLowerCase()){currentParent=currentParent.parentNode;if(currentParent.type=='root'){currentParent=tmpParent;throw'break';}}
currentParent=currentParent.parentNode;}}}else if(match[2]){comment(currentParent,match[2]);}}catch(e){}nextIndex=re_tag.lastIndex;}
if(nextIndex<htmlstr.length){text(currentParent,htmlstr.slice(nextIndex));}return root;};var filterNode=UE.filterNode=function(){function filterNode(node,rules){switch(node.type){case'text':break;case'element':var val;if(val=rules[node.tagName]){if(val==='-'){node.parentNode.removeChild(node);}else if(utils.isFunction(val)){var parentNode=node.parentNode,index=node.getIndex();val(node);if(node.parentNode){if(node.children){for(var i=0,ci;ci=node.children[i];){filterNode(ci,rules);if(ci.parentNode){i++;}}}}else{for(var i=index,ci;ci=parentNode.children[i];){filterNode(ci,rules);if(ci.parentNode){i++;}}}}else{var attrs=val['$'];if(attrs&&node.attrs){var tmpAttrs={},tmpVal;for(var a in attrs){tmpVal=node.getAttr(a);if(a=='style'&&utils.isArray(attrs[a])){var tmpCssStyle=[];utils.each(attrs[a],function(v){var tmp;if(tmp=node.getStyle(v)){tmpCssStyle.push(v+':'+tmp);}});tmpVal=tmpCssStyle.join(';');}if(tmpVal){tmpAttrs[a]=tmpVal;}}node.attrs=tmpAttrs;}if(node.children){for(var i=0,ci;ci=node.children[i];){filterNode(ci,rules);if(ci.parentNode){i++;}}}}}else{if(dtd.$cdata[node.tagName]){node.parentNode.removeChild(node);}else{var parentNode=node.parentNode,index=node.getIndex();node.parentNode.removeChild(node,true);for(var i=index,ci;ci=parentNode.children[i];){filterNode(ci,rules);if(ci.parentNode){i++;}}}}break;case'comment':node.parentNode.removeChild(node);}}return function(root,rules){if(utils.isEmptyObject(rules)){return root;}var val;if(val=rules['-']){utils.each(val.split(' '),function(k){rules[k]='-';});}for(var i=0,ci;ci=root.children[i];){filterNode(ci,rules);if(ci.parentNode){i++;}}return root;};}();UE.plugin=function(){var _plugins={};return{register:function register(pluginName,fn,oldOptionName,afterDisabled){if(oldOptionName&&utils.isFunction(oldOptionName)){afterDisabled=oldOptionName;oldOptionName=null;}_plugins[pluginName]={optionName:oldOptionName||pluginName,execFn:fn,afterDisabled:afterDisabled};},load:function load(editor){utils.each(_plugins,function(plugin){var _export=plugin.execFn.call(editor);if(editor.options[plugin.optionName]!==false){if(_export){utils.each(_export,function(v,k){switch(k.toLowerCase()){case'shortcutkey':editor.addshortcutkey(v);break;case'bindevents':utils.each(v,function(fn,eventName){editor.addListener(eventName,fn);});break;case'bindmultievents':utils.each(utils.isArray(v)?v:[v],function(event){var types=utils.trim(event.type).split(/\s+/);utils.each(types,function(eventName){editor.addListener(eventName,event.handler);});});break;case'commands':utils.each(v,function(execFn,execName){editor.commands[execName]=execFn;});break;case'outputrule':editor.addOutputRule(v);break;case'inputrule':editor.addInputRule(v);break;case'defaultoptions':editor.setOpt(v);}});}}else if(plugin.afterDisabled){plugin.afterDisabled.call(editor);}});utils.each(UE.plugins,function(plugin){plugin.call(editor);});},run:function run(pluginName,editor){var plugin=_plugins[pluginName];if(plugin){plugin.exeFn.call(editor);}}};}();var keymap=UE.keymap={'Backspace':8,'Tab':9,'Enter':13,'Shift':16,'Control':17,'Alt':18,'CapsLock':20,'Esc':27,'Spacebar':32,'PageUp':33,'PageDown':34,'End':35,'Home':36,'Left':37,'Up':38,'Right':39,'Down':40,'Insert':45,'Del':46,'NumLock':144,'Cmd':91,'=':187,'-':189,"b":66,'i':73,'z':90,'y':89,'v':86,'x':88,'s':83,'n':78};var LocalStorage=UE.LocalStorage=function(){var storage=window.localStorage||getUserData()||null,LOCAL_FILE='localStorage';return{saveLocalData:function saveLocalData(key,data){if(storage&&data){storage.setItem(key,data);return true;}return false;},getLocalData:function getLocalData(key){if(storage){return storage.getItem(key);}return null;},removeItem:function removeItem(key){storage&&storage.removeItem(key);}};function getUserData(){var container=document.createElement("div");container.style.display="none";if(!container.addBehavior){return null;}container.addBehavior("#default#userdata");return{getItem:function getItem(key){var result=null;try{document.body.appendChild(container);container.load(LOCAL_FILE);result=container.getAttribute(key);document.body.removeChild(container);}catch(e){}return result;},setItem:function setItem(key,value){document.body.appendChild(container);container.setAttribute(key,value);container.save(LOCAL_FILE);document.body.removeChild(container);},removeItem:function removeItem(key){document.body.appendChild(container);container.removeAttribute(key);container.save(LOCAL_FILE);document.body.removeChild(container);}};}}();(function(){var ROOTKEY='ueditor_preference';UE.Editor.prototype.setPreferences=function(key,value){var obj={};if(utils.isString(key)){obj[key]=value;}else{obj=key;}var data=LocalStorage.getLocalData(ROOTKEY);if(data&&(data=utils.str2json(data))){utils.extend(data,obj);}else{data=obj;}data&&LocalStorage.saveLocalData(ROOTKEY,utils.json2str(data));};UE.Editor.prototype.getPreferences=function(key){var data=LocalStorage.getLocalData(ROOTKEY);if(data&&(data=utils.str2json(data))){return key?data[key]:data;}return null;};UE.Editor.prototype.removePreferences=function(key){var data=LocalStorage.getLocalData(ROOTKEY);if(data&&(data=utils.str2json(data))){data[key]=undefined;delete data[key];}data&&LocalStorage.saveLocalData(ROOTKEY,utils.json2str(data));};})();UE.plugins['defaultfilter']=function(){var me=this;me.setOpt({'allowDivTransToP':true,'disabledTableInTable':true});me.addInputRule(function(root){var allowDivTransToP=this.options.allowDivTransToP;var val;function tdParent(node){while(node&&node.type=='element'){if(node.tagName=='td'){return true;}node=node.parentNode;}return false;}
root.traversal(function(node){if(node.type=='element'){if(!dtd.$cdata[node.tagName]&&me.options.autoClearEmptyNode&&dtd.$inline[node.tagName]&&!dtd.$empty[node.tagName]&&(!node.attrs||utils.isEmptyObject(node.attrs))){if(!node.firstChild())node.parentNode.removeChild(node);else if(node.tagName=='span'&&(!node.attrs||utils.isEmptyObject(node.attrs))){node.parentNode.removeChild(node,true);}return;}switch(node.tagName){case'style':case'script':node.setAttr({cdata_tag:node.tagName,cdata_data:node.innerHTML()||'','_ue_custom_node_':'true'});node.tagName='div';node.innerHTML('');break;case'a':if(val=node.getAttr('href')){node.setAttr('_href',val);}break;case'img':if(val=node.getAttr('src')){if(/^data:/.test(val)){node.parentNode.removeChild(node);break;}}node.setAttr('_src',node.getAttr('src'));break;case'span':if(browser.webkit&&(val=node.getStyle('white-space'))){if(/nowrap|normal/.test(val)){node.setStyle('white-space','');if(me.options.autoClearEmptyNode&&utils.isEmptyObject(node.attrs)){node.parentNode.removeChild(node,true);}}}val=node.getAttr('id');if(val&&/^_baidu_bookmark_/i.test(val)){node.parentNode.removeChild(node);}break;case'p':if(val=node.getAttr('align')){node.setAttr('align');node.setStyle('text-align',val);}
utils.each(node.children,function(n){if(n.type=='element'&&n.tagName=='p'){var next=n.nextSibling();node.parentNode.insertAfter(n,node);var last=n;while(next){var tmp=next.nextSibling();node.parentNode.insertAfter(next,last);last=next;next=tmp;}return false;}});if(!node.firstChild()){node.innerHTML(browser.ie?'&nbsp;':'<br/>');}break;case'div':if(node.getAttr('cdata_tag')){break;}
val=node.getAttr('class');if(val&&/^line number\d+/.test(val)){break;}if(!allowDivTransToP){break;}var tmpNode,p=UE.uNode.createElement('p');while(tmpNode=node.firstChild()){if(tmpNode.type=='text'||!UE.dom.dtd.$block[tmpNode.tagName]){p.appendChild(tmpNode);}else{if(p.firstChild()){node.parentNode.insertBefore(p,node);p=UE.uNode.createElement('p');}else{node.parentNode.insertBefore(tmpNode,node);}}}if(p.firstChild()){node.parentNode.insertBefore(p,node);}node.parentNode.removeChild(node);break;case'dl':node.tagName='ul';break;case'dt':case'dd':node.tagName='li';break;case'li':var className=node.getAttr('class');if(!className||!/list\-/.test(className)){node.setAttr();}var tmpNodes=node.getNodesByTagName('ol ul');UE.utils.each(tmpNodes,function(n){node.parentNode.insertAfter(n,node);});break;case'td':case'th':case'caption':if(!node.children||!node.children.length){node.appendChild(browser.ie11below?UE.uNode.createText(' '):UE.uNode.createElement('br'));}break;case'table':if(me.options.disabledTableInTable&&tdParent(node)){node.parentNode.insertBefore(UE.uNode.createText(node.innerText()),node);node.parentNode.removeChild(node);}}}});});me.addOutputRule(function(root){var val;root.traversal(function(node){if(node.type=='element'){if(me.options.autoClearEmptyNode&&dtd.$inline[node.tagName]&&!dtd.$empty[node.tagName]&&(!node.attrs||utils.isEmptyObject(node.attrs))){if(!node.firstChild())node.parentNode.removeChild(node);else if(node.tagName=='span'&&(!node.attrs||utils.isEmptyObject(node.attrs))){node.parentNode.removeChild(node,true);}return;}switch(node.tagName){case'div':if(val=node.getAttr('cdata_tag')){node.tagName=val;node.appendChild(UE.uNode.createText(node.getAttr('cdata_data')));node.setAttr({cdata_tag:'',cdata_data:'','_ue_custom_node_':''});}break;case'a':if(val=node.getAttr('_href')){node.setAttr({'href':utils.html(val),'_href':''});}break;break;case'span':val=node.getAttr('id');if(val&&/^_baidu_bookmark_/i.test(val)){node.parentNode.removeChild(node);}break;case'img':if(val=node.getAttr('_src')){node.setAttr({'src':node.getAttr('_src'),'_src':''});}}}});});};UE.commands['inserthtml']={execCommand:function execCommand(command,html,notNeedFilter){var me=this,range,div;if(!html){return;}if(me.fireEvent('beforeinserthtml',html)===true){return;}range=me.selection.getRange();div=range.document.createElement('div');div.style.display='inline';if(!notNeedFilter){var root=UE.htmlparser(html);if(me.options.filterRules){UE.filterNode(root,me.options.filterRules);}
me.filterInputRule(root);html=root.toHtml();}div.innerHTML=utils.trim(html);if(!range.collapsed){var tmpNode=range.startContainer;if(domUtils.isFillChar(tmpNode)){range.setStartBefore(tmpNode);}tmpNode=range.endContainer;if(domUtils.isFillChar(tmpNode)){range.setEndAfter(tmpNode);}range.txtToElmBoundary();if(range.endContainer&&range.endContainer.nodeType==1){tmpNode=range.endContainer.childNodes[range.endOffset];if(tmpNode&&domUtils.isBr(tmpNode)){range.setEndAfter(tmpNode);}}if(range.startOffset==0){tmpNode=range.startContainer;if(domUtils.isBoundaryNode(tmpNode,'firstChild')){tmpNode=range.endContainer;if(range.endOffset==(tmpNode.nodeType==3?tmpNode.nodeValue.length:tmpNode.childNodes.length)&&domUtils.isBoundaryNode(tmpNode,'lastChild')){me.body.innerHTML='<p>'+(browser.ie?'':'<br/>')+'</p>';range.setStart(me.body.firstChild,0).collapse(true);}}}!range.collapsed&&range.deleteContents();if(range.startContainer.nodeType==1){var child=range.startContainer.childNodes[range.startOffset],pre;if(child&&domUtils.isBlockElm(child)&&(pre=child.previousSibling)&&domUtils.isBlockElm(pre)){range.setEnd(pre,pre.childNodes.length).collapse();while(child.firstChild){pre.appendChild(child.firstChild);}domUtils.remove(child);}}}var child,parent,pre,tmp,hadBreak=0,nextNode;if(range.inFillChar()){child=range.startContainer;if(domUtils.isFillChar(child)){range.setStartBefore(child).collapse(true);domUtils.remove(child);}else if(domUtils.isFillChar(child,true)){child.nodeValue=child.nodeValue.replace(fillCharReg,'');range.startOffset--;range.collapsed&&range.collapse(true);}}
var li=domUtils.findParentByTagName(range.startContainer,'li',true);if(li){var next,last;while(child=div.firstChild){while(child&&(child.nodeType==3||!domUtils.isBlockElm(child)||child.tagName=='HR')){next=child.nextSibling;range.insertNode(child).collapse();last=child;child=next;}if(child){if(/^(ol|ul)$/i.test(child.tagName)){while(child.firstChild){last=child.firstChild;domUtils.insertAfter(li,child.firstChild);li=li.nextSibling;}domUtils.remove(child);}else{var tmpLi;next=child.nextSibling;tmpLi=me.document.createElement('li');domUtils.insertAfter(li,tmpLi);tmpLi.appendChild(child);last=child;child=next;li=tmpLi;}}}li=domUtils.findParentByTagName(range.startContainer,'li',true);if(domUtils.isEmptyBlock(li)){domUtils.remove(li);}if(last){range.setStartAfter(last).collapse(true).select(true);}}else{while(child=div.firstChild){if(hadBreak){var p=me.document.createElement('p');while(child&&(child.nodeType==3||!dtd.$block[child.tagName])){nextNode=child.nextSibling;p.appendChild(child);child=nextNode;}if(p.firstChild){child=p;}}range.insertNode(child);nextNode=child.nextSibling;if(!hadBreak&&child.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(child)){parent=domUtils.findParent(child,function(node){return domUtils.isBlockElm(node);});if(parent&&parent.tagName.toLowerCase()!='body'&&!(dtd[parent.tagName][child.nodeName]&&child.parentNode===parent)){if(!dtd[parent.tagName][child.nodeName]){pre=parent;}else{tmp=child.parentNode;while(tmp!==parent){pre=tmp;tmp=tmp.parentNode;}}domUtils.breakParent(child,pre||tmp);var pre=child.previousSibling;domUtils.trimWhiteTextNode(pre);if(!pre.childNodes.length){domUtils.remove(pre);}
if(!browser.ie&&(next=child.nextSibling)&&domUtils.isBlockElm(next)&&next.lastChild&&!domUtils.isBr(next.lastChild)){next.appendChild(me.document.createElement('br'));}hadBreak=1;}}var next=child.nextSibling;if(!div.firstChild&&next&&domUtils.isBlockElm(next)){range.setStart(next,0).collapse(true);break;}range.setEndAfter(child).collapse();}child=range.startContainer;if(nextNode&&domUtils.isBr(nextNode)){domUtils.remove(nextNode);}
if(domUtils.isBlockElm(child)&&domUtils.isEmptyNode(child)){if(nextNode=child.nextSibling){domUtils.remove(child);if(nextNode.nodeType==1&&dtd.$block[nextNode.tagName]){range.setStart(nextNode,0).collapse(true).shrinkBoundary();}}else{try{child.innerHTML=browser.ie?domUtils.fillChar:'<br/>';}catch(e){range.setStartBefore(child);domUtils.remove(child);}}}
try{range.select(true);}catch(e){}}setTimeout(function(){range=me.selection.getRange();range.scrollToView(me.autoHeightEnabled,me.autoHeightEnabled?domUtils.getXY(me.iframe).y:0);me.fireEvent('afterinserthtml',html);},200);}};UE.plugins['autotypeset']=function(){this.setOpt({'autotypeset':{mergeEmptyline:true,removeClass:true,removeEmptyline:false,textAlign:"left",imageBlockLine:'center',pasteFilter:false,clearFontSize:false,clearFontFamily:false,removeEmptyNode:false,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:false,indentValue:'2em',bdc2sb:false,tobdc:false}});var me=this,opt=me.options.autotypeset,remainClass={'selectTdClass':1,'pagebreak':1,'anchorclass':1},remainTag={'li':1},tags={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},highlightCont;if(!opt){return;}readLocalOpts();function isLine(node,notEmpty){if(!node||node.nodeType==3)return 0;if(domUtils.isBr(node))return 1;if(node&&node.parentNode&&tags[node.tagName.toLowerCase()]){if(highlightCont&&highlightCont.contains(node)||node.getAttribute('pagebreak')){return 0;}return notEmpty?!domUtils.isEmptyBlock(node):domUtils.isEmptyBlock(node,new RegExp('[\\s'+domUtils.fillChar+']','g'));}}function removeNotAttributeSpan(node){if(!node.style.cssText){domUtils.removeAttributes(node,['style']);if(node.tagName.toLowerCase()=='span'&&domUtils.hasNoAttributes(node)){domUtils.remove(node,true);}}}function autotype(type,html){var me=this,cont;if(html){if(!opt.pasteFilter){return;}cont=me.document.createElement('div');cont.innerHTML=html.html;}else{cont=me.document.body;}var nodes=domUtils.getElementsByTagName(cont,'*');for(var i=0,ci;ci=nodes[i++];){if(me.fireEvent('excludeNodeinautotype',ci)===true){continue;}
if(opt.clearFontSize&&ci.style.fontSize){domUtils.removeStyle(ci,'font-size');removeNotAttributeSpan(ci);}
if(opt.clearFontFamily&&ci.style.fontFamily){domUtils.removeStyle(ci,'font-family');removeNotAttributeSpan(ci);}if(isLine(ci)){if(opt.mergeEmptyline){var next=ci.nextSibling,tmpNode,isBr=domUtils.isBr(ci);while(isLine(next)){tmpNode=next;next=tmpNode.nextSibling;if(isBr&&(!next||next&&!domUtils.isBr(next))){break;}domUtils.remove(tmpNode);}}
if(opt.removeEmptyline&&domUtils.inDoc(ci,cont)&&!remainTag[ci.parentNode.tagName.toLowerCase()]){if(domUtils.isBr(ci)){next=ci.nextSibling;if(next&&!domUtils.isBr(next)){continue;}}domUtils.remove(ci);continue;}}if(isLine(ci,true)&&ci.tagName!='SPAN'){if(opt.indent){ci.style.textIndent=opt.indentValue;}if(opt.textAlign){ci.style.textAlign=opt.textAlign;}}
if(opt.removeClass&&ci.className&&!remainClass[ci.className.toLowerCase()]){if(highlightCont&&highlightCont.contains(ci)){continue;}domUtils.removeAttributes(ci,['class']);}
if(opt.imageBlockLine&&ci.tagName.toLowerCase()=='img'&&!ci.getAttribute('emotion')){if(html){var img=ci;switch(opt.imageBlockLine){case'left':case'right':case'none':var pN=img.parentNode,tmpNode,pre,next;while(dtd.$inline[pN.tagName]||pN.tagName=='A'){pN=pN.parentNode;}tmpNode=pN;if(tmpNode.tagName=='P'&&domUtils.getStyle(tmpNode,'text-align')=='center'){if(!domUtils.isBody(tmpNode)&&domUtils.getChildCount(tmpNode,function(node){return!domUtils.isBr(node)&&!domUtils.isWhitespace(node);})==1){pre=tmpNode.previousSibling;next=tmpNode.nextSibling;if(pre&&next&&pre.nodeType==1&&next.nodeType==1&&pre.tagName==next.tagName&&domUtils.isBlockElm(pre)){pre.appendChild(tmpNode.firstChild);while(next.firstChild){pre.appendChild(next.firstChild);}domUtils.remove(tmpNode);domUtils.remove(next);}else{domUtils.setStyle(tmpNode,'text-align','');}}}domUtils.setStyle(img,'float',opt.imageBlockLine);break;case'center':if(me.queryCommandValue('imagefloat')!='center'){pN=img.parentNode;domUtils.setStyle(img,'float','none');tmpNode=img;while(pN&&domUtils.getChildCount(pN,function(node){return!domUtils.isBr(node)&&!domUtils.isWhitespace(node);})==1&&(dtd.$inline[pN.tagName]||pN.tagName=='A')){tmpNode=pN;pN=pN.parentNode;}var pNode=me.document.createElement('p');domUtils.setAttributes(pNode,{style:'text-align:center'});tmpNode.parentNode.insertBefore(pNode,tmpNode);pNode.appendChild(tmpNode);domUtils.setStyle(tmpNode,'float','');}}}else{var range=me.selection.getRange();range.selectNode(ci).select();me.execCommand('imagefloat',opt.imageBlockLine);}}
if(opt.removeEmptyNode){if(opt.removeTagNames[ci.tagName.toLowerCase()]&&domUtils.hasNoAttributes(ci)&&domUtils.isEmptyBlock(ci)){domUtils.remove(ci);}}}if(opt.tobdc){var root=UE.htmlparser(cont.innerHTML);root.traversal(function(node){if(node.type=='text'){node.data=ToDBC(node.data);}});cont.innerHTML=root.toHtml();}if(opt.bdc2sb){var root=UE.htmlparser(cont.innerHTML);root.traversal(function(node){if(node.type=='text'){node.data=DBC2SB(node.data);}});cont.innerHTML=root.toHtml();}if(html){html.html=cont.innerHTML;}}if(opt.pasteFilter){me.addListener('beforepaste',autotype);}function DBC2SB(str){var result='';for(var i=0;i<str.length;i++){var code=str.charCodeAt(i);if(code>=65281&&code<=65373)
{result+=String.fromCharCode(str.charCodeAt(i)-65248);}else if(code==12288)
{result+=String.fromCharCode(str.charCodeAt(i)-12288+32);}else{result+=str.charAt(i);}}return result;}function ToDBC(txtstring){txtstring=utils.html(txtstring);var tmp="";var mark="";for(var i=0;i<txtstring.length;i++){if(txtstring.charCodeAt(i)==32){tmp=tmp+String.fromCharCode(12288);}else if(txtstring.charCodeAt(i)<127){tmp=tmp+String.fromCharCode(txtstring.charCodeAt(i)+65248);}else{tmp+=txtstring.charAt(i);}}return tmp;}function readLocalOpts(){var cookieOpt=me.getPreferences('autotypeset');utils.extend(me.options.autotypeset,cookieOpt);}me.commands['autotypeset']={execCommand:function execCommand(){me.removeListener('beforepaste',autotype);if(opt.pasteFilter){me.addListener('beforepaste',autotype);}autotype.call(me);}};};UE.plugin.register('autosubmit',function(){return{shortcutkey:{"autosubmit":"ctrl+13"},commands:{'autosubmit':{execCommand:function execCommand(){var me=this,form=domUtils.findParentByTagName(me.iframe,"form",false);if(form){if(me.fireEvent("beforesubmit")===false){return;}me.sync();form.submit();}}}}};});UE.plugin.register('background',function(){var me=this,cssRuleId='editor_background',isSetColored,reg=new RegExp('body[\\s]*\\{(.+)\\}','i');function stringToObj(str){var obj={},styles=str.split(';');utils.each(styles,function(v){var index=v.indexOf(':'),key=utils.trim(v.substr(0,index)).toLowerCase();key&&(obj[key]=utils.trim(v.substr(index+1)||''));});return obj;}function setBackground(obj){if(obj){var styles=[];for(var name in obj){if(obj.hasOwnProperty(name)){styles.push(name+":"+obj[name]+'; ');}}utils.cssRule(cssRuleId,styles.length?'body{'+styles.join("")+'}':'',me.document);}else{utils.cssRule(cssRuleId,'',me.document);}}
var orgFn=me.hasContents;me.hasContents=function(){if(me.queryCommandValue('background')){return true;}return orgFn.apply(me,arguments);};return{bindEvents:{'getAllHtml':function getAllHtml(type,headHtml){var body=this.body,su=domUtils.getComputedStyle(body,"background-image"),url="";if(su.indexOf(me.options.imagePath)>0){url=su.substring(su.indexOf(me.options.imagePath),su.length-1).replace(/"|\(|\)/ig,"");}else{url=su!="none"?su.replace(/url\("?|"?\)/ig,""):"";}var html='<style type="text/css">body{';var bgObj={"background-color":domUtils.getComputedStyle(body,"background-color")||"#ffffff",'background-image':url?'url('+url+')':'','background-repeat':domUtils.getComputedStyle(body,"background-repeat")||"",'background-position':browser.ie?domUtils.getComputedStyle(body,"background-position-x")+" "+domUtils.getComputedStyle(body,"background-position-y"):domUtils.getComputedStyle(body,"background-position"),'height':domUtils.getComputedStyle(body,"height")};for(var name in bgObj){if(bgObj.hasOwnProperty(name)){html+=name+":"+bgObj[name]+"; ";}}html+='}</style> ';headHtml.push(html);},'aftersetcontent':function aftersetcontent(){if(isSetColored==false)setBackground();}},inputRule:function inputRule(root){isSetColored=false;utils.each(root.getNodesByTagName('p'),function(p){var styles=p.getAttr('data-background');if(styles){isSetColored=true;setBackground(stringToObj(styles));p.parentNode.removeChild(p);}});},outputRule:function outputRule(root){var me=this,styles=(utils.cssRule(cssRuleId,me.document)||'').replace(/[\n\r]+/g,'').match(reg);if(styles){root.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+utils.trim(styles[1].replace(/"/g,'').replace(/[\s]+/g,' '))+'"><br/></p>'));}},commands:{'background':{execCommand:function execCommand(cmd,obj){setBackground(obj);},queryCommandValue:function queryCommandValue(){var me=this,styles=(utils.cssRule(cssRuleId,me.document)||'').replace(/[\n\r]+/g,'').match(reg);return styles?stringToObj(styles[1]):null;},notNeedUndo:true}}};});UE.commands['imagefloat']={execCommand:function execCommand(cmd,align){var me=this,range=me.selection.getRange();if(!range.collapsed){var img=range.getClosedNode();if(img&&img.tagName=='IMG'){switch(align){case'left':case'right':case'none':var pN=img.parentNode,tmpNode,pre,next;while(dtd.$inline[pN.tagName]||pN.tagName=='A'){pN=pN.parentNode;}tmpNode=pN;if(tmpNode.tagName=='P'&&domUtils.getStyle(tmpNode,'text-align')=='center'){if(!domUtils.isBody(tmpNode)&&domUtils.getChildCount(tmpNode,function(node){return!domUtils.isBr(node)&&!domUtils.isWhitespace(node);})==1){pre=tmpNode.previousSibling;next=tmpNode.nextSibling;if(pre&&next&&pre.nodeType==1&&next.nodeType==1&&pre.tagName==next.tagName&&domUtils.isBlockElm(pre)){pre.appendChild(tmpNode.firstChild);while(next.firstChild){pre.appendChild(next.firstChild);}domUtils.remove(tmpNode);domUtils.remove(next);}else{domUtils.setStyle(tmpNode,'text-align','');}}range.selectNode(img).select();}domUtils.setStyle(img,'float',align=='none'?'':align);if(align=='none'){domUtils.removeAttributes(img,'align');}break;case'center':if(me.queryCommandValue('imagefloat')!='center'){pN=img.parentNode;domUtils.setStyle(img,'float','');domUtils.removeAttributes(img,'align');tmpNode=img;while(pN&&domUtils.getChildCount(pN,function(node){return!domUtils.isBr(node)&&!domUtils.isWhitespace(node);})==1&&(dtd.$inline[pN.tagName]||pN.tagName=='A')){tmpNode=pN;pN=pN.parentNode;}range.setStartBefore(tmpNode).setCursor(false);pN=me.document.createElement('div');pN.appendChild(tmpNode);domUtils.setStyle(tmpNode,'float','');me.execCommand('insertHtml','<p id="_img_parent_tmp" style="text-align:center">'+pN.innerHTML+'</p>');tmpNode=me.document.getElementById('_img_parent_tmp');tmpNode.removeAttribute('id');tmpNode=tmpNode.firstChild;range.selectNode(tmpNode).select();next=tmpNode.parentNode.nextSibling;if(next&&domUtils.isEmptyNode(next)){domUtils.remove(next);}}break;}}}},queryCommandValue:function queryCommandValue(){var range=this.selection.getRange(),startNode,floatStyle;if(range.collapsed){return'none';}startNode=range.getClosedNode();if(startNode&&startNode.nodeType==1&&startNode.tagName=='IMG'){floatStyle=domUtils.getComputedStyle(startNode,'float')||startNode.getAttribute('align');if(floatStyle=='none'){floatStyle=domUtils.getComputedStyle(startNode.parentNode,'text-align')=='center'?'center':floatStyle;}return{left:1,right:1,center:1}[floatStyle]?floatStyle:'none';}return'none';},queryCommandState:function queryCommandState(){var range=this.selection.getRange(),startNode;if(range.collapsed)return-1;startNode=range.getClosedNode();if(startNode&&startNode.nodeType==1&&startNode.tagName=='IMG'){return 0;}return-1;}};UE.commands['insertimage']={execCommand:function execCommand(cmd,opt){opt=utils.isArray(opt)?opt:[opt];if(!opt.length){return;}var me=this,range=me.selection.getRange(),img=range.getClosedNode();if(me.fireEvent('beforeinsertimage',opt)===true){return;}if(img&&/img/i.test(img.tagName)&&(img.className!="edui-faked-video"||img.className.indexOf("edui-upload-video")!=-1)&&!img.getAttribute("word_img")){var first=opt.shift();var floatStyle=first['floatStyle'];delete first['floatStyle'];domUtils.setAttributes(img,first);me.execCommand('imagefloat',floatStyle);if(opt.length>0){range.setStartAfter(img).setCursor(false,true);me.execCommand('insertimage',opt);}}else{var html=[],str='',ci;ci=opt[0];if(opt.length==1){str='<img src="'+ci.src+'" '+(ci._src?' _src="'+ci._src+'" ':'')+(ci.width?'width="'+ci.width+'" ':'')+(ci.height?' height="'+ci.height+'" ':'')+(ci['floatStyle']=='left'||ci['floatStyle']=='right'?' style="float:'+ci['floatStyle']+';"':'')+(ci.title&&ci.title!=""?' title="'+ci.title+'"':'')+(ci.border&&ci.border!="0"?' border="'+ci.border+'"':'')+(ci.alt&&ci.alt!=""?' alt="'+ci.alt+'"':'')+(ci.hspace&&ci.hspace!="0"?' hspace = "'+ci.hspace+'"':'')+(ci.vspace&&ci.vspace!="0"?' vspace = "'+ci.vspace+'"':'')+'/>';if(ci['floatStyle']=='center'){str='<p style="text-align: center">'+str+'</p>';}html.push(str);}else{for(var i=0;ci=opt[i++];){str='<p '+(ci['floatStyle']=='center'?'style="text-align: center" ':'')+'><img src="'+ci.src+'" '+(ci.width?'width="'+ci.width+'" ':'')+(ci._src?' _src="'+ci._src+'" ':'')+(ci.height?' height="'+ci.height+'" ':'')+' style="'+(ci['floatStyle']&&ci['floatStyle']!='center'?'float:'+ci['floatStyle']+';':'')+(ci.border||'')+'" '+(ci.title?' title="'+ci.title+'"':'')+' /></p>';html.push(str);}}me.execCommand('insertHtml',html.join(''));}me.fireEvent('afterinsertimage',opt);}};UE.plugins['justify']=function(){var me=this,block=domUtils.isBlockElm,defaultValue={left:1,right:1,center:1,justify:1},doJustify=function doJustify(range,style){var bookmark=range.createBookmark(),filterFn=function filterFn(node){return node.nodeType==1?node.tagName.toLowerCase()!='br'&&!domUtils.isBookmarkNode(node):!domUtils.isWhitespace(node);};range.enlarge(true);var bookmark2=range.createBookmark(),current=domUtils.getNextDomNode(bookmark2.start,false,filterFn),tmpRange=range.cloneRange(),tmpNode;while(current&&!(domUtils.getPosition(current,bookmark2.end)&domUtils.POSITION_FOLLOWING)){if(current.nodeType==3||!block(current)){tmpRange.setStartBefore(current);while(current&&current!==bookmark2.end&&!block(current)){tmpNode=current;current=domUtils.getNextDomNode(current,false,null,function(node){return!block(node);});}tmpRange.setEndAfter(tmpNode);var common=tmpRange.getCommonAncestor();if(!domUtils.isBody(common)&&block(common)){domUtils.setStyles(common,utils.isString(style)?{'text-align':style}:style);current=common;}else{var p=range.document.createElement('p');domUtils.setStyles(p,utils.isString(style)?{'text-align':style}:style);var frag=tmpRange.extractContents();p.appendChild(frag);tmpRange.insertNode(p);current=p;}current=domUtils.getNextDomNode(current,false,filterFn);}else{current=domUtils.getNextDomNode(current,true,filterFn);}}return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);};UE.commands['justify']={execCommand:function execCommand(cmdName,align){var range=this.selection.getRange(),txt;if(range.collapsed){txt=this.document.createTextNode('p');range.insertNode(txt);}doJustify(range,align);if(txt){range.setStartBefore(txt).collapse(true);domUtils.remove(txt);}range.select();return true;},queryCommandValue:function queryCommandValue(){var startNode=this.selection.getStart(),value=domUtils.getComputedStyle(startNode,'text-align');return defaultValue[value]?value:'left';},queryCommandState:function queryCommandState(){var start=this.selection.getStart(),cell=start&&domUtils.findParentByTagName(start,["td","th","caption"],true);return cell?-1:0;}};};UE.plugins['font']=function(){var me=this,fonts={'forecolor':'color','backcolor':'background-color','fontsize':'font-size','fontfamily':'font-family','underline':'text-decoration','strikethrough':'text-decoration','fontborder':'border'},needCmd={'underline':1,'strikethrough':1,'fontborder':1},needSetChild={'forecolor':'color','backcolor':'background-color','fontsize':'font-size','fontfamily':'font-family'};me.setOpt({'fontfamily':[{name:'songti',val:',SimSun'},{name:'yahei',val:',Microsoft YaHei'},{name:'kaiti',val:',_GB2312, SimKai'},{name:'heiti',val:', SimHei'},{name:'lishu',val:', SimLi'},{name:'andaleMono',val:'andale mono'},{name:'arial',val:'arial, helvetica,sans-serif'},{name:'arialBlack',val:'arial black,avant garde'},{name:'comicSansMs',val:'comic sans ms'},{name:'impact',val:'impact,chicago'},{name:'timesNewRoman',val:'times new roman'}],'fontsize':[10,11,12,14,16,18,20,24,36]});function mergeWithParent(node){var parent;while(parent=node.parentNode){if(parent.tagName=='SPAN'&&domUtils.getChildCount(parent,function(child){return!domUtils.isBookmarkNode(child)&&!domUtils.isBr(child);})==1){parent.style.cssText+=node.style.cssText;domUtils.remove(node,true);node=parent;}else{break;}}}function mergeChild(rng,cmdName,value){if(needSetChild[cmdName]){rng.adjustmentBoundary();if(!rng.collapsed&&rng.startContainer.nodeType==1){var start=rng.startContainer.childNodes[rng.startOffset];if(start&&domUtils.isTagNode(start,'span')){var bk=rng.createBookmark();utils.each(domUtils.getElementsByTagName(start,'span'),function(span){if(!span.parentNode||domUtils.isBookmarkNode(span))return;if(cmdName=='backcolor'&&domUtils.getComputedStyle(span,'background-color').toLowerCase()===value){return;}domUtils.removeStyle(span,needSetChild[cmdName]);if(span.style.cssText.replace(/^\s+$/,'').length==0){domUtils.remove(span,true);}});rng.moveToBookmark(bk);}}}}function mergesibling(rng,cmdName,value){var collapsed=rng.collapsed,bk=rng.createBookmark(),common;if(collapsed){common=bk.start.parentNode;while(dtd.$inline[common.tagName]){common=common.parentNode;}}else{common=domUtils.getCommonAncestor(bk.start,bk.end);}utils.each(domUtils.getElementsByTagName(common,'span'),function(span){if(!span.parentNode||domUtils.isBookmarkNode(span))return;if(/\s*border\s*:\s*none;?\s*/i.test(span.style.cssText)){if(/^\s*border\s*:\s*none;?\s*$/.test(span.style.cssText)){domUtils.remove(span,true);}else{domUtils.removeStyle(span,'border');}return;}if(/border/i.test(span.style.cssText)&&span.parentNode.tagName=='SPAN'&&/border/i.test(span.parentNode.style.cssText)){span.style.cssText=span.style.cssText.replace(/border[^:]*:[^;]+;?/gi,'');}if(!(cmdName=='fontborder'&&value=='none')){var next=span.nextSibling;while(next&&next.nodeType==1&&next.tagName=='SPAN'){if(domUtils.isBookmarkNode(next)&&cmdName=='fontborder'){span.appendChild(next);next=span.nextSibling;continue;}if(next.style.cssText==span.style.cssText){domUtils.moveChild(next,span);domUtils.remove(next);}if(span.nextSibling===next)break;next=span.nextSibling;}}mergeWithParent(span);if(browser.ie&&browser.version>8){var parent=domUtils.findParent(span,function(n){return n.tagName=='SPAN'&&/background-color/.test(n.style.cssText);});if(parent&&!/background-color/.test(span.style.cssText)){span.style.backgroundColor=parent.style.backgroundColor;}}});rng.moveToBookmark(bk);mergeChild(rng,cmdName,value);}me.addInputRule(function(root){utils.each(root.getNodesByTagName('u s del font strike'),function(node){if(node.tagName=='font'){var cssStyle=[];for(var p in node.attrs){switch(p){case'size':cssStyle.push('font-size:'+({'1':'10','2':'12','3':'16','4':'18','5':'24','6':'32','7':'48'}[node.attrs[p]]||node.attrs[p])+'px');break;case'color':cssStyle.push('color:'+node.attrs[p]);break;case'face':cssStyle.push('font-family:'+node.attrs[p]);break;case'style':cssStyle.push(node.attrs[p]);}}node.attrs={'style':cssStyle.join(';')};}else{var val=node.tagName=='u'?'underline':'line-through';node.attrs={'style':(node.getAttr('style')||'')+'text-decoration:'+val+';'};}node.tagName='span';});});for(var p in fonts){(function(cmd,style){UE.commands[cmd]={execCommand:function execCommand(cmdName,value){value=value||(this.queryCommandState(cmdName)?'none':cmdName=='underline'?'underline':cmdName=='fontborder'?'1px solid #000':'line-through');var me=this,range=this.selection.getRange(),text;if(value=='default'){if(range.collapsed){text=me.document.createTextNode('font');range.insertNode(text).select();}me.execCommand('removeFormat','span,a',style);if(text){range.setStartBefore(text).collapse(true);domUtils.remove(text);}mergesibling(range,cmdName,value);range.select();}else{if(!range.collapsed){if(needCmd[cmd]&&me.queryCommandValue(cmd)){me.execCommand('removeFormat','span,a',style);}range=me.selection.getRange();range.applyInlineStyle('span',{'style':style+':'+value});mergesibling(range,cmdName,value);range.select();}else{var span=domUtils.findParentByTagName(range.startContainer,'span',true);text=me.document.createTextNode('font');if(span&&!span.children.length&&!span[browser.ie?'innerText':'textContent'].replace(fillCharReg,'').length){range.insertNode(text);if(needCmd[cmd]){range.selectNode(text).select();me.execCommand('removeFormat','span,a',style,null);span=domUtils.findParentByTagName(text,'span',true);range.setStartBefore(text);}span&&(span.style.cssText+=';'+style+':'+value);range.collapse(true).select();}else{range.insertNode(text);range.selectNode(text).select();span=range.document.createElement('span');if(needCmd[cmd]){if(domUtils.findParentByTagName(text,'a',true)){range.setStartBefore(text).setCursor();domUtils.remove(text);return;}me.execCommand('removeFormat','span,a',style);}span.style.cssText=style+':'+value;text.parentNode.insertBefore(span,text);if(!browser.ie||browser.ie&&browser.version==9){var spanParent=span.parentNode;while(!domUtils.isBlockElm(spanParent)){if(spanParent.tagName=='SPAN'){span.style.cssText=spanParent.style.cssText+";"+span.style.cssText;}spanParent=spanParent.parentNode;}}if(opera){setTimeout(function(){range.setStart(span,0).collapse(true);mergesibling(range,cmdName,value);range.select();});}else{range.setStart(span,0).collapse(true);mergesibling(range,cmdName,value);range.select();}}domUtils.remove(text);}}return true;},queryCommandValue:function queryCommandValue(cmdName){var startNode=this.selection.getStart();if(cmdName=='underline'||cmdName=='strikethrough'){var tmpNode=startNode,value;while(tmpNode&&!domUtils.isBlockElm(tmpNode)&&!domUtils.isBody(tmpNode)){if(tmpNode.nodeType==1){value=domUtils.getComputedStyle(tmpNode,style);if(value!='none'){return value;}}tmpNode=tmpNode.parentNode;}return'none';}if(cmdName=='fontborder'){var tmp=startNode,val;while(tmp&&dtd.$inline[tmp.tagName]){if(val=domUtils.getComputedStyle(tmp,'border')){if(/1px/.test(val)&&/solid/.test(val)){return val;}}tmp=tmp.parentNode;}return'';}if(cmdName=='FontSize'){var styleVal=domUtils.getComputedStyle(startNode,style),tmp=/^([\d\.]+)(\w+)$/.exec(styleVal);if(tmp){return Math.floor(tmp[1])+tmp[2];}return styleVal;}return domUtils.getComputedStyle(startNode,style);},queryCommandState:function queryCommandState(cmdName){if(!needCmd[cmdName])return 0;var val=this.queryCommandValue(cmdName);if(cmdName=='fontborder'){return/1px/.test(val)&&/solid/.test(val);}else{return cmdName=='underline'?/underline/.test(val):/line\-through/.test(val);}}};})(p,fonts[p]);}};UE.plugins['link']=function(){function optimize(range){var start=range.startContainer,end=range.endContainer;if(start=domUtils.findParentByTagName(start,'a',true)){range.setStartBefore(start);}if(end=domUtils.findParentByTagName(end,'a',true)){range.setEndAfter(end);}}UE.commands['unlink']={execCommand:function execCommand(){var range=this.selection.getRange(),bookmark;if(range.collapsed&&!domUtils.findParentByTagName(range.startContainer,'a',true)){return;}bookmark=range.createBookmark();optimize(range);range.removeInlineStyle('a').moveToBookmark(bookmark).select();},queryCommandState:function queryCommandState(){return!this.highlight&&this.queryCommandValue('link')?0:-1;}};function doLink(range,opt,me){var rngClone=range.cloneRange(),link=me.queryCommandValue('link');optimize(range=range.adjustmentBoundary());var start=range.startContainer;if(start.nodeType==1&&link){start=start.childNodes[range.startOffset];if(start&&start.nodeType==1&&start.tagName=='A'&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(start[browser.ie?'innerText':'textContent'])){start[browser.ie?'innerText':'textContent']=utils.html(opt.textValue||opt.href);}}if(!rngClone.collapsed||link){range.removeInlineStyle('a');rngClone=range.cloneRange();}if(rngClone.collapsed){var a=range.document.createElement('a'),text='';if(opt.textValue){text=utils.html(opt.textValue);delete opt.textValue;}else{text=utils.html(opt.href);}domUtils.setAttributes(a,opt);start=domUtils.findParentByTagName(rngClone.startContainer,'a',true);if(start&&domUtils.isInNodeEndBoundary(rngClone,start)){range.setStartAfter(start).collapse(true);}a[browser.ie?'innerText':'textContent']=text;range.insertNode(a).selectNode(a);}else{range.applyInlineStyle('a',opt);}}UE.commands['link']={execCommand:function execCommand(cmdName,opt){var range;opt._href&&(opt._href=utils.unhtml(opt._href,/[<">]/g));opt.href&&(opt.href=utils.unhtml(opt.href,/[<">]/g));opt.textValue&&(opt.textValue=utils.unhtml(opt.textValue,/[<">]/g));doLink(range=this.selection.getRange(),opt,this);range.collapse().select(true);},queryCommandValue:function queryCommandValue(){var range=this.selection.getRange(),node;if(range.collapsed){node=range.startContainer;node=node.nodeType==1?node:node.parentNode;if(node&&(node=domUtils.findParentByTagName(node,'a',true))&&!domUtils.isInNodeEndBoundary(range,node)){return node;}}else{range.shrinkBoundary();var start=range.startContainer.nodeType==3||!range.startContainer.childNodes[range.startOffset]?range.startContainer:range.startContainer.childNodes[range.startOffset],end=range.endContainer.nodeType==3||range.endOffset==0?range.endContainer:range.endContainer.childNodes[range.endOffset-1],common=range.getCommonAncestor();node=domUtils.findParentByTagName(common,'a',true);if(!node&&common.nodeType==1){var as=common.getElementsByTagName('a'),ps,pe;for(var i=0,ci;ci=as[i++];){ps=domUtils.getPosition(ci,start),pe=domUtils.getPosition(ci,end);if((ps&domUtils.POSITION_FOLLOWING||ps&domUtils.POSITION_CONTAINS)&&(pe&domUtils.POSITION_PRECEDING||pe&domUtils.POSITION_CONTAINS)){node=ci;break;}}}return node;}},queryCommandState:function queryCommandState(){var img=this.selection.getRange().getClosedNode(),flag=img&&(img.className=="edui-faked-video"||img.className.indexOf("edui-upload-video")!=-1);return flag?-1:0;}};};UE.plugins['insertframe']=function(){var me=this;function deleteIframe(){me._iframe&&delete me._iframe;}me.addListener("selectionchange",function(){deleteIframe();});};UE.commands['scrawl']={queryCommandState:function queryCommandState(){return browser.ie&&browser.version<=8?-1:0;}};UE.plugins['removeformat']=function(){var me=this;me.setOpt({'removeFormatTags':'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var','removeFormatAttributes':'class,style,lang,width,height,align,hspace,valign'});me.commands['removeformat']={execCommand:function execCommand(cmdName,tags,style,attrs,notIncludeA){var tagReg=new RegExp('^(?:'+(tags||this.options.removeFormatTags).replace(/,/g,'|')+')$','i'),removeFormatAttributes=style?[]:(attrs||this.options.removeFormatAttributes).split(','),range=new dom.Range(this.document),bookmark,node,parent,filter=function filter(node){return node.nodeType==1;};function isRedundantSpan(node){if(node.nodeType==3||node.tagName.toLowerCase()!='span'){return 0;}if(browser.ie){var attrs=node.attributes;if(attrs.length){for(var i=0,l=attrs.length;i<l;i++){if(attrs[i].specified){return 0;}}return 1;}}return!node.attributes.length;}function doRemove(range){var bookmark1=range.createBookmark();if(range.collapsed){range.enlarge(true);}
if(!notIncludeA){var aNode=domUtils.findParentByTagName(range.startContainer,'a',true);if(aNode){range.setStartBefore(aNode);}aNode=domUtils.findParentByTagName(range.endContainer,'a',true);if(aNode){range.setEndAfter(aNode);}}bookmark=range.createBookmark();node=bookmark.start;while((parent=node.parentNode)&&!domUtils.isBlockElm(parent)){domUtils.breakParent(node,parent);domUtils.clearEmptySibling(node);}if(bookmark.end){node=bookmark.end;while((parent=node.parentNode)&&!domUtils.isBlockElm(parent)){domUtils.breakParent(node,parent);domUtils.clearEmptySibling(node);}
var current=domUtils.getNextDomNode(bookmark.start,false,filter),next;while(current){if(current==bookmark.end){break;}next=domUtils.getNextDomNode(current,true,filter);if(!dtd.$empty[current.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(current)){if(tagReg.test(current.tagName)){if(style){domUtils.removeStyle(current,style);if(isRedundantSpan(current)&&style!='text-decoration'){domUtils.remove(current,true);}}else{domUtils.remove(current,true);}}else{if(!dtd.$tableContent[current.tagName]&&!dtd.$list[current.tagName]){domUtils.removeAttributes(current,removeFormatAttributes);if(isRedundantSpan(current)){domUtils.remove(current,true);}}}}current=next;}}
var pN=bookmark.start.parentNode;if(domUtils.isBlockElm(pN)&&!dtd.$tableContent[pN.tagName]&&!dtd.$list[pN.tagName]){domUtils.removeAttributes(pN,removeFormatAttributes);}pN=bookmark.end.parentNode;if(bookmark.end&&domUtils.isBlockElm(pN)&&!dtd.$tableContent[pN.tagName]&&!dtd.$list[pN.tagName]){domUtils.removeAttributes(pN,removeFormatAttributes);}range.moveToBookmark(bookmark).moveToBookmark(bookmark1);var node=range.startContainer,tmp,collapsed=range.collapsed;while(node.nodeType==1&&domUtils.isEmptyNode(node)&&dtd.$removeEmpty[node.tagName]){tmp=node.parentNode;range.setStartBefore(node);if(range.startContainer===range.endContainer){range.endOffset--;}domUtils.remove(node);node=tmp;}if(!collapsed){node=range.endContainer;while(node.nodeType==1&&domUtils.isEmptyNode(node)&&dtd.$removeEmpty[node.tagName]){tmp=node.parentNode;range.setEndBefore(node);domUtils.remove(node);node=tmp;}}}range=this.selection.getRange();doRemove(range);range.select();}};};UE.plugins['blockquote']=function(){var me=this;function getObj(editor){return domUtils.filterNodeList(editor.selection.getStartElementPath(),'blockquote');}me.commands['blockquote']={execCommand:function execCommand(cmdName,attrs){var range=this.selection.getRange(),obj=getObj(this),blockquote=dtd.blockquote,bookmark=range.createBookmark();if(obj){var start=range.startContainer,startBlock=domUtils.isBlockElm(start)?start:domUtils.findParent(start,function(node){return domUtils.isBlockElm(node);}),end=range.endContainer,endBlock=domUtils.isBlockElm(end)?end:domUtils.findParent(end,function(node){return domUtils.isBlockElm(node);});startBlock=domUtils.findParentByTagName(startBlock,'li',true)||startBlock;endBlock=domUtils.findParentByTagName(endBlock,'li',true)||endBlock;if(startBlock.tagName=='LI'||startBlock.tagName=='TD'||startBlock===obj||domUtils.isBody(startBlock)){domUtils.remove(obj,true);}else{domUtils.breakParent(startBlock,obj);}if(startBlock!==endBlock){obj=domUtils.findParentByTagName(endBlock,'blockquote');if(obj){if(endBlock.tagName=='LI'||endBlock.tagName=='TD'||domUtils.isBody(endBlock)){obj.parentNode&&domUtils.remove(obj,true);}else{domUtils.breakParent(endBlock,obj);}}}var blockquotes=domUtils.getElementsByTagName(this.document,'blockquote');for(var i=0,bi;bi=blockquotes[i++];){if(!bi.childNodes.length){domUtils.remove(bi);}else if(domUtils.getPosition(bi,startBlock)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(bi,endBlock)&domUtils.POSITION_PRECEDING){domUtils.remove(bi,true);}}}else{var tmpRange=range.cloneRange(),node=tmpRange.startContainer.nodeType==1?tmpRange.startContainer:tmpRange.startContainer.parentNode,preNode=node,doEnd=1;while(1){if(domUtils.isBody(node)){if(preNode!==node){if(range.collapsed){tmpRange.selectNode(preNode);doEnd=0;}else{tmpRange.setStartBefore(preNode);}}else{tmpRange.setStart(node,0);}break;}if(!blockquote[node.tagName]){if(range.collapsed){tmpRange.selectNode(preNode);}else{tmpRange.setStartBefore(preNode);}break;}preNode=node;node=node.parentNode;}
if(doEnd){preNode=node=node=tmpRange.endContainer.nodeType==1?tmpRange.endContainer:tmpRange.endContainer.parentNode;while(1){if(domUtils.isBody(node)){if(preNode!==node){tmpRange.setEndAfter(preNode);}else{tmpRange.setEnd(node,node.childNodes.length);}break;}if(!blockquote[node.tagName]){tmpRange.setEndAfter(preNode);break;}preNode=node;node=node.parentNode;}}node=range.document.createElement('blockquote');domUtils.setAttributes(node,attrs);node.appendChild(tmpRange.extractContents());tmpRange.insertNode(node);var childs=domUtils.getElementsByTagName(node,'blockquote');for(var i=0,ci;ci=childs[i++];){if(ci.parentNode){domUtils.remove(ci,true);}}}range.moveToBookmark(bookmark).select();},queryCommandState:function queryCommandState(){return getObj(this)?1:0;}};};UE.commands['touppercase']=UE.commands['tolowercase']={execCommand:function execCommand(cmd){var me=this;var rng=me.selection.getRange();if(rng.collapsed){return rng;}var bk=rng.createBookmark(),bkEnd=bk.end,filterFn=function filterFn(node){return!domUtils.isBr(node)&&!domUtils.isWhitespace(node);},curNode=domUtils.getNextDomNode(bk.start,false,filterFn);while(curNode&&domUtils.getPosition(curNode,bkEnd)&domUtils.POSITION_PRECEDING){if(curNode.nodeType==3){curNode.nodeValue=curNode.nodeValue[cmd=='touppercase'?'toUpperCase':'toLowerCase']();}curNode=domUtils.getNextDomNode(curNode,true,filterFn);if(curNode===bkEnd){break;}}rng.moveToBookmark(bk).select();}};UE.commands['indent']={execCommand:function execCommand(){var me=this,value=me.queryCommandState("indent")?"0em":me.options.indentValue||'2em';me.execCommand('Paragraph','p',{style:'text-indent:'+value});},queryCommandState:function queryCommandState(){var pN=domUtils.filterNodeList(this.selection.getStartElementPath(),'p h1 h2 h3 h4 h5 h6');return pN&&pN.style.textIndent&&parseInt(pN.style.textIndent)?1:0;}};UE.commands['print']={execCommand:function execCommand(){this.window.print();},notNeedUndo:1};UE.commands['preview']={execCommand:function execCommand(){var w=window.open('','_blank',''),d=w.document;d.open();d.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+'ueditor.parse.js"></script><script>'+"setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)"+'</script></head><body><div>'+this.getContent(null,null,true)+'</div></body></html>');d.close();},notNeedUndo:1};UE.plugins['selectall']=function(){var me=this;me.commands['selectall']={execCommand:function execCommand(){var me=this,body=me.body,range=me.selection.getRange();range.selectNodeContents(body);if(domUtils.isEmptyBlock(body)){if(browser.opera&&body.firstChild&&body.firstChild.nodeType==1){range.setStartAtFirst(body.firstChild);}range.collapse(true);}range.select(true);},notNeedUndo:1};me.addshortcutkey({"selectAll":"ctrl+65"});};UE.plugins['paragraph']=function(){var me=this,block=domUtils.isBlockElm,notExchange=['TD','LI','PRE'],doParagraph=function doParagraph(range,style,attrs,sourceCmdName){var bookmark=range.createBookmark(),filterFn=function filterFn(node){return node.nodeType==1?node.tagName.toLowerCase()!='br'&&!domUtils.isBookmarkNode(node):!domUtils.isWhitespace(node);},para;range.enlarge(true);var bookmark2=range.createBookmark(),current=domUtils.getNextDomNode(bookmark2.start,false,filterFn),tmpRange=range.cloneRange(),tmpNode;while(current&&!(domUtils.getPosition(current,bookmark2.end)&domUtils.POSITION_FOLLOWING)){if(current.nodeType==3||!block(current)){tmpRange.setStartBefore(current);while(current&&current!==bookmark2.end&&!block(current)){tmpNode=current;current=domUtils.getNextDomNode(current,false,null,function(node){return!block(node);});}tmpRange.setEndAfter(tmpNode);para=range.document.createElement(style);if(attrs){domUtils.setAttributes(para,attrs);if(sourceCmdName&&sourceCmdName=='customstyle'&&attrs.style){para.style.cssText=attrs.style;}}para.appendChild(tmpRange.extractContents());if(domUtils.isEmptyNode(para)){domUtils.fillChar(range.document,para);}tmpRange.insertNode(para);var parent=para.parentNode;if(block(parent)&&!domUtils.isBody(para.parentNode)&&utils.indexOf(notExchange,parent.tagName)==-1){if(!(sourceCmdName&&sourceCmdName=='customstyle')){parent.getAttribute('dir')&&para.setAttribute('dir',parent.getAttribute('dir'));parent.style.cssText&&(para.style.cssText=parent.style.cssText+';'+para.style.cssText);parent.style.textAlign&&!para.style.textAlign&&(para.style.textAlign=parent.style.textAlign);parent.style.textIndent&&!para.style.textIndent&&(para.style.textIndent=parent.style.textIndent);parent.style.padding&&!para.style.padding&&(para.style.padding=parent.style.padding);}
if(attrs&&/h\d/i.test(parent.tagName)&&!/h\d/i.test(para.tagName)){domUtils.setAttributes(parent,attrs);if(sourceCmdName&&sourceCmdName=='customstyle'&&attrs.style){parent.style.cssText=attrs.style;}domUtils.remove(para,true);para=parent;}else{domUtils.remove(para.parentNode,true);}}if(utils.indexOf(notExchange,parent.tagName)!=-1){current=parent;}else{current=para;}current=domUtils.getNextDomNode(current,false,filterFn);}else{current=domUtils.getNextDomNode(current,true,filterFn);}}return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);};me.setOpt('paragraph',{'p':'','h1':'','h2':'','h3':'','h4':'','h5':'','h6':''});me.commands['paragraph']={execCommand:function execCommand(cmdName,style,attrs,sourceCmdName){var range=this.selection.getRange();if(range.collapsed){var txt=this.document.createTextNode('p');range.insertNode(txt);if(browser.ie){var node=txt.previousSibling;if(node&&domUtils.isWhitespace(node)){domUtils.remove(node);}node=txt.nextSibling;if(node&&domUtils.isWhitespace(node)){domUtils.remove(node);}}}range=doParagraph(range,style,attrs,sourceCmdName);if(txt){range.setStartBefore(txt).collapse(true);pN=txt.parentNode;domUtils.remove(txt);if(domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)){domUtils.fillNode(this.document,pN);}}if(browser.gecko&&range.collapsed&&range.startContainer.nodeType==1){var child=range.startContainer.childNodes[range.startOffset];if(child&&child.nodeType==1&&child.tagName.toLowerCase()==style){range.setStart(child,0).collapse(true);}}
range.select();return true;},queryCommandValue:function queryCommandValue(){var node=domUtils.filterNodeList(this.selection.getStartElementPath(),'p h1 h2 h3 h4 h5 h6');return node?node.tagName.toLowerCase():'';}};};(function(){var block=domUtils.isBlockElm,getObj=function getObj(editor){return domUtils.filterNodeList(editor.selection.getStartElementPath(),function(n){return n&&n.nodeType==1&&n.getAttribute('dir');});},doDirectionality=function doDirectionality(range,editor,forward){var bookmark,filterFn=function filterFn(node){return node.nodeType==1?!domUtils.isBookmarkNode(node):!domUtils.isWhitespace(node);},obj=getObj(editor);if(obj&&range.collapsed){obj.setAttribute('dir',forward);return range;}bookmark=range.createBookmark();range.enlarge(true);var bookmark2=range.createBookmark(),current=domUtils.getNextDomNode(bookmark2.start,false,filterFn),tmpRange=range.cloneRange(),tmpNode;while(current&&!(domUtils.getPosition(current,bookmark2.end)&domUtils.POSITION_FOLLOWING)){if(current.nodeType==3||!block(current)){tmpRange.setStartBefore(current);while(current&&current!==bookmark2.end&&!block(current)){tmpNode=current;current=domUtils.getNextDomNode(current,false,null,function(node){return!block(node);});}tmpRange.setEndAfter(tmpNode);var common=tmpRange.getCommonAncestor();if(!domUtils.isBody(common)&&block(common)){common.setAttribute('dir',forward);current=common;}else{var p=range.document.createElement('p');p.setAttribute('dir',forward);var frag=tmpRange.extractContents();p.appendChild(frag);tmpRange.insertNode(p);current=p;}current=domUtils.getNextDomNode(current,false,filterFn);}else{current=domUtils.getNextDomNode(current,true,filterFn);}}return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);};UE.commands['directionality']={execCommand:function execCommand(cmdName,forward){var range=this.selection.getRange();if(range.collapsed){var txt=this.document.createTextNode('d');range.insertNode(txt);}doDirectionality(range,this,forward);if(txt){range.setStartBefore(txt).collapse(true);domUtils.remove(txt);}range.select();return true;},queryCommandValue:function queryCommandValue(){var node=getObj(this);return node?node.getAttribute('dir'):'ltr';}};})();UE.plugins['horizontal']=function(){var me=this;me.commands['horizontal']={execCommand:function execCommand(cmdName){var me=this;if(me.queryCommandState(cmdName)!==-1){me.execCommand('insertHtml','<hr>');var range=me.selection.getRange(),start=range.startContainer;if(start.nodeType==1&&!start.childNodes[range.startOffset]){var tmp;if(tmp=start.childNodes[range.startOffset-1]){if(tmp.nodeType==1&&tmp.tagName=='HR'){if(me.options.enterTag=='p'){tmp=me.document.createElement('p');range.insertNode(tmp);range.setStart(tmp,0).setCursor();}else{tmp=me.document.createElement('br');range.insertNode(tmp);range.setStartBefore(tmp).setCursor();}}}}return true;}},queryCommandState:function queryCommandState(){return domUtils.filterNodeList(this.selection.getStartElementPath(),'table')?-1:0;}};me.addListener('delkeydown',function(name,evt){var rng=this.selection.getRange();rng.txtToElmBoundary(true);if(domUtils.isStartInblock(rng)){var tmpNode=rng.startContainer;var pre=tmpNode.previousSibling;if(pre&&domUtils.isTagNode(pre,'hr')){domUtils.remove(pre);rng.select();domUtils.preventDefault(evt);return true;}}});};UE.commands['time']=UE.commands["date"]={execCommand:function execCommand(cmd,format){var date=new Date();function formatTime(date,format){var hh=('0'+date.getHours()).slice(-2),ii=('0'+date.getMinutes()).slice(-2),ss=('0'+date.getSeconds()).slice(-2);format=format||'hh:ii:ss';return format.replace(/hh/ig,hh).replace(/ii/ig,ii).replace(/ss/ig,ss);}function formatDate(date,format){var yyyy=('000'+date.getFullYear()).slice(-4),yy=yyyy.slice(-2),mm=('0'+(date.getMonth()+1)).slice(-2),dd=('0'+date.getDate()).slice(-2);format=format||'yyyy-mm-dd';return format.replace(/yyyy/ig,yyyy).replace(/yy/ig,yy).replace(/mm/ig,mm).replace(/dd/ig,dd);}this.execCommand('insertHtml',cmd=="time"?formatTime(date,format):formatDate(date,format));}};UE.plugins['rowspacing']=function(){var me=this;me.setOpt({'rowspacingtop':['5','10','15','20','25'],'rowspacingbottom':['5','10','15','20','25']});me.commands['rowspacing']={execCommand:function execCommand(cmdName,value,dir){this.execCommand('paragraph','p',{style:'margin-'+dir+':'+value+'px'});return true;},queryCommandValue:function queryCommandValue(cmdName,dir){var pN=domUtils.filterNodeList(this.selection.getStartElementPath(),function(node){return domUtils.isBlockElm(node);}),value;if(pN){value=domUtils.getComputedStyle(pN,'margin-'+dir).replace(/[^\d]/g,'');return!value?0:value;}return 0;}};};UE.plugins['lineheight']=function(){var me=this;me.setOpt({'lineheight':['1','1.5','1.75','2','3','4','5']});me.commands['lineheight']={execCommand:function execCommand(cmdName,value){this.execCommand('paragraph','p',{style:'line-height:'+(value=="1"?"normal":value+'em')});return true;},queryCommandValue:function queryCommandValue(){var pN=domUtils.filterNodeList(this.selection.getStartElementPath(),function(node){return domUtils.isBlockElm(node);});if(pN){var value=domUtils.getComputedStyle(pN,'line-height');return value=='normal'?1:value.replace(/[^\d.]*/ig,"");}}};};UE.plugins['insertcode']=function(){var me=this;me.ready(function(){utils.cssRule('pre','pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}',me.document);});me.setOpt('insertcode',{'as3':'ActionScript3','bash':'Bash/Shell','cpp':'C/C++','css':'Css','cf':'CodeFunction','c#':'C#','delphi':'Delphi','diff':'Diff','erlang':'Erlang','groovy':'Groovy','html':'Html','java':'Java','jfx':'JavaFx','js':'Javascript','pl':'Perl','php':'Php','plain':'Plain Text','ps':'PowerShell','python':'Python','ruby':'Ruby','scala':'Scala','sql':'Sql','vb':'Vb','xml':'Xml'});me.commands['insertcode']={execCommand:function execCommand(cmd,lang){var me=this,rng=me.selection.getRange(),pre=domUtils.findParentByTagName(rng.startContainer,'pre',true);if(pre){pre.className='brush:'+lang+';toolbar:false;';}else{var code='';if(rng.collapsed){code=browser.ie&&browser.ie11below?browser.version<=8?'&nbsp;':'':'<br/>';}else{var frag=rng.extractContents();var div=me.document.createElement('div');div.appendChild(frag);utils.each(UE.filterNode(UE.htmlparser(div.innerHTML.replace(/[\r\t]/g,'')),me.options.filterTxtRules).children,function(node){if(browser.ie&&browser.ie11below&&browser.version>8){if(node.type=='element'){if(node.tagName=='br'){code+='\n';}else if(!dtd.$empty[node.tagName]){utils.each(node.children,function(cn){if(cn.type=='element'){if(cn.tagName=='br'){code+='\n';}else if(!dtd.$empty[node.tagName]){code+=cn.innerText();}}else{code+=cn.data;}});if(!/\n$/.test(code)){code+='\n';}}}else{code+=node.data+'\n';}if(!node.nextSibling()&&/\n$/.test(code)){code=code.replace(/\n$/,'');}}else{if(browser.ie&&browser.ie11below){if(node.type=='element'){if(node.tagName=='br'){code+='<br>';}else if(!dtd.$empty[node.tagName]){utils.each(node.children,function(cn){if(cn.type=='element'){if(cn.tagName=='br'){code+='<br>';}else if(!dtd.$empty[node.tagName]){code+=cn.innerText();}}else{code+=cn.data;}});if(!/br>$/.test(code)){code+='<br>';}}}else{code+=node.data+'<br>';}if(!node.nextSibling()&&/<br>$/.test(code)){code=code.replace(/<br>$/,'');}}else{code+=node.type=='element'?dtd.$empty[node.tagName]?'':node.innerText():node.data;if(!/br\/?\s*>$/.test(code)){if(!node.nextSibling())return;code+='<br>';}}}});}me.execCommand('inserthtml','<pre id="coder"class="brush:'+lang+';toolbar:false">'+code+'</pre>',true);pre=me.document.getElementById('coder');domUtils.removeAttributes(pre,'id');var tmpNode=pre.previousSibling;if(tmpNode&&(tmpNode.nodeType==3&&tmpNode.nodeValue.length==1&&browser.ie&&browser.version==6||domUtils.isEmptyBlock(tmpNode))){domUtils.remove(tmpNode);}var rng=me.selection.getRange();if(domUtils.isEmptyBlock(pre)){rng.setStart(pre,0).setCursor(false,true);}else{rng.selectNodeContents(pre).select();}}},queryCommandValue:function queryCommandValue(){var path=this.selection.getStartElementPath();var lang='';utils.each(path,function(node){if(node.nodeName=='PRE'){var match=node.className.match(/brush:([^;]+)/);lang=match&&match[1]?match[1]:'';return false;}});return lang;}};me.addInputRule(function(root){utils.each(root.getNodesByTagName('pre'),function(pre){var brs=pre.getNodesByTagName('br');if(brs.length){browser.ie&&browser.ie11below&&browser.version>8&&utils.each(brs,function(br){var txt=UE.uNode.createText('\n');br.parentNode.insertBefore(txt,br);br.parentNode.removeChild(br);});return;}if(browser.ie&&browser.ie11below&&browser.version>8)return;var code=pre.innerText().split(/\n/);pre.innerHTML('');utils.each(code,function(c){if(c.length){pre.appendChild(UE.uNode.createText(c));}pre.appendChild(UE.uNode.createElement('br'));});});});me.addOutputRule(function(root){utils.each(root.getNodesByTagName('pre'),function(pre){var code='';utils.each(pre.children,function(n){if(n.type=='text'){code+=n.data.replace(/[ ]/g,'&nbsp;').replace(/\n$/,'');}else{if(n.tagName=='br'){code+='\n';}else{code+=!dtd.$empty[n.tagName]?'':n.innerText();}}});pre.innerText(code.replace(/(&nbsp;|\n)+$/,''));});});me.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};var orgQuery=me.queryCommandState;me.queryCommandState=function(cmd){var me=this;if(!me.notNeedCodeQuery[cmd.toLowerCase()]&&me.selection&&me.queryCommandValue('insertcode')){return-1;}return UE.Editor.prototype.queryCommandState.apply(this,arguments);};me.addListener('beforeenterkeydown',function(){var rng=me.selection.getRange();var pre=domUtils.findParentByTagName(rng.startContainer,'pre',true);if(pre){me.fireEvent('saveScene');if(!rng.collapsed){rng.deleteContents();}if(!browser.ie||browser.ie9above){var tmpNode=me.document.createElement('br'),pre;rng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true);var next=tmpNode.nextSibling;if(!next&&(!browser.ie||browser.version>10)){rng.insertNode(tmpNode.cloneNode(false));}else{rng.setStartAfter(tmpNode);}pre=tmpNode.previousSibling;var tmp;while(pre){tmp=pre;pre=pre.previousSibling;if(!pre||pre.nodeName=='BR'){pre=tmp;break;}}if(pre){var str='';while(pre&&pre.nodeName!='BR'&&new RegExp('^[\\s'+domUtils.fillChar+']*$').test(pre.nodeValue)){str+=pre.nodeValue;pre=pre.nextSibling;}if(pre.nodeName!='BR'){var match=pre.nodeValue.match(new RegExp('^([\\s'+domUtils.fillChar+']+)'));if(match&&match[1]){str+=match[1];}}if(str){str=me.document.createTextNode(str);rng.insertNode(str).setStartAfter(str);}}rng.collapse(true).select(true);}else{if(browser.version>8){var txt=me.document.createTextNode('\n');var start=rng.startContainer;if(rng.startOffset==0){var preNode=start.previousSibling;if(preNode){rng.insertNode(txt);var fillchar=me.document.createTextNode(' ');rng.setStartAfter(txt).insertNode(fillchar).setStart(fillchar,0).collapse(true).select(true);}}else{rng.insertNode(txt).setStartAfter(txt);var fillchar=me.document.createTextNode(' ');start=rng.startContainer.childNodes[rng.startOffset];if(start&&!/^\n/.test(start.nodeValue)){rng.setStartBefore(txt);}rng.insertNode(fillchar).setStart(fillchar,0).collapse(true).select(true);}}else{var tmpNode=me.document.createElement('br');rng.insertNode(tmpNode);rng.insertNode(me.document.createTextNode(domUtils.fillChar));rng.setStartAfter(tmpNode);pre=tmpNode.previousSibling;var tmp;while(pre){tmp=pre;pre=pre.previousSibling;if(!pre||pre.nodeName=='BR'){pre=tmp;break;}}if(pre){var str='';while(pre&&pre.nodeName!='BR'&&new RegExp('^[ '+domUtils.fillChar+']*$').test(pre.nodeValue)){str+=pre.nodeValue;pre=pre.nextSibling;}if(pre.nodeName!='BR'){var match=pre.nodeValue.match(new RegExp('^([ '+domUtils.fillChar+']+)'));if(match&&match[1]){str+=match[1];}}str=me.document.createTextNode(str);rng.insertNode(str).setStartAfter(str);}rng.collapse(true).select();}}me.fireEvent('saveScene');return true;}});me.addListener('tabkeydown',function(cmd,evt){var rng=me.selection.getRange();var pre=domUtils.findParentByTagName(rng.startContainer,'pre',true);if(pre){me.fireEvent('saveScene');if(evt.shiftKey){}else{if(!rng.collapsed){var bk=rng.createBookmark();var start=bk.start.previousSibling;while(start){if(pre.firstChild===start&&!domUtils.isBr(start)){pre.insertBefore(me.document.createTextNode('    '),start);break;}if(domUtils.isBr(start)){pre.insertBefore(me.document.createTextNode('    '),start.nextSibling);break;}start=start.previousSibling;}var end=bk.end;start=bk.start.nextSibling;if(pre.firstChild===bk.start){pre.insertBefore(me.document.createTextNode('    '),start.nextSibling);}while(start&&start!==end){if(domUtils.isBr(start)&&start.nextSibling){if(start.nextSibling===end){break;}pre.insertBefore(me.document.createTextNode('    '),start.nextSibling);}start=start.nextSibling;}rng.moveToBookmark(bk).select();}else{var tmpNode=me.document.createTextNode('    ');rng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true).select(true);}}me.fireEvent('saveScene');return true;}});me.addListener('beforeinserthtml',function(evtName,html){var me=this,rng=me.selection.getRange(),pre=domUtils.findParentByTagName(rng.startContainer,'pre',true);if(pre){if(!rng.collapsed){rng.deleteContents();}var htmlstr='';if(browser.ie&&browser.version>8){utils.each(UE.filterNode(UE.htmlparser(html),me.options.filterTxtRules).children,function(node){if(node.type=='element'){if(node.tagName=='br'){htmlstr+='\n';}else if(!dtd.$empty[node.tagName]){utils.each(node.children,function(cn){if(cn.type=='element'){if(cn.tagName=='br'){htmlstr+='\n';}else if(!dtd.$empty[node.tagName]){htmlstr+=cn.innerText();}}else{htmlstr+=cn.data;}});if(!/\n$/.test(htmlstr)){htmlstr+='\n';}}}else{htmlstr+=node.data+'\n';}if(!node.nextSibling()&&/\n$/.test(htmlstr)){htmlstr=htmlstr.replace(/\n$/,'');}});var tmpNode=me.document.createTextNode(utils.html(htmlstr.replace(/&nbsp;/g,' ')));rng.insertNode(tmpNode).selectNode(tmpNode).select();}else{var frag=me.document.createDocumentFragment();utils.each(UE.filterNode(UE.htmlparser(html),me.options.filterTxtRules).children,function(node){if(node.type=='element'){if(node.tagName=='br'){frag.appendChild(me.document.createElement('br'));}else if(!dtd.$empty[node.tagName]){utils.each(node.children,function(cn){if(cn.type=='element'){if(cn.tagName=='br'){frag.appendChild(me.document.createElement('br'));}else if(!dtd.$empty[node.tagName]){frag.appendChild(me.document.createTextNode(utils.html(cn.innerText().replace(/&nbsp;/g,' '))));}}else{frag.appendChild(me.document.createTextNode(utils.html(cn.data.replace(/&nbsp;/g,' '))));}});if(frag.lastChild.nodeName!='BR'){frag.appendChild(me.document.createElement('br'));}}}else{frag.appendChild(me.document.createTextNode(utils.html(node.data.replace(/&nbsp;/g,' '))));}if(!node.nextSibling()&&frag.lastChild.nodeName=='BR'){frag.removeChild(frag.lastChild);}});rng.insertNode(frag).select();}return true;}});me.addListener('keydown',function(cmd,evt){var me=this,keyCode=evt.keyCode||evt.which;if(keyCode==40){var rng=me.selection.getRange(),pre,start=rng.startContainer;if(rng.collapsed&&(pre=domUtils.findParentByTagName(rng.startContainer,'pre',true))&&!pre.nextSibling){var last=pre.lastChild;while(last&&last.nodeName=='BR'){last=last.previousSibling;}if(last===start||rng.startContainer===pre&&rng.startOffset==pre.childNodes.length){me.execCommand('insertparagraph');domUtils.preventDefault(evt);}}}});me.addListener('delkeydown',function(type,evt){var rng=this.selection.getRange();rng.txtToElmBoundary(true);var start=rng.startContainer;if(domUtils.isTagNode(start,'pre')&&rng.collapsed&&domUtils.isStartInblock(rng)){var p=me.document.createElement('p');domUtils.fillNode(me.document,p);start.parentNode.insertBefore(p,start);domUtils.remove(start);rng.setStart(p,0).setCursor(false,true);domUtils.preventDefault(evt);return true;}});};UE.commands['cleardoc']={execCommand:function execCommand(cmdName){var me=this,enterTag=me.options.enterTag,range=me.selection.getRange();if(enterTag=="br"){me.body.innerHTML="<br/>";range.setStart(me.body,0).setCursor();}else{me.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";range.setStart(me.body.firstChild,0).setCursor(false,true);}setTimeout(function(){me.fireEvent("clearDoc");},0);}};UE.plugin.register('anchor',function(){return{bindEvents:{'ready':function ready(){utils.cssRule('anchor','.anchorclass{background: url(\''+this.options.themePath+this.options.theme+'/images/anchor.gif\') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}',this.document);}},outputRule:function outputRule(root){utils.each(root.getNodesByTagName('img'),function(a){var val;if(val=a.getAttr('anchorname')){a.tagName='a';a.setAttr({anchorname:'',name:val,'class':''});}});},inputRule:function inputRule(root){utils.each(root.getNodesByTagName('a'),function(a){var val;if((val=a.getAttr('name'))&&!a.getAttr('href')){a.tagName='img';a.setAttr({anchorname:a.getAttr('name'),'class':'anchorclass'});a.setAttr('name');}});},commands:{'anchor':{execCommand:function execCommand(cmd,name){var range=this.selection.getRange(),img=range.getClosedNode();if(img&&img.getAttribute('anchorname')){if(name){img.setAttribute('anchorname',name);}else{range.setStartBefore(img).setCursor();domUtils.remove(img);}}else{if(name){var anchor=this.document.createElement('img');range.collapse(true);domUtils.setAttributes(anchor,{'anchorname':name,'class':'anchorclass'});range.insertNode(anchor).setStartAfter(anchor).setCursor(false,true);}}}}}};});UE.plugins['wordcount']=function(){var me=this;me.setOpt('wordCount',true);me.addListener('contentchange',function(){me.fireEvent('wordcount');});var timer;me.addListener('ready',function(){var me=this;domUtils.on(me.body,"keyup",function(evt){var code=evt.keyCode||evt.which,ignores={"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1};if(code in ignores)return;clearTimeout(timer);timer=setTimeout(function(){me.fireEvent('wordcount');},200);});});};UE.plugins['pagebreak']=function(){var me=this,notBreakTags=['td'];me.setOpt('pageBreakTag','_ueditor_page_break_tag_');function fillNode(node){if(domUtils.isEmptyBlock(node)){var firstChild=node.firstChild,tmpNode;while(firstChild&&firstChild.nodeType==1&&domUtils.isEmptyBlock(firstChild)){tmpNode=firstChild;firstChild=firstChild.firstChild;}!tmpNode&&(tmpNode=node);domUtils.fillNode(me.document,tmpNode);}}
me.ready(function(){utils.cssRule('pagebreak','.pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}',me.document);});function isHr(node){return node&&node.nodeType==1&&node.tagName=='HR'&&node.className=='pagebreak';}me.addInputRule(function(root){root.traversal(function(node){if(node.type=='text'&&node.data==me.options.pageBreakTag){var hr=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');node.parentNode.insertBefore(hr,node);node.parentNode.removeChild(node);}});});me.addOutputRule(function(node){utils.each(node.getNodesByTagName('hr'),function(n){if(n.getAttr('class')=='pagebreak'){var txt=UE.uNode.createText(me.options.pageBreakTag);n.parentNode.insertBefore(txt,n);n.parentNode.removeChild(n);}});});me.commands['pagebreak']={execCommand:function execCommand(){var range=me.selection.getRange(),hr=me.document.createElement('hr');domUtils.setAttributes(hr,{'class':'pagebreak',noshade:"noshade",size:"5"});domUtils.unSelectable(hr);var node=domUtils.findParentByTagName(range.startContainer,notBreakTags,true),parents=[],pN;if(node){switch(node.tagName){case'TD':pN=node.parentNode;if(!pN.previousSibling){var table=domUtils.findParentByTagName(pN,'table');table.parentNode.insertBefore(hr,table);parents=domUtils.findParents(hr,true);}else{pN.parentNode.insertBefore(hr,pN);parents=domUtils.findParents(hr);}pN=parents[1];if(hr!==pN){domUtils.breakParent(hr,pN);}
me.fireEvent('afteradjusttable',me.document);}}else{if(!range.collapsed){range.deleteContents();var start=range.startContainer;while(!domUtils.isBody(start)&&domUtils.isBlockElm(start)&&domUtils.isEmptyNode(start)){range.setStartBefore(start).collapse(true);domUtils.remove(start);start=range.startContainer;}}range.insertNode(hr);var pN=hr.parentNode,nextNode;while(!domUtils.isBody(pN)){domUtils.breakParent(hr,pN);nextNode=hr.nextSibling;if(nextNode&&domUtils.isEmptyBlock(nextNode)){domUtils.remove(nextNode);}pN=hr.parentNode;}nextNode=hr.nextSibling;var pre=hr.previousSibling;if(isHr(pre)){domUtils.remove(pre);}else{pre&&fillNode(pre);}if(!nextNode){var p=me.document.createElement('p');hr.parentNode.appendChild(p);domUtils.fillNode(me.document,p);range.setStart(p,0).collapse(true);}else{if(isHr(nextNode)){domUtils.remove(nextNode);}else{fillNode(nextNode);}range.setEndAfter(hr).collapse(false);}range.select(true);}}};};UE.plugin.register('wordimage',function(){var me=this,images=[];return{commands:{'wordimage':{execCommand:function execCommand(){var images=domUtils.getElementsByTagName(me.body,"img");var urlList=[];for(var i=0,ci;ci=images[i++];){var url=ci.getAttribute("word_img");url&&urlList.push(url);}return urlList;},queryCommandState:function queryCommandState(){images=domUtils.getElementsByTagName(me.body,"img");for(var i=0,ci;ci=images[i++];){if(ci.getAttribute("word_img")){return 1;}}return-1;},notNeedUndo:true}},inputRule:function inputRule(root){utils.each(root.getNodesByTagName('img'),function(img){var attrs=img.attrs,flag=parseInt(attrs.width)<128||parseInt(attrs.height)<43,opt=me.options,src=opt.UEDITOR_HOME_URL+'themes/default/images/spacer.gif';if(attrs['src']&&/^(?:(file:\/+))/.test(attrs['src'])){img.setAttr({width:attrs.width,height:attrs.height,alt:attrs.alt,word_img:attrs.src,src:src,'style':'background:url('+(flag?opt.themePath+opt.theme+'/images/word.gif':opt.langPath+opt.lang+'/images/localimage.png')+') no-repeat center center;border:1px solid #ddd'});}});}};});UE.plugins['dragdrop']=function(){var me=this;me.ready(function(){domUtils.on(this.body,'dragend',function(){var rng=me.selection.getRange();var node=rng.getClosedNode()||me.selection.getStart();if(node&&node.tagName=='IMG'){var pre=node.previousSibling,next;while(next=node.nextSibling){if(next.nodeType==1&&next.tagName=='SPAN'&&!next.firstChild){domUtils.remove(next);}else{break;}}if((pre&&pre.nodeType==1&&!domUtils.isEmptyBlock(pre)||!pre)&&(!next||next&&!domUtils.isEmptyBlock(next))){if(pre&&pre.tagName=='P'&&!domUtils.isEmptyBlock(pre)){pre.appendChild(node);domUtils.moveChild(next,pre);domUtils.remove(next);}else if(next&&next.tagName=='P'&&!domUtils.isEmptyBlock(next)){next.insertBefore(node,next.firstChild);}if(pre&&pre.tagName=='P'&&domUtils.isEmptyBlock(pre)){domUtils.remove(pre);}if(next&&next.tagName=='P'&&domUtils.isEmptyBlock(next)){domUtils.remove(next);}rng.selectNode(node).select();me.fireEvent('saveScene');}}});});me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which;if(keyCode==13){var rng=me.selection.getRange(),node;if(node=domUtils.findParentByTagName(rng.startContainer,'p',true)){if(domUtils.getComputedStyle(node,'text-align')=='center'){domUtils.removeStyle(node,'text-align');}}}});};UE.plugins['undo']=function(){var saveSceneTimer;var me=this,maxUndoCount=me.options.maxUndoCount||20,maxInputCount=me.options.maxInputCount||20,fillchar=new RegExp(domUtils.fillChar+'|<\/hr>','gi');var noNeedFillCharTags={ol:1,ul:1,table:1,tbody:1,tr:1,body:1};var orgState=me.options.autoClearEmptyNode;function compareAddr(indexA,indexB){if(indexA.length!=indexB.length)return 0;for(var i=0,l=indexA.length;i<l;i++){if(indexA[i]!=indexB[i])return 0;}return 1;}function compareRangeAddress(rngAddrA,rngAddrB){if(rngAddrA.collapsed!=rngAddrB.collapsed){return 0;}if(!compareAddr(rngAddrA.startAddress,rngAddrB.startAddress)||!compareAddr(rngAddrA.endAddress,rngAddrB.endAddress)){return 0;}return 1;}function UndoManager(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return;}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0);}}this.restore(--this.index);}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index);}}this.restore(++this.index);}};this.restore=function(){var me=this.editor;var scene=this.list[this.index];var root=UE.htmlparser(scene.content.replace(fillchar,''));me.options.autoClearEmptyNode=false;me.filterInputRule(root);me.options.autoClearEmptyNode=orgState;me.document.body.innerHTML=root.toHtml();me.fireEvent('afterscencerestore');if(browser.ie){utils.each(domUtils.getElementsByTagName(me.document,'td th caption p'),function(node){if(domUtils.isEmptyNode(node)){domUtils.fillNode(me.document,node);}});}try{var rng=new dom.Range(me.document).moveToAddress(scene.address);rng.select(noNeedFillCharTags[rng.startContainer.nodeName.toLowerCase()]);}catch(e){}this.update();this.clearKey();me.fireEvent('reset',true);};this.getScene=function(){var me=this.editor;var rng=me.selection.getRange(),rngAddress=rng.createAddress(false,true);me.fireEvent('beforegetscene');var root=UE.htmlparser(me.body.innerHTML);me.options.autoClearEmptyNode=false;me.filterOutputRule(root);me.options.autoClearEmptyNode=orgState;var cont=root.toHtml();me.fireEvent('aftergetscene');return{address:rngAddress,content:cont};};this.save=function(notCompareRange,notSetCursor){clearTimeout(saveSceneTimer);var currentScene=this.getScene(notSetCursor),lastScene=this.list[this.index];if(lastScene&&lastScene.content!=currentScene.content){me.trigger('contentchange');}
if(lastScene&&lastScene.content==currentScene.content&&(notCompareRange?1:compareRangeAddress(lastScene.address,currentScene.address))){return;}this.list=this.list.slice(0,this.index+1);this.list.push(currentScene);if(this.list.length>maxUndoCount){this.list.shift();}this.index=this.list.length-1;this.clearKey();this.update();};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1];};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey();};this.clearKey=function(){keycont=0;lastKeyCode=null;};}me.undoManger=new UndoManager();me.undoManger.editor=me;function saveScene(){this.undoManger.save();}me.addListener('saveScene',function(){var args=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,args);});me.addListener('reset',function(type,exclude){if(!exclude){this.undoManger.reset();}});me.commands['redo']=me.commands['undo']={execCommand:function execCommand(cmdName){this.undoManger[cmdName]();},queryCommandState:function queryCommandState(cmdName){return this.undoManger['has'+(cmdName.toLowerCase()=='undo'?'Undo':'Redo')]?0:-1;},notNeedUndo:1};var keys={16:1,17:1,18:1,37:1,38:1,39:1,40:1},keycont=0,lastKeyCode;var inputType=false;me.addListener('ready',function(){domUtils.on(this.body,'compositionstart',function(){inputType=true;});domUtils.on(this.body,'compositionend',function(){inputType=false;});});me.addshortcutkey({"Undo":"ctrl+90","Redo":"ctrl+89"});var isCollapsed=true;me.addListener('keydown',function(type,evt){var me=this;var keyCode=evt.keyCode||evt.which;if(!keys[keyCode]&&!evt.ctrlKey&&!evt.metaKey&&!evt.shiftKey&&!evt.altKey){var _ret2=function(){var save=function save(cont){cont.undoManger.save(false,true);cont.fireEvent('selectionchange');};if(inputType)return{v:void 0};if(!me.selection.getRange().collapsed){me.undoManger.save(false,true);isCollapsed=false;return{v:void 0};}if(me.undoManger.list.length==0){me.undoManger.save(true);}clearTimeout(saveSceneTimer);saveSceneTimer=setTimeout(function(){if(inputType){var interalTimer=setInterval(function(){if(!inputType){save(me);clearInterval(interalTimer);}},300);return;}save(me);},200);lastKeyCode=keyCode;keycont++;if(keycont>=maxInputCount){save(me);}}();if((typeof _ret2==='undefined'?'undefined':_typeof(_ret2))==="object")return _ret2.v;}});me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which;if(!keys[keyCode]&&!evt.ctrlKey&&!evt.metaKey&&!evt.shiftKey&&!evt.altKey){if(inputType)return;if(!isCollapsed){this.undoManger.save(false,true);isCollapsed=true;}}});me.stopCmdUndo=function(){me.__hasEnterExecCommand=true;};me.startCmdUndo=function(){me.__hasEnterExecCommand=false;};};UE.plugin.register('copy',function(){var me=this;function initZeroClipboard(){ZeroClipboard.config({debug:false,swfPath:me.options.UEDITOR_HOME_URL+'third-party/zeroclipboard/ZeroClipboard.swf'});var client=me.zeroclipboard=new ZeroClipboard();client.on('copy',function(e){var client=e.client,rng=me.selection.getRange(),div=document.createElement('div');div.appendChild(rng.cloneContents());client.setText(div.innerText||div.textContent);client.setHtml(div.innerHTML);rng.select();});client.on('mouseover mouseout',function(e){var target=e.target;if(e.type=='mouseover'){domUtils.addClass(target,'edui-state-hover');}else if(e.type=='mouseout'){domUtils.removeClasses(target,'edui-state-hover');}});client.on('wrongflash noflash',function(){ZeroClipboard.destroy();});}return{bindEvents:{'ready':function ready(){if(!browser.ie){if(window.ZeroClipboard){initZeroClipboard();}else{utils.loadFile(document,{src:me.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){initZeroClipboard();});}}}},commands:{'copy':{execCommand:function execCommand(cmd){if(!me.document.execCommand('copy')){alert(me.getLang('copymsg'));}}}}};});UE.plugins['paste']=function(){function getClipboardData(callback){var doc=this.document;if(doc.getElementById('baidu_pastebin')){return;}var range=this.selection.getRange(),bk=range.createBookmark(),pastebin=doc.createElement('div');pastebin.id='baidu_pastebin';browser.webkit&&pastebin.appendChild(doc.createTextNode(domUtils.fillChar+domUtils.fillChar));doc.body.appendChild(pastebin);bk.start.style.display='';pastebin.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+
domUtils.getXY(bk.start).y+'px';range.selectNodeContents(pastebin).select(true);setTimeout(function(){if(browser.webkit){for(var i=0,pastebins=doc.querySelectorAll('#baidu_pastebin'),pi;pi=pastebins[i++];){if(domUtils.isEmptyNode(pi)){domUtils.remove(pi);}else{pastebin=pi;break;}}}try{pastebin.parentNode.removeChild(pastebin);}catch(e){}range.moveToBookmark(bk).select(true);callback(pastebin);},0);}var me=this;me.setOpt({retainOnlyLabelPasted:false});var txtContent,htmlContent,address;function getPureHtml(html){return html.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(a,b,tagName,attrs){tagName=tagName.toLowerCase();if({img:1}[tagName]){return a;}attrs=attrs.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(str,atr,val){if({'src':1,'href':1,'name':1}[atr.toLowerCase()]){return atr+'='+val+' ';}return'';});if({'span':1,'div':1}[tagName]){return'';}else{return'<'+b+tagName+' '+utils.trim(attrs)+'>';}});}function filter(div){var html;if(div.firstChild){var nodes=domUtils.getElementsByTagName(div,'span');for(var i=0,ni;ni=nodes[i++];){if(ni.id=='_baidu_cut_start'||ni.id=='_baidu_cut_end'){domUtils.remove(ni);}}if(browser.webkit){var brs=div.querySelectorAll('div br');for(var i=0,bi;bi=brs[i++];){var pN=bi.parentNode;if(pN.tagName=='DIV'&&pN.childNodes.length==1){pN.innerHTML='<p><br/></p>';domUtils.remove(pN);}}var divs=div.querySelectorAll('#baidu_pastebin');for(var i=0,di;di=divs[i++];){var tmpP=me.document.createElement('p');di.parentNode.insertBefore(tmpP,di);while(di.firstChild){tmpP.appendChild(di.firstChild);}domUtils.remove(di);}var metas=div.querySelectorAll('meta');for(var i=0,ci;ci=metas[i++];){domUtils.remove(ci);}var brs=div.querySelectorAll('br');for(i=0;ci=brs[i++];){if(/^apple-/i.test(ci.className)){domUtils.remove(ci);}}}if(browser.gecko){var dirtyNodes=div.querySelectorAll('[_moz_dirty]');for(i=0;ci=dirtyNodes[i++];){ci.removeAttribute('_moz_dirty');}}if(!browser.ie){var spans=div.querySelectorAll('span.Apple-style-span');for(var i=0,ci;ci=spans[i++];){domUtils.remove(ci,true);}}
html=div.innerHTML;html=UE.filterWord(html);var root=UE.htmlparser(html);if(me.options.filterRules){UE.filterNode(root,me.options.filterRules);}
me.filterInputRule(root);if(browser.webkit){var br=root.lastChild();if(br&&br.type=='element'&&br.tagName=='br'){root.removeChild(br);}utils.each(me.body.querySelectorAll('div'),function(node){if(domUtils.isEmptyBlock(node)){domUtils.remove(node,true);}});}html={'html':root.toHtml()};me.fireEvent('beforepaste',html,root);if(!html.html){return;}root=UE.htmlparser(html.html,true);if(me.queryCommandState('pasteplain')===1){me.execCommand('insertHtml',UE.filterNode(root,me.options.filterTxtRules).toHtml(),true);}else{UE.filterNode(root,me.options.filterTxtRules);txtContent=root.toHtml();htmlContent=html.html;address=me.selection.getRange().createAddress(true);me.execCommand('insertHtml',me.getOpt('retainOnlyLabelPasted')===true?getPureHtml(htmlContent):htmlContent,true);}me.fireEvent("afterpaste",html);}}me.addListener('pasteTransfer',function(cmd,plainType){if(address&&txtContent&&htmlContent&&txtContent!=htmlContent){var range=me.selection.getRange();range.moveToAddress(address,true);if(!range.collapsed){while(!domUtils.isBody(range.startContainer)){var start=range.startContainer;if(start.nodeType==1){start=start.childNodes[range.startOffset];if(!start){range.setStartBefore(range.startContainer);continue;}var pre=start.previousSibling;if(pre&&pre.nodeType==3&&new RegExp('^[\n\r\t '+domUtils.fillChar+']*$').test(pre.nodeValue)){range.setStartBefore(pre);}}if(range.startOffset==0){range.setStartBefore(range.startContainer);}else{break;}}while(!domUtils.isBody(range.endContainer)){var end=range.endContainer;if(end.nodeType==1){end=end.childNodes[range.endOffset];if(!end){range.setEndAfter(range.endContainer);continue;}var next=end.nextSibling;if(next&&next.nodeType==3&&new RegExp('^[\n\r\t'+domUtils.fillChar+']*$').test(next.nodeValue)){range.setEndAfter(next);}}if(range.endOffset==range.endContainer[range.endContainer.nodeType==3?'nodeValue':'childNodes'].length){range.setEndAfter(range.endContainer);}else{break;}}}range.deleteContents();range.select(true);me.__hasEnterExecCommand=true;var html=htmlContent;if(plainType===2){html=getPureHtml(html);}else if(plainType){html=txtContent;}me.execCommand('inserthtml',html,true);me.__hasEnterExecCommand=false;var rng=me.selection.getRange();while(!domUtils.isBody(rng.startContainer)&&!rng.startOffset&&rng.startContainer[rng.startContainer.nodeType==3?'nodeValue':'childNodes'].length){rng.setStartBefore(rng.startContainer);}var tmpAddress=rng.createAddress(true);address.endAddress=tmpAddress.startAddress;}});me.addListener('ready',function(){domUtils.on(me.body,'cut',function(){var range=me.selection.getRange();if(!range.collapsed&&me.undoManger){me.undoManger.save();}});domUtils.on(me.body,browser.ie||browser.opera?'keydown':'paste',function(e){if((browser.ie||browser.opera)&&(!e.ctrlKey&&!e.metaKey||e.keyCode!='86')){return;}getClipboardData.call(me,function(div){filter(div);});});});me.commands['paste']={execCommand:function execCommand(cmd){if(browser.ie){getClipboardData.call(me,function(div){filter(div);});me.document.execCommand('paste');}else{alert(me.getLang('pastemsg'));}}};};UE.plugins['pasteplain']=function(){var me=this;me.setOpt({'pasteplain':false,'filterTxtRules':function(){function transP(node){node.tagName='p';node.setStyle();}function removeNode(node){node.parentNode.removeChild(node,true);}return{'-':'script style object iframe embed input select','p':{$:{}},'br':{$:{}},div:function div(node){var tmpNode,p=UE.uNode.createElement('p');while(tmpNode=node.firstChild()){if(tmpNode.type=='text'||!UE.dom.dtd.$block[tmpNode.tagName]){p.appendChild(tmpNode);}else{if(p.firstChild()){node.parentNode.insertBefore(p,node);p=UE.uNode.createElement('p');}else{node.parentNode.insertBefore(tmpNode,node);}}}if(p.firstChild()){node.parentNode.insertBefore(p,node);}node.parentNode.removeChild(node);},ol:removeNode,ul:removeNode,dl:removeNode,dt:removeNode,dd:removeNode,'li':removeNode,'caption':transP,'th':transP,'tr':transP,'h1':transP,'h2':transP,'h3':transP,'h4':transP,'h5':transP,'h6':transP,'td':function td(node){var txt=!!node.innerText();if(txt){node.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'),node);}node.parentNode.removeChild(node,node.innerText());}};}()});var pasteplain=me.options.pasteplain;me.commands['pasteplain']={queryCommandState:function queryCommandState(){return pasteplain?1:0;},execCommand:function execCommand(){pasteplain=!pasteplain|0;},notNeedUndo:1};};UE.plugins['list']=function(){var me=this,notExchange={'TD':1,'PRE':1,'BLOCKQUOTE':1};var customStyle={'cn':'cn-1-','cn1':'cn-2-','cn2':'cn-3-','num':'num-1-','num1':'num-2-','num2':'num-3-','dash':'dash','dot':'dot'};me.setOpt({'autoTransWordToList':false,'insertorderedlist':{'num':'','num1':'','num2':'','cn':'','cn1':'','cn2':'','decimal':'','lower-alpha':'','lower-roman':'','upper-alpha':'','upper-roman':''},'insertunorderedlist':{'circle':'','disc':'','square':'','dash':'','dot':''},listDefaultPaddingLeft:'30',listiconpath:'http://bs.baidu.com/listicon/',maxListLevel:-1,disablePInList:false});function listToArray(list){var arr=[];for(var p in list){arr.push(p);}return arr;}var listStyle={'OL':listToArray(me.options.insertorderedlist),'UL':listToArray(me.options.insertunorderedlist)};var liiconpath=me.options.listiconpath;for(var s in customStyle){if(!me.options.insertorderedlist.hasOwnProperty(s)&&!me.options.insertunorderedlist.hasOwnProperty(s)){delete customStyle[s];}}me.ready(function(){var customCss=[];for(var p in customStyle){if(p=='dash'||p=='dot'){customCss.push('li.list-'+customStyle[p]+'{background-image:url('+liiconpath+customStyle[p]+'.gif)}');customCss.push('ul.custom_'+p+'{list-style:none;}ul.custom_'+p+' li{background-position:0 3px;background-repeat:no-repeat}');}else{for(var i=0;i<99;i++){customCss.push('li.list-'+customStyle[p]+i+'{background-image:url('+liiconpath+'list-'+customStyle[p]+i+'.gif)}');}customCss.push('ol.custom_'+p+'{list-style:none;}ol.custom_'+p+' li{background-position:0 3px;background-repeat:no-repeat}');}switch(p){case'cn':customCss.push('li.list-'+p+'-paddingleft-1{padding-left:25px}');customCss.push('li.list-'+p+'-paddingleft-2{padding-left:40px}');customCss.push('li.list-'+p+'-paddingleft-3{padding-left:55px}');break;case'cn1':customCss.push('li.list-'+p+'-paddingleft-1{padding-left:30px}');customCss.push('li.list-'+p+'-paddingleft-2{padding-left:40px}');customCss.push('li.list-'+p+'-paddingleft-3{padding-left:55px}');break;case'cn2':customCss.push('li.list-'+p+'-paddingleft-1{padding-left:40px}');customCss.push('li.list-'+p+'-paddingleft-2{padding-left:55px}');customCss.push('li.list-'+p+'-paddingleft-3{padding-left:68px}');break;case'num':case'num1':customCss.push('li.list-'+p+'-paddingleft-1{padding-left:25px}');break;case'num2':customCss.push('li.list-'+p+'-paddingleft-1{padding-left:35px}');customCss.push('li.list-'+p+'-paddingleft-2{padding-left:40px}');break;case'dash':customCss.push('li.list-'+p+'-paddingleft{padding-left:35px}');break;case'dot':customCss.push('li.list-'+p+'-paddingleft{padding-left:20px}');}}customCss.push('.list-paddingleft-1{padding-left:0}');customCss.push('.list-paddingleft-2{padding-left:'+me.options.listDefaultPaddingLeft+'px}');customCss.push('.list-paddingleft-3{padding-left:'+me.options.listDefaultPaddingLeft*2+'px}');utils.cssRule('list','ol,ul{margin:0;pading:0;'+(browser.ie?'':'width:95%')+'}li{clear:both;}'+customCss.join('\n'),me.document);});me.ready(function(){domUtils.on(me.body,'cut',function(){setTimeout(function(){var rng=me.selection.getRange(),li;if(!rng.collapsed){if(li=domUtils.findParentByTagName(rng.startContainer,'li',true)){if(!li.nextSibling&&domUtils.isEmptyBlock(li)){var pn=li.parentNode,node;if(node=pn.previousSibling){domUtils.remove(pn);rng.setStartAtLast(node).collapse(true);rng.select(true);}else if(node=pn.nextSibling){domUtils.remove(pn);rng.setStartAtFirst(node).collapse(true);rng.select(true);}else{var tmpNode=me.document.createElement('p');domUtils.fillNode(me.document,tmpNode);pn.parentNode.insertBefore(tmpNode,pn);domUtils.remove(pn);rng.setStart(tmpNode,0).collapse(true);rng.select(true);}}}}});});});function getStyle(node){var cls=node.className;if(domUtils.hasClass(node,/custom_/)){return cls.match(/custom_(\w+)/)[1];}return domUtils.getStyle(node,'list-style-type');}me.addListener('beforepaste',function(type,html){var me=this,rng=me.selection.getRange(),li;var root=UE.htmlparser(html.html,true);if(li=domUtils.findParentByTagName(rng.startContainer,'li',true)){var list=li.parentNode,tagName=list.tagName=='OL'?'ul':'ol';utils.each(root.getNodesByTagName(tagName),function(n){n.tagName=list.tagName;n.setAttr();if(n.parentNode===root){type=getStyle(list)||(list.tagName=='OL'?'decimal':'disc');}else{var className=n.parentNode.getAttr('class');if(className&&/custom_/.test(className)){type=className.match(/custom_(\w+)/)[1];}else{type=n.parentNode.getStyle('list-style-type');}if(!type){type=list.tagName=='OL'?'decimal':'disc';}}var index=utils.indexOf(listStyle[list.tagName],type);if(n.parentNode!==root)index=index+1==listStyle[list.tagName].length?0:index+1;var currentStyle=listStyle[list.tagName][index];if(customStyle[currentStyle]){n.setAttr('class','custom_'+currentStyle);}else{n.setStyle('list-style-type',currentStyle);}});}html.html=root.toHtml();});me.getOpt('disablePInList')===true&&me.addOutputRule(function(root){utils.each(root.getNodesByTagName('li'),function(li){var newChildrens=[],index=0;utils.each(li.children,function(n){if(n.tagName=='p'){var tmpNode;while(tmpNode=n.children.pop()){newChildrens.splice(index,0,tmpNode);tmpNode.parentNode=li;lastNode=tmpNode;}tmpNode=newChildrens[newChildrens.length-1];if(!tmpNode||tmpNode.type!='element'||tmpNode.tagName!='br'){var br=UE.uNode.createElement('br');br.parentNode=li;newChildrens.push(br);}index=newChildrens.length;}});if(newChildrens.length){li.children=newChildrens;}});});me.addInputRule(function(root){utils.each(root.getNodesByTagName('li'),function(li){var tmpP=UE.uNode.createElement('p');for(var i=0,ci;ci=li.children[i];){if(ci.type=='text'||dtd.p[ci.tagName]){tmpP.appendChild(ci);}else{if(tmpP.firstChild()){li.insertBefore(tmpP,ci);tmpP=UE.uNode.createElement('p');i=i+2;}else{i++;}}}if(tmpP.firstChild()&&!tmpP.parentNode||!li.firstChild()){li.appendChild(tmpP);}
if(!tmpP.firstChild()){tmpP.innerHTML(browser.ie?'&nbsp;':'<br/>');}
var p=li.firstChild();var lastChild=p.lastChild();if(lastChild&&lastChild.type=='text'&&/^\s*$/.test(lastChild.data)){p.removeChild(lastChild);}});if(me.options.autoTransWordToList){var orderlisttype,unorderlisttype;(function(){var checkListType=function checkListType(content,container){var span=container.firstChild();if(span&&span.type=='element'&&span.tagName=='span'&&/Wingdings|Symbol/.test(span.getStyle('font-family'))){for(var p in unorderlisttype){if(unorderlisttype[p]==span.data){return p;}}return'disc';}for(var p in orderlisttype){if(orderlisttype[p].test(content)){return p;}}};orderlisttype={'num1':/^\d+\)/,'decimal':/^\d+\./,'lower-alpha':/^[a-z]+\)/,'upper-alpha':/^[A-Z]+\./,'cn':/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,'cn2':/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/};unorderlisttype={'square':'n'};utils.each(root.getNodesByTagName('p'),function(node){if(node.getAttr('class')!='MsoListParagraph'){return;}
node.setStyle('margin','');node.setStyle('margin-left','');node.setAttr('class','');function appendLi(list,p,type){if(list.tagName=='ol'){if(browser.ie){var first=p.firstChild();if(first.type=='element'&&first.tagName=='span'&&orderlisttype[type].test(first.innerText())){p.removeChild(first);}}else{p.innerHTML(p.innerHTML().replace(orderlisttype[type],''));}}else{p.removeChild(p.firstChild());}var li=UE.uNode.createElement('li');li.appendChild(p);list.appendChild(li);}var tmp=node,type,cacheNode=node;if(node.parentNode.tagName!='li'&&(type=checkListType(node.innerText(),node))){var list=UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type)?'ol':'ul');if(customStyle[type]){list.setAttr('class','custom_'+type);}else{list.setStyle('list-style-type',type);}while(node&&node.parentNode.tagName!='li'&&checkListType(node.innerText(),node)){tmp=node.nextSibling();if(!tmp){node.parentNode.insertBefore(list,node);}appendLi(list,node,type);node=tmp;}if(!list.parentNode&&node&&node.parentNode){node.parentNode.insertBefore(list,node);}}var span=cacheNode.firstChild();if(span&&span.type=='element'&&span.tagName=='span'&&/^\s*(&nbsp;)+\s*$/.test(span.innerText())){span.parentNode.removeChild(span);}});})();}});me.addListener('contentchange',function(){adjustListStyle(me.document);});function adjustListStyle(doc,ignore){utils.each(domUtils.getElementsByTagName(doc,'ol ul'),function(node){if(!domUtils.inDoc(node,doc))return;var parent=node.parentNode;if(parent.tagName==node.tagName){var nodeStyleType=getStyle(node)||(node.tagName=='OL'?'decimal':'disc'),parentStyleType=getStyle(parent)||(parent.tagName=='OL'?'decimal':'disc');if(nodeStyleType==parentStyleType){var styleIndex=utils.indexOf(listStyle[node.tagName],nodeStyleType);styleIndex=styleIndex+1==listStyle[node.tagName].length?0:styleIndex+1;setListStyle(node,listStyle[node.tagName][styleIndex]);}}var index=0,type=2;if(domUtils.hasClass(node,/custom_/)){if(!(/[ou]l/i.test(parent.tagName)&&domUtils.hasClass(parent,/custom_/))){type=1;}}else{if(/[ou]l/i.test(parent.tagName)&&domUtils.hasClass(parent,/custom_/)){type=3;}}var style=domUtils.getStyle(node,'list-style-type');style&&(node.style.cssText='list-style-type:'+style);node.className=utils.trim(node.className.replace(/list-paddingleft-\w+/,''))+' list-paddingleft-'+type;utils.each(domUtils.getElementsByTagName(node,'li'),function(li){li.style.cssText&&(li.style.cssText='');if(!li.firstChild){domUtils.remove(li);return;}if(li.parentNode!==node){return;}index++;if(domUtils.hasClass(node,/custom_/)){var paddingLeft=1,currentStyle=getStyle(node);if(node.tagName=='OL'){if(currentStyle){switch(currentStyle){case'cn':case'cn1':case'cn2':if(index>10&&(index%10==0||index>10&&index<20)){paddingLeft=2;}else if(index>20){paddingLeft=3;}break;case'num2':if(index>9){paddingLeft=2;}}}li.className='list-'+customStyle[currentStyle]+index+' '+'list-'+currentStyle+'-paddingleft-'+paddingLeft;}else{li.className='list-'+customStyle[currentStyle]+' '+'list-'+currentStyle+'-paddingleft';}}else{li.className=li.className.replace(/list-[\w\-]+/gi,'');}var className=li.getAttribute('class');if(className!==null&&!className.replace(/\s/g,'')){domUtils.removeAttributes(li,'class');}});!ignore&&adjustList(node,node.tagName.toLowerCase(),getStyle(node)||domUtils.getStyle(node,'list-style-type'),true);});}function adjustList(list,tag,style,ignoreEmpty){var nextList=list.nextSibling;if(nextList&&nextList.nodeType==1&&nextList.tagName.toLowerCase()==tag&&(getStyle(nextList)||domUtils.getStyle(nextList,'list-style-type')||(tag=='ol'?'decimal':'disc'))==style){domUtils.moveChild(nextList,list);if(nextList.childNodes.length==0){domUtils.remove(nextList);}}if(nextList&&domUtils.isFillChar(nextList)){domUtils.remove(nextList);}var preList=list.previousSibling;if(preList&&preList.nodeType==1&&preList.tagName.toLowerCase()==tag&&(getStyle(preList)||domUtils.getStyle(preList,'list-style-type')||(tag=='ol'?'decimal':'disc'))==style){domUtils.moveChild(list,preList);}if(preList&&domUtils.isFillChar(preList)){domUtils.remove(preList);}!ignoreEmpty&&domUtils.isEmptyBlock(list)&&domUtils.remove(list);if(getStyle(list)){adjustListStyle(list.ownerDocument,true);}}function setListStyle(list,style){if(customStyle[style]){list.className='custom_'+style;}try{domUtils.setStyle(list,'list-style-type',style);}catch(e){}}function clearEmptySibling(node){var tmpNode=node.previousSibling;if(tmpNode&&domUtils.isEmptyBlock(tmpNode)){domUtils.remove(tmpNode);}tmpNode=node.nextSibling;if(tmpNode&&domUtils.isEmptyBlock(tmpNode)){domUtils.remove(tmpNode);}}me.addListener('keydown',function(type,evt){function preventAndSave(){evt.preventDefault?evt.preventDefault():evt.returnValue=false;me.fireEvent('contentchange');me.undoManger&&me.undoManger.save();}function findList(node,filterFn){while(node&&!domUtils.isBody(node)){if(filterFn(node)){return null;}if(node.nodeType==1&&/[ou]l/i.test(node.tagName)){return node;}node=node.parentNode;}return null;}var keyCode=evt.keyCode||evt.which;if(keyCode==13&&!evt.shiftKey){var rng=me.selection.getRange(),parent=domUtils.findParent(rng.startContainer,function(node){return domUtils.isBlockElm(node);},true),li=domUtils.findParentByTagName(rng.startContainer,'li',true);if(parent&&parent.tagName!='PRE'&&!li){var html=parent.innerHTML.replace(new RegExp(domUtils.fillChar,'g'),'');if(/^\s*1\s*\.[^\d]/.test(html)){parent.innerHTML=html.replace(/^\s*1\s*\./,'');rng.setStartAtLast(parent).collapse(true).select();me.__hasEnterExecCommand=true;me.execCommand('insertorderedlist');me.__hasEnterExecCommand=false;}}var range=me.selection.getRange(),start=findList(range.startContainer,function(node){return node.tagName=='TABLE';}),end=range.collapsed?start:findList(range.endContainer,function(node){return node.tagName=='TABLE';});if(start&&end&&start===end){if(!range.collapsed){start=domUtils.findParentByTagName(range.startContainer,'li',true);end=domUtils.findParentByTagName(range.endContainer,'li',true);if(start&&end&&start===end){range.deleteContents();li=domUtils.findParentByTagName(range.startContainer,'li',true);if(li&&domUtils.isEmptyBlock(li)){pre=li.previousSibling;next=li.nextSibling;p=me.document.createElement('p');domUtils.fillNode(me.document,p);parentList=li.parentNode;if(pre&&next){range.setStart(next,0).collapse(true).select(true);domUtils.remove(li);}else{if(!pre&&!next||!pre){parentList.parentNode.insertBefore(p,parentList);}else{li.parentNode.parentNode.insertBefore(p,parentList.nextSibling);}domUtils.remove(li);if(!parentList.firstChild){domUtils.remove(parentList);}range.setStart(p,0).setCursor();}preventAndSave();return;}}else{var tmpRange=range.cloneRange(),bk=tmpRange.collapse(false).createBookmark();range.deleteContents();tmpRange.moveToBookmark(bk);var li=domUtils.findParentByTagName(tmpRange.startContainer,'li',true);clearEmptySibling(li);tmpRange.select();preventAndSave();return;}}li=domUtils.findParentByTagName(range.startContainer,'li',true);if(li){if(domUtils.isEmptyBlock(li)){bk=range.createBookmark();var parentList=li.parentNode;if(li!==parentList.lastChild){domUtils.breakParent(li,parentList);clearEmptySibling(li);}else{parentList.parentNode.insertBefore(li,parentList.nextSibling);if(domUtils.isEmptyNode(parentList)){domUtils.remove(parentList);}}
if(!dtd.$list[li.parentNode.tagName]){if(!domUtils.isBlockElm(li.firstChild)){p=me.document.createElement('p');li.parentNode.insertBefore(p,li);while(li.firstChild){p.appendChild(li.firstChild);}domUtils.remove(li);}else{domUtils.remove(li,true);}}range.moveToBookmark(bk).select();}else{var first=li.firstChild;if(!first||!domUtils.isBlockElm(first)){var p=me.document.createElement('p');!li.firstChild&&domUtils.fillNode(me.document,p);while(li.firstChild){p.appendChild(li.firstChild);}li.appendChild(p);first=p;}var span=me.document.createElement('span');range.insertNode(span);domUtils.breakParent(span,li);var nextLi=span.nextSibling;first=nextLi.firstChild;if(!first){p=me.document.createElement('p');domUtils.fillNode(me.document,p);nextLi.appendChild(p);first=p;}if(domUtils.isEmptyNode(first)){first.innerHTML='';domUtils.fillNode(me.document,first);}range.setStart(first,0).collapse(true).shrinkBoundary().select();domUtils.remove(span);var pre=nextLi.previousSibling;if(pre&&domUtils.isEmptyBlock(pre)){pre.innerHTML='<p></p>';domUtils.fillNode(me.document,pre.firstChild);}}
preventAndSave();}}}if(keyCode==8){range=me.selection.getRange();if(range.collapsed&&domUtils.isStartInblock(range)){tmpRange=range.cloneRange().trimBoundary();li=domUtils.findParentByTagName(range.startContainer,'li',true);if(li&&domUtils.isStartInblock(tmpRange)){start=domUtils.findParentByTagName(range.startContainer,'p',true);if(start&&start!==li.firstChild){var parentList=domUtils.findParentByTagName(start,['ol','ul']);domUtils.breakParent(start,parentList);clearEmptySibling(start);me.fireEvent('contentchange');range.setStart(start,0).setCursor(false,true);me.fireEvent('saveScene');domUtils.preventDefault(evt);return;}if(li&&(pre=li.previousSibling)){if(keyCode==46&&li.childNodes.length){return;}
if(dtd.$list[pre.tagName]){pre=pre.lastChild;}me.undoManger&&me.undoManger.save();first=li.firstChild;if(domUtils.isBlockElm(first)){if(domUtils.isEmptyNode(first)){pre.appendChild(first);range.setStart(first,0).setCursor(false,true);while(li.firstChild){pre.appendChild(li.firstChild);}}else{span=me.document.createElement('span');range.insertNode(span);if(domUtils.isEmptyBlock(pre)){pre.innerHTML='';}domUtils.moveChild(li,pre);range.setStartBefore(span).collapse(true).select(true);domUtils.remove(span);}}else{if(domUtils.isEmptyNode(li)){var p=me.document.createElement('p');pre.appendChild(p);range.setStart(p,0).setCursor();}else{range.setEnd(pre,pre.childNodes.length).collapse().select(true);while(li.firstChild){pre.appendChild(li.firstChild);}}}domUtils.remove(li);me.fireEvent('contentchange');me.fireEvent('saveScene');domUtils.preventDefault(evt);return;}
if(li&&!li.previousSibling){var parentList=li.parentNode;var bk=range.createBookmark();if(domUtils.isTagNode(parentList.parentNode,'ol ul')){parentList.parentNode.insertBefore(li,parentList);if(domUtils.isEmptyNode(parentList)){domUtils.remove(parentList);}}else{while(li.firstChild){parentList.parentNode.insertBefore(li.firstChild,parentList);}domUtils.remove(li);if(domUtils.isEmptyNode(parentList)){domUtils.remove(parentList);}}range.moveToBookmark(bk).setCursor(false,true);me.fireEvent('contentchange');me.fireEvent('saveScene');domUtils.preventDefault(evt);return;}}}}});me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which;if(keyCode==8){var rng=me.selection.getRange(),list;if(list=domUtils.findParentByTagName(rng.startContainer,['ol','ul'],true)){adjustList(list,list.tagName.toLowerCase(),getStyle(list)||domUtils.getComputedStyle(list,'list-style-type'),true);}}});me.addListener('tabkeydown',function(){var range=me.selection.getRange();function checkLevel(li){if(me.options.maxListLevel!=-1){var level=li.parentNode,levelNum=0;while(/[ou]l/i.test(level.tagName)){levelNum++;level=level.parentNode;}if(levelNum>=me.options.maxListLevel){return true;}}}
var li=domUtils.findParentByTagName(range.startContainer,'li',true);if(li){var bk;if(range.collapsed){if(checkLevel(li))return true;var parentLi=li.parentNode,list=me.document.createElement(parentLi.tagName),index=utils.indexOf(listStyle[list.tagName],getStyle(parentLi)||domUtils.getComputedStyle(parentLi,'list-style-type'));index=index+1==listStyle[list.tagName].length?0:index+1;var currentStyle=listStyle[list.tagName][index];setListStyle(list,currentStyle);if(domUtils.isStartInblock(range)){me.fireEvent('saveScene');bk=range.createBookmark();parentLi.insertBefore(list,li);list.appendChild(li);adjustList(list,list.tagName.toLowerCase(),currentStyle);me.fireEvent('contentchange');range.moveToBookmark(bk).select(true);return true;}}else{me.fireEvent('saveScene');bk=range.createBookmark();for(var i=0,closeList,parents=domUtils.findParents(li),ci;ci=parents[i++];){if(domUtils.isTagNode(ci,'ol ul')){closeList=ci;break;}}var current=li;if(bk.end){while(current&&!(domUtils.getPosition(current,bk.end)&domUtils.POSITION_FOLLOWING)){if(checkLevel(current)){current=domUtils.getNextDomNode(current,false,null,function(node){return node!==closeList;});continue;}var parentLi=current.parentNode,list=me.document.createElement(parentLi.tagName),index=utils.indexOf(listStyle[list.tagName],getStyle(parentLi)||domUtils.getComputedStyle(parentLi,'list-style-type'));var currentIndex=index+1==listStyle[list.tagName].length?0:index+1;var currentStyle=listStyle[list.tagName][currentIndex];setListStyle(list,currentStyle);parentLi.insertBefore(list,current);while(current&&!(domUtils.getPosition(current,bk.end)&domUtils.POSITION_FOLLOWING)){li=current.nextSibling;list.appendChild(current);if(!li||domUtils.isTagNode(li,'ol ul')){if(li){while(li=li.firstChild){if(li.tagName=='LI'){break;}}}else{li=domUtils.getNextDomNode(current,false,null,function(node){return node!==closeList;});}break;}current=li;}adjustList(list,list.tagName.toLowerCase(),currentStyle);current=li;}}me.fireEvent('contentchange');range.moveToBookmark(bk).select();return true;}}});function getLi(start){while(start&&!domUtils.isBody(start)){if(start.nodeName=='TABLE'){return null;}if(start.nodeName=='LI'){return start;}start=start.parentNode;}}me.commands['insertorderedlist']=me.commands['insertunorderedlist']={execCommand:function execCommand(command,style){if(!style){style=command.toLowerCase()=='insertorderedlist'?'decimal':'disc';}var me=this,range=this.selection.getRange(),filterFn=function filterFn(node){return node.nodeType==1?node.tagName.toLowerCase()!='br':!domUtils.isWhitespace(node);},tag=command.toLowerCase()=='insertorderedlist'?'ol':'ul',frag=me.document.createDocumentFragment();range.adjustmentBoundary().shrinkBoundary();var bko=range.createBookmark(true),start=getLi(me.document.getElementById(bko.start)),modifyStart=0,end=getLi(me.document.getElementById(bko.end)),modifyEnd=0,startParent,endParent,list,tmp;if(start||end){start&&(startParent=start.parentNode);if(!bko.end){end=start;}end&&(endParent=end.parentNode);if(startParent===endParent){while(start!==end){tmp=start;start=start.nextSibling;if(!domUtils.isBlockElm(tmp.firstChild)){var p=me.document.createElement('p');while(tmp.firstChild){p.appendChild(tmp.firstChild);}tmp.appendChild(p);}frag.appendChild(tmp);}tmp=me.document.createElement('span');startParent.insertBefore(tmp,end);if(!domUtils.isBlockElm(end.firstChild)){p=me.document.createElement('p');while(end.firstChild){p.appendChild(end.firstChild);}end.appendChild(p);}frag.appendChild(end);domUtils.breakParent(tmp,startParent);if(domUtils.isEmptyNode(tmp.previousSibling)){domUtils.remove(tmp.previousSibling);}if(domUtils.isEmptyNode(tmp.nextSibling)){domUtils.remove(tmp.nextSibling);}var nodeStyle=getStyle(startParent)||domUtils.getComputedStyle(startParent,'list-style-type')||(command.toLowerCase()=='insertorderedlist'?'decimal':'disc');if(startParent.tagName.toLowerCase()==tag&&nodeStyle==style){for(var i=0,ci,tmpFrag=me.document.createDocumentFragment();ci=frag.firstChild;){if(domUtils.isTagNode(ci,'ol ul')){tmpFrag.appendChild(ci);}else{while(ci.firstChild){tmpFrag.appendChild(ci.firstChild);domUtils.remove(ci);}}}tmp.parentNode.insertBefore(tmpFrag,tmp);}else{list=me.document.createElement(tag);setListStyle(list,style);list.appendChild(frag);tmp.parentNode.insertBefore(list,tmp);}domUtils.remove(tmp);list&&adjustList(list,tag,style);range.moveToBookmark(bko).select();return;}
if(start){while(start){tmp=start.nextSibling;if(domUtils.isTagNode(start,'ol ul')){frag.appendChild(start);}else{var tmpfrag=me.document.createDocumentFragment(),hasBlock=0;while(start.firstChild){if(domUtils.isBlockElm(start.firstChild)){hasBlock=1;}tmpfrag.appendChild(start.firstChild);}if(!hasBlock){var tmpP=me.document.createElement('p');tmpP.appendChild(tmpfrag);frag.appendChild(tmpP);}else{frag.appendChild(tmpfrag);}domUtils.remove(start);}start=tmp;}startParent.parentNode.insertBefore(frag,startParent.nextSibling);if(domUtils.isEmptyNode(startParent)){range.setStartBefore(startParent);domUtils.remove(startParent);}else{range.setStartAfter(startParent);}modifyStart=1;}if(end&&domUtils.inDoc(endParent,me.document)){start=endParent.firstChild;while(start&&start!==end){tmp=start.nextSibling;if(domUtils.isTagNode(start,'ol ul')){frag.appendChild(start);}else{tmpfrag=me.document.createDocumentFragment();hasBlock=0;while(start.firstChild){if(domUtils.isBlockElm(start.firstChild)){hasBlock=1;}tmpfrag.appendChild(start.firstChild);}if(!hasBlock){tmpP=me.document.createElement('p');tmpP.appendChild(tmpfrag);frag.appendChild(tmpP);}else{frag.appendChild(tmpfrag);}domUtils.remove(start);}start=tmp;}var tmpDiv=domUtils.createElement(me.document,'div',{'tmpDiv':1});domUtils.moveChild(end,tmpDiv);frag.appendChild(tmpDiv);domUtils.remove(end);endParent.parentNode.insertBefore(frag,endParent);range.setEndBefore(endParent);if(domUtils.isEmptyNode(endParent)){domUtils.remove(endParent);}modifyEnd=1;}}if(!modifyStart){range.setStartBefore(me.document.getElementById(bko.start));}if(bko.end&&!modifyEnd){range.setEndAfter(me.document.getElementById(bko.end));}range.enlarge(true,function(node){return notExchange[node.tagName];});frag=me.document.createDocumentFragment();var bk=range.createBookmark(),current=domUtils.getNextDomNode(bk.start,false,filterFn),tmpRange=range.cloneRange(),tmpNode,block=domUtils.isBlockElm;while(current&&current!==bk.end&&domUtils.getPosition(current,bk.end)&domUtils.POSITION_PRECEDING){if(current.nodeType==3||dtd.li[current.tagName]){if(current.nodeType==1&&dtd.$list[current.tagName]){while(current.firstChild){frag.appendChild(current.firstChild);}tmpNode=domUtils.getNextDomNode(current,false,filterFn);domUtils.remove(current);current=tmpNode;continue;}tmpNode=current;tmpRange.setStartBefore(current);while(current&&current!==bk.end&&(!block(current)||domUtils.isBookmarkNode(current))){tmpNode=current;current=domUtils.getNextDomNode(current,false,null,function(node){return!notExchange[node.tagName];});}if(current&&block(current)){tmp=domUtils.getNextDomNode(tmpNode,false,filterFn);if(tmp&&domUtils.isBookmarkNode(tmp)){current=domUtils.getNextDomNode(tmp,false,filterFn);tmpNode=tmp;}}tmpRange.setEndAfter(tmpNode);current=domUtils.getNextDomNode(tmpNode,false,filterFn);var li=range.document.createElement('li');li.appendChild(tmpRange.extractContents());if(domUtils.isEmptyNode(li)){var tmpNode=range.document.createElement('p');while(li.firstChild){tmpNode.appendChild(li.firstChild);}li.appendChild(tmpNode);}frag.appendChild(li);}else{current=domUtils.getNextDomNode(current,true,filterFn);}}range.moveToBookmark(bk).collapse(true);list=me.document.createElement(tag);setListStyle(list,style);list.appendChild(frag);range.insertNode(list);adjustList(list,tag,style);for(var i=0,ci,tmpDivs=domUtils.getElementsByTagName(list,'div');ci=tmpDivs[i++];){if(ci.getAttribute('tmpDiv')){domUtils.remove(ci,true);}}range.moveToBookmark(bko).select();},queryCommandState:function queryCommandState(command){var tag=command.toLowerCase()=='insertorderedlist'?'ol':'ul';var path=this.selection.getStartElementPath();for(var i=0,ci;ci=path[i++];){if(ci.nodeName=='TABLE'){return 0;}if(tag==ci.nodeName.toLowerCase()){return 1;};}return 0;},queryCommandValue:function queryCommandValue(command){var tag=command.toLowerCase()=='insertorderedlist'?'ol':'ul';var path=this.selection.getStartElementPath(),node;for(var i=0,ci;ci=path[i++];){if(ci.nodeName=='TABLE'){node=null;break;}if(tag==ci.nodeName.toLowerCase()){node=ci;break;};}return node?getStyle(node)||domUtils.getComputedStyle(node,'list-style-type'):null;}};};(function(){var sourceEditors={textarea:function textarea(editor,holder){var textarea=holder.ownerDocument.createElement('textarea');textarea.style.cssText='position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;';if(browser.ie&&browser.version<8){textarea.style.width=holder.offsetWidth+'px';textarea.style.height=holder.offsetHeight+'px';holder.onresize=function(){textarea.style.width=holder.offsetWidth+'px';textarea.style.height=holder.offsetHeight+'px';};}holder.appendChild(textarea);return{setContent:function setContent(content){textarea.value=content;},getContent:function getContent(){return textarea.value;},select:function select(){var range;if(browser.ie){range=textarea.createTextRange();range.collapse(true);range.select();}else{textarea.setSelectionRange(0,0);textarea.focus();}},dispose:function dispose(){holder.removeChild(textarea);holder.onresize=null;textarea=null;holder=null;}};},codemirror:function codemirror(editor,holder){var codeEditor=window.CodeMirror(holder,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true});var dom=codeEditor.getWrapperElement();dom.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';codeEditor.getScrollerElement().style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;';codeEditor.refresh();return{getCodeMirror:function getCodeMirror(){return codeEditor;},setContent:function setContent(content){codeEditor.setValue(content);},getContent:function getContent(){return codeEditor.getValue();},select:function select(){codeEditor.focus();},dispose:function dispose(){holder.removeChild(dom);dom=null;codeEditor=null;}};}};UE.plugins['source']=function(){var me=this;var opt=this.options;var sourceMode=false;var sourceEditor;var orgSetContent;opt.sourceEditor=browser.ie?'textarea':opt.sourceEditor||'codemirror';me.setOpt({sourceEditorFirst:false});function createSourceEditor(holder){return sourceEditors[opt.sourceEditor=='codemirror'&&window.CodeMirror?'codemirror':'textarea'](me,holder);}var bakCssText;var oldGetContent,bakAddress;me.commands['source']={execCommand:function execCommand(){sourceMode=!sourceMode;if(sourceMode){bakAddress=me.selection.getRange().createAddress(false,true);me.undoManger&&me.undoManger.save(true);if(browser.gecko){me.body.contentEditable=false;}bakCssText=me.iframe.style.cssText;me.iframe.style.cssText+='position:absolute;left:-32768px;top:-32768px;';me.fireEvent('beforegetcontent');var root=UE.htmlparser(me.body.innerHTML);me.filterOutputRule(root);root.traversal(function(node){if(node.type=='element'){switch(node.tagName){case'td':case'th':case'caption':if(node.children&&node.children.length==1){if(node.firstChild().tagName=='br'){node.removeChild(node.firstChild());}};break;case'pre':node.innerText(node.innerText().replace(/&nbsp;/g,' '));}}});me.fireEvent('aftergetcontent');var content=root.toHtml(true);sourceEditor=createSourceEditor(me.iframe.parentNode);sourceEditor.setContent(content);orgSetContent=me.setContent;me.setContent=function(html){var root=UE.htmlparser(html);me.filterInputRule(root);html=root.toHtml();sourceEditor.setContent(html);};setTimeout(function(){sourceEditor.select();me.addListener('fullscreenchanged',function(){try{sourceEditor.getCodeMirror().refresh();}catch(e){}});});oldGetContent=me.getContent;me.getContent=function(){return sourceEditor.getContent()||'<p>'+(browser.ie?'':'<br/>')+'</p>';};}else{me.iframe.style.cssText=bakCssText;var cont=sourceEditor.getContent()||'<p>'+(browser.ie?'':'<br/>')+'</p>';cont=cont.replace(new RegExp('[\\r\\t\\n ]*<\/?(\\w+)\\s*(?:[^>]*)>','g'),function(a,b){if(b&&!dtd.$inlineWithA[b.toLowerCase()]){return a.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,'');}return a.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,'');});me.setContent=orgSetContent;me.setContent(cont);sourceEditor.dispose();sourceEditor=null;me.getContent=oldGetContent;var first=me.body.firstChild;if(!first){me.body.innerHTML='<p>'+(browser.ie?'':'<br/>')+'</p>';first=me.body.firstChild;}
me.undoManger&&me.undoManger.save(true);if(browser.gecko){var input=document.createElement('input');input.style.cssText='position:absolute;left:0;top:-32768px';document.body.appendChild(input);me.body.contentEditable=false;setTimeout(function(){domUtils.setViewportOffset(input,{left:-32768,top:0});input.focus();setTimeout(function(){me.body.contentEditable=true;me.selection.getRange().moveToAddress(bakAddress).select(true);domUtils.remove(input);});});}else{try{me.selection.getRange().moveToAddress(bakAddress).select(true);}catch(e){}}}this.fireEvent('sourcemodechanged',sourceMode);},queryCommandState:function queryCommandState(){return sourceMode|0;},notNeedUndo:1};var oldQueryCommandState=me.queryCommandState;me.queryCommandState=function(cmdName){cmdName=cmdName.toLowerCase();if(sourceMode){return cmdName in{'source':1,'fullscreen':1}?1:-1;}return oldQueryCommandState.apply(this,arguments);};if(opt.sourceEditor=="codemirror"){me.addListener("ready",function(){utils.loadFile(document,{src:opt.codeMirrorJsUrl||opt.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){if(opt.sourceEditorFirst){setTimeout(function(){me.execCommand("source");},0);}});utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:opt.codeMirrorCssUrl||opt.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"});});}};})();UE.plugins['enterkey']=function(){var hTag,me=this,tag=me.options.enterTag;me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which;if(keyCode==13){var range=me.selection.getRange(),start=range.startContainer,doSave;if(!browser.ie){if(/h\d/i.test(hTag)){if(browser.gecko){var h=domUtils.findParentByTagName(start,['h1','h2','h3','h4','h5','h6','blockquote','caption','table'],true);if(!h){me.document.execCommand('formatBlock',false,'<p>');doSave=1;}}else{if(start.nodeType==1){var tmp=me.document.createTextNode(''),div;range.insertNode(tmp);div=domUtils.findParentByTagName(tmp,'div',true);if(div){var p=me.document.createElement('p');while(div.firstChild){p.appendChild(div.firstChild);}div.parentNode.insertBefore(p,div);domUtils.remove(div);range.setStartBefore(tmp).setCursor();doSave=1;}domUtils.remove(tmp);}}if(me.undoManger&&doSave){me.undoManger.save();}}
browser.opera&&range.select();}else{me.fireEvent('saveScene',true,true);}}});me.addListener('keydown',function(type,evt){var keyCode=evt.keyCode||evt.which;if(keyCode==13){if(me.fireEvent('beforeenterkeydown')){domUtils.preventDefault(evt);return;}me.fireEvent('saveScene',true,true);hTag='';var range=me.selection.getRange();if(!range.collapsed){var start=range.startContainer,end=range.endContainer,startTd=domUtils.findParentByTagName(start,'td',true),endTd=domUtils.findParentByTagName(end,'td',true);if(startTd&&endTd&&startTd!==endTd||!startTd&&endTd||startTd&&!endTd){evt.preventDefault?evt.preventDefault():evt.returnValue=false;return;}}if(tag=='p'){if(!browser.ie){start=domUtils.findParentByTagName(range.startContainer,['ol','ul','p','h1','h2','h3','h4','h5','h6','blockquote','caption'],true);if(!start&&!browser.opera){me.document.execCommand('formatBlock',false,'<p>');if(browser.gecko){range=me.selection.getRange();start=domUtils.findParentByTagName(range.startContainer,'p',true);start&&domUtils.removeDirtyAttr(start);}}else{hTag=start.tagName;start.tagName.toLowerCase()=='p'&&browser.gecko&&domUtils.removeDirtyAttr(start);}}}else{evt.preventDefault?evt.preventDefault():evt.returnValue=false;if(!range.collapsed){range.deleteContents();start=range.startContainer;if(start.nodeType==1&&(start=start.childNodes[range.startOffset])){while(start.nodeType==1){if(dtd.$empty[start.tagName]){range.setStartBefore(start).setCursor();if(me.undoManger){me.undoManger.save();}return false;}if(!start.firstChild){var br=range.document.createElement('br');start.appendChild(br);range.setStart(start,0).setCursor();if(me.undoManger){me.undoManger.save();}return false;}start=start.firstChild;}if(start===range.startContainer.childNodes[range.startOffset]){br=range.document.createElement('br');range.insertNode(br).setCursor();}else{range.setStart(start,0).setCursor();}}else{br=range.document.createElement('br');range.insertNode(br).setStartAfter(br).setCursor();}}else{br=range.document.createElement('br');range.insertNode(br);var parent=br.parentNode;if(parent.lastChild===br){br.parentNode.insertBefore(br.cloneNode(true),br);range.setStartBefore(br);}else{range.setStartAfter(br);}range.setCursor();}}}});};UE.plugins['keystrokes']=function(){var me=this;var collapsed=true;me.addListener('keydown',function(type,evt){var keyCode=evt.keyCode||evt.which,rng=me.selection.getRange();if(!rng.collapsed&&!(evt.ctrlKey||evt.shiftKey||evt.altKey||evt.metaKey)&&(keyCode>=65&&keyCode<=90||keyCode>=48&&keyCode<=57||keyCode>=96&&keyCode<=111||{13:1,8:1,46:1}[keyCode])){var tmpNode=rng.startContainer;if(domUtils.isFillChar(tmpNode)){rng.setStartBefore(tmpNode);}tmpNode=rng.endContainer;if(domUtils.isFillChar(tmpNode)){rng.setEndAfter(tmpNode);}rng.txtToElmBoundary();if(rng.endContainer&&rng.endContainer.nodeType==1){tmpNode=rng.endContainer.childNodes[rng.endOffset];if(tmpNode&&domUtils.isBr(tmpNode)){rng.setEndAfter(tmpNode);}}if(rng.startOffset==0){tmpNode=rng.startContainer;if(domUtils.isBoundaryNode(tmpNode,'firstChild')){tmpNode=rng.endContainer;if(rng.endOffset==(tmpNode.nodeType==3?tmpNode.nodeValue.length:tmpNode.childNodes.length)&&domUtils.isBoundaryNode(tmpNode,'lastChild')){me.fireEvent('saveScene');me.body.innerHTML='<p>'+(browser.ie?'':'<br/>')+'</p>';rng.setStart(me.body.firstChild,0).setCursor(false,true);me._selectionChange();return;}}}}
if(keyCode==keymap.Backspace){rng=me.selection.getRange();collapsed=rng.collapsed;if(me.fireEvent('delkeydown',evt)){return;}var start,end;if(rng.collapsed&&rng.inFillChar()){start=rng.startContainer;if(domUtils.isFillChar(start)){rng.setStartBefore(start).shrinkBoundary(true).collapse(true);domUtils.remove(start);}else{start.nodeValue=start.nodeValue.replace(new RegExp('^'+domUtils.fillChar),'');rng.startOffset--;rng.collapse(true).select(true);}}
if(start=rng.getClosedNode()){me.fireEvent('saveScene');rng.setStartBefore(start);domUtils.remove(start);rng.setCursor();me.fireEvent('saveScene');domUtils.preventDefault(evt);return;}
if(!browser.ie){start=domUtils.findParentByTagName(rng.startContainer,'table',true);end=domUtils.findParentByTagName(rng.endContainer,'table',true);if(start&&!end||!start&&end||start!==end){evt.preventDefault();return;}}}
if(keyCode==keymap.Tab){var excludeTagNameForTabKey={'ol':1,'ul':1,'table':1};if(me.fireEvent('tabkeydown',evt)){domUtils.preventDefault(evt);return;}var range=me.selection.getRange();me.fireEvent('saveScene');for(var i=0,txt='',tabSize=me.options.tabSize||4,tabNode=me.options.tabNode||'&nbsp;';i<tabSize;i++){txt+=tabNode;}var span=me.document.createElement('span');span.innerHTML=txt+domUtils.fillChar;if(range.collapsed){range.insertNode(span.cloneNode(true).firstChild).setCursor(true);}else{var filterFn=function filterFn(node){return domUtils.isBlockElm(node)&&!excludeTagNameForTabKey[node.tagName.toLowerCase()];};start=domUtils.findParent(range.startContainer,filterFn,true);end=domUtils.findParent(range.endContainer,filterFn,true);if(start&&end&&start===end){range.deleteContents();range.insertNode(span.cloneNode(true).firstChild).setCursor(true);}else{var bookmark=range.createBookmark();range.enlarge(true);var bookmark2=range.createBookmark(),current=domUtils.getNextDomNode(bookmark2.start,false,filterFn);while(current&&!(domUtils.getPosition(current,bookmark2.end)&domUtils.POSITION_FOLLOWING)){current.insertBefore(span.cloneNode(true).firstChild,current.firstChild);current=domUtils.getNextDomNode(current,false,filterFn);}range.moveToBookmark(bookmark2).moveToBookmark(bookmark).select();}}domUtils.preventDefault(evt);}
if(browser.gecko&&keyCode==46){range=me.selection.getRange();if(range.collapsed){start=range.startContainer;if(domUtils.isEmptyBlock(start)){var parent=start.parentNode;while(domUtils.getChildCount(parent)==1&&!domUtils.isBody(parent)){start=parent;parent=parent.parentNode;}if(start===parent.lastChild)evt.preventDefault();return;}}}});me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which,rng,me=this;if(keyCode==keymap.Backspace){if(me.fireEvent('delkeyup')){return;}rng=me.selection.getRange();if(rng.collapsed){var tmpNode,autoClearTagName=['h1','h2','h3','h4','h5','h6'];if(tmpNode=domUtils.findParentByTagName(rng.startContainer,autoClearTagName,true)){if(domUtils.isEmptyBlock(tmpNode)){var pre=tmpNode.previousSibling;if(pre&&pre.nodeName!='TABLE'){domUtils.remove(tmpNode);rng.setStartAtLast(pre).setCursor(false,true);return;}else{var next=tmpNode.nextSibling;if(next&&next.nodeName!='TABLE'){domUtils.remove(tmpNode);rng.setStartAtFirst(next).setCursor(false,true);return;}}}}
if(domUtils.isBody(rng.startContainer)){var tmpNode=domUtils.createElement(me.document,'p',{'innerHTML':browser.ie?domUtils.fillChar:'<br/>'});rng.insertNode(tmpNode).setStart(tmpNode,0).setCursor(false,true);}}
if(!collapsed&&(rng.startContainer.nodeType==3||rng.startContainer.nodeType==1&&domUtils.isEmptyBlock(rng.startContainer))){if(browser.ie){var span=rng.document.createElement('span');rng.insertNode(span).setStartBefore(span).collapse(true);rng.select();domUtils.remove(span);}else{rng.select();}}}});};UE.plugins['fiximgclick']=function(){var elementUpdated=false;function Scale(){this.editor=null;this.resizer=null;this.cover=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0};}(function(){var rect=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];Scale.prototype={init:function init(editor){var me=this;me.editor=editor;me.startPos=this.prePos={x:0,y:0};me.dragId=-1;var hands=[],cover=me.cover=document.createElement('div'),resizer=me.resizer=document.createElement('div');cover.id=me.editor.ui.id+'_imagescale_cover';cover.style.cssText='position:absolute;display:none;z-index:'+me.editor.options.zIndex+';filter:alpha(opacity=0); opacity:0;background:#CCC;';domUtils.on(cover,'mousedown click',function(){me.hide();});for(i=0;i<8;i++){hands.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');}resizer.id=me.editor.ui.id+'_imagescale';resizer.className='edui-editor-imagescale';resizer.innerHTML=hands.join('');resizer.style.cssText+=';display:none;border:1px solid #3b77ff;z-index:'+me.editor.options.zIndex+';';me.editor.ui.getDom().appendChild(cover);me.editor.ui.getDom().appendChild(resizer);me.initStyle();me.initEvents();},initStyle:function initStyle(){utils.cssRule('imagescale','.edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}'+'.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}'+'.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}');},initEvents:function initEvents(){var me=this;me.startPos.x=me.startPos.y=0;me.isDraging=false;},_eventHandler:function _eventHandler(e){var me=this;switch(e.type){case'mousedown':var hand=e.target||e.srcElement,hand;if(hand.className.indexOf('edui-editor-imagescale-hand')!=-1&&me.dragId==-1){me.dragId=hand.className.slice(-1);me.startPos.x=me.prePos.x=e.clientX;me.startPos.y=me.prePos.y=e.clientY;domUtils.on(me.doc,'mousemove',me.proxy(me._eventHandler,me));}break;case'mousemove':if(me.dragId!=-1){me.updateContainerStyle(me.dragId,{x:e.clientX-me.prePos.x,y:e.clientY-me.prePos.y});me.prePos.x=e.clientX;me.prePos.y=e.clientY;elementUpdated=true;me.updateTargetElement();}break;case'mouseup':if(me.dragId!=-1){me.updateContainerStyle(me.dragId,{x:e.clientX-me.prePos.x,y:e.clientY-me.prePos.y});me.updateTargetElement();if(me.target.parentNode)me.attachTo(me.target);me.dragId=-1;}domUtils.un(me.doc,'mousemove',me.proxy(me._eventHandler,me));if(elementUpdated){elementUpdated=false;me.editor.fireEvent('contentchange');}break;default:break;}},updateTargetElement:function updateTargetElement(){var me=this;domUtils.setStyles(me.target,{'width':me.resizer.style.width,'height':me.resizer.style.height});me.target.width=parseInt(me.resizer.style.width);me.target.height=parseInt(me.resizer.style.height);me.attachTo(me.target);},updateContainerStyle:function updateContainerStyle(dir,offset){var me=this,dom=me.resizer,tmp;if(rect[dir][0]!=0){tmp=parseInt(dom.style.left)+offset.x;dom.style.left=me._validScaledProp('left',tmp)+'px';}if(rect[dir][1]!=0){tmp=parseInt(dom.style.top)+offset.y;dom.style.top=me._validScaledProp('top',tmp)+'px';}if(rect[dir][2]!=0){tmp=dom.clientWidth+rect[dir][2]*offset.x;dom.style.width=me._validScaledProp('width',tmp)+'px';}if(rect[dir][3]!=0){tmp=dom.clientHeight+rect[dir][3]*offset.y;dom.style.height=me._validScaledProp('height',tmp)+'px';}},_validScaledProp:function _validScaledProp(prop,value){var ele=this.resizer,wrap=document;value=isNaN(value)?0:value;switch(prop){case'left':return value<0?0:value+ele.clientWidth>wrap.clientWidth?wrap.clientWidth-ele.clientWidth:value;case'top':return value<0?0:value+ele.clientHeight>wrap.clientHeight?wrap.clientHeight-ele.clientHeight:value;case'width':return value<=0?1:value+ele.offsetLeft>wrap.clientWidth?wrap.clientWidth-ele.offsetLeft:value;case'height':return value<=0?1:value+ele.offsetTop>wrap.clientHeight?wrap.clientHeight-ele.offsetTop:value;}},hideCover:function hideCover(){this.cover.style.display='none';},showCover:function showCover(){var me=this,editorPos=domUtils.getXY(me.editor.ui.getDom()),iframePos=domUtils.getXY(me.editor.iframe);domUtils.setStyles(me.cover,{'width':me.editor.iframe.offsetWidth+'px','height':me.editor.iframe.offsetHeight+'px','top':iframePos.y-editorPos.y+'px','left':iframePos.x-editorPos.x+'px','position':'absolute','display':''});},show:function show(targetObj){var me=this;me.resizer.style.display='block';if(targetObj)me.attachTo(targetObj);domUtils.on(this.resizer,'mousedown',me.proxy(me._eventHandler,me));domUtils.on(me.doc,'mouseup',me.proxy(me._eventHandler,me));me.showCover();me.editor.fireEvent('afterscaleshow',me);me.editor.fireEvent('saveScene');},hide:function hide(){var me=this;me.hideCover();me.resizer.style.display='none';domUtils.un(me.resizer,'mousedown',me.proxy(me._eventHandler,me));domUtils.un(me.doc,'mouseup',me.proxy(me._eventHandler,me));me.editor.fireEvent('afterscalehide',me);},proxy:function proxy(fn,context){return function(e){return fn.apply(context||this,arguments);};},attachTo:function attachTo(targetObj){var me=this,target=me.target=targetObj,resizer=this.resizer,imgPos=domUtils.getXY(target),iframePos=domUtils.getXY(me.editor.iframe),editorPos=domUtils.getXY(resizer.parentNode);domUtils.setStyles(resizer,{'width':target.width+'px','height':target.height+'px','left':iframePos.x+imgPos.x-me.editor.document.body.scrollLeft-editorPos.x-parseInt(resizer.style.borderLeftWidth)+'px','top':iframePos.y+imgPos.y-me.editor.document.body.scrollTop-editorPos.y-parseInt(resizer.style.borderTopWidth)+'px'});}};})();return function(){var me=this,imageScale;me.setOpt('imageScaleEnabled',true);if(!browser.ie&&me.options.imageScaleEnabled){me.addListener('click',function(type,e){var range=me.selection.getRange(),img=range.getClosedNode();if(img&&img.tagName=='IMG'&&me.body.contentEditable!="false"){if(img.className.indexOf("edui-faked-music")!=-1||img.getAttribute("anchorname")||domUtils.hasClass(img,'loadingclass')||domUtils.hasClass(img,'loaderrorclass')){return;}if(!imageScale){imageScale=new Scale();imageScale.init(me);me.ui.getDom().appendChild(imageScale.resizer);var _keyDownHandler=function _keyDownHandler(e){imageScale.hide();if(imageScale.target)me.selection.getRange().selectNode(imageScale.target).select();},_mouseDownHandler=function _mouseDownHandler(e){var ele=e.target||e.srcElement;if(ele&&(ele.className===undefined||ele.className.indexOf('edui-editor-imagescale')==-1)){_keyDownHandler(e);}},timer;me.addListener('afterscaleshow',function(e){me.addListener('beforekeydown',_keyDownHandler);me.addListener('beforemousedown',_mouseDownHandler);domUtils.on(document,'keydown',_keyDownHandler);domUtils.on(document,'mousedown',_mouseDownHandler);me.selection.getNative().removeAllRanges();});me.addListener('afterscalehide',function(e){me.removeListener('beforekeydown',_keyDownHandler);me.removeListener('beforemousedown',_mouseDownHandler);domUtils.un(document,'keydown',_keyDownHandler);domUtils.un(document,'mousedown',_mouseDownHandler);var target=imageScale.target;if(target.parentNode){me.selection.getRange().selectNode(target).select();}});domUtils.on(imageScale.resizer,'mousedown',function(e){me.selection.getNative().removeAllRanges();var ele=e.target||e.srcElement;if(ele&&ele.className.indexOf('edui-editor-imagescale-hand')==-1){timer=setTimeout(function(){imageScale.hide();if(imageScale.target)me.selection.getRange().selectNode(ele).select();},200);}});domUtils.on(imageScale.resizer,'mouseup',function(e){var ele=e.target||e.srcElement;if(ele&&ele.className.indexOf('edui-editor-imagescale-hand')==-1){clearTimeout(timer);}});}imageScale.show(img);}else{if(imageScale&&imageScale.resizer.style.display!='none')imageScale.hide();}});}if(browser.webkit){me.addListener('click',function(type,e){if(e.target.tagName=='IMG'&&me.body.contentEditable!="false"){var range=new dom.Range(me.document);range.selectNode(e.target).select();}});}};}();UE.plugin.register('autolink',function(){var cont=0;return!browser.ie?{bindEvents:{'reset':function reset(){cont=0;},'keydown':function keydown(type,evt){var me=this;var keyCode=evt.keyCode||evt.which;if(keyCode==32||keyCode==13){var sel=me.selection.getNative(),range=sel.getRangeAt(0).cloneRange(),offset,charCode;var start=range.startContainer;while(start.nodeType==1&&range.startOffset>0){start=range.startContainer.childNodes[range.startOffset-1];if(!start){break;}range.setStart(start,start.nodeType==1?start.childNodes.length:start.nodeValue.length);range.collapse(true);start=range.startContainer;}do{if(range.startOffset==0){start=range.startContainer.previousSibling;while(start&&start.nodeType==1){start=start.lastChild;}if(!start||domUtils.isFillChar(start)){break;}offset=start.nodeValue.length;}else{start=range.startContainer;offset=range.startOffset;}range.setStart(start,offset-1);charCode=range.toString().charCodeAt(0);}while(charCode!=160&&charCode!=32);if(range.toString().replace(new RegExp(domUtils.fillChar,'g'),'').match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(range.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(range.toString())){break;}try{range.setStart(range.startContainer,range.startOffset+1);}catch(e){var start=range.startContainer;while(!(next=start.nextSibling)){if(domUtils.isBody(start)){return;}start=start.parentNode;}range.setStart(next,0);}}
if(domUtils.findParentByTagName(range.startContainer,'a',true)){return;}var a=me.document.createElement('a'),text=me.document.createTextNode(' '),href;me.undoManger&&me.undoManger.save();a.appendChild(range.extractContents());a.href=a.innerHTML=a.innerHTML.replace(/<[^>]+>/g,'');href=a.getAttribute("href").replace(new RegExp(domUtils.fillChar,'g'),'');href=/^(?:https?:\/\/)/ig.test(href)?href:"http://"+href;a.setAttribute('_src',utils.html(href));a.href=utils.html(href);range.insertNode(a);a.parentNode.insertBefore(text,a.nextSibling);range.setStart(text,0);range.collapse(true);sel.removeAllRanges();sel.addRange(range);me.undoManger&&me.undoManger.save();}}}}}:{};},function(){var keyCodes={37:1,38:1,39:1,40:1,13:1,32:1};function checkIsCludeLink(node){if(node.nodeType==3){return null;}if(node.nodeName=='A'){return node;}var lastChild=node.lastChild;while(lastChild){if(lastChild.nodeName=='A'){return lastChild;}if(lastChild.nodeType==3){if(domUtils.isWhitespace(lastChild)){lastChild=lastChild.previousSibling;continue;}return null;}lastChild=lastChild.lastChild;}}browser.ie&&this.addListener('keyup',function(cmd,evt){var me=this,keyCode=evt.keyCode;if(keyCodes[keyCode]){var rng=me.selection.getRange();var start=rng.startContainer;if(keyCode==13){while(start&&!domUtils.isBody(start)&&!domUtils.isBlockElm(start)){start=start.parentNode;}if(start&&!domUtils.isBody(start)&&start.nodeName=='P'){var pre=start.previousSibling;if(pre&&pre.nodeType==1){var pre=checkIsCludeLink(pre);if(pre&&!pre.getAttribute('_href')){domUtils.remove(pre,true);}}}}else if(keyCode==32){if(start.nodeType==3&&/^\s$/.test(start.nodeValue)){start=start.previousSibling;if(start&&start.nodeName=='A'&&!start.getAttribute('_href')){domUtils.remove(start,true);}}}else{start=domUtils.findParentByTagName(start,'a',true);if(start&&!start.getAttribute('_href')){var bk=rng.createBookmark();domUtils.remove(start,true);rng.moveToBookmark(bk).select(true);}}}});});UE.plugins['autoheight']=function(){var me=this;me.autoHeightEnabled=me.options.autoHeightEnabled!==false;if(!me.autoHeightEnabled){return;}var bakOverflow,lastHeight=0,options=me.options,currentHeight,timer;function adjustHeight(){var me=this;clearTimeout(timer);if(isFullscreen)return;if(!me.queryCommandState||me.queryCommandState&&me.queryCommandState('source')!=1){timer=setTimeout(function(){var node=me.body.lastChild;while(node&&node.nodeType!=1){node=node.previousSibling;}if(node&&node.nodeType==1){node.style.clear='both';currentHeight=Math.max(domUtils.getXY(node).y+node.offsetHeight+25,Math.max(options.minFrameHeight,options.initialFrameHeight));if(currentHeight!=lastHeight){if(currentHeight!==parseInt(me.iframe.parentNode.style.height)){me.iframe.parentNode.style.height=currentHeight+'px';}me.body.style.height=currentHeight+'px';lastHeight=currentHeight;}domUtils.removeStyle(node,'clear');}},50);}}var isFullscreen;me.addListener('fullscreenchanged',function(cmd,f){isFullscreen=f;});me.addListener('destroy',function(){me.removeListener('contentchange afterinserthtml keyup mouseup',adjustHeight);});me.enableAutoHeight=function(){var me=this;if(!me.autoHeightEnabled){return;}var doc=me.document;me.autoHeightEnabled=true;bakOverflow=doc.body.style.overflowY;doc.body.style.overflowY='hidden';me.addListener('contentchange afterinserthtml keyup mouseup',adjustHeight);setTimeout(function(){adjustHeight.call(me);},browser.gecko?100:0);me.fireEvent('autoheightchanged',me.autoHeightEnabled);};me.disableAutoHeight=function(){me.body.style.overflowY=bakOverflow||'';me.removeListener('contentchange',adjustHeight);me.removeListener('keyup',adjustHeight);me.removeListener('mouseup',adjustHeight);me.autoHeightEnabled=false;me.fireEvent('autoheightchanged',me.autoHeightEnabled);};me.on('setHeight',function(){me.disableAutoHeight();});me.addListener('ready',function(){me.enableAutoHeight();var timer;domUtils.on(browser.ie?me.body:me.document,browser.webkit?'dragover':'drop',function(){clearTimeout(timer);timer=setTimeout(function(){adjustHeight.call(me);},100);});var lastScrollY;window.onscroll=function(){if(lastScrollY===null){lastScrollY=this.scrollY;}else if(this.scrollY==0&&lastScrollY!=0){me.window.scrollTo(0,0);lastScrollY=null;}};});};UE.plugins['autofloat']=function(){var me=this,lang=me.getLang();me.setOpt({topOffset:0});var optsAutoFloatEnabled=me.options.autoFloatEnabled!==false,topOffset=me.options.topOffset;if(!optsAutoFloatEnabled){return;}var uiUtils=UE.ui.uiUtils,LteIE6=browser.ie&&browser.version<=6,quirks=browser.quirks;function checkHasUI(){if(!UE.ui){alert(lang.autofloatMsg);return 0;}return 1;}function fixIE6FixedPos(){var docStyle=document.body.style;docStyle.backgroundImage='url("about:blank")';docStyle.backgroundAttachment='fixed';}var bakCssText,placeHolder=document.createElement('div'),toolbarBox,orgTop,getPosition,flag=true;function setFloating(){var toobarBoxPos=domUtils.getXY(toolbarBox),origalFloat=domUtils.getComputedStyle(toolbarBox,'position'),origalLeft=domUtils.getComputedStyle(toolbarBox,'left');toolbarBox.style.width=toolbarBox.offsetWidth+'px';toolbarBox.style.zIndex=me.options.zIndex*1+1;toolbarBox.parentNode.insertBefore(placeHolder,toolbarBox);if(LteIE6||quirks&&browser.ie){if(toolbarBox.style.position!='absolute'){toolbarBox.style.position='absolute';}toolbarBox.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-orgTop+topOffset+'px';}else{if(browser.ie7Compat&&flag){flag=false;toolbarBox.style.left=domUtils.getXY(toolbarBox).x-document.documentElement.getBoundingClientRect().left+2+'px';}if(toolbarBox.style.position!='fixed'){toolbarBox.style.position='fixed';toolbarBox.style.top=topOffset+"px";(origalFloat=='absolute'||origalFloat=='relative')&&parseFloat(origalLeft)&&(toolbarBox.style.left=toobarBoxPos.x+'px');}}}function unsetFloating(){flag=true;if(placeHolder.parentNode){placeHolder.parentNode.removeChild(placeHolder);}toolbarBox.style.cssText=bakCssText;}function updateFloating(){var rect3=getPosition(me.container);var offset=me.options.toolbarTopOffset||0;if(rect3.top<0&&rect3.bottom-toolbarBox.offsetHeight>offset){setFloating();}else{unsetFloating();}}var defer_updateFloating=utils.defer(function(){updateFloating();},browser.ie?200:100,true);me.addListener('destroy',function(){domUtils.un(window,['scroll','resize'],updateFloating);me.removeListener('keydown',defer_updateFloating);});me.addListener('ready',function(){if(checkHasUI(me)){if(!me.ui){return;}getPosition=uiUtils.getClientRect;toolbarBox=me.ui.getDom('toolbarbox');orgTop=getPosition(toolbarBox).top;bakCssText=toolbarBox.style.cssText;placeHolder.style.height=toolbarBox.offsetHeight+'px';if(LteIE6){fixIE6FixedPos();}domUtils.on(window,['scroll','resize'],updateFloating);me.addListener('keydown',defer_updateFloating);me.addListener('beforefullscreenchange',function(t,enabled){if(enabled){unsetFloating();}});me.addListener('fullscreenchanged',function(t,enabled){if(!enabled){updateFloating();}});me.addListener('sourcemodechanged',function(t,enabled){setTimeout(function(){updateFloating();},0);});me.addListener("clearDoc",function(){setTimeout(function(){updateFloating();},0);});}});};UE.plugins['video']=function(){var me=this;function creatInsertStr(url,width,height,id,align,classname,type){var str;switch(type){case'image':str='<img '+(id?'id="'+id+'"':'')+' width="'+width+'" height="'+height+'" _url="'+url+'" class="'+classname.replace(/\bvideo-js\b/,'')+'"'+' src="'+me.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+me.options.UEDITOR_HOME_URL+'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;'+(align?'float:'+align+';':'')+'" />';break;case'embed':str='<embed type="application/x-shockwave-flash" class="'+classname+'" pluginspage="http://www.macromedia.com/go/getflashplayer"'+' src="'+utils.html(url)+'" width="'+width+'" height="'+height+'"'+(align?' style="float:'+align+'"':'')+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case'video':var ext=url.substr(url.lastIndexOf('.')+1);if(ext=='ogv')ext='ogg';str='<video'+(id?' id="'+id+'"':'')+' class="'+classname+' video-js" '+(align?' style="float:'+align+'"':'')+' controls preload="none" width="'+width+'" height="'+height+'" src="'+url+'" data-setup="{}">'+'<source src="'+url+'" type="video/'+ext+'" /></video>';break;}return str;}function switchImgAndVideo(root,img2video){utils.each(root.getNodesByTagName(img2video?'img':'embed video'),function(node){var className=node.getAttr('class');if(className&&className.indexOf('edui-faked-video')!=-1){var html=creatInsertStr(img2video?node.getAttr('_url'):node.getAttr('src'),node.getAttr('width'),node.getAttr('height'),null,node.getStyle('float')||'',className,img2video?'embed':'image');node.parentNode.replaceChild(UE.uNode.createElement(html),node);}if(className&&className.indexOf('edui-upload-video')!=-1){var html=creatInsertStr(img2video?node.getAttr('_url'):node.getAttr('src'),node.getAttr('width'),node.getAttr('height'),null,node.getStyle('float')||'',className,img2video?'video':'image');node.parentNode.replaceChild(UE.uNode.createElement(html),node);}});}me.addOutputRule(function(root){switchImgAndVideo(root,true);});me.addInputRule(function(root){switchImgAndVideo(root);});me.commands["insertvideo"]={execCommand:function execCommand(cmd,videoObjs,type){videoObjs=utils.isArray(videoObjs)?videoObjs:[videoObjs];var html=[],id='tmpVedio',cl;for(var i=0,vi,len=videoObjs.length;i<len;i++){vi=videoObjs[i];cl=type=='upload'?'edui-upload-video video-js vjs-default-skin':'edui-faked-video';html.push(creatInsertStr(vi.url,vi.width||420,vi.height||280,id+i,null,cl,'image'));}me.execCommand("inserthtml",html.join(""),true);var rng=this.selection.getRange();for(var i=0,len=videoObjs.length;i<len;i++){var img=this.document.getElementById('tmpVedio'+i);domUtils.removeAttributes(img,'id');rng.selectNode(img).select();me.execCommand('imagefloat',videoObjs[i].align);}},queryCommandState:function queryCommandState(){var img=me.selection.getRange().getClosedNode(),flag=img&&(img.className=="edui-faked-video"||img.className.indexOf("edui-upload-video")!=-1);return flag?1:0;}};};(function(){var UETable=UE.UETable=function(table){this.table=table;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(table);};UETable.removeSelectedClass=function(cells){utils.each(cells,function(cell){domUtils.removeClasses(cell,"selectTdClass");});};UETable.addSelectedClass=function(cells){utils.each(cells,function(cell){domUtils.addClass(cell,"selectTdClass");});};UETable.isEmptyBlock=function(node){var reg=new RegExp(domUtils.fillChar,'g');if(node[browser.ie?'innerText':'textContent'].replace(/^\s*$/,'').replace(reg,'').length>0){return 0;}for(var i in dtd.$isNotEmpty){if(dtd.$isNotEmpty.hasOwnProperty(i)){if(node.getElementsByTagName(i).length){return 0;}}}return 1;};UETable.getWidth=function(cell){if(!cell)return 0;return parseInt(domUtils.getComputedStyle(cell,"width"),10);};UETable.getTableCellAlignState=function(cells){!utils.isArray(cells)&&(cells=[cells]);var result={},status=['align','valign'],tempStatus=null,isSame=true;utils.each(cells,function(cellNode){utils.each(status,function(currentState){tempStatus=cellNode.getAttribute(currentState);if(!result[currentState]&&tempStatus){result[currentState]=tempStatus;}else if(!result[currentState]||tempStatus!==result[currentState]){isSame=false;return false;}});return isSame;});return isSame?result:null;};UETable.getTableItemsByRange=function(editor){var start=editor.selection.getStart();if(start&&start.id&&start.id.indexOf('_baidu_bookmark_start_')===0&&start.nextSibling){start=start.nextSibling;}
var cell=start&&domUtils.findParentByTagName(start,["td","th"],true),tr=cell&&cell.parentNode,caption=start&&domUtils.findParentByTagName(start,'caption',true),table=caption?caption.parentNode:tr&&tr.parentNode.parentNode;return{cell:cell,tr:tr,table:table,caption:caption};};UETable.getUETableBySelected=function(editor){var table=UETable.getTableItemsByRange(editor).table;if(table&&table.ueTable&&table.ueTable.selectedTds.length){return table.ueTable;}return null;};UETable.getDefaultValue=function(editor,table){var borderMap={thin:'0px',medium:'1px',thick:'2px'},tableBorder,tdPadding,tdBorder,tmpValue;if(!table){table=editor.document.createElement('table');table.insertRow(0).insertCell(0).innerHTML='xxx';editor.body.appendChild(table);var td=table.getElementsByTagName('td')[0];tmpValue=domUtils.getComputedStyle(table,'border-left-width');tableBorder=parseInt(borderMap[tmpValue]||tmpValue,10);tmpValue=domUtils.getComputedStyle(td,'padding-left');tdPadding=parseInt(borderMap[tmpValue]||tmpValue,10);tmpValue=domUtils.getComputedStyle(td,'border-left-width');tdBorder=parseInt(borderMap[tmpValue]||tmpValue,10);domUtils.remove(table);return{tableBorder:tableBorder,tdPadding:tdPadding,tdBorder:tdBorder};}else{td=table.getElementsByTagName('td')[0];tmpValue=domUtils.getComputedStyle(table,'border-left-width');tableBorder=parseInt(borderMap[tmpValue]||tmpValue,10);tmpValue=domUtils.getComputedStyle(td,'padding-left');tdPadding=parseInt(borderMap[tmpValue]||tmpValue,10);tmpValue=domUtils.getComputedStyle(td,'border-left-width');tdBorder=parseInt(borderMap[tmpValue]||tmpValue,10);return{tableBorder:tableBorder,tdPadding:tdPadding,tdBorder:tdBorder};}};UETable.getUETable=function(tdOrTable){var tag=tdOrTable.tagName.toLowerCase();tdOrTable=tag=="td"||tag=="th"||tag=='caption'?domUtils.findParentByTagName(tdOrTable,"table",true):tdOrTable;if(!tdOrTable.ueTable){tdOrTable.ueTable=new UETable(tdOrTable);}return tdOrTable.ueTable;};UETable.cloneCell=function(cell,ignoreMerge,keepPro){if(!cell||utils.isString(cell)){return this.table.ownerDocument.createElement(cell||'td');}var flag=domUtils.hasClass(cell,"selectTdClass");flag&&domUtils.removeClasses(cell,"selectTdClass");var tmpCell=cell.cloneNode(true);if(ignoreMerge){tmpCell.rowSpan=tmpCell.colSpan=1;}
!keepPro&&domUtils.removeAttributes(tmpCell,'width height');!keepPro&&domUtils.removeAttributes(tmpCell,'style');tmpCell.style.borderLeftStyle="";tmpCell.style.borderTopStyle="";tmpCell.style.borderLeftColor=cell.style.borderRightColor;tmpCell.style.borderLeftWidth=cell.style.borderRightWidth;tmpCell.style.borderTopColor=cell.style.borderBottomColor;tmpCell.style.borderTopWidth=cell.style.borderBottomWidth;flag&&domUtils.addClass(cell,"selectTdClass");return tmpCell;};UETable.prototype={getMaxRows:function getMaxRows(){var rows=this.table.rows,maxLen=1;for(var i=0,row;row=rows[i];i++){var currentMax=1;for(var j=0,cj;cj=row.cells[j++];){currentMax=Math.max(cj.rowSpan||1,currentMax);}maxLen=Math.max(currentMax+i,maxLen);}return maxLen;},getMaxCols:function getMaxCols(){var rows=this.table.rows,maxLen=0,cellRows={};for(var i=0,row;row=rows[i];i++){var cellsNum=0;for(var j=0,cj;cj=row.cells[j++];){cellsNum+=cj.colSpan||1;if(cj.rowSpan&&cj.rowSpan>1){for(var k=1;k<cj.rowSpan;k++){if(!cellRows['row_'+(i+k)]){cellRows['row_'+(i+k)]=cj.colSpan||1;}else{cellRows['row_'+(i+k)]++;}}}}cellsNum+=cellRows['row_'+i]||0;maxLen=Math.max(cellsNum,maxLen);}return maxLen;},getCellColIndex:function getCellColIndex(cell){},getHSideCell:function getHSideCell(cell,right){try{var cellInfo=this.getCellInfo(cell),previewRowIndex,previewColIndex;var len=this.selectedTds.length,range=this.cellsRange;if(!right&&(!len?!cellInfo.colIndex:!range.beginColIndex)||right&&(!len?cellInfo.colIndex==this.colsNum-1:range.endColIndex==this.colsNum-1))return null;previewRowIndex=!len?cellInfo.rowIndex:range.beginRowIndex;previewColIndex=!right?!len?cellInfo.colIndex<1?0:cellInfo.colIndex-1:range.beginColIndex-1:!len?cellInfo.colIndex+1:range.endColIndex+1;return this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex,this.indexTable[previewRowIndex][previewColIndex].cellIndex);}catch(e){showError(e);}},getTabNextCell:function getTabNextCell(cell,preRowIndex){var cellInfo=this.getCellInfo(cell),rowIndex=preRowIndex||cellInfo.rowIndex,colIndex=cellInfo.colIndex+1+(cellInfo.colSpan-1),nextCell;try{nextCell=this.getCell(this.indexTable[rowIndex][colIndex].rowIndex,this.indexTable[rowIndex][colIndex].cellIndex);}catch(e){try{rowIndex=rowIndex*1+1;colIndex=0;nextCell=this.getCell(this.indexTable[rowIndex][colIndex].rowIndex,this.indexTable[rowIndex][colIndex].cellIndex);}catch(e){}}return nextCell;},getVSideCell:function getVSideCell(cell,bottom,ignoreRange){try{var cellInfo=this.getCellInfo(cell),nextRowIndex,nextColIndex;var len=this.selectedTds.length&&!ignoreRange,range=this.cellsRange;if(!bottom&&cellInfo.rowIndex==0||bottom&&(!len?cellInfo.rowIndex+cellInfo.rowSpan>this.rowsNum-1:range.endRowIndex==this.rowsNum-1))return null;nextRowIndex=!bottom?!len?cellInfo.rowIndex-1:range.beginRowIndex-1:!len?cellInfo.rowIndex+cellInfo.rowSpan:range.endRowIndex+1;nextColIndex=!len?cellInfo.colIndex:range.beginColIndex;return this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex,this.indexTable[nextRowIndex][nextColIndex].cellIndex);}catch(e){showError(e);}},getSameEndPosCells:function getSameEndPosCells(cell,xOrY){try{var flag=xOrY.toLowerCase()==="x",end=domUtils.getXY(cell)[flag?'x':'y']+cell["offset"+(flag?'Width':'Height')],rows=this.table.rows,cells=null,returns=[];for(var i=0;i<this.rowsNum;i++){cells=rows[i].cells;for(var j=0,tmpCell;tmpCell=cells[j++];){var tmpEnd=domUtils.getXY(tmpCell)[flag?'x':'y']+tmpCell["offset"+(flag?'Width':'Height')];if(tmpEnd>end&&flag)break;if(cell==tmpCell||end==tmpEnd){if(tmpCell[flag?"colSpan":"rowSpan"]==1){returns.push(tmpCell);}if(flag)break;}}}return returns;}catch(e){showError(e);}},setCellContent:function setCellContent(cell,content){cell.innerHTML=content||(browser.ie?domUtils.fillChar:"<br />");},cloneCell:UETable.cloneCell,getSameStartPosXCells:function getSameStartPosXCells(cell){try{var start=domUtils.getXY(cell).x+cell.offsetWidth,rows=this.table.rows,cells,returns=[];for(var i=0;i<this.rowsNum;i++){cells=rows[i].cells;for(var j=0,tmpCell;tmpCell=cells[j++];){var tmpStart=domUtils.getXY(tmpCell).x;if(tmpStart>start)break;if(tmpStart==start&&tmpCell.colSpan==1){returns.push(tmpCell);break;}}}return returns;}catch(e){showError(e);}},update:function update(table){this.table=table||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];var rows=this.table.rows,rowsNum=this.getMaxRows(),dNum=rowsNum-rows.length,colsNum=this.getMaxCols();while(dNum--){this.table.insertRow(rows.length);}this.rowsNum=rowsNum;this.colsNum=colsNum;for(var i=0,len=rows.length;i<len;i++){this.indexTable[i]=new Array(colsNum);}
for(var rowIndex=0,row;row=rows[rowIndex];rowIndex++){for(var cellIndex=0,cell,cells=row.cells;cell=cells[cellIndex];cellIndex++){if(cell.rowSpan>rowsNum){cell.rowSpan=rowsNum;}var colIndex=cellIndex,rowSpan=cell.rowSpan||1,colSpan=cell.colSpan||1;while(this.indexTable[rowIndex][colIndex]){colIndex++;}for(var j=0;j<rowSpan;j++){for(var k=0;k<colSpan;k++){this.indexTable[rowIndex+j][colIndex+k]={rowIndex:rowIndex,cellIndex:cellIndex,colIndex:colIndex,rowSpan:rowSpan,colSpan:colSpan};}}}}
for(j=0;j<rowsNum;j++){for(k=0;k<colsNum;k++){if(this.indexTable[j][k]===undefined){row=rows[j];cell=row.cells[row.cells.length-1];cell=cell?cell.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(cell);if(cell.colSpan!==1)cell.colSpan=1;if(cell.rowSpan!==1)cell.rowSpan=1;row.appendChild(cell);this.indexTable[j][k]={rowIndex:j,cellIndex:cell.cellIndex,colIndex:k,rowSpan:1,colSpan:1};}}}
var tds=domUtils.getElementsByTagName(this.table,"td"),selectTds=[];utils.each(tds,function(td){if(domUtils.hasClass(td,"selectTdClass")){selectTds.push(td);}});if(selectTds.length){var start=selectTds[0],end=selectTds[selectTds.length-1],startInfo=this.getCellInfo(start),endInfo=this.getCellInfo(end);this.selectedTds=selectTds;this.cellsRange={beginRowIndex:startInfo.rowIndex,beginColIndex:startInfo.colIndex,endRowIndex:endInfo.rowIndex+endInfo.rowSpan-1,endColIndex:endInfo.colIndex+endInfo.colSpan-1};}
if(!domUtils.hasClass(this.table.rows[0],"firstRow")){domUtils.addClass(this.table.rows[0],"firstRow");for(var i=1;i<this.table.rows.length;i++){domUtils.removeClasses(this.table.rows[i],"firstRow");}}},getCellInfo:function getCellInfo(cell){if(!cell)return;var cellIndex=cell.cellIndex,rowIndex=cell.parentNode.rowIndex,rowInfo=this.indexTable[rowIndex],numCols=this.colsNum;for(var colIndex=cellIndex;colIndex<numCols;colIndex++){var cellInfo=rowInfo[colIndex];if(cellInfo.rowIndex===rowIndex&&cellInfo.cellIndex===cellIndex){return cellInfo;}}},getCell:function getCell(rowIndex,cellIndex){return rowIndex<this.rowsNum&&this.table.rows[rowIndex].cells[cellIndex]||null;},deleteCell:function deleteCell(cell,rowIndex){rowIndex=typeof rowIndex=='number'?rowIndex:cell.parentNode.rowIndex;var row=this.table.rows[rowIndex];row.deleteCell(cell.cellIndex);},getCellsRange:function getCellsRange(cellA,cellB){function checkRange(beginRowIndex,beginColIndex,endRowIndex,endColIndex){var tmpBeginRowIndex=beginRowIndex,tmpBeginColIndex=beginColIndex,tmpEndRowIndex=endRowIndex,tmpEndColIndex=endColIndex,cellInfo,colIndex,rowIndex;if(beginRowIndex>0){for(colIndex=beginColIndex;colIndex<endColIndex;colIndex++){cellInfo=me.indexTable[beginRowIndex][colIndex];rowIndex=cellInfo.rowIndex;if(rowIndex<beginRowIndex){tmpBeginRowIndex=Math.min(rowIndex,tmpBeginRowIndex);}}}
if(endColIndex<me.colsNum){for(rowIndex=beginRowIndex;rowIndex<endRowIndex;rowIndex++){cellInfo=me.indexTable[rowIndex][endColIndex];colIndex=cellInfo.colIndex+cellInfo.colSpan-1;if(colIndex>endColIndex){tmpEndColIndex=Math.max(colIndex,tmpEndColIndex);}}}
if(endRowIndex<me.rowsNum){for(colIndex=beginColIndex;colIndex<endColIndex;colIndex++){cellInfo=me.indexTable[endRowIndex][colIndex];rowIndex=cellInfo.rowIndex+cellInfo.rowSpan-1;if(rowIndex>endRowIndex){tmpEndRowIndex=Math.max(rowIndex,tmpEndRowIndex);}}}
if(beginColIndex>0){for(rowIndex=beginRowIndex;rowIndex<endRowIndex;rowIndex++){cellInfo=me.indexTable[rowIndex][beginColIndex];colIndex=cellInfo.colIndex;if(colIndex<beginColIndex){tmpBeginColIndex=Math.min(cellInfo.colIndex,tmpBeginColIndex);}}}
if(tmpBeginRowIndex!=beginRowIndex||tmpBeginColIndex!=beginColIndex||tmpEndRowIndex!=endRowIndex||tmpEndColIndex!=endColIndex){return checkRange(tmpBeginRowIndex,tmpBeginColIndex,tmpEndRowIndex,tmpEndColIndex);}else{return{beginRowIndex:beginRowIndex,beginColIndex:beginColIndex,endRowIndex:endRowIndex,endColIndex:endColIndex};}}try{var me=this,cellAInfo=me.getCellInfo(cellA);if(cellA===cellB){return{beginRowIndex:cellAInfo.rowIndex,beginColIndex:cellAInfo.colIndex,endRowIndex:cellAInfo.rowIndex+cellAInfo.rowSpan-1,endColIndex:cellAInfo.colIndex+cellAInfo.colSpan-1};}var cellBInfo=me.getCellInfo(cellB);var beginRowIndex=Math.min(cellAInfo.rowIndex,cellBInfo.rowIndex),beginColIndex=Math.min(cellAInfo.colIndex,cellBInfo.colIndex),endRowIndex=Math.max(cellAInfo.rowIndex+cellAInfo.rowSpan-1,cellBInfo.rowIndex+cellBInfo.rowSpan-1),endColIndex=Math.max(cellAInfo.colIndex+cellAInfo.colSpan-1,cellBInfo.colIndex+cellBInfo.colSpan-1);return checkRange(beginRowIndex,beginColIndex,endRowIndex,endColIndex);}catch(e){}},getCells:function getCells(range){this.clearSelected();var beginRowIndex=range.beginRowIndex,beginColIndex=range.beginColIndex,endRowIndex=range.endRowIndex,endColIndex=range.endColIndex,cellInfo,rowIndex,colIndex,tdHash={},returnTds=[];for(var i=beginRowIndex;i<=endRowIndex;i++){for(var j=beginColIndex;j<=endColIndex;j++){cellInfo=this.indexTable[i][j];rowIndex=cellInfo.rowIndex;colIndex=cellInfo.colIndex;var key=rowIndex+'|'+colIndex;if(tdHash[key])continue;tdHash[key]=1;if(rowIndex<i||colIndex<j||rowIndex+cellInfo.rowSpan-1>endRowIndex||colIndex+cellInfo.colSpan-1>endColIndex){return null;}returnTds.push(this.getCell(rowIndex,cellInfo.cellIndex));}}return returnTds;},clearSelected:function clearSelected(){UETable.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={};},setSelected:function setSelected(range){var cells=this.getCells(range);UETable.addSelectedClass(cells);this.selectedTds=cells;this.cellsRange=range;},isFullRow:function isFullRow(){var range=this.cellsRange;return range.endColIndex-range.beginColIndex+1==this.colsNum;},isFullCol:function isFullCol(){var range=this.cellsRange,table=this.table,ths=table.getElementsByTagName("th"),rows=range.endRowIndex-range.beginRowIndex+1;return!ths.length?rows==this.rowsNum:rows==this.rowsNum||rows==this.rowsNum-1;},getNextCell:function getNextCell(cell,bottom,ignoreRange){try{var cellInfo=this.getCellInfo(cell),nextRowIndex,nextColIndex;var len=this.selectedTds.length&&!ignoreRange,range=this.cellsRange;if(!bottom&&cellInfo.rowIndex==0||bottom&&(!len?cellInfo.rowIndex+cellInfo.rowSpan>this.rowsNum-1:range.endRowIndex==this.rowsNum-1))return null;nextRowIndex=!bottom?!len?cellInfo.rowIndex-1:range.beginRowIndex-1:!len?cellInfo.rowIndex+cellInfo.rowSpan:range.endRowIndex+1;nextColIndex=!len?cellInfo.colIndex:range.beginColIndex;return this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex,this.indexTable[nextRowIndex][nextColIndex].cellIndex);}catch(e){showError(e);}},getPreviewCell:function getPreviewCell(cell,top){try{var cellInfo=this.getCellInfo(cell),previewRowIndex,previewColIndex;var len=this.selectedTds.length,range=this.cellsRange;if(!top&&(!len?!cellInfo.colIndex:!range.beginColIndex)||top&&(!len?cellInfo.rowIndex>this.colsNum-1:range.endColIndex==this.colsNum-1))return null;previewRowIndex=!top?!len?cellInfo.rowIndex:range.beginRowIndex:!len?cellInfo.rowIndex<1?0:cellInfo.rowIndex-1:range.beginRowIndex;previewColIndex=!top?!len?cellInfo.colIndex<1?0:cellInfo.colIndex-1:range.beginColIndex-1:!len?cellInfo.colIndex:range.endColIndex+1;return this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex,this.indexTable[previewRowIndex][previewColIndex].cellIndex);}catch(e){showError(e);}},moveContent:function moveContent(cellTo,cellFrom){if(UETable.isEmptyBlock(cellFrom))return;if(UETable.isEmptyBlock(cellTo)){cellTo.innerHTML=cellFrom.innerHTML;return;}var child=cellTo.lastChild;if(child.nodeType==3||!dtd.$block[child.tagName]){cellTo.appendChild(cellTo.ownerDocument.createElement('br'));}while(child=cellFrom.firstChild){cellTo.appendChild(child);}},mergeRight:function mergeRight(cell){var cellInfo=this.getCellInfo(cell),rightColIndex=cellInfo.colIndex+cellInfo.colSpan,rightCellInfo=this.indexTable[cellInfo.rowIndex][rightColIndex],rightCell=this.getCell(rightCellInfo.rowIndex,rightCellInfo.cellIndex);cell.colSpan=cellInfo.colSpan+rightCellInfo.colSpan;cell.removeAttribute("width");this.moveContent(cell,rightCell);this.deleteCell(rightCell,rightCellInfo.rowIndex);this.update();},mergeDown:function mergeDown(cell){var cellInfo=this.getCellInfo(cell),downRowIndex=cellInfo.rowIndex+cellInfo.rowSpan,downCellInfo=this.indexTable[downRowIndex][cellInfo.colIndex],downCell=this.getCell(downCellInfo.rowIndex,downCellInfo.cellIndex);cell.rowSpan=cellInfo.rowSpan+downCellInfo.rowSpan;cell.removeAttribute("height");this.moveContent(cell,downCell);this.deleteCell(downCell,downCellInfo.rowIndex);this.update();},mergeRange:function mergeRange(){var range=this.cellsRange,leftTopCell=this.getCell(range.beginRowIndex,this.indexTable[range.beginRowIndex][range.beginColIndex].cellIndex);if(leftTopCell.tagName=="TH"&&range.endRowIndex!==range.beginRowIndex){var index=this.indexTable,info=this.getCellInfo(leftTopCell);leftTopCell=this.getCell(1,index[1][info.colIndex].cellIndex);range=this.getCellsRange(leftTopCell,this.getCell(index[this.rowsNum-1][info.colIndex].rowIndex,index[this.rowsNum-1][info.colIndex].cellIndex));}
var cells=this.getCells(range);for(var i=0,ci;ci=cells[i++];){if(ci!==leftTopCell){this.moveContent(leftTopCell,ci);this.deleteCell(ci);}}
leftTopCell.rowSpan=range.endRowIndex-range.beginRowIndex+1;leftTopCell.rowSpan>1&&leftTopCell.removeAttribute("height");leftTopCell.colSpan=range.endColIndex-range.beginColIndex+1;leftTopCell.colSpan>1&&leftTopCell.removeAttribute("width");if(leftTopCell.rowSpan==this.rowsNum&&leftTopCell.colSpan!=1){leftTopCell.colSpan=1;}if(leftTopCell.colSpan==this.colsNum&&leftTopCell.rowSpan!=1){var rowIndex=leftTopCell.parentNode.rowIndex;if(this.table.deleteRow){for(var i=rowIndex+1,curIndex=rowIndex+1,len=leftTopCell.rowSpan;i<len;i++){this.table.deleteRow(curIndex);}}else{for(var i=0,len=leftTopCell.rowSpan-1;i<len;i++){var row=this.table.rows[rowIndex+1];row.parentNode.removeChild(row);}}leftTopCell.rowSpan=1;}this.update();},insertRow:function insertRow(rowIndex,sourceCell){var numCols=this.colsNum,table=this.table,row=table.insertRow(rowIndex),cell,isInsertTitle=typeof sourceCell=='string'&&sourceCell.toUpperCase()=='TH';function replaceTdToTh(colIndex,cell,tableRow){if(colIndex==0){var tr=tableRow.nextSibling||tableRow.previousSibling,th=tr.cells[colIndex];if(th.tagName=='TH'){th=cell.ownerDocument.createElement("th");th.appendChild(cell.firstChild);tableRow.insertBefore(th,cell);domUtils.remove(cell);}}else{if(cell.tagName=='TH'){var td=cell.ownerDocument.createElement("td");td.appendChild(cell.firstChild);tableRow.insertBefore(td,cell);domUtils.remove(cell);}}}
if(rowIndex==0||rowIndex==this.rowsNum){for(var colIndex=0;colIndex<numCols;colIndex++){cell=this.cloneCell(sourceCell,true);this.setCellContent(cell);cell.getAttribute('vAlign')&&cell.setAttribute('vAlign',cell.getAttribute('vAlign'));row.appendChild(cell);if(!isInsertTitle)replaceTdToTh(colIndex,cell,row);}}else{var infoRow=this.indexTable[rowIndex],cellIndex=0;for(colIndex=0;colIndex<numCols;colIndex++){var cellInfo=infoRow[colIndex];if(cellInfo.rowIndex<rowIndex){cell=this.getCell(cellInfo.rowIndex,cellInfo.cellIndex);cell.rowSpan=cellInfo.rowSpan+1;}else{cell=this.cloneCell(sourceCell,true);this.setCellContent(cell);row.appendChild(cell);}if(!isInsertTitle)replaceTdToTh(colIndex,cell,row);}}
this.update();return row;},deleteRow:function deleteRow(rowIndex){var row=this.table.rows[rowIndex],infoRow=this.indexTable[rowIndex],colsNum=this.colsNum,count=0;for(var colIndex=0;colIndex<colsNum;){var cellInfo=infoRow[colIndex],cell=this.getCell(cellInfo.rowIndex,cellInfo.cellIndex);if(cell.rowSpan>1){if(cellInfo.rowIndex==rowIndex){var clone=cell.cloneNode(true);clone.rowSpan=cell.rowSpan-1;clone.innerHTML="";cell.rowSpan=1;var nextRowIndex=rowIndex+1,nextRow=this.table.rows[nextRowIndex],insertCellIndex,preMerged=this.getPreviewMergedCellsNum(nextRowIndex,colIndex)-count;if(preMerged<colIndex){insertCellIndex=colIndex-preMerged-1;domUtils.insertAfter(nextRow.cells[insertCellIndex],clone);}else{if(nextRow.cells.length)nextRow.insertBefore(clone,nextRow.cells[0]);}count+=1;}}colIndex+=cell.colSpan||1;}var deleteTds=[],cacheMap={};for(colIndex=0;colIndex<colsNum;colIndex++){var tmpRowIndex=infoRow[colIndex].rowIndex,tmpCellIndex=infoRow[colIndex].cellIndex,key=tmpRowIndex+"_"+tmpCellIndex;if(cacheMap[key])continue;cacheMap[key]=1;cell=this.getCell(tmpRowIndex,tmpCellIndex);deleteTds.push(cell);}var mergeTds=[];utils.each(deleteTds,function(td){if(td.rowSpan==1){td.parentNode.removeChild(td);}else{mergeTds.push(td);}});utils.each(mergeTds,function(td){td.rowSpan--;});row.parentNode.removeChild(row);this.update();},insertCol:function insertCol(colIndex,sourceCell,defaultValue){var rowsNum=this.rowsNum,rowIndex=0,tableRow,cell,backWidth=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),isInsertTitleCol=typeof sourceCell=='string'&&sourceCell.toUpperCase()=='TH';function replaceTdToTh(rowIndex,cell,tableRow){if(rowIndex==0){var th=cell.nextSibling||cell.previousSibling;if(th.tagName=='TH'){th=cell.ownerDocument.createElement("th");th.appendChild(cell.firstChild);tableRow.insertBefore(th,cell);domUtils.remove(cell);}}else{if(cell.tagName=='TH'){var td=cell.ownerDocument.createElement("td");td.appendChild(cell.firstChild);tableRow.insertBefore(td,cell);domUtils.remove(cell);}}}var preCell;if(colIndex==0||colIndex==this.colsNum){for(;rowIndex<rowsNum;rowIndex++){tableRow=this.table.rows[rowIndex];preCell=tableRow.cells[colIndex==0?colIndex:tableRow.cells.length];cell=this.cloneCell(sourceCell,true);this.setCellContent(cell);cell.setAttribute('vAlign',cell.getAttribute('vAlign'));preCell&&cell.setAttribute('width',preCell.getAttribute('width'));if(!colIndex){tableRow.insertBefore(cell,tableRow.cells[0]);}else{domUtils.insertAfter(tableRow.cells[tableRow.cells.length-1],cell);}if(!isInsertTitleCol)replaceTdToTh(rowIndex,cell,tableRow);}}else{for(;rowIndex<rowsNum;rowIndex++){var cellInfo=this.indexTable[rowIndex][colIndex];if(cellInfo.colIndex<colIndex){cell=this.getCell(cellInfo.rowIndex,cellInfo.cellIndex);cell.colSpan=cellInfo.colSpan+1;}else{tableRow=this.table.rows[rowIndex];preCell=tableRow.cells[cellInfo.cellIndex];cell=this.cloneCell(sourceCell,true);this.setCellContent(cell);cell.setAttribute('vAlign',cell.getAttribute('vAlign'));preCell&&cell.setAttribute('width',preCell.getAttribute('width'));preCell?tableRow.insertBefore(cell,preCell):tableRow.appendChild(cell);}if(!isInsertTitleCol)replaceTdToTh(rowIndex,cell,tableRow);}}
this.update();this.updateWidth(backWidth,defaultValue||{tdPadding:10,tdBorder:1});},updateWidth:function updateWidth(width,defaultValue){var table=this.table,tmpWidth=UETable.getWidth(table)-defaultValue.tdPadding*2-defaultValue.tdBorder+width;if(tmpWidth<table.ownerDocument.body.offsetWidth){table.setAttribute("width",tmpWidth);return;}var tds=domUtils.getElementsByTagName(this.table,"td th");utils.each(tds,function(td){td.setAttribute("width",width);});},deleteCol:function deleteCol(colIndex){var indexTable=this.indexTable,tableRows=this.table.rows,backTableWidth=this.table.getAttribute("width"),backTdWidth=0,rowsNum=this.rowsNum,cacheMap={};for(var rowIndex=0;rowIndex<rowsNum;){var infoRow=indexTable[rowIndex],cellInfo=infoRow[colIndex],key=cellInfo.rowIndex+'_'+cellInfo.colIndex;if(cacheMap[key])continue;cacheMap[key]=1;var cell=this.getCell(cellInfo.rowIndex,cellInfo.cellIndex);if(!backTdWidth)backTdWidth=cell&&parseInt(cell.offsetWidth/cell.colSpan,10).toFixed(0);if(cell.colSpan>1){cell.colSpan--;}else{tableRows[rowIndex].deleteCell(cellInfo.cellIndex);}rowIndex+=cellInfo.rowSpan||1;}this.table.setAttribute("width",backTableWidth-backTdWidth);this.update();},splitToCells:function splitToCells(cell){var me=this,cells=this.splitToRows(cell);utils.each(cells,function(cell){me.splitToCols(cell);});},splitToRows:function splitToRows(cell){var cellInfo=this.getCellInfo(cell),rowIndex=cellInfo.rowIndex,colIndex=cellInfo.colIndex,results=[];cell.rowSpan=1;results.push(cell);for(var i=rowIndex,endRow=rowIndex+cellInfo.rowSpan;i<endRow;i++){if(i==rowIndex)continue;var tableRow=this.table.rows[i],tmpCell=tableRow.insertCell(colIndex-this.getPreviewMergedCellsNum(i,colIndex));tmpCell.colSpan=cellInfo.colSpan;this.setCellContent(tmpCell);tmpCell.setAttribute('vAlign',cell.getAttribute('vAlign'));tmpCell.setAttribute('align',cell.getAttribute('align'));if(cell.style.cssText){tmpCell.style.cssText=cell.style.cssText;}results.push(tmpCell);}this.update();return results;},getPreviewMergedCellsNum:function getPreviewMergedCellsNum(rowIndex,colIndex){var indexRow=this.indexTable[rowIndex],num=0;for(var i=0;i<colIndex;){var colSpan=indexRow[i].colSpan,tmpRowIndex=indexRow[i].rowIndex;num+=colSpan-(tmpRowIndex==rowIndex?1:0);i+=colSpan;}return num;},splitToCols:function splitToCols(cell){var backWidth=(cell.offsetWidth/cell.colSpan-22).toFixed(0),cellInfo=this.getCellInfo(cell),rowIndex=cellInfo.rowIndex,colIndex=cellInfo.colIndex,results=[];cell.colSpan=1;cell.setAttribute("width",backWidth);results.push(cell);for(var j=colIndex,endCol=colIndex+cellInfo.colSpan;j<endCol;j++){if(j==colIndex)continue;var tableRow=this.table.rows[rowIndex],tmpCell=tableRow.insertCell(this.indexTable[rowIndex][j].cellIndex+1);tmpCell.rowSpan=cellInfo.rowSpan;this.setCellContent(tmpCell);tmpCell.setAttribute('vAlign',cell.getAttribute('vAlign'));tmpCell.setAttribute('align',cell.getAttribute('align'));tmpCell.setAttribute('width',backWidth);if(cell.style.cssText){tmpCell.style.cssText=cell.style.cssText;}
if(cell.tagName=='TH'){var th=cell.ownerDocument.createElement('th');th.appendChild(tmpCell.firstChild);th.setAttribute('vAlign',cell.getAttribute('vAlign'));th.rowSpan=tmpCell.rowSpan;tableRow.insertBefore(th,tmpCell);domUtils.remove(tmpCell);}results.push(tmpCell);}this.update();return results;},isLastCell:function isLastCell(cell,rowsNum,colsNum){rowsNum=rowsNum||this.rowsNum;colsNum=colsNum||this.colsNum;var cellInfo=this.getCellInfo(cell);return cellInfo.rowIndex+cellInfo.rowSpan==rowsNum&&cellInfo.colIndex+cellInfo.colSpan==colsNum;},getLastCell:function getLastCell(cells){cells=cells||this.table.getElementsByTagName("td");var firstInfo=this.getCellInfo(cells[0]);var me=this,last=cells[0],tr=last.parentNode,cellsNum=0,cols=0,rows;utils.each(cells,function(cell){if(cell.parentNode==tr)cols+=cell.colSpan||1;cellsNum+=cell.rowSpan*cell.colSpan||1;});rows=cellsNum/cols;utils.each(cells,function(cell){if(me.isLastCell(cell,rows,cols)){last=cell;return false;}});return last;},selectRow:function selectRow(rowIndex){var indexRow=this.indexTable[rowIndex],start=this.getCell(indexRow[0].rowIndex,indexRow[0].cellIndex),end=this.getCell(indexRow[this.colsNum-1].rowIndex,indexRow[this.colsNum-1].cellIndex),range=this.getCellsRange(start,end);this.setSelected(range);},selectTable:function selectTable(){var tds=this.table.getElementsByTagName("td"),range=this.getCellsRange(tds[0],tds[tds.length-1]);this.setSelected(range);},setBackground:function setBackground(cells,value){if(typeof value==="string"){utils.each(cells,function(cell){cell.style.backgroundColor=value;});}else if((typeof value==='undefined'?'undefined':_typeof(value))==="object"){value=utils.extend({repeat:true,colorList:["#ddd","#fff"]},value);var rowIndex=this.getCellInfo(cells[0]).rowIndex,count=0,colors=value.colorList,getColor=function getColor(list,index,repeat){return list[index]?list[index]:repeat?list[index%list.length]:"";};for(var i=0,cell;cell=cells[i++];){var cellInfo=this.getCellInfo(cell);cell.style.backgroundColor=getColor(colors,rowIndex+count==cellInfo.rowIndex?count:++count,value.repeat);}}},removeBackground:function removeBackground(cells){utils.each(cells,function(cell){cell.style.backgroundColor="";});}};function showError(e){}})();;(function(){var UT=UE.UETable,getTableItemsByRange=function getTableItemsByRange(editor){return UT.getTableItemsByRange(editor);},getUETableBySelected=function getUETableBySelected(editor){return UT.getUETableBySelected(editor);},getDefaultValue=function getDefaultValue(editor,table){return UT.getDefaultValue(editor,table);},getUETable=function getUETable(tdOrTable){return UT.getUETable(tdOrTable);};UE.commands['inserttable']={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).table?-1:0;},execCommand:function execCommand(cmd,opt){function createTable(opt,tdWidth){var html=[],rowsNum=opt.numRows,colsNum=opt.numCols;for(var r=0;r<rowsNum;r++){html.push('<tr'+(r==0?' class="firstRow"':'')+'>');for(var c=0;c<colsNum;c++){html.push('<td width="'+tdWidth+'"  vAlign="'+opt.tdvalign+'" >'+(browser.ie&&browser.version<11?domUtils.fillChar:'<br/>')+'</td>');}html.push('</tr>');}
return'<table><tbody>'+html.join('')+'</tbody></table>';}if(!opt){opt=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign});}var me=this;var range=this.selection.getRange(),start=range.startContainer,firstParentBlock=domUtils.findParent(start,function(node){return domUtils.isBlockElm(node);},true)||me.body;var defaultValue=getDefaultValue(me),tableWidth=firstParentBlock.offsetWidth,tdWidth=Math.floor(tableWidth/opt.numCols-defaultValue.tdPadding*2-defaultValue.tdBorder);!opt.tdvalign&&(opt.tdvalign=me.options.tdvalign);me.execCommand("inserthtml",createTable(opt,tdWidth));}};UE.commands['insertparagraphbeforetable']={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).cell?0:-1;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;if(table){var p=this.document.createElement("p");p.innerHTML=browser.ie?'&nbsp;':'<br />';table.parentNode.insertBefore(p,table);this.selection.getRange().setStart(p,0).setCursor();}}};UE.commands['deletetable']={queryCommandState:function queryCommandState(){var rng=this.selection.getRange();return domUtils.findParentByTagName(rng.startContainer,'table',true)?0:-1;},execCommand:function execCommand(cmd,table){var rng=this.selection.getRange();table=table||domUtils.findParentByTagName(rng.startContainer,'table',true);if(table){var next=table.nextSibling;if(!next){next=domUtils.createElement(this.document,'p',{'innerHTML':browser.ie?domUtils.fillChar:'<br/>'});table.parentNode.insertBefore(next,table);}domUtils.remove(table);rng=this.selection.getRange();if(next.nodeType==3){rng.setStartBefore(next);}else{rng.setStart(next,0);}rng.setCursor(false,true);this.fireEvent("tablehasdeleted");}}};UE.commands['cellalign']={queryCommandState:function queryCommandState(){return getSelectedArr(this).length?0:-1;},execCommand:function execCommand(cmd,align){var selectedTds=getSelectedArr(this);if(selectedTds.length){for(var i=0,ci;ci=selectedTds[i++];){ci.setAttribute('align',align);}}}};UE.commands['cellvalign']={queryCommandState:function queryCommandState(){return getSelectedArr(this).length?0:-1;},execCommand:function execCommand(cmd,valign){var selectedTds=getSelectedArr(this);if(selectedTds.length){for(var i=0,ci;ci=selectedTds[i++];){ci.setAttribute('vAlign',valign);}}}};UE.commands['insertcaption']={queryCommandState:function queryCommandState(){var table=getTableItemsByRange(this).table;if(table){return table.getElementsByTagName('caption').length==0?1:-1;}return-1;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;if(table){var caption=this.document.createElement('caption');caption.innerHTML=browser.ie?domUtils.fillChar:'<br/>';table.insertBefore(caption,table.firstChild);var range=this.selection.getRange();range.setStart(caption,0).setCursor();}}};UE.commands['deletecaption']={queryCommandState:function queryCommandState(){var rng=this.selection.getRange(),table=domUtils.findParentByTagName(rng.startContainer,'table');if(table){return table.getElementsByTagName('caption').length==0?-1:1;}return-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),table=domUtils.findParentByTagName(rng.startContainer,'table');if(table){domUtils.remove(table.getElementsByTagName('caption')[0]);var range=this.selection.getRange();range.setStart(table.rows[0].cells[0],0).setCursor();}}};UE.commands['inserttitle']={queryCommandState:function queryCommandState(){var table=getTableItemsByRange(this).table;if(table){var firstRow=table.rows[0];return firstRow.cells[firstRow.cells.length-1].tagName.toLowerCase()!='th'?0:-1;}return-1;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;if(table){getUETable(table).insertRow(0,'th');}var th=table.getElementsByTagName('th')[0];this.selection.getRange().setStart(th,0).setCursor(false,true);}};UE.commands['deletetitle']={queryCommandState:function queryCommandState(){var table=getTableItemsByRange(this).table;if(table){var firstRow=table.rows[0];return firstRow.cells[firstRow.cells.length-1].tagName.toLowerCase()=='th'?0:-1;}return-1;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;if(table){domUtils.remove(table.rows[0]);}var td=table.getElementsByTagName('td')[0];this.selection.getRange().setStart(td,0).setCursor(false,true);}};UE.commands['inserttitlecol']={queryCommandState:function queryCommandState(){var table=getTableItemsByRange(this).table;if(table){var lastRow=table.rows[table.rows.length-1];return lastRow.getElementsByTagName('th').length?-1:0;}return-1;},execCommand:function execCommand(cmd){var table=getTableItemsByRange(this).table;if(table){getUETable(table).insertCol(0,'th');}resetTdWidth(table,this);var th=table.getElementsByTagName('th')[0];this.selection.getRange().setStart(th,0).setCursor(false,true);}};UE.commands['deletetitlecol']={queryCommandState:function queryCommandState(){var table=getTableItemsByRange(this).table;if(table){var lastRow=table.rows[table.rows.length-1];return lastRow.getElementsByTagName('th').length?0:-1;}return-1;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;if(table){for(var i=0;i<table.rows.length;i++){domUtils.remove(table.rows[i].children[0]);}}resetTdWidth(table,this);var td=table.getElementsByTagName('td')[0];this.selection.getRange().setStart(td,0).setCursor(false,true);}};UE.commands["mergeright"]={queryCommandState:function queryCommandState(cmd){var tableItems=getTableItemsByRange(this),table=tableItems.table,cell=tableItems.cell;if(!table||!cell)return-1;var ut=getUETable(table);if(ut.selectedTds.length)return-1;var cellInfo=ut.getCellInfo(cell),rightColIndex=cellInfo.colIndex+cellInfo.colSpan;if(rightColIndex>=ut.colsNum)return-1;var rightCellInfo=ut.indexTable[cellInfo.rowIndex][rightColIndex],rightCell=table.rows[rightCellInfo.rowIndex].cells[rightCellInfo.cellIndex];if(!rightCell||cell.tagName!=rightCell.tagName)return-1;return rightCellInfo.rowIndex==cellInfo.rowIndex&&rightCellInfo.rowSpan==cellInfo.rowSpan?0:-1;},execCommand:function execCommand(cmd){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell);ut.mergeRight(cell);rng.moveToBookmark(bk).select();}};UE.commands["mergedown"]={queryCommandState:function queryCommandState(cmd){var tableItems=getTableItemsByRange(this),table=tableItems.table,cell=tableItems.cell;if(!table||!cell)return-1;var ut=getUETable(table);if(ut.selectedTds.length)return-1;var cellInfo=ut.getCellInfo(cell),downRowIndex=cellInfo.rowIndex+cellInfo.rowSpan;if(downRowIndex>=ut.rowsNum)return-1;var downCellInfo=ut.indexTable[downRowIndex][cellInfo.colIndex],downCell=table.rows[downCellInfo.rowIndex].cells[downCellInfo.cellIndex];if(!downCell||cell.tagName!=downCell.tagName)return-1;return downCellInfo.colIndex==cellInfo.colIndex&&downCellInfo.colSpan==cellInfo.colSpan?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell);ut.mergeDown(cell);rng.moveToBookmark(bk).select();}};UE.commands["mergecells"]={queryCommandState:function queryCommandState(){return getUETableBySelected(this)?0:-1;},execCommand:function execCommand(){var ut=getUETableBySelected(this);if(ut&&ut.selectedTds.length){var cell=ut.selectedTds[0];ut.mergeRange();var rng=this.selection.getRange();if(domUtils.isEmptyBlock(cell)){rng.setStart(cell,0).collapse(true);}else{rng.selectNodeContents(cell);}rng.select();}}};UE.commands["insertrow"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;return cell&&(cell.tagName=="TD"||cell.tagName=='TH'&&tableItems.tr!==tableItems.table.rows[0])&&getUETable(tableItems.table).rowsNum<this.options.maxRowNum?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var tableItems=getTableItemsByRange(this),cell=tableItems.cell,table=tableItems.table,ut=getUETable(table),cellInfo=ut.getCellInfo(cell);if(!ut.selectedTds.length){ut.insertRow(cellInfo.rowIndex,cell);}else{var range=ut.cellsRange;for(var i=0,len=range.endRowIndex-range.beginRowIndex+1;i<len;i++){ut.insertRow(range.beginRowIndex,cell);}}rng.moveToBookmark(bk).select();if(table.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",table);}};UE.commands["insertrownext"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;return cell&&cell.tagName=="TD"&&getUETable(tableItems.table).rowsNum<this.options.maxRowNum?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var tableItems=getTableItemsByRange(this),cell=tableItems.cell,table=tableItems.table,ut=getUETable(table),cellInfo=ut.getCellInfo(cell);if(!ut.selectedTds.length){ut.insertRow(cellInfo.rowIndex+cellInfo.rowSpan,cell);}else{var range=ut.cellsRange;for(var i=0,len=range.endRowIndex-range.beginRowIndex+1;i<len;i++){ut.insertRow(range.endRowIndex+1,cell);}}rng.moveToBookmark(bk).select();if(table.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",table);}};UE.commands["deleterow"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this);return tableItems.cell?0:-1;},execCommand:function execCommand(){var cell=getTableItemsByRange(this).cell,ut=getUETable(cell),cellsRange=ut.cellsRange,cellInfo=ut.getCellInfo(cell),preCell=ut.getVSideCell(cell),nextCell=ut.getVSideCell(cell,true),rng=this.selection.getRange();if(utils.isEmptyObject(cellsRange)){ut.deleteRow(cellInfo.rowIndex);}else{for(var i=cellsRange.beginRowIndex;i<cellsRange.endRowIndex+1;i++){ut.deleteRow(cellsRange.beginRowIndex);}}var table=ut.table;if(!table.getElementsByTagName('td').length){var nextSibling=table.nextSibling;domUtils.remove(table);if(nextSibling){rng.setStart(nextSibling,0).setCursor(false,true);}}else{if(cellInfo.rowSpan==1||cellInfo.rowSpan==cellsRange.endRowIndex-cellsRange.beginRowIndex+1){if(nextCell||preCell)rng.selectNodeContents(nextCell||preCell).setCursor(false,true);}else{var newCell=ut.getCell(cellInfo.rowIndex,ut.indexTable[cellInfo.rowIndex][cellInfo.colIndex].cellIndex);if(newCell)rng.selectNodeContents(newCell).setCursor(false,true);}}if(table.getAttribute("interlaced")==="enabled")this.fireEvent("interlacetable",table);}};UE.commands["insertcol"]={queryCommandState:function queryCommandState(cmd){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;return cell&&(cell.tagName=="TD"||cell.tagName=='TH'&&cell!==tableItems.tr.cells[0])&&getUETable(tableItems.table).colsNum<this.options.maxColNum?0:-1;},execCommand:function execCommand(cmd){var rng=this.selection.getRange(),bk=rng.createBookmark(true);if(this.queryCommandState(cmd)==-1)return;var cell=getTableItemsByRange(this).cell,ut=getUETable(cell),cellInfo=ut.getCellInfo(cell);if(!ut.selectedTds.length){ut.insertCol(cellInfo.colIndex,cell);}else{var range=ut.cellsRange;for(var i=0,len=range.endColIndex-range.beginColIndex+1;i<len;i++){ut.insertCol(range.beginColIndex,cell);}}rng.moveToBookmark(bk).select(true);}};UE.commands["insertcolnext"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;return cell&&getUETable(tableItems.table).colsNum<this.options.maxColNum?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell),cellInfo=ut.getCellInfo(cell);if(!ut.selectedTds.length){ut.insertCol(cellInfo.colIndex+cellInfo.colSpan,cell);}else{var range=ut.cellsRange;for(var i=0,len=range.endColIndex-range.beginColIndex+1;i<len;i++){ut.insertCol(range.endColIndex+1,cell);}}rng.moveToBookmark(bk).select();}};UE.commands["deletecol"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this);return tableItems.cell?0:-1;},execCommand:function execCommand(){var cell=getTableItemsByRange(this).cell,ut=getUETable(cell),range=ut.cellsRange,cellInfo=ut.getCellInfo(cell),preCell=ut.getHSideCell(cell),nextCell=ut.getHSideCell(cell,true);if(utils.isEmptyObject(range)){ut.deleteCol(cellInfo.colIndex);}else{for(var i=range.beginColIndex;i<range.endColIndex+1;i++){ut.deleteCol(range.beginColIndex);}}var table=ut.table,rng=this.selection.getRange();if(!table.getElementsByTagName('td').length){var nextSibling=table.nextSibling;domUtils.remove(table);if(nextSibling){rng.setStart(nextSibling,0).setCursor(false,true);}}else{if(domUtils.inDoc(cell,this.document)){rng.setStart(cell,0).setCursor(false,true);}else{if(nextCell&&domUtils.inDoc(nextCell,this.document)){rng.selectNodeContents(nextCell).setCursor(false,true);}else{if(preCell&&domUtils.inDoc(preCell,this.document)){rng.selectNodeContents(preCell).setCursor(true,true);}}}}}};UE.commands["splittocells"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;if(!cell)return-1;var ut=getUETable(tableItems.table);if(ut.selectedTds.length>0)return-1;return cell&&(cell.colSpan>1||cell.rowSpan>1)?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell);ut.splitToCells(cell);rng.moveToBookmark(bk).select();}};UE.commands["splittorows"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;if(!cell)return-1;var ut=getUETable(tableItems.table);if(ut.selectedTds.length>0)return-1;return cell&&cell.rowSpan>1?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell);ut.splitToRows(cell);rng.moveToBookmark(bk).select();}};UE.commands["splittocols"]={queryCommandState:function queryCommandState(){var tableItems=getTableItemsByRange(this),cell=tableItems.cell;if(!cell)return-1;var ut=getUETable(tableItems.table);if(ut.selectedTds.length>0)return-1;return cell&&cell.colSpan>1?0:-1;},execCommand:function execCommand(){var rng=this.selection.getRange(),bk=rng.createBookmark(true);var cell=getTableItemsByRange(this).cell,ut=getUETable(cell);ut.splitToCols(cell);rng.moveToBookmark(bk).select();}};UE.commands["adaptbytext"]=UE.commands["adaptbywindow"]={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).table?0:-1;},execCommand:function execCommand(cmd){var tableItems=getTableItemsByRange(this),table=tableItems.table;if(table){if(cmd=='adaptbywindow'){resetTdWidth(table,this);}else{var cells=domUtils.getElementsByTagName(table,"td th");utils.each(cells,function(cell){cell.removeAttribute("width");});table.removeAttribute("width");}}}};UE.commands['averagedistributecol']={queryCommandState:function queryCommandState(){var ut=getUETableBySelected(this);if(!ut)return-1;return ut.isFullRow()||ut.isFullCol()?0:-1;},execCommand:function execCommand(cmd){var me=this,ut=getUETableBySelected(me);function getAverageWidth(){var tb=ut.table,averageWidth,sumWidth=0,colsNum=0,tbAttr=getDefaultValue(me,tb);if(ut.isFullRow()){sumWidth=tb.offsetWidth;colsNum=ut.colsNum;}else{var begin=ut.cellsRange.beginColIndex,end=ut.cellsRange.endColIndex,node;for(var i=begin;i<=end;){node=ut.selectedTds[i];sumWidth+=node.offsetWidth;i+=node.colSpan;colsNum+=1;}}averageWidth=Math.ceil(sumWidth/colsNum)-tbAttr.tdBorder*2-tbAttr.tdPadding*2;return averageWidth;}function setAverageWidth(averageWidth){utils.each(domUtils.getElementsByTagName(ut.table,"th"),function(node){node.setAttribute("width","");});var cells=ut.isFullRow()?domUtils.getElementsByTagName(ut.table,"td"):ut.selectedTds;utils.each(cells,function(node){if(node.colSpan==1){node.setAttribute("width",averageWidth);}});}if(ut&&ut.selectedTds.length){setAverageWidth(getAverageWidth());}}};UE.commands['averagedistributerow']={queryCommandState:function queryCommandState(){var ut=getUETableBySelected(this);if(!ut)return-1;if(ut.selectedTds&&/th/ig.test(ut.selectedTds[0].tagName))return-1;return ut.isFullRow()||ut.isFullCol()?0:-1;},execCommand:function execCommand(cmd){var me=this,ut=getUETableBySelected(me);function getAverageHeight(){var averageHeight,rowNum,sumHeight=0,tb=ut.table,tbAttr=getDefaultValue(me,tb),tdpadding=parseInt(domUtils.getComputedStyle(tb.getElementsByTagName('td')[0],"padding-top"));if(ut.isFullCol()){var captionArr=domUtils.getElementsByTagName(tb,"caption"),thArr=domUtils.getElementsByTagName(tb,"th"),captionHeight,thHeight;if(captionArr.length>0){captionHeight=captionArr[0].offsetHeight;}if(thArr.length>0){thHeight=thArr[0].offsetHeight;}sumHeight=tb.offsetHeight-(captionHeight||0)-(thHeight||0);rowNum=thArr.length==0?ut.rowsNum:ut.rowsNum-1;}else{var begin=ut.cellsRange.beginRowIndex,end=ut.cellsRange.endRowIndex,count=0,trs=domUtils.getElementsByTagName(tb,"tr");for(var i=begin;i<=end;i++){sumHeight+=trs[i].offsetHeight;count+=1;}rowNum=count;}
if(browser.ie&&browser.version<9){averageHeight=Math.ceil(sumHeight/rowNum);}else{averageHeight=Math.ceil(sumHeight/rowNum)-tbAttr.tdBorder*2-tdpadding*2;}return averageHeight;}function setAverageHeight(averageHeight){var cells=ut.isFullCol()?domUtils.getElementsByTagName(ut.table,"td"):ut.selectedTds;utils.each(cells,function(node){if(node.rowSpan==1){node.setAttribute("height",averageHeight);}});}if(ut&&ut.selectedTds.length){setAverageHeight(getAverageHeight());}}};UE.commands['cellalignment']={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).table?0:-1;},execCommand:function execCommand(cmd,data){var me=this,ut=getUETableBySelected(me);if(!ut){var start=me.selection.getStart(),cell=start&&domUtils.findParentByTagName(start,["td","th","caption"],true);if(!/caption/ig.test(cell.tagName)){domUtils.setAttributes(cell,data);}else{cell.style.textAlign=data.align;cell.style.verticalAlign=data.vAlign;}me.selection.getRange().setCursor(true);}else{utils.each(ut.selectedTds,function(cell){domUtils.setAttributes(cell,data);});}},queryCommandValue:function queryCommandValue(cmd){var activeMenuCell=getTableItemsByRange(this).cell;if(!activeMenuCell){activeMenuCell=getSelectedArr(this)[0];}if(!activeMenuCell){return null;}else{var cells=UE.UETable.getUETable(activeMenuCell).selectedTds;!cells.length&&(cells=activeMenuCell);return UE.UETable.getTableCellAlignState(cells);}}};UE.commands['tablealignment']={queryCommandState:function queryCommandState(){if(browser.ie&&browser.version<8){return-1;}return getTableItemsByRange(this).table?0:-1;},execCommand:function execCommand(cmd,value){var me=this,start=me.selection.getStart(),table=start&&domUtils.findParentByTagName(start,["table"],true);if(table){table.setAttribute("align",value);}}};UE.commands['edittable']={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).table?0:-1;},execCommand:function execCommand(cmd,color){var rng=this.selection.getRange(),table=domUtils.findParentByTagName(rng.startContainer,'table');if(table){var arr=domUtils.getElementsByTagName(table,"td").concat(domUtils.getElementsByTagName(table,"th"),domUtils.getElementsByTagName(table,"caption"));utils.each(arr,function(node){node.style.borderColor=color;});}}};UE.commands['edittd']={queryCommandState:function queryCommandState(){return getTableItemsByRange(this).table?0:-1;},execCommand:function execCommand(cmd,bkColor){var me=this,ut=getUETableBySelected(me);if(!ut){var start=me.selection.getStart(),cell=start&&domUtils.findParentByTagName(start,["td","th","caption"],true);if(cell){cell.style.backgroundColor=bkColor;}}else{utils.each(ut.selectedTds,function(cell){cell.style.backgroundColor=bkColor;});}}};UE.commands["settablebackground"]={queryCommandState:function queryCommandState(){return getSelectedArr(this).length>1?0:-1;},execCommand:function execCommand(cmd,value){var cells,ut;cells=getSelectedArr(this);ut=getUETable(cells[0]);ut.setBackground(cells,value);}};UE.commands["cleartablebackground"]={queryCommandState:function queryCommandState(){var cells=getSelectedArr(this);if(!cells.length)return-1;for(var i=0,cell;cell=cells[i++];){if(cell.style.backgroundColor!=="")return 0;}return-1;},execCommand:function execCommand(){var cells=getSelectedArr(this),ut=getUETable(cells[0]);ut.removeBackground(cells);}};UE.commands["interlacetable"]=UE.commands["uninterlacetable"]={queryCommandState:function queryCommandState(cmd){var table=getTableItemsByRange(this).table;if(!table)return-1;var interlaced=table.getAttribute("interlaced");if(cmd=="interlacetable"){return interlaced==="enabled"?-1:0;}else{return!interlaced||interlaced==="disabled"?-1:0;}},execCommand:function execCommand(cmd,classList){var table=getTableItemsByRange(this).table;if(cmd=="interlacetable"){table.setAttribute("interlaced","enabled");this.fireEvent("interlacetable",table,classList);}else{table.setAttribute("interlaced","disabled");this.fireEvent("uninterlacetable",table);}}};UE.commands["setbordervisible"]={queryCommandState:function queryCommandState(cmd){var table=getTableItemsByRange(this).table;if(!table)return-1;return 0;},execCommand:function execCommand(){var table=getTableItemsByRange(this).table;utils.each(domUtils.getElementsByTagName(table,'td'),function(td){td.style.borderWidth='1px';td.style.borderStyle='solid';});}};function resetTdWidth(table,editor){var tds=domUtils.getElementsByTagName(table,'td th');utils.each(tds,function(td){td.removeAttribute("width");});table.setAttribute('width',getTableWidth(editor,true,getDefaultValue(editor,table)));var tdsWidths=[];setTimeout(function(){utils.each(tds,function(td){td.colSpan==1&&tdsWidths.push(td.offsetWidth);});utils.each(tds,function(td,i){td.colSpan==1&&td.setAttribute("width",tdsWidths[i]+"");});},0);}function getTableWidth(editor,needIEHack,defaultValue){var body=editor.body;return body.offsetWidth-(needIEHack?parseInt(domUtils.getComputedStyle(body,'margin-left'),10)*2:0)-defaultValue.tableBorder*2-(editor.options.offsetWidth||0);}function getSelectedArr(editor){var cell=getTableItemsByRange(editor).cell;if(cell){var ut=getUETable(cell);return ut.selectedTds.length?ut.selectedTds:[cell];}else{return[];}}})();UE.plugins['table']=function(){var me=this,tabTimer=null,tableDragTimer=null,tableResizeTimer=null,cellMinWidth=5,isInResizeBuffer=false,cellBorderWidth=5,offsetOfTableCell=10,singleClickState=0,userActionStatus=null,dblclickTime=360,UT=UE.UETable,getUETable=function getUETable(tdOrTable){return UT.getUETable(tdOrTable);},getUETableBySelected=function getUETableBySelected(editor){return UT.getUETableBySelected(editor);},getDefaultValue=function getDefaultValue(editor,table){return UT.getDefaultValue(editor,table);},removeSelectedClass=function removeSelectedClass(cells){return UT.removeSelectedClass(cells);};function showError(e){}me.ready(function(){var me=this;var orgGetText=me.selection.getText;me.selection.getText=function(){var table=getUETableBySelected(me);if(table){var str='';utils.each(table.selectedTds,function(td){str+=td[browser.ie?'innerText':'textContent'];});return str;}else{return orgGetText.call(me.selection);}};});var startTd=null,currentTd=null,onDrag="",onBorder=false,dragButton=null,dragOver=false,dragLine=null,dragTd=null;var mousedown=false,needIEHack=true;me.setOpt({'maxColNum':20,'maxRowNum':100,'defaultCols':5,'defaultRows':5,'tdvalign':'top','cursorpath':me.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",'tableDragable':false,'classList':["ue-table-interlace-color-single","ue-table-interlace-color-double"]});me.getUETable=getUETable;var commands={'deletetable':1,'inserttable':1,'cellvalign':1,'insertcaption':1,'deletecaption':1,'inserttitle':1,'deletetitle':1,"mergeright":1,"mergedown":1,"mergecells":1,"insertrow":1,"insertrownext":1,"deleterow":1,"insertcol":1,"insertcolnext":1,"deletecol":1,"splittocells":1,"splittorows":1,"splittocols":1,"adaptbytext":1,"adaptbywindow":1,"adaptbycustomer":1,"insertparagraph":1,"insertparagraphbeforetable":1,"averagedistributecol":1,"averagedistributerow":1};me.ready(function(){utils.cssRule('table','.selectTdClass{background-color:#edf5fa !important}'+'table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}'+'table{margin-bottom:10px;border-collapse:collapse;display:table;}'+'td,th{padding: 5px 10px;border: 1px solid #DDD;}'+'caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}'+'th{border-top:1px solid #BBB;background-color:#F7F7F7;}'+'table tr.firstRow th{border-top-width:2px;}'+'.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }'+'td p{margin:0;padding:0;}',me.document);var tableCopyList,isFullCol,isFullRow;me.addListener('keydown',function(cmd,evt){var me=this;var keyCode=evt.keyCode||evt.which;if(keyCode==8){var ut=getUETableBySelected(me);if(ut&&ut.selectedTds.length){if(ut.isFullCol()){me.execCommand('deletecol');}else if(ut.isFullRow()){me.execCommand('deleterow');}else{me.fireEvent('delcells');}domUtils.preventDefault(evt);}var caption=domUtils.findParentByTagName(me.selection.getStart(),'caption',true),range=me.selection.getRange();if(range.collapsed&&caption&&isEmptyBlock(caption)){me.fireEvent('saveScene');var table=caption.parentNode;domUtils.remove(caption);if(table){range.setStart(table.rows[0].cells[0],0).setCursor(false,true);}me.fireEvent('saveScene');}}if(keyCode==46){ut=getUETableBySelected(me);if(ut){me.fireEvent('saveScene');for(var i=0,ci;ci=ut.selectedTds[i++];){domUtils.fillNode(me.document,ci);}me.fireEvent('saveScene');domUtils.preventDefault(evt);}}if(keyCode==13){var rng=me.selection.getRange(),caption=domUtils.findParentByTagName(rng.startContainer,'caption',true);if(caption){var table=domUtils.findParentByTagName(caption,'table');if(!rng.collapsed){rng.deleteContents();me.fireEvent('saveScene');}else{if(caption){rng.setStart(table.rows[0].cells[0],0).setCursor(false,true);}}domUtils.preventDefault(evt);return;}if(rng.collapsed){var table=domUtils.findParentByTagName(rng.startContainer,'table');if(table){var cell=table.rows[0].cells[0],start=domUtils.findParentByTagName(me.selection.getStart(),['td','th'],true),preNode=table.previousSibling;if(cell===start&&(!preNode||preNode.nodeType==1&&preNode.tagName=='TABLE')&&domUtils.isStartInblock(rng)){var first=domUtils.findParent(me.selection.getStart(),function(n){return domUtils.isBlockElm(n);},true);if(first&&(/t(h|d)/i.test(first.tagName)||first===start.firstChild)){me.execCommand('insertparagraphbeforetable');domUtils.preventDefault(evt);}}}}}if((evt.ctrlKey||evt.metaKey)&&evt.keyCode=='67'){tableCopyList=null;var ut=getUETableBySelected(me);if(ut){var tds=ut.selectedTds;isFullCol=ut.isFullCol();isFullRow=ut.isFullRow();tableCopyList=[[ut.cloneCell(tds[0],null,true)]];for(var i=1,ci;ci=tds[i];i++){if(ci.parentNode!==tds[i-1].parentNode){tableCopyList.push([ut.cloneCell(ci,null,true)]);}else{tableCopyList[tableCopyList.length-1].push(ut.cloneCell(ci,null,true));}}}}});me.addListener("tablehasdeleted",function(){toggleDraggableState(this,false,"",null);if(dragButton)domUtils.remove(dragButton);});me.addListener('beforepaste',function(cmd,html){var me=this;var rng=me.selection.getRange();if(domUtils.findParentByTagName(rng.startContainer,'caption',true)){var div=me.document.createElement("div");div.innerHTML=html.html;html.html=div[browser.ie9below?'innerText':'textContent'];return;}var table=getUETableBySelected(me);if(tableCopyList){me.fireEvent('saveScene');var rng=me.selection.getRange();var td=domUtils.findParentByTagName(rng.startContainer,['td','th'],true),tmpNode,preNode;if(td){var ut=getUETable(td);if(isFullRow){var rowIndex=ut.getCellInfo(td).rowIndex;if(td.tagName=='TH'){rowIndex++;}for(var i=0,ci;ci=tableCopyList[i++];){var tr=ut.insertRow(rowIndex++,"td");for(var j=0,cj;cj=ci[j];j++){var cell=tr.cells[j];if(!cell){cell=tr.insertCell(j);}cell.innerHTML=cj.innerHTML;cj.getAttribute('width')&&cell.setAttribute('width',cj.getAttribute('width'));cj.getAttribute('vAlign')&&cell.setAttribute('vAlign',cj.getAttribute('vAlign'));cj.getAttribute('align')&&cell.setAttribute('align',cj.getAttribute('align'));cj.style.cssText&&(cell.style.cssText=cj.style.cssText);}for(var j=0,cj;cj=tr.cells[j];j++){if(!ci[j])break;cj.innerHTML=ci[j].innerHTML;ci[j].getAttribute('width')&&cj.setAttribute('width',ci[j].getAttribute('width'));ci[j].getAttribute('vAlign')&&cj.setAttribute('vAlign',ci[j].getAttribute('vAlign'));ci[j].getAttribute('align')&&cj.setAttribute('align',ci[j].getAttribute('align'));ci[j].style.cssText&&(cj.style.cssText=ci[j].style.cssText);}}}else{if(isFullCol){cellInfo=ut.getCellInfo(td);var maxColNum=0;for(var j=0,ci=tableCopyList[0],cj;cj=ci[j++];){maxColNum+=cj.colSpan||1;}me.__hasEnterExecCommand=true;for(i=0;i<maxColNum;i++){me.execCommand('insertcol');}me.__hasEnterExecCommand=false;td=ut.table.rows[0].cells[cellInfo.cellIndex];if(td.tagName=='TH'){td=ut.table.rows[1].cells[cellInfo.cellIndex];}}for(var i=0,ci;ci=tableCopyList[i++];){tmpNode=td;for(var j=0,cj;cj=ci[j++];){if(td){td.innerHTML=cj.innerHTML;cj.getAttribute('width')&&td.setAttribute('width',cj.getAttribute('width'));cj.getAttribute('vAlign')&&td.setAttribute('vAlign',cj.getAttribute('vAlign'));cj.getAttribute('align')&&td.setAttribute('align',cj.getAttribute('align'));cj.style.cssText&&(td.style.cssText=cj.style.cssText);preNode=td;td=td.nextSibling;}else{var cloneTd=cj.cloneNode(true);domUtils.removeAttributes(cloneTd,['class','rowSpan','colSpan']);preNode.parentNode.appendChild(cloneTd);}}td=ut.getNextCell(tmpNode,true,true);if(!tableCopyList[i])break;if(!td){var cellInfo=ut.getCellInfo(tmpNode);ut.table.insertRow(ut.table.rows.length);ut.update();td=ut.getVSideCell(tmpNode,true);}}}ut.update();}else{table=me.document.createElement('table');for(var i=0,ci;ci=tableCopyList[i++];){var tr=table.insertRow(table.rows.length);for(var j=0,cj;cj=ci[j++];){cloneTd=UT.cloneCell(cj,null,true);domUtils.removeAttributes(cloneTd,['class']);tr.appendChild(cloneTd);}if(j==2&&cloneTd.rowSpan>1){cloneTd.rowSpan=1;}}var defaultValue=getDefaultValue(me),width=me.body.offsetWidth-(needIEHack?parseInt(domUtils.getComputedStyle(me.body,'margin-left'),10)*2:0)-defaultValue.tableBorder*2-(me.options.offsetWidth||0);me.execCommand('insertHTML','<table  '+(isFullCol&&isFullRow?'width="'+width+'"':'')+'>'+table.innerHTML.replace(/>\s*</g,'><').replace(/\bth\b/gi,"td")+'</table>');}me.fireEvent('contentchange');me.fireEvent('saveScene');html.html='';return true;}else{var div=me.document.createElement("div"),tables;div.innerHTML=html.html;tables=div.getElementsByTagName("table");if(domUtils.findParentByTagName(me.selection.getStart(),'table')){utils.each(tables,function(t){domUtils.remove(t);});if(domUtils.findParentByTagName(me.selection.getStart(),'caption',true)){div.innerHTML=div[browser.ie?'innerText':'textContent'];}}else{utils.each(tables,function(table){removeStyleSize(table,true);domUtils.removeAttributes(table,['style','border']);utils.each(domUtils.getElementsByTagName(table,"td"),function(td){if(isEmptyBlock(td)){domUtils.fillNode(me.document,td);}removeStyleSize(td,true);});});}html.html=div.innerHTML;}});me.addListener('afterpaste',function(){utils.each(domUtils.getElementsByTagName(me.body,"table"),function(table){if(table.offsetWidth>me.body.offsetWidth){var defaultValue=getDefaultValue(me,table);table.style.width=me.body.offsetWidth-(needIEHack?parseInt(domUtils.getComputedStyle(me.body,'margin-left'),10)*2:0)-defaultValue.tableBorder*2-(me.options.offsetWidth||0)+'px';}});});me.addListener('blur',function(){tableCopyList=null;});var timer;me.addListener('keydown',function(){clearTimeout(timer);timer=setTimeout(function(){var rng=me.selection.getRange(),cell=domUtils.findParentByTagName(rng.startContainer,['th','td'],true);if(cell){var table=cell.parentNode.parentNode.parentNode;if(table.offsetWidth>table.getAttribute("width")){cell.style.wordBreak="break-all";}}},100);});me.addListener("selectionchange",function(){toggleDraggableState(me,false,"",null);});me.addListener("contentchange",function(){var me=this;hideDragLine(me);if(getUETableBySelected(me))return;var rng=me.selection.getRange();var start=rng.startContainer;start=domUtils.findParentByTagName(start,['td','th'],true);utils.each(domUtils.getElementsByTagName(me.document,'table'),function(table){if(me.fireEvent("excludetable",table)===true)return;table.ueTable=new UT(table);table.onmouseover=function(){me.fireEvent('tablemouseover',table);};table.onmousemove=function(){me.fireEvent('tablemousemove',table);me.options.tableDragable&&toggleDragButton(true,this,me);utils.defer(function(){me.fireEvent('contentchange',50);},true);};table.onmouseout=function(){me.fireEvent('tablemouseout',table);toggleDraggableState(me,false,"",null);hideDragLine(me);};table.onclick=function(evt){evt=me.window.event||evt;var target=getParentTdOrTh(evt.target||evt.srcElement);if(!target)return;var ut=getUETable(target),table=ut.table,cellInfo=ut.getCellInfo(target),cellsRange,rng=me.selection.getRange();if(inTableSide(table,target,evt,true)){var endTdCol=ut.getCell(ut.indexTable[ut.rowsNum-1][cellInfo.colIndex].rowIndex,ut.indexTable[ut.rowsNum-1][cellInfo.colIndex].cellIndex);if(evt.shiftKey&&ut.selectedTds.length){if(ut.selectedTds[0]!==endTdCol){cellsRange=ut.getCellsRange(ut.selectedTds[0],endTdCol);ut.setSelected(cellsRange);}else{rng&&rng.selectNodeContents(endTdCol).select();}}else{if(target!==endTdCol){cellsRange=ut.getCellsRange(target,endTdCol);ut.setSelected(cellsRange);}else{rng&&rng.selectNodeContents(endTdCol).select();}}return;}if(inTableSide(table,target,evt)){var endTdRow=ut.getCell(ut.indexTable[cellInfo.rowIndex][ut.colsNum-1].rowIndex,ut.indexTable[cellInfo.rowIndex][ut.colsNum-1].cellIndex);if(evt.shiftKey&&ut.selectedTds.length){if(ut.selectedTds[0]!==endTdRow){cellsRange=ut.getCellsRange(ut.selectedTds[0],endTdRow);ut.setSelected(cellsRange);}else{rng&&rng.selectNodeContents(endTdRow).select();}}else{if(target!==endTdRow){cellsRange=ut.getCellsRange(target,endTdRow);ut.setSelected(cellsRange);}else{rng&&rng.selectNodeContents(endTdRow).select();}}}};});switchBorderColor(me,true);});domUtils.on(me.document,"mousemove",mouseMoveEvent);domUtils.on(me.document,"mouseout",function(evt){var target=evt.target||evt.srcElement;if(target.tagName=="TABLE"){toggleDraggableState(me,false,"",null);}});me.addListener("interlacetable",function(type,table,classList){if(!table)return;var me=this,rows=table.rows,len=rows.length,getClass=function getClass(list,index,repeat){return list[index]?list[index]:repeat?list[index%list.length]:"";};for(var i=0;i<len;i++){rows[i].className=getClass(classList||me.options.classList,i,true);}});me.addListener("uninterlacetable",function(type,table){if(!table)return;var me=this,rows=table.rows,classList=me.options.classList,len=rows.length;for(var i=0;i<len;i++){domUtils.removeClasses(rows[i],classList);}});me.addListener("mousedown",mouseDownEvent);me.addListener("mouseup",mouseUpEvent);domUtils.on(me.body,'dragstart',function(evt){mouseUpEvent.call(me,'dragstart',evt);});me.addOutputRule(function(root){utils.each(root.getNodesByTagName('div'),function(n){if(n.getAttr('id')=='ue_tableDragLine'){n.parentNode.removeChild(n);}});});var currentRowIndex=0;me.addListener("mousedown",function(){currentRowIndex=0;});me.addListener('tabkeydown',function(){var range=this.selection.getRange(),common=range.getCommonAncestor(true,true),table=domUtils.findParentByTagName(common,'table');if(table){if(domUtils.findParentByTagName(common,'caption',true)){var cell=domUtils.getElementsByTagName(table,'th td');if(cell&&cell.length){range.setStart(cell[0],0).setCursor(false,true);}}else{var cell=domUtils.findParentByTagName(common,['td','th'],true),ua=getUETable(cell);currentRowIndex=cell.rowSpan>1?currentRowIndex:ua.getCellInfo(cell).rowIndex;var nextCell=ua.getTabNextCell(cell,currentRowIndex);if(nextCell){if(isEmptyBlock(nextCell)){range.setStart(nextCell,0).setCursor(false,true);}else{range.selectNodeContents(nextCell).select();}}else{me.fireEvent('saveScene');me.__hasEnterExecCommand=true;this.execCommand('insertrownext');me.__hasEnterExecCommand=false;range=this.selection.getRange();range.setStart(table.rows[table.rows.length-1].cells[0],0).setCursor();me.fireEvent('saveScene');}}return true;}});browser.ie&&me.addListener('selectionchange',function(){toggleDraggableState(this,false,"",null);});me.addListener("keydown",function(type,evt){var me=this;var keyCode=evt.keyCode||evt.which;if(keyCode==8||keyCode==46){return;}var notCtrlKey=!evt.ctrlKey&&!evt.metaKey&&!evt.shiftKey&&!evt.altKey;notCtrlKey&&removeSelectedClass(domUtils.getElementsByTagName(me.body,"td"));var ut=getUETableBySelected(me);if(!ut)return;notCtrlKey&&ut.clearSelected();});me.addListener("beforegetcontent",function(){switchBorderColor(this,false);browser.ie&&utils.each(this.document.getElementsByTagName('caption'),function(ci){if(domUtils.isEmptyNode(ci)){ci.innerHTML='&nbsp;';}});});me.addListener("aftergetcontent",function(){switchBorderColor(this,true);});me.addListener("getAllHtml",function(){removeSelectedClass(me.document.getElementsByTagName("td"));});me.addListener("fullscreenchanged",function(type,fullscreen){if(!fullscreen){var ratio=this.body.offsetWidth/document.body.offsetWidth,tables=domUtils.getElementsByTagName(this.body,"table");utils.each(tables,function(table){if(table.offsetWidth<me.body.offsetWidth)return false;var tds=domUtils.getElementsByTagName(table,"td"),backWidths=[];utils.each(tds,function(td){backWidths.push(td.offsetWidth);});for(var i=0,td;td=tds[i];i++){td.setAttribute("width",Math.floor(backWidths[i]*ratio));}table.setAttribute("width",Math.floor(getTableWidth(me,needIEHack,getDefaultValue(me))));});}});var oldExecCommand=me.execCommand;me.execCommand=function(cmd,datatat){var me=this,args=arguments;cmd=cmd.toLowerCase();var ut=getUETableBySelected(me),tds,range=new dom.Range(me.document),cmdFun=me.commands[cmd]||UE.commands[cmd],result;if(!cmdFun)return;if(ut&&!commands[cmd]&&!cmdFun.notNeedUndo&&!me.__hasEnterExecCommand){me.__hasEnterExecCommand=true;me.fireEvent("beforeexeccommand",cmd);tds=ut.selectedTds;var lastState=-2,lastValue=-2,value,state;for(var i=0,td;td=tds[i];i++){if(isEmptyBlock(td)){range.setStart(td,0).setCursor(false,true);}else{range.selectNode(td).select(true);}state=me.queryCommandState(cmd);value=me.queryCommandValue(cmd);if(state!=-1){if(lastState!==state||lastValue!==value){me._ignoreContentChange=true;result=oldExecCommand.apply(me,arguments);me._ignoreContentChange=false;}lastState=me.queryCommandState(cmd);lastValue=me.queryCommandValue(cmd);if(domUtils.isEmptyBlock(td)){domUtils.fillNode(me.document,td);}}}range.setStart(tds[0],0).shrinkBoundary(true).setCursor(false,true);me.fireEvent('contentchange');me.fireEvent("afterexeccommand",cmd);me.__hasEnterExecCommand=false;me._selectionChange();}else{result=oldExecCommand.apply(me,arguments);}return result;};});function removeStyleSize(obj,replaceToProperty){removeStyle(obj,"width",true);removeStyle(obj,"height",true);}function removeStyle(obj,styleName,replaceToProperty){if(obj.style[styleName]){replaceToProperty&&obj.setAttribute(styleName,parseInt(obj.style[styleName],10));obj.style[styleName]="";}}function getParentTdOrTh(ele){if(ele.tagName=="TD"||ele.tagName=="TH")return ele;var td;if(td=domUtils.findParentByTagName(ele,"td",true)||domUtils.findParentByTagName(ele,"th",true))return td;return null;}function isEmptyBlock(node){var reg=new RegExp(domUtils.fillChar,'g');if(node[browser.ie?'innerText':'textContent'].replace(/^\s*$/,'').replace(reg,'').length>0){return 0;}for(var n in dtd.$isNotEmpty){if(node.getElementsByTagName(n).length){return 0;}}return 1;}function mouseCoords(evt){if(evt.pageX||evt.pageY){return{x:evt.pageX,y:evt.pageY};}return{x:evt.clientX+me.document.body.scrollLeft-me.document.body.clientLeft,y:evt.clientY+me.document.body.scrollTop-me.document.body.clientTop};}function mouseMoveEvent(evt){if(isEditorDisabled()){return;}try{var target=getParentTdOrTh(evt.target||evt.srcElement),pos;if(isInResizeBuffer){me.body.style.webkitUserSelect='none';if(Math.abs(userActionStatus.x-evt.clientX)>offsetOfTableCell||Math.abs(userActionStatus.y-evt.clientY)>offsetOfTableCell){clearTableDragTimer();isInResizeBuffer=false;singleClickState=0;tableBorderDrag(evt);}}
if(onDrag&&dragTd){singleClickState=0;me.body.style.webkitUserSelect='none';me.selection.getNative()[browser.ie9below?'empty':'removeAllRanges']();pos=mouseCoords(evt);toggleDraggableState(me,true,onDrag,pos,target);if(onDrag=="h"){dragLine.style.left=getPermissionX(dragTd,evt)+"px";}else if(onDrag=="v"){dragLine.style.top=getPermissionY(dragTd,evt)+"px";}return;}
if(target){if(me.fireEvent('excludetable',target)===true)return;pos=mouseCoords(evt);var state=getRelation(target,pos),table=domUtils.findParentByTagName(target,"table",true);if(inTableSide(table,target,evt,true)){if(me.fireEvent("excludetable",table)===true)return;me.body.style.cursor="url("+me.options.cursorpath+"h.png),pointer";}else if(inTableSide(table,target,evt)){if(me.fireEvent("excludetable",table)===true)return;me.body.style.cursor="url("+me.options.cursorpath+"v.png),pointer";}else{me.body.style.cursor="text";var curCell=target;if(/\d/.test(state)){state=state.replace(/\d/,'');target=getUETable(target).getPreviewCell(target,state=="v");}
toggleDraggableState(me,target?!!state:false,target?state:'',pos,target);}}else{toggleDragButton(false,table,me);}}catch(e){showError(e);}}var dragButtonTimer;function toggleDragButton(show,table,editor){if(!show){if(dragOver)return;dragButtonTimer=setTimeout(function(){!dragOver&&dragButton&&dragButton.parentNode&&dragButton.parentNode.removeChild(dragButton);},2000);}else{createDragButton(table,editor);}}function createDragButton(table,editor){var pos=domUtils.getXY(table),doc=table.ownerDocument;if(dragButton&&dragButton.parentNode)return dragButton;dragButton=doc.createElement("div");dragButton.contentEditable=false;dragButton.innerHTML="";dragButton.style.cssText="width:15px;height:15px;background-image:url("+editor.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(pos.y-15)+"px;left:"+pos.x+"px;";domUtils.unSelectable(dragButton);dragButton.onmouseover=function(evt){dragOver=true;};dragButton.onmouseout=function(evt){dragOver=false;};domUtils.on(dragButton,'click',function(type,evt){doClick(evt,this);});domUtils.on(dragButton,'dblclick',function(type,evt){doDblClick(evt);});domUtils.on(dragButton,'dragstart',function(type,evt){domUtils.preventDefault(evt);});var timer;function doClick(evt,button){clearTimeout(timer);timer=setTimeout(function(){editor.fireEvent("tableClicked",table,button);},300);}function doDblClick(evt){clearTimeout(timer);var ut=getUETable(table),start=table.rows[0].cells[0],end=ut.getLastCell(),range=ut.getCellsRange(start,end);editor.selection.getRange().setStart(start,0).setCursor(false,true);ut.setSelected(range);}doc.body.appendChild(dragButton);}
function inTableSide(table,cell,evt,top){var pos=mouseCoords(evt),state=getRelation(cell,pos);if(top){var caption=table.getElementsByTagName("caption")[0],capHeight=caption?caption.offsetHeight:0;return state=="v1"&&pos.y-domUtils.getXY(table).y-capHeight<8;}else{return state=="h1"&&pos.x-domUtils.getXY(table).x<8;}}function getPermissionX(dragTd,evt){var ut=getUETable(dragTd);if(ut){var preTd=ut.getSameEndPosCells(dragTd,"x")[0],nextTd=ut.getSameStartPosXCells(dragTd)[0],mouseX=mouseCoords(evt).x,left=(preTd?domUtils.getXY(preTd).x:domUtils.getXY(ut.table).x)+20,right=nextTd?domUtils.getXY(nextTd).x+nextTd.offsetWidth-20:me.body.offsetWidth+5||parseInt(domUtils.getComputedStyle(me.body,"width"),10);left+=cellMinWidth;right-=cellMinWidth;return mouseX<left?left:mouseX>right?right:mouseX;}}function getPermissionY(dragTd,evt){try{var top=domUtils.getXY(dragTd).y,mousePosY=mouseCoords(evt).y;return mousePosY<top?top:mousePosY;}catch(e){showError(e);}}function toggleDraggableState(editor,draggable,dir,mousePos,cell){try{editor.body.style.cursor=dir=="h"?"col-resize":dir=="v"?"row-resize":"text";if(browser.ie){if(dir&&!mousedown&&!getUETableBySelected(editor)){getDragLine(editor,editor.document);showDragLineAt(dir,cell);}else{hideDragLine(editor);}}onBorder=draggable;}catch(e){showError(e);}}function getResizeLineByUETable(){var lineId='_UETableResizeLine',line=this.document.getElementById(lineId);if(!line){line=this.document.createElement("div");line.id=lineId;line.contnetEditable=false;line.setAttribute("unselectable","on");var styles={width:2*cellBorderWidth+1+'px',position:'absolute','z-index':100000,cursor:'col-resize',background:'red',display:'none'};line.onmouseout=function(){this.style.display='none';};utils.extend(line.style,styles);this.document.body.appendChild(line);}return line;}function updateResizeLine(cell,uetable){var line=getResizeLineByUETable.call(this),table=uetable.table,styles={top:domUtils.getXY(table).y+'px',left:domUtils.getXY(cell).x+cell.offsetWidth-cellBorderWidth+'px',display:'block',height:table.offsetHeight+'px'};utils.extend(line.style,styles);}function showResizeLine(cell){var uetable=getUETable(cell);updateResizeLine.call(this,cell,uetable);}function getRelation(ele,mousePos){var elePos=domUtils.getXY(ele);if(!elePos){return'';}if(elePos.x+ele.offsetWidth-mousePos.x<cellBorderWidth){return"h";}if(mousePos.x-elePos.x<cellBorderWidth){return'h1';}if(elePos.y+ele.offsetHeight-mousePos.y<cellBorderWidth){return"v";}if(mousePos.y-elePos.y<cellBorderWidth){return'v1';}return'';}function mouseDownEvent(type,evt){if(isEditorDisabled()){return;}userActionStatus={x:evt.clientX,y:evt.clientY};if(evt.button==2){var ut=getUETableBySelected(me),flag=false;if(ut){var td=getTargetTd(me,evt);utils.each(ut.selectedTds,function(ti){if(ti===td){flag=true;}});if(!flag){removeSelectedClass(domUtils.getElementsByTagName(me.body,"th td"));ut.clearSelected();}else{td=ut.selectedTds[0];setTimeout(function(){me.selection.getRange().setStart(td,0).setCursor(false,true);},0);}}}else{tableClickHander(evt);}}
function clearTableTimer(){tabTimer&&clearTimeout(tabTimer);tabTimer=null;}
function tableDbclickHandler(evt){singleClickState=0;evt=evt||me.window.event;var target=getParentTdOrTh(evt.target||evt.srcElement);if(target){var h;if(h=getRelation(target,mouseCoords(evt))){hideDragLine(me);if(h=='h1'){h='h';if(inTableSide(domUtils.findParentByTagName(target,"table"),target,evt)){me.execCommand('adaptbywindow');}else{target=getUETable(target).getPreviewCell(target);if(target){var rng=me.selection.getRange();rng.selectNodeContents(target).setCursor(true,true);}}}if(h=='h'){var ut=getUETable(target),table=ut.table,cells=getCellsByMoveBorder(target,table,true);cells=extractArray(cells,'left');ut.width=ut.offsetWidth;var oldWidth=[],newWidth=[];utils.each(cells,function(cell){oldWidth.push(cell.offsetWidth);});utils.each(cells,function(cell){cell.removeAttribute("width");});window.setTimeout(function(){var changeable=true;utils.each(cells,function(cell,index){var width=cell.offsetWidth;if(width>oldWidth[index]){changeable=false;return false;}newWidth.push(width);});var change=changeable?newWidth:oldWidth;utils.each(cells,function(cell,index){cell.width=change[index]-getTabcellSpace();});},0);}}}}function tableClickHander(evt){removeSelectedClass(domUtils.getElementsByTagName(me.body,"td th"));utils.each(me.document.getElementsByTagName('table'),function(t){t.ueTable=null;});startTd=getTargetTd(me,evt);if(!startTd)return;var table=domUtils.findParentByTagName(startTd,"table",true);ut=getUETable(table);ut&&ut.clearSelected();if(!onBorder){me.document.body.style.webkitUserSelect='';mousedown=true;me.addListener('mouseover',mouseOverEvent);}else{borderActionHandler(evt);}}
function borderActionHandler(evt){if(browser.ie){evt=reconstruct(evt);}clearTableDragTimer();isInResizeBuffer=true;tableDragTimer=setTimeout(function(){tableBorderDrag(evt);},dblclickTime);}function extractArray(originArr,key){var result=[],tmp=null;for(var i=0,len=originArr.length;i<len;i++){tmp=originArr[i][key];if(tmp){result.push(tmp);}}return result;}function clearTableDragTimer(){tableDragTimer&&clearTimeout(tableDragTimer);tableDragTimer=null;}function reconstruct(obj){var attrs=['pageX','pageY','clientX','clientY','srcElement','target'],newObj={};if(obj){for(var i=0,key,val;key=attrs[i];i++){val=obj[key];val&&(newObj[key]=val);}}return newObj;}
function tableBorderDrag(evt){isInResizeBuffer=false;startTd=evt.target||evt.srcElement;if(!startTd)return;var state=getRelation(startTd,mouseCoords(evt));if(/\d/.test(state)){state=state.replace(/\d/,'');startTd=getUETable(startTd).getPreviewCell(startTd,state=='v');}hideDragLine(me);getDragLine(me,me.document);me.fireEvent('saveScene');showDragLineAt(state,startTd);mousedown=true;onDrag=state;dragTd=startTd;}function mouseUpEvent(type,evt){if(isEditorDisabled()){return;}clearTableDragTimer();isInResizeBuffer=false;if(onBorder){singleClickState=++singleClickState%3;userActionStatus={x:evt.clientX,y:evt.clientY};tableResizeTimer=setTimeout(function(){singleClickState>0&&singleClickState--;},dblclickTime);if(singleClickState===2){singleClickState=0;tableDbclickHandler(evt);return;}}if(evt.button==2)return;var me=this;var range=me.selection.getRange(),start=domUtils.findParentByTagName(range.startContainer,'table',true),end=domUtils.findParentByTagName(range.endContainer,'table',true);if(start||end){if(start===end){start=domUtils.findParentByTagName(range.startContainer,['td','th','caption'],true);end=domUtils.findParentByTagName(range.endContainer,['td','th','caption'],true);if(start!==end){me.selection.clearRange();}}else{me.selection.clearRange();}}mousedown=false;me.document.body.style.webkitUserSelect='';if(onDrag&&dragTd){me.selection.getNative()[browser.ie9below?'empty':'removeAllRanges']();singleClickState=0;dragLine=me.document.getElementById('ue_tableDragLine');if(dragLine){var dragTdPos=domUtils.getXY(dragTd),dragLinePos=domUtils.getXY(dragLine);switch(onDrag){case"h":changeColWidth(dragTd,dragLinePos.x-dragTdPos.x);break;case"v":changeRowHeight(dragTd,dragLinePos.y-dragTdPos.y-dragTd.offsetHeight);break;default:}onDrag="";dragTd=null;hideDragLine(me);me.fireEvent('saveScene');return;}}
if(!startTd){var target=domUtils.findParentByTagName(evt.target||evt.srcElement,"td",true);if(!target)target=domUtils.findParentByTagName(evt.target||evt.srcElement,"th",true);if(target&&(target.tagName=="TD"||target.tagName=="TH")){if(me.fireEvent("excludetable",target)===true)return;range=new dom.Range(me.document);range.setStart(target,0).setCursor(false,true);}}else{var ut=getUETable(startTd),cell=ut?ut.selectedTds[0]:null;if(cell){range=new dom.Range(me.document);if(domUtils.isEmptyBlock(cell)){range.setStart(cell,0).setCursor(false,true);}else{range.selectNodeContents(cell).shrinkBoundary().setCursor(false,true);}}else{range=me.selection.getRange().shrinkBoundary();if(!range.collapsed){var start=domUtils.findParentByTagName(range.startContainer,['td','th'],true),end=domUtils.findParentByTagName(range.endContainer,['td','th'],true);if(start&&!end||!start&&end||start&&end&&start!==end){range.setCursor(false,true);}}}startTd=null;me.removeListener('mouseover',mouseOverEvent);}me._selectionChange(250,evt);}function mouseOverEvent(type,evt){if(isEditorDisabled()){return;}var me=this,tar=evt.target||evt.srcElement;currentTd=domUtils.findParentByTagName(tar,"td",true)||domUtils.findParentByTagName(tar,"th",true);if(startTd&&currentTd&&(startTd.tagName=="TD"&&currentTd.tagName=="TD"||startTd.tagName=="TH"&&currentTd.tagName=="TH")&&domUtils.findParentByTagName(startTd,'table')==domUtils.findParentByTagName(currentTd,'table')){var ut=getUETable(currentTd);if(startTd!=currentTd){me.document.body.style.webkitUserSelect='none';me.selection.getNative()[browser.ie9below?'empty':'removeAllRanges']();var range=ut.getCellsRange(startTd,currentTd);ut.setSelected(range);}else{me.document.body.style.webkitUserSelect='';ut.clearSelected();}}evt.preventDefault?evt.preventDefault():evt.returnValue=false;}function setCellHeight(cell,height,backHeight){var lineHight=parseInt(domUtils.getComputedStyle(cell,"line-height"),10),tmpHeight=backHeight+height;height=tmpHeight<lineHight?lineHight:tmpHeight;if(cell.style.height)cell.style.height="";cell.rowSpan==1?cell.setAttribute("height",height):cell.removeAttribute&&cell.removeAttribute("height");}function getWidth(cell){if(!cell)return 0;return parseInt(domUtils.getComputedStyle(cell,"width"),10);}function changeColWidth(cell,changeValue){var ut=getUETable(cell);if(ut){var table=ut.table,cells=getCellsByMoveBorder(cell,table);table.style.width="";table.removeAttribute("width");changeValue=correctChangeValue(changeValue,cell,cells);if(cell.nextSibling){var i=0;utils.each(cells,function(cellGroup){cellGroup.left.width=+cellGroup.left.width+changeValue;cellGroup.right&&(cellGroup.right.width=+cellGroup.right.width-changeValue);});}else{utils.each(cells,function(cellGroup){cellGroup.left.width-=-changeValue;});}}}function isEditorDisabled(){return me.body.contentEditable==="false";}function changeRowHeight(td,changeValue){if(Math.abs(changeValue)<10)return;var ut=getUETable(td);if(ut){var cells=ut.getSameEndPosCells(td,"y"),backHeight=cells[0]?cells[0].offsetHeight:0;for(var i=0,cell;cell=cells[i++];){setCellHeight(cell,changeValue,backHeight);}}}function getCellsByMoveBorder(cell,table,isContainMergeCell){if(!table){table=domUtils.findParentByTagName(cell,'table');}if(!table){return null;}
var index=domUtils.getNodeIndex(cell),temp=cell,rows=table.rows,colIndex=0;while(temp){if(temp.nodeType===1){colIndex+=temp.colSpan||1;}temp=temp.previousSibling;}temp=null;var borderCells=[];utils.each(rows,function(tabRow){var cells=tabRow.cells,currIndex=0;utils.each(cells,function(tabCell){currIndex+=tabCell.colSpan||1;if(currIndex===colIndex){borderCells.push({left:tabCell,right:tabCell.nextSibling||null});return false;}else if(currIndex>colIndex){if(isContainMergeCell){borderCells.push({left:tabCell});}return false;}});});return borderCells;}function getMinWidthByTableCells(cells){var minWidth=Number.MAX_VALUE;for(var i=0,curCell;curCell=cells[i];i++){minWidth=Math.min(minWidth,curCell.width||getTableCellWidth(curCell));}return minWidth;}function correctChangeValue(changeValue,relatedCell,cells){changeValue-=getTabcellSpace();if(changeValue<0){return 0;}changeValue-=getTableCellWidth(relatedCell);var direction=changeValue<0?'left':'right';changeValue=Math.abs(changeValue);utils.each(cells,function(cellGroup){var curCell=cellGroup[direction];if(curCell){changeValue=Math.min(changeValue,getTableCellWidth(curCell)-cellMinWidth);}});changeValue=changeValue<0?0:changeValue;return direction==='left'?-changeValue:changeValue;}function getTableCellWidth(cell){var width=0,offset=0,width=cell.offsetWidth-getTabcellSpace();if(!cell.nextSibling){width-=getTableCellOffset(cell);}width=width<0?0:width;try{cell.width=width;}catch(e){}return width;}function getTableCellOffset(cell){tab=domUtils.findParentByTagName(cell,"table",false);if(tab.offsetVal===undefined){var prev=cell.previousSibling;if(prev){tab.offsetVal=cell.offsetWidth-prev.offsetWidth===UT.borderWidth?UT.borderWidth:0;}else{tab.offsetVal=0;}}return tab.offsetVal;}function getTabcellSpace(){if(UT.tabcellSpace===undefined){var cell=null,tab=me.document.createElement("table"),tbody=me.document.createElement("tbody"),trow=me.document.createElement("tr"),tabcell=me.document.createElement("td"),mirror=null;tabcell.style.cssText='border: 0;';tabcell.width=1;trow.appendChild(tabcell);trow.appendChild(mirror=tabcell.cloneNode(false));tbody.appendChild(trow);tab.appendChild(tbody);tab.style.cssText="visibility: hidden;";me.body.appendChild(tab);UT.paddingSpace=tabcell.offsetWidth-1;var tmpTabWidth=tab.offsetWidth;tabcell.style.cssText='';mirror.style.cssText='';UT.borderWidth=(tab.offsetWidth-tmpTabWidth)/3;UT.tabcellSpace=UT.paddingSpace+UT.borderWidth;me.body.removeChild(tab);}getTabcellSpace=function getTabcellSpace(){return UT.tabcellSpace;};return UT.tabcellSpace;}function getDragLine(editor,doc){if(mousedown)return;dragLine=editor.document.createElement("div");domUtils.setAttributes(dragLine,{id:"ue_tableDragLine",unselectable:'on',contenteditable:false,'onresizestart':'return false','ondragstart':'return false','onselectstart':'return false',style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});editor.body.appendChild(dragLine);}function hideDragLine(editor){if(mousedown)return;var line;while(line=editor.document.getElementById('ue_tableDragLine')){domUtils.remove(line);}}function showDragLineAt(state,cell){if(!cell)return;var table=domUtils.findParentByTagName(cell,"table"),caption=table.getElementsByTagName('caption'),width=table.offsetWidth,height=table.offsetHeight-(caption.length>0?caption[0].offsetHeight:0),tablePos=domUtils.getXY(table),cellPos=domUtils.getXY(cell),css;switch(state){case"h":css='height:'+height+'px;top:'+(tablePos.y+(caption.length>0?caption[0].offsetHeight:0))+'px;left:'+(cellPos.x+cell.offsetWidth);dragLine.style.cssText=css+'px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)';break;case"v":css='width:'+width+'px;left:'+tablePos.x+'px;top:'+(cellPos.y+cell.offsetHeight);dragLine.style.cssText=css+'px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)';break;default:}}function switchBorderColor(editor,flag){var tableArr=domUtils.getElementsByTagName(editor.body,"table"),color;for(var i=0,node;node=tableArr[i++];){var td=domUtils.getElementsByTagName(node,"td");if(td[0]){if(flag){color=td[0].style.borderColor.replace(/\s/g,"");if(/(#ffffff)|(rgb\(255,255,255\))/ig.test(color))domUtils.addClass(node,"noBorderTable");}else{domUtils.removeClasses(node,"noBorderTable");}}}}function getTableWidth(editor,needIEHack,defaultValue){var body=editor.body;return body.offsetWidth-(needIEHack?parseInt(domUtils.getComputedStyle(body,'margin-left'),10)*2:0)-defaultValue.tableBorder*2-(editor.options.offsetWidth||0);}function getTargetTd(editor,evt){var target=domUtils.findParentByTagName(evt.target||evt.srcElement,["td","th"],true),dir=null;if(!target){return null;}dir=getRelation(target,mouseCoords(evt));if(!target){return null;}if(dir==='h1'&&target.previousSibling){var position=domUtils.getXY(target),cellWidth=target.offsetWidth;if(Math.abs(position.x+cellWidth-evt.clientX)>cellWidth/3){target=target.previousSibling;}}else if(dir==='v1'&&target.parentNode.previousSibling){var position=domUtils.getXY(target),cellHeight=target.offsetHeight;if(Math.abs(position.y+cellHeight-evt.clientY)>cellHeight/3){target=target.parentNode.previousSibling.firstChild;}}
return target&&!(editor.fireEvent("excludetable",target)===true)?target:null;}};UE.UETable.prototype.sortTable=function(sortByCellIndex,compareFn){var table=this.table,rows=table.rows,trArray=[],flag=rows[0].cells[0].tagName==="TH",lastRowIndex=0;if(this.selectedTds.length){var range=this.cellsRange,len=range.endRowIndex+1;for(var i=range.beginRowIndex;i<len;i++){trArray[i]=rows[i];}trArray.splice(0,range.beginRowIndex);lastRowIndex=range.endRowIndex+1===this.rowsNum?0:range.endRowIndex+1;}else{for(var i=0,len=rows.length;i<len;i++){trArray[i]=rows[i];}}var Fn={'reversecurrent':function reversecurrent(td1,td2){return 1;},'orderbyasc':function orderbyasc(td1,td2){var value1=td1.innerText||td1.textContent,value2=td2.innerText||td2.textContent;return value1.localeCompare(value2);},'reversebyasc':function reversebyasc(td1,td2){var value1=td1.innerHTML,value2=td2.innerHTML;return value2.localeCompare(value1);},'orderbynum':function orderbynum(td1,td2){var value1=td1[browser.ie?'innerText':'textContent'].match(/\d+/),value2=td2[browser.ie?'innerText':'textContent'].match(/\d+/);if(value1)value1=+value1[0];if(value2)value2=+value2[0];return(value1||0)-(value2||0);},'reversebynum':function reversebynum(td1,td2){var value1=td1[browser.ie?'innerText':'textContent'].match(/\d+/),value2=td2[browser.ie?'innerText':'textContent'].match(/\d+/);if(value1)value1=+value1[0];if(value2)value2=+value2[0];return(value2||0)-(value1||0);}};table.setAttribute('data-sort-type',compareFn&&typeof compareFn==="string"&&Fn[compareFn]?compareFn:'');flag&&trArray.splice(0,1);trArray=utils.sort(trArray,function(tr1,tr2){var result;if(compareFn&&typeof compareFn==="function"){result=compareFn.call(this,tr1.cells[sortByCellIndex],tr2.cells[sortByCellIndex]);}else if(compareFn&&typeof compareFn==="number"){result=1;}else if(compareFn&&typeof compareFn==="string"&&Fn[compareFn]){result=Fn[compareFn].call(this,tr1.cells[sortByCellIndex],tr2.cells[sortByCellIndex]);}else{result=Fn['orderbyasc'].call(this,tr1.cells[sortByCellIndex],tr2.cells[sortByCellIndex]);}return result;});var fragment=table.ownerDocument.createDocumentFragment();for(var j=0,len=trArray.length;j<len;j++){fragment.appendChild(trArray[j]);}var tbody=table.getElementsByTagName("tbody")[0];if(!lastRowIndex){tbody.appendChild(fragment);}else{tbody.insertBefore(fragment,rows[lastRowIndex-range.endRowIndex+range.beginRowIndex-1]);}};UE.plugins['tablesort']=function(){var me=this,UT=UE.UETable,getUETable=function getUETable(tdOrTable){return UT.getUETable(tdOrTable);},getTableItemsByRange=function getTableItemsByRange(editor){return UT.getTableItemsByRange(editor);};me.ready(function(){utils.cssRule('tablesort','table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;'+'   background-image:url('+me.options.themePath+me.options.theme+'/images/sortable.png);}',me.document);me.addListener("afterexeccommand",function(type,cmd){if(cmd=='mergeright'||cmd=='mergedown'||cmd=='mergecells'){this.execCommand('disablesort');}});});UE.commands['sorttable']={queryCommandState:function queryCommandState(){var me=this,tableItems=getTableItemsByRange(me);if(!tableItems.cell)return-1;var table=tableItems.table,cells=table.getElementsByTagName("td");for(var i=0,cell;cell=cells[i++];){if(cell.rowSpan!=1||cell.colSpan!=1)return-1;}return 0;},execCommand:function execCommand(cmd,fn){var me=this,range=me.selection.getRange(),bk=range.createBookmark(true),tableItems=getTableItemsByRange(me),cell=tableItems.cell,ut=getUETable(tableItems.table),cellInfo=ut.getCellInfo(cell);ut.sortTable(cellInfo.cellIndex,fn);range.moveToBookmark(bk);try{range.select();}catch(e){}}};UE.commands["enablesort"]=UE.commands["disablesort"]={queryCommandState:function queryCommandState(cmd){var table=getTableItemsByRange(this).table;if(table&&cmd=='enablesort'){var cells=domUtils.getElementsByTagName(table,'th td');for(var i=0;i<cells.length;i++){if(cells[i].getAttribute('colspan')>1||cells[i].getAttribute('rowspan')>1)return-1;}}return!table?-1:cmd=='enablesort'^table.getAttribute('data-sort')!='sortEnabled'?-1:0;},execCommand:function execCommand(cmd){var table=getTableItemsByRange(this).table;table.setAttribute("data-sort",cmd=="enablesort"?"sortEnabled":"sortDisabled");cmd=="enablesort"?domUtils.addClass(table,"sortEnabled"):domUtils.removeClasses(table,"sortEnabled");}};};UE.plugins['contextmenu']=function(){var me=this;me.setOpt('enableContextMenu',true);if(me.getOpt('enableContextMenu')===false){return;}var lang=me.getLang("contextMenu"),menu,items=me.options.contextMenu||[{label:lang['selectall'],cmdName:'selectall'},{label:lang.cleardoc,cmdName:'cleardoc',exec:function exec(){if(confirm(lang.confirmclear)){this.execCommand('cleardoc');}}},'-',{label:lang.unlink,cmdName:'unlink'},'-',{group:lang.paragraph,icon:'justifyjustify',subMenu:[{label:lang.justifyleft,cmdName:'justify',value:'left'},{label:lang.justifyright,cmdName:'justify',value:'right'},{label:lang.justifycenter,cmdName:'justify',value:'center'},{label:lang.justifyjustify,cmdName:'justify',value:'justify'}]},'-',{group:lang.table,icon:'table',subMenu:[{label:lang.inserttable,cmdName:'inserttable'},{label:lang.deletetable,cmdName:'deletetable'},'-',{label:lang.deleterow,cmdName:'deleterow'},{label:lang.deletecol,cmdName:'deletecol'},{label:lang.insertcol,cmdName:'insertcol'},{label:lang.insertcolnext,cmdName:'insertcolnext'},{label:lang.insertrow,cmdName:'insertrow'},{label:lang.insertrownext,cmdName:'insertrownext'},'-',{label:lang.insertcaption,cmdName:'insertcaption'},{label:lang.deletecaption,cmdName:'deletecaption'},{label:lang.inserttitle,cmdName:'inserttitle'},{label:lang.deletetitle,cmdName:'deletetitle'},{label:lang.inserttitlecol,cmdName:'inserttitlecol'},{label:lang.deletetitlecol,cmdName:'deletetitlecol'},'-',{label:lang.mergecells,cmdName:'mergecells'},{label:lang.mergeright,cmdName:'mergeright'},{label:lang.mergedown,cmdName:'mergedown'},'-',{label:lang.splittorows,cmdName:'splittorows'},{label:lang.splittocols,cmdName:'splittocols'},{label:lang.splittocells,cmdName:'splittocells'},'-',{label:lang.averageDiseRow,cmdName:'averagedistributerow'},{label:lang.averageDisCol,cmdName:'averagedistributecol'},'-',{label:lang.edittd,cmdName:'edittd',exec:function exec(){if(UE.ui['edittd']){new UE.ui['edittd'](this);}this.getDialog('edittd').open();}},{label:lang.edittable,cmdName:'edittable',exec:function exec(){if(UE.ui['edittable']){new UE.ui['edittable'](this);}this.getDialog('edittable').open();}},{label:lang.setbordervisible,cmdName:'setbordervisible'}]},{group:lang.tablesort,icon:'tablesort',subMenu:[{label:lang.enablesort,cmdName:'enablesort'},{label:lang.disablesort,cmdName:'disablesort'},'-',{label:lang.reversecurrent,cmdName:'sorttable',value:'reversecurrent'},{label:lang.orderbyasc,cmdName:'sorttable',value:'orderbyasc'},{label:lang.reversebyasc,cmdName:'sorttable',value:'reversebyasc'},{label:lang.orderbynum,cmdName:'sorttable',value:'orderbynum'},{label:lang.reversebynum,cmdName:'sorttable',value:'reversebynum'}]},{group:lang.borderbk,icon:'borderBack',subMenu:[{label:lang.setcolor,cmdName:"interlacetable",exec:function exec(){this.execCommand("interlacetable");}},{label:lang.unsetcolor,cmdName:"uninterlacetable",exec:function exec(){this.execCommand("uninterlacetable");}},{label:lang.setbackground,cmdName:"settablebackground",exec:function exec(){this.execCommand("settablebackground",{repeat:true,colorList:["#bbb","#ccc"]});}},{label:lang.unsetbackground,cmdName:"cleartablebackground",exec:function exec(){this.execCommand("cleartablebackground");}},{label:lang.redandblue,cmdName:"settablebackground",exec:function exec(){this.execCommand("settablebackground",{repeat:true,colorList:["red","blue"]});}},{label:lang.threecolorgradient,cmdName:"settablebackground",exec:function exec(){this.execCommand("settablebackground",{repeat:true,colorList:["#aaa","#bbb","#ccc"]});}}]},{group:lang.aligntd,icon:'aligntd',subMenu:[{cmdName:'cellalignment',value:{align:'left',vAlign:'top'}},{cmdName:'cellalignment',value:{align:'center',vAlign:'top'}},{cmdName:'cellalignment',value:{align:'right',vAlign:'top'}},{cmdName:'cellalignment',value:{align:'left',vAlign:'middle'}},{cmdName:'cellalignment',value:{align:'center',vAlign:'middle'}},{cmdName:'cellalignment',value:{align:'right',vAlign:'middle'}},{cmdName:'cellalignment',value:{align:'left',vAlign:'bottom'}},{cmdName:'cellalignment',value:{align:'center',vAlign:'bottom'}},{cmdName:'cellalignment',value:{align:'right',vAlign:'bottom'}}]},{group:lang.aligntable,icon:'aligntable',subMenu:[{cmdName:'tablealignment',className:'left',label:lang.tableleft,value:"left"},{cmdName:'tablealignment',className:'center',label:lang.tablecenter,value:"center"},{cmdName:'tablealignment',className:'right',label:lang.tableright,value:"right"}]},'-',{label:lang.insertparagraphbefore,cmdName:'insertparagraph',value:true},{label:lang.insertparagraphafter,cmdName:'insertparagraph'},{label:lang['copy'],cmdName:'copy'},{label:lang['paste'],cmdName:'paste'}];if(!items.length){return;}var uiUtils=UE.ui.uiUtils;me.addListener('contextmenu',function(type,evt){var offset=uiUtils.getViewportOffsetByEvent(evt);me.fireEvent('beforeselectionchange');if(menu){menu.destroy();}for(var i=0,ti,contextItems=[];ti=items[i];i++){var last;(function(item){if(item=='-'){if((last=contextItems[contextItems.length-1])&&last!=='-'){contextItems.push('-');}}else if(item.hasOwnProperty("group")){for(var j=0,cj,subMenu=[];cj=item.subMenu[j];j++){(function(subItem){if(subItem=='-'){if((last=subMenu[subMenu.length-1])&&last!=='-'){subMenu.push('-');}else{subMenu.splice(subMenu.length-1);}}else{if((me.commands[subItem.cmdName]||UE.commands[subItem.cmdName]||subItem.query)&&(subItem.query?subItem.query():me.queryCommandState(subItem.cmdName))>-1){subMenu.push({'label':subItem.label||me.getLang("contextMenu."+subItem.cmdName+(subItem.value||''))||"",'className':'edui-for-'+subItem.cmdName+(subItem.className?' edui-for-'+subItem.cmdName+'-'+subItem.className:''),onclick:subItem.exec?function(){subItem.exec.call(me);}:function(){me.execCommand(subItem.cmdName,subItem.value);}});}}})(cj);}if(subMenu.length){var getLabel=function getLabel(){switch(item.icon){case"table":return me.getLang("contextMenu.table");case"justifyjustify":return me.getLang("contextMenu.paragraph");case"aligntd":return me.getLang("contextMenu.aligntd");case"aligntable":return me.getLang("contextMenu.aligntable");case"tablesort":return lang.tablesort;case"borderBack":return lang.borderbk;default:return'';}};contextItems.push({'label':getLabel(),className:'edui-for-'+item.icon,'subMenu':{items:subMenu,editor:me}});}}else{if((me.commands[item.cmdName]||UE.commands[item.cmdName]||item.query)&&(item.query?item.query.call(me):me.queryCommandState(item.cmdName))>-1){contextItems.push({'label':item.label||me.getLang("contextMenu."+item.cmdName),className:'edui-for-'+(item.icon?item.icon:item.cmdName+(item.value||'')),onclick:item.exec?function(){item.exec.call(me);}:function(){me.execCommand(item.cmdName,item.value);}});}}})(ti);}if(contextItems[contextItems.length-1]=='-'){contextItems.pop();}menu=new UE.ui.Menu({items:contextItems,className:"edui-contextmenu",editor:me});menu.render();menu.showAt(offset);me.fireEvent("aftershowcontextmenu",menu);domUtils.preventDefault(evt);if(browser.ie){var ieRange;try{ieRange=me.selection.getNative().createRange();}catch(e){return;}if(ieRange.item){var range=new dom.Range(me.document);range.selectNode(ieRange.item(0)).select(true,true);}}});me.addListener('aftershowcontextmenu',function(type,menu){if(me.zeroclipboard){var items=menu.items;for(var key in items){if(items[key].className=='edui-for-copy'){me.zeroclipboard.clip(items[key].getDom());}}}});};UE.plugins['shortcutmenu']=function(){var me=this,menu,items=me.options.shortcutMenu||[];if(!items.length){return;}me.addListener('contextmenu mouseup',function(type,e){var me=this,customEvt={type:type,target:e.target||e.srcElement,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY};setTimeout(function(){var rng=me.selection.getRange();if(rng.collapsed===false||type=="contextmenu"){if(!menu){menu=new baidu.editor.ui.ShortCutMenu({editor:me,items:items,theme:me.options.theme,className:'edui-shortcutmenu'});menu.render();me.fireEvent("afterrendershortcutmenu",menu);}menu.show(customEvt,!!UE.plugins['contextmenu']);}});if(type=='contextmenu'){domUtils.preventDefault(e);if(browser.ie9below){var ieRange;try{ieRange=me.selection.getNative().createRange();}catch(e){return;}if(ieRange.item){var range=new dom.Range(me.document);range.selectNode(ieRange.item(0)).select(true,true);}}}});me.addListener('keydown',function(type){if(type=="keydown"){menu&&!menu.isHidden&&menu.hide();}});};UE.plugins['basestyle']=function(){var basestyles={'bold':['strong','b'],'italic':['em','i'],'subscript':['sub'],'superscript':['sup']},getObj=function getObj(editor,tagNames){return domUtils.filterNodeList(editor.selection.getStartElementPath(),tagNames);},me=this;me.addshortcutkey({"Bold":"ctrl+66","Italic":"ctrl+73","Underline":"ctrl+85"});me.addInputRule(function(root){utils.each(root.getNodesByTagName('b i'),function(node){switch(node.tagName){case'b':node.tagName='strong';break;case'i':node.tagName='em';}});});for(var style in basestyles){(function(cmd,tagNames){me.commands[cmd]={execCommand:function execCommand(cmdName){var range=me.selection.getRange(),obj=getObj(this,tagNames);if(range.collapsed){if(obj){var tmpText=me.document.createTextNode('');range.insertNode(tmpText).removeInlineStyle(tagNames);range.setStartBefore(tmpText);domUtils.remove(tmpText);}else{var tmpNode=range.document.createElement(tagNames[0]);if(cmdName=='superscript'||cmdName=='subscript'){tmpText=me.document.createTextNode('');range.insertNode(tmpText).removeInlineStyle(['sub','sup']).setStartBefore(tmpText).collapse(true);}range.insertNode(tmpNode).setStart(tmpNode,0);}range.collapse(true);}else{if(cmdName=='superscript'||cmdName=='subscript'){if(!obj||obj.tagName.toLowerCase()!=cmdName){range.removeInlineStyle(['sub','sup']);}}obj?range.removeInlineStyle(tagNames):range.applyInlineStyle(tagNames[0]);}range.select();},queryCommandState:function queryCommandState(){return getObj(this,tagNames)?1:0;}};})(style,basestyles[style]);}};UE.plugins['elementpath']=function(){var currentLevel,tagNames,me=this;me.setOpt('elementPathEnabled',true);if(!me.options.elementPathEnabled){return;}me.commands['elementpath']={execCommand:function execCommand(cmdName,level){var start=tagNames[level],range=me.selection.getRange();currentLevel=level*1;range.selectNode(start).select();},queryCommandValue:function queryCommandValue(){var parents=[].concat(this.selection.getStartElementPath()).reverse(),names=[];tagNames=parents;for(var i=0,ci;ci=parents[i];i++){if(ci.nodeType==3){continue;}var name=ci.tagName.toLowerCase();if(name=='img'&&ci.getAttribute('anchorname')){name='anchor';}names[i]=name;if(currentLevel==i){currentLevel=-1;break;}}return names;}};};UE.plugins['formatmatch']=function(){var me=this,list=[],img,flag=0;me.addListener('reset',function(){list=[];flag=0;});function addList(type,evt){if(browser.webkit){var target=evt.target.tagName=='IMG'?evt.target:null;}function addFormat(range){if(text){range.selectNode(text);}return range.applyInlineStyle(list[list.length-1].tagName,null,list);}me.undoManger&&me.undoManger.save();var range=me.selection.getRange(),imgT=target||range.getClosedNode();if(img&&imgT&&imgT.tagName=='IMG'){imgT.style.cssText+=';float:'+(img.style.cssFloat||img.style.styleFloat||'none')+';display:'+(img.style.display||'inline');img=null;}else{if(!img){var collapsed=range.collapsed;if(collapsed){var text=me.document.createTextNode('match');range.insertNode(text).select();}me.__hasEnterExecCommand=true;var removeFormatAttributes=me.options.removeFormatAttributes;me.options.removeFormatAttributes='';me.execCommand('removeformat');me.options.removeFormatAttributes=removeFormatAttributes;me.__hasEnterExecCommand=false;range=me.selection.getRange();if(list.length){addFormat(range);}if(text){range.setStartBefore(text).collapse(true);}range.select();text&&domUtils.remove(text);}}me.undoManger&&me.undoManger.save();me.removeListener('mouseup',addList);flag=0;}me.commands['formatmatch']={execCommand:function execCommand(cmdName){if(flag){flag=0;list=[];me.removeListener('mouseup',addList);return;}var range=me.selection.getRange();img=range.getClosedNode();if(!img||img.tagName!='IMG'){range.collapse(true).shrinkBoundary();var start=range.startContainer;list=domUtils.findParents(start,true,function(node){return!domUtils.isBlockElm(node)&&node.nodeType==1;});for(var i=0,ci;ci=list[i];i++){if(ci.tagName=='A'){list.splice(i,1);break;}}}me.addListener('mouseup',addList);flag=1;},queryCommandState:function queryCommandState(){return flag;},notNeedUndo:1};};UE.plugin.register('searchreplace',function(){var me=this;var _blockElm={'table':1,'tbody':1,'tr':1,'ol':1,'ul':1};function findTextInString(textContent,opt,currentIndex){var str=opt.searchStr;if(opt.dir==-1){textContent=textContent.split('').reverse().join('');str=str.split('').reverse().join('');currentIndex=textContent.length-currentIndex;}var reg=new RegExp(str,'g'+(opt.casesensitive?'':'i')),match;while(match=reg.exec(textContent)){if(match.index>=currentIndex){return opt.dir==-1?textContent.length-match.index-opt.searchStr.length:match.index;}}return-1;}function findTextBlockElm(node,currentIndex,opt){var textContent,index,methodName=opt.all||opt.dir==1?'getNextDomNode':'getPreDomNode';if(domUtils.isBody(node)){node=node.firstChild;}var first=1;while(node){textContent=node.nodeType==3?node.nodeValue:node[browser.ie?'innerText':'textContent'];index=findTextInString(textContent,opt,currentIndex);first=0;if(index!=-1){return{'node':node,'index':index};}node=domUtils[methodName](node);while(node&&_blockElm[node.nodeName.toLowerCase()]){node=domUtils[methodName](node,true);}if(node){currentIndex=opt.dir==-1?(node.nodeType==3?node.nodeValue:node[browser.ie?'innerText':'textContent']).length:0;}}}function findNTextInBlockElm(node,index,str){var currentIndex=0,currentNode=node.firstChild,currentNodeLength=0,result;while(currentNode){if(currentNode.nodeType==3){currentNodeLength=currentNode.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,'').length;currentIndex+=currentNodeLength;if(currentIndex>=index){return{'node':currentNode,'index':currentNodeLength-(currentIndex-index)};}}else if(!dtd.$empty[currentNode.tagName]){currentNodeLength=currentNode[browser.ie?'innerText':'textContent'].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,'').length;currentIndex+=currentNodeLength;if(currentIndex>=index){result=findNTextInBlockElm(currentNode,currentNodeLength-(currentIndex-index),str);if(result){return result;}}}currentNode=domUtils.getNextDomNode(currentNode);}}function searchReplace(me,opt){var rng=me.selection.getRange(),startBlockNode,searchStr=opt.searchStr,span=me.document.createElement('span');span.innerHTML='$$ueditor_searchreplace_key$$';rng.shrinkBoundary(true);if(!rng.collapsed){rng.select();var rngText=me.selection.getText();if(new RegExp('^'+opt.searchStr+'$',opt.casesensitive?'':'i').test(rngText)){if(opt.replaceStr!=undefined){replaceText(rng,opt.replaceStr);rng.select();return true;}else{rng.collapse(opt.dir==-1);}}}rng.insertNode(span);rng.enlargeToBlockElm(true);startBlockNode=rng.startContainer;var currentIndex=startBlockNode[browser.ie?'innerText':'textContent'].indexOf('$$ueditor_searchreplace_key$$');rng.setStartBefore(span);domUtils.remove(span);var result=findTextBlockElm(startBlockNode,currentIndex,opt);if(result){var rngStart=findNTextInBlockElm(result.node,result.index,searchStr);var rngEnd=findNTextInBlockElm(result.node,result.index+searchStr.length,searchStr);rng.setStart(rngStart.node,rngStart.index).setEnd(rngEnd.node,rngEnd.index);if(opt.replaceStr!==undefined){replaceText(rng,opt.replaceStr);}rng.select();return true;}else{rng.setCursor();}}function replaceText(rng,str){str=me.document.createTextNode(str);rng.deleteContents().insertNode(str);}return{commands:{'searchreplace':{execCommand:function execCommand(cmdName,opt){utils.extend(opt,{all:false,casesensitive:false,dir:1},true);var num=0;if(opt.all){var rng=me.selection.getRange(),first=me.body.firstChild;if(first&&first.nodeType==1){rng.setStart(first,0);rng.shrinkBoundary(true);}else if(first.nodeType==3){rng.setStartBefore(first);}rng.collapse(true).select(true);if(opt.replaceStr!==undefined){me.fireEvent('saveScene');}while(searchReplace(this,opt)){num++;}if(num){me.fireEvent('saveScene');}}else{if(opt.replaceStr!==undefined){me.fireEvent('saveScene');}if(searchReplace(this,opt)){num++;}if(num){me.fireEvent('saveScene');}}return num;},notNeedUndo:1}}};});UE.plugins['customstyle']=function(){var me=this;me.setOpt({'customstyle':[{tag:'h1',name:'tc',style:'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'},{tag:'h1',name:'tl',style:'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;'},{tag:'span',name:'im',style:'font-size:16px;font-style:italic;font-weight:bold;line-height:18px;'},{tag:'span',name:'hi',style:'font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;'}]});me.commands['customstyle']={execCommand:function execCommand(cmdName,obj){var me=this,tagName=obj.tag,node=domUtils.findParent(me.selection.getStart(),function(node){return node.getAttribute('label');},true),range,bk,tmpObj={};for(var p in obj){if(obj[p]!==undefined)tmpObj[p]=obj[p];}delete tmpObj.tag;if(node&&node.getAttribute('label')==obj.label){range=this.selection.getRange();bk=range.createBookmark();if(range.collapsed){if(dtd.$block[node.tagName]){var fillNode=me.document.createElement('p');domUtils.moveChild(node,fillNode);node.parentNode.insertBefore(fillNode,node);domUtils.remove(node);}else{domUtils.remove(node,true);}}else{var common=domUtils.getCommonAncestor(bk.start,bk.end),nodes=domUtils.getElementsByTagName(common,tagName);if(new RegExp(tagName,'i').test(common.tagName)){nodes.push(common);}for(var i=0,ni;ni=nodes[i++];){if(ni.getAttribute('label')==obj.label){var ps=domUtils.getPosition(ni,bk.start),pe=domUtils.getPosition(ni,bk.end);if((ps&domUtils.POSITION_FOLLOWING||ps&domUtils.POSITION_CONTAINS)&&(pe&domUtils.POSITION_PRECEDING||pe&domUtils.POSITION_CONTAINS))if(dtd.$block[tagName]){var fillNode=me.document.createElement('p');domUtils.moveChild(ni,fillNode);ni.parentNode.insertBefore(fillNode,ni);}domUtils.remove(ni,true);}}node=domUtils.findParent(common,function(node){return node.getAttribute('label')==obj.label;},true);if(node){domUtils.remove(node,true);}}range.moveToBookmark(bk).select();}else{if(dtd.$block[tagName]){this.execCommand('paragraph',tagName,tmpObj,'customstyle');range=me.selection.getRange();if(!range.collapsed){range.collapse();node=domUtils.findParent(me.selection.getStart(),function(node){return node.getAttribute('label')==obj.label;},true);var pNode=me.document.createElement('p');domUtils.insertAfter(node,pNode);domUtils.fillNode(me.document,pNode);range.setStart(pNode,0).setCursor();}}else{range=me.selection.getRange();if(range.collapsed){node=me.document.createElement(tagName);domUtils.setAttributes(node,tmpObj);range.insertNode(node).setStart(node,0).setCursor();return;}bk=range.createBookmark();range.applyInlineStyle(tagName,tmpObj).moveToBookmark(bk).select();}}},queryCommandValue:function queryCommandValue(){var parent=domUtils.filterNodeList(this.selection.getStartElementPath(),function(node){return node.getAttribute('label');});return parent?parent.getAttribute('label'):'';}};me.addListener('keyup',function(type,evt){var keyCode=evt.keyCode||evt.which;if(keyCode==32||keyCode==13){var range=me.selection.getRange();if(range.collapsed){var node=domUtils.findParent(me.selection.getStart(),function(node){return node.getAttribute('label');},true);if(node&&dtd.$block[node.tagName]&&domUtils.isEmptyNode(node)){var p=me.document.createElement('p');domUtils.insertAfter(node,p);domUtils.fillNode(me.document,p);domUtils.remove(node);range.setStart(p,0).setCursor();}}}});};UE.plugins['catchremoteimage']=function(){var me=this,ajax=UE.ajax;if(me.options.catchRemoteImageEnable===false)return;me.setOpt({catchRemoteImageEnable:false});me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage");});me.addListener("catchRemoteImage",function(){var catcherLocalDomain=me.getOpt('catcherLocalDomain'),catcherActionUrl=me.getActionUrl(me.getOpt('catcherActionName')),catcherUrlPrefix=me.getOpt('catcherUrlPrefix'),catcherFieldName=me.getOpt('catcherFieldName');var remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img"),test=function test(src,urls){if(src.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(src)){return true;}if(urls){for(var j=0,url;url=urls[j++];){if(src.indexOf(url)!==-1){return true;}}}return false;};for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img")){continue;}var src=ci.getAttribute("_src")||ci.src||"";if(/^(https?|ftp):/i.test(src)&&!test(src,catcherLocalDomain)){remoteImages.push(src);}}if(remoteImages.length){catchremoteimage(remoteImages,{success:function success(r){try{var info=r.state!==undefined?r:eval("("+r.responseText+")");}catch(e){return;}var i,j,ci,cj,oldSrc,newSrc,list=info.list;for(i=0;ci=imgs[i++];){oldSrc=ci.getAttribute("_src")||ci.src||"";for(j=0;cj=list[j++];){if(oldSrc==cj.source&&cj.state=="SUCCESS"){newSrc=catcherUrlPrefix+cj.url;domUtils.setAttributes(ci,{"src":newSrc,"_src":newSrc});break;}}}me.fireEvent('catchremotesuccess');},error:function error(){me.fireEvent("catchremoteerror");}});}function catchremoteimage(imgs,callbacks){var params=utils.serializeParam(me.queryCommandValue('serverparam'))||'',url=utils.formatUrl(catcherActionUrl+(catcherActionUrl.indexOf('?')==-1?'?':'&')+params),isJsonp=utils.isCrossDomainUrl(url),opt={'method':'POST','dataType':isJsonp?'jsonp':'','timeout':60000,'onsuccess':callbacks["success"],'onerror':callbacks["error"]};opt[catcherFieldName]=imgs;ajax.request(url,opt);}});};UE.plugin.register('snapscreen',function(){var me=this;var snapplugin;function getLocation(url){var search,a=document.createElement('a'),params=utils.serializeParam(me.queryCommandValue('serverparam'))||'';a.href=url;if(browser.ie){a.href=a.href;}search=a.search;if(params){search=search+(search.indexOf('?')==-1?'?':'&')+params;search=search.replace(/[&]+/ig,'&');}return{'port':a.port,'hostname':a.hostname,'path':a.pathname+search||+a.hash};}return{commands:{'snapscreen':{execCommand:function execCommand(cmd){var url,local,res;var lang=me.getLang("snapScreen_plugin");if(!snapplugin){var container=me.container;var doc=me.container.ownerDocument||me.container.document;snapplugin=doc.createElement("object");try{snapplugin.type="application/x-pluginbaidusnap";}catch(e){return;}snapplugin.style.cssText="position:absolute;left:-9999px;width:0;height:0;";snapplugin.setAttribute("width","0");snapplugin.setAttribute("height","0");container.appendChild(snapplugin);}function onSuccess(rs){try{rs=eval("("+rs+")");if(rs.state=='SUCCESS'){var opt=me.options;me.execCommand('insertimage',{src:opt.snapscreenUrlPrefix+rs.url,_src:opt.snapscreenUrlPrefix+rs.url,alt:rs.title||'',floatStyle:opt.snapscreenImgAlign});}else{alert(rs.state);}}catch(e){alert(lang.callBackErrorMsg);}}url=me.getActionUrl(me.getOpt('snapscreenActionName'));local=getLocation(url);setTimeout(function(){try{res=snapplugin.saveSnapshot(local.hostname,local.path,local.port);}catch(e){me.ui._dialogs['snapscreenDialog'].open();return;}onSuccess(res);},50);},queryCommandState:function queryCommandState(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1;}}}};});UE.commands['insertparagraph']={execCommand:function execCommand(cmdName,front){var me=this,range=me.selection.getRange(),start=range.startContainer,tmpNode;while(start){if(domUtils.isBody(start)){break;}tmpNode=start;start=start.parentNode;}if(tmpNode){var p=me.document.createElement('p');if(front){tmpNode.parentNode.insertBefore(p,tmpNode);}else{tmpNode.parentNode.insertBefore(p,tmpNode.nextSibling);}domUtils.fillNode(me.document,p);range.setStart(p,0).setCursor(false,true);}}};UE.plugin.register('webapp',function(){var me=this;function createInsertStr(obj,toEmbed){return!toEmbed?'<img title="'+obj.title+'" width="'+obj.width+'" height="'+obj.height+'"'+' src="'+me.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+obj.logo+'" style="background:url('+obj.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+obj.url+'" '+(obj.align&&!obj.cssfloat?'align="'+obj.align+'"':'')+(obj.cssfloat?'style="float:'+obj.cssfloat+'"':'')+'/>':'<iframe class="edui-faked-webapp" title="'+obj.title+'" '+(obj.align&&!obj.cssfloat?'align="'+obj.align+'"':'')+(obj.cssfloat?'style="float:'+obj.cssfloat+'"':'')+'width="'+obj.width+'" height="'+obj.height+'"  scrolling="no" frameborder="0" src="'+obj.url+'" logo_url = "'+obj.logo+'"></iframe>';}return{outputRule:function outputRule(root){utils.each(root.getNodesByTagName('img'),function(node){var html;if(node.getAttr('class')=='edui-faked-webapp'){html=createInsertStr({title:node.getAttr('title'),'width':node.getAttr('width'),'height':node.getAttr('height'),'align':node.getAttr('align'),'cssfloat':node.getStyle('float'),'url':node.getAttr("_url"),'logo':node.getAttr('_logo_url')},true);var embed=UE.uNode.createElement(html);node.parentNode.replaceChild(embed,node);}});},inputRule:function inputRule(root){utils.each(root.getNodesByTagName('iframe'),function(node){if(node.getAttr('class')=='edui-faked-webapp'){var img=UE.uNode.createElement(createInsertStr({title:node.getAttr('title'),'width':node.getAttr('width'),'height':node.getAttr('height'),'align':node.getAttr('align'),'cssfloat':node.getStyle('float'),'url':node.getAttr("src"),'logo':node.getAttr('logo_url')}));node.parentNode.replaceChild(img,node);}});},commands:{'webapp':{execCommand:function execCommand(cmd,obj){var me=this,str=createInsertStr(utils.extend(obj,{align:'none'}),false);me.execCommand("inserthtml",str);},queryCommandState:function queryCommandState(){var me=this,img=me.selection.getRange().getClosedNode(),flag=img&&img.className=="edui-faked-webapp";return flag?1:0;}}}};});UE.plugins['template']=function(){UE.commands['template']={execCommand:function execCommand(cmd,obj){obj.html&&this.execCommand("inserthtml",obj.html);}};this.addListener("click",function(type,evt){var el=evt.target||evt.srcElement,range=this.selection.getRange();var tnode=domUtils.findParent(el,function(node){if(node.className&&domUtils.hasClass(node,"ue_t")){return node;}},true);tnode&&range.selectNode(tnode).shrinkBoundary().select();});this.addListener("keydown",function(type,evt){var range=this.selection.getRange();if(!range.collapsed){if(!evt.ctrlKey&&!evt.metaKey&&!evt.shiftKey&&!evt.altKey){var tnode=domUtils.findParent(range.startContainer,function(node){if(node.className&&domUtils.hasClass(node,"ue_t")){return node;}},true);if(tnode){domUtils.removeClasses(tnode,["ue_t"]);}}}});};UE.plugin.register('music',function(){var me=this;function creatInsertStr(url,width,height,align,cssfloat,toEmbed){return!toEmbed?'<img '+(align&&!cssfloat?'align="'+align+'"':'')+(cssfloat?'style="float:'+cssfloat+'"':'')+' width="'+width+'" height="'+height+'" _url="'+url+'" class="edui-faked-music"'+' src="'+me.options.langPath+me.options.lang+'/images/music.png" />':'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer"'+' src="'+url+'" width="'+width+'" height="'+height+'" '+(align&&!cssfloat?'align="'+align+'"':'')+(cssfloat?'style="float:'+cssfloat+'"':'')+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';}return{outputRule:function outputRule(root){utils.each(root.getNodesByTagName('img'),function(node){var html;if(node.getAttr('class')=='edui-faked-music'){var cssfloat=node.getStyle('float');var align=node.getAttr('align');html=creatInsertStr(node.getAttr("_url"),node.getAttr('width'),node.getAttr('height'),align,cssfloat,true);var embed=UE.uNode.createElement(html);node.parentNode.replaceChild(embed,node);}});},inputRule:function inputRule(root){utils.each(root.getNodesByTagName('embed'),function(node){if(node.getAttr('class')=='edui-faked-music'){var cssfloat=node.getStyle('float');var align=node.getAttr('align');html=creatInsertStr(node.getAttr("src"),node.getAttr('width'),node.getAttr('height'),align,cssfloat,false);var img=UE.uNode.createElement(html);node.parentNode.replaceChild(img,node);}});},commands:{'music':{execCommand:function execCommand(cmd,musicObj){var me=this,str=creatInsertStr(musicObj.url,musicObj.width||400,musicObj.height||95,"none",false);me.execCommand("inserthtml",str);},queryCommandState:function queryCommandState(){var me=this,img=me.selection.getRange().getClosedNode(),flag=img&&img.className=="edui-faked-music";return flag?1:0;}}}};});UE.plugin.register('autoupload',function(){function sendAndInsertFile(file,editor){var me=editor;var fieldName,urlPrefix,maxSize,allowFiles,actionUrl,loadingHtml,errorHandler,successHandler,filetype=/image\/\w+/i.test(file.type)?'image':'file',loadingId='loading_'+(+new Date()).toString(36);fieldName=me.getOpt(filetype+'FieldName');urlPrefix=me.getOpt(filetype+'UrlPrefix');maxSize=me.getOpt(filetype+'MaxSize');allowFiles=me.getOpt(filetype+'AllowFiles');actionUrl=me.getActionUrl(me.getOpt(filetype+'ActionName'));errorHandler=function errorHandler(title){var loader=me.document.getElementById(loadingId);loader&&domUtils.remove(loader);me.fireEvent('showmessage',{'id':loadingId,'content':title,'type':'error','timeout':4000});};if(filetype=='image'){loadingHtml='<img class="loadingclass" id="'+loadingId+'" src="'+me.options.themePath+me.options.theme+'/images/spacer.gif" title="'+(me.getLang('autoupload.loading')||'')+'" >';successHandler=function successHandler(data){var link=urlPrefix+data.url,loader=me.document.getElementById(loadingId);if(loader){loader.setAttribute('src',link);loader.setAttribute('_src',link);loader.setAttribute('title',data.title||'');loader.setAttribute('alt',data.original||'');loader.removeAttribute('id');domUtils.removeClasses(loader,'loadingclass');}};}else{loadingHtml='<p>'+'<img class="loadingclass" id="'+loadingId+'" src="'+me.options.themePath+me.options.theme+'/images/spacer.gif" title="'+(me.getLang('autoupload.loading')||'')+'" >'+'</p>';successHandler=function successHandler(data){var link=urlPrefix+data.url,loader=me.document.getElementById(loadingId);var rng=me.selection.getRange(),bk=rng.createBookmark();rng.selectNode(loader).select();me.execCommand('insertfile',{'url':link});rng.moveToBookmark(bk).select();};}me.execCommand('inserthtml',loadingHtml);if(!me.getOpt(filetype+'ActionName')){errorHandler(me.getLang('autoupload.errorLoadConfig'));return;}if(file.size>maxSize){errorHandler(me.getLang('autoupload.exceedSizeError'));return;}var fileext=file.name?file.name.substr(file.name.lastIndexOf('.')):'';if(fileext&&filetype!='image'||allowFiles&&(allowFiles.join('')+'.').indexOf(fileext.toLowerCase()+'.')==-1){errorHandler(me.getLang('autoupload.exceedTypeError'));return;}var xhr=new XMLHttpRequest(),fd=new FormData(),params=utils.serializeParam(me.queryCommandValue('serverparam'))||'',url=utils.formatUrl(actionUrl+(actionUrl.indexOf('?')==-1?'?':'&')+params);fd.append(fieldName,file,file.name||'blob.'+file.type.substr('image/'.length));fd.append('type','ajax');xhr.open("post",url,true);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.addEventListener('load',function(e){try{var json=new Function("return "+utils.trim(e.target.response))();if(json.state=='SUCCESS'&&json.url){successHandler(json);}else{errorHandler(json.state);}}catch(er){errorHandler(me.getLang('autoupload.loadError'));}});xhr.send(fd);}function getPasteImage(e){return e.clipboardData&&e.clipboardData.items&&e.clipboardData.items.length==1&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null;}function getDropImage(e){return e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null;}return{outputRule:function outputRule(root){utils.each(root.getNodesByTagName('img'),function(n){if(/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr('class'))){n.parentNode.removeChild(n);}});utils.each(root.getNodesByTagName('p'),function(n){if(/\bloadpara\b/.test(n.getAttr('class'))){n.parentNode.removeChild(n);}});},bindEvents:{'ready':function ready(e){var me=this;if(window.FormData&&window.FileReader){domUtils.on(me.body,'paste drop',function(e){var hasImg=false,items;items=e.type=='paste'?getPasteImage(e):getDropImage(e);if(items){var len=items.length,file;while(len--){file=items[len];if(file.getAsFile)file=file.getAsFile();if(file&&file.size>0){sendAndInsertFile(file,me);hasImg=true;}}hasImg&&e.preventDefault();}});domUtils.on(me.body,'dragover',function(e){if(e.dataTransfer.types[0]=='Files'){e.preventDefault();}});utils.cssRule('loading','.loadingclass{display:inline-block;cursor:default;background: url(\''+this.options.themePath+this.options.theme+'/images/loading.gif\') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n'+'.loaderrorclass{display:inline-block;cursor:default;background: url(\''+this.options.themePath+this.options.theme+'/images/loaderror.png\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;'+'}',this.document);}}}};});UE.plugin.register('autosave',function(){var me=this,lastSaveTime=new Date(),MIN_TIME=20,saveKey=null;function save(editor){var saveData;if(new Date()-lastSaveTime<MIN_TIME){return;}if(!editor.hasContents()){saveKey&&me.removePreferences(saveKey);return;}lastSaveTime=new Date();editor._saveFlag=null;saveData=me.body.innerHTML;if(editor.fireEvent("beforeautosave",{content:saveData})===false){return;}me.setPreferences(saveKey,saveData);editor.fireEvent("afterautosave",{content:saveData});}return{defaultOptions:{saveInterval:500},bindEvents:{'ready':function ready(){var _suffix="-drafts-data",key=null;if(me.key){key=me.key+_suffix;}else{key=(me.container.parentNode.id||'ue-common')+_suffix;}
saveKey=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,'_')+key;},'contentchange':function contentchange(){if(!saveKey){return;}if(me._saveFlag){window.clearTimeout(me._saveFlag);}if(me.options.saveInterval>0){me._saveFlag=window.setTimeout(function(){save(me);},me.options.saveInterval);}else{save(me);}}},commands:{'clearlocaldata':{execCommand:function execCommand(cmd,name){if(saveKey&&me.getPreferences(saveKey)){me.removePreferences(saveKey);}},notNeedUndo:true,ignoreContentChange:true},'getlocaldata':{execCommand:function execCommand(cmd,name){return saveKey?me.getPreferences(saveKey)||'':'';},notNeedUndo:true,ignoreContentChange:true},'drafts':{execCommand:function execCommand(cmd,name){if(saveKey){me.body.innerHTML=me.getPreferences(saveKey)||'<p>'+domUtils.fillHtml+'</p>';me.focus(true);}},queryCommandState:function queryCommandState(){return saveKey?me.getPreferences(saveKey)===null?-1:0:-1;},notNeedUndo:true,ignoreContentChange:true}}};});UE.plugin.register('charts',function(){var me=this;return{bindEvents:{'chartserror':function chartserror(){}},commands:{'charts':{execCommand:function execCommand(cmd,data){var tableNode=domUtils.findParentByTagName(this.selection.getRange().startContainer,'table',true),flagText=[],config={};if(!tableNode){return false;}if(!validData(tableNode)){me.fireEvent("chartserror");return false;}config.title=data.title||'';config.subTitle=data.subTitle||'';config.xTitle=data.xTitle||'';config.yTitle=data.yTitle||'';config.suffix=data.suffix||'';config.tip=data.tip||'';config.dataFormat=data.tableDataFormat||'';config.chartType=data.chartType||0;for(var key in config){if(!config.hasOwnProperty(key)){continue;}flagText.push(key+":"+config[key]);}tableNode.setAttribute("data-chart",flagText.join(";"));domUtils.addClass(tableNode,"edui-charts-table");},queryCommandState:function queryCommandState(cmd,name){var tableNode=domUtils.findParentByTagName(this.selection.getRange().startContainer,'table',true);return tableNode&&validData(tableNode)?0:-1;}}},inputRule:function inputRule(root){utils.each(root.getNodesByTagName('table'),function(tableNode){if(tableNode.getAttr("data-chart")!==undefined){tableNode.setAttr("style");}});},outputRule:function outputRule(root){utils.each(root.getNodesByTagName('table'),function(tableNode){if(tableNode.getAttr("data-chart")!==undefined){tableNode.setAttr("style","display: none;");}});}};function validData(table){var firstRows=null,cellCount=0;if(table.rows.length<2){return false;}
if(table.rows[0].cells.length<2){return false;}
firstRows=table.rows[0].cells;cellCount=firstRows.length;for(var i=0,cell;cell=firstRows[i];i++){if(cell.tagName.toLowerCase()!=='th'){return false;}}for(var i=1,row;row=table.rows[i];i++){if(row.cells.length!=cellCount){return false;}
if(row.cells[0].tagName.toLowerCase()!=='th'){return false;}for(var j=1,cell;cell=row.cells[j];j++){var value=utils.trim(cell.innerText||cell.textContent||'');value=value.replace(new RegExp(UE.dom.domUtils.fillChar,'g'),'').replace(/^\s+|\s+$/g,'');if(!/^\d*\.?\d+$/.test(value)){return false;}}}return true;}});UE.plugin.register('section',function(){function Section(option){this.tag='';this.level=-1,this.dom=null;this.nextSection=null;this.previousSection=null;this.parentSection=null;this.startAddress=[];this.endAddress=[];this.children=[];}function getSection(option){var section=new Section();return utils.extend(section,option);}function getNodeFromAddress(startAddress,root){var current=root;for(var i=0;i<startAddress.length;i++){if(!current.childNodes)return null;current=current.childNodes[startAddress[i]];}return current;}var me=this;return{bindMultiEvents:{type:'aftersetcontent afterscencerestore',handler:function handler(){me.fireEvent('updateSections');}},bindEvents:{'ready':function ready(){me.fireEvent('updateSections');domUtils.on(me.body,'drop paste',function(){me.fireEvent('updateSections');});},'afterexeccommand':function afterexeccommand(type,cmd){if(cmd=='paragraph'){me.fireEvent('updateSections');}},'keyup':function keyup(type,e){var me=this,range=me.selection.getRange();if(range.collapsed!=true){me.fireEvent('updateSections');}else{var keyCode=e.keyCode||e.which;if(keyCode==13||keyCode==8||keyCode==46){me.fireEvent('updateSections');}}}},commands:{'getsections':{execCommand:function execCommand(cmd,levels){var levelFn=levels||['h1','h2','h3','h4','h5','h6'];for(var i=0;i<levelFn.length;i++){if(typeof levelFn[i]=='string'){levelFn[i]=function(fn){return function(node){return node.tagName==fn.toUpperCase();};}(levelFn[i]);}else if(typeof levelFn[i]!='function'){levelFn[i]=function(node){return null;};}}function getSectionLevel(node){for(var i=0;i<levelFn.length;i++){if(levelFn[i](node))return i;}return-1;}var me=this,Directory=getSection({'level':-1,'title':'root'}),previous=Directory;function traversal(node,Directory){var level,tmpSection=null,parent,child,children=node.childNodes;for(var i=0,len=children.length;i<len;i++){child=children[i];level=getSectionLevel(child);if(level>=0){var address=me.selection.getRange().selectNode(child).createAddress(true).startAddress,current=getSection({'tag':child.tagName,'title':child.innerText||child.textContent||'','level':level,'dom':child,'startAddress':utils.clone(address,[]),'endAddress':utils.clone(address,[]),'children':[]});previous.nextSection=current;current.previousSection=previous;parent=previous;while(level<=parent.level){parent=parent.parentSection;}current.parentSection=parent;parent.children.push(current);tmpSection=previous=current;}else{child.nodeType===1&&traversal(child,Directory);tmpSection&&tmpSection.endAddress[tmpSection.endAddress.length-1]++;}}}traversal(me.body,Directory);return Directory;},notNeedUndo:true},'movesection':{execCommand:function execCommand(cmd,sourceSection,targetSection,isAfter){var me=this,targetAddress,target;if(!sourceSection||!targetSection||targetSection.level==-1)return;targetAddress=isAfter?targetSection.endAddress:targetSection.startAddress;target=getNodeFromAddress(targetAddress,me.body);if(!targetAddress||!target||isContainsAddress(sourceSection.startAddress,sourceSection.endAddress,targetAddress))return;var startNode=getNodeFromAddress(sourceSection.startAddress,me.body),endNode=getNodeFromAddress(sourceSection.endAddress,me.body),current,nextNode;if(isAfter){current=endNode;while(current&&!(domUtils.getPosition(startNode,current)&domUtils.POSITION_FOLLOWING)){nextNode=current.previousSibling;domUtils.insertAfter(target,current);if(current==startNode)break;current=nextNode;}}else{current=startNode;while(current&&!(domUtils.getPosition(current,endNode)&domUtils.POSITION_FOLLOWING)){nextNode=current.nextSibling;target.parentNode.insertBefore(current,target);if(current==endNode)break;current=nextNode;}}me.fireEvent('updateSections');function isContainsAddress(startAddress,endAddress,addressTarget){var isAfterStartAddress=false,isBeforeEndAddress=false;for(var i=0;i<startAddress.length;i++){if(i>=addressTarget.length)break;if(addressTarget[i]>startAddress[i]){isAfterStartAddress=true;break;}else if(addressTarget[i]<startAddress[i]){break;}}for(var i=0;i<endAddress.length;i++){if(i>=addressTarget.length)break;if(addressTarget[i]<startAddress[i]){isBeforeEndAddress=true;break;}else if(addressTarget[i]>startAddress[i]){break;}}return isAfterStartAddress&&isBeforeEndAddress;}}},'deletesection':{execCommand:function execCommand(cmd,section,keepChildren){var me=this;if(!section)return;function getNodeFromAddress(startAddress){var current=me.body;for(var i=0;i<startAddress.length;i++){if(!current.childNodes)return null;current=current.childNodes[startAddress[i]];}return current;}var startNode=getNodeFromAddress(section.startAddress),endNode=getNodeFromAddress(section.endAddress),current=startNode,nextNode;if(!keepChildren){while(current&&domUtils.inDoc(endNode,me.document)&&!(domUtils.getPosition(current,endNode)&domUtils.POSITION_FOLLOWING)){nextNode=current.nextSibling;domUtils.remove(current);current=nextNode;}}else{domUtils.remove(current);}me.fireEvent('updateSections');}},'selectsection':{execCommand:function execCommand(cmd,section){if(!section&&!section.dom)return false;var me=this,range=me.selection.getRange(),address={'startAddress':utils.clone(section.startAddress,[]),'endAddress':utils.clone(section.endAddress,[])};address.endAddress[address.endAddress.length-1]++;range.moveToAddress(address).select().scrollToView();return true;},notNeedUndo:true},'scrolltosection':{execCommand:function execCommand(cmd,section){if(!section&&!section.dom)return false;var me=this,range=me.selection.getRange(),address={'startAddress':section.startAddress,'endAddress':section.endAddress};address.endAddress[address.endAddress.length-1]++;range.moveToAddress(address).scrollToView();return true;},notNeedUndo:true}}};});UE.plugin.register('simpleupload',function(){var me=this,isLoaded=false,containerBtn;function initUploadBtn(){var w=containerBtn.offsetWidth||20,h=containerBtn.offsetHeight||20,btnIframe=document.createElement('iframe'),btnStyle='display:block;width:'+w+'px;height:'+h+'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';domUtils.on(btnIframe,'load',function(){var timestrap=(+new Date()).toString(36),wrapper,btnIframeDoc,btnIframeBody;btnIframeDoc=btnIframe.contentDocument||btnIframe.contentWindow.document;btnIframeBody=btnIframeDoc.body;wrapper=btnIframeDoc.createElement('div');wrapper.innerHTML='<form id="edui_form_'+timestrap+'" target="edui_iframe_'+timestrap+'" method="POST" enctype="multipart/form-data" action="'+me.getOpt('serverUrl')+'" '+'style="'+btnStyle+'">'+'<input id="edui_input_'+timestrap+'" type="file" accept="image/*" name="'+me.options.imageFieldName+'" '+'style="'+btnStyle+'">'+'</form>'+'<iframe id="edui_iframe_'+timestrap+'" name="edui_iframe_'+timestrap+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';wrapper.className='edui-'+me.options.theme;wrapper.id=me.ui.id+'_iframeupload';btnIframeBody.style.cssText=btnStyle;btnIframeBody.style.width=w+'px';btnIframeBody.style.height=h+'px';btnIframeBody.appendChild(wrapper);if(btnIframeBody.parentNode){btnIframeBody.parentNode.style.width=w+'px';btnIframeBody.parentNode.style.height=w+'px';}var form=btnIframeDoc.getElementById('edui_form_'+timestrap);var input=btnIframeDoc.getElementById('edui_input_'+timestrap);var iframe=btnIframeDoc.getElementById('edui_iframe_'+timestrap);domUtils.on(input,'change',function(){if(!input.value)return;var loadingId='loading_'+(+new Date()).toString(36);var params=utils.serializeParam(me.queryCommandValue('serverparam'))||'';var imageActionUrl=me.getActionUrl(me.getOpt('imageActionName'));var allowFiles=me.getOpt('imageAllowFiles');me.focus();me.execCommand('inserthtml','<img class="loadingclass" id="'+loadingId+'" src="'+me.options.themePath+me.options.theme+'/images/spacer.gif" title="'+(me.getLang('simpleupload.loading')||'')+'" >');function callback(){try{var link,json,loader,body=(iframe.contentDocument||iframe.contentWindow.document).body,result=body.innerText||body.textContent||'';json=new Function("return "+result)();link=me.options.imageUrlPrefix+json.url;if(json.state=='SUCCESS'&&json.url){loader=me.document.getElementById(loadingId);loader.setAttribute('src',link);loader.setAttribute('_src',link);loader.setAttribute('title',json.title||'');loader.setAttribute('alt',json.original||'');loader.removeAttribute('id');domUtils.removeClasses(loader,'loadingclass');}else{showErrorLoader&&showErrorLoader(json.state);}}catch(er){showErrorLoader&&showErrorLoader(me.getLang('simpleupload.loadError'));}form.reset();domUtils.un(iframe,'load',callback);}function showErrorLoader(title){if(loadingId){var loader=me.document.getElementById(loadingId);loader&&domUtils.remove(loader);me.fireEvent('showmessage',{'id':loadingId,'content':title,'type':'error','timeout':4000});}}if(!me.getOpt('imageActionName')){errorHandler(me.getLang('autoupload.errorLoadConfig'));return;}
var filename=input.value,fileext=filename?filename.substr(filename.lastIndexOf('.')):'';if(!fileext||allowFiles&&(allowFiles.join('')+'.').indexOf(fileext.toLowerCase()+'.')==-1){showErrorLoader(me.getLang('simpleupload.exceedTypeError'));return;}domUtils.on(iframe,'load',callback);form.action=utils.formatUrl(imageActionUrl+(imageActionUrl.indexOf('?')==-1?'?':'&')+params);form.submit();});var stateTimer;me.addListener('selectionchange',function(){clearTimeout(stateTimer);stateTimer=setTimeout(function(){var state=me.queryCommandState('simpleupload');if(state==-1){input.disabled='disabled';}else{input.disabled=false;}},400);});isLoaded=true;});btnIframe.style.cssText=btnStyle;containerBtn.appendChild(btnIframe);}return{bindEvents:{'ready':function ready(){utils.cssRule('loading','.loadingclass{display:inline-block;cursor:default;background: url(\''+this.options.themePath+this.options.theme+'/images/loading.gif\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n'+'.loaderrorclass{display:inline-block;cursor:default;background: url(\''+this.options.themePath+this.options.theme+'/images/loaderror.png\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;'+'}',this.document);},'simpleuploadbtnready':function simpleuploadbtnready(type,container){containerBtn=container;me.afterConfigReady(initUploadBtn);}},outputRule:function outputRule(root){utils.each(root.getNodesByTagName('img'),function(n){if(/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr('class'))){n.parentNode.removeChild(n);}});},commands:{'simpleupload':{queryCommandState:function queryCommandState(){return isLoaded?0:-1;}}}};});UE.plugin.register('serverparam',function(){var me=this,serverParam={};return{commands:{'serverparam':{execCommand:function execCommand(cmd,key,value){if(key===undefined||key===null){serverParam={};}else if(utils.isString(key)){if(value===undefined||value===null){delete serverParam[key];}else{serverParam[key]=value;}}else if(utils.isObject(key)){utils.extend(serverParam,key,true);}else if(utils.isFunction(key)){utils.extend(serverParam,key(),true);}},queryCommandValue:function queryCommandValue(){return serverParam||{};}}}};});UE.plugin.register('insertfile',function(){var me=this;function getFileIcon(url){var ext=url.substr(url.lastIndexOf('.')+1).toLowerCase(),maps={"rar":"icon_rar.gif","zip":"icon_rar.gif","tar":"icon_rar.gif","gz":"icon_rar.gif","bz2":"icon_rar.gif","doc":"icon_doc.gif","docx":"icon_doc.gif","pdf":"icon_pdf.gif","mp3":"icon_mp3.gif","xls":"icon_xls.gif","chm":"icon_chm.gif","ppt":"icon_ppt.gif","pptx":"icon_ppt.gif","avi":"icon_mv.gif","rmvb":"icon_mv.gif","wmv":"icon_mv.gif","flv":"icon_mv.gif","swf":"icon_mv.gif","rm":"icon_mv.gif","exe":"icon_exe.gif","psd":"icon_psd.gif","txt":"icon_txt.gif","jpg":"icon_jpg.gif","png":"icon_jpg.gif","jpeg":"icon_jpg.gif","gif":"icon_jpg.gif","ico":"icon_jpg.gif","bmp":"icon_jpg.gif"};return maps[ext]?maps[ext]:maps['txt'];}return{commands:{'insertfile':{execCommand:function execCommand(command,filelist){filelist=utils.isArray(filelist)?filelist:[filelist];var i,item,icon,title,html='',URL=me.getOpt('UEDITOR_HOME_URL'),iconDir=URL+(URL.substr(URL.length-1)=='/'?'':'/')+'dialogs/attachment/fileTypeImages/';for(i=0;i<filelist.length;i++){item=filelist[i];icon=iconDir+getFileIcon(item.url);title=item.title||item.url.substr(item.url.lastIndexOf('/')+1);html+='<p style="line-height: 16px;">'+'<img style="vertical-align: middle; margin-right: 2px;" src="'+icon+'" _src="'+icon+'" />'+'<a style="font-size:12px; color:#0066cc;" href="'+item.url+'" title="'+title+'">'+title+'</a>'+'</p>';}me.execCommand('insertHtml',html);}}}};});var baidu=baidu||{};baidu.editor=baidu.editor||{};UE.ui=baidu.editor.ui={};(function(){var browser=baidu.editor.browser,domUtils=baidu.editor.dom.domUtils;var magic='$EDITORUI';var root=window[magic]={};var uidMagic='ID'+magic;var uidCount=0;var uiUtils=baidu.editor.ui.uiUtils={uid:function uid(obj){return obj?obj[uidMagic]||(obj[uidMagic]=++uidCount):++uidCount;},hook:function hook(fn,callback){var _dg;if(fn&&fn._callbacks){_dg=fn;}else{_dg=function dg(){var q;if(fn){q=fn.apply(this,arguments);}var callbacks=_dg._callbacks;var k=callbacks.length;while(k--){var r=callbacks[k].apply(this,arguments);if(q===undefined){q=r;}}return q;};_dg._callbacks=[];}_dg._callbacks.push(callback);return _dg;},createElementByHtml:function createElementByHtml(html){var el=document.createElement('div');el.innerHTML=html;el=el.firstChild;el.parentNode.removeChild(el);return el;},getViewportElement:function getViewportElement(){return browser.ie&&browser.quirks?document.body:document.documentElement;},getClientRect:function getClientRect(element){var bcr;try{bcr=element.getBoundingClientRect();}catch(e){bcr={left:0,top:0,height:0,width:0};}var rect={left:Math.round(bcr.left),top:Math.round(bcr.top),height:Math.round(bcr.bottom-bcr.top),width:Math.round(bcr.right-bcr.left)};var doc;while((doc=element.ownerDocument)!==document&&(element=domUtils.getWindow(doc).frameElement)){bcr=element.getBoundingClientRect();rect.left+=bcr.left;rect.top+=bcr.top;}rect.bottom=rect.top+rect.height;rect.right=rect.left+rect.width;return rect;},getViewportRect:function getViewportRect(){var viewportEl=uiUtils.getViewportElement();var width=(window.innerWidth||viewportEl.clientWidth)|0;var height=(window.innerHeight||viewportEl.clientHeight)|0;return{left:0,top:0,height:height,width:width,bottom:height,right:width};},setViewportOffset:function setViewportOffset(element,offset){var rect;var fixedLayer=uiUtils.getFixedLayer();if(element.parentNode===fixedLayer){element.style.left=offset.left+'px';element.style.top=offset.top+'px';}else{domUtils.setViewportOffset(element,offset);}},getEventOffset:function getEventOffset(evt){var el=evt.target||evt.srcElement;var rect=uiUtils.getClientRect(el);var offset=uiUtils.getViewportOffsetByEvent(evt);return{left:offset.left-rect.left,top:offset.top-rect.top};},getViewportOffsetByEvent:function getViewportOffsetByEvent(evt){var el=evt.target||evt.srcElement;var frameEl=domUtils.getWindow(el).frameElement;var offset={left:evt.clientX,top:evt.clientY};if(frameEl&&el.ownerDocument!==document){var rect=uiUtils.getClientRect(frameEl);offset.left+=rect.left;offset.top+=rect.top;}return offset;},setGlobal:function setGlobal(id,obj){root[id]=obj;return magic+'["'+id+'"]';},unsetGlobal:function unsetGlobal(id){delete root[id];},copyAttributes:function copyAttributes(tgt,src){var attributes=src.attributes;var k=attributes.length;while(k--){var attrNode=attributes[k];if(attrNode.nodeName!='style'&&attrNode.nodeName!='class'&&(!browser.ie||attrNode.specified)){tgt.setAttribute(attrNode.nodeName,attrNode.nodeValue);}}if(src.className){domUtils.addClass(tgt,src.className);}if(src.style.cssText){tgt.style.cssText+=';'+src.style.cssText;}},removeStyle:function removeStyle(el,styleName){if(el.style.removeProperty){el.style.removeProperty(styleName);}else if(el.style.removeAttribute){el.style.removeAttribute(styleName);}else throw'';},contains:function contains(elA,elB){return elA&&elB&&(elA===elB?false:elA.contains?elA.contains(elB):elA.compareDocumentPosition(elB)&16);},startDrag:function startDrag(evt,callbacks,doc){var doc=doc||document;var startX=evt.clientX;var startY=evt.clientY;function handleMouseMove(evt){var x=evt.clientX-startX;var y=evt.clientY-startY;callbacks.ondragmove(x,y,evt);if(evt.stopPropagation){evt.stopPropagation();}else{evt.cancelBubble=true;}}if(doc.addEventListener){(function(){var handleMouseUp=function handleMouseUp(evt){doc.removeEventListener('mousemove',handleMouseMove,true);doc.removeEventListener('mouseup',handleMouseUp,true);window.removeEventListener('mouseup',handleMouseUp,true);callbacks.ondragstop();};doc.addEventListener('mousemove',handleMouseMove,true);doc.addEventListener('mouseup',handleMouseUp,true);window.addEventListener('mouseup',handleMouseUp,true);evt.preventDefault();})();}else{var elm;(function(){var releaseCaptrue=function releaseCaptrue(){elm.releaseCapture();elm.detachEvent('onmousemove',handleMouseMove);elm.detachEvent('onmouseup',releaseCaptrue);elm.detachEvent('onlosecaptrue',releaseCaptrue);callbacks.ondragstop();};elm=evt.srcElement;elm.setCapture();elm.attachEvent('onmousemove',handleMouseMove);elm.attachEvent('onmouseup',releaseCaptrue);elm.attachEvent('onlosecaptrue',releaseCaptrue);evt.returnValue=false;})();}callbacks.ondragstart();},getFixedLayer:function getFixedLayer(){var layer=document.getElementById('edui_fixedlayer');if(layer==null){layer=document.createElement('div');layer.id='edui_fixedlayer';document.body.appendChild(layer);if(browser.ie&&browser.version<=8){layer.style.position='absolute';bindFixedLayer();setTimeout(updateFixedOffset);}else{layer.style.position='fixed';}layer.style.left='0';layer.style.top='0';layer.style.width='0';layer.style.height='0';}return layer;},makeUnselectable:function makeUnselectable(element){if(browser.opera||browser.ie&&browser.version<9){element.unselectable='on';if(element.hasChildNodes()){for(var i=0;i<element.childNodes.length;i++){if(element.childNodes[i].nodeType==1){uiUtils.makeUnselectable(element.childNodes[i]);}}}}else{if(element.style.MozUserSelect!==undefined){element.style.MozUserSelect='none';}else if(element.style.WebkitUserSelect!==undefined){element.style.WebkitUserSelect='none';}else if(element.style.KhtmlUserSelect!==undefined){element.style.KhtmlUserSelect='none';}}}};function updateFixedOffset(){var layer=document.getElementById('edui_fixedlayer');uiUtils.setViewportOffset(layer,{left:0,top:0});}function bindFixedLayer(adjOffset){domUtils.on(window,'scroll',updateFixedOffset);domUtils.on(window,'resize',baidu.editor.utils.defer(updateFixedOffset,0,true));}})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,EventBase=baidu.editor.EventBase,UIBase=baidu.editor.ui.UIBase=function(){};UIBase.prototype={className:'',uiName:'',initOptions:function initOptions(options){var me=this;for(var k in options){me[k]=options[k];}this.id=this.id||'edui'+uiUtils.uid();},initUIBase:function initUIBase(){this._globalKey=utils.unhtml(uiUtils.setGlobal(this.id,this));},render:function render(holder){var html=this.renderHtml();var el=uiUtils.createElementByHtml(html);var list=domUtils.getElementsByTagName(el,"*");var theme="edui-"+(this.theme||this.editor.options.theme);var layer=document.getElementById('edui_fixedlayer');for(var i=0,node;node=list[i++];){domUtils.addClass(node,theme);}domUtils.addClass(el,theme);if(layer){layer.className="";domUtils.addClass(layer,theme);}var seatEl=this.getDom();if(seatEl!=null){seatEl.parentNode.replaceChild(el,seatEl);uiUtils.copyAttributes(el,seatEl);}else{if(typeof holder=='string'){holder=document.getElementById(holder);}holder=holder||uiUtils.getFixedLayer();domUtils.addClass(holder,theme);holder.appendChild(el);}this.postRender();},getDom:function getDom(name){if(!name){return document.getElementById(this.id);}else{return document.getElementById(this.id+'_'+name);}},postRender:function postRender(){this.fireEvent('postrender');},getHtmlTpl:function getHtmlTpl(){return'';},formatHtml:function formatHtml(tpl){var prefix='edui-'+this.uiName;return tpl.replace(/##/g,this.id).replace(/%%-/g,this.uiName?prefix+'-':'').replace(/%%/g,(this.uiName?prefix:'')+' '+this.className).replace(/\$\$/g,this._globalKey);},renderHtml:function renderHtml(){return this.formatHtml(this.getHtmlTpl());},dispose:function dispose(){var box=this.getDom();if(box)baidu.editor.dom.domUtils.remove(box);uiUtils.unsetGlobal(this.id);}};utils.inherits(UIBase,EventBase);})();(function(){var utils=baidu.editor.utils,UIBase=baidu.editor.ui.UIBase,Separator=baidu.editor.ui.Separator=function(options){this.initOptions(options);this.initSeparator();};Separator.prototype={uiName:'separator',initSeparator:function initSeparator(){this.initUIBase();},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-box %%"></div>';}};utils.inherits(Separator,UIBase);})();(function(){var utils=baidu.editor.utils,domUtils=baidu.editor.dom.domUtils,UIBase=baidu.editor.ui.UIBase,uiUtils=baidu.editor.ui.uiUtils;var Mask=baidu.editor.ui.Mask=function(options){this.initOptions(options);this.initUIBase();};Mask.prototype={getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>';},postRender:function postRender(){var me=this;domUtils.on(window,'resize',function(){setTimeout(function(){if(!me.isHidden()){me._fill();}});});},show:function show(zIndex){this._fill();this.getDom().style.display='';this.getDom().style.zIndex=zIndex;},hide:function hide(){this.getDom().style.display='none';this.getDom().style.zIndex='';},isHidden:function isHidden(){return this.getDom().style.display=='none';},_onMouseDown:function _onMouseDown(){return false;},_onClick:function _onClick(e,target){this.fireEvent('click',e,target);},_fill:function _fill(){var el=this.getDom();var vpRect=uiUtils.getViewportRect();el.style.width=vpRect.width+'px';el.style.height=vpRect.height+'px';}};utils.inherits(Mask,UIBase);})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,domUtils=baidu.editor.dom.domUtils,UIBase=baidu.editor.ui.UIBase,Popup=baidu.editor.ui.Popup=function(options){this.initOptions(options);this.initPopup();};var allPopups=[];function closeAllPopup(evt,el){for(var i=0;i<allPopups.length;i++){var pop=allPopups[i];if(!pop.isHidden()){if(pop.queryAutoHide(el)!==false){if(evt&&/scroll/ig.test(evt.type)&&pop.className=="edui-wordpastepop")return;pop.hide();}}}if(allPopups.length)pop.editor.fireEvent("afterhidepop");}Popup.postHide=closeAllPopup;var ANCHOR_CLASSES=['edui-anchor-topleft','edui-anchor-topright','edui-anchor-bottomleft','edui-anchor-bottomright'];Popup.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function initPopup(){this.initUIBase();allPopups.push(this);},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-popup %%" onmousedown="return false;">'+' <div id="##_body" class="edui-popup-body">'+' <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe>'+' <div class="edui-shadow"></div>'+' <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+'  </div>'+' </div>'+'</div>';},getContentHtmlTpl:function getContentHtmlTpl(){if(this.content){if(typeof this.content=='string'){return this.content;}return this.content.renderHtml();}else{return'';}},_UIBase_postRender:UIBase.prototype.postRender,postRender:function postRender(){if(this.content instanceof UIBase){this.content.postRender();}
if(this.captureWheel&&!this.captured){this.captured=true;var winHeight=(document.documentElement.clientHeight||document.body.clientHeight)-80,_height=this.getDom().offsetHeight,_top=uiUtils.getClientRect(this.combox.getDom()).top,content=this.getDom('content'),ifr=this.getDom('body').getElementsByTagName('iframe'),me=this;ifr.length&&(ifr=ifr[0]);while(_top+_height>winHeight){_height-=30;}content.style.height=_height+'px';ifr&&(ifr.style.height=_height+'px');if(window.XMLHttpRequest){domUtils.on(content,'onmousewheel'in document.body?'mousewheel':'DOMMouseScroll',function(e){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}if(e.wheelDelta){content.scrollTop-=e.wheelDelta/120*60;}else{content.scrollTop-=e.detail/-3*60;}});}else{domUtils.on(this.getDom(),'mousewheel',function(e){e.returnValue=false;me.getDom('content').scrollTop-=e.wheelDelta/120*60;});}}this.fireEvent('postRenderAfter');this.hide(true);this._UIBase_postRender();},_doAutoRender:function _doAutoRender(){if(!this.getDom()&&this.autoRender){this.render();}},mesureSize:function mesureSize(){var box=this.getDom('content');return uiUtils.getClientRect(box);},fitSize:function fitSize(){if(this.captureWheel&&this.sized){return this.__size;}this.sized=true;var popBodyEl=this.getDom('body');popBodyEl.style.width='';popBodyEl.style.height='';var size=this.mesureSize();if(this.captureWheel){popBodyEl.style.width=-(-20-size.width)+'px';var height=parseInt(this.getDom('content').style.height,10);!window.isNaN(height)&&(size.height=height);}else{popBodyEl.style.width=size.width+'px';}popBodyEl.style.height=size.height+'px';this.__size=size;this.captureWheel&&(this.getDom('content').style.overflow='auto');return size;},showAnchor:function showAnchor(element,hoz){this.showAnchorRect(uiUtils.getClientRect(element),hoz);},showAnchorRect:function showAnchorRect(rect,hoz,adj){this._doAutoRender();var vpRect=uiUtils.getViewportRect();this.getDom().style.visibility='hidden';this._show();var popSize=this.fitSize();var sideLeft,sideUp,left,top;if(hoz){sideLeft=this.canSideLeft&&rect.right+popSize.width>vpRect.right&&rect.left>popSize.width;sideUp=this.canSideUp&&rect.top+popSize.height>vpRect.bottom&&rect.bottom>popSize.height;left=sideLeft?rect.left-popSize.width:rect.right;top=sideUp?rect.bottom-popSize.height:rect.top;}else{sideLeft=this.canSideLeft&&rect.right+popSize.width>vpRect.right&&rect.left>popSize.width;sideUp=this.canSideUp&&rect.top+popSize.height>vpRect.bottom&&rect.bottom>popSize.height;left=sideLeft?rect.right-popSize.width:rect.left;top=sideUp?rect.top-popSize.height:rect.bottom;}var popEl=this.getDom();uiUtils.setViewportOffset(popEl,{left:left,top:top});domUtils.removeClasses(popEl,ANCHOR_CLASSES);popEl.className+=' '+ANCHOR_CLASSES[(sideUp?1:0)*2+(sideLeft?1:0)];if(this.editor){popEl.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=popEl.style.zIndex-1;}this.getDom().style.visibility='visible';},showAt:function showAt(offset){var left=offset.left;var top=offset.top;var rect={left:left,top:top,right:left,bottom:top,height:0,width:0};this.showAnchorRect(rect,false,true);},_show:function _show(){if(this._hidden){var box=this.getDom();box.style.display='';this._hidden=false;this.fireEvent('show');}},isHidden:function isHidden(){return this._hidden;},show:function show(){this._doAutoRender();this._show();},hide:function hide(notNofity){if(!this._hidden&&this.getDom()){this.getDom().style.display='none';this._hidden=true;if(!notNofity){this.fireEvent('hide');}}},queryAutoHide:function queryAutoHide(el){return!el||!uiUtils.contains(this.getDom(),el);}};utils.inherits(Popup,UIBase);domUtils.on(document,'mousedown',function(evt){var el=evt.target||evt.srcElement;closeAllPopup(evt,el);});domUtils.on(window,'scroll',function(evt,el){closeAllPopup(evt,el);});})();(function(){var utils=baidu.editor.utils,UIBase=baidu.editor.ui.UIBase,ColorPicker=baidu.editor.ui.ColorPicker=function(options){this.initOptions(options);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase();};ColorPicker.prototype={getHtmlTpl:function getHtmlTpl(){return genColorPicker(this.noColorText,this.editor);},_onTableClick:function _onTableClick(evt){var tgt=evt.target||evt.srcElement;var color=tgt.getAttribute('data-color');if(color){this.fireEvent('pickcolor',color);}},_onTableOver:function _onTableOver(evt){var tgt=evt.target||evt.srcElement;var color=tgt.getAttribute('data-color');if(color){this.getDom('preview').style.backgroundColor=color;}},_onTableOut:function _onTableOut(){this.getDom('preview').style.backgroundColor='';},_onPickNoColor:function _onPickNoColor(){this.fireEvent('picknocolor');}};utils.inherits(ColorPicker,UIBase);var COLORS=('ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,'+'f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,'+'d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,'+'bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,'+'a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,'+'7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,'+'c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,').split(',');function genColorPicker(noColorText,editor){var html='<div id="##" class="edui-colorpicker %%">'+'<div class="edui-colorpicker-topbar edui-clearfix">'+'<div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div>'+'<div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+noColorText+'</div>'+'</div>'+'<table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+editor.getLang("themeColor")+'</td> </tr>'+'<tr class="edui-colorpicker-tablefirstrow" >';for(var i=0;i<COLORS.length;i++){if(i&&i%10===0){html+='</tr>'+(i==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+editor.getLang("standardColor")+'</td></tr>':'')+'<tr'+(i==60?' class="edui-colorpicker-tablefirstrow"':'')+'>';}html+=i<70?'<td style="padding: 0 2px;"><a hidefocus title="'+COLORS[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' data-color="#'+COLORS[i]+'"'+' style="background-color:#'+COLORS[i]+';border:solid #ccc;'+(i<10||i>=60?'border-width:1px;':i>=10&&i<20?'border-width:1px 1px 0 1px;':'border-width:0 1px 0 1px;')+'"'+'></a></td>':'';}html+='</tr></table></div>';return html;}})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,UIBase=baidu.editor.ui.UIBase;var TablePicker=baidu.editor.ui.TablePicker=function(options){this.initOptions(options);this.initTablePicker();};TablePicker.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function initTablePicker(){this.initUIBase();},getHtmlTpl:function getHtmlTpl(){var me=this;return'<div id="##" class="edui-tablepicker %%">'+'<div class="edui-tablepicker-body">'+'<div class="edui-infoarea">'+'<span id="##_label" class="edui-label"></span>'+'</div>'+'<div class="edui-pickarea"'+' onmousemove="$$._onMouseMove(event, this);"'+' onmouseover="$$._onMouseOver(event, this);"'+' onmouseout="$$._onMouseOut(event, this);"'+' onclick="$$._onClick(event, this);"'+'>'+'<div id="##_overlay" class="edui-overlay"></div>'+'</div>'+'</div>'+'</div>';},_UIBase_render:UIBase.prototype.render,render:function render(holder){this._UIBase_render(holder);this.getDom('label').innerHTML='0'+this.editor.getLang("t_row")+' x 0'+this.editor.getLang("t_col");},_track:function _track(numCols,numRows){var style=this.getDom('overlay').style;var sideLen=this.lengthOfCellSide;style.width=numCols*sideLen+'px';style.height=numRows*sideLen+'px';var label=this.getDom('label');label.innerHTML=numCols+this.editor.getLang("t_col")+' x '+numRows+this.editor.getLang("t_row");this.numCols=numCols;this.numRows=numRows;},_onMouseOver:function _onMouseOver(evt,el){var rel=evt.relatedTarget||evt.fromElement;if(!uiUtils.contains(el,rel)&&el!==rel){this.getDom('label').innerHTML='0'+this.editor.getLang("t_col")+' x 0'+this.editor.getLang("t_row");this.getDom('overlay').style.visibility='';}},_onMouseOut:function _onMouseOut(evt,el){var rel=evt.relatedTarget||evt.toElement;if(!uiUtils.contains(el,rel)&&el!==rel){this.getDom('label').innerHTML='0'+this.editor.getLang("t_col")+' x 0'+this.editor.getLang("t_row");this.getDom('overlay').style.visibility='hidden';}},_onMouseMove:function _onMouseMove(evt,el){var style=this.getDom('overlay').style;var offset=uiUtils.getEventOffset(evt);var sideLen=this.lengthOfCellSide;var numCols=Math.ceil(offset.left/sideLen);var numRows=Math.ceil(offset.top/sideLen);this._track(numCols,numRows);},_onClick:function _onClick(){this.fireEvent('picktable',this.numCols,this.numRows);}};utils.inherits(TablePicker,UIBase);})();(function(){var browser=baidu.editor.browser,domUtils=baidu.editor.dom.domUtils,uiUtils=baidu.editor.ui.uiUtils;var TPL_STATEFUL='onmousedown="$$.Stateful_onMouseDown(event, this);"'+' onmouseup="$$.Stateful_onMouseUp(event, this);"'+(browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);"'+' onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);"'+' onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function Stateful_init(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl;},Stateful_getHtmlTpl:function Stateful_getHtmlTpl(){var tpl=this._Stateful_dGetHtmlTpl();return tpl.replace(/stateful/g,function(){return TPL_STATEFUL;});},Stateful_onMouseEnter:function Stateful_onMouseEnter(evt,el){this.target=el;if(!this.isDisabled()||this.alwalysHoverable){this.addState('hover');this.fireEvent('over');}},Stateful_onMouseLeave:function Stateful_onMouseLeave(evt,el){if(!this.isDisabled()||this.alwalysHoverable){this.removeState('hover');this.removeState('active');this.fireEvent('out');}},Stateful_onMouseOver:function Stateful_onMouseOver(evt,el){var rel=evt.relatedTarget;if(!uiUtils.contains(el,rel)&&el!==rel){this.Stateful_onMouseEnter(evt,el);}},Stateful_onMouseOut:function Stateful_onMouseOut(evt,el){var rel=evt.relatedTarget;if(!uiUtils.contains(el,rel)&&el!==rel){this.Stateful_onMouseLeave(evt,el);}},Stateful_onMouseDown:function Stateful_onMouseDown(evt,el){if(!this.isDisabled()){this.addState('active');}},Stateful_onMouseUp:function Stateful_onMouseUp(evt,el){if(!this.isDisabled()){this.removeState('active');}},Stateful_postRender:function Stateful_postRender(){if(this.disabled&&!this.hasState('disabled')){this.addState('disabled');}},hasState:function hasState(state){return domUtils.hasClass(this.getStateDom(),'edui-state-'+state);},addState:function addState(state){if(!this.hasState(state)){this.getStateDom().className+=' edui-state-'+state;}},removeState:function removeState(state){if(this.hasState(state)){domUtils.removeClasses(this.getStateDom(),['edui-state-'+state]);}},getStateDom:function getStateDom(){return this.getDom('state');},isChecked:function isChecked(){return this.hasState('checked');},setChecked:function setChecked(checked){if(!this.isDisabled()&&checked){this.addState('checked');}else{this.removeState('checked');}},isDisabled:function isDisabled(){return this.hasState('disabled');},setDisabled:function setDisabled(disabled){if(disabled){this.removeState('hover');this.removeState('checked');this.removeState('active');this.addState('disabled');}else{this.removeState('disabled');}}};})();(function(){var utils=baidu.editor.utils,UIBase=baidu.editor.ui.UIBase,Stateful=baidu.editor.ui.Stateful,Button=baidu.editor.ui.Button=function(options){if(options.name){var btnName=options.name;var cssRules=options.cssRules;if(!options.className){options.className='edui-for-'+btnName;}options.cssRules='.edui-default  .edui-for-'+btnName+' .edui-icon {'+cssRules+'}';}this.initOptions(options);this.initButton();};Button.prototype={uiName:'button',label:'',title:'',showIcon:true,showText:true,cssRules:'',initButton:function initButton(){this.initUIBase();this.Stateful_init();if(this.cssRules){utils.cssRule('edui-customize-'+this.name+'-style',this.cssRules);}},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-box %%">'+'<div id="##_state" stateful>'+'<div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':'')+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':'')+(this.showText?'<div class="edui-box edui-label">'+this.label+'</div>':'')+'</div>'+'</div>'+'</div></div>';},postRender:function postRender(){this.Stateful_postRender();this.setDisabled(this.disabled);},_onMouseDown:function _onMouseDown(e){var target=e.target||e.srcElement,tagName=target&&target.tagName&&target.tagName.toLowerCase();if(tagName=='input'||tagName=='object'||tagName=='object'){return false;}},_onClick:function _onClick(){if(!this.isDisabled()){this.fireEvent('click');}},setTitle:function setTitle(text){var label=this.getDom('label');label.innerHTML=text;}};utils.inherits(Button,UIBase);utils.extend(Button.prototype,Stateful);})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,domUtils=baidu.editor.dom.domUtils,UIBase=baidu.editor.ui.UIBase,Stateful=baidu.editor.ui.Stateful,SplitButton=baidu.editor.ui.SplitButton=function(options){this.initOptions(options);this.initSplitButton();};SplitButton.prototype={popup:null,uiName:'splitbutton',title:'',initSplitButton:function initSplitButton(){this.initUIBase();this.Stateful_init();var me=this;if(this.popup!=null){var popup=this.popup;this.popup=null;this.setPopup(popup);}},_UIBase_postRender:UIBase.prototype.postRender,postRender:function postRender(){this.Stateful_postRender();this._UIBase_postRender();},setPopup:function setPopup(popup){if(this.popup===popup)return;if(this.popup!=null){this.popup.dispose();}popup.addListener('show',utils.bind(this._onPopupShow,this));popup.addListener('hide',utils.bind(this._onPopupHide,this));popup.addListener('postrender',utils.bind(function(){popup.getDom('body').appendChild(uiUtils.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(uiUtils.getClientRect(this.getDom()).width+20)+'px"></div>'));popup.getDom().className+=' '+this.className;},this));this.popup=popup;},_onPopupShow:function _onPopupShow(){this.addState('opened');},_onPopupHide:function _onPopupHide(){this.removeState('opened');},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-box %%">'+'<div '+(this.title?'title="'+this.title+'"':'')+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"></div>'+'</div>'+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+'</div></div></div>';},showPopup:function showPopup(){var rect=uiUtils.getClientRect(this.getDom());rect.top-=this.popup.SHADOW_RADIUS;rect.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(rect);},_onArrowClick:function _onArrowClick(event,el){if(!this.isDisabled()){this.showPopup();}},_onButtonClick:function _onButtonClick(){if(!this.isDisabled()){this.fireEvent('buttonclick');}}};utils.inherits(SplitButton,UIBase);utils.extend(SplitButton.prototype,Stateful,true);})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,ColorPicker=baidu.editor.ui.ColorPicker,Popup=baidu.editor.ui.Popup,SplitButton=baidu.editor.ui.SplitButton,ColorButton=baidu.editor.ui.ColorButton=function(options){this.initOptions(options);this.initColorButton();};ColorButton.prototype={initColorButton:function initColorButton(){var me=this;this.popup=new Popup({content:new ColorPicker({noColorText:me.editor.getLang("clearColor"),editor:me.editor,onpickcolor:function onpickcolor(t,color){me._onPickColor(color);},onpicknocolor:function onpicknocolor(t,color){me._onPickNoColor(color);}}),editor:me.editor});this.initSplitButton();},_SplitButton_postRender:SplitButton.prototype.postRender,postRender:function postRender(){this._SplitButton_postRender();this.getDom('button_body').appendChild(uiUtils.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=' edui-colorbutton';},setColor:function setColor(color){this.getDom('colorlump').style.backgroundColor=color;this.color=color;},_onPickColor:function _onPickColor(color){if(this.fireEvent('pickcolor',color)!==false){this.setColor(color);this.popup.hide();}},_onPickNoColor:function _onPickNoColor(color){if(this.fireEvent('picknocolor')!==false){this.popup.hide();}}};utils.inherits(ColorButton,SplitButton);})();(function(){var utils=baidu.editor.utils,Popup=baidu.editor.ui.Popup,TablePicker=baidu.editor.ui.TablePicker,SplitButton=baidu.editor.ui.SplitButton,TableButton=baidu.editor.ui.TableButton=function(options){this.initOptions(options);this.initTableButton();};TableButton.prototype={initTableButton:function initTableButton(){var me=this;this.popup=new Popup({content:new TablePicker({editor:me.editor,onpicktable:function onpicktable(t,numCols,numRows){me._onPickTable(numCols,numRows);}}),'editor':me.editor});this.initSplitButton();},_onPickTable:function _onPickTable(numCols,numRows){if(this.fireEvent('picktable',numCols,numRows)!==false){this.popup.hide();}}};utils.inherits(TableButton,SplitButton);})();(function(){var utils=baidu.editor.utils,UIBase=baidu.editor.ui.UIBase;var AutoTypeSetPicker=baidu.editor.ui.AutoTypeSetPicker=function(options){this.initOptions(options);this.initAutoTypeSetPicker();};AutoTypeSetPicker.prototype={initAutoTypeSetPicker:function initAutoTypeSetPicker(){this.initUIBase();},getHtmlTpl:function getHtmlTpl(){var me=this.editor,opt=me.options.autotypeset,lang=me.getLang("autoTypeSet");var textAlignInputName='textAlignValue'+me.uid,imageBlockInputName='imageBlockLineValue'+me.uid,symbolConverInputName='symbolConverValue'+me.uid;return'<div id="##" class="edui-autotypesetpicker %%">'+'<div class="edui-autotypesetpicker-body">'+'<table >'+'<tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(opt["mergeEmptyline"]?"checked":"")+'>'+lang.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(opt["removeEmptyline"]?"checked":"")+'>'+lang.delLine+'</td></tr>'+'<tr><td nowrap><input type="checkbox" name="removeClass" '+(opt["removeClass"]?"checked":"")+'>'+lang.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(opt["indent"]?"checked":"")+'>'+lang.indent+'</td></tr>'+'<tr>'+'<td nowrap><input type="checkbox" name="textAlign" '+(opt["textAlign"]?"checked":"")+'>'+lang.alignment+'</td>'+'<td colspan="2" id="'+textAlignInputName+'">'+'<input type="radio" name="'+textAlignInputName+'" value="left" '+(opt["textAlign"]&&opt["textAlign"]=="left"?"checked":"")+'>'+me.getLang("justifyleft")+'<input type="radio" name="'+textAlignInputName+'" value="center" '+(opt["textAlign"]&&opt["textAlign"]=="center"?"checked":"")+'>'+me.getLang("justifycenter")+'<input type="radio" name="'+textAlignInputName+'" value="right" '+(opt["textAlign"]&&opt["textAlign"]=="right"?"checked":"")+'>'+me.getLang("justifyright")+'</td>'+'</tr>'+'<tr>'+'<td nowrap><input type="checkbox" name="imageBlockLine" '+(opt["imageBlockLine"]?"checked":"")+'>'+lang.imageFloat+'</td>'+'<td nowrap id="'+imageBlockInputName+'">'+'<input type="radio" name="'+imageBlockInputName+'" value="none" '+(opt["imageBlockLine"]&&opt["imageBlockLine"]=="none"?"checked":"")+'>'+me.getLang("default")+'<input type="radio" name="'+imageBlockInputName+'" value="left" '+(opt["imageBlockLine"]&&opt["imageBlockLine"]=="left"?"checked":"")+'>'+me.getLang("justifyleft")+'<input type="radio" name="'+imageBlockInputName+'" value="center" '+(opt["imageBlockLine"]&&opt["imageBlockLine"]=="center"?"checked":"")+'>'+me.getLang("justifycenter")+'<input type="radio" name="'+imageBlockInputName+'" value="right" '+(opt["imageBlockLine"]&&opt["imageBlockLine"]=="right"?"checked":"")+'>'+me.getLang("justifyright")+'</td>'+'</tr>'+'<tr><td nowrap><input type="checkbox" name="clearFontSize" '+(opt["clearFontSize"]?"checked":"")+'>'+lang.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(opt["clearFontFamily"]?"checked":"")+'>'+lang.removeFontFamily+'</td></tr>'+'<tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(opt["removeEmptyNode"]?"checked":"")+'>'+lang.removeHtml+'</td></tr>'+'<tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(opt["pasteFilter"]?"checked":"")+'>'+lang.pasteFilter+'</td></tr>'+'<tr>'+'<td nowrap><input type="checkbox" name="symbolConver" '+(opt["bdc2sb"]||opt["tobdc"]?"checked":"")+'>'+lang.symbol+'</td>'+'<td id="'+symbolConverInputName+'">'+'<input type="radio" name="bdc" value="bdc2sb" '+(opt["bdc2sb"]?"checked":"")+'>'+lang.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(opt["tobdc"]?"checked":"")+'>'+lang.tobdc+''+'</td>'+'<td nowrap align="right"><button >'+lang.run+'</button></td>'+'</tr>'+'</table>'+'</div>'+'</div>';},_UIBase_render:UIBase.prototype.render};utils.inherits(AutoTypeSetPicker,UIBase);})();(function(){var utils=baidu.editor.utils,Popup=baidu.editor.ui.Popup,AutoTypeSetPicker=baidu.editor.ui.AutoTypeSetPicker,SplitButton=baidu.editor.ui.SplitButton,AutoTypeSetButton=baidu.editor.ui.AutoTypeSetButton=function(options){this.initOptions(options);this.initAutoTypeSetButton();};function getPara(me){var opt={},cont=me.getDom(),editorId=me.editor.uid,inputType=null,attrName=null,ipts=domUtils.getElementsByTagName(cont,"input");for(var i=ipts.length-1,ipt;ipt=ipts[i--];){inputType=ipt.getAttribute("type");if(inputType=="checkbox"){attrName=ipt.getAttribute("name");opt[attrName]&&delete opt[attrName];if(ipt.checked){var attrValue=document.getElementById(attrName+"Value"+editorId);if(attrValue){if(/input/ig.test(attrValue.tagName)){opt[attrName]=attrValue.value;}else{var iptChilds=attrValue.getElementsByTagName("input");for(var j=iptChilds.length-1,iptchild;iptchild=iptChilds[j--];){if(iptchild.checked){opt[attrName]=iptchild.value;break;}}}}else{opt[attrName]=true;}}else{opt[attrName]=false;}}else{opt[ipt.getAttribute("value")]=ipt.checked;}}var selects=domUtils.getElementsByTagName(cont,"select");for(var i=0,si;si=selects[i++];){var attr=si.getAttribute('name');opt[attr]=opt[attr]?si.value:'';}utils.extend(me.editor.options.autotypeset,opt);me.editor.setPreferences('autotypeset',opt);}AutoTypeSetButton.prototype={initAutoTypeSetButton:function initAutoTypeSetButton(){var me=this;this.popup=new Popup({content:new AutoTypeSetPicker({editor:me.editor}),'editor':me.editor,hide:function hide(){if(!this._hidden&&this.getDom()){getPara(this);this.getDom().style.display='none';this._hidden=true;this.fireEvent('hide');}}});var flag=0;this.popup.addListener('postRenderAfter',function(){var popupUI=this;if(flag)return;var cont=this.getDom(),btn=cont.getElementsByTagName('button')[0];btn.onclick=function(){getPara(popupUI);me.editor.execCommand('autotypeset');popupUI.hide();};domUtils.on(cont,'click',function(e){var target=e.target||e.srcElement,editorId=me.editor.uid;if(target&&target.tagName=='INPUT'){if(target.name=='imageBlockLine'||target.name=='textAlign'||target.name=='symbolConver'){var checked=target.checked,radioTd=document.getElementById(target.name+'Value'+editorId),radios=radioTd.getElementsByTagName('input'),defalutSelect={'imageBlockLine':'none','textAlign':'left','symbolConver':'tobdc'};for(var i=0;i<radios.length;i++){if(checked){if(radios[i].value==defalutSelect[target.name]){radios[i].checked='checked';}}else{radios[i].checked=false;}}}
if(target.name=='imageBlockLineValue'+editorId||target.name=='textAlignValue'+editorId||target.name=='bdc'){var checkboxs=target.parentNode.previousSibling.getElementsByTagName('input');checkboxs&&(checkboxs[0].checked=true);}getPara(popupUI);}});flag=1;});this.initSplitButton();}};utils.inherits(AutoTypeSetButton,SplitButton);})();(function(){var utils=baidu.editor.utils,Popup=baidu.editor.ui.Popup,Stateful=baidu.editor.ui.Stateful,UIBase=baidu.editor.ui.UIBase;var CellAlignPicker=baidu.editor.ui.CellAlignPicker=function(options){this.initOptions(options);this.initSelected();this.initCellAlignPicker();};CellAlignPicker.prototype={initSelected:function initSelected(){var status={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3},result=-1;if(this.selected){this.selectedIndex=status.valign[this.selected.valign]*status.count+status.align[this.selected.align];}},initCellAlignPicker:function initCellAlignPicker(){this.initUIBase();this.Stateful_init();},getHtmlTpl:function getHtmlTpl(){var alignType=['left','center','right'],COUNT=9,tempClassName=null,tempIndex=-1,tmpl=[];for(var i=0;i<COUNT;i++){tempClassName=this.selectedIndex===i?' class="edui-cellalign-selected" ':'';tempIndex=i%3;tempIndex===0&&tmpl.push('<tr>');tmpl.push('<td index="'+i+'" '+tempClassName+' stateful><div class="edui-icon edui-'+alignType[tempIndex]+'"></div></td>');tempIndex===2&&tmpl.push('</tr>');}return'<div id="##" class="edui-cellalignpicker %%">'+'<div class="edui-cellalignpicker-body">'+'<table onclick="$$._onClick(event);">'+tmpl.join('')+'</table>'+'</div>'+'</div>';},getStateDom:function getStateDom(){return this.target;},_onClick:function _onClick(evt){var target=evt.target||evt.srcElement;if(/icon/.test(target.className)){this.items[target.parentNode.getAttribute("index")].onclick();Popup.postHide(evt);}},_UIBase_render:UIBase.prototype.render};utils.inherits(CellAlignPicker,UIBase);utils.extend(CellAlignPicker.prototype,Stateful,true);})();(function(){var utils=baidu.editor.utils,Stateful=baidu.editor.ui.Stateful,uiUtils=baidu.editor.ui.uiUtils,UIBase=baidu.editor.ui.UIBase;var PastePicker=baidu.editor.ui.PastePicker=function(options){this.initOptions(options);this.initPastePicker();};PastePicker.prototype={initPastePicker:function initPastePicker(){this.initUIBase();this.Stateful_init();},getHtmlTpl:function getHtmlTpl(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div>'+'<div class="edui-pastecontainer">'+'<div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div>'+'<div class="edui-button">'+'<div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful>'+'<div class="edui-richtxticon"></div></div>'+'<div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful>'+'<div class="edui-tagicon"></div></div>'+'<div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful>'+'<div class="edui-plaintxticon"></div></div>'+'</div>'+'</div>'+'</div>';},getStateDom:function getStateDom(){return this.target;},format:function format(param){this.editor.ui._isTransfer=true;this.editor.fireEvent('pasteTransfer',param);},_onClick:function _onClick(cur){var node=domUtils.getNextDomNode(cur),screenHt=uiUtils.getViewportRect().height,subPop=uiUtils.getClientRect(node);if(subPop.top+subPop.height>screenHt)node.style.top=-subPop.height-cur.offsetHeight+"px";else node.style.top="";if(/hidden/ig.test(domUtils.getComputedStyle(node,"visibility"))){node.style.visibility="visible";domUtils.addClass(cur,"edui-state-opened");}else{node.style.visibility="hidden";domUtils.removeClasses(cur,"edui-state-opened");}},_UIBase_render:UIBase.prototype.render};utils.inherits(PastePicker,UIBase);utils.extend(PastePicker.prototype,Stateful,true);})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,UIBase=baidu.editor.ui.UIBase,Toolbar=baidu.editor.ui.Toolbar=function(options){this.initOptions(options);this.initToolbar();};Toolbar.prototype={items:null,initToolbar:function initToolbar(){this.items=this.items||[];this.initUIBase();},add:function add(item,index){if(index===undefined){this.items.push(item);}else{this.items.splice(index,0,item);}},getHtmlTpl:function getHtmlTpl(){var buff=[];for(var i=0;i<this.items.length;i++){buff[i]=this.items[i].renderHtml();}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+buff.join('')+'</div>';},postRender:function postRender(){var box=this.getDom();for(var i=0;i<this.items.length;i++){this.items[i].postRender();}uiUtils.makeUnselectable(box);},_onMouseDown:function _onMouseDown(e){var target=e.target||e.srcElement,tagName=target&&target.tagName&&target.tagName.toLowerCase();if(tagName=='input'||tagName=='object'||tagName=='object'){return false;}}};utils.inherits(Toolbar,UIBase);})();(function(){var utils=baidu.editor.utils,domUtils=baidu.editor.dom.domUtils,uiUtils=baidu.editor.ui.uiUtils,UIBase=baidu.editor.ui.UIBase,Popup=baidu.editor.ui.Popup,Stateful=baidu.editor.ui.Stateful,CellAlignPicker=baidu.editor.ui.CellAlignPicker,Menu=baidu.editor.ui.Menu=function(options){this.initOptions(options);this.initMenu();};var menuSeparator={renderHtml:function renderHtml(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>';},postRender:function postRender(){},queryAutoHide:function queryAutoHide(){return true;}};Menu.prototype={items:null,uiName:'menu',initMenu:function initMenu(){this.items=this.items||[];this.initPopup();this.initItems();},initItems:function initItems(){for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item=='-'){this.items[i]=this.getSeparator();}else if(!(item instanceof MenuItem)){item.editor=this.editor;item.theme=this.editor.options.theme;this.items[i]=this.createItem(item);}}},getSeparator:function getSeparator(){return menuSeparator;},createItem:function createItem(item){item.menu=this;return new MenuItem(item);},_Popup_getContentHtmlTpl:Popup.prototype.getContentHtmlTpl,getContentHtmlTpl:function getContentHtmlTpl(){if(this.items.length==0){return this._Popup_getContentHtmlTpl();}var buff=[];for(var i=0;i<this.items.length;i++){var item=this.items[i];buff[i]=item.renderHtml();}return'<div class="%%-body">'+buff.join('')+'</div>';},_Popup_postRender:Popup.prototype.postRender,postRender:function postRender(){var me=this;for(var i=0;i<this.items.length;i++){var item=this.items[i];item.ownerMenu=this;item.postRender();}domUtils.on(this.getDom(),'mouseover',function(evt){evt=evt||event;var rel=evt.relatedTarget||evt.fromElement;var el=me.getDom();if(!uiUtils.contains(el,rel)&&el!==rel){me.fireEvent('over');}});this._Popup_postRender();},queryAutoHide:function queryAutoHide(el){if(el){if(uiUtils.contains(this.getDom(),el)){return false;}for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.queryAutoHide(el)===false){return false;}}}},clearItems:function clearItems(){for(var i=0;i<this.items.length;i++){var item=this.items[i];clearTimeout(item._showingTimer);clearTimeout(item._closingTimer);if(item.subMenu){item.subMenu.destroy();}}this.items=[];},destroy:function destroy(){if(this.getDom()){domUtils.remove(this.getDom());}this.clearItems();},dispose:function dispose(){this.destroy();}};utils.inherits(Menu,Popup);var MenuItem=baidu.editor.ui.MenuItem=function(options){this.initOptions(options);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof Menu)){if(options.className&&options.className.indexOf("aligntd")!=-1){var me=this;this.subMenu.selected=this.editor.queryCommandValue('cellalignment');this.subMenu=new Popup({content:new CellAlignPicker(this.subMenu),parentMenu:me,editor:me.editor,destroy:function destroy(){if(this.getDom()){domUtils.remove(this.getDom());}}});this.subMenu.addListener("postRenderAfter",function(){domUtils.on(this.getDom(),"mouseover",function(){me.addState('opened');});});}else{this.subMenu=new Menu(this.subMenu);}}};MenuItem.prototype={label:'',subMenu:null,ownerMenu:null,uiName:'menuitem',alwalysHoverable:true,getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);">'+'<div class="%%-body">'+this.renderLabelHtml()+'</div>'+'</div>';},postRender:function postRender(){var me=this;this.addListener('over',function(){me.ownerMenu.fireEvent('submenuover',me);if(me.subMenu){me.delayShowSubMenu();}});if(this.subMenu){this.getDom().className+=' edui-hassubmenu';this.subMenu.render();this.addListener('out',function(){me.delayHideSubMenu();});this.subMenu.addListener('over',function(){clearTimeout(me._closingTimer);me._closingTimer=null;me.addState('opened');});this.ownerMenu.addListener('hide',function(){me.hideSubMenu();});this.ownerMenu.addListener('submenuover',function(t,subMenu){if(subMenu!==me){me.delayHideSubMenu();}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(el){if(el&&uiUtils.contains(me.getDom(),el)){return false;}return this._bakQueryAutoHide(el);};}this.getDom().style.tabIndex='-1';uiUtils.makeUnselectable(this.getDom());this.Stateful_postRender();},delayShowSubMenu:function delayShowSubMenu(){var me=this;if(!me.isDisabled()){me.addState('opened');clearTimeout(me._showingTimer);clearTimeout(me._closingTimer);me._closingTimer=null;me._showingTimer=setTimeout(function(){me.showSubMenu();},250);}},delayHideSubMenu:function delayHideSubMenu(){var me=this;if(!me.isDisabled()){me.removeState('opened');clearTimeout(me._showingTimer);if(!me._closingTimer){me._closingTimer=setTimeout(function(){if(!me.hasState('opened')){me.hideSubMenu();}me._closingTimer=null;},400);}}},renderLabelHtml:function renderLabelHtml(){return'<div class="edui-arrow"></div>'+'<div class="edui-box edui-icon"></div>'+'<div class="edui-box edui-label %%-label">'+(this.label||'')+'</div>';},getStateDom:function getStateDom(){return this.getDom();},queryAutoHide:function queryAutoHide(el){if(this.subMenu&&this.hasState('opened')){return this.subMenu.queryAutoHide(el);}},_onClick:function _onClick(event,this_){if(this.hasState('disabled'))return;if(this.fireEvent('click',event,this_)!==false){if(this.subMenu){this.showSubMenu();}else{Popup.postHide(event);}}},showSubMenu:function showSubMenu(){var rect=uiUtils.getClientRect(this.getDom());rect.right-=5;rect.left+=2;rect.width-=7;rect.top-=4;rect.bottom+=4;rect.height+=8;this.subMenu.showAnchorRect(rect,true,true);},hideSubMenu:function hideSubMenu(){this.subMenu.hide();}};utils.inherits(MenuItem,UIBase);utils.extend(MenuItem.prototype,Stateful,true);})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,Menu=baidu.editor.ui.Menu,SplitButton=baidu.editor.ui.SplitButton,Combox=baidu.editor.ui.Combox=function(options){this.initOptions(options);this.initCombox();};Combox.prototype={uiName:'combox',onbuttonclick:function onbuttonclick(){this.showPopup();},initCombox:function initCombox(){var me=this;this.items=this.items||[];for(var i=0;i<this.items.length;i++){var item=this.items[i];item.uiName='listitem';item.index=i;item.onclick=function(){me.selectByIndex(this.index);};}this.popup=new Menu({items:this.items,uiName:'list',editor:this.editor,captureWheel:true,combox:this});this.initSplitButton();},_SplitButton_postRender:SplitButton.prototype.postRender,postRender:function postRender(){this._SplitButton_postRender();this.setLabel(this.label||'');this.setValue(this.initValue||'');},showPopup:function showPopup(){var rect=uiUtils.getClientRect(this.getDom());rect.top+=1;rect.bottom-=1;rect.height-=2;this.popup.showAnchorRect(rect);},getValue:function getValue(){return this.value;},setValue:function setValue(value){var index=this.indexByValue(value);if(index!=-1){this.selectedIndex=index;this.setLabel(this.items[index].label);this.value=this.items[index].value;}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(value));this.value=value;}},setLabel:function setLabel(label){this.getDom('button_body').innerHTML=label;this.label=label;},getLabelForUnknowValue:function getLabelForUnknowValue(value){return value;},indexByValue:function indexByValue(value){for(var i=0;i<this.items.length;i++){if(value==this.items[i].value){return i;}}return-1;},getItem:function getItem(index){return this.items[index];},selectByIndex:function selectByIndex(index){if(index<this.items.length&&this.fireEvent('select',index)!==false){this.selectedIndex=index;this.value=this.items[index].value;this.setLabel(this.items[index].label);}}};utils.inherits(Combox,SplitButton);})();(function(){var utils=baidu.editor.utils,domUtils=baidu.editor.dom.domUtils,uiUtils=baidu.editor.ui.uiUtils,Mask=baidu.editor.ui.Mask,UIBase=baidu.editor.ui.UIBase,Button=baidu.editor.ui.Button,Dialog=baidu.editor.ui.Dialog=function(options){if(options.name){var name=options.name;var cssRules=options.cssRules;if(!options.className){options.className='edui-for-'+name;}if(cssRules){options.cssRules='.edui-default .edui-for-'+name+' .edui-dialog-content  {'+cssRules+'}';}}this.initOptions(utils.extend({autoReset:true,draggable:true,onok:function onok(){},oncancel:function oncancel(){},onclose:function onclose(t,ok){return ok?this.onok():this.oncancel();},holdScroll:false},options));this.initDialog();};var modalMask;var dragMask;var activeDialog;Dialog.prototype={draggable:false,uiName:'dialog',initDialog:function initDialog(){var me=this,theme=this.editor.options.theme;if(this.cssRules){utils.cssRule('edui-customize-'+this.name+'-style',this.cssRules);}this.initUIBase();this.modalMask=modalMask||(modalMask=new Mask({className:'edui-dialog-modalmask',theme:theme,onclick:function onclick(){activeDialog&&activeDialog.close(false);}}));this.dragMask=dragMask||(dragMask=new Mask({className:'edui-dialog-dragmask',theme:theme}));this.closeButton=new Button({className:'edui-dialog-closebutton',title:me.closeDialog,theme:theme,onclick:function onclick(){me.close(false);}});this.fullscreen&&this.initResizeEvent();if(this.buttons){for(var i=0;i<this.buttons.length;i++){if(!(this.buttons[i]instanceof Button)){this.buttons[i]=new Button(utils.extend(this.buttons[i],{editor:this.editor},true));}}}},initResizeEvent:function initResizeEvent(){var me=this;domUtils.on(window,"resize",function(){if(me._hidden||me._hidden===undefined){return;}if(me.__resizeTimer){window.clearTimeout(me.__resizeTimer);}me.__resizeTimer=window.setTimeout(function(){me.__resizeTimer=null;var dialogWrapNode=me.getDom(),contentNode=me.getDom('content'),wrapRect=UE.ui.uiUtils.getClientRect(dialogWrapNode),contentRect=UE.ui.uiUtils.getClientRect(contentNode),vpRect=uiUtils.getViewportRect();contentNode.style.width=vpRect.width-wrapRect.width+contentRect.width+"px";contentNode.style.height=vpRect.height-wrapRect.height+contentRect.height+"px";dialogWrapNode.style.width=vpRect.width+"px";dialogWrapNode.style.height=vpRect.height+"px";me.fireEvent("resize");},100);});},fitSize:function fitSize(){var popBodyEl=this.getDom('body');var size=this.mesureSize();popBodyEl.style.width=size.width+'px';popBodyEl.style.height=size.height+'px';return size;},safeSetOffset:function safeSetOffset(offset){var me=this;var el=me.getDom();var vpRect=uiUtils.getViewportRect();var rect=uiUtils.getClientRect(el);var left=offset.left;if(left+rect.width>vpRect.right){left=vpRect.right-rect.width;}var top=offset.top;if(top+rect.height>vpRect.bottom){top=vpRect.bottom-rect.height;}el.style.left=Math.max(left,0)+'px';el.style.top=Math.max(top,0)+'px';},showAtCenter:function showAtCenter(){var vpRect=uiUtils.getViewportRect();if(!this.fullscreen){this.getDom().style.display='';var popSize=this.fitSize();var titleHeight=this.getDom('titlebar').offsetHeight|0;var left=vpRect.width/2-popSize.width/2;var top=vpRect.height/2-(popSize.height-titleHeight)/2-titleHeight;var popEl=this.getDom();this.safeSetOffset({left:Math.max(left|0,0),top:Math.max(top|0,0)});if(!domUtils.hasClass(popEl,'edui-state-centered')){popEl.className+=' edui-state-centered';}}else{var dialogWrapNode=this.getDom(),contentNode=this.getDom('content');dialogWrapNode.style.display="block";var wrapRect=UE.ui.uiUtils.getClientRect(dialogWrapNode),contentRect=UE.ui.uiUtils.getClientRect(contentNode);dialogWrapNode.style.left="-100000px";contentNode.style.width=vpRect.width-wrapRect.width+contentRect.width+"px";contentNode.style.height=vpRect.height-wrapRect.height+contentRect.height+"px";dialogWrapNode.style.width=vpRect.width+"px";dialogWrapNode.style.height=vpRect.height+"px";dialogWrapNode.style.left=0;this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}};document.documentElement.style.overflowX='hidden';document.documentElement.style.overflowY='hidden';document.body.style.overflowX='hidden';document.body.style.overflowY='hidden';}this._show();},getContentHtml:function getContentHtml(){var contentHtml='';if(typeof this.content=='string'){contentHtml=this.content;}else if(this.iframeUrl){contentHtml='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>';}return contentHtml;},getHtmlTpl:function getHtmlTpl(){var footHtml='';if(this.buttons){var buff=[];for(var i=0;i<this.buttons.length;i++){buff[i]=this.buttons[i].renderHtml();}footHtml='<div class="%%-foot">'+'<div id="##_buttons" class="%%-buttons">'+buff.join('')+'</div>'+'</div>';}return'<div id="##" class="%%"><div '+(!this.fullscreen?'class="%%"':'class="%%-wrap edui-dialog-fullscreen-flag"')+'><div id="##_body" class="%%-body">'+'<div class="%%-shadow"></div>'+'<div id="##_titlebar" class="%%-titlebar">'+'<div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);">'+'<span class="%%-caption">'+(this.title||'')+'</span>'+'</div>'+this.closeButton.renderHtml()+'</div>'+'<div id="##_content" class="%%-content">'+(this.autoReset?'':this.getContentHtml())+'</div>'+footHtml+'</div></div></div>';},postRender:function postRender(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide();}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide();}var me=this;this.addListener('show',function(){me.modalMask.show(this.getDom().style.zIndex-2);});this.addListener('hide',function(){me.modalMask.hide();});if(this.buttons){for(var i=0;i<this.buttons.length;i++){this.buttons[i].postRender();}}domUtils.on(window,'resize',function(){setTimeout(function(){if(!me.isHidden()){me.safeSetOffset(uiUtils.getClientRect(me.getDom()));}});});this._hide();},mesureSize:function mesureSize(){var body=this.getDom('body');var width=uiUtils.getClientRect(this.getDom('content')).width;var dialogBodyStyle=body.style;dialogBodyStyle.width=width;return uiUtils.getClientRect(body);},_onTitlebarMouseDown:function _onTitlebarMouseDown(evt,el){if(this.draggable){var rect;var vpRect=uiUtils.getViewportRect();var me=this;uiUtils.startDrag(evt,{ondragstart:function ondragstart(){rect=uiUtils.getClientRect(me.getDom());me.getDom('contmask').style.visibility='visible';me.dragMask.show(me.getDom().style.zIndex-1);},ondragmove:function ondragmove(x,y){var left=rect.left+x;var top=rect.top+y;me.safeSetOffset({left:left,top:top});},ondragstop:function ondragstop(){me.getDom('contmask').style.visibility='hidden';domUtils.removeClasses(me.getDom(),['edui-state-centered']);me.dragMask.hide();}});}},reset:function reset(){this.getDom('content').innerHTML=this.getContentHtml();this.fireEvent('dialogafterreset');},_show:function _show(){if(this._hidden){this.getDom().style.display='';this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent('show');baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4;}},isHidden:function isHidden(){return this._hidden;},_hide:function _hide(){if(!this._hidden){var wrapNode=this.getDom();wrapNode.style.display='none';wrapNode.style.zIndex='';wrapNode.style.width='';wrapNode.style.height='';this._hidden=true;this.fireEvent('hide');}},open:function open(){if(this.autoReset){try{this.reset();}catch(e){this.render();this.open();}}this.showAtCenter();if(this.iframeUrl){try{this.getDom('iframe').focus();}catch(ex){}}activeDialog=this;},_onCloseButtonClick:function _onCloseButtonClick(evt,el){this.close(false);},close:function close(ok){if(this.fireEvent('close',ok)!==false){if(this.fullscreen){document.documentElement.style.overflowX=this._originalContext.html.overflowX;document.documentElement.style.overflowY=this._originalContext.html.overflowY;document.body.style.overflowX=this._originalContext.body.overflowX;document.body.style.overflowY=this._originalContext.body.overflowY;delete this._originalContext;}this._hide();var content=this.getDom('content');var iframe=this.getDom('iframe');if(content&&iframe){var doc=iframe.contentDocument||iframe.contentWindow.document;doc&&(doc.body.innerHTML='');domUtils.remove(content);}}}};utils.inherits(Dialog,UIBase);})();(function(){var utils=baidu.editor.utils,Menu=baidu.editor.ui.Menu,SplitButton=baidu.editor.ui.SplitButton,MenuButton=baidu.editor.ui.MenuButton=function(options){this.initOptions(options);this.initMenuButton();};MenuButton.prototype={initMenuButton:function initMenuButton(){var me=this;this.uiName="menubutton";this.popup=new Menu({items:me.items,className:me.className,editor:me.editor});this.popup.addListener('show',function(){var list=this;for(var i=0;i<list.items.length;i++){list.items[i].removeState('checked');if(list.items[i].value==me._value){list.items[i].addState('checked');this.value=me._value;}}});this.initSplitButton();},setValue:function setValue(value){this._value=value;}};utils.inherits(MenuButton,SplitButton);})();(function(){var utils=baidu.editor.utils,Popup=baidu.editor.ui.Popup,SplitButton=baidu.editor.ui.SplitButton,MultiMenuPop=baidu.editor.ui.MultiMenuPop=function(options){this.initOptions(options);this.initMultiMenu();};MultiMenuPop.prototype={initMultiMenu:function initMultiMenu(){var me=this;this.popup=new Popup({content:'',editor:me.editor,iframe_rendered:false,onshow:function onshow(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom('content').innerHTML='<iframe id="'+me.id+'_iframe" src="'+me.iframeUrl+'" frameborder="0"></iframe>';me.editor.container.style.zIndex&&(this.getDom().style.zIndex=me.editor.container.style.zIndex*1+1);}}});this.onbuttonclick=function(){this.showPopup();};this.initSplitButton();}};utils.inherits(MultiMenuPop,SplitButton);})();(function(){var UI=baidu.editor.ui,UIBase=UI.UIBase,uiUtils=UI.uiUtils,utils=baidu.editor.utils,domUtils=baidu.editor.dom.domUtils;var allMenus=[],timeID,isSubMenuShow=false;var ShortCutMenu=UI.ShortCutMenu=function(options){this.initOptions(options);this.initShortCutMenu();};ShortCutMenu.postHide=hideAllMenu;ShortCutMenu.prototype={isHidden:true,SPACE:5,initShortCutMenu:function initShortCutMenu(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();allMenus.push(this);},initEvent:function initEvent(){var me=this,doc=me.editor.document;domUtils.on(doc,"mousemove",function(e){if(me.isHidden===false){if(me.getSubMenuMark()||me.eventType=="contextmenu")return;var flag=true,el=me.getDom(),wt=el.offsetWidth,ht=el.offsetHeight,distanceX=wt/2+me.SPACE,distanceY=ht/2,x=Math.abs(e.screenX-me.left),y=Math.abs(e.screenY-me.top);clearTimeout(timeID);timeID=setTimeout(function(){if(y>0&&y<distanceY){me.setOpacity(el,"1");}else if(y>distanceY&&y<distanceY+70){me.setOpacity(el,"0.5");flag=false;}else if(y>distanceY+70&&y<distanceY+140){me.hide();}if(flag&&x>0&&x<distanceX){me.setOpacity(el,"1");}else if(x>distanceX&&x<distanceX+70){me.setOpacity(el,"0.5");}else if(x>distanceX+70&&x<distanceX+140){me.hide();}});}});if(browser.chrome){domUtils.on(doc,"mouseout",function(e){var relatedTgt=e.relatedTarget||e.toElement;if(relatedTgt==null||relatedTgt.tagName=="HTML"){me.hide();}});}me.editor.addListener("afterhidepop",function(){if(!me.isHidden){isSubMenuShow=true;}});},initItems:function initItems(){if(utils.isArray(this.items)){for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i].toLowerCase();if(UI[item]){this.items[i]=new UI[item](this.editor);this.items[i].className+=" edui-shortcutsubmenu ";}}}},setOpacity:function setOpacity(el,value){if(browser.ie&&browser.version<9){el.style.filter="alpha(opacity = "+parseFloat(value)*100+");";}else{el.style.opacity=value;}},getSubMenuMark:function getSubMenuMark(){isSubMenuShow=false;var layerEle=uiUtils.getFixedLayer();var list=domUtils.getElementsByTagName(layerEle,"div",function(node){return domUtils.hasClass(node,"edui-shortcutsubmenu edui-popup");});for(var i=0,node;node=list[i++];){if(node.style.display!="none"){isSubMenuShow=true;}}return isSubMenuShow;},show:function show(e,hasContextmenu){var me=this,offset={},el=this.getDom(),fixedlayer=uiUtils.getFixedLayer();function setPos(offset){if(offset.left<0){offset.left=0;}if(offset.top<0){offset.top=0;}el.style.cssText="position:absolute;left:"+offset.left+"px;top:"+offset.top+"px;";}function setPosByCxtMenu(menu){if(!menu.tagName){menu=menu.getDom();}offset.left=parseInt(menu.style.left);offset.top=parseInt(menu.style.top);offset.top-=el.offsetHeight+15;setPos(offset);}me.eventType=e.type;el.style.cssText="display:block;left:-9999px";if(e.type=="contextmenu"&&hasContextmenu){var menu=domUtils.getElementsByTagName(fixedlayer,"div","edui-contextmenu")[0];if(menu){setPosByCxtMenu(menu);}else{me.editor.addListener("aftershowcontextmenu",function(type,menu){setPosByCxtMenu(menu);});}}else{offset=uiUtils.getViewportOffsetByEvent(e);offset.top-=el.offsetHeight+me.SPACE;offset.left+=me.SPACE+20;setPos(offset);me.setOpacity(el,0.2);}me.isHidden=false;me.left=e.screenX+el.offsetWidth/2-me.SPACE;me.top=e.screenY-el.offsetHeight/2-me.SPACE;if(me.editor){el.style.zIndex=me.editor.container.style.zIndex*1+10;fixedlayer.style.zIndex=el.style.zIndex-1;}},hide:function hide(){if(this.getDom()){this.getDom().style.display="none";}this.isHidden=true;},postRender:function postRender(){if(utils.isArray(this.items)){for(var i=0,item;item=this.items[i++];){item.postRender();}}},getHtmlTpl:function getHtmlTpl(){var buff;if(utils.isArray(this.items)){buff=[];for(var i=0;i<this.items.length;i++){buff[i]=this.items[i].renderHtml();}buff=buff.join("");}else{buff=this.items;}return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+buff+'</div>';}};utils.inherits(ShortCutMenu,UIBase);function hideAllMenu(e){var tgt=e.target||e.srcElement,cur=domUtils.findParent(tgt,function(node){return domUtils.hasClass(node,"edui-shortcutmenu")||domUtils.hasClass(node,"edui-popup");},true);if(!cur){for(var i=0,menu;menu=allMenus[i++];){menu.hide();}}}domUtils.on(document,'mousedown',function(e){hideAllMenu(e);});domUtils.on(window,'scroll',function(e){hideAllMenu(e);});})();(function(){var utils=baidu.editor.utils,UIBase=baidu.editor.ui.UIBase,Breakline=baidu.editor.ui.Breakline=function(options){this.initOptions(options);this.initSeparator();};Breakline.prototype={uiName:'Breakline',initSeparator:function initSeparator(){this.initUIBase();},getHtmlTpl:function getHtmlTpl(){return'<br/>';}};utils.inherits(Breakline,UIBase);})();(function(){var utils=baidu.editor.utils,domUtils=baidu.editor.dom.domUtils,UIBase=baidu.editor.ui.UIBase,Message=baidu.editor.ui.Message=function(options){this.initOptions(options);this.initMessage();};Message.prototype={initMessage:function initMessage(){this.initUIBase();},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="edui-message %%">'+' <div id="##_closer" class="edui-message-closer"></div>'+' <div id="##_body" class="edui-message-body edui-message-type-info">'+' <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe>'+' <div class="edui-shadow"></div>'+' <div id="##_content" class="edui-message-content">'+'  </div>'+' </div>'+'</div>';},reset:function reset(opt){var me=this;if(!opt.keepshow){clearTimeout(this.timer);me.timer=setTimeout(function(){me.hide();},opt.timeout||4000);}opt.content!==undefined&&me.setContent(opt.content);opt.type!==undefined&&me.setType(opt.type);me.show();},postRender:function postRender(){var me=this,closer=this.getDom('closer');closer&&domUtils.on(closer,'click',function(){me.hide();});},setContent:function setContent(content){this.getDom('content').innerHTML=content;},setType:function setType(type){type=type||'info';var body=this.getDom('body');body.className=body.className.replace(/edui-message-type-[\w-]+/,'edui-message-type-'+type);},getContent:function getContent(){return this.getDom('content').innerHTML;},getType:function getType(){var arr=this.getDom('body').match(/edui-message-type-([\w-]+)/);return arr?arr[1]:'';},show:function show(){this.getDom().style.display='block';},hide:function hide(){var dom=this.getDom();if(dom){dom.style.display='none';dom.parentNode&&dom.parentNode.removeChild(dom);}}};utils.inherits(Message,UIBase);})();(function(){var utils=baidu.editor.utils;var editorui=baidu.editor.ui;var _Dialog=editorui.Dialog;editorui.buttons={};editorui.Dialog=function(options){var dialog=new _Dialog(options);dialog.addListener('hide',function(){if(dialog.editor){var editor=dialog.editor;try{if(browser.gecko){var y=editor.window.scrollY,x=editor.window.scrollX;editor.body.focus();editor.window.scrollTo(x,y);}else{editor.focus();}}catch(ex){}}});return dialog;};var iframeUrlMap={'anchor':'~/dialogs/anchor/anchor.html','insertimage':'~/dialogs/image/image.html','link':'~/dialogs/link/link.html','spechars':'~/dialogs/spechars/spechars.html','searchreplace':'~/dialogs/searchreplace/searchreplace.html','map':'~/dialogs/map/map.html','gmap':'~/dialogs/gmap/gmap.html','insertvideo':'~/dialogs/video/video.html','help':'~/dialogs/help/help.html','preview':'~/dialogs/preview/preview.html','emotion':'~/dialogs/emotion/emotion.html','wordimage':'~/dialogs/wordimage/wordimage.html','attachment':'~/dialogs/attachment/attachment.html','insertframe':'~/dialogs/insertframe/insertframe.html','edittip':'~/dialogs/table/edittip.html','edittable':'~/dialogs/table/edittable.html','edittd':'~/dialogs/table/edittd.html','webapp':'~/dialogs/webapp/webapp.html','snapscreen':'~/dialogs/snapscreen/snapscreen.html','scrawl':'~/dialogs/scrawl/scrawl.html','music':'~/dialogs/music/music.html','template':'~/dialogs/template/template.html','background':'~/dialogs/background/background.html','charts':'~/dialogs/charts/charts.html'};var btnCmds=['undo','redo','formatmatch','bold','italic','underline','fontborder','touppercase','tolowercase','strikethrough','subscript','superscript','source','indent','outdent','blockquote','pasteplain','pagebreak','selectall','print','horizontal','removeformat','time','date','unlink','insertparagraphbeforetable','insertrow','insertcol','mergeright','mergedown','deleterow','deletecol','splittorows','splittocols','splittocells','mergecells','deletetable','drafts'];for(var i=0,ci;ci=btnCmds[i++];){ci=ci.toLowerCase();editorui[ci]=function(cmd){return function(editor){var ui=new editorui.Button({className:'edui-for-'+cmd,title:editor.options.labelMap[cmd]||editor.getLang("labelMap."+cmd)||'',onclick:function onclick(){editor.execCommand(cmd);},theme:editor.options.theme,showText:false});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){var state=editor.queryCommandState(cmd);if(state==-1){ui.setDisabled(true);ui.setChecked(false);}else{if(!uiReady){ui.setDisabled(false);ui.setChecked(state);}}});return ui;};}(ci);}
editorui.cleardoc=function(editor){var ui=new editorui.Button({className:'edui-for-cleardoc',title:editor.options.labelMap.cleardoc||editor.getLang("labelMap.cleardoc")||'',theme:editor.options.theme,onclick:function onclick(){if(confirm(editor.getLang("confirmClear"))){editor.execCommand('cleardoc');}}});editorui.buttons["cleardoc"]=ui;editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState('cleardoc')==-1);});return ui;};var typeset={'justify':['left','right','center','justify'],'imagefloat':['none','left','center','right'],'directionality':['ltr','rtl']};for(var p in typeset){(function(cmd,val){for(var i=0,ci;ci=val[i++];){(function(cmd2){editorui[cmd.replace('float','')+cmd2]=function(editor){var ui=new editorui.Button({className:'edui-for-'+cmd.replace('float','')+cmd2,title:editor.options.labelMap[cmd.replace('float','')+cmd2]||editor.getLang("labelMap."+cmd.replace('float','')+cmd2)||'',theme:editor.options.theme,onclick:function onclick(){editor.execCommand(cmd,cmd2);}});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){ui.setDisabled(editor.queryCommandState(cmd)==-1);ui.setChecked(editor.queryCommandValue(cmd)==cmd2&&!uiReady);});return ui;};})(ci);}})(p,typeset[p]);}
for(var i=0,ci;ci=['backcolor','forecolor'][i++];){editorui[ci]=function(cmd){return function(editor){var ui=new editorui.ColorButton({className:'edui-for-'+cmd,color:'default',title:editor.options.labelMap[cmd]||editor.getLang("labelMap."+cmd)||'',editor:editor,onpickcolor:function onpickcolor(t,color){editor.execCommand(cmd,color);},onpicknocolor:function onpicknocolor(){editor.execCommand(cmd,'default');this.setColor('transparent');this.color='default';},onbuttonclick:function onbuttonclick(){editor.execCommand(cmd,this.color);}});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState(cmd)==-1);});return ui;};}(ci);}var dialogBtns={noOk:['searchreplace','help','spechars','webapp','preview'],ok:['attachment','anchor','link','insertimage','map','gmap','insertframe','wordimage','insertvideo','insertframe','edittip','edittable','edittd','scrawl','template','music','background','charts']};for(var p in dialogBtns){(function(type,vals){for(var i=0,ci;ci=vals[i++];){if(browser.opera&&ci==="searchreplace"){continue;}(function(cmd){editorui[cmd]=function(editor,iframeUrl,title){iframeUrl=iframeUrl||(editor.options.iframeUrlMap||{})[cmd]||iframeUrlMap[cmd];title=editor.options.labelMap[cmd]||editor.getLang("labelMap."+cmd)||'';var dialog;if(iframeUrl){dialog=new editorui.Dialog(utils.extend({iframeUrl:editor.ui.mapUrl(iframeUrl),editor:editor,className:'edui-for-'+cmd,title:title,holdScroll:cmd==='insertimage',fullscreen:/charts|preview/.test(cmd),closeDialog:editor.getLang("closeDialog")},type=='ok'?{buttons:[{className:'edui-okbutton',label:editor.getLang("ok"),editor:editor,onclick:function onclick(){dialog.close(true);}},{className:'edui-cancelbutton',label:editor.getLang("cancel"),editor:editor,onclick:function onclick(){dialog.close(false);}}]}:{}));editor.ui._dialogs[cmd+"Dialog"]=dialog;}var ui=new editorui.Button({className:'edui-for-'+cmd,title:title,onclick:function onclick(){if(dialog){switch(cmd){case"wordimage":var images=editor.execCommand("wordimage");if(images&&images.length){dialog.render();dialog.open();}break;case"scrawl":if(editor.queryCommandState("scrawl")!=-1){dialog.render();dialog.open();}break;default:dialog.render();dialog.open();}}},theme:editor.options.theme,disabled:cmd=='scrawl'&&editor.queryCommandState("scrawl")==-1||cmd=='charts'});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(){var unNeedCheckState={'edittable':1};if(cmd in unNeedCheckState)return;var state=editor.queryCommandState(cmd);if(ui.getDom()){ui.setDisabled(state==-1);ui.setChecked(state);}});return ui;};})(ci.toLowerCase());}})(p,dialogBtns[p]);}editorui.snapscreen=function(editor,iframeUrl,title){title=editor.options.labelMap['snapscreen']||editor.getLang("labelMap.snapscreen")||'';var ui=new editorui.Button({className:'edui-for-snapscreen',title:title,onclick:function onclick(){editor.execCommand("snapscreen");},theme:editor.options.theme});editorui.buttons['snapscreen']=ui;iframeUrl=iframeUrl||(editor.options.iframeUrlMap||{})["snapscreen"]||iframeUrlMap["snapscreen"];if(iframeUrl){var dialog=new editorui.Dialog({iframeUrl:editor.ui.mapUrl(iframeUrl),editor:editor,className:'edui-for-snapscreen',title:title,buttons:[{className:'edui-okbutton',label:editor.getLang("ok"),editor:editor,onclick:function onclick(){dialog.close(true);}},{className:'edui-cancelbutton',label:editor.getLang("cancel"),editor:editor,onclick:function onclick(){dialog.close(false);}}]});dialog.render();editor.ui._dialogs["snapscreenDialog"]=dialog;}editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState('snapscreen')==-1);});return ui;};editorui.insertcode=function(editor,list,title){list=editor.options['insertcode']||[];title=editor.options.labelMap['insertcode']||editor.getLang("labelMap.insertcode")||'';var items=[];utils.each(list,function(key,val){items.push({label:key,value:val,theme:editor.options.theme,renderLabelHtml:function renderLabelHtml(){return'<div class="edui-label %%-label" >'+(this.label||'')+'</div>';}});});var ui=new editorui.Combox({editor:editor,items:items,onselect:function onselect(t,index){editor.execCommand('insertcode',this.items[index].value);},onbuttonclick:function onbuttonclick(){this.showPopup();},title:title,initValue:title,className:'edui-for-insertcode',indexByValue:function indexByValue(value){if(value){for(var i=0,ci;ci=this.items[i];i++){if(ci.value.indexOf(value)!=-1)return i;}}return-1;}});editorui.buttons['insertcode']=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){if(!uiReady){var state=editor.queryCommandState('insertcode');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('insertcode');if(!value){ui.setValue(title);return;}
value&&(value=value.replace(/['"]/g,'').split(',')[0]);ui.setValue(value);}}});return ui;};editorui.fontfamily=function(editor,list,title){list=editor.options['fontfamily']||[];title=editor.options.labelMap['fontfamily']||editor.getLang("labelMap.fontfamily")||'';if(!list.length)return;for(var i=0,ci,items=[];ci=list[i];i++){var langLabel=editor.getLang('fontfamily')[ci.name]||"";(function(key,val){items.push({label:key,value:val,theme:editor.options.theme,renderLabelHtml:function renderLabelHtml(){return'<div class="edui-label %%-label" style="font-family:'+utils.unhtml(this.value)+'">'+(this.label||'')+'</div>';}});})(ci.label||langLabel,ci.val);}var ui=new editorui.Combox({editor:editor,items:items,onselect:function onselect(t,index){editor.execCommand('FontFamily',this.items[index].value);},onbuttonclick:function onbuttonclick(){this.showPopup();},title:title,initValue:title,className:'edui-for-fontfamily',indexByValue:function indexByValue(value){if(value){for(var i=0,ci;ci=this.items[i];i++){if(ci.value.indexOf(value)!=-1)return i;}}return-1;}});editorui.buttons['fontfamily']=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){if(!uiReady){var state=editor.queryCommandState('FontFamily');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('FontFamily');value&&(value=value.replace(/['"]/g,'').split(',')[0]);ui.setValue(value);}}});return ui;};editorui.fontsize=function(editor,list,title){title=editor.options.labelMap['fontsize']||editor.getLang("labelMap.fontsize")||'';list=list||editor.options['fontsize']||[];if(!list.length)return;var items=[];for(var i=0;i<list.length;i++){var size=list[i]+'px';items.push({label:size,value:size,theme:editor.options.theme,renderLabelHtml:function renderLabelHtml(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||'')+'</div>';}});}var ui=new editorui.Combox({editor:editor,items:items,title:title,initValue:title,onselect:function onselect(t,index){editor.execCommand('FontSize',this.items[index].value);},onbuttonclick:function onbuttonclick(){this.showPopup();},className:'edui-for-fontsize'});editorui.buttons['fontsize']=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){if(!uiReady){var state=editor.queryCommandState('FontSize');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);ui.setValue(editor.queryCommandValue('FontSize'));}}});return ui;};editorui.paragraph=function(editor,list,title){title=editor.options.labelMap['paragraph']||editor.getLang("labelMap.paragraph")||'';list=editor.options['paragraph']||[];if(utils.isEmptyObject(list))return;var items=[];for(var i in list){items.push({value:i,label:list[i]||editor.getLang("paragraph")[i],theme:editor.options.theme,renderLabelHtml:function renderLabelHtml(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||'')+'</span></div>';}});}var ui=new editorui.Combox({editor:editor,items:items,title:title,initValue:title,className:'edui-for-paragraph',onselect:function onselect(t,index){editor.execCommand('Paragraph',this.items[index].value);},onbuttonclick:function onbuttonclick(){this.showPopup();}});editorui.buttons['paragraph']=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){if(!uiReady){var state=editor.queryCommandState('Paragraph');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('Paragraph');var index=ui.indexByValue(value);if(index!=-1){ui.setValue(value);}else{ui.setValue(ui.initValue);}}}});return ui;};editorui.customstyle=function(editor){var list=editor.options['customstyle']||[],title=editor.options.labelMap['customstyle']||editor.getLang("labelMap.customstyle")||'';if(!list.length)return;var langCs=editor.getLang('customstyle');for(var i=0,items=[],t;t=list[i++];){(function(t){var ck={};ck.label=t.label?t.label:langCs[t.name];ck.style=t.style;ck.className=t.className;ck.tag=t.tag;items.push({label:ck.label,value:ck,theme:editor.options.theme,renderLabelHtml:function renderLabelHtml(){return'<div class="edui-label %%-label">'+'<'+ck.tag+' '+(ck.className?' class="'+ck.className+'"':"")+(ck.style?' style="'+ck.style+'"':"")+'>'+ck.label+"<\/"+ck.tag+">"+'</div>';}});})(t);}var ui=new editorui.Combox({editor:editor,items:items,title:title,initValue:title,className:'edui-for-customstyle',onselect:function onselect(t,index){editor.execCommand('customstyle',this.items[index].value);},onbuttonclick:function onbuttonclick(){this.showPopup();},indexByValue:function indexByValue(value){for(var i=0,ti;ti=this.items[i++];){if(ti.label==value){return i-1;}}return-1;}});editorui.buttons['customstyle']=ui;editor.addListener('selectionchange',function(type,causeByUi,uiReady){if(!uiReady){var state=editor.queryCommandState('customstyle');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('customstyle');var index=ui.indexByValue(value);if(index!=-1){ui.setValue(value);}else{ui.setValue(ui.initValue);}}}});return ui;};editorui.inserttable=function(editor,iframeUrl,title){title=editor.options.labelMap['inserttable']||editor.getLang("labelMap.inserttable")||'';var ui=new editorui.TableButton({editor:editor,title:title,className:'edui-for-inserttable',onpicktable:function onpicktable(t,numCols,numRows){editor.execCommand('InsertTable',{numRows:numRows,numCols:numCols,border:1});},onbuttonclick:function onbuttonclick(){this.showPopup();}});editorui.buttons['inserttable']=ui;editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState('inserttable')==-1);});return ui;};editorui.lineheight=function(editor){var val=editor.options.lineheight||[];if(!val.length)return;for(var i=0,ci,items=[];ci=val[i++];){items.push({label:ci,value:ci,theme:editor.options.theme,onclick:function onclick(){editor.execCommand("lineheight",this.value);}});}var ui=new editorui.MenuButton({editor:editor,className:'edui-for-lineheight',title:editor.options.labelMap['lineheight']||editor.getLang("labelMap.lineheight")||'',items:items,onbuttonclick:function onbuttonclick(){var value=editor.queryCommandValue('LineHeight')||this.value;editor.execCommand("LineHeight",value);}});editorui.buttons['lineheight']=ui;editor.addListener('selectionchange',function(){var state=editor.queryCommandState('LineHeight');if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('LineHeight');value&&ui.setValue((value+'').replace(/cm/,''));ui.setChecked(state);}});return ui;};var rowspacings=['top','bottom'];for(var r=0,ri;ri=rowspacings[r++];){(function(cmd){editorui['rowspacing'+cmd]=function(editor){var val=editor.options['rowspacing'+cmd]||[];if(!val.length)return null;for(var i=0,ci,items=[];ci=val[i++];){items.push({label:ci,value:ci,theme:editor.options.theme,onclick:function onclick(){editor.execCommand("rowspacing",this.value,cmd);}});}var ui=new editorui.MenuButton({editor:editor,className:'edui-for-rowspacing'+cmd,title:editor.options.labelMap['rowspacing'+cmd]||editor.getLang("labelMap.rowspacing"+cmd)||'',items:items,onbuttonclick:function onbuttonclick(){var value=editor.queryCommandValue('rowspacing',cmd)||this.value;editor.execCommand("rowspacing",value,cmd);}});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(){var state=editor.queryCommandState('rowspacing',cmd);if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue('rowspacing',cmd);value&&ui.setValue((value+'').replace(/%/,''));ui.setChecked(state);}});return ui;};})(ri);}
var lists=['insertorderedlist','insertunorderedlist'];for(var l=0,cl;cl=lists[l++];){(function(cmd){editorui[cmd]=function(editor){var vals=editor.options[cmd],_onMenuClick=function _onMenuClick(){editor.execCommand(cmd,this.value);},items=[];for(var i in vals){items.push({label:vals[i]||editor.getLang()[cmd][i]||"",value:i,theme:editor.options.theme,onclick:_onMenuClick});}var ui=new editorui.MenuButton({editor:editor,className:'edui-for-'+cmd,title:editor.getLang("labelMap."+cmd)||'','items':items,onbuttonclick:function onbuttonclick(){var value=editor.queryCommandValue(cmd)||this.value;editor.execCommand(cmd,value);}});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(){var state=editor.queryCommandState(cmd);if(state==-1){ui.setDisabled(true);}else{ui.setDisabled(false);var value=editor.queryCommandValue(cmd);ui.setValue(value);ui.setChecked(state);}});return ui;};})(cl);}editorui.fullscreen=function(editor,title){title=editor.options.labelMap['fullscreen']||editor.getLang("labelMap.fullscreen")||'';var ui=new editorui.Button({className:'edui-for-fullscreen',title:title,theme:editor.options.theme,onclick:function onclick(){if(editor.ui){editor.ui.setFullScreen(!editor.ui.isFullScreen());}this.setChecked(editor.ui.isFullScreen());}});editorui.buttons['fullscreen']=ui;editor.addListener('selectionchange',function(){var state=editor.queryCommandState('fullscreen');ui.setDisabled(state==-1);ui.setChecked(editor.ui.isFullScreen());});return ui;};editorui["emotion"]=function(editor,iframeUrl){var cmd="emotion";var ui=new editorui.MultiMenuPop({title:editor.options.labelMap[cmd]||editor.getLang("labelMap."+cmd+"")||'',editor:editor,className:'edui-for-'+cmd,iframeUrl:editor.ui.mapUrl(iframeUrl||(editor.options.iframeUrlMap||{})[cmd]||iframeUrlMap[cmd])});editorui.buttons[cmd]=ui;editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState(cmd)==-1);});return ui;};editorui.autotypeset=function(editor){var ui=new editorui.AutoTypeSetButton({editor:editor,title:editor.options.labelMap['autotypeset']||editor.getLang("labelMap.autotypeset")||'',className:'edui-for-autotypeset',onbuttonclick:function onbuttonclick(){editor.execCommand('autotypeset');}});editorui.buttons['autotypeset']=ui;editor.addListener('selectionchange',function(){ui.setDisabled(editor.queryCommandState('autotypeset')==-1);});return ui;};editorui["simpleupload"]=function(editor){var name='simpleupload',ui=new editorui.Button({className:'edui-for-'+name,title:editor.options.labelMap[name]||editor.getLang("labelMap."+name)||'',onclick:function onclick(){},theme:editor.options.theme,showText:false});editorui.buttons[name]=ui;editor.addListener('ready',function(){var b=ui.getDom('body'),iconSpan=b.children[0];editor.fireEvent('simpleuploadbtnready',iconSpan);});editor.addListener('selectionchange',function(type,causeByUi,uiReady){var state=editor.queryCommandState(name);if(state==-1){ui.setDisabled(true);ui.setChecked(false);}else{if(!uiReady){ui.setDisabled(false);ui.setChecked(state);}}});return ui;};})();(function(){var utils=baidu.editor.utils,uiUtils=baidu.editor.ui.uiUtils,UIBase=baidu.editor.ui.UIBase,domUtils=baidu.editor.dom.domUtils;var nodeStack=[];function EditorUI(options){this.initOptions(options);this.initEditorUI();}EditorUI.prototype={uiName:'editor',initEditorUI:function initEditorUI(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var editor=this.editor,me=this;editor.addListener('ready',function(){editor.getDialog=function(name){return editor.ui._dialogs[name+"Dialog"];};domUtils.on(editor.window,'scroll',function(evt){baidu.editor.ui.Popup.postHide(evt);});editor.ui._actualFrameWidth=editor.options.initialFrameWidth;UE.browser.ie&&UE.browser.version===6&&editor.container.ownerDocument.execCommand("BackgroundImageCache",false,true);if(editor.options.elementPathEnabled){editor.ui.getDom('elementpath').innerHTML='<div class="edui-editor-breadcrumb">'+editor.getLang("elementPathTip")+':</div>';}if(editor.options.wordCount){var countFn=function countFn(){setCount(editor,me);domUtils.un(editor.document,"click",arguments.callee);};domUtils.on(editor.document,"click",countFn);editor.ui.getDom('wordcount').innerHTML=editor.getLang("wordCountTip");}editor.ui._scale();if(editor.options.scaleEnabled){if(editor.autoHeightEnabled){editor.disableAutoHeight();}me.enableScale();}else{me.disableScale();}if(!editor.options.elementPathEnabled&&!editor.options.wordCount&&!editor.options.scaleEnabled){editor.ui.getDom('elementpath').style.display="none";editor.ui.getDom('wordcount').style.display="none";editor.ui.getDom('scale').style.display="none";}if(!editor.selection.isFocus())return;editor.fireEvent('selectionchange',false,true);});editor.addListener('mousedown',function(t,evt){var el=evt.target||evt.srcElement;baidu.editor.ui.Popup.postHide(evt,el);baidu.editor.ui.ShortCutMenu.postHide(evt);});editor.addListener("delcells",function(){if(UE.ui['edittip']){new UE.ui['edittip'](editor);}editor.getDialog('edittip').open();});var pastePop,isPaste=false,timer;editor.addListener("afterpaste",function(){if(editor.queryCommandState('pasteplain'))return;if(baidu.editor.ui.PastePicker){pastePop=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:editor}),editor:editor,className:'edui-wordpastepop'});pastePop.render();}isPaste=true;});editor.addListener("afterinserthtml",function(){clearTimeout(timer);timer=setTimeout(function(){if(pastePop&&(isPaste||editor.ui._isTransfer)){if(pastePop.isHidden()){var span=domUtils.createElement(editor.document,'span',{'style':"line-height:0px;",'innerHTML':'\uFEFF'}),range=editor.selection.getRange();range.insertNode(span);var tmp=getDomNode(span,'firstChild','previousSibling');tmp&&pastePop.showAnchor(tmp.nodeType==3?tmp.parentNode:tmp);domUtils.remove(span);}else{pastePop.show();}delete editor.ui._isTransfer;isPaste=false;}},200);});editor.addListener('contextmenu',function(t,evt){baidu.editor.ui.Popup.postHide(evt);});editor.addListener('keydown',function(t,evt){if(pastePop)pastePop.dispose(evt);var keyCode=evt.keyCode||evt.which;if(evt.altKey&&keyCode==90){UE.ui.buttons['fullscreen'].onclick();}});editor.addListener('wordcount',function(type){setCount(this,me);});function setCount(editor,ui){editor.setOpt({wordCount:true,maximumWords:10000,wordCountMsg:editor.options.wordCountMsg||editor.getLang("wordCountMsg"),wordOverFlowMsg:editor.options.wordOverFlowMsg||editor.getLang("wordOverFlowMsg")});var opt=editor.options,max=opt.maximumWords,msg=opt.wordCountMsg,errMsg=opt.wordOverFlowMsg,countDom=ui.getDom('wordcount');if(!opt.wordCount){return;}var count=editor.getContentLength(true);if(count>max){countDom.innerHTML=errMsg;editor.fireEvent("wordcountoverflow");}else{countDom.innerHTML=msg.replace("{#leave}",max-count).replace("{#count}",count);}}editor.addListener('selectionchange',function(){if(editor.options.elementPathEnabled){me[(editor.queryCommandState('elementpath')==-1?'dis':'en')+'ableElementPath']();}if(editor.options.scaleEnabled){me[(editor.queryCommandState('scale')==-1?'dis':'en')+'ableScale']();}});var popup=new baidu.editor.ui.Popup({editor:editor,content:'',className:'edui-bubble',_onEditButtonClick:function _onEditButtonClick(){this.hide();editor.ui._dialogs.linkDialog.open();},_onImgEditButtonClick:function _onImgEditButtonClick(name){this.hide();editor.ui._dialogs[name]&&editor.ui._dialogs[name].open();},_onImgSetFloat:function _onImgSetFloat(value){this.hide();editor.execCommand("imagefloat",value);},_setIframeAlign:function _setIframeAlign(value){var frame=popup.anchorEl;var newFrame=frame.cloneNode(true);switch(value){case-2:newFrame.setAttribute("align","");break;case-1:newFrame.setAttribute("align","left");break;case 1:newFrame.setAttribute("align","right");break;}frame.parentNode.insertBefore(newFrame,frame);domUtils.remove(frame);popup.anchorEl=newFrame;popup.showAnchor(popup.anchorEl);},_updateIframe:function _updateIframe(){var frame=editor._iframe=popup.anchorEl;if(domUtils.hasClass(frame,'ueditor_baidumap')){editor.selection.getRange().selectNode(frame).select();editor.ui._dialogs.mapDialog.open();popup.hide();}else{editor.ui._dialogs.insertframeDialog.open();popup.hide();}},_onRemoveButtonClick:function _onRemoveButtonClick(cmdName){editor.execCommand(cmdName);this.hide();},queryAutoHide:function queryAutoHide(el){if(el&&el.ownerDocument==editor.document){if(el.tagName.toLowerCase()=='img'||domUtils.findParentByTagName(el,'a',true)){return el!==popup.anchorEl;}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,el);}});popup.render();if(editor.options.imagePopup){editor.addListener('mouseover',function(t,evt){evt=evt||window.event;var el=evt.target||evt.srcElement;if(editor.ui._dialogs.insertframeDialog&&/iframe/ig.test(el.tagName)){var html=popup.formatHtml('<nobr>'+editor.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+editor.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+editor.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+editor.getLang("justifyright")+'</span>&nbsp;&nbsp;'+' <span onclick="$$._updateIframe( this);" class="edui-clickable">'+editor.getLang("modify")+'</span></nobr>');if(html){popup.getDom('content').innerHTML=html;popup.anchorEl=el;popup.showAnchor(popup.anchorEl);}else{popup.hide();}}});editor.addListener('selectionchange',function(t,causeByUi){if(!causeByUi)return;var html='',str="",img=editor.selection.getRange().getClosedNode(),dialogs=editor.ui._dialogs;if(img&&img.tagName=='IMG'){var dialogName='insertimageDialog';if(img.className.indexOf("edui-faked-video")!=-1||img.className.indexOf("edui-upload-video")!=-1){dialogName="insertvideoDialog";}if(img.className.indexOf("edui-faked-webapp")!=-1){dialogName="webappDialog";}if(img.src.indexOf("http://api.map.baidu.com")!=-1){dialogName="mapDialog";}if(img.className.indexOf("edui-faked-music")!=-1){dialogName="musicDialog";}if(img.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){dialogName="gmapDialog";}if(img.getAttribute("anchorname")){dialogName="anchorDialog";html=popup.formatHtml('<nobr>'+editor.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+editor.getLang("modify")+'</span>&nbsp;&nbsp;'+'<span onclick=$$._onRemoveButtonClick(\'anchor\') class="edui-clickable">'+editor.getLang("delete")+'</span></nobr>');}if(img.getAttribute("word_img")){editor.word_img=[img.getAttribute("word_img")];dialogName="wordimageDialog";}if(domUtils.hasClass(img,'loadingclass')||domUtils.hasClass(img,'loaderrorclass')){dialogName="";}if(!dialogs[dialogName]){return;}str='<nobr>'+editor.getLang("property")+': '+'<span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+editor.getLang("default")+'</span>&nbsp;&nbsp;'+'<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+editor.getLang("justifyleft")+'</span>&nbsp;&nbsp;'+'<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+editor.getLang("justifyright")+'</span>&nbsp;&nbsp;'+'<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+editor.getLang("justifycenter")+'</span>&nbsp;&nbsp;'+'<span onclick="$$._onImgEditButtonClick(\''+dialogName+'\');" class="edui-clickable">'+editor.getLang("modify")+'</span></nobr>';!html&&(html=popup.formatHtml(str));}if(editor.ui._dialogs.linkDialog){var link=editor.queryCommandValue('link');var url;if(link&&(url=link.getAttribute('_href')||link.getAttribute('href',2))){var txt=url;if(url.length>30){txt=url.substring(0,20)+"...";}if(html){html+='<div style="height:5px;"></div>';}html+=popup.formatHtml('<nobr>'+editor.getLang("anthorMsg")+': <a target="_blank" href="'+url+'" title="'+url+'" >'+txt+'</a>'+' <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+editor.getLang("modify")+'</span>'+' <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+editor.getLang("clear")+'</span></nobr>');popup.showAnchor(link);}}if(html){popup.getDom('content').innerHTML=html;popup.anchorEl=img||link;popup.showAnchor(popup.anchorEl);}else{popup.hide();}});}},_initToolbars:function _initToolbars(){var editor=this.editor;var toolbars=this.toolbars||[];var toolbarUis=[];for(var i=0;i<toolbars.length;i++){var toolbar=toolbars[i];var toolbarUi=new baidu.editor.ui.Toolbar({theme:editor.options.theme});for(var j=0;j<toolbar.length;j++){var toolbarItem=toolbar[j];var toolbarItemUi=null;if(typeof toolbarItem=='string'){toolbarItem=toolbarItem.toLowerCase();if(toolbarItem=='|'){toolbarItem='Separator';}if(toolbarItem=='||'){toolbarItem='Breakline';}if(baidu.editor.ui[toolbarItem]){toolbarItemUi=new baidu.editor.ui[toolbarItem](editor);}
if(toolbarItem=='fullscreen'){if(toolbarUis&&toolbarUis[0]){toolbarUis[0].items.splice(0,0,toolbarItemUi);}else{toolbarItemUi&&toolbarUi.items.splice(0,0,toolbarItemUi);}continue;}}else{toolbarItemUi=toolbarItem;}if(toolbarItemUi&&toolbarItemUi.id){toolbarUi.add(toolbarItemUi);}}toolbarUis[i]=toolbarUi;}
utils.each(UE._customizeUI,function(obj,key){var itemUI,index;if(obj.id&&obj.id!=editor.key){return false;}itemUI=obj.execFn.call(editor,editor,key);if(itemUI){index=obj.index;if(index===undefined){index=toolbarUi.items.length;}toolbarUi.add(itemUI,index);}});this.toolbars=toolbarUis;},getHtmlTpl:function getHtmlTpl(){return'<div id="##" class="%%">'+'<div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div>':'')+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;">'+'<div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div>'+'<div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div>'+'<div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div>'+'<div style="height:0;overflow:hidden;clear:both;"></div>'+'</div>'+'<div id="##_message_holder" class="%%-messageholder"></div>'+'</div>'+'<div id="##_iframeholder" class="%%-iframeholder">'+'</div>'+'<div id="##_bottombar" class="%%-bottomContainer"><table><tr>'+'<td id="##_elementpath" class="%%-bottombar"></td>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+'<td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td>'+'</tr></table></div>'+'<div id="##_scalelayer"></div>'+'</div>';},showWordImageDialog:function showWordImageDialog(){this._dialogs['wordimageDialog'].open();},renderToolbarBoxHtml:function renderToolbarBoxHtml(){var buff=[];for(var i=0;i<this.toolbars.length;i++){buff.push(this.toolbars[i].renderHtml());}return buff.join('');},setFullScreen:function setFullScreen(fullscreen){var editor=this.editor,container=editor.container.parentNode.parentNode;if(this._fullscreen!=fullscreen){this._fullscreen=fullscreen;this.editor.fireEvent('beforefullscreenchange',fullscreen);if(baidu.editor.browser.gecko){var bk=editor.selection.getRange().createBookmark();}if(fullscreen){while(container.tagName!="BODY"){var position=baidu.editor.dom.domUtils.getComputedStyle(container,"position");nodeStack.push(position);container.style.position="static";container=container.parentNode;}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=editor.iframe.parentNode.offsetWidth;if(this._bakAutoHeight){editor.autoHeightEnabled=false;this.editor.disableAutoHeight();}document.documentElement.style.overflow='hidden';window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom('iframeholder').style.cssText;editor.iframe.parentNode.style.width='';this._updateFullScreen();}else{while(container.tagName!="BODY"){container.style.position=nodeStack.shift();container=container.parentNode;}this.getDom().style.cssText=this._bakCssText;this.getDom('iframeholder').style.cssText=this._bakCssText1;if(this._bakAutoHeight){editor.autoHeightEnabled=true;this.editor.enableAutoHeight();}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;editor.iframe.parentNode.style.width=this._bakEditorContaninerWidth+'px';window.scrollTo(0,this._bakScrollTop);}if(browser.gecko&&editor.body.contentEditable==='true'){var input=document.createElement('input');document.body.appendChild(input);editor.body.contentEditable=false;setTimeout(function(){input.focus();setTimeout(function(){editor.body.contentEditable=true;editor.fireEvent('fullscreenchanged',fullscreen);editor.selection.getRange().moveToBookmark(bk).select(true);baidu.editor.dom.domUtils.remove(input);fullscreen&&window.scroll(0,0);},0);},0);}if(editor.body.contentEditable==='true'){this.editor.fireEvent('fullscreenchanged',fullscreen);this.triggerLayout();}}},_updateFullScreen:function _updateFullScreen(){if(this._fullscreen){var vpRect=uiUtils.getViewportRect();this.getDom().style.cssText='border:0;position:absolute;left:0;top:'+(this.editor.options.topOffset||0)+'px;width:'+vpRect.width+'px;height:'+vpRect.height+'px;z-index:'+(this.getDom().style.zIndex*1+100);uiUtils.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(vpRect.height-this.getDom('toolbarbox').offsetHeight-this.getDom('bottombar').offsetHeight-(this.editor.options.topOffset||0),true);if(browser.gecko){try{window.onresize();}catch(e){}}}},_updateElementPath:function _updateElementPath(){var bottom=this.getDom('elementpath'),list;if(this.elementPathEnabled&&(list=this.editor.queryCommandValue('elementpath'))){var buff=[];for(var i=0,ci;ci=list[i];i++){buff[i]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+i+'&quot;);">'+ci+'</span>');}bottom.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+': '+buff.join(' &gt; ')+'</div>';}else{bottom.style.display='none';}},disableElementPath:function disableElementPath(){var bottom=this.getDom('elementpath');bottom.innerHTML='';bottom.style.display='none';this.elementPathEnabled=false;},enableElementPath:function enableElementPath(){var bottom=this.getDom('elementpath');bottom.style.display='';this.elementPathEnabled=true;this._updateElementPath();},_scale:function _scale(){var doc=document,editor=this.editor,editorHolder=editor.container,editorDocument=editor.document,toolbarBox=this.getDom("toolbarbox"),bottombar=this.getDom("bottombar"),scale=this.getDom("scale"),scalelayer=this.getDom("scalelayer");var isMouseMove=false,position=null,minEditorHeight=0,minEditorWidth=editor.options.minFrameWidth,pageX=0,pageY=0,scaleWidth=0,scaleHeight=0;function down(){position=domUtils.getXY(editorHolder);if(!minEditorHeight){minEditorHeight=editor.options.minFrameHeight+toolbarBox.offsetHeight+bottombar.offsetHeight;}scalelayer.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+editorHolder.offsetWidth+"px;height:"+editorHolder.offsetHeight+"px;z-index:"+(editor.options.zIndex+1);domUtils.on(doc,"mousemove",move);domUtils.on(editorDocument,"mouseup",up);domUtils.on(doc,"mouseup",up);}var me=this;this.editor.addListener('fullscreenchanged',function(e,fullScreen){if(fullScreen){me.disableScale();}else{if(me.editor.options.scaleEnabled){me.enableScale();var tmpNode=me.editor.document.createElement('span');me.editor.body.appendChild(tmpNode);me.editor.body.style.height=Math.max(domUtils.getXY(tmpNode).y,me.editor.iframe.offsetHeight-20)+'px';domUtils.remove(tmpNode);}}});function move(event){clearSelection();var e=event||window.event;pageX=e.pageX||doc.documentElement.scrollLeft+e.clientX;pageY=e.pageY||doc.documentElement.scrollTop+e.clientY;scaleWidth=pageX-position.x;scaleHeight=pageY-position.y;if(scaleWidth>=minEditorWidth){isMouseMove=true;scalelayer.style.width=scaleWidth+'px';}if(scaleHeight>=minEditorHeight){isMouseMove=true;scalelayer.style.height=scaleHeight+"px";}}function up(){if(isMouseMove){isMouseMove=false;editor.ui._actualFrameWidth=scalelayer.offsetWidth-2;editorHolder.style.width=editor.ui._actualFrameWidth+'px';editor.setHeight(scalelayer.offsetHeight-bottombar.offsetHeight-toolbarBox.offsetHeight-2,true);}if(scalelayer){scalelayer.style.display="none";}clearSelection();domUtils.un(doc,"mousemove",move);domUtils.un(editorDocument,"mouseup",up);domUtils.un(doc,"mouseup",up);}function clearSelection(){if(browser.ie)doc.selection.clear();else window.getSelection().removeAllRanges();}this.enableScale=function(){if(editor.queryCommandState("source")==1)return;scale.style.display="";this.scaleEnabled=true;domUtils.on(scale,"mousedown",down);};this.disableScale=function(){scale.style.display="none";this.scaleEnabled=false;domUtils.un(scale,"mousedown",down);};},isFullScreen:function isFullScreen(){return this._fullscreen;},postRender:function postRender(){UIBase.prototype.postRender.call(this);for(var i=0;i<this.toolbars.length;i++){this.toolbars[i].postRender();}var me=this;var timerId,domUtils=baidu.editor.dom.domUtils,updateFullScreenTime=function updateFullScreenTime(){clearTimeout(timerId);timerId=setTimeout(function(){me._updateFullScreen();});};domUtils.on(window,'resize',updateFullScreenTime);me.addListener('destroy',function(){domUtils.un(window,'resize',updateFullScreenTime);clearTimeout(timerId);});},showToolbarMsg:function showToolbarMsg(msg,flag){this.getDom('toolbarmsg_label').innerHTML=msg;this.getDom('toolbarmsg').style.display='';if(!flag){var w=this.getDom('upload_dialog');w.style.display='none';}},hideToolbarMsg:function hideToolbarMsg(){this.getDom('toolbarmsg').style.display='none';},mapUrl:function mapUrl(url){return url?url.replace('~/',this.editor.options.UEDITOR_HOME_URL||''):'';},triggerLayout:function triggerLayout(){var dom=this.getDom();if(dom.style.zoom=='1'){dom.style.zoom='100%';}else{dom.style.zoom='1';}}};utils.inherits(EditorUI,baidu.editor.ui.UIBase);var instances={};UE.ui.Editor=function(options){var editor=new UE.Editor(options);editor.options.editor=editor;utils.loadFile(document,{href:editor.options.themePath+editor.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var oldRender=editor.render;editor.render=function(holder){if(holder.constructor===String){editor.key=holder;instances[holder]=editor;}utils.domReady(function(){editor.langIsReady?renderUI():editor.addListener("langReady",renderUI);function renderUI(){editor.setOpt({labelMap:editor.options.labelMap||editor.getLang('labelMap')});new EditorUI(editor.options);if(holder){if(holder.constructor===String){holder=document.getElementById(holder);}holder&&holder.getAttribute('name')&&(editor.options.textarea=holder.getAttribute('name'));if(holder&&/script|textarea/ig.test(holder.tagName)){var newDiv=document.createElement('div');holder.parentNode.insertBefore(newDiv,holder);var cont=holder.value||holder.innerHTML;editor.options.initialContent=/^[\t\r\n ]*$/.test(cont)?editor.options.initialContent:cont.replace(/>[\n\r\t]+([ ]{4})+/g,'>').replace(/[\n\r\t]+([ ]{4})+</g,'<').replace(/>[\n\r\t]+</g,'><');holder.className&&(newDiv.className=holder.className);holder.style.cssText&&(newDiv.style.cssText=holder.style.cssText);if(/textarea/i.test(holder.tagName)){editor.textarea=holder;editor.textarea.style.display='none';}else{holder.parentNode.removeChild(holder);}if(holder.id){newDiv.id=holder.id;domUtils.removeAttributes(holder,'id');}holder=newDiv;holder.innerHTML='';}}domUtils.addClass(holder,"edui-"+editor.options.theme);editor.ui.render(holder);var opt=editor.options;editor.container=editor.ui.getDom();var parents=domUtils.findParents(holder,true);var displays=[];for(var i=0,ci;ci=parents[i];i++){displays[i]=ci.style.display;ci.style.display='block';}if(opt.initialFrameWidth){opt.minFrameWidth=opt.initialFrameWidth;}else{opt.minFrameWidth=opt.initialFrameWidth=holder.offsetWidth;var styleWidth=holder.style.width;if(/%$/.test(styleWidth)){opt.initialFrameWidth=styleWidth;}}if(opt.initialFrameHeight){opt.minFrameHeight=opt.initialFrameHeight;}else{opt.initialFrameHeight=opt.minFrameHeight=holder.offsetHeight;}for(var i=0,ci;ci=parents[i];i++){ci.style.display=displays[i];}
if(holder.style.height){holder.style.height='';}editor.container.style.width=opt.initialFrameWidth+(/%$/.test(opt.initialFrameWidth)?'':'px');editor.container.style.zIndex=opt.zIndex;oldRender.call(editor,editor.ui.getDom('iframeholder'));editor.fireEvent("afteruiready");}});};return editor;};UE.getEditor=function(id,opt){var editor=instances[id];if(!editor){editor=instances[id]=new UE.ui.Editor(opt);editor.render(id);}return editor;};UE.delEditor=function(id){var editor;if(editor=instances[id]){editor.key&&editor.destroy();delete instances[id];}};UE.insertPic=function(ueditor){if(!ueditor)return;var bodyEditor=ueditor.body;var btnInsertPic=ueditor.container.querySelector('.edui-for-simpleupload');var input=document.createElement('input');var range;input.type='file';input.accept="image/*";input.style.display="none";btnInsertPic.appendChild(input);bodyEditor.onclick=function(){range=ueditor.window.getSelection().getRangeAt(0);};if(typeof FileReader==='undefined'){alert(" FileReader");input.setAttribute('disabled','disabled');}else{input.addEventListener('change',readFile,false);}btnInsertPic.onclick=function(e){input.click();e.stopPropagation();};function readFile(e){e.stopPropagation();var file=this.files[0];if(!/image\/\w+/.test(file.type)){alert("");return false;}var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(e){var img=document.createElement('img');img.src=this.result;if(range){range.insertNode(img);}else{bodyEditor.appendChild(img);}};}};UE.registerUI=function(uiName,fn,index,editorId){utils.each(uiName.split(/\s+/),function(name){UE._customizeUI[name]={id:editorId,execFn:fn,index:index};});};})();UE.registerUI('message',function(editor){var editorui=baidu.editor.ui;var Message=editorui.Message;var holder;var _messageItems=[];var me=editor;me.addListener('ready',function(){holder=document.getElementById(me.ui.id+'_message_holder');updateHolderPos();setTimeout(function(){updateHolderPos();},500);});me.addListener('showmessage',function(type,opt){opt=utils.isString(opt)?{'content':opt}:opt;var message=new Message({'timeout':opt.timeout,'type':opt.type,'content':opt.content,'keepshow':opt.keepshow,'editor':me}),mid=opt.id||'msg_'+(+new Date()).toString(36);message.render(holder);_messageItems[mid]=message;message.reset(opt);updateHolderPos();return mid;});me.addListener('updatemessage',function(type,id,opt){opt=utils.isString(opt)?{'content':opt}:opt;var message=_messageItems[id];message.render(holder);message&&message.reset(opt);});me.addListener('hidemessage',function(type,id){var message=_messageItems[id];message&&message.hide();});function updateHolderPos(){var toolbarbox=me.ui.getDom('toolbarbox');if(toolbarbox){holder.style.top=toolbarbox.offsetHeight+3+'px';}holder.style.zIndex=Math.max(me.options.zIndex,me.iframe.style.zIndex)+1;}});UE.registerUI('autosave',function(editor){var timer=null,uid=null;editor.on('afterautosave',function(){clearTimeout(timer);timer=setTimeout(function(){if(uid){editor.trigger('hidemessage',uid);}uid=editor.trigger('showmessage',{content:editor.getLang('autosave.success'),timeout:50000});},50000);});});})();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(root,factory){if((typeof exports==='undefined'?'undefined':_typeof(exports))=='object')module.exports=factory();else if(typeof define=='function'&&define.amd)define(factory);else root.LoadingSpinner=factory();})(this,function(){"use strict";var prefixes=['webkit','Moz','ms','O'],animations={},useCssAnimations;function createEl(tag,prop){var el=document.createElement(tag||'div'),n;for(n in prop){el[n]=prop[n];}return el;}
function ins(parent){for(var i=1,n=arguments.length;i<n;i++){parent.appendChild(arguments[i]);}return parent;}
var sheet=function(){var el=createEl('style',{type:'text/css'});ins(document.getElementsByTagName('head')[0],el);return el.sheet||el.styleSheet;}();function addAnimation(alpha,trail,i,lines){var name=['opacity',trail,~~(alpha*100),i,lines].join('-'),start=0.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf('Animation')).toLowerCase(),pre=prefix&&'-'+prefix+'-'||'';if(!animations[name]){sheet.insertRule('@'+pre+'keyframes '+name+'{'+'0%{opacity:'+z+'}'+start+'%{opacity:'+alpha+'}'+(start+0.01)+'%{opacity:1}'+(start+trail)%100+'%{opacity:'+alpha+'}'+'100%{opacity:'+z+'}'+'}',sheet.cssRules.length);animations[name]=1;}
return name;}
function vendor(el,prop){var s=el.style,pp,i;prop=prop.charAt(0).toUpperCase()+prop.slice(1);for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop;if(s[pp]!==undefined)return pp;}
if(s[prop]!==undefined)return prop;}
function css(el,prop){for(var n in prop){el.style[vendor(el,n)||n]=prop[n];}return el;}
function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def){if(obj[n]===undefined)obj[n]=def[n];}}
return obj;}
function pos(el){var o={x:el.offsetLeft,y:el.offsetTop};while(el=el.offsetParent){o.x+=el.offsetLeft,o.y+=el.offsetTop;}return o;}
function getColor(color,idx){return typeof color=='string'?color:color[idx%color.length];}
var defaults={lines:12,length:10,width:5,radius:15,rotate:0,corners:1,color:'#000',direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:1001,className:'spinner',top:'50%',left:'50%',position:'absolute'};function LoadingSpinner(o){this.opts=merge(o||{},LoadingSpinner.defaults,defaults);}
LoadingSpinner.defaults={};merge(LoadingSpinner.prototype,{spin:function spin(target){this.stop();this.opts.target=target;var divMask=document.createElement("div");divMask.className="spinnerMask";divMask.style.width=target.width;divMask.style.height=target.height;target.appendChild(divMask);this.divMask=divMask;var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width;css(el,{left:o.left,top:o.top});if(target){target.insertBefore(el,target.firstChild||null);}
el.setAttribute('role','progressbar');self.lines(el,self.opts);if(!useCssAnimations){var i=0,start=(o.lines-1)*(1-o.direction)/2,alpha,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var j=0;j<o.lines;j++){alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity);self.opacity(el,j*o.direction+start,alpha,o);}
self.timeout=self.el&&setTimeout(anim,~~(1000/fps));})();}
return self;},stop:function stop(){var el=this.el;if(el){clearTimeout(this.timeout);if(el.parentNode)el.parentNode.removeChild(el);this.el=undefined;if(this.divMask){if(this.divMask.parentNode)this.divMask.parentNode.removeChild(this.divMask);this.el=undefined;}}
return this;},lines:function lines(el,o){var i=0,start=(o.lines-1)*(1-o.direction)/2,seg;function fill(color,shadow){return css(createEl(),{position:'absolute',width:o.length+o.width+'px',height:o.width+'px',background:color,boxShadow:shadow,transformOrigin:'left',transform:'rotate('+~~(360/o.lines*i+o.rotate)+'deg) translate('+o.radius+'px'+',0)',borderRadius:(o.corners*o.width>>1)+'px'});}
for(;i<o.lines;i++){seg=css(createEl(),{position:'absolute',top:1+~(o.width/2)+'px',transform:o.hwaccel?'translate3d(0,0,0)':'',opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+' '+1/o.speed+'s linear infinite'});if(o.shadow)ins(seg,css(fill('#000','0 0 4px '+'#000'),{top:2+'px'}));ins(el,ins(seg,fill(getColor(o.color,i),'0 0 1px rgba(0,0,0,.1)')));}
return el;},opacity:function opacity(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val;}});function initVML(){function vml(tag,attr){return createEl('<'+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr);}
sheet.addRule('.spin-vml','behavior:url(#default#VML)');LoadingSpinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r;function grp(){return css(vml('group',{coordsize:s+' '+s,coordorigin:-r+' '+-r}),{width:s,height:s});}
var margin=-(o.width+o.length)*2+'px',g=css(grp(),{position:'absolute',top:margin,left:margin}),i;function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+'deg',left:~~dx}),ins(css(vml('roundrect',{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml('fill',{color:getColor(o.color,i),opacity:o.opacity}),vml('stroke',{opacity:0}))));}
if(o.shadow)for(i=1;i<=o.lines;i++){seg(i,-2,'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)');}for(i=1;i<=o.lines;i++){seg(i);}return ins(el,g);};LoadingSpinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0;if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild;if(c)c.opacity=val;}};}
var probe=css(createEl('group'),{behavior:'url(#default#VML)'});if(!vendor(probe,'transform')&&probe.adj)initVML();else useCssAnimations=vendor(probe,'animation');return LoadingSpinner;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(t,e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))?exports.io=e():t.io=e();}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports;}var r={};return e.m=t,e.c=r,e.p="",e(0);}([function(t,e,r){"use strict";function n(t,e){"object"===("undefined"==typeof t?"undefined":i(t))&&(e=t,t=void 0),e=e||{};var r,n=s(t),a=n.source,p=n.id,f=n.path,l=h[p]&&f in h[p].nsps,d=e.forceNew||e["force new connection"]||!1===e.multiplex||l;return d?(u("ignoring socket cache for %s",a),r=c(a,e)):(h[p]||(u("new io instance for %s",a),h[p]=c(a,e)),r=h[p]),n.query&&!e.query?e.query=n.query:e&&"object"===i(e.query)&&(e.query=o(e.query)),r.socket(n.path,e);}function o(t){var e=[];for(var r in t){t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));}return e.join("&");}var i="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return typeof t==="undefined"?"undefined":_typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t==="undefined"?"undefined":_typeof(t);},s=r(1),a=r(7),c=r(17),u=r(3)("socket.io-client");t.exports=e=n;var h=e.managers={};e.protocol=a.protocol,e.connect=n,e.Manager=r(17),e.Socket=r(45);},function(t,e,r){(function(e){"use strict";function n(t,r){var n=t;r=r||e.location,null==t&&(t=r.protocol+"//"+r.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?r.protocol+t:r.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t="undefined"!=typeof r?r.protocol+"//"+t:"https://"+t),i("parse %s",t),n=o(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=n.host.indexOf(":")!==-1,a=s?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n;}var o=r(2),i=r(3)("socket.io-client:url");t.exports=n;}).call(e,function(){return this;}());},function(t,e){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,o=t.indexOf("["),i=t.indexOf("]");o!=-1&&i!=-1&&(t=t.substring(0,o)+t.substring(o,i).replace(/:/g,";")+t.substring(i,t.length));for(var s=r.exec(t||""),a={},c=14;c--;){a[n[c]]=s[c]||"";}return o!=-1&&i!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a;};},function(t,e,r){(function(n){function o(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31;}function i(){var t=arguments,r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!r)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,i=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o));}),t.splice(i,0,n),t;}function s(){return"object"==(typeof console==="undefined"?"undefined":_typeof(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments);}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t;}catch(t){}}function c(){try{return e.storage.debug;}catch(t){}if("undefined"!=typeof n&&"env"in n)return n.env.DEBUG;}function u(){try{return window.localStorage;}catch(t){}}e=t.exports=r(5),e.log=s,e.formatArgs=i,e.save=a,e.load=c,e.useColors=o,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t);}catch(t){return"[UnexpectedJSONParseError]: "+t.message;}},e.enable(c());}).call(e,r(4));},function(t,e){function r(){throw new Error("setTimeout has not been defined");}function n(){throw new Error("clearTimeout has not been defined");}function o(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0);}catch(e){try{return h.call(null,t,0);}catch(e){return h.call(this,t,0);}}}function i(t){if(p===clearTimeout)return clearTimeout(t);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t);}catch(e){try{return p.call(null,t);}catch(e){return p.call(this,t);}}}function s(){y&&l&&(y=!1,l.length?d=l.concat(d):g=-1,d.length&&a());}function a(){if(!y){var t=o(s);y=!0;for(var e=d.length;e;){for(l=d,d=[];++g<e;){l&&l[g].run();}g=-1,e=d.length;}l=null,y=!1,i(t);}}function c(t,e){this.fun=t,this.array=e;}function u(){}var h,p,f=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r;}catch(t){h=r;}try{p="function"==typeof clearTimeout?clearTimeout:n;}catch(t){p=n;}}();var l,d=[],y=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++){e[r-1]=arguments[r];}d.push(new c(t,e)),1!==d.length||y||o(a);},c.prototype.run=function(){this.fun.apply(null,this.array);},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.binding=function(t){throw new Error("process.binding is not supported");},f.cwd=function(){return"/";},f.chdir=function(t){throw new Error("process.chdir is not supported");},f.umask=function(){return 0;};},function(t,e,r){function n(){return e.colors[h++%e.colors.length];}function o(t){function r(){}function o(){var t=o,r=+new Date(),i=r-(u||r);t.diff=i,t.prev=u,t.curr=r,u=r,null==t.useColors&&(t.useColors=e.useColors()),null==t.color&&t.useColors&&(t.color=n());for(var s=new Array(arguments.length),a=0;a<s.length;a++){s[a]=arguments[a];}s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(r,n){if("%%"===r)return r;c++;var o=e.formatters[n];if("function"==typeof o){var i=s[c];r=o.call(t,i),s.splice(c,1),c--;}return r;}),s=e.formatArgs.apply(t,s);var h=o.log||e.log||console.log.bind(console);h.apply(t,s);}r.enabled=!1,o.enabled=!0;var i=e.enabled(t)?o:r;return i.namespace=t,i;}function i(t){e.save(t);for(var r=(t||"").split(/[\s,]+/),n=r.length,o=0;o<n;o++){r[o]&&(t=r[o].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));}}function s(){e.enable("");}function a(t){var r,n;for(r=0,n=e.skips.length;r<n;r++){if(e.skips[r].test(t))return!1;}for(r=0,n=e.names.length;r<n;r++){if(e.names[r].test(t))return!0;}return!1;}function c(t){return t instanceof Error?t.stack||t.message:t;}e=t.exports=o.debug=o,e.coerce=c,e.disable=s,e.enable=i,e.enabled=a,e.humanize=r(6),e.names=[],e.skips=[],e.formatters={};var u,h=0;},function(t,e){function r(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*h;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*a;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return;}}}}function n(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms";}function o(t){return i(t,u,"day")||i(t,c,"hour")||i(t,a,"minute")||i(t,s,"second")||t+" ms";}function i(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s";}var s=1e3,a=60*s,c=60*a,u=24*c,h=365.25*u;t.exports=function(t,e){e=e||{};var i=typeof t==="undefined"?"undefined":_typeof(t);if("string"===i&&t.length>0)return r(t);if("number"===i&&isNaN(t)===!1)return e.long?o(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t));};},function(t,e,r){function n(){}function o(t){var r="",n=!1;return r+=t.type,e.BINARY_EVENT!=t.type&&e.BINARY_ACK!=t.type||(r+=t.attachments,r+="-"),t.nsp&&"/"!=t.nsp&&(n=!0,r+=t.nsp),null!=t.id&&(n&&(r+=",",n=!1),r+=t.id),null!=t.data&&(n&&(r+=","),r+=f.stringify(t.data)),p("encoded %j as %s",t,r),r;}function i(t,e){function r(t){var r=d.deconstructPacket(t),n=o(r.packet),i=r.buffers;i.unshift(n),e(i);}d.removeBlobs(t,r);}function s(){this.reconstructor=null;}function a(t){var r={},n=0;if(r.type=Number(t.charAt(0)),null==e.types[r.type])return h();if(e.BINARY_EVENT==r.type||e.BINARY_ACK==r.type){for(var o="";"-"!=t.charAt(++n)&&(o+=t.charAt(n),n!=t.length);){}if(o!=Number(o)||"-"!=t.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o);}if("/"==t.charAt(n+1))for(r.nsp="";++n;){var i=t.charAt(n);if(","==i)break;if(r.nsp+=i,n==t.length)break;}else r.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(r.id="";++n;){var i=t.charAt(n);if(null==i||Number(i)!=i){--n;break;}if(r.id+=t.charAt(n),n==t.length)break;}r.id=Number(r.id);}return t.charAt(++n)&&(r=c(r,t.substr(n))),p("decoded %s as %j",t,r),r;}function c(t,e){try{t.data=f.parse(e);}catch(t){return h();}return t;}function u(t){this.reconPack=t,this.buffers=[];}function h(t){return{type:e.ERROR,data:"parser error"};}var p=r(8)("socket.io-parser"),f=r(11),l=r(13),d=r(14),y=r(16);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=s,n.prototype.encode=function(t,r){if(p("encoding packet %j",t),e.BINARY_EVENT==t.type||e.BINARY_ACK==t.type)i(t,r);else{var n=o(t);r([n]);}},l(s.prototype),s.prototype.add=function(t){var r;if("string"==typeof t)r=a(t),e.BINARY_EVENT==r.type||e.BINARY_ACK==r.type?(this.reconstructor=new u(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!y(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,this.emit("decoded",r));}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction();},u.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e;}return null;},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[];};},function(t,e,r){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31;}function o(){var t=arguments,r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!r)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,i=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o));}),t.splice(i,0,n),t;}function i(){return"object"==(typeof console==="undefined"?"undefined":_typeof(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments);}function s(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t;}catch(t){}}function a(){var t;try{t=e.storage.debug;}catch(t){}return t;}function c(){try{return window.localStorage;}catch(t){}}e=t.exports=r(9),e.log=i,e.formatArgs=o,e.save=s,e.load=a,e.useColors=n,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){return JSON.stringify(t);},e.enable(a());},function(t,e,r){function n(){return e.colors[h++%e.colors.length];}function o(t){function r(){}function o(){var t=o,r=+new Date(),i=r-(u||r);t.diff=i,t.prev=u,t.curr=r,u=r,null==t.useColors&&(t.useColors=e.useColors()),null==t.color&&t.useColors&&(t.color=n());var s=Array.prototype.slice.call(arguments);s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(r,n){if("%%"===r)return r;a++;var o=e.formatters[n];if("function"==typeof o){var i=s[a];r=o.call(t,i),s.splice(a,1),a--;}return r;}),"function"==typeof e.formatArgs&&(s=e.formatArgs.apply(t,s));var c=o.log||e.log||console.log.bind(console);c.apply(t,s);}r.enabled=!1,o.enabled=!0;var i=e.enabled(t)?o:r;return i.namespace=t,i;}function i(t){e.save(t);for(var r=(t||"").split(/[\s,]+/),n=r.length,o=0;o<n;o++){r[o]&&(t=r[o].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));}}function s(){e.enable("");}function a(t){var r,n;for(r=0,n=e.skips.length;r<n;r++){if(e.skips[r].test(t))return!1;}for(r=0,n=e.names.length;r<n;r++){if(e.names[r].test(t))return!0;}return!1;}function c(t){return t instanceof Error?t.stack||t.message:t;}e=t.exports=o,e.coerce=c,e.disable=s,e.enable=i,e.enabled=a,e.humanize=r(10),e.names=[],e.skips=[],e.formatters={};var u,h=0;},function(t,e){function r(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*h;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*a;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;}}}}function n(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms";}function o(t){return i(t,u,"day")||i(t,c,"hour")||i(t,a,"minute")||i(t,s,"second")||t+" ms";}function i(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s";}var s=1e3,a=60*s,c=60*a,u=24*c,h=365.25*u;t.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e.long?o(t):n(t);};},function(t,e,r){(function(t,r){var n=!1;(function(){function o(t,e){function r(t){if(r[t]!==g)return r[t];var o;if("bug-string-char-index"==t)o="a"!="a"[0];else if("json"==t)o=r("json-stringify")&&r("json-parse");else{var s,a="{\"a\":[1,true,false,null,\"\\u0000\\b\\n\\f\\r\\t\"]}";if("json-stringify"==t){var c=e.stringify,h="function"==typeof c&&b;if(h){(s=function s(){return 1;}).toJSON=s;try{h="0"===c(0)&&"0"===c(new n())&&'""'==c(new i())&&c(v)===g&&c(g)===g&&c()===g&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([g])&&"null"==c(null)&&"[null,null,null]"==c([g,v,null])&&c({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new u(-1));}catch(t){h=!1;}}o=h;}if("json-parse"==t){var p=e.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){s=p(a);var f=5==s.a.length&&1===s.a[0];if(f){try{f=!p('"\t"');}catch(t){}if(f)try{f=1!==p("01");}catch(t){}if(f)try{f=1!==p("1.");}catch(t){}}}}catch(t){f=!1;}o=f;}}return r[t]=!!o;}t||(t=c.Object()),e||(e=c.Object());var n=t.Number||c.Number,i=t.String||c.String,a=t.Object||c.Object,u=t.Date||c.Date,h=t.SyntaxError||c.SyntaxError,p=t.TypeError||c.TypeError,f=t.Math||c.Math,l=t.JSON||c.JSON;"object"==(typeof l==="undefined"?"undefined":_typeof(l))&&l&&(e.stringify=l.stringify,e.parse=l.parse);var _d,_y,g,m=a.prototype,v=m.toString,b=new u(-0xc782b5b800cec);try{b=b.getUTCFullYear()==-109252&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds();}catch(t){}if(!r("json")){var w="[object Function]",k="[object Date]",A="[object Number]",x="[object String]",B="[object Array]",C="[object Boolean]",S=r("bug-string-char-index");if(!b)var T=f.floor,E=[0,31,59,90,120,151,181,212,243,273,304,334],_=function _(t,e){return E[e]+365*(t-1970)+T((t-1969+(e=+(e>1)))/4)-T((t-1901+e)/100)+T((t-1601+e)/400);};if((_d=m.hasOwnProperty)||(_d=function d(t){var e,r={};return(r.__proto__=null,r.__proto__={toString:1},r).toString!=v?_d=function d(t){var e=this.__proto__,r=t in(this.__proto__=null,this);return this.__proto__=e,r;}:(e=r.constructor,_d=function d(t){var r=(this.constructor||e).prototype;return t in this&&!(t in r&&this[t]===r[t]);}),r=null,_d.call(this,t);}),_y=function y(t,e){var r,n,o,i=0;(r=function r(){this.valueOf=0;}).prototype.valueOf=0,n=new r();for(o in n){_d.call(n,o)&&i++;}return r=n=null,i?_y=2==i?function(t,e){var r,n={},o=v.call(t)==w;for(r in t){o&&"prototype"==r||_d.call(n,r)||!(n[r]=1)||!_d.call(t,r)||e(r);}}:function(t,e){var r,n,o=v.call(t)==w;for(r in t){o&&"prototype"==r||!_d.call(t,r)||(n="constructor"===r)||e(r);}(n||_d.call(t,r="constructor"))&&e(r);}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],_y=function y(t,e){var r,o,i=v.call(t)==w,a=!i&&"function"!=typeof t.constructor&&s[_typeof(t.hasOwnProperty)]&&t.hasOwnProperty||_d;for(r in t){i&&"prototype"==r||!a.call(t,r)||e(r);}for(o=n.length;r=n[--o];a.call(t,r)&&e(r)){}}),_y(t,e);},!r("json-stringify")){var N={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},j="000000",O=function O(t,e){return(j+(e||0)).slice(-t);},P="\\u00",R=function R(t){for(var e='"',r=0,n=t.length,o=!S||n>10,i=o&&(S?t.split(""):t);r<n;r++){var s=t.charCodeAt(r);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=N[s];break;default:if(s<32){e+=P+O(2,s.toString(16));break;}e+=o?i[r]:t.charAt(r);}}return e+'"';},D=function D(t,e,r,n,o,i,s){var a,c,u,h,f,l,m,b,w,S,E,N,j,P,q,U;try{a=e[t];}catch(t){}if("object"==(typeof a==="undefined"?"undefined":_typeof(a))&&a)if(c=v.call(a),c!=k||_d.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=A&&c!=x&&c!=B||_d.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&a<1/0){if(_){for(f=T(a/864e5),u=T(f/365.2425)+1970-1;_(u+1,0)<=f;u++){}for(h=T((f-_(u,0))/30.42);_(u,h+1)<=f;h++){}f=1+f-_(u,h),l=(a%864e5+864e5)%864e5,m=T(l/36e5)%24,b=T(l/6e4)%60,w=T(l/1e3)%60,S=l%1e3;}else u=a.getUTCFullYear(),h=a.getUTCMonth(),f=a.getUTCDate(),m=a.getUTCHours(),b=a.getUTCMinutes(),w=a.getUTCSeconds(),S=a.getUTCMilliseconds();a=(u<=0||u>=1e4?(u<0?"-":"+")+O(6,u<0?-u:u):O(4,u))+"-"+O(2,h+1)+"-"+O(2,f)+"T"+O(2,m)+":"+O(2,b)+":"+O(2,w)+"."+O(3,S)+"Z";}else a=null;if(r&&(a=r.call(e,t,a)),null===a)return"null";if(c=v.call(a),c==C)return""+a;if(c==A)return a>-1/0&&a<1/0?""+a:"null";if(c==x)return R(""+a);if("object"==(typeof a==="undefined"?"undefined":_typeof(a))){for(P=s.length;P--;){if(s[P]===a)throw p();}if(s.push(a),E=[],q=i,i+=o,c==B){for(j=0,P=a.length;j<P;j++){N=D(j,a,r,n,o,i,s),E.push(N===g?"null":N);}U=E.length?o?"[\n"+i+E.join(",\n"+i)+"\n"+q+"]":"["+E.join(",")+"]":"[]";}else _y(n||a,function(t){var e=D(t,a,r,n,o,i,s);e!==g&&E.push(R(t)+":"+(o?" ":"")+e);}),U=E.length?o?"{\n"+i+E.join(",\n"+i)+"\n"+q+"}":"{"+E.join(",")+"}":"{}";return s.pop(),U;}};e.stringify=function(t,e,r){var n,o,i,a;if(s[typeof e==="undefined"?"undefined":_typeof(e)]&&e)if((a=v.call(e))==w)o=e;else if(a==B){i={};for(var c,u=0,h=e.length;u<h;c=e[u++],a=v.call(c),(a==x||a==A)&&(i[c]=1)){}}if(r)if((a=v.call(r))==A){if((r-=r%1)>0)for(n="",r>10&&(r=10);n.length<r;n+=" "){}}else a==x&&(n=r.length<=10?r:r.slice(0,10));return D("",(c={},c[""]=t,c),o,i,n,"",[]);};}if(!r("json-parse")){var q,U,M=i.fromCharCode,L={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},I=function I(){throw q=U=null,h();},H=function H(){for(var t,e,r,n,o,i=U,s=i.length;q<s;){switch(o=i.charCodeAt(q)){case 9:case 10:case 13:case 32:q++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=S?i.charAt(q):i[q],q++,t;case 34:for(t="@",q++;q<s;){if(o=i.charCodeAt(q),o<32)I();else if(92==o)switch(o=i.charCodeAt(++q)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=L[o],q++;break;case 117:for(e=++q,r=q+4;q<r;q++){o=i.charCodeAt(q),o>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||I();}t+=M("0x"+i.slice(e,q));break;default:I();}else{if(34==o)break;for(o=i.charCodeAt(q),e=q;o>=32&&92!=o&&34!=o;){o=i.charCodeAt(++q);}t+=i.slice(e,q);}}if(34==i.charCodeAt(q))return q++,t;I();default:if(e=q,45==o&&(n=!0,o=i.charCodeAt(++q)),o>=48&&o<=57){for(48==o&&(o=i.charCodeAt(q+1),o>=48&&o<=57)&&I(),n=!1;q<s&&(o=i.charCodeAt(q),o>=48&&o<=57);q++){}if(46==i.charCodeAt(q)){for(r=++q;r<s&&(o=i.charCodeAt(r),o>=48&&o<=57);r++){}r==q&&I(),q=r;}if(o=i.charCodeAt(q),101==o||69==o){for(o=i.charCodeAt(++q),43!=o&&45!=o||q++,r=q;r<s&&(o=i.charCodeAt(r),o>=48&&o<=57);r++){}r==q&&I(),q=r;}return+i.slice(e,q);}if(n&&I(),"true"==i.slice(q,q+4))return q+=4,!0;if("false"==i.slice(q,q+5))return q+=5,!1;if("null"==i.slice(q,q+4))return q+=4,null;I();}}return"$";},z=function z(t){var e,r;if("$"==t&&I(),"string"==typeof t){if("@"==(S?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=H(),"]"!=t;r||(r=!0)){r&&(","==t?(t=H(),"]"==t&&I()):I()),","==t&&I(),e.push(z(t));}return e;}if("{"==t){for(e={};t=H(),"}"!=t;r||(r=!0)){r&&(","==t?(t=H(),"}"==t&&I()):I()),","!=t&&"string"==typeof t&&"@"==(S?t.charAt(0):t[0])&&":"==H()||I(),e[t.slice(1)]=z(H());}return e;}I();}return t;},J=function J(t,e,r){var n=X(t,e,r);n===g?delete t[e]:t[e]=n;},X=function X(t,e,r){var n,o=t[e];if("object"==(typeof o==="undefined"?"undefined":_typeof(o))&&o)if(v.call(o)==B)for(n=o.length;n--;){J(o,n,r);}else _y(o,function(t){J(o,t,r);});return r.call(t,e,o);};e.parse=function(t,e){var r,n;return q=0,U=""+t,r=z(H()),"$"!=H()&&I(),q=U=null,e&&v.call(e)==w?X((n={},n[""]=r,n),"",e):r;};}}return e.runInContext=o,e;}var i="function"==typeof n&&n.amd,s={function:!0,object:!0},a=s[typeof e==="undefined"?"undefined":_typeof(e)]&&e&&!e.nodeType&&e,c=s[typeof window==="undefined"?"undefined":_typeof(window)]&&window||this,u=a&&s[typeof t==="undefined"?"undefined":_typeof(t)]&&t&&!t.nodeType&&"object"==(typeof r==="undefined"?"undefined":_typeof(r))&&r;if(!u||u.global!==u&&u.window!==u&&u.self!==u||(c=u),a&&!i)o(c,a);else{var h=c.JSON,p=c.JSON3,f=!1,l=o(c,c.JSON3={noConflict:function noConflict(){return f||(f=!0,c.JSON=h,c.JSON3=p,h=p=null),l;}});c.JSON={parse:l.parse,stringify:l.stringify};}i&&n(function(){return l;});}).call(this);}).call(e,r(12)(t),function(){return this;}());},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t;};},function(t,e){function r(t){if(t)return n(t);}function n(t){for(var e in r.prototype){t[e]=r.prototype[e];}return t;}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this;},r.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments);}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this;},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,o=0;o<r.length;o++){if(n=r[o],n===e||n.fn===e){r.splice(o,1);break;}}return this;},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,o=r.length;n<o;++n){r[n].apply(this,e);}}return this;},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[];},r.prototype.hasListeners=function(t){return!!this.listeners(t).length;};},function(t,e,r){(function(t){var n=r(15),o=r(16);e.deconstructPacket=function(t){function e(t){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:r.length};return r.push(t),i;}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++){s[a]=e(t[a]);}return s;}if("object"==(typeof t==="undefined"?"undefined":_typeof(t))&&!(t instanceof Date)){var s={};for(var c in t){s[c]=e(t[c]);}return s;}return t;}var r=[],i=t.data,s=t;return s.data=e(i),s.attachments=r.length,{packet:s,buffers:r};},e.reconstructPacket=function(t,e){function r(t){if(t&&t._placeholder){var o=e[t.num];return o;}if(n(t)){for(var i=0;i<t.length;i++){t[i]=r(t[i]);}return t;}if(t&&"object"==(typeof t==="undefined"?"undefined":_typeof(t))){for(var s in t){t[s]=r(t[s]);}return t;}return t;}return t.data=r(t.data),t.attachments=void 0,t;},e.removeBlobs=function(e,r){function i(e,c,u){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var h=new FileReader();h.onload=function(){u?u[c]=this.result:a=this.result,--s||r(a);},h.readAsArrayBuffer(e);}else if(n(e))for(var p=0;p<e.length;p++){i(e[p],p,e);}else if(e&&"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&!o(e))for(var f in e){i(e[f],f,e);}}var s=0,a=e;i(a),s||r(a);};}).call(e,function(){return this;}());},function(t,e){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t);};},function(t,e){(function(e){function r(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer;}t.exports=r;}).call(e,function(){return this;}());},function(t,e,r){"use strict";function n(t,e){return this instanceof n?(t&&"object"===("undefined"==typeof t?"undefined":o(t))&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new c.Encoder(),this.decoder=new c.Decoder(),this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(t,e);}var o="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return typeof t==="undefined"?"undefined":_typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t==="undefined"?"undefined":_typeof(t);},i=r(18),s=r(45),a=r(36),c=r(7),u=r(47),h=r(48),p=r(3)("socket.io-client:manager"),f=r(43),l=r(51),d=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps){d.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments);}},n.prototype.updateSocketIds=function(){for(var t in this.nsps){d.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id);}},a(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection;},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts;},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay;},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor;},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax;},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout;},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect();},n.prototype.open=n.prototype.connect=function(t,e){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=i(this.uri,this.opts);var r=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=u(r,"open",function(){n.onopen(),t&&t();}),s=u(r,"error",function(e){if(p("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var r=new Error("Connection error");r.data=e,t(r);}else n.maybeReconnectOnOpen();});if(!1!==this._timeout){var a=this._timeout;p("connect attempt will timeout after %d",a);var c=setTimeout(function(){p("connect attempt timed out after %d",a),o.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",a);},a);this.subs.push({destroy:function destroy(){clearTimeout(c);}});}return this.subs.push(o),this.subs.push(s),this;},n.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(u(t,"data",h(this,"ondata"))),this.subs.push(u(t,"ping",h(this,"onping"))),this.subs.push(u(t,"pong",h(this,"onpong"))),this.subs.push(u(t,"error",h(this,"onerror"))),this.subs.push(u(t,"close",h(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",h(this,"ondecoded")));},n.prototype.onping=function(){this.lastPing=new Date(),this.emitAll("ping");},n.prototype.onpong=function(){this.emitAll("pong",new Date()-this.lastPing);},n.prototype.ondata=function(t){this.decoder.add(t);},n.prototype.ondecoded=function(t){this.emit("packet",t);},n.prototype.onerror=function(t){p("error",t),this.emitAll("error",t);},n.prototype.socket=function(t,e){function r(){~f(o.connecting,n)||o.connecting.push(n);}var n=this.nsps[t];if(!n){n=new s(this,t,e),this.nsps[t]=n;var o=this;n.on("connecting",r),n.on("connect",function(){n.id=o.engine.id;}),this.autoConnect&&r();}return n;},n.prototype.destroy=function(t){var e=f(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close();},n.prototype.packet=function(t){p("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(r){for(var n=0;n<r.length;n++){e.engine.write(r[n],t.options);}e.encoding=!1,e.processPacketQueue();}));},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t);}},n.prototype.cleanup=function(){p("cleanup");for(var t=this.subs.length,e=0;e<t;e++){var r=this.subs.shift();r.destroy();}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy();},n.prototype.close=n.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close();},n.prototype.onclose=function(t){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect();},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(p("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(p("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(p("reconnect success"),t.onreconnect());}));},e);this.subs.push({destroy:function destroy(){clearTimeout(r);}});}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t);};},function(t,e,r){t.exports=r(19);},function(t,e,r){t.exports=r(20),t.exports.parser=r(27);},function(t,e,r){(function(e){function n(t,r){if(!(this instanceof n))return new n(t,r);r=r||{},t&&"object"==(typeof t==="undefined"?"undefined":_typeof(t))&&(r=t,t=null),t?(t=h(t),r.hostname=t.host,r.secure="https"===t.protocol||"wss"===t.protocol,r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=h(r.host).host),this.secure=null!=r.secure?r.secure:e.location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.agent=r.agent||!1,this.hostname=r.hostname||(e.location?location.hostname:"localhost"),this.port=r.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=r.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==r.upgrade,this.path=(r.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!r.forceJSONP,this.jsonp=!1!==r.jsonp,this.forceBase64=!!r.forceBase64,this.enablesXDR=!!r.enablesXDR,this.timestampParam=r.timestampParam||"t",this.timestampRequests=r.timestampRequests,this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=r.policyPort||843,this.rememberUpgrade=r.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=r.onlyBinaryUpgrades,this.perMessageDeflate=!1!==r.perMessageDeflate&&(r.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=r.pfx||null,this.key=r.key||null,this.passphrase=r.passphrase||null,this.cert=r.cert||null,this.ca=r.ca||null,this.ciphers=r.ciphers||null,this.rejectUnauthorized=void 0===r.rejectUnauthorized?null:r.rejectUnauthorized,this.forceNode=!!r.forceNode;var o="object"==(typeof e==="undefined"?"undefined":_typeof(e))&&e;o.global===o&&(r.extraHeaders&&Object.keys(r.extraHeaders).length>0&&(this.extraHeaders=r.extraHeaders),r.localAddress&&(this.localAddress=r.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open();}function o(t){var e={};for(var r in t){t.hasOwnProperty(r)&&(e[r]=t[r]);}return e;}var i=r(21),s=r(36),a=r(3)("engine.io-client:socket"),c=r(43),u=r(27),h=r(2),p=r(44),f=r(37);t.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=u.protocol,n.Socket=n,n.Transport=r(26),n.transports=r(21),n.parser=r(27),n.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=o(this.query);e.EIO=u.protocol,e.transport=t,this.id&&(e.sid=this.id);var r=new i[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return r;},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available");},0);}t=this.transports[0];}this.readyState="opening";try{t=this.createTransport(t);}catch(t){return this.transports.shift(),void this.open();}t.open(),this.setTransport(t);},n.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain();}).on("packet",function(t){e.onPacket(t);}).on("error",function(t){e.onError(t);}).on("close",function(){e.onClose("transport close");});},n.prototype.probe=function(t){function e(){if(f.onlyBinaryUpgrades){var e=!this.supportsBinary&&f.transport.supportsBinary;p=p||e;}p||(a('probe transport "%s" opened',t),h.send([{type:"ping",data:"probe"}]),h.once("packet",function(e){if(!p)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),f.upgrading=!0,f.emit("upgrading",h),!h)return;n.priorWebsocketSuccess="websocket"===h.name,a('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){p||"closed"!==f.readyState&&(a("changing transport and sending upgrade packet"),u(),f.setTransport(h),h.send([{type:"upgrade"}]),f.emit("upgrade",h),h=null,f.upgrading=!1,f.flush());});}else{a('probe transport "%s" failed',t);var r=new Error("probe error");r.transport=h.name,f.emit("upgradeError",r);}}));}function r(){p||(p=!0,u(),h.close(),h=null);}function o(e){var n=new Error("probe error: "+e);n.transport=h.name,r(),a('probe transport "%s" failed because of error: %s',t,e),f.emit("upgradeError",n);}function i(){o("transport closed");}function s(){o("socket closed");}function c(t){h&&t.name!==h.name&&(a('"%s" works - aborting "%s"',t.name,h.name),r());}function u(){h.removeListener("open",e),h.removeListener("error",o),h.removeListener("close",i),f.removeListener("close",s),f.removeListener("upgrading",c);}a('probing transport "%s"',t);var h=this.createTransport(t,{probe:1}),p=!1,f=this;n.priorWebsocketSuccess=!1,h.once("open",e),h.once("error",o),h.once("close",i),this.once("close",s),this.once("upgrading",c),h.open();},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++){this.probe(this.upgrades[t]);}}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(p(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data);}else a('packet received with socket readyState "%s"',this.readyState);},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat));},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout");},t||e.pingInterval+e.pingTimeout);},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout);},t.pingInterval);},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping");});},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush();},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"));},n.prototype.write=n.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this;},n.prototype.sendPacket=function(t,e,r,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){r=r||{},r.compress=!1!==r.compress;var o={type:t,data:e,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush();}},n.prototype.close=function(){function t(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close();}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t();}function r(){n.once("upgrade",e),n.once("upgradeError",e);}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t();}):this.upgrading?r():t();}return this;},n.prototype.onError=function(t){a("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t);},n.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);var r=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),r.writeBuffer=[],r.prevBufferLen=0;}},n.prototype.filterUpgrades=function(t){for(var e=[],r=0,n=t.length;r<n;r++){~c(this.transports,t[r])&&e.push(t[r]);}return e;};}).call(e,function(){return this;}());},function(t,e,r){(function(t){function n(e){var r,n=!1,a=!1,c=!1!==e.jsonp;if(t.location){var u="https:"===location.protocol,h=location.port;h||(h=u?443:80),n=e.hostname!==location.hostname||h!==e.port,a=e.secure!==u;}if(e.xdomain=n,e.xscheme=a,r=new o(e),"open"in r&&!e.forceJSONP)return new i(e);if(!c)throw new Error("JSONP disabled");return new s(e);}var o=r(22),i=r(24),s=r(40),a=r(41);e.polling=n,e.websocket=a;}).call(e,function(){return this;}());},function(t,e,r){(function(e){var n=r(23);t.exports=function(t){var r=t.xdomain,o=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!r||n))return new XMLHttpRequest();}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!o&&i)return new XDomainRequest();}catch(t){}if(!r)try{return new e[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");}catch(t){}};}).call(e,function(){return this;}());},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest();}catch(e){t.exports=!1;}},function(t,e,r){(function(e){function n(){}function o(t){if(c.call(this,t),this.requestTimeout=t.requestTimeout,e.location){var r="https:"===location.protocol,n=location.port;n||(n=r?443:80),this.xd=t.hostname!==e.location.hostname||n!==t.port,this.xs=t.secure!==r;}else this.extraHeaders=t.extraHeaders;}function i(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create();}function s(){for(var t in i.requests){i.requests.hasOwnProperty(t)&&i.requests[t].abort();}}var a=r(22),c=r(25),u=r(36),h=r(38),p=r(3)("engine.io-client:polling-xhr");t.exports=o,t.exports.Request=i,h(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new i(t);},o.prototype.doWrite=function(t,e){var r="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:r}),o=this;n.on("success",e),n.on("error",function(t){o.onError("xhr post error",t);}),this.sendXhr=n;},o.prototype.doPoll=function(){p("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t);}),t.on("error",function(t){e.onError("xhr poll error",t);}),this.pollXhr=t;},u(i.prototype),i.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var r=this.xhr=new a(t),n=this;try{p("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.extraHeaders){r.setDisableHeaderCheck(!0);for(var o in this.extraHeaders){this.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this.extraHeaders[o]);}}}catch(t){}if(this.supportsBinary&&(r.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?r.setRequestHeader("Content-type","application/octet-stream"):r.setRequestHeader("Content-type","text/plain;charset=UTF-8");}catch(t){}try{r.setRequestHeader("Accept","*/*");}catch(t){}"withCredentials"in r&&(r.withCredentials=!0),this.requestTimeout&&(r.timeout=this.requestTimeout),this.hasXDR()?(r.onload=function(){n.onLoad();},r.onerror=function(){n.onError(r.responseText);}):r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?n.onLoad():setTimeout(function(){n.onError(r.status);},0));},p("xhr data %s",this.data),r.send(this.data);}catch(t){return void setTimeout(function(){n.onError(t);},0);}e.document&&(this.index=i.requestsCount++,i.requests[this.index]=this);},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup();},i.prototype.onData=function(t){this.emit("data",t),this.onSuccess();},i.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0);},i.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort();}catch(t){}e.document&&delete i.requests[this.index],this.xhr=null;}},i.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0];}catch(t){}if("application/octet-stream"===e)t=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response));}catch(e){for(var r=new Uint8Array(this.xhr.response),n=[],o=0,i=r.length;o<i;o++){n.push(r[o]);}t=String.fromCharCode.apply(null,n);}else t=this.xhr.responseText;}catch(t){this.onError(t);}null!=t&&this.onData(t);},i.prototype.hasXDR=function(){return"undefined"!=typeof e.XDomainRequest&&!this.xs&&this.enablesXDR;},i.prototype.abort=function(){this.cleanup();},i.requestsCount=0,i.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",s):e.addEventListener&&e.addEventListener("beforeunload",s,!1));}).call(e,function(){return this;}());},function(t,e,r){function n(t){var e=t&&t.forceBase64;h&&!e||(this.supportsBinary=!1),o.call(this,t);}var o=r(26),i=r(37),s=r(27),a=r(38),c=r(39),u=r(3)("engine.io-client:polling");t.exports=n;var h=function(){var t=r(22),e=new t({xdomain:!1});return null!=e.responseType;}();a(n,o),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll();},n.prototype.pause=function(t){function e(){u("paused"),r.readyState="paused",t();}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(u("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){u("pre-pause polling complete"),--n||e();})),this.writable||(u("we are currently writing - waiting to pause"),n++,this.once("drain",function(){u("pre-pause writing complete"),--n||e();}));}else e();},n.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll");},n.prototype.onData=function(t){var e=this;u("polling got data %s",t);var r=function r(t,_r,n){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t);};s.decodePayload(t,this.socket.binaryType,r),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState));},n.prototype.doClose=function(){function t(){u("writing close packet"),e.write([{type:"close"}]);}var e=this;"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t));},n.prototype.write=function(t){var e=this;this.writable=!1;var r=function r(){e.writable=!0,e.emit("drain");};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,r);});},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(r=":"+this.port),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t;};},function(t,e,r){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress;}var o=r(27),i=r(36);t.exports=n,i(n.prototype),n.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this;},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this;},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this;},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t);},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open");},n.prototype.onData=function(t){var e=o.decodePacket(t,this.socket.binaryType);this.onPacket(e);},n.prototype.onPacket=function(t){this.emit("packet",t);},n.prototype.onClose=function(){this.readyState="closed",this.emit("close");};},function(t,e,r){(function(t){function n(t,r){var n="b"+e.packets[t.type]+t.data.data;return r(n);}function o(t,r,n){if(!r)return e.encodeBase64Packet(t,n);var o=t.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=v[t.type];for(var a=0;a<i.length;a++){s[a+1]=i[a];}return n(s.buffer);}function i(t,r,n){if(!r)return e.encodeBase64Packet(t,n);var o=new FileReader();return o.onload=function(){t.data=o.result,e.encodePacket(t,r,!0,n);},o.readAsArrayBuffer(t.data);}function s(t,r,n){if(!r)return e.encodeBase64Packet(t,n);if(m)return i(t,r,n);var o=new Uint8Array(1);o[0]=v[t.type];var s=new k([o.buffer,t.data]);return n(s);}function a(t){try{t=d.decode(t);}catch(t){return!1;}return t;}function c(t,e,r){for(var n=new Array(t.length),o=l(t.length,r),i=function i(t,r,o){e(r,function(e,r){n[t]=r,o(e,n);});},s=0;s<t.length;s++){i(s,t[s],o);}}var u,h=r(28),p=r(29),f=r(31),l=r(32),d=r(33);t&&t.ArrayBuffer&&(u=r(34));var y="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=y||g;e.protocol=3;var v=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=h(v),w={type:"error",data:"parser error"},k=r(35);e.encodePacket=function(e,r,i,a){"function"==typeof r&&(a=r,r=!1),"function"==typeof i&&(a=i,i=null);var c=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&c instanceof ArrayBuffer)return o(e,r,a);if(k&&c instanceof t.Blob)return s(e,r,a);if(c&&c.base64)return n(e,a);var u=v[e.type];return void 0!==e.data&&(u+=i?d.encode(String(e.data)):String(e.data)),a(""+u);},e.encodeBase64Packet=function(r,n){var o="b"+e.packets[r.type];if(k&&r.data instanceof t.Blob){var i=new FileReader();return i.onload=function(){var t=i.result.split(",")[1];n(o+t);},i.readAsDataURL(r.data);}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(r.data));}catch(t){for(var a=new Uint8Array(r.data),c=new Array(a.length),u=0;u<a.length;u++){c[u]=a[u];}s=String.fromCharCode.apply(null,c);}return o+=t.btoa(s),n(o);},e.decodePacket=function(t,r,n){if(void 0===t)return w;if("string"==typeof t){if("b"==t.charAt(0))return e.decodeBase64Packet(t.substr(1),r);if(n&&(t=a(t),t===!1))return w;var o=t.charAt(0);return Number(o)==o&&b[o]?t.length>1?{type:b[o],data:t.substring(1)}:{type:b[o]}:w;}var i=new Uint8Array(t),o=i[0],s=f(t,1);return k&&"blob"===r&&(s=new k([s])),{type:b[o],data:s};},e.decodeBase64Packet=function(t,e){var r=b[t.charAt(0)];if(!u)return{type:r,data:{base64:!0,data:t.substr(1)}};var n=u.decode(t.substr(1));return"blob"===e&&k&&(n=new k([n])),{type:r,data:n};},e.encodePayload=function(t,r,n){function o(t){return t.length+":"+t;}function i(t,n){e.encodePacket(t,!!s&&r,!0,function(t){n(null,o(t));});}"function"==typeof r&&(n=r,r=null);var s=p(t);return r&&s?k&&!m?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n):t.length?void c(t,i,function(t,e){return n(e.join(""));}):n("0:");},e.decodePayload=function(t,r,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,r,n);"function"==typeof r&&(n=r,r=null);var o;if(""==t)return n(w,0,1);for(var i,s,a="",c=0,u=t.length;c<u;c++){var h=t.charAt(c);if(":"!=h)a+=h;else{if(""==a||a!=(i=Number(a)))return n(w,0,1);if(s=t.substr(c+1,i),a!=s.length)return n(w,0,1);if(s.length){if(o=e.decodePacket(s,r,!0),w.type==o.type&&w.data==o.data)return n(w,0,1);var p=n(o,c+i,u);if(!1===p)return;}c+=i,a="";}}return""!=a?n(w,0,1):void 0;},e.encodePayloadAsArrayBuffer=function(t,r){function n(t,r){e.encodePacket(t,!0,!0,function(t){return r(null,t);});}return t.length?void c(t,n,function(t,e){var n=e.reduce(function(t,e){var r;return r="string"==typeof e?e.length:e.byteLength,t+r.toString().length+r+2;},0),o=new Uint8Array(n),i=0;return e.forEach(function(t){var e="string"==typeof t,r=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++){n[s]=t.charCodeAt(s);}r=n.buffer;}e?o[i++]=0:o[i++]=1;for(var a=r.byteLength.toString(),s=0;s<a.length;s++){o[i++]=parseInt(a[s]);}o[i++]=255;for(var n=new Uint8Array(r),s=0;s<n.length;s++){o[i++]=n[s];}}),r(o.buffer);}):r(new ArrayBuffer(0));},e.encodePayloadAsBlob=function(t,r){function n(t,r){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),o=0;o<t.length;o++){n[o]=t.charCodeAt(o);}t=n.buffer,e[0]=0;}for(var i=t instanceof ArrayBuffer?t.byteLength:t.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++){a[o]=parseInt(s[o]);}if(a[s.length]=255,k){var c=new k([e.buffer,a.buffer,t]);r(null,c);}});}c(t,n,function(t,e){return r(new k(e));});},e.decodePayloadAsBinary=function(t,r,n){"function"==typeof r&&(n=r,r=null);for(var o=t,i=[],s=!1;o.byteLength>0;){for(var a=new Uint8Array(o),c=0===a[0],u="",h=1;255!=a[h];h++){if(u.length>310){s=!0;break;}u+=a[h];}if(s)return n(w,0,1);o=f(o,2+u.length),u=parseInt(u);var p=f(o,0,u);if(c)try{p=String.fromCharCode.apply(null,new Uint8Array(p));}catch(t){var l=new Uint8Array(p);p="";for(var h=0;h<l.length;h++){p+=String.fromCharCode(l[h]);}}i.push(p),o=f(o,u);}var d=i.length;i.forEach(function(t,o){n(e.decodePacket(t,r,!0),o,d);});};}).call(e,function(){return this;}());},function(t,e){t.exports=Object.keys||function(t){var e=[],r=Object.prototype.hasOwnProperty;for(var n in t){r.call(t,n)&&e.push(n);}return e;};},function(t,e,r){(function(e){function n(t){function r(t){if(!t)return!1;if(e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer||e.Blob&&t instanceof Blob||e.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++){if(r(t[n]))return!0;}}else if(t&&"object"==(typeof t==="undefined"?"undefined":_typeof(t))){t.toJSON&&(t=t.toJSON());for(var i in t){if(Object.prototype.hasOwnProperty.call(t,i)&&r(t[i]))return!0;}}return!1;}return r(t);}var o=r(30);t.exports=n;}).call(e,function(){return this;}());},function(t,e){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t);};},function(t,e){t.exports=function(t,e,r){var n=t.byteLength;if(e=e||0,r=r||n,t.slice)return t.slice(e,r);if(e<0&&(e+=n),r<0&&(r+=n),r>n&&(r=n),e>=n||e>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(t),i=new Uint8Array(r-e),s=e,a=0;s<r;s++,a++){i[a]=o[s];}return i.buffer;};},function(t,e){function r(t,e,r){function o(t,n){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=r):0!==o.count||i||e(null,n);}var i=!1;return r=r||n,o.count=t,0===t?e():o;}function n(){}t.exports=r;},function(t,e,r){var n;(function(t,o){!function(i){function s(t){for(var e,r,n=[],o=0,i=t.length;o<i;){e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);}return n;}function a(t){for(var e,r=t.length,n=-1,o="";++n<r;){e=t[n],e>65535&&(e-=65536,o+=b(e>>>10&1023|55296),e=56320|1023&e),o+=b(e);}return o;}function c(t,e){return b(t>>e&63|128);}function u(t){if(0==(4294967168&t))return b(t);var e="";return 0==(4294965248&t)?e=b(t>>6&31|192):0==(4294901760&t)?(e=b(t>>12&15|224),e+=c(t,6)):0==(4292870144&t)&&(e=b(t>>18&7|240),e+=c(t,12),e+=c(t,6)),e+=b(63&t|128);}function h(t){for(var e,r=s(t),n=r.length,o=-1,i="";++o<n;){e=r[o],i+=u(e);}return i;}function p(){if(v>=m)throw Error("Invalid byte index");var t=255&g[v];if(v++,128==(192&t))return 63&t;throw Error("Invalid continuation byte");}function f(){var t,e,r,n,o;if(v>m)throw Error("Invalid byte index");if(v==m)return!1;if(t=255&g[v],v++,0==(128&t))return t;if(192==(224&t)){var e=p();if(o=(31&t)<<6|e,o>=128)return o;throw Error("Invalid continuation byte");}if(224==(240&t)){if(e=p(),r=p(),o=(15&t)<<12|e<<6|r,o>=2048)return o;throw Error("Invalid continuation byte");}if(240==(248&t)&&(e=p(),r=p(),n=p(),o=(15&t)<<18|e<<12|r<<6|n,o>=65536&&o<=1114111))return o;throw Error("Invalid WTF-8 detected");}function l(t){g=s(t),m=g.length,v=0;for(var e,r=[];(e=f())!==!1;){r.push(e);}return a(r);}var d="object"==(typeof e==="undefined"?"undefined":_typeof(e))&&e,y=("object"==(typeof t==="undefined"?"undefined":_typeof(t))&&t&&t.exports==d&&t,"object"==(typeof o==="undefined"?"undefined":_typeof(o))&&o);y.global!==y&&y.window!==y||(i=y);var g,m,v,b=String.fromCharCode,w={version:"1.0.0",encode:h,decode:l};n=function(){return w;}.call(e,r,e,t),!(void 0!==n&&(t.exports=n));}(this);}).call(e,r(12)(t),function(){return this;}());},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<t.length;n++){r[t.charCodeAt(n)]=n;}e.encode=function(e){var r,n=new Uint8Array(e),o=n.length,i="";for(r=0;r<o;r+=3){i+=t[n[r]>>2],i+=t[(3&n[r])<<4|n[r+1]>>4],i+=t[(15&n[r+1])<<2|n[r+2]>>6],i+=t[63&n[r+2]];}return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i;},e.decode=function(t){var e,n,o,i,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),p=new Uint8Array(h);for(e=0;e<c;e+=4){n=r[t.charCodeAt(e)],o=r[t.charCodeAt(e+1)],i=r[t.charCodeAt(e+2)],s=r[t.charCodeAt(e+3)],p[u++]=n<<2|o>>4,p[u++]=(15&o)<<4|i>>2,p[u++]=(3&i)<<6|63&s;}return h;};}();},function(t,e){(function(e){function r(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var o=new Uint8Array(r.byteLength);o.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=o.buffer;}t[e]=n;}}}function n(t,e){e=e||{};var n=new i();r(t);for(var o=0;o<t.length;o++){n.append(t[o]);}return e.type?n.getBlob(e.type):n.getBlob();}function o(t,e){return r(t),new Blob(t,e||{});}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size;}catch(t){return!1;}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size;}catch(t){return!1;}}(),c=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return s?a?e.Blob:o:c?n:void 0;}();}).call(e,function(){return this;}());},function(t,e,r){function n(t){if(t)return o(t);}function o(t){for(var e in n.prototype){t[e]=n.prototype[e];}return t;}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this;},n.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments);}return r.fn=e,this.on(t,r),this;},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,o=0;o<r.length;o++){if(n=r[o],n===e||n.fn===e){r.splice(o,1);break;}}return this;},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var n=0,o=r.length;n<o;++n){r[n].apply(this,e);}}return this;},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[];},n.prototype.hasListeners=function(t){return!!this.listeners(t).length;};},function(t,e){e.encode=function(t){var e="";for(var r in t){t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));}return e;},e.decode=function(t){for(var e={},r=t.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]);}return e;};},function(t,e){t.exports=function(t,e){var r=function r(){};r.prototype=e.prototype,t.prototype=new r(),t.prototype.constructor=t;};},function(t,e){"use strict";function r(t){var e="";do{e=s[t%a]+e,t=Math.floor(t/a);}while(t>0);return e;}function n(t){var e=0;for(h=0;h<t.length;h++){e=e*a+c[t.charAt(h)];}return e;}function o(){var t=r(+new Date());return t!==i?(u=0,i=t):t+"."+r(u++);}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,c={},u=0,h=0;h<a;h++){c[s[h]]=h;}o.encode=r,o.decode=n,t.exports=o;},function(t,e,r){(function(e){function n(){}function o(t){i.call(this,t),this.query=this.query||{},a||(e.___eio||(e.___eio=[]),a=e.___eio),this.index=a.length;var r=this;a.push(function(t){r.onData(t);}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){r.script&&(r.script.onerror=n);},!1);}var i=r(25),s=r(38);t.exports=o;var a,c=/\n/g,u=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this);},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e);};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t);},100);},o.prototype.doWrite=function(t,e){function r(){n(),e();}function n(){if(o.iframe)try{o.form.removeChild(o.iframe);}catch(t){o.onError("jsonp polling iframe removal error",t);}try{var t='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(t);}catch(t){i=document.createElement("iframe"),i.name=o.iframeId,i.src="javascript:0";}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i;}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a;}this.form.action=this.uri(),n(),t=t.replace(u,"\\\n"),this.area.value=t.replace(c,"\\n");try{this.form.submit();}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&r();}:this.iframe.onload=r;};}).call(e,function(){return this;}());},function(t,e,r){(function(e){function n(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=p&&!t.forceNode,this.usingBrowserWebSocket||(f=o),i.call(this,t);}var o,i=r(26),s=r(27),a=r(37),c=r(38),u=r(39),h=r(3)("engine.io-client:websocket"),p=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{o=r(42);}catch(t){}var f=p;f||"undefined"!=typeof window||(f=o),t.exports=n,c(n,i),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new f(t):new f(t,e,r);}catch(t){return this.emit("error",t);}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners();}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen();},this.ws.onclose=function(){t.onClose();},this.ws.onmessage=function(e){t.onData(e.data);},this.ws.onerror=function(e){t.onError("websocket error",e);};},n.prototype.write=function(t){function r(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain");},0);}var n=this;this.writable=!1;for(var o=t.length,i=0,a=o;i<a;i++){!function(t){s.encodePacket(t,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var s={};if(t.options&&(s.compress=t.options.compress),n.perMessageDeflate){var a="string"==typeof i?e.Buffer.byteLength(i):i.length;a<n.perMessageDeflate.threshold&&(s.compress=!1);}}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,s);}catch(t){h("websocket closed before onclose event");}--o||r();});}(t[i]);}},n.prototype.onClose=function(){i.prototype.onClose.call(this);},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close();},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),t=a.encode(t),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t;},n.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===n.prototype.name);};}).call(e,function(){return this;}());},function(t,e){},function(t,e){var r=[].indexOf;t.exports=function(t,e){if(r)return t.indexOf(e);for(var n=0;n<t.length;++n){if(t[n]===e)return n;}return-1;};},function(t,e){(function(e){var r=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):r.test(t.replace(n,"@").replace(o,"]").replace(i,""))?new Function("return "+t)():void 0):null;};}).call(e,function(){return this;}());},function(t,e,r){"use strict";function n(t,e,r){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open();}var o=r(7),i=r(36),s=r(46),a=r(47),c=r(48),u=r(3)("socket.io-client:socket"),h=r(49);t.exports=e=n;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;i(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",c(this,"onopen")),a(t,"packet",c(this,"onpacket")),a(t,"close",c(this,"onclose"))];}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this);},n.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this;},n.prototype.emit=function(t){if(p.hasOwnProperty(t))return f.apply(this,arguments),this;var e=s(arguments),r=o.EVENT;h(e)&&(r=o.BINARY_EVENT);var n={type:r,data:e};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this;},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t);},n.prototype.onopen=function(){u("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:o.CONNECT,query:this.query}):this.packet({type:o.CONNECT}));},n.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t);},n.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case o.CONNECT:this.onconnect();break;case o.EVENT:this.onevent(t);break;case o.BINARY_EVENT:this.onevent(t);break;case o.ACK:this.onack(t);break;case o.BINARY_ACK:this.onack(t);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",t.data);}},n.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e);},n.prototype.ack=function(t){var e=this,r=!1;return function(){if(!r){r=!0;var n=s(arguments);u("sending ack %j",n);var i=h(n)?o.BINARY_ACK:o.ACK;e.packet({type:i,id:t,data:n});}};},n.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id);},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered();},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++){f.apply(this,this.receiveBuffer[t]);}for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++){this.packet(this.sendBuffer[t]);}this.sendBuffer=[];},n.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect");},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++){this.subs[t].destroy();}this.subs=null;}this.io.destroy(this);},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this;},n.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this;};},function(t,e){function r(t,e){var r=[];e=e||0;for(var n=e||0;n<t.length;n++){r[n-e]=t[n];}return r;}t.exports=r;},function(t,e){"use strict";function r(t,e,r){return t.on(e,r),{destroy:function destroy(){t.removeListener(e,r);}};}t.exports=r;},function(t,e){var r=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return e.apply(t,n.concat(r.call(arguments)));};};},function(t,e,r){(function(e){function n(t){function r(t){if(!t)return!1;if(e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer||e.Blob&&t instanceof Blob||e.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++){if(r(t[n]))return!0;}}else if(t&&"object"==(typeof t==="undefined"?"undefined":_typeof(t))){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var i in t){if(Object.prototype.hasOwnProperty.call(t,i)&&r(t[i]))return!0;}}return!1;}return r(t);}var o=r(50);t.exports=n;}).call(e,function(){return this;}());},function(t,e){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t);};},function(t,e){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0;}t.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r;}return 0|Math.min(t,this.max);},r.prototype.reset=function(){this.attempts=0;},r.prototype.setMin=function(t){this.ms=t;},r.prototype.setMax=function(t){this.max=t;},r.prototype.setJitter=function(t){this.jitter=t;};}]);});(function(){dockspawn={version:"0.0.2"};dockspawn.TabHandle=function(parent){this.parent=parent;var undockHandler=dockspawn.TabHandle.prototype._performUndock.bind(this);this.elementBase=document.createElement('div');this.elementText=document.createElement('div');this.elementCloseButton=document.createElement('div');this.elementBase.classList.add("tab-handle");this.elementBase.classList.add("disable-selection");this.elementText.classList.add("tab-handle-text");this.elementCloseButton.classList.add("tab-handle-close-button");this.elementBase.appendChild(this.elementText);if(this.parent.host.displayCloseButton)this.elementBase.appendChild(this.elementCloseButton);this.parent.host.tabListElement.appendChild(this.elementBase);var panel=parent.container;var title=panel.getRawTitle();this.elementText.innerHTML=title;var closeIcon="icon-remove-sign";this.elementCloseButton.innerHTML='<i class="'+closeIcon+'"></i>';this._bringToFront(this.elementBase);this.undockInitiator=new dockspawn.UndockInitiator(this.elementBase,undockHandler);this.undockInitiator.enabled=true;this.mouseClickHandler=new dockspawn.EventHandler(this.elementBase,'click',this.onMouseClicked.bind(this));this.closeButtonHandler=new dockspawn.EventHandler(this.elementCloseButton,'mousedown',this.onCloseButtonClicked.bind(this));this.zIndexCounter=1000;};dockspawn.TabHandle.prototype.updateTitle=function(){if(this.parent.container instanceof dockspawn.PanelContainer){var panel=this.parent.container;var title=panel.getRawTitle();this.elementText.innerHTML=title;}};dockspawn.TabHandle.prototype.destroy=function(){this.mouseClickHandler.cancel();this.closeButtonHandler.cancel();removeNode(this.elementBase);removeNode(this.elementCloseButton);delete this.elementBase;delete this.elementCloseButton;};dockspawn.TabHandle.prototype._performUndock=function(e,dragOffset){if(this.parent.container.containerType=="panel"){this.undockInitiator.enabled=false;var panel=this.parent.container;return panel.performUndockToDialog(e,dragOffset);}else return null;};dockspawn.TabHandle.prototype.onMouseClicked=function(){this.parent.onSelected();};dockspawn.TabHandle.prototype.onCloseButtonClicked=function(){if(this.parent.container.containerType=="panel"){this.undockInitiator.enabled=false;var panel=this.parent.container;panel.performUndock();}};dockspawn.TabHandle.prototype.setSelected=function(selected){var selectedClassName="tab-handle-selected";if(selected)this.elementBase.classList.add(selectedClassName);else this.elementBase.classList.remove(selectedClassName);};dockspawn.TabHandle.prototype.setZIndex=function(zIndex){this.elementBase.style.zIndex=zIndex;};dockspawn.TabHandle.prototype._bringToFront=function(element){element.style.zIndex=this.zIndexCounter;this.zIndexCounter++;};dockspawn.TabHost=function(tabStripDirection,displayCloseButton){if(tabStripDirection===undefined)tabStripDirection=dockspawn.TabHost.DIRECTION_BOTTOM;if(displayCloseButton===undefined)displayCloseButton=false;this.tabStripDirection=tabStripDirection;this.displayCloseButton=displayCloseButton;this.pages=[];this.hostElement=document.createElement('div');this.tabListElement=document.createElement('div');this.separatorElement=document.createElement('div');this.contentElement=document.createElement('div');this.createTabPage=this._createDefaultTabPage;if(this.tabStripDirection==dockspawn.TabHost.DIRECTION_BOTTOM){this.hostElement.appendChild(this.contentElement);this.hostElement.appendChild(this.separatorElement);this.hostElement.appendChild(this.tabListElement);}else if(this.tabStripDirection==dockspawn.TabHost.DIRECTION_TOP){this.tabListElement.classList.add('hide');this.separatorElement.classList.add('hide');this.hostElement.appendChild(this.tabListElement);this.hostElement.appendChild(this.separatorElement);this.hostElement.appendChild(this.contentElement);}else throw new dockspawn.Exception("Only top and bottom tab strip orientations are supported");this.hostElement.classList.add("tab-host");this.tabListElement.classList.add("tab-handle-list-container");this.separatorElement.classList.add("tab-handle-content-seperator");this.contentElement.classList.add("tab-content");};dockspawn.TabHost.DIRECTION_TOP=0;dockspawn.TabHost.DIRECTION_BOTTOM=1;dockspawn.TabHost.DIRECTION_LEFT=2;dockspawn.TabHost.DIRECTION_RIGHT=3;dockspawn.TabHost.prototype._createDefaultTabPage=function(tabHost,container){return new dockspawn.TabPage(tabHost,container);};dockspawn.TabHost.prototype.setActiveTab=function(container){var self=this;this.pages.forEach(function(page){if(page.container===container){self.onTabPageSelected(page);return;}});};dockspawn.TabHost.prototype.resize=function(width,height){this.hostElement.style.width=width+"px";this.hostElement.style.height=height+"px";var tabHeight=this.tabListElement.clientHeight;var separatorHeight=this.separatorElement.clientHeight;var contentHeight=height-tabHeight-separatorHeight;this.contentElement.style.height=contentHeight+"px";if(this.activeTab)this.activeTab.resize(width,contentHeight);};dockspawn.TabHost.prototype.performLayout=function(children){this.pages.forEach(function(tab){tab.destroy();});this.pages.length=0;var oldActiveTab=this.activeTab;delete this.activeTab;var childPanels=children.filter(function(child){return child.containerType=="panel";});if(childPanels.length>0){var self=this;childPanels.forEach(function(child){var page=self.createTabPage(self,child);self.pages.push(page);if(oldActiveTab&&page.container===oldActiveTab.container)self.activeTab=page;});this._setTabHandlesVisible(true);}else
this._setTabHandlesVisible(false);if(this.activeTab)this.onTabPageSelected(this.activeTab);};dockspawn.TabHost.prototype._setTabHandlesVisible=function(visible){this.tabListElement.style.display=visible?"block":"none";this.separatorElement.style.display=visible?"block":"none";};dockspawn.TabHost.prototype.onTabPageSelected=function(page){var changedPages=[];this.activeTab=page;this.pages.forEach(function(tabPage){var selected=tabPage===page;if(tabPage.selected!==selected)changedPages.push(tabPage);tabPage.setSelected(selected);});var zIndexDelta=1;var zIndex=1000;this.pages.forEach(function(tabPage){tabPage.handle.setZIndex(zIndex);var selected=tabPage==page;if(selected)zIndexDelta=-1;zIndex+=zIndexDelta;});changedPages.forEach(function(tabPage){if(this.onTabChanged)this.onTabChanged(this,tabPage);},this);};dockspawn.TabHost.prototype.onTabChanged=function(host,page){var ele=page.container.elementContent;var cancelld=ele.dispatchEvent(new CustomEvent('dock.tabPage.changed',{detail:page.selected}));};dockspawn.TabPage=function(host,container){if(arguments.length==0)return;this.selected=false;this.host=host;this.container=container;this.handle=new dockspawn.TabHandle(this);this.containerElement=container.containerElement;if(container instanceof dockspawn.PanelContainer){var panel=container;panel.onTitleChanged=this.onTitleChanged.bind(this);}};dockspawn.TabPage.prototype.onTitleChanged=function(sender,title){this.handle.updateTitle();};dockspawn.TabPage.prototype.destroy=function(){this.handle.destroy();if(this.container instanceof dockspawn.PanelContainer){var panel=this.container;delete panel.onTitleChanged;}};dockspawn.TabPage.prototype.onSelected=function(){this.host.onTabPageSelected(this);};dockspawn.TabPage.prototype.setSelected=function(flag){this.selected=flag;this.handle.setSelected(flag);if(this.selected){this.host.contentElement.appendChild(this.containerElement);var width=this.host.contentElement.clientWidth;var height=this.host.contentElement.clientHeight;this.container.resize(width,height);}else removeNode(this.containerElement);$(".edit").hide();};dockspawn.TabPage.prototype.resize=function(width,height){this.container.resize(width,height);};dockspawn.Dialog=function(panel,dockManager){this.panel=panel;this.zIndexCounter=1000;this.dockManager=dockManager;this.eventListener=dockManager;this._initialize();};dockspawn.Dialog.fromElement=function(id,dockManager){return new dockspawn.Dialog(new dockspawn.PanelContainer(document.getElementById(id),dockManager),dockManager);};dockspawn.Dialog.prototype._initialize=function(){this.panel.floatingDialog=this;this.elementDialog=document.createElement('div');this.elementDialog.appendChild(this.panel.elementPanel);this.draggable=new dockspawn.DraggableContainer(this,this.panel,this.elementDialog,this.panel.elementTitle);this.resizable=new dockspawn.ResizableContainer(this,this.draggable,this.draggable.topLevelElement);document.body.appendChild(this.elementDialog);this.elementDialog.classList.add("dialog-floating");this.elementDialog.classList.add("rounded-corner-top");this.panel.elementTitle.classList.add("rounded-corner-top");this.mouseDownHandler=new dockspawn.EventHandler(this.elementDialog,'mousedown',this.onMouseDown.bind(this));this.resize(this.panel.elementPanel.clientWidth,this.panel.elementPanel.clientHeight);this.bringToFront();};dockspawn.Dialog.prototype.setPosition=function(x,y){this.elementDialog.style.left=x+"px";this.elementDialog.style.top=y+"px";};dockspawn.Dialog.prototype.onMouseDown=function(e){this.bringToFront();};dockspawn.Dialog.prototype.destroy=function(){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
this.elementDialog.classList.remove("rounded-corner-top");this.panel.elementTitle.classList.remove("rounded-corner-top");removeNode(this.elementDialog);this.draggable.removeDecorator();removeNode(this.panel.elementPanel);this.panel.floatingDialog=undefined;};dockspawn.Dialog.prototype.resize=function(width,height){this.resizable.resize(width,height);};dockspawn.Dialog.prototype.setTitle=function(title){this.panel.setTitle(title);};dockspawn.Dialog.prototype.setTitleIcon=function(iconName){this.panel.setTitleIcon(iconName);};dockspawn.Dialog.prototype.bringToFront=function(){this.elementDialog.style.zIndex=this.zIndexCounter++;};dockspawn.DraggableContainer=function(dialog,delegate,topLevelElement,dragHandle){this.dialog=dialog;this.delegate=delegate;this.containerElement=delegate.containerElement;this.dockManager=delegate.dockManager;this.topLevelElement=topLevelElement;this.containerType=delegate.containerType;this.mouseDownHandler=new dockspawn.EventHandler(dragHandle,'mousedown',this.onMouseDown.bind(this));this.topLevelElement.style.marginLeft=topLevelElement.offsetLeft+"px";this.topLevelElement.style.marginTop=topLevelElement.offsetTop+"px";this.minimumAllowedChildNodes=delegate.minimumAllowedChildNodes;};dockspawn.DraggableContainer.prototype.destroy=function(){this.removeDecorator();this.delegate.destroy();};dockspawn.DraggableContainer.prototype.saveState=function(state){this.delegate.saveState(state);};dockspawn.DraggableContainer.prototype.loadState=function(state){this.delegate.loadState(state);};dockspawn.DraggableContainer.prototype.setActiveChild=function(child){};Object.defineProperty(dockspawn.DraggableContainer.prototype,"width",{get:function get(){return this.delegate.width;}});Object.defineProperty(dockspawn.DraggableContainer.prototype,"height",{get:function get(){return this.delegate.height;}});dockspawn.DraggableContainer.prototype.name=function(value){if(value)this.delegate.name=value;return this.delegate.name;};dockspawn.DraggableContainer.prototype.resize=function(width,height){this.delegate.resize(width,height);};dockspawn.DraggableContainer.prototype.performLayout=function(children){this.delegate.performLayout(children);};dockspawn.DraggableContainer.prototype.removeDecorator=function(){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}};dockspawn.DraggableContainer.prototype.onMouseDown=function(event){this._startDragging(event);this.previousMousePosition={x:event.pageX,y:event.pageY};if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMove.bind(this));this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));};dockspawn.DraggableContainer.prototype.onMouseUp=function(event){this._stopDragging(event);this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;this.mouseUpHandler.cancel();delete this.mouseUpHandler;};dockspawn.DraggableContainer.prototype._startDragging=function(event){if(this.dialog.eventListener)this.dialog.eventListener.onDialogDragStarted(this.dialog,event);document.body.classList.add("disable-selection");};dockspawn.DraggableContainer.prototype._stopDragging=function(event){if(this.dialog.eventListener)this.dialog.eventListener.onDialogDragEnded(this.dialog,event);document.body.classList.remove("disable-selection");};dockspawn.DraggableContainer.prototype.onMouseMove=function(event){var currentMousePosition=new Point(event.pageX,event.pageY);var dx=Math.floor(currentMousePosition.x-this.previousMousePosition.x);var dy=Math.floor(currentMousePosition.y-this.previousMousePosition.y);this._performDrag(dx,dy);this.previousMousePosition=currentMousePosition;};dockspawn.DraggableContainer.prototype._performDrag=function(dx,dy){var left=dx+getPixels(this.topLevelElement.style.marginLeft);var top=dy+getPixels(this.topLevelElement.style.marginTop);this.topLevelElement.style.marginLeft=left+"px";this.topLevelElement.style.marginTop=top+"px";};dockspawn.ResizableContainer=function(dialog,delegate,topLevelElement){this.dialog=dialog;this.delegate=delegate;this.containerElement=delegate.containerElement;this.dockManager=delegate.dockManager;this.topLevelElement=topLevelElement;this.containerType=delegate.containerType;this.topLevelElement.style.marginLeft=this.topLevelElement.offsetLeft+"px";this.topLevelElement.style.marginTop=this.topLevelElement.offsetTop+"px";this.minimumAllowedChildNodes=delegate.minimumAllowedChildNodes;this._buildResizeHandles();this.readyToProcessNextResize=true;};dockspawn.ResizableContainer.prototype.setActiveChild=function(child){};dockspawn.ResizableContainer.prototype._buildResizeHandles=function(){this.resizeHandles=[];this._buildResizeHandle(false,true,true,false);this._buildResizeHandle(true,false,false,true);this._buildResizeHandle(false,true,false,true);this._buildResizeHandle(true,false,false,false);this._buildResizeHandle(false,true,false,false);this._buildResizeHandle(false,false,true,false);this._buildResizeHandle(false,false,false,true);};dockspawn.ResizableContainer.prototype._buildResizeHandle=function(east,west,north,south){var handle=new ResizeHandle();handle.east=east;handle.west=west;handle.north=north;handle.south=south;handle.element=document.createElement('div');this.topLevelElement.appendChild(handle.element);var verticalClass="";var horizontalClass="";if(north)verticalClass="n";if(south)verticalClass="s";if(east)horizontalClass="e";if(west)horizontalClass="w";var cssClass="resize-handle-"+verticalClass+horizontalClass;if(verticalClass.length>0&&horizontalClass.length>0)handle.corner=true;handle.element.classList.add(handle.corner?"resize-handle-corner":"resize-handle");handle.element.classList.add(cssClass);this.resizeHandles.push(handle);var self=this;handle.mouseDownHandler=new dockspawn.EventHandler(handle.element,'mousedown',function(e){self.onMouseDown(handle,e);});};dockspawn.ResizableContainer.prototype.saveState=function(state){this.delegate.saveState(state);};dockspawn.ResizableContainer.prototype.loadState=function(state){this.delegate.loadState(state);};Object.defineProperty(dockspawn.ResizableContainer.prototype,"width",{get:function get(){return this.delegate.width;}});Object.defineProperty(dockspawn.ResizableContainer.prototype,"height",{get:function get(){return this.delegate.height;}});dockspawn.ResizableContainer.prototype.name=function(value){if(value)this.delegate.name=value;return this.delegate.name;};dockspawn.ResizableContainer.prototype.resize=function(width,height){this.delegate.resize(width,height);this._adjustResizeHandles(width,height);};dockspawn.ResizableContainer.prototype._adjustResizeHandles=function(width,height){var self=this;this.resizeHandles.forEach(function(handle){handle.adjustSize(self.topLevelElement,width,height);});};dockspawn.ResizableContainer.prototype.performLayout=function(children){this.delegate.performLayout(children);};dockspawn.ResizableContainer.prototype.destroy=function(){this.removeDecorator();this.delegate.destroy();};dockspawn.ResizableContainer.prototype.removeDecorator=function(){};dockspawn.ResizableContainer.prototype.onMouseMoved=function(handle,e){if(!this.readyToProcessNextResize)return;this.readyToProcessNextResize=false;this.dockManager.suspendLayout();var currentMousePosition=new Point(e.pageX,e.pageY);var dx=Math.floor(currentMousePosition.x-this.previousMousePosition.x);var dy=Math.floor(currentMousePosition.y-this.previousMousePosition.y);this._performDrag(handle,dx,dy);this.previousMousePosition=currentMousePosition;this.readyToProcessNextResize=true;this.dockManager.resumeLayout();};dockspawn.ResizableContainer.prototype.onMouseDown=function(handle,event){this.previousMousePosition=new Point(event.pageX,event.pageY);if(handle.mouseMoveHandler){handle.mouseMoveHandler.cancel();delete handle.mouseMoveHandler;}
if(handle.mouseUpHandler){handle.mouseUpHandler.cancel();delete handle.mouseUpHandler;}
var self=this;handle.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',function(e){self.onMouseMoved(handle,e);});handle.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',function(e){self.onMouseUp(handle,e);});document.body.classList.add("disable-selection");};dockspawn.ResizableContainer.prototype.onMouseUp=function(handle,event){handle.mouseMoveHandler.cancel();handle.mouseUpHandler.cancel();delete handle.mouseMoveHandler;delete handle.mouseUpHandler;document.body.classList.remove("disable-selection");};dockspawn.ResizableContainer.prototype._performDrag=function(handle,dx,dy){var bounds={};bounds.left=getPixels(this.topLevelElement.style.marginLeft);bounds.top=getPixels(this.topLevelElement.style.marginTop);bounds.width=this.topLevelElement.clientWidth;bounds.height=this.topLevelElement.clientHeight;if(handle.east)this._resizeEast(dx,bounds);if(handle.west)this._resizeWest(dx,bounds);if(handle.north)this._resizeNorth(dy,bounds);if(handle.south)this._resizeSouth(dy,bounds);};dockspawn.ResizableContainer.prototype._resizeWest=function(dx,bounds){this._resizeContainer(dx,0,-dx,0,bounds);};dockspawn.ResizableContainer.prototype._resizeEast=function(dx,bounds){this._resizeContainer(0,0,dx,0,bounds);};dockspawn.ResizableContainer.prototype._resizeNorth=function(dy,bounds){this._resizeContainer(0,dy,0,-dy,bounds);};dockspawn.ResizableContainer.prototype._resizeSouth=function(dy,bounds){this._resizeContainer(0,0,0,dy,bounds);};dockspawn.ResizableContainer.prototype._resizeContainer=function(leftDelta,topDelta,widthDelta,heightDelta,bounds){bounds.left+=leftDelta;bounds.top+=topDelta;bounds.width+=widthDelta;bounds.height+=heightDelta;var minWidth=50;var minHeight=50;bounds.width=Math.max(bounds.width,minWidth);bounds.height=Math.max(bounds.height,minHeight);this.topLevelElement.style.marginLeft=bounds.left+"px";this.topLevelElement.style.marginTop=bounds.top+"px";this.resize(bounds.width,bounds.height);};function ResizeHandle(){this.element=undefined;this.handleSize=6;this.cornerSize=12;this.east=false;this.west=false;this.north=false;this.south=false;this.corner=false;}
ResizeHandle.prototype.adjustSize=function(container,clientWidth,clientHeight){if(this.corner){if(this.west)this.element.style.left="0px";if(this.east)this.element.style.left=clientWidth-this.cornerSize+"px";if(this.north)this.element.style.top="0px";if(this.south)this.element.style.top=clientHeight-this.cornerSize+"px";}else{if(this.west){this.element.style.left="0px";this.element.style.top=this.cornerSize+"px";}
if(this.east){this.element.style.left=clientWidth-this.handleSize+"px";this.element.style.top=this.cornerSize+"px";}
if(this.north){this.element.style.left=this.cornerSize+"px";this.element.style.top="0px";}
if(this.south){this.element.style.left=this.cornerSize+"px";this.element.style.top=clientHeight-this.handleSize+"px";}
if(this.west||this.east){this.element.style.height=clientHeight-this.cornerSize*2+"px";}else{this.element.style.width=clientWidth-this.cornerSize*2+"px";}}};dockspawn.Exception=function(message){this.message=message;};dockspawn.Exception.prototype.toString=function(){return this.message;};dockspawn.DockManager=function(element){if(element===undefined)throw new dockspawn.Exception("Invalid Dock Manager element provided");this.element=element;this.context=this.dockWheel=this.layoutEngine=this.mouseMoveHandler=undefined;this.layoutEventListeners=[];};dockspawn.DockManager.prototype.initialize=function(){this.context=new dockspawn.DockManagerContext(this);var documentNode=new dockspawn.DockNode(this.context.documentManagerView);this.context.model.rootNode=documentNode;this.context.model.documentManagerNode=documentNode;this.setRootNode(this.context.model.rootNode);this.resize(this.element.clientWidth,this.element.clientHeight);this.dockWheel=new dockspawn.DockWheel(this);this.layoutEngine=new dockspawn.DockLayoutEngine(this);this.rebuildLayout(this.context.model.rootNode);};dockspawn.DockManager.prototype.rebuildLayout=function(node){var self=this;node.children.forEach(function(child){self.rebuildLayout(child);});node.performLayout();};dockspawn.DockManager.prototype.invalidate=function(){this.resize(this.element.clientWidth,this.element.clientHeight);};dockspawn.DockManager.prototype.resize=function(width,height){this.element.style.width=width+"px";this.element.style.height=height+"px";this.context.model.rootNode.container.resize(width,height);};dockspawn.DockManager.prototype.setModel=function(model){removeNode(this.context.documentManagerView.containerElement);this.context.model=model;this.setRootNode(model.rootNode);this.rebuildLayout(model.rootNode);this.invalidate();};dockspawn.DockManager.prototype.setRootNode=function(node){if(this.context.model.rootNode){}
node.detachFromParent();this.context.model.rootNode=node;this.element.appendChild(node.container.containerElement);};dockspawn.DockManager.prototype.onDialogDragStarted=function(sender,e){this.dockWheel.activeNode=this._findNodeOnPoint(e.pageX,e.pageY);this.dockWheel.activeDialog=sender;this.dockWheel.showWheel();if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMoved.bind(this));};dockspawn.DockManager.prototype.onDialogDragEnded=function(sender,e){if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.dockWheel.onDialogDropped(sender);this.dockWheel.hideWheel();delete this.dockWheel.activeDialog;};dockspawn.DockManager.prototype.onMouseMoved=function(e){this.dockWheel.activeNode=this._findNodeOnPoint(e.clientX,e.clientY);};dockspawn.DockManager.prototype._findNodeOnPoint=function(x,y){var stack=[];stack.push(this.context.model.rootNode);var bestMatch;while(stack.length>0){var topNode=stack.pop();if(isPointInsideNode(x,y,topNode)){bestMatch=topNode;[].push.apply(stack,topNode.children);}}
return bestMatch;};dockspawn.DockManager.prototype.dockDialogLeft=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockLeft.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogRight=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockRight.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogUp=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockUp.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogDown=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockDown.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogFill=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockFill.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockLeft=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockLeft.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockRight=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockRight.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockUp=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockUp.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockDown=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockDown.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockFill=function(referenceNode,container){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockFill.bind(this.layoutEngine));};dockspawn.DockManager.prototype._requestDockDialog=function(referenceNode,dialog,layoutDockFunction){var panel=dialog.panel;var newNode=new dockspawn.DockNode(panel);panel.prepareForDocking();dialog.destroy();layoutDockFunction(referenceNode,newNode);this.invalidate();return newNode;};dockspawn.DockManager.prototype._requestDockContainer=function(referenceNode,container,layoutDockFunction,ratio){var newNode=new dockspawn.DockNode(container);if(container.containerType=="panel"){var panel=container;panel.prepareForDocking();removeNode(panel.elementPanel);}
layoutDockFunction(referenceNode,newNode);if(ratio&&newNode.parent&&(newNode.parent.container.containerType=="vertical"||newNode.parent.container.containerType=="horizontal")){var splitter=newNode.parent.container;splitter.setContainerRatio(container,ratio);}
this.rebuildLayout(this.context.model.rootNode);this.invalidate();return newNode;};dockspawn.DockManager.prototype.requestUndockToDialog=function(container,event,dragOffset){var node=this._findNodeFromContainer(container);this.layoutEngine.undock(node);var dialog=new dockspawn.Dialog(node.container,this);var dialogWidth=dialog.elementDialog.clientWidth;if(dragOffset.x>dialogWidth)dragOffset.x=0.75*dialogWidth;dialog.setPosition(event.clientX-dragOffset.x,event.clientY-dragOffset.y);dialog.draggable.onMouseDown(event);return dialog;};dockspawn.DockManager.prototype.requestUndock=function(container){var node=this._findNodeFromContainer(container);this.layoutEngine.undock(node);};dockspawn.DockManager.prototype.requestRemove=function(container){var node=this._findNodeFromContainer(container);var parent=node.parent;node.detachFromParent();if(parent)this.rebuildLayout(parent);return node;};dockspawn.DockManager.prototype._findNodeFromContainer=function(container){var stack=[];stack.push(this.context.model.rootNode);while(stack.length>0){var topNode=stack.pop();if(topNode.container===container)return topNode;[].push.apply(stack,topNode.children);}
throw new dockspawn.Exception("Cannot find dock node belonging to the element");};dockspawn.DockManager.prototype.addLayoutListener=function(listener){this.layoutEventListeners.push(listener);};dockspawn.DockManager.prototype.removeLayoutListener=function(listener){this.layoutEventListeners.splice(this.layoutEventListeners.indexOf(listener),1);};dockspawn.DockManager.prototype.suspendLayout=function(){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onSuspendLayout)listener.onSuspendLayout(self);});};dockspawn.DockManager.prototype.resumeLayout=function(){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onResumeLayout)listener.onResumeLayout(self);});};dockspawn.DockManager.prototype.notifyOnDock=function(dockNode){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onDock){listener.onDock(self,dockNode);}});};dockspawn.DockManager.prototype.notifyOnUnDock=function(dockNode){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onUndock){listener.onUndock(self,dockNode);}});};dockspawn.DockManager.prototype.saveState=function(){var serializer=new dockspawn.DockGraphSerializer();return serializer.serialize(this.context.model);};dockspawn.DockManager.prototype.loadState=function(json){var deserializer=new dockspawn.DockGraphDeserializer(this);this.context.model=deserializer.deserialize(json);this.setModel(this.context.model);};dockspawn.DockLayoutEngine=function(dockManager){this.dockManager=dockManager;};dockspawn.DockLayoutEngine.prototype.dockLeft=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"horizontal",true);};dockspawn.DockLayoutEngine.prototype.dockRight=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"horizontal",false);};dockspawn.DockLayoutEngine.prototype.dockUp=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"vertical",true);};dockspawn.DockLayoutEngine.prototype.dockDown=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"vertical",false);};dockspawn.DockLayoutEngine.prototype.dockFill=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"fill",false);};dockspawn.DockLayoutEngine.prototype.undock=function(node){var parentNode=node.parent;if(!parentNode)throw new dockspawn.Exception("Cannot undock.  panel is not a leaf node");var siblingIndex=parentNode.children.indexOf(node);node.detachFromParent();if(parentNode.children.length<parentNode.container.minimumAllowedChildNodes){var grandParent=parentNode.parent;for(var i=0;i<parentNode.children.length;i++){var otherChild=parentNode.children[i];if(grandParent){grandParent.addChildAfter(parentNode,otherChild);parentNode.detachFromParent();parentNode.container.destroy();grandParent.performLayout();}else{parentNode.detachFromParent();parentNode.container.destroy();this.dockManager.setRootNode(otherChild);}}}else{parentNode.performLayout();if(parentNode.children.length>0){var nextActiveSibling=parentNode.children[Math.max(0,siblingIndex-1)];parentNode.container.setActiveChild(nextActiveSibling.container);}}
this.dockManager.invalidate();this.dockManager.notifyOnUnDock(node);};dockspawn.DockLayoutEngine.prototype._performDock=function(referenceNode,newNode,direction,insertBeforeReference){if(referenceNode.parent&&referenceNode.parent.container.containerType=="fill")referenceNode=referenceNode.parent;if(direction=="fill"&&referenceNode.container.containerType=="fill"){referenceNode.addChild(newNode);referenceNode.performLayout();referenceNode.container.setActiveChild(newNode.container);return;}
var model=this.dockManager.context.model;if(referenceNode===model.rootNode){var compositeContainer=this._createDockContainer(direction,newNode,referenceNode);var compositeNode=new dockspawn.DockNode(compositeContainer);if(insertBeforeReference){compositeNode.addChild(newNode);compositeNode.addChild(referenceNode);}else{compositeNode.addChild(referenceNode);compositeNode.addChild(newNode);}
this.dockManager.setRootNode(compositeNode);this.dockManager.rebuildLayout(this.dockManager.context.model.rootNode);compositeNode.container.setActiveChild(newNode.container);return;}
if(referenceNode.parent.container.containerType!=direction){var referenceParent=referenceNode.parent;var referenceNodeWidth=referenceNode.container.containerElement.clientWidth;var referenceNodeHeight=referenceNode.container.containerElement.clientHeight;var referenceNodeParentWidth=referenceParent.container.containerElement.clientWidth;var referenceNodeParentHeight=referenceParent.container.containerElement.clientHeight;var compositeContainer=this._createDockContainer(direction,newNode,referenceNode);var compositeNode=new dockspawn.DockNode(compositeContainer);referenceParent.addChildAfter(referenceNode,compositeNode);referenceNode.detachFromParent();removeNode(referenceNode.container.containerElement);if(insertBeforeReference){compositeNode.addChild(newNode);compositeNode.addChild(referenceNode);}else{compositeNode.addChild(referenceNode);compositeNode.addChild(newNode);}
referenceParent.performLayout();compositeNode.performLayout();compositeNode.container.setActiveChild(newNode.container);compositeNode.container.resize(referenceNodeWidth,referenceNodeHeight);referenceParent.container.resize(referenceNodeParentWidth,referenceNodeParentHeight);}else{var referenceParent=referenceNode.parent;if(insertBeforeReference)referenceParent.addChildBefore(referenceNode,newNode);else referenceParent.addChildAfter(referenceNode,newNode);referenceParent.performLayout();referenceParent.container.setActiveChild(newNode.container);}
var containerWidth=newNode.container.containerElement.clientWidth;var containerHeight=newNode.container.containerElement.clientHeight;newNode.container.resize(containerWidth,containerHeight);this.dockManager.notifyOnDock(newNode);};dockspawn.DockLayoutEngine.prototype._forceResizeCompositeContainer=function(container){var width=container.containerElement.clientWidth;var height=container.containerElement.clientHeight;container.resize(width,height);};dockspawn.DockLayoutEngine.prototype._createDockContainer=function(containerType,newNode,referenceNode){if(containerType=="horizontal")return new dockspawn.HorizontalDockContainer(this.dockManager,[newNode.container,referenceNode.container]);if(containerType=="vertical")return new dockspawn.VerticalDockContainer(this.dockManager,[newNode.container,referenceNode.container]);if(containerType=="fill")return new dockspawn.FillDockContainer(this.dockManager);throw new dockspawn.Exception("Failed to create dock container of type: "+containerType);};dockspawn.DockLayoutEngine.prototype.getDockBounds=function(referenceNode,containerToDock,direction,insertBeforeReference){var compositeNode;var childCount;var childPosition;if(direction=="fill"){var targetElement=referenceNode.container.containerElement;var bounds=new Rectangle();bounds.x=targetElement.offsetLeft;bounds.y=targetElement.offsetTop;bounds.width=targetElement.clientWidth;bounds.height=targetElement.clientHeight;return bounds;}
if(referenceNode.parent&&referenceNode.parent.container.containerType=="fill")
referenceNode=referenceNode.parent;var hierarchyModified=false;if(referenceNode.parent&&referenceNode.parent.container.containerType==direction){compositeNode=referenceNode.parent;childCount=compositeNode.children.length;childPosition=compositeNode.children.indexOf(referenceNode)+(insertBeforeReference?0:1);}else{compositeNode=referenceNode;childCount=1;childPosition=insertBeforeReference?0:1;hierarchyModified=true;}
var splitBarSize=5;var targetPanelSize=0;var targetPanelStart=0;if(direction=="vertical"||direction=="horizontal"){var compositeSize=this._getVaringDimension(compositeNode.container,direction)-(childCount-1)*splitBarSize;var newPanelOriginalSize=this._getVaringDimension(containerToDock,direction);var scaleMultiplier=compositeSize/(compositeSize+newPanelOriginalSize);targetPanelSize=newPanelOriginalSize*scaleMultiplier;if(hierarchyModified)targetPanelStart=insertBeforeReference?0:compositeSize*scaleMultiplier;else{for(var i=0;i<childPosition;i++){targetPanelStart+=this._getVaringDimension(compositeNode.children[i].container,direction);}targetPanelStart*=scaleMultiplier;}}
var bounds=new Rectangle();if(direction=="vertical"){bounds.x=compositeNode.container.containerElement.offsetLeft;bounds.y=compositeNode.container.containerElement.offsetTop+targetPanelStart;bounds.width=compositeNode.container.width;bounds.height=targetPanelSize;}else if(direction=="horizontal"){bounds.x=compositeNode.container.containerElement.offsetLeft+targetPanelStart;bounds.y=compositeNode.container.containerElement.offsetTop;bounds.width=targetPanelSize;bounds.height=compositeNode.container.height;}
return bounds;};dockspawn.DockLayoutEngine.prototype._getVaringDimension=function(container,direction){if(direction=="vertical")return container.height;if(direction=="horizontal")return container.width;return 0;};dockspawn.DockManagerContext=function(dockManager){this.dockManager=dockManager;this.model=new dockspawn.DockModel();this.documentManagerView=new dockspawn.DocumentManagerContainer(this.dockManager);};dockspawn.DockModel=function(){this.rootNode=this.documentManagerNode=undefined;};dockspawn.DockNode=function(container){this.container=container;this.children=[];};dockspawn.DockNode.prototype.detachFromParent=function(){if(this.parent){this.parent.removeChild(this);delete this.parent;}};dockspawn.DockNode.prototype.removeChild=function(childNode){var index=this.children.indexOf(childNode);if(index>=0)this.children.splice(index,1);};dockspawn.DockNode.prototype.addChild=function(childNode){childNode.detachFromParent();childNode.parent=this;this.children.push(childNode);};dockspawn.DockNode.prototype.addChildBefore=function(referenceNode,childNode){this._addChildWithDirection(referenceNode,childNode,true);};dockspawn.DockNode.prototype.addChildAfter=function(referenceNode,childNode){this._addChildWithDirection(referenceNode,childNode,false);};dockspawn.DockNode.prototype._addChildWithDirection=function(referenceNode,childNode,before){childNode.detachFromParent();childNode.parent=this;var referenceIndex=this.children.indexOf(referenceNode);var preList=this.children.slice(0,referenceIndex);var postList=this.children.slice(referenceIndex+1,this.children.length);this.children=preList.slice(0);if(before){this.children.push(childNode);this.children.push(referenceNode);}else{this.children.push(referenceNode);this.children.push(childNode);}
Array.prototype.push.apply(this.children,postList);};dockspawn.DockNode.prototype.performLayout=function(){var childContainers=this.children.map(function(childNode){return childNode.container;});this.container.performLayout(childContainers);};dockspawn.DockNode.prototype.debug_DumpTree=function(indent){if(indent===undefined)indent=0;var message=this.container.name;for(var i=0;i<indent;i++){message="\t"+message;}var parentType=this.parent===undefined?"null":this.parent.container.containerType;console.log(">>"+message+" ["+parentType+"]");this.children.forEach(function(childNode){childNode.debug_DumpTree(indent+1);});};dockspawn.DockWheel=function(dockManager){this.dockManager=dockManager;this.elementMainWheel=document.createElement("div");this.elementSideWheel=document.createElement("div");this.wheelItems={};var wheelTypes=["left","right","top","down","fill","left-s","right-s","top-s","down-s"];var self=this;wheelTypes.forEach(function(wheelType){self.wheelItems[wheelType]=new DockWheelItem(self,wheelType);if(wheelType.substr(-2,2)=="-s")
self.elementSideWheel.appendChild(self.wheelItems[wheelType].element);else
self.elementMainWheel.appendChild(self.wheelItems[wheelType].element);});var zIndex=100000;this.elementMainWheel.classList.add("dock-wheel-base");this.elementSideWheel.classList.add("dock-wheel-base");this.elementMainWheel.style.zIndex=zIndex+1;this.elementSideWheel.style.zIndex=zIndex;this.elementPanelPreview=document.createElement("div");this.elementPanelPreview.classList.add("dock-wheel-panel-preview");this.elementPanelPreview.style.zIndex=zIndex-1;this.activeDialog=undefined;this._activeNode=undefined;this._visible=false;};Object.defineProperty(dockspawn.DockWheel.prototype,"activeNode",{get:function get(){return this._activeNode;},set:function set(value){var previousValue=this._activeNode;this._activeNode=value;if(previousValue!==this._activeNode){if(this._visible)this.showWheel();}}});dockspawn.DockWheel.prototype.showWheel=function(){this._visible=true;if(!this.activeNode){removeNode(this.elementMainWheel);removeNode(this.elementSideWheel);return;}
var element=this.activeNode.container.containerElement;var ignore=function(ele){return ele===this.dockManager.context.documentManagerView.element||ele===this.dockManager.context.model.rootNode.container.containerElement;}.call(this,element);removeNode(this.elementMainWheel);if(!ignore){var containerWidth=element.clientWidth;var containerHeight=element.clientHeight;var baseX=Math.floor(containerWidth/2)+element.offsetLeft;var baseY=Math.floor(containerHeight/2)+element.offsetTop;this.elementMainWheel.style.left=baseX+"px";this.elementMainWheel.style.top=baseY+"px";element.appendChild(this.elementMainWheel);}
var sideMargin=20;var dockManagerWidth=this.dockManager.element.clientWidth;var dockManagerHeight=this.dockManager.element.clientHeight;var dockManagerOffsetX=this.dockManager.element.offsetLeft;var dockManagerOffsetY=this.dockManager.element.offsetTop;removeNode(this.elementSideWheel);this.dockManager.element.appendChild(this.elementSideWheel);if(!ignore){this._setWheelButtonPosition("top-s",dockManagerWidth/2,-dockManagerHeight+sideMargin);this._setWheelButtonPosition("down-s",dockManagerWidth/2,-sideMargin);}else{removeNode(this.wheelItems['top-s'].element);removeNode(this.wheelItems['down-s'].element);}
this._setWheelButtonPosition("left-s",sideMargin,-dockManagerHeight/2);this._setWheelButtonPosition("right-s",dockManagerWidth-sideMargin*2,-dockManagerHeight/2);};dockspawn.DockWheel.prototype._setWheelButtonPosition=function(wheelId,left,top){var item=this.wheelItems[wheelId];var itemHalfWidth=item.element.clientWidth/2;var itemHalfHeight=item.element.clientHeight/2;var x=Math.floor(left-itemHalfWidth);var y=Math.floor(top-itemHalfHeight);item.element.style.marginLeft=x+"px";item.element.style.marginTop=y+"px";};dockspawn.DockWheel.prototype.hideWheel=function(){this._visible=false;this.activeNode=undefined;removeNode(this.elementMainWheel);removeNode(this.elementSideWheel);removeNode(this.elementPanelPreview);for(var wheelType in this.wheelItems){this.wheelItems[wheelType].active=false;}};dockspawn.DockWheel.prototype.onMouseOver=function(wheelItem,e){if(!this.activeDialog)return;var rootNode=this.dockManager.context.model.rootNode;var bounds;if(wheelItem.id=="top"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",true);}else if(wheelItem.id=="down"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",false);}else if(wheelItem.id=="left"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",true);}else if(wheelItem.id=="right"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",false);}else if(wheelItem.id=="fill"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"fill",false);}else if(wheelItem.id=="top-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"vertical",true);}else if(wheelItem.id=="down-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"vertical",false);}else if(wheelItem.id=="left-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"horizontal",true);}else if(wheelItem.id=="right-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"horizontal",false);}
if(bounds){this.dockManager.element.appendChild(this.elementPanelPreview);this.elementPanelPreview.style.left=Math.round(bounds.x)+"px";this.elementPanelPreview.style.top=Math.round(bounds.y)+"px";this.elementPanelPreview.style.width=Math.round(bounds.width)+"px";this.elementPanelPreview.style.height=Math.round(bounds.height)+"px";}};dockspawn.DockWheel.prototype.onMouseOut=function(wheelItem,e){removeNode(this.elementPanelPreview);};dockspawn.DockWheel.prototype.onDialogDropped=function(dialog){var wheelItem=this._getActiveWheelItem();if(wheelItem)this._handleDockRequest(wheelItem,dialog);};dockspawn.DockWheel.prototype._getActiveWheelItem=function(){for(var wheelType in this.wheelItems){var wheelItem=this.wheelItems[wheelType];if(wheelItem.active)return wheelItem;}
return undefined;};dockspawn.DockWheel.prototype._handleDockRequest=function(wheelItem,dialog){if(!this.activeNode)return;if(wheelItem.id=="left"){this.dockManager.dockDialogLeft(this.activeNode,dialog);}else if(wheelItem.id=="right"){this.dockManager.dockDialogRight(this.activeNode,dialog);}else if(wheelItem.id=="top"){this.dockManager.dockDialogUp(this.activeNode,dialog);}else if(wheelItem.id=="down"){this.dockManager.dockDialogDown(this.activeNode,dialog);}else if(wheelItem.id=="fill"){this.dockManager.dockDialogFill(this.activeNode,dialog);}else if(wheelItem.id=="left-s"){this.dockManager.dockDialogLeft(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="right-s"){this.dockManager.dockDialogRight(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="top-s"){this.dockManager.dockDialogUp(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="down-s"){this.dockManager.dockDialogDown(this.dockManager.context.model.rootNode,dialog);}};function DockWheelItem(wheel,id){this.wheel=wheel;this.id=id;var wheelType=id.replace("-s","");this.element=document.createElement("div");this.element.classList.add("dock-wheel-item");this.element.classList.add("disable-selection");this.element.classList.add("dock-wheel-"+wheelType);this.element.classList.add("dock-wheel-"+wheelType+"-icon");this.hoverIconClass="dock-wheel-"+wheelType+"-icon-hover";this.mouseOverHandler=new dockspawn.EventHandler(this.element,'mouseover',this.onMouseMoved.bind(this));this.mouseOutHandler=new dockspawn.EventHandler(this.element,'mouseout',this.onMouseOut.bind(this));this.active=false;};DockWheelItem.prototype.onMouseMoved=function(e){this.active=true;this.element.classList.add(this.hoverIconClass);this.wheel.onMouseOver(this,e);};DockWheelItem.prototype.onMouseOut=function(e){this.active=false;this.element.classList.remove(this.hoverIconClass);this.wheel.onMouseOut(this,e);};dockspawn.FillDockContainer=function(dockManager,tabStripDirection){if(arguments.length==0)return;if(tabStripDirection===undefined)tabStripDirection=dockspawn.TabHost.DIRECTION_BOTTOM;this.dockManager=dockManager;this.tabOrientation=tabStripDirection;this.name=getNextId("fill_");this.element=document.createElement("div");this.containerElement=this.element;this.containerType="fill";this.minimumAllowedChildNodes=2;this.element.classList.add("dock-container");this.element.classList.add("dock-container-fill");this.tabHost=new dockspawn.TabHost(this.tabOrientation);this.element.appendChild(this.tabHost.hostElement);};dockspawn.FillDockContainer.prototype.setActiveChild=function(child){this.tabHost.setActiveTab(child);};dockspawn.FillDockContainer.prototype.resize=function(width,height){this.element.style.width=width+"px";this.element.style.height=height+"px";this.tabHost.resize(width,height);};dockspawn.FillDockContainer.prototype.performLayout=function(children){this.tabHost.performLayout(children);};dockspawn.FillDockContainer.prototype.destroy=function(){if(removeNode(this.element))delete this.element;};dockspawn.FillDockContainer.prototype.saveState=function(state){state.width=this.width;state.height=this.height;};dockspawn.FillDockContainer.prototype.loadState=function(state){this.width=state.width;this.height=state.height;};Object.defineProperty(dockspawn.FillDockContainer.prototype,"width",{get:function get(){return this.element.clientWidth;},set:function set(value){this.element.style.width=value+"px";}});Object.defineProperty(dockspawn.FillDockContainer.prototype,"height",{get:function get(){return this.element.clientHeight;},set:function set(value){this.element.style.height=value+"px";}});dockspawn.DocumentManagerContainer=function(dockManager){dockspawn.FillDockContainer.call(this,dockManager,dockspawn.TabHost.DIRECTION_TOP);this.minimumAllowedChildNodes=0;this.element.classList.add("document-manager");this.tabHost.createTabPage=this._createDocumentTabPage;this.tabHost.displayCloseButton=true;};dockspawn.DocumentManagerContainer.prototype=new dockspawn.FillDockContainer();dockspawn.DocumentManagerContainer.prototype.constructor=dockspawn.DocumentManagerContainer;dockspawn.DocumentManagerContainer.prototype._createDocumentTabPage=function(tabHost,container){return new dockspawn.DocumentTabPage(tabHost,container);};dockspawn.DocumentManagerContainer.prototype.saveState=function(state){dockspawn.FillDockContainer.prototype.saveState.call(this,state);state.documentManager=true;};dockspawn.DocumentManagerContainer.prototype.selectedTab=function(){return this.tabHost.activeTab;};dockspawn.DocumentTabPage=function(host,container){dockspawn.TabPage.call(this,host,container);if(this.container.containerType=="panel"){this.panel=container;this.containerElement=this.panel.elementContent;removeNode(this.containerElement);}};dockspawn.DocumentTabPage.prototype=new dockspawn.TabPage();dockspawn.DocumentTabPage.prototype.constructor=dockspawn.DocumentTabPage;dockspawn.DocumentTabPage.prototype.destroy=function(){dockspawn.TabPage.prototype.destroy.call(this);removeNode(this.containerElement);this.panel.elementContentHost.appendChild(this.containerElement);};dockspawn.SplitterPanel=function(childContainers,stackedVertical){this.childContainers=childContainers;this.stackedVertical=stackedVertical;this.panelElement=document.createElement('div');this.spiltterBars=[];this._buildSplitterDOM();};dockspawn.SplitterPanel.prototype._buildSplitterDOM=function(){if(this.childContainers.length<=1)throw new dockspawn.Exception("Splitter panel should contain atleast 2 panels");this.spiltterBars=[];for(var i=0;i<this.childContainers.length-1;i++){var previousContainer=this.childContainers[i];var nextContainer=this.childContainers[i+1];var splitterBar=new dockspawn.SplitterBar(previousContainer,nextContainer,this.stackedVertical);this.spiltterBars.push(splitterBar);this._insertContainerIntoPanel(previousContainer);this.panelElement.appendChild(splitterBar.barElement);}
this._insertContainerIntoPanel(this.childContainers.slice(-1)[0]);};dockspawn.SplitterPanel.prototype.performLayout=function(children){this.removeFromDOM();this.childContainers=children;this._buildSplitterDOM();};dockspawn.SplitterPanel.prototype.removeFromDOM=function(){this.childContainers.forEach(function(container){if(container.containerElement){container.containerElement.classList.remove("splitter-container-vertical");container.containerElement.classList.remove("splitter-container-horizontal");removeNode(container.containerElement);}});this.spiltterBars.forEach(function(bar){removeNode(bar.barElement);});};dockspawn.SplitterPanel.prototype.destroy=function(){this.removeFromDOM();this.panelElement.parentNode.removeChild(this.panelElement);};dockspawn.SplitterPanel.prototype._insertContainerIntoPanel=function(container){if(!container){console.log('undefined');}
removeNode(container.containerElement);this.panelElement.appendChild(container.containerElement);container.containerElement.classList.add(this.stackedVertical?"splitter-container-vertical":"splitter-container-horizontal");};dockspawn.SplitterPanel.prototype.setContainerRatio=function(container,ratio){var splitPanelSize=this.stackedVertical?this.panelElement.clientHeight:this.panelElement.clientWidth;var newContainerSize=ratio>1?ratio:splitPanelSize*ratio;var barSize=this.stackedVertical?this.spiltterBars[0].barElement.clientHeight:this.spiltterBars[0].barElement.clientWidth;var otherPanelSizeQuota=splitPanelSize-newContainerSize-barSize*this.spiltterBars.length;var otherPanelScaleMultipler=otherPanelSizeQuota/splitPanelSize;for(var i=0;i<this.childContainers.length;i++){var child=this.childContainers[i];var size;if(child!==container){size=this.stackedVertical?child.containerElement.clientHeight:child.containerElement.clientWidth;size*=otherPanelScaleMultipler;}else size=newContainerSize;if(this.stackedVertical)child.resize(child.width,Math.floor(size));else child.resize(Math.floor(size),child.height);}};dockspawn.SplitterPanel.prototype.resize=function(width,height){if(this.childContainers.length<=1)return;for(var i=0;i<this.childContainers.length;i++){var childContainer=this.childContainers[i];if(this.stackedVertical)childContainer.resize(width,childContainer.height);else childContainer.resize(childContainer.width,height);if(i<this.spiltterBars.length){var splitBar=this.spiltterBars[i];if(this.stackedVertical)splitBar.barElement.style.width=width+"px";else splitBar.barElement.style.height=height+"px";}}
var totalChildPanelSize=0;var self=this;this.childContainers.forEach(function(container){var size=self.stackedVertical?container.height:container.width;totalChildPanelSize+=size;});var barSize=this.stackedVertical?this.spiltterBars[0].barElement.getBoundingClientRect().height:this.spiltterBars[0].barElement.getBoundingClientRect().width;var targetTotalChildPanelSize=this.stackedVertical?height:width;targetTotalChildPanelSize-=barSize*this.spiltterBars.length;totalChildPanelSize=Math.max(totalChildPanelSize,1);var scaleMultiplier=targetTotalChildPanelSize/totalChildPanelSize;var updatedTotalChildPanelSize=0;for(var i=0;i<this.childContainers.length;i++){var child=this.childContainers[i];var original=this.stackedVertical?child.containerElement.clientHeight:child.containerElement.clientWidth;var newSize=Math.floor(original*scaleMultiplier);updatedTotalChildPanelSize+=newSize;if(i==this.childContainers.length-1)newSize+=targetTotalChildPanelSize-updatedTotalChildPanelSize;if(this.stackedVertical)child.resize(child.width,newSize);else child.resize(newSize,child.height);}
this.panelElement.style.width=width+"px";this.panelElement.style.height=height+"px";};dockspawn.SplitterDockContainer=function(name,dockManager,childContainers){if(arguments.length==0)return;this.name=name;this.dockManager=dockManager;this.splitterPanel=new dockspawn.SplitterPanel(childContainers,this.stackedVertical);this.containerElement=this.splitterPanel.panelElement;this.minimumAllowedChildNodes=2;};dockspawn.SplitterDockContainer.prototype.resize=function(width,height){this.splitterPanel.resize(width,height);this._cachedWidth=width;this._cachedHeight=height;};dockspawn.SplitterDockContainer.prototype.performLayout=function(childContainers){this.splitterPanel.performLayout(childContainers);};dockspawn.SplitterDockContainer.prototype.setActiveChild=function(child){};dockspawn.SplitterDockContainer.prototype.destroy=function(){this.splitterPanel.destroy();};dockspawn.SplitterDockContainer.prototype.setContainerRatio=function(container,ratio){this.splitterPanel.setContainerRatio(container,ratio);this.resize(this.width,this.height);};dockspawn.SplitterDockContainer.prototype.saveState=function(state){state.width=this.width;state.height=this.height;};dockspawn.SplitterDockContainer.prototype.loadState=function(state){this.resize(state.width,state.height);};Object.defineProperty(dockspawn.SplitterDockContainer.prototype,"width",{get:function get(){if(this._cachedWidth===undefined)this._cachedWidth=this.splitterPanel.panelElement.clientWidth;return this._cachedWidth;}});Object.defineProperty(dockspawn.SplitterDockContainer.prototype,"height",{get:function get(){if(this._cachedHeight===undefined)this._cachedHeight=this.splitterPanel.panelElement.clientHeight;return this._cachedHeight;}});dockspawn.HorizontalDockContainer=function(dockManager,childContainers){this.stackedVertical=false;dockspawn.SplitterDockContainer.call(this,getNextId("horizontal_splitter_"),dockManager,childContainers);this.containerType="horizontal";};dockspawn.HorizontalDockContainer.prototype=new dockspawn.SplitterDockContainer();dockspawn.HorizontalDockContainer.prototype.constructor=dockspawn.HorizontalDockContainer;dockspawn.PanelContainer=function(elementContent,dockManager,title){if(!title)title="Panel";this.elementContent=elementContent;this.dockManager=dockManager;this.title=title;this.containerType="panel";this.iconName="icon-circle-arrow-right";this.minimumAllowedChildNodes=0;this._floatingDialog=undefined;this._initialize();};Object.defineProperty(dockspawn.PanelContainer.prototype,"floatingDialog",{get:function get(){return this._floatingDialog;},set:function set(value){this._floatingDialog=value;var canUndock=this._floatingDialog===undefined;this.undockInitiator.enabled=canUndock;}});dockspawn.PanelContainer.loadFromState=function(state,dockManager){var elementName=state.element;var elementContent=document.getElementById(elementName);var ret=new dockspawn.PanelContainer(elementContent,dockManager);ret.elementContent=elementContent;ret._initialize();ret.loadState(state);return ret;};dockspawn.PanelContainer.prototype.saveState=function(state){state.element=this.elementContent.id;state.width=this.width;state.height=this.height;};dockspawn.PanelContainer.prototype.loadState=function(state){this.width=state.width;this.height=state.height;this.resize(this.width,this.height);};dockspawn.PanelContainer.prototype.setActiveChild=function(child){};Object.defineProperty(dockspawn.PanelContainer.prototype,"containerElement",{get:function get(){return this.elementPanel;}});dockspawn.PanelContainer.prototype._initialize=function(){this.name=getNextId("panel_");this.elementPanel=document.createElement('div');this.elementTitle=document.createElement('div');this.elementTitleText=document.createElement('div');this.elementContentHost=document.createElement('div');this.elementButtonClose=document.createElement('div');this.elementPanel.appendChild(this.elementTitle);this.elementTitle.appendChild(this.elementTitleText);this.elementTitle.appendChild(this.elementButtonClose);this.elementButtonClose.innerHTML='<i class="glyphicon glyphicon-remove"></i>';this.elementButtonClose.classList.add("panel-titlebar-button-close");this.elementPanel.appendChild(this.elementContentHost);this.elementPanel.classList.add("panel-base");this.elementTitle.classList.add("panel-titlebar");this.elementTitle.classList.add("disable-selection");this.elementTitleText.classList.add("panel-titlebar-text");this.elementContentHost.classList.add("panel-content");var panelWidth=this.elementContent.clientWidth;var panelHeight=this.elementContent.clientHeight;var titleHeight=this.elementTitle.clientHeight;this._setPanelDimensions(panelWidth,panelHeight+titleHeight);document.body.appendChild(this.elementPanel);this.closeButtonClickedHandler=new dockspawn.EventHandler(this.elementButtonClose,'click',this.onCloseButtonClicked.bind(this));removeNode(this.elementContent);this.elementContentHost.appendChild(this.elementContent);var contentTitle=this.elementContent.getAttribute('caption');var contentIcon=this.elementContent.getAttribute('icon');if(contentTitle!=null)this.title=contentTitle;if(contentIcon!=null)this.iconName=contentIcon;this._updateTitle();this.undockInitiator=new dockspawn.UndockInitiator(this.elementTitle,this.performUndockToDialog.bind(this));this.floatingDialog=undefined;};dockspawn.PanelContainer.prototype.destroy=function(){removeNode(this.elementPanel);if(this.closeButtonClickedHandler){this.closeButtonClickedHandler.cancel();delete this.closeButtonClickedHandler;}};dockspawn.PanelContainer.prototype.performUndockToDialog=function(e,dragOffset){this.undockInitiator.enabled=false;return this.dockManager.requestUndockToDialog(this,e,dragOffset);};dockspawn.PanelContainer.prototype.performUndock=function(){this.undockInitiator.enabled=false;this.dockManager.requestUndock(this);};dockspawn.PanelContainer.prototype.prepareForDocking=function(){this.undockInitiator.enabled=true;};Object.defineProperty(dockspawn.PanelContainer.prototype,"width",{get:function get(){return this._cachedWidth;},set:function set(value){if(value!==this._cachedWidth){this._cachedWidth=value;this.elementPanel.style.width=value+"px";}}});Object.defineProperty(dockspawn.PanelContainer.prototype,"height",{get:function get(){return this._cachedHeight;},set:function set(value){if(value!==this._cachedHeight){this._cachedHeight=value;this.elementPanel.style.height=value+"px";}}});dockspawn.PanelContainer.prototype.resize=function(width,height){if(this._cachedWidth==width&&this._cachedHeight==height){return;}
this._setPanelDimensions(width,height);this._cachedWidth=width;this._cachedHeight=height;};dockspawn.PanelContainer.prototype._setPanelDimensions=function(width,height){this.elementTitle.style.width=width+"px";this.elementContentHost.style.width=width+"px";this.elementContent.style.width=width+"px";this.elementPanel.style.width=width+"px";var titleBarHeight=this.elementTitle.clientHeight;var contentHeight=height-titleBarHeight;this.elementContentHost.style.height=contentHeight+"px";this.elementContent.style.height=contentHeight+"px";this.elementPanel.style.height=height+"px";};dockspawn.PanelContainer.prototype.setTitle=function(title){this.title=title;this._updateTitle();if(this.onTitleChanged)this.onTitleChanged(this,title);};dockspawn.PanelContainer.prototype.setTitleIcon=function(iconName){this.iconName=iconName;this._updateTitle();};dockspawn.PanelContainer.prototype._updateTitle=function(){this.elementTitleText.innerHTML='<i class="'+this.iconName+'"></i> '+this.title;};dockspawn.PanelContainer.prototype.getRawTitle=function(){return this.elementTitleText.innerHTML;};dockspawn.PanelContainer.prototype.performLayout=function(children){};dockspawn.PanelContainer.prototype.onCloseButtonClicked=function(e){if(this.floatingDialog)this.floatingDialog.destroy();else{this.performUndock();this.destroy();}};dockspawn.VerticalDockContainer=function(dockManager,childContainers){this.stackedVertical=true;dockspawn.SplitterDockContainer.call(this,getNextId("vertical_splitter_"),dockManager,childContainers);this.containerType="vertical";};dockspawn.VerticalDockContainer.prototype=new dockspawn.SplitterDockContainer();dockspawn.VerticalDockContainer.prototype.constructor=dockspawn.VerticalDockContainer;dockspawn.SplitterBar=function(previousContainer,nextContainer,stackedVertical){this.previousContainer=previousContainer;this.nextContainer=nextContainer;this.stackedVertical=stackedVertical;this.barElement=document.createElement('div');this.barElement.classList.add(stackedVertical?"splitbar-horizontal":"splitbar-vertical");this.mouseDownHandler=new dockspawn.EventHandler(this.barElement,'mousedown',this.onMouseDown.bind(this));this.minPanelSize=50;this.readyToProcessNextDrag=true;};dockspawn.SplitterBar.prototype.onMouseDown=function(e){this._startDragging(e);};dockspawn.SplitterBar.prototype.onMouseUp=function(e){this._stopDragging(e);};dockspawn.SplitterBar.prototype.onMouseMoved=function(e){if(!this.readyToProcessNextDrag)return;this.readyToProcessNextDrag=false;var dockManager=this.previousContainer.dockManager;dockManager.suspendLayout();var dx=e.pageX-this.previousMouseEvent.pageX;var dy=e.pageY-this.previousMouseEvent.pageY;this._performDrag(dx,dy);this.previousMouseEvent=e;this.readyToProcessNextDrag=true;dockManager.resumeLayout();};dockspawn.SplitterBar.prototype._performDrag=function(dx,dy){var previousWidth=this.previousContainer.containerElement.clientWidth;var previousHeight=this.previousContainer.containerElement.clientHeight;var nextWidth=this.nextContainer.containerElement.clientWidth;var nextHeight=this.nextContainer.containerElement.clientHeight;var previousPanelSize=this.stackedVertical?previousHeight:previousWidth;var nextPanelSize=this.stackedVertical?nextHeight:nextWidth;var deltaMovement=this.stackedVertical?dy:dx;var newPreviousPanelSize=previousPanelSize+deltaMovement;var newNextPanelSize=nextPanelSize-deltaMovement;if(newPreviousPanelSize<this.minPanelSize||newNextPanelSize<this.minPanelSize){var continueProcessing=newPreviousPanelSize<this.minPanelSize&&newPreviousPanelSize>previousPanelSize||newNextPanelSize<this.minPanelSize&&newNextPanelSize>nextPanelSize;if(!continueProcessing)return;}
if(this.stackedVertical){this.previousContainer.resize(previousWidth,newPreviousPanelSize);this.nextContainer.resize(nextWidth,newNextPanelSize);}else{this.previousContainer.resize(newPreviousPanelSize,previousHeight);this.nextContainer.resize(newNextPanelSize,nextHeight);}};dockspawn.SplitterBar.prototype._startDragging=function(e){disableGlobalTextSelection();if(this.mouseMovedHandler){this.mouseMovedHandler.cancel();delete this.mouseMovedHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
this.mouseMovedHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMoved.bind(this));this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));this.previousMouseEvent=e;};dockspawn.SplitterBar.prototype._stopDragging=function(e){enableGlobalTextSelection();document.body.classList.remove("disable-selection");if(this.mouseMovedHandler){this.mouseMovedHandler.cancel();delete this.mouseMovedHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}};dockspawn.DockGraphDeserializer=function(dockManager){this.dockManager=dockManager;};dockspawn.DockGraphDeserializer.prototype.deserialize=function(json){var graphInfo=JSON.parse(_json);var model=new dockspawn.DockModel();model.rootNode=this._buildGraph(graphInfo);return model;};dockspawn.DockGraphDeserializer.prototype._buildGraph=function(nodeInfo){var childrenInfo=nodeInfo.children;var children=[];var self=this;childrenInfo.forEach(function(childInfo){var childNode=self._buildGraph(childInfo);children.push(childNode);});var container=this._createContainer(nodeInfo,children);var node=new dockspawn.DockNode(container);node.children=children;node.children.forEach(function(childNode){childNode.parent=node;});return node;};dockspawn.DockGraphDeserializer.prototype._createContainer=function(nodeInfo,children){var containerType=nodeInfo.containerType;var containerState=nodeInfo.state;var container;var childContainers=[];children.forEach(function(childNode){childContainers.push(childNode.container);});childContainers=[];if(containerType=="panel")container=new dockspawn.PanelContainer.loadFromState(containerState,this.dockManager);else if(containerType=="horizontal")container=new dockspawn.HorizontalDockContainer(this.dockManager,childContainers);else if(containerType=="vertical")container=new dockspawn.VerticalDockContainer(this.dockManager,childContainers);else if(containerType=="fill"){var typeDocumentManager=containerState.documentManager;if(typeDocumentManager)container=new DocumentManagerContainer(this.dockManager);else container=new dockspawn.FillDockContainer(this.dockManager);}else throw new dockspawn.Exception("Cannot create dock container of unknown type: "+containerType);container.loadState(containerState);container.performLayout(childContainers);return container;};dockspawn.DockGraphSerializer=function(){};dockspawn.DockGraphSerializer.prototype.serialize=function(model){var graphInfo=this._buildGraphInfo(model.rootNode);return JSON.stringify(graphInfo);};dockspawn.DockGraphSerializer.prototype._buildGraphInfo=function(node){var nodeState={};node.container.saveState(nodeState);var childrenInfo=[];var self=this;node.childNodes.forEach(function(childNode){childrenInfo.push(self._buildGraphInfo(childNode));});var nodeInfo={};nodeInfo.containerType=node.container.containerType;nodeInfo.state=nodeState;nodeInfo.children=childrenInfo;return nodeInfo;};function getPixels(pixels){if(pixels==null)return 0;return parseInt(pixels.replace("px",""));}
function disableGlobalTextSelection(){document.body.classList.add("disable-selection");}
function enableGlobalTextSelection(){document.body.classList.remove("disable-selection");}
function isPointInsideNode(px,py,node){var element=node.container.containerElement;var x=element.offsetLeft;var y=element.offsetTop;var width=element.clientWidth;var height=element.clientHeight;return px>=x&&px<=x+width&&py>=y&&py<=y+height;}
function Rectangle(){}
function getNextId(prefix){return prefix+getNextId.counter++;}
getNextId.counter=0;function removeNode(node){if(node.parentNode==null)return false;node.parentNode.removeChild(node);return true;}
function Point(x,y){this.x=x;this.y=y;}
dockspawn.EventHandler=function(source,eventName,target){this.target=target;this.eventName=eventName;this.source=source;this.source.addEventListener(eventName,this.target);};dockspawn.EventHandler.prototype.cancel=function(){this.source.removeEventListener(this.eventName,this.target);};dockspawn.UndockInitiator=function(element,listener,thresholdPixels){if(!thresholdPixels)thresholdPixels=10;this.element=element;this.listener=listener;this.thresholdPixels=thresholdPixels;this._enabled=false;};Object.defineProperty(dockspawn.UndockInitiator.prototype,"enabled",{get:function get(){return this._enabled;},set:function set(value){this._enabled=value;if(this._enabled){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
this.mouseDownHandler=new dockspawn.EventHandler(this.element,'mousedown',this.onMouseDown.bind(this));}else{if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}}}});dockspawn.UndockInitiator.prototype.onMouseDown=function(e){if(this.enabled){if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMove.bind(this));this.dragStartPosition=new Point(e.pageX,e.pageY);}};dockspawn.UndockInitiator.prototype.onMouseUp=function(e){if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}};dockspawn.UndockInitiator.prototype.onMouseMove=function(e){var position=new Point(e.pageX,e.pageY);var dx=position.x-this.dragStartPosition.x;var dy=position.y-this.dragStartPosition.y;var distance=Math.sqrt(dx*dx+dy*dy);if(distance>this.thresholdPixels){this.enabled=false;this._requestUndock(e);}};dockspawn.UndockInitiator.prototype._requestUndock=function(e){var dragOffsetX=this.dragStartPosition.x-this.element.offsetLeft;var dragOffsetY=this.dragStartPosition.y-this.element.offsetTop;var dragOffset=new Point(dragOffsetX,dragOffsetY);this.listener(e,dragOffset);};})();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(q){var I,J,K,L,M,N,v,s={},w={},x={},O={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(b){var a=b.treeObj,c=f.event;a.bind(c.NODECREATED,function(a,c,g){j.apply(b.callback.onNodeCreated,[a,c,g]);});a.bind(c.CLICK,function(a,c,g,m,h){j.apply(b.callback.onClick,[c,g,m,h]);});a.bind(c.EXPAND,function(a,c,g){j.apply(b.callback.onExpand,[a,c,g]);});a.bind(c.COLLAPSE,function(a,c,g){j.apply(b.callback.onCollapse,[a,c,g]);});a.bind(c.ASYNC_SUCCESS,function(a,c,g,h){j.apply(b.callback.onAsyncSuccess,[a,c,g,h]);});a.bind(c.ASYNC_ERROR,function(a,c,g,h,f,i){j.apply(b.callback.onAsyncError,[a,c,g,h,f,i]);});a.bind(c.REMOVE,function(a,c,g){j.apply(b.callback.onRemove,[a,c,g]);});a.bind(c.SELECTED,function(a,c,g){j.apply(b.callback.onSelected,[c,g]);});a.bind(c.UNSELECTED,function(a,c,g){j.apply(b.callback.onUnSelected,[c,g]);});}],z=[function(b){var a=f.event;b.treeObj.unbind(a.NODECREATED).unbind(a.CLICK).unbind(a.EXPAND).unbind(a.COLLAPSE).unbind(a.ASYNC_SUCCESS).unbind(a.ASYNC_ERROR).unbind(a.REMOVE).unbind(a.SELECTED).unbind(a.UNSELECTED);}],A=[function(b){var a=h.getCache(b);a||(a={},h.setCache(b,a));a.nodes=[];a.doms=[];}],B=[function(b,a,c,d,e,g){if(c){var m=h.getRoot(b),f=b.data.key.children;c.level=a;c.tId=b.treeId+"_"+ ++m.zId;c.parentTId=d?d.tId:null;c.open=typeof c.open=="string"?j.eqs(c.open,"true"):!!c.open;c[f]&&c[f].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent=typeof c.isParent=="string"?j.eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!b.async.enable?c.open:!1,c.zAsync=!c.isParent);c.isFirstNode=e;c.isLastNode=g;c.getParentNode=function(){return h.getNodeCache(b,c.parentTId);};c.getPreNode=function(){return h.getPreNode(b,c);};c.getNextNode=function(){return h.getNextNode(b,c);};c.getIndex=function(){return h.getNodeIndex(b,c);};c.getPath=function(){return h.getNodePath(b,c);};c.isAjaxing=!1;h.fixPIdKeyValue(b,c);}}],u=[function(b){var a=b.target,c=h.getSetting(b.data.treeId),d="",e=null,g="",m="",i=null,n=null,k=null;if(j.eqs(b.type,"mousedown"))m="mousedown";else if(j.eqs(b.type,"mouseup"))m="mouseup";else if(j.eqs(b.type,"contextmenu"))m="contextmenu";else if(j.eqs(b.type,"click")){if(j.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+f.id.SWITCH)!==null)d=j.getNodeMainDom(a).id,g="switchNode";else{if(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}]))d=j.getNodeMainDom(k).id,g="clickNode";}}else if(j.eqs(b.type,"dblclick")&&(m="dblclick",k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id,g="switchNode";if(m.length>0&&d.length==0&&(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id;if(d.length>0)switch(e=h.getNodeCache(c,d),g){case"switchNode":e.isParent?j.eqs(b.type,"click")||j.eqs(b.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand)?i=I:g="":g="";break;case"clickNode":i=J;}switch(m){case"mousedown":n=K;break;case"mouseup":n=L;break;case"dblclick":n=M;break;case"contextmenu":n=N;}return{stop:!1,node:e,nodeEventType:g,nodeEventCallback:i,treeEventType:m,treeEventCallback:n};}],C=[function(b){var a=h.getRoot(b);a||(a={},h.setRoot(b,a));a[b.data.key.children]=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[];a.zId=0;a._ver=new Date().getTime();}],D=[],E=[],F=[],G=[],H=[],h={addNodeCache:function addNodeCache(b,a){h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=a;},getNodeCacheId:function getNodeCacheId(b){return b.substring(b.lastIndexOf("_")+1);},addAfterA:function addAfterA(b){E.push(b);},addBeforeA:function addBeforeA(b){D.push(b);},addInnerAfterA:function addInnerAfterA(b){G.push(b);},addInnerBeforeA:function addInnerBeforeA(b){F.push(b);},addInitBind:function addInitBind(b){y.push(b);},addInitUnBind:function addInitUnBind(b){z.push(b);},addInitCache:function addInitCache(b){A.push(b);},addInitNode:function addInitNode(b){B.push(b);},addInitProxy:function addInitProxy(b,a){a?u.splice(0,0,b):u.push(b);},addInitRoot:function addInitRoot(b){C.push(b);},addNodesData:function addNodesData(b,a,c,d){var e=b.data.key.children;a[e]?c>=a[e].length&&(c=-1):(a[e]=[],c=-1);if(a[e].length>0&&c===0)a[e][0].isFirstNode=!1,i.setNodeLineIcos(b,a[e][0]);else if(a[e].length>0&&c<0)a[e][a[e].length-1].isLastNode=!1,i.setNodeLineIcos(b,a[e][a[e].length-1]);a.isParent=!0;c<0?a[e]=a[e].concat(d):(b=[c,0].concat(d),a[e].splice.apply(a[e],b));},addSelectedNode:function addSelectedNode(b,a){var c=h.getRoot(b);h.isSelectedNode(b,a)||c.curSelectedList.push(a);},addCreatedNode:function addCreatedNode(b,a){(b.callback.onNodeCreated||b.view.addDiyDom)&&h.getRoot(b).createdNodes.push(a);},addZTreeTools:function addZTreeTools(b){H.push(b);},exSetting:function exSetting(b){q.extend(!0,O,b);},fixPIdKeyValue:function fixPIdKeyValue(b,a){b.data.simpleData.enable&&(a[b.data.simpleData.pIdKey]=a.parentTId?a.getParentNode()[b.data.simpleData.idKey]:b.data.simpleData.rootPId);},getAfterA:function getAfterA(b,a,c){for(var d=0,e=E.length;d<e;d++){E[d].apply(this,arguments);}},getBeforeA:function getBeforeA(b,a,c){for(var d=0,e=D.length;d<e;d++){D[d].apply(this,arguments);}},getInnerAfterA:function getInnerAfterA(b,a,c){for(var d=0,e=G.length;d<e;d++){G[d].apply(this,arguments);}},getInnerBeforeA:function getInnerBeforeA(b,a,c){for(var d=0,e=F.length;d<e;d++){F[d].apply(this,arguments);}},getCache:function getCache(b){return x[b.treeId];},getNodeIndex:function getNodeIndex(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e;}return-1;},getNextNode:function getNextNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e==g?null:d[c][e+1];}return null;},getNodeByParam:function getNodeByParam(b,a,c,d){if(!a||!c)return null;for(var e=b.data.key.children,g=0,f=a.length;g<f;g++){if(a[g][c]==d)return a[g];var i=h.getNodeByParam(b,a[g][e],c,d);if(i)return i;}return null;},getNodeCache:function getNodeCache(b,a){if(!a)return null;var c=x[b.treeId].nodes[h.getNodeCacheId(a)];return c?c:null;},getNodeName:function getNodeName(b,a){return""+a[b.data.key.name];},getNodePath:function getNodePath(b,a){if(!a)return null;var c;(c=a.parentTId?a.getParentNode().getPath():[])&&c.push(a);return c;},getNodeTitle:function getNodeTitle(b,a){return""+a[b.data.key.title===""?b.data.key.name:b.data.key.title];},getNodes:function getNodes(b){return h.getRoot(b)[b.data.key.children];},getNodesByParam:function getNodesByParam(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],f=0,i=a.length;f<i;f++){a[f][c]==d&&g.push(a[f]),g=g.concat(h.getNodesByParam(b,a[f][e],c,d));}return g;},getNodesByParamFuzzy:function getNodesByParamFuzzy(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],d=d.toLowerCase(),f=0,i=a.length;f<i;f++){typeof a[f][c]=="string"&&a[f][c].toLowerCase().indexOf(d)>-1&&g.push(a[f]),g=g.concat(h.getNodesByParamFuzzy(b,a[f][e],c,d));}return g;},getNodesByFilter:function getNodesByFilter(b,a,c,d,e){if(!a)return d?null:[];for(var g=b.data.key.children,f=d?null:[],i=0,n=a.length;i<n;i++){if(j.apply(c,[a[i],e],!1)){if(d)return a[i];f.push(a[i]);}var k=h.getNodesByFilter(b,a[i][g],c,d,e);if(d&&k)return k;f=d?k:f.concat(k);}return f;},getPreNode:function getPreNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length;e<g;e++){if(d[c][e]===a)return e==0?null:d[c][e-1];}return null;},getRoot:function getRoot(b){return b?w[b.treeId]:null;},getRoots:function getRoots(){return w;},getSetting:function getSetting(b){return s[b];},getSettings:function getSettings(){return s;},getZTreeTools:function getZTreeTools(b){return(b=this.getRoot(this.getSetting(b)))?b.treeTools:null;},initCache:function initCache(b){for(var a=0,c=A.length;a<c;a++){A[a].apply(this,arguments);}},initNode:function initNode(b,a,c,d,e,g){for(var f=0,h=B.length;f<h;f++){B[f].apply(this,arguments);}},initRoot:function initRoot(b){for(var a=0,c=C.length;a<c;a++){C[a].apply(this,arguments);}},isSelectedNode:function isSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d])return!0;}return!1;},removeNodeCache:function removeNodeCache(b,a){var c=b.data.key.children;if(a[c])for(var d=0,e=a[c].length;d<e;d++){arguments.callee(b,a[c][d]);}h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=null;},removeSelectedNode:function removeSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d]||!h.getNodeCache(b,c.curSelectedList[d].tId))c.curSelectedList.splice(d,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,a]),d--,e--;}},setCache:function setCache(b,a){x[b.treeId]=a;},setRoot:function setRoot(b,a){w[b.treeId]=a;},setZTreeTools:function setZTreeTools(b,a){for(var c=0,d=H.length;c<d;c++){H[c].apply(this,arguments);}},transformToArrayFormat:function transformToArrayFormat(b,a){if(!a)return[];var c=b.data.key.children,d=[];if(j.isArray(a))for(var e=0,g=a.length;e<g;e++){d.push(a[e]),a[e][c]&&(d=d.concat(h.transformToArrayFormat(b,a[e][c])));}else d.push(a),a[c]&&(d=d.concat(h.transformToArrayFormat(b,a[c])));return d;},transformTozTreeFormat:function transformTozTreeFormat(b,a){var c,d,e=b.data.simpleData.idKey,g=b.data.simpleData.pIdKey,f=b.data.key.children;if(!e||e==""||!a)return[];if(j.isArray(a)){var h=[],i=[];for(c=0,d=a.length;c<d;c++){i[a[c][e]]=a[c];}for(c=0,d=a.length;c<d;c++){i[a[c][g]]&&a[c][e]!=a[c][g]?(i[a[c][g]][f]||(i[a[c][g]][f]=[]),i[a[c][g]][f].push(a[c])):h.push(a[c]);}return h;}else return[a];}},l={bindEvent:function bindEvent(b){for(var a=0,c=y.length;a<c;a++){y[a].apply(this,arguments);}},unbindEvent:function unbindEvent(b){for(var a=0,c=z.length;a<c;a++){z[a].apply(this,arguments);}},bindTree:function bindTree(b){var a={treeId:b.treeId},c=b.treeObj;b.view.txtSelectedEnable||c.bind("selectstart",v).css({"-moz-user-select":"-moz-none"});c.bind("click",a,l.proxy);c.bind("dblclick",a,l.proxy);c.bind("mouseover",a,l.proxy);c.bind("mouseout",a,l.proxy);c.bind("mousedown",a,l.proxy);c.bind("mouseup",a,l.proxy);c.bind("contextmenu",a,l.proxy);},unbindTree:function unbindTree(b){b.treeObj.unbind("selectstart",v).unbind("click",l.proxy).unbind("dblclick",l.proxy).unbind("mouseover",l.proxy).unbind("mouseout",l.proxy).unbind("mousedown",l.proxy).unbind("mouseup",l.proxy).unbind("contextmenu",l.proxy);},doProxy:function doProxy(b){for(var a=[],c=0,d=u.length;c<d;c++){var e=u[c].apply(this,arguments);a.push(e);if(e.stop)break;}return a;},proxy:function proxy(b){var a=h.getSetting(b.data.treeId);if(!j.uCanDo(a,b))return!0;for(var a=l.doProxy(b),c=!0,d=0,e=a.length;d<e;d++){var g=a[d];g.nodeEventCallback&&(c=g.nodeEventCallback.apply(g,[b,g.node])&&c);g.treeEventCallback&&(c=g.treeEventCallback.apply(g,[b,g.node])&&c);}return c;}};I=function I(b,a){var c=h.getSetting(b.data.treeId);if(a.open){if(j.apply(c.callback.beforeCollapse,[c.treeId,a],!0)==!1)return!0;}else if(j.apply(c.callback.beforeExpand,[c.treeId,a],!0)==!1)return!0;h.getRoot(c).expandTriggerFlag=!0;i.switchNode(c,a);return!0;};J=function J(b,a){var c=h.getSetting(b.data.treeId),d=c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&h.isSelectedNode(c,a)?0:c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&c.view.selectedMulti?2:1;if(j.apply(c.callback.beforeClick,[c.treeId,a,d],!0)==!1)return!0;d===0?i.cancelPreSelectedNode(c,a):i.selectNode(c,a,d===2);c.treeObj.trigger(f.event.CLICK,[b,c.treeId,a,d]);return!0;};K=function K(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseDown,[c.treeId,a],!0)&&j.apply(c.callback.onMouseDown,[b,c.treeId,a]);return!0;};L=function L(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseUp,[c.treeId,a],!0)&&j.apply(c.callback.onMouseUp,[b,c.treeId,a]);return!0;};M=function M(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeDblClick,[c.treeId,a],!0)&&j.apply(c.callback.onDblClick,[b,c.treeId,a]);return!0;};N=function N(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeRightClick,[c.treeId,a],!0)&&j.apply(c.callback.onRightClick,[b,c.treeId,a]);return typeof c.callback.onRightClick!="function";};v=function v(b){b=b.originalEvent.srcElement.nodeName.toLowerCase();return b==="input"||b==="textarea";};var j={apply:function apply(b,a,c){return typeof b=="function"?b.apply(P,a?a:[]):c;},canAsync:function canAsync(b,a){var c=b.data.key.children;return b.async.enable&&a&&a.isParent&&!(a.zAsync||a[c]&&a[c].length>0);},clone:function clone(b){if(b===null)return null;var a=j.isArray(b)?[]:{},c;for(c in b){a[c]=b[c]instanceof Date?new Date(b[c].getTime()):_typeof(b[c])==="object"?arguments.callee(b[c]):b[c];}return a;},eqs:function eqs(b,a){return b.toLowerCase()===a.toLowerCase();},isArray:function isArray(b){return Object.prototype.toString.apply(b)==="[object Array]";},$:function $(b,a,c){a&&typeof a!="string"&&(c=a,a="");return typeof b=="string"?q(b,c?c.treeObj.get(0).ownerDocument:null):q("#"+b.tId+a,c?c.treeObj:null);},getMDom:function getMDom(b,a,c){if(!a)return null;for(;a&&a.id!==b.treeId;){for(var d=0,e=c.length;a.tagName&&d<e;d++){if(j.eqs(a.tagName,c[d].tagName)&&a.getAttribute(c[d].attrName)!==null)return a;}a=a.parentNode;}return null;},getNodeMainDom:function getNodeMainDom(b){return q(b).parent("li").get(0)||q(b).parentsUntil("li").parent().get(0);},isChildOrSelf:function isChildOrSelf(b,a){return q(b).closest("#"+a).length>0;},uCanDo:function uCanDo(){return!0;}},i={addNodes:function addNodes(b,a,c,d,e){if(!b.data.keep.leaf||!a||a.isParent)if(j.isArray(d)||(d=[d]),b.data.simpleData.enable&&(d=h.transformTozTreeFormat(b,d)),a){var g=k(a,f.id.SWITCH,b),m=k(a,f.id.ICON,b),o=k(a,f.id.UL,b);if(!a.open)i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,m,f.folder.CLOSE),a.open=!1,o.css({display:"none"});h.addNodesData(b,a,c,d);i.createNodes(b,a.level+1,d,a,c);e||i.expandCollapseParentNode(b,a,!0);}else h.addNodesData(b,h.getRoot(b),c,d),i.createNodes(b,0,d,null,c);},appendNodes:function appendNodes(b,a,c,d,e,g,f){if(!c)return[];var j=[],k=b.data.key.children,l=(d?d:h.getRoot(b))[k],r,Q;if(!l||e>=l.length)e=-1;for(var t=0,q=c.length;t<q;t++){var p=c[t];g&&(r=(e===0||l.length==c.length)&&t==0,Q=e<0&&t==c.length-1,h.initNode(b,a,p,d,r,Q,f),h.addNodeCache(b,p));r=[];p[k]&&p[k].length>0&&(r=i.appendNodes(b,a+1,p[k],p,-1,g,f&&p.open));f&&(i.makeDOMNodeMainBefore(j,b,p),i.makeDOMNodeLine(j,b,p),h.getBeforeA(b,p,j),i.makeDOMNodeNameBefore(j,b,p),h.getInnerBeforeA(b,p,j),i.makeDOMNodeIcon(j,b,p),h.getInnerAfterA(b,p,j),i.makeDOMNodeNameAfter(j,b,p),h.getAfterA(b,p,j),p.isParent&&p.open&&i.makeUlHtml(b,p,j,r.join("")),i.makeDOMNodeMainAfter(j,b,p),h.addCreatedNode(b,p));}return j;},appendParentULDom:function appendParentULDom(b,a){var c=[],d=k(a,b);!d.get(0)&&a.parentTId&&(i.appendParentULDom(b,a.getParentNode()),d=k(a,b));var e=k(a,f.id.UL,b);e.get(0)&&e.remove();e=i.appendNodes(b,a.level+1,a[b.data.key.children],a,-1,!1,!0);i.makeUlHtml(b,a,c,e.join(""));d.append(c.join(""));},asyncNode:function asyncNode(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;else if(a&&a.isAjaxing)return!1;else if(j.apply(b.callback.beforeAsync,[b.treeId,a],!0)==!1)return j.apply(d),!1;if(a)a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:"","class":f.className.BUTTON+" "+f.className.ICO_LOADING});var m={};for(e=0,g=b.async.autoParam.length;a&&e<g;e++){var o=b.async.autoParam[e].split("="),n=o;o.length>1&&(n=o[1],o=o[0]);m[n]=a[o];}if(j.isArray(b.async.otherParam))for(e=0,g=b.async.otherParam.length;e<g;e+=2){m[b.async.otherParam[e]]=b.async.otherParam[e+1];}else for(var l in b.async.otherParam){m[l]=b.async.otherParam[l];}var r=h.getRoot(b)._ver;q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:m,dataType:b.async.dataType,success:function success(e){if(r==h.getRoot(b)._ver){var g=[];try{g=!e||e.length==0?[]:typeof e=="string"?eval("("+e+")"):e;}catch(m){g=e;}if(a)a.isAjaxing=null,a.zAsync=!0;i.setNodeLineIcos(b,a);g&&g!==""?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c);b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]);j.apply(d);}},error:function error(c,d,e){if(r==h.getRoot(b)._ver){if(a)a.isAjaxing=null;i.setNodeLineIcos(b,a);b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,c,d,e]);}}});return!0;},cancelPreSelectedNode:function cancelPreSelectedNode(b,a,c){var d=h.getRoot(b).curSelectedList,e,g;for(e=d.length-1;e>=0;e--){if(g=d[e],a===g||!a&&(!c||c!==g))if(k(g,f.id.A,b).removeClass(f.node.CURSELECTED),a){h.removeSelectedNode(b,a);break;}else d.splice(e,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,g]);}},createNodeCallback:function createNodeCallback(b){if(b.callback.onNodeCreated||b.view.addDiyDom)for(var a=h.getRoot(b);a.createdNodes.length>0;){var c=a.createdNodes.shift();j.apply(b.view.addDiyDom,[b.treeId,c]);b.callback.onNodeCreated&&b.treeObj.trigger(f.event.NODECREATED,[b.treeId,c]);}},createNodes:function createNodes(b,a,c,d,e){if(c&&c.length!=0){var g=h.getRoot(b),j=b.data.key.children,j=!d||d.open||!!k(d[j][0],b).get(0);g.createdNodes=[];var a=i.appendNodes(b,a,c,d,e,!0,j),o,n;d?(d=k(d,f.id.UL,b),d.get(0)&&(o=d)):o=b.treeObj;o&&(e>=0&&(n=o.children()[e]),e>=0&&n?q(n).before(a.join("")):o.append(a.join("")));i.createNodeCallback(b);}},destroy:function destroy(b){b&&(h.initCache(b),h.initRoot(b),l.unbindTree(b),l.unbindEvent(b),b.treeObj.empty(),delete s[b.treeId]);},expandCollapseNode:function expandCollapseNode(b,a,c,d,e){var g=h.getRoot(b),m=b.data.key.children;if(a){if(g.expandTriggerFlag){var o=e,e=function e(){o&&o();a.open?b.treeObj.trigger(f.event.EXPAND,[b.treeId,a]):b.treeObj.trigger(f.event.COLLAPSE,[b.treeId,a]);};g.expandTriggerFlag=!1;}if(!a.open&&a.isParent&&(!k(a,f.id.UL,b).get(0)||a[m]&&a[m].length>0&&!k(a[m][0],b).get(0)))i.appendParentULDom(b,a),i.createNodeCallback(b);if(a.open==c)j.apply(e,[]);else{var c=k(a,f.id.UL,b),g=k(a,f.id.SWITCH,b),n=k(a,f.id.ICON,b);a.isParent?(a.open=!a.open,a.iconOpen&&a.iconClose&&n.attr("style",i.makeNodeIcoStyle(b,a)),a.open?(i.replaceSwitchClass(a,g,f.folder.OPEN),i.replaceIcoClass(a,n,f.folder.OPEN),d==!1||b.view.expandSpeed==""?(c.show(),j.apply(e,[])):a[m]&&a[m].length>0?c.slideDown(b.view.expandSpeed,e):(c.show(),j.apply(e,[]))):(i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,n,f.folder.CLOSE),d==!1||b.view.expandSpeed==""||!(a[m]&&a[m].length>0)?(c.hide(),j.apply(e,[])):c.slideUp(b.view.expandSpeed,e))):j.apply(e,[]);}}else j.apply(e,[]);},expandCollapseParentNode:function expandCollapseParentNode(b,a,c,d,e){a&&(a.parentTId?(i.expandCollapseNode(b,a,c,d),a.parentTId&&i.expandCollapseParentNode(b,a.getParentNode(),c,d,e)):i.expandCollapseNode(b,a,c,d,e));},expandCollapseSonNode:function expandCollapseSonNode(b,a,c,d,e){var g=h.getRoot(b),f=b.data.key.children,g=a?a[f]:g[f],f=a?!1:d,j=h.getRoot(b).expandTriggerFlag;h.getRoot(b).expandTriggerFlag=!1;if(g)for(var k=0,l=g.length;k<l;k++){g[k]&&i.expandCollapseSonNode(b,g[k],c,f);}h.getRoot(b).expandTriggerFlag=j;i.expandCollapseNode(b,a,c,d,e);},isSelectedNode:function isSelectedNode(b,a){if(!a)return!1;var c=h.getRoot(b).curSelectedList,d;for(d=c.length-1;d>=0;d--){if(a===c[d])return!0;}return!1;},makeDOMNodeIcon:function makeDOMNodeIcon(b,a,c){var d=h.getNodeName(a,c),d=a.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.push("<span id='",c.tId,f.id.ICON,"' title='' treeNode",f.id.ICON," class='",i.makeNodeIcoClass(a,c),"' style='",i.makeNodeIcoStyle(a,c),"'></span><span id='",c.tId,f.id.SPAN,"'>",d,"</span>");},makeDOMNodeLine:function makeDOMNodeLine(b,a,c){b.push("<span id='",c.tId,f.id.SWITCH,"' title='' class='",i.makeNodeLineClass(a,c),"' treeNode",f.id.SWITCH,"></span>");},makeDOMNodeMainAfter:function makeDOMNodeMainAfter(b){b.push("</li>");},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(b,a,c){b.push("<li id='",c.tId,"' class='",f.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>");},makeDOMNodeNameAfter:function makeDOMNodeNameAfter(b){b.push("</a>");},makeDOMNodeNameBefore:function makeDOMNodeNameBefore(b,a,c){var d=h.getNodeTitle(a,c),e=i.makeNodeUrl(a,c),g=i.makeNodeFontCss(a,c),m=[],k;for(k in g){m.push(k,":",g[k],";");}b.push("<a id='",c.tId,f.id.A,"' class='",f.className.LEVEL,c.level,"' treeNode",f.id.A,' onclick="',c.click||"",'" ',e!=null&&e.length>0?"href='"+e+"'":""," target='",i.makeNodeTarget(c),"' style='",m.join(""),"'");j.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&d&&b.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");b.push(">");},makeNodeFontCss:function makeNodeFontCss(b,a){var c=j.apply(b.view.fontCss,[b.treeId,a],b.view.fontCss);return c&&typeof c!="function"?c:{};},makeNodeIcoClass:function makeNodeIcoClass(b,a){var c=["ico"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+"_":"")+c[0],a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU));return f.className.BUTTON+" "+c.join("_");},makeNodeIcoStyle:function makeNodeIcoStyle(b,a){var c=[];if(!a.isAjaxing){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a[b.data.key.icon];d&&c.push("background:url(",d,") 0 0 no-repeat;");(b.view.showIcon==!1||!j.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push("width:0px;height:0px;");}return c.join("");},makeNodeLineClass:function makeNodeLineClass(b,a){var c=[];b.view.showLine?a.level==0&&a.isFirstNode&&a.isLastNode?c.push(f.line.ROOT):a.level==0&&a.isFirstNode?c.push(f.line.ROOTS):a.isLastNode?c.push(f.line.BOTTOM):c.push(f.line.CENTER):c.push(f.line.NOLINE);a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU);return i.makeNodeLineClassEx(a)+c.join("_");},makeNodeLineClassEx:function makeNodeLineClassEx(b){return f.className.BUTTON+" "+f.className.LEVEL+b.level+" "+f.className.SWITCH+" ";},makeNodeTarget:function makeNodeTarget(b){return b.target||"_blank";},makeNodeUrl:function makeNodeUrl(b,a){var c=b.data.key.url;return a[c]?a[c]:null;},makeUlHtml:function makeUlHtml(b,a,c,d){c.push("<ul id='",a.tId,f.id.UL,"' class='",f.className.LEVEL,a.level," ",i.makeUlLineClass(b,a),"' style='display:",a.open?"block":"none","'>");c.push(d);c.push("</ul>");},makeUlLineClass:function makeUlLineClass(b,a){return b.view.showLine&&!a.isLastNode?f.line.LINE:"";},removeChildNodes:function removeChildNodes(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){for(var e=0,g=d.length;e<g;e++){h.removeNodeCache(b,d[e]);}h.removeSelectedNode(b);delete a[c];b.data.keep.parent?k(a,f.id.UL,b).empty():(a.isParent=!1,a.open=!1,c=k(a,f.id.SWITCH,b),d=k(a,f.id.ICON,b),i.replaceSwitchClass(a,c,f.folder.DOCU),i.replaceIcoClass(a,d,f.folder.DOCU),k(a,f.id.UL,b).remove());}}},setFirstNode:function setFirstNode(b,a){var c=b.data.key.children;if(a[c].length>0)a[c][0].isFirstNode=!0;},setLastNode:function setLastNode(b,a){var c=b.data.key.children,d=a[c].length;if(d>0)a[c][d-1].isLastNode=!0;},removeNode:function removeNode(b,a){var c=h.getRoot(b),d=b.data.key.children,e=a.parentTId?a.getParentNode():c;a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null;};a.getNextNode=function(){return null;};if(h.getNodeCache(b,a.tId)){k(a,b).remove();h.removeNodeCache(b,a);h.removeSelectedNode(b,a);for(var g=0,j=e[d].length;g<j;g++){if(e[d][g].tId==a.tId){e[d].splice(g,1);break;}}i.setFirstNode(b,e);i.setLastNode(b,e);var o,g=e[d].length;if(!b.data.keep.parent&&g==0)e.isParent=!1,e.open=!1,g=k(e,f.id.UL,b),j=k(e,f.id.SWITCH,b),o=k(e,f.id.ICON,b),i.replaceSwitchClass(e,j,f.folder.DOCU),i.replaceIcoClass(e,o,f.folder.DOCU),g.css("display","none");else if(b.view.showLine&&g>0){var n=e[d][g-1],g=k(n,f.id.UL,b),j=k(n,f.id.SWITCH,b);o=k(n,f.id.ICON,b);e==c?e[d].length==1?i.replaceSwitchClass(n,j,f.line.ROOT):(c=k(e[d][0],f.id.SWITCH,b),i.replaceSwitchClass(e[d][0],c,f.line.ROOTS),i.replaceSwitchClass(n,j,f.line.BOTTOM)):i.replaceSwitchClass(n,j,f.line.BOTTOM);g.removeClass(f.line.LINE);}}},replaceIcoClass:function replaceIcoClass(b,a,c){if(a&&!b.isAjaxing&&(b=a.attr("class"),b!=void 0)){b=b.split("_");switch(c){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:b[b.length-1]=c;}a.attr("class",b.join("_"));}},replaceSwitchClass:function replaceSwitchClass(b,a,c){if(a){var d=a.attr("class");if(d!=void 0){d=d.split("_");switch(c){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:d[0]=i.makeNodeLineClassEx(b)+c;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:d[1]=c;}a.attr("class",d.join("_"));c!==f.folder.DOCU?a.removeAttr("disabled"):a.attr("disabled","disabled");}}},selectNode:function selectNode(b,a,c){c||i.cancelPreSelectedNode(b,null,a);k(a,f.id.A,b).addClass(f.node.CURSELECTED);h.addSelectedNode(b,a);b.treeObj.trigger(f.event.SELECTED,[b.treeId,a]);},setNodeFontCss:function setNodeFontCss(b,a){var c=k(a,f.id.A,b),d=i.makeNodeFontCss(b,a);d&&c.css(d);},setNodeLineIcos:function setNodeLineIcos(b,a){if(a){var c=k(a,f.id.SWITCH,b),d=k(a,f.id.UL,b),e=k(a,f.id.ICON,b),g=i.makeUlLineClass(b,a);g.length==0?d.removeClass(f.line.LINE):d.addClass(g);c.attr("class",i.makeNodeLineClass(b,a));a.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");e.removeAttr("style");e.attr("style",i.makeNodeIcoStyle(b,a));e.attr("class",i.makeNodeIcoClass(b,a));}},setNodeName:function setNodeName(b,a){var c=h.getNodeTitle(b,a),d=k(a,f.id.SPAN,b);d.empty();b.view.nameIsHTML?d.html(h.getNodeName(b,a)):d.text(h.getNodeName(b,a));j.apply(b.view.showTitle,[b.treeId,a],b.view.showTitle)&&k(a,f.id.A,b).attr("title",!c?"":c);},setNodeTarget:function setNodeTarget(b,a){k(a,f.id.A,b).attr("target",i.makeNodeTarget(a));},setNodeUrl:function setNodeUrl(b,a){var c=k(a,f.id.A,b),d=i.makeNodeUrl(b,a);d==null||d.length==0?c.removeAttr("href"):c.attr("href",d);},switchNode:function switchNode(b,a){a.open||!j.canAsync(b,a)?i.expandCollapseNode(b,a,!a.open):b.async.enable?i.asyncNode(b,a)||i.expandCollapseNode(b,a,!a.open):a&&i.expandCollapseNode(b,a,!a.open);}};q.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:l,data:h},getZTreeObj:function getZTreeObj(b){return(b=h.getZTreeTools(b))?b:null;},destroy:function destroy(b){if(b&&b.length>0)i.destroy(h.getSetting(b));else for(var a in s){i.destroy(s[a]);}},init:function init(b,a,c){var d=j.clone(O);q.extend(!0,d,a);d.treeId=b.attr("id");d.treeObj=b;d.treeObj.empty();s[d.treeId]=d;if(typeof document.body.style.maxHeight==="undefined")d.view.expandSpeed="";h.initRoot(d);b=h.getRoot(d);a=d.data.key.children;c=c?j.clone(j.isArray(c)?c:[c]):[];b[a]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c;h.initCache(d);l.unbindTree(d);l.bindTree(d);l.unbindEvent(d);l.bindEvent(d);c={setting:d,addNodes:function addNodes(a,b,c,f){function h(){i.addNodes(d,a,b,l,f==!0);}a||(a=null);if(a&&!a.isParent&&d.data.keep.leaf)return null;var k=parseInt(b,10);isNaN(k)?(f=!!c,c=b,b=-1):b=k;if(!c)return null;var l=j.clone(j.isArray(c)?c:[c]);j.canAsync(d,a)?i.asyncNode(d,a,f,h):h();return l;},cancelSelectedNode:function cancelSelectedNode(a){i.cancelPreSelectedNode(d,a);},destroy:function destroy(){i.destroy(d);},expandAll:function expandAll(a){a=!!a;i.expandCollapseSonNode(d,null,a,!0);return a;},expandNode:function expandNode(a,b,c,f,n){if(!a||!a.isParent)return null;b!==!0&&b!==!1&&(b=!a.open);if((n=!!n)&&b&&j.apply(d.callback.beforeExpand,[d.treeId,a],!0)==!1)return null;else if(n&&!b&&j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)==!1)return null;b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1);if(b===a.open&&!c)return null;h.getRoot(d).expandTriggerFlag=n;if(!j.canAsync(d,a)&&c)i.expandCollapseSonNode(d,a,b,!0,function(){if(f!==!1)try{k(a,d).focus().blur();}catch(b){}});else if(a.open=!b,i.switchNode(this.setting,a),f!==!1)try{k(a,d).focus().blur();}catch(l){}return b;},getNodes:function getNodes(){return h.getNodes(d);},getNodeByParam:function getNodeByParam(a,b,c){return!a?null:h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodeByTId:function getNodeByTId(a){return h.getNodeCache(d,a);},getNodesByParam:function getNodesByParam(a,b,c){return!a?null:h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByParamFuzzy:function getNodesByParamFuzzy(a,b,c){return!a?null:h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByFilter:function getNodesByFilter(a,b,c,f){b=!!b;return!a||typeof a!="function"?b?null:[]:h.getNodesByFilter(d,c?c[d.data.key.children]:h.getNodes(d),a,b,f);},getNodeIndex:function getNodeIndex(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),f=0,i=c[b].length;f<i;f++){if(c[b][f]==a)return f;}return-1;},getSelectedNodes:function getSelectedNodes(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,f=b.length;c<f;c++){a.push(b[c]);}return a;},isSelectedNode:function isSelectedNode(a){return h.isSelectedNode(d,a);},reAsyncChildNodes:function reAsyncChildNodes(a,b,c){if(this.setting.async.enable){var j=!a;j&&(a=h.getRoot(d));if(b=="refresh"){for(var b=this.setting.data.key.children,l=0,q=a[b]?a[b].length:0;l<q;l++){h.removeNodeCache(d,a[b][l]);}h.removeSelectedNode(d);a[b]=[];j?this.setting.treeObj.empty():k(a,f.id.UL,d).empty();}i.asyncNode(this.setting,j?null:a,!!c);}},refresh:function refresh(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d);a[d.data.key.children]=b;h.initCache(d);i.createNodes(d,0,a[d.data.key.children],null,-1);},removeChildNodes:function removeChildNodes(a){if(!a)return null;var b=a[d.data.key.children];i.removeChildNodes(d,a);return b?b:null;},removeNode:function removeNode(a,b){a&&(b=!!b,b&&j.apply(d.callback.beforeRemove,[d.treeId,a],!0)==!1||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(f.event.REMOVE,[d.treeId,a])));},selectNode:function selectNode(a,b){if(a&&j.uCanDo(d)){b=d.view.selectedMulti&&b;if(a.parentTId)i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{k(a,d).focus().blur();}catch(b){}});else try{k(a,d).focus().blur();}catch(c){}i.selectNode(d,a,b);}},transformTozTreeNodes:function transformTozTreeNodes(a){return h.transformTozTreeFormat(d,a);},transformToArray:function transformToArray(a){return h.transformToArrayFormat(d,a);},updateNode:function updateNode(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a));}};b.treeTools=c;h.setZTreeTools(d,c);b[a]&&b[a].length>0?i.createNodes(d,0,b[a],null,-1):d.async.enable&&d.async.url&&d.async.url!==""&&i.asyncNode(d);return c;}};var P=q.fn.zTree,k=j.$,f=P.consts;})(jQuery);(function(m){var p,q,r,o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};p=function p(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=b.data.key.checked;if(k.apply(b.callback.beforeCheck,[b.treeId,a],!0)==!1)return!0;a[d]=!a[d];e.checkNodeRelation(b,a);d=n(a,j.id.CHECK,b);e.setChkClass(b,d,a);e.repairParentChkClassWithSelf(b,a);b.treeObj.trigger(j.event.CHECK,[c,b.treeId,a]);return!0;};q=function q(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!0;e.setChkClass(b,d,a);return!0;};r=function r(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!1;e.setChkClass(b,d,a);return!0;};m.extend(!0,m.fn.zTree.consts,o);m.extend(!0,m.fn.zTree._z,{tools:{},view:{checkNodeRelation:function checkNodeRelation(c,a){var b,d,h,i=c.data.key.children,l=c.data.key.checked;b=j.radio;if(c.check.chkStyle==b.STYLE){var f=g.getRadioCheckedList(c);if(a[l]){if(c.check.radioType==b.TYPE_ALL){for(d=f.length-1;d>=0;d--){b=f[d],b[l]&&b!=a&&(b[l]=!1,f.splice(d,1),e.setChkClass(c,n(b,j.id.CHECK,c),b),b.parentTId!=a.parentTId&&e.repairParentChkClassWithSelf(c,b));}f.push(a);}else{f=a.parentTId?a.getParentNode():g.getRoot(c);for(d=0,h=f[i].length;d<h;d++){b=f[i][d],b[l]&&b!=a&&(b[l]=!1,e.setChkClass(c,n(b,j.id.CHECK,c),b));}}}else if(c.check.radioType==b.TYPE_ALL)for(d=0,h=f.length;d<h;d++){if(a==f[d]){f.splice(d,1);break;}}}else a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.Y.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!0),!a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.N.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!1),a[l]&&c.check.chkboxType.Y.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!0),!a[l]&&c.check.chkboxType.N.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!1);},makeChkClass:function makeChkClass(c,a){var b=c.data.key.checked,d=j.checkbox,h=j.radio,i="",i=a.chkDisabled===!0?d.DISABLED:a.halfCheck?d.PART:c.check.chkStyle==h.STYLE?a.check_Child_State<1?d.FULL:d.PART:a[b]?a.check_Child_State===2||a.check_Child_State===-1?d.FULL:d.PART:a.check_Child_State<1?d.FULL:d.PART,b=c.check.chkStyle+"_"+(a[b]?d.TRUE:d.FALSE)+"_"+i,b=a.check_Focus&&a.chkDisabled!==!0?b+"_"+d.FOCUS:b;return j.className.BUTTON+" "+d.DEFAULT+" "+b;},repairAllChk:function repairAllChk(c,a){if(c.check.enable&&c.check.chkStyle===j.checkbox.STYLE)for(var b=c.data.key.checked,d=c.data.key.children,h=g.getRoot(c),i=0,l=h[d].length;i<l;i++){var f=h[d][i];f.nocheck!==!0&&f.chkDisabled!==!0&&(f[b]=a);e.setSonNodeCheckBox(c,f,a);}},repairChkClass:function repairChkClass(c,a){if(a&&(g.makeChkFlag(c,a),a.nocheck!==!0)){var b=n(a,j.id.CHECK,c);e.setChkClass(c,b,a);}},repairParentChkClass:function repairParentChkClass(c,a){if(a&&a.parentTId){var b=a.getParentNode();e.repairChkClass(c,b);e.repairParentChkClass(c,b);}},repairParentChkClassWithSelf:function repairParentChkClassWithSelf(c,a){if(a){var b=c.data.key.children;a[b]&&a[b].length>0?e.repairParentChkClass(c,a[b][0]):e.repairParentChkClass(c,a);}},repairSonChkDisabled:function repairSonChkDisabled(c,a,b,d){if(a){var h=c.data.key.children;if(a.chkDisabled!=b)a.chkDisabled=b;e.repairChkClass(c,a);if(a[h]&&d)for(var i=0,l=a[h].length;i<l;i++){e.repairSonChkDisabled(c,a[h][i],b,d);}}},repairParentChkDisabled:function repairParentChkDisabled(c,a,b,d){if(a){if(a.chkDisabled!=b&&d)a.chkDisabled=b;e.repairChkClass(c,a);e.repairParentChkDisabled(c,a.getParentNode(),b,d);}},setChkClass:function setChkClass(c,a,b){a&&(b.nocheck===!0?a.hide():a.show(),a.attr("class",e.makeChkClass(c,b)));},setParentNodeCheckBox:function setParentNodeCheckBox(c,a,b,d){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);g.makeChkFlag(c,a);a.nocheck!==!0&&a.chkDisabled!==!0&&(a[i]=b,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]));if(a.parentTId){l=!0;if(!b)for(var h=a.getParentNode()[h],f=0,k=h.length;f<k;f++){if(h[f].nocheck!==!0&&h[f].chkDisabled!==!0&&h[f][i]||(h[f].nocheck===!0||h[f].chkDisabled===!0)&&h[f].check_Child_State>0){l=!1;break;}}l&&e.setParentNodeCheckBox(c,a.getParentNode(),b,d);}},setSonNodeCheckBox:function setSonNodeCheckBox(c,a,b,d){if(a){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);var f=!1;if(a[h])for(var k=0,m=a[h].length;k<m&&a.chkDisabled!==!0;k++){var o=a[h][k];e.setSonNodeCheckBox(c,o,b,d);o.chkDisabled===!0&&(f=!0);}if(a!=g.getRoot(c)&&a.chkDisabled!==!0){f&&a.nocheck!==!0&&g.makeChkFlag(c,a);if(a.nocheck!==!0&&a.chkDisabled!==!0){if(a[i]=b,!f)a.check_Child_State=a[h]&&a[h].length>0?b?2:0:-1;}else a.check_Child_State=-1;e.setChkClass(c,l,a);c.check.autoCheckTrigger&&a!=d&&a.nocheck!==!0&&a.chkDisabled!==!0&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]);}}}},event:{},data:{getRadioCheckedList:function getRadioCheckedList(c){for(var a=g.getRoot(c).radioCheckedList,b=0,d=a.length;b<d;b++){g.getNodeCache(c,a[b].tId)||(a.splice(b,1),b--,d--);}return a;},getCheckStatus:function getCheckStatus(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled)return null;var b=c.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:c.check.chkStyle==j.radio.STYLE?a.check_Child_State===2:a[b]?a.check_Child_State>-1&&a.check_Child_State<2:a.check_Child_State>0};},getTreeCheckedNodes:function getTreeCheckedNodes(c,a,b,d){if(!a)return[];for(var h=c.data.key.children,i=c.data.key.checked,e=b&&c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL,d=!d?[]:d,f=0,k=a.length;f<k;f++){if(a[f].nocheck!==!0&&a[f].chkDisabled!==!0&&a[f][i]==b&&(d.push(a[f]),e))break;g.getTreeCheckedNodes(c,a[f][h],b,d);if(e&&d.length>0)break;}return d;},getTreeChangeCheckedNodes:function getTreeChangeCheckedNodes(c,a,b){if(!a)return[];for(var d=c.data.key.children,h=c.data.key.checked,b=!b?[]:b,i=0,e=a.length;i<e;i++){a[i].nocheck!==!0&&a[i].chkDisabled!==!0&&a[i][h]!=a[i].checkedOld&&b.push(a[i]),g.getTreeChangeCheckedNodes(c,a[i][d],b);}return b;},makeChkFlag:function makeChkFlag(c,a){if(a){var b=c.data.key.children,d=c.data.key.checked,h=-1;if(a[b])for(var i=0,e=a[b].length;i<e;i++){var f=a[b][i],g=-1;if(c.check.chkStyle==j.radio.STYLE){if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?2:f[d]?2:f.check_Child_State>0?2:0,g==2){h=2;break;}else g==0&&(h=0);}else if(c.check.chkStyle==j.checkbox.STYLE)if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?1:f[d]?f.check_Child_State===-1||f.check_Child_State===2?2:1:f.check_Child_State>0?1:0,g===1){h=1;break;}else if(g===2&&h>-1&&i>0&&g!==h){h=1;break;}else if(h===2&&g>-1&&g<2){h=1;break;}else g>-1&&(h=g);}a.check_Child_State=h;}}}});var m=m.fn.zTree,k=m._z.tools,j=m.consts,e=m._z.view,g=m._z.data,n=k.$;g.exSetting(v);g.addInitBind(function(c){c.treeObj.bind(j.event.CHECK,function(a,b,d,h){a.srcEvent=b;k.apply(c.callback.onCheck,[a,d,h]);});});g.addInitUnBind(function(c){c.treeObj.unbind(j.event.CHECK);});g.addInitCache(function(){});g.addInitNode(function(c,a,b,d){if(b){a=c.data.key.checked;typeof b[a]=="string"&&(b[a]=k.eqs(b[a],"true"));b[a]=!!b[a];b.checkedOld=b[a];if(typeof b.nocheck=="string")b.nocheck=k.eqs(b.nocheck,"true");b.nocheck=!!b.nocheck||c.check.nocheckInherit&&d&&!!d.nocheck;if(typeof b.chkDisabled=="string")b.chkDisabled=k.eqs(b.chkDisabled,"true");b.chkDisabled=!!b.chkDisabled||c.check.chkDisabledInherit&&d&&!!d.chkDisabled;if(typeof b.halfCheck=="string")b.halfCheck=k.eqs(b.halfCheck,"true");b.halfCheck=!!b.halfCheck;b.check_Child_State=-1;b.check_Focus=!1;b.getCheckStatus=function(){return g.getCheckStatus(c,b);};c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL&&b[a]&&g.getRoot(c).radioCheckedList.push(b);}});g.addInitProxy(function(c){var a=c.target,b=g.getSetting(c.data.treeId),d="",h=null,e="",l=null;if(k.eqs(c.type,"mouseover")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoverCheck";}else if(k.eqs(c.type,"mouseout")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoutCheck";}else if(k.eqs(c.type,"click")&&b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="checkNode";if(d.length>0)switch(h=g.getNodeCache(b,d),e){case"checkNode":l=p;break;case"mouseoverCheck":l=q;break;case"mouseoutCheck":l=r;}return{stop:e==="checkNode",node:h,nodeEventType:e,nodeEventCallback:l,treeEventType:"",treeEventCallback:null};},!0);g.addInitRoot(function(c){g.getRoot(c).radioCheckedList=[];});g.addBeforeA(function(c,a,b){c.check.enable&&(g.makeChkFlag(c,a),b.push("<span ID='",a.tId,j.id.CHECK,"' class='",e.makeChkClass(c,a),"' treeNode",j.id.CHECK,a.nocheck===!0?" style='display:none;'":"","></span>"));});g.addZTreeTools(function(c,a){a.checkNode=function(a,b,c,g){var f=this.setting.data.key.checked;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[f]),g=!!g,(a[f]!==b||c)&&!(g&&k.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)==!1)&&k.uCanDo(this.setting)&&this.setting.check.enable&&a.nocheck!==!0))a[f]=b,b=n(a,j.id.CHECK,this.setting),(c||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,a),e.setChkClass(this.setting,b,a),e.repairParentChkClassWithSelf(this.setting,a),g&&this.setting.treeObj.trigger(j.event.CHECK,[null,this.setting.treeId,a]);};a.checkAllNodes=function(a){e.repairAllChk(this.setting,!!a);};a.getCheckedNodes=function(a){var b=this.setting.data.key.children;return g.getTreeCheckedNodes(this.setting,g.getRoot(this.setting)[b],a!==!1);};a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return g.getTreeChangeCheckedNodes(this.setting,g.getRoot(this.setting)[a]);};a.setChkDisabled=function(a,b,c,g){b=!!b;c=!!c;e.repairSonChkDisabled(this.setting,a,b,!!g);e.repairParentChkDisabled(this.setting,a.getParentNode(),b,c);};var b=a.updateNode;a.updateNode=function(c,g){b&&b.apply(a,arguments);if(c&&this.setting.check.enable&&n(c,this.setting).get(0)&&k.uCanDo(this.setting)){var i=n(c,j.id.CHECK,this.setting);(g==!0||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,c);e.setChkClass(this.setting,i,c);e.repairParentChkClassWithSelf(this.setting,c);}};});var s=e.createNodes;e.createNodes=function(c,a,b,d,g){s&&s.apply(e,arguments);b&&e.repairParentChkClassWithSelf(c,d);};var t=e.removeNode;e.removeNode=function(c,a){var b=a.getParentNode();t&&t.apply(e,arguments);a&&b&&(e.repairChkClass(c,b),e.repairParentChkClass(c,b));};var u=e.appendNodes;e.appendNodes=function(c,a,b,d,h,i,j){var f="";u&&(f=u.apply(e,arguments));d&&g.makeChkFlag(c,d);return f;};})(jQuery);(function(i){i.extend(!0,i.fn.zTree._z,{view:{clearOldFirstNode:function clearOldFirstNode(c,a){for(var b=a.getNextNode();b;){if(b.isFirstNode){b.isFirstNode=!1;d.setNodeLineIcos(c,b);break;}if(b.isLastNode)break;b=b.getNextNode();}},clearOldLastNode:function clearOldLastNode(c,a,b){for(a=a.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1;b&&d.setNodeLineIcos(c,a);break;}if(a.isFirstNode)break;a=a.getPreNode();}},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(c,a,b){c.push("<li ",b.isHidden?"style='display:none;' ":"","id='",b.tId,"' class='",l.className.LEVEL,b.level,"' tabindex='0' hidefocus='true' treenode>");},showNode:function showNode(c,a){a.isHidden=!1;f.initShowForExCheck(c,a);j(a,c).show();},showNodes:function showNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if(!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.showNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForShow(c,a),d.setLastNodeForShow(c,a);}}},hideNode:function hideNode(c,a){a.isHidden=!0;a.isFirstNode=!1;a.isLastNode=!1;f.initHideForExCheck(c,a);d.cancelPreSelectedNode(c,a);j(a,c).hide();},hideNodes:function hideNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if((h.isFirstNode||h.isLastNode)&&!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.hideNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForHide(c,a),d.setLastNodeForHide(c,a);}}},setFirstNode:function setFirstNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][0].isFirstNode=!0:e>0&&d.setFirstNodeForHide(c,a[b]);},setLastNode:function setLastNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][e-1].isLastNode=!0:e>0&&d.setLastNodeForHide(c,a[b]);},setFirstNodeForHide:function setFirstNodeForHide(c,a){var b,e,g;for(e=0,g=a.length;e<g;e++){b=a[e];if(b.isFirstNode)break;if(!b.isHidden&&!b.isFirstNode){b.isFirstNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setFirstNodeForShow:function setFirstNodeForShow(c,a){var b,e,g,f,h;for(e=0,g=a.length;e<g;e++){if(b=a[e],!f&&!b.isHidden&&b.isFirstNode){f=b;break;}else if(!f&&!b.isHidden&&!b.isFirstNode)b.isFirstNode=!0,f=b,d.setNodeLineIcos(c,b);else if(f&&b.isFirstNode){b.isFirstNode=!1;h=b;d.setNodeLineIcos(c,b);break;}}return{"new":f,old:h};},setLastNodeForHide:function setLastNodeForHide(c,a){var b,e;for(e=a.length-1;e>=0;e--){b=a[e];if(b.isLastNode)break;if(!b.isHidden&&!b.isLastNode){b.isLastNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setLastNodeForShow:function setLastNodeForShow(c,a){var b,e,g,f;for(e=a.length-1;e>=0;e--){if(b=a[e],!g&&!b.isHidden&&b.isLastNode){g=b;break;}else if(!g&&!b.isHidden&&!b.isLastNode)b.isLastNode=!0,g=b,d.setNodeLineIcos(c,b);else if(g&&b.isLastNode){b.isLastNode=!1;f=b;d.setNodeLineIcos(c,b);break;}}return{"new":g,old:f};}},data:{initHideForExCheck:function initHideForExCheck(c,a){if(a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck=="undefined")a._nocheck=!!a.nocheck,a.nocheck=!0;a.check_Child_State=-1;d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}},initShowForExCheck:function initShowForExCheck(c,a){if(!a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck!="undefined")a.nocheck=a._nocheck,delete a._nocheck;if(d.setChkClass){var b=j(a,l.id.CHECK,c);d.setChkClass(c,b,a);}d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}}}});var i=i.fn.zTree,m=i._z.tools,l=i.consts,d=i._z.view,f=i._z.data,j=m.$;f.addInitNode(function(c,a,b){if(typeof b.isHidden=="string")b.isHidden=m.eqs(b.isHidden,"true");b.isHidden=!!b.isHidden;f.initHideForExCheck(c,b);});f.addBeforeA(function(){});f.addZTreeTools(function(c,a){a.showNodes=function(a,b){d.showNodes(c,a,b);};a.showNode=function(a,b){a&&d.showNodes(c,[a],b);};a.hideNodes=function(a,b){d.hideNodes(c,a,b);};a.hideNode=function(a,b){a&&d.hideNodes(c,[a],b);};var b=a.checkNode;if(b)a.checkNode=function(c,d,f,h){(!c||!c.isHidden)&&b.apply(a,arguments);};});var n=f.initNode;f.initNode=function(c,a,b,e,g,i,h){var j=(e?e:f.getRoot(c))[c.data.key.children];f.tmpHideFirstNode=d.setFirstNodeForHide(c,j);f.tmpHideLastNode=d.setLastNodeForHide(c,j);h&&(d.setNodeLineIcos(c,f.tmpHideFirstNode),d.setNodeLineIcos(c,f.tmpHideLastNode));g=f.tmpHideFirstNode===b;i=f.tmpHideLastNode===b;n&&n.apply(f,arguments);h&&i&&d.clearOldLastNode(c,b,h);};var o=f.makeChkFlag;if(o)f.makeChkFlag=function(c,a){(!a||!a.isHidden)&&o.apply(f,arguments);};var p=f.getTreeCheckedNodes;if(p)f.getTreeCheckedNodes=function(c,a,b,e){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return p.apply(f,arguments);};var q=f.getTreeChangeCheckedNodes;if(q)f.getTreeChangeCheckedNodes=function(c,a,b){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return q.apply(f,arguments);};var r=d.expandCollapseSonNode;if(r)d.expandCollapseSonNode=function(c,a,b,e,f){(!a||!a.isHidden)&&r.apply(d,arguments);};var s=d.setSonNodeCheckBox;if(s)d.setSonNodeCheckBox=function(c,a,b,e){(!a||!a.isHidden)&&s.apply(d,arguments);};var t=d.repairParentChkClassWithSelf;if(t)d.repairParentChkClassWithSelf=function(c,a){(!a||!a.isHidden)&&t.apply(d,arguments);};})(jQuery);(function(v){var I={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},x={onHoverOverNode:function onHoverOverNode(b,a){var c=m.getSetting(b.data.treeId),d=m.getRoot(c);if(d.curHoverNode!=a)x.onHoverOutNode(b);d.curHoverNode=a;f.addHoverDom(c,a);},onHoverOutNode:function onHoverOutNode(b){var b=m.getSetting(b.data.treeId),a=m.getRoot(b);if(a.curHoverNode&&!m.isSelectedNode(b,a.curHoverNode))f.removeTreeDom(b,a.curHoverNode),a.curHoverNode=null;},onMousedownNode:function onMousedownNode(b,a){function c(b){if(B.dragFlag==0&&Math.abs(N-b.clientX)<e.edit.drag.minMoveSize&&Math.abs(O-b.clientY)<e.edit.drag.minMoveSize)return!0;var a,c,n,k,i;i=e.data.key.children;M.css("cursor","pointer");if(B.dragFlag==0){if(g.apply(e.callback.beforeDrag,[e.treeId,l],!0)==!1)return r(b),!0;for(a=0,c=l.length;a<c;a++){if(a==0)B.dragNodeShowBefore=[];n=l[a];n.isParent&&n.open?(f.expandCollapseNode(e,n,!n.open),B.dragNodeShowBefore[n.tId]=!0):B.dragNodeShowBefore[n.tId]=!1;}B.dragFlag=1;t.showHoverDom=!1;g.showIfameMask(e,!0);n=!0;k=-1;if(l.length>1){var j=l[0].parentTId?l[0].getParentNode()[i]:m.getNodes(e);i=[];for(a=0,c=j.length;a<c;a++){if(B.dragNodeShowBefore[j[a].tId]!==void 0&&(n&&k>-1&&k+1!==a&&(n=!1),i.push(j[a]),k=a),l.length===i.length){l=i;break;}}}n&&(H=l[0].getPreNode(),R=l[l.length-1].getNextNode());D=o("<ul class='zTreeDragUL'></ul>",e);for(a=0,c=l.length;a<c;a++){n=l[a],n.editNameFlag=!1,f.selectNode(e,n,a>0),f.removeTreeDom(e,n),a>e.edit.drag.maxShowNodeNum-1||(k=o("<li id='"+n.tId+"_tmp'></li>",e),k.append(o(n,d.id.A,e).clone()),k.css("padding","0"),k.children("#"+n.tId+d.id.A).removeClass(d.node.CURSELECTED),D.append(k),a==e.edit.drag.maxShowNodeNum-1&&(k=o("<li id='"+n.tId+"_moretmp'><a>  ...  </a></li>",e),D.append(k)));}D.attr("id",l[0].tId+d.id.UL+"_tmp");D.addClass(e.treeObj.attr("class"));D.appendTo(M);A=o("<span class='tmpzTreeMove_arrow'></span>",e);A.attr("id","zTreeMove_arrow_tmp");A.appendTo(M);e.treeObj.trigger(d.event.DRAG,[b,e.treeId,l]);}if(B.dragFlag==1){s&&A.attr("id")==b.target.id&&u&&b.clientX+F.scrollLeft()+2>v("#"+u+d.id.A,s).offset().left?(n=v("#"+u+d.id.A,s),b.target=n.length>0?n.get(0):b.target):s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));u=s=null;J=!1;h=e;n=m.getSettings();for(var y in n){if(n[y].treeId&&n[y].edit.enable&&n[y].treeId!=e.treeId&&(b.target.id==n[y].treeId||v(b.target).parents("#"+n[y].treeId).length>0))J=!0,h=n[y];}y=F.scrollTop();k=F.scrollLeft();i=h.treeObj.offset();a=h.treeObj.get(0).scrollHeight;n=h.treeObj.get(0).scrollWidth;c=b.clientY+y-i.top;var p=h.treeObj.height()+i.top-b.clientY-y,q=b.clientX+k-i.left,x=h.treeObj.width()+i.left-b.clientX-k;i=c<e.edit.drag.borderMax&&c>e.edit.drag.borderMin;var j=p<e.edit.drag.borderMax&&p>e.edit.drag.borderMin,K=q<e.edit.drag.borderMax&&q>e.edit.drag.borderMin,G=x<e.edit.drag.borderMax&&x>e.edit.drag.borderMin,p=c>e.edit.drag.borderMin&&p>e.edit.drag.borderMin&&q>e.edit.drag.borderMin&&x>e.edit.drag.borderMin,q=i&&h.treeObj.scrollTop()<=0,x=j&&h.treeObj.scrollTop()+h.treeObj.height()+10>=a,P=K&&h.treeObj.scrollLeft()<=0,Q=G&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=n;if(b.target&&g.isChildOrSelf(b.target,h.treeId)){for(var E=b.target;E&&E.tagName&&!g.eqs(E.tagName,"li")&&E.id!=h.treeId;){E=E.parentNode;}var S=!0;for(a=0,c=l.length;a<c;a++){if(n=l[a],E.id===n.tId){S=!1;break;}else if(o(n,e).find("#"+E.id).length>0){S=!1;break;}}if(S&&b.target&&g.isChildOrSelf(b.target,E.id+d.id.A))s=v(E),u=E.id;}n=l[0];if(p&&g.isChildOrSelf(b.target,h.treeId)){if(!s&&(b.target.id==h.treeId||q||x||P||Q)&&(J||!J&&n.parentTId))s=h.treeObj;i?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):j&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10);K?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):G&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10);s&&s!=h.treeObj&&s.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+s.offset().left-h.treeObj.offset().left);}D.css({top:b.clientY+y+3+"px",left:b.clientX+k+3+"px"});i=a=0;if(s&&s.attr("id")!=h.treeId){var z=u==null?null:m.getNodeCache(h,u);c=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;a=!!(H&&u===H.tId);i=!!(R&&u===R.tId);k=n.parentTId&&n.parentTId==u;n=(c||!i)&&g.apply(h.edit.drag.prev,[h.treeId,l,z],!!h.edit.drag.prev);a=(c||!a)&&g.apply(h.edit.drag.next,[h.treeId,l,z],!!h.edit.drag.next);G=(c||!k)&&!(h.data.keep.leaf&&!z.isParent)&&g.apply(h.edit.drag.inner,[h.treeId,l,z],!!h.edit.drag.inner);if(!n&&!a&&!G){if(s=null,u="",w=d.move.TYPE_INNER,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;}else{c=v("#"+u+d.id.A,s);i=z.isLastNode?null:v("#"+z.getNextNode().tId+d.id.A,s.next());j=c.offset().top;k=c.offset().left;K=n?G?0.25:a?0.5:1:-1;G=a?G?0.75:n?0.5:0:-1;y=(b.clientY+y-j)/c.height();(K==1||y<=K&&y>=-0.2)&&n?(a=1-A.width(),i=j-A.height()/2,w=d.move.TYPE_PREV):(G==0||y>=G&&y<=1.2)&&a?(a=1-A.width(),i=i==null||z.isParent&&z.open?j+c.height()-A.height()/2:i.offset().top-A.height()/2,w=d.move.TYPE_NEXT):(a=5-A.width(),i=j,w=d.move.TYPE_INNER);A.css({display:"block",top:i+"px",left:k+a+"px"});c.addClass(d.node.TMPTARGET_NODE+"_"+w);if(T!=u||U!=w)L=new Date().getTime();if(z&&z.isParent&&w==d.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==z.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===z.tId&&(y=!1),y))window.zTreeMoveTimer=setTimeout(function(){w==d.move.TYPE_INNER&&z&&z.isParent&&!z.open&&new Date().getTime()-L>h.edit.drag.autoOpenTime&&g.apply(h.callback.beforeDragOpen,[h.treeId,z],!0)&&(f.switchNode(h,z),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(d.event.EXPAND,[h.treeId,z]));},h.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=z.tId;}}else if(w=d.move.TYPE_INNER,s&&g.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?s.addClass(d.node.TMPTARGET_TREE):s=null,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;T=u;U=w;e.treeObj.trigger(d.event.DRAGMOVE,[b,e.treeId,l]);}return!1;}function r(b){if(window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;U=T=null;F.unbind("mousemove",c);F.unbind("mouseup",r);F.unbind("selectstart",k);M.css("cursor","auto");s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));g.showIfameMask(e,!1);t.showHoverDom=!0;if(B.dragFlag!=0){B.dragFlag=0;var a,i,j;for(a=0,i=l.length;a<i;a++){j=l[a],j.isParent&&B.dragNodeShowBefore[j.tId]&&!j.open&&(f.expandCollapseNode(e,j,!j.open),delete B.dragNodeShowBefore[j.tId]);}D&&D.remove();A&&A.remove();var p=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;!p&&s&&u&&l[0].parentTId&&u==l[0].parentTId&&w==d.move.TYPE_INNER&&(s=null);if(s){var q=u==null?null:m.getNodeCache(h,u);if(g.apply(e.callback.beforeDrop,[h.treeId,l,q,w,p],!0)==!1)f.selectNodes(x,l);else{var C=p?g.clone(l):l;a=function a(){if(J){if(!p)for(var a=0,c=l.length;a<c;a++){f.removeNode(e,l[a]);}w==d.move.TYPE_INNER?f.addNodes(h,q,-1,C):f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);}else if(p&&w==d.move.TYPE_INNER)f.addNodes(h,q,-1,C);else if(p)f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);else if(w!=d.move.TYPE_NEXT)for(a=0,c=C.length;a<c;a++){f.moveNode(h,q,C[a],w,!1);}else for(a=-1,c=C.length-1;a<c;c--){f.moveNode(h,q,C[c],w,!1);}f.selectNodes(h,C);o(C[0],e).focus().blur();e.treeObj.trigger(d.event.DROP,[b,h.treeId,C,q,w,p]);};w==d.move.TYPE_INNER&&g.canAsync(h,q)?f.asyncNode(h,q,!1,a):a();}}else f.selectNodes(x,l),e.treeObj.trigger(d.event.DROP,[b,e.treeId,l,null,null,null]);}}function k(){return!1;}var i,j,e=m.getSetting(b.data.treeId),B=m.getRoot(e),t=m.getRoots();if(b.button==2||!e.edit.enable||!e.edit.drag.isCopy&&!e.edit.drag.isMove)return!0;var p=b.target,q=m.getRoot(e).curSelectedList,l=[];if(m.isSelectedNode(e,a))for(i=0,j=q.length;i<j;i++){if(q[i].editNameFlag&&g.eqs(p.tagName,"input")&&p.getAttribute("treeNode"+d.id.INPUT)!==null)return!0;l.push(q[i]);if(l[0].parentTId!==q[i].parentTId){l=[a];break;}}else l=[a];f.editNodeBlur=!0;f.cancelCurEditNode(e);var F=v(e.treeObj.get(0).ownerDocument),M=v(e.treeObj.get(0).ownerDocument.body),D,A,s,J=!1,h=e,x=e,H,R,T=null,U=null,u=null,w=d.move.TYPE_INNER,N=b.clientX,O=b.clientY,L=new Date().getTime();g.uCanDo(e)&&F.bind("mousemove",c);F.bind("mouseup",r);F.bind("selectstart",k);b.preventDefault&&b.preventDefault();return!0;}};v.extend(!0,v.fn.zTree.consts,I);v.extend(!0,v.fn.zTree._z,{tools:{getAbs:function getAbs(b){b=b.getBoundingClientRect();return[b.left+(document.body.scrollLeft+document.documentElement.scrollLeft),b.top+(document.body.scrollTop+document.documentElement.scrollTop)];},inputFocus:function inputFocus(b){b.get(0)&&(b.focus(),g.setCursorPosition(b.get(0),b.val().length));},inputSelect:function inputSelect(b){b.get(0)&&(b.focus(),b.select());},setCursorPosition:function setCursorPosition(b,a){if(b.setSelectionRange)b.focus(),b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0);c.moveEnd("character",a);c.moveStart("character",a);c.select();}},showIfameMask:function showIfameMask(b,a){for(var c=m.getRoot(b);c.dragMaskList.length>0;){c.dragMaskList[0].remove(),c.dragMaskList.shift();}if(a)for(var d=o("iframe",b),f=0,i=d.length;f<i;f++){var j=d.get(f),e=g.getAbs(j),j=o("<div id='zTreeMask_"+f+"' class='zTreeMask' style='top:"+e[1]+"px; left:"+e[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>",b);j.appendTo(o("body",b));c.dragMaskList.push(j);}}},view:{addEditBtn:function addEditBtn(b,a){if(!(a.editNameFlag||o(a,d.id.EDIT,b).length>0)&&g.apply(b.edit.showRenameBtn,[b.treeId,a],b.edit.showRenameBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" edit' id='"+a.tId+d.id.EDIT+"' title='"+g.apply(b.edit.renameTitle,[b.treeId,a],b.edit.renameTitle)+"' treeNode"+d.id.EDIT+" style='display:none;'></span>";c.append(r);o(a,d.id.EDIT,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeEditName,[b.treeId,a],!0)==!1)return!1;f.editNode(b,a);return!1;}).show();}},addRemoveBtn:function addRemoveBtn(b,a){if(!(a.editNameFlag||o(a,d.id.REMOVE,b).length>0)&&g.apply(b.edit.showRemoveBtn,[b.treeId,a],b.edit.showRemoveBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" remove' id='"+a.tId+d.id.REMOVE+"' title='"+g.apply(b.edit.removeTitle,[b.treeId,a],b.edit.removeTitle)+"' treeNode"+d.id.REMOVE+" style='display:none;'></span>";c.append(r);o(a,d.id.REMOVE,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeRemove,[b.treeId,a],!0)==!1)return!1;f.removeNode(b,a);b.treeObj.trigger(d.event.REMOVE,[b.treeId,a]);return!1;}).bind("mousedown",function(){return!0;}).show();}},addHoverDom:function addHoverDom(b,a){if(m.getRoots().showHoverDom)a.isHover=!0,b.edit.enable&&(f.addEditBtn(b,a),f.addRemoveBtn(b,a)),g.apply(b.view.addHoverDom,[b.treeId,a]);},cancelCurEditNode:function cancelCurEditNode(b,a,c){var r=m.getRoot(b),k=b.data.key.name,i=r.curEditNode;if(i){var j=r.curEditInput,a=a?a:c?i[k]:j.val();if(g.apply(b.callback.beforeRename,[b.treeId,i,a,c],!0)===!1)return!1;i[k]=a;o(i,d.id.A,b).removeClass(d.node.CURSELECTED_EDIT);j.unbind();f.setNodeName(b,i);i.editNameFlag=!1;r.curEditNode=null;r.curEditInput=null;f.selectNode(b,i,!1);b.treeObj.trigger(d.event.RENAME,[b.treeId,i,c]);}return r.noSelection=!0;},editNode:function editNode(b,a){var c=m.getRoot(b);f.editNodeBlur=!1;if(m.isSelectedNode(b,a)&&c.curEditNode==a&&a.editNameFlag)setTimeout(function(){g.inputFocus(c.curEditInput);},0);else{var r=b.data.key.name;a.editNameFlag=!0;f.removeTreeDom(b,a);f.cancelCurEditNode(b);f.selectNode(b,a,!1);o(a,d.id.SPAN,b).html("<input type=text class='rename' id='"+a.tId+d.id.INPUT+"' treeNode"+d.id.INPUT+" >");var k=o(a,d.id.INPUT,b);k.attr("value",a[r]);b.edit.editNameSelectAll?g.inputSelect(k):g.inputFocus(k);k.bind("blur",function(){f.editNodeBlur||f.cancelCurEditNode(b);}).bind("keydown",function(a){a.keyCode=="13"?(f.editNodeBlur=!0,f.cancelCurEditNode(b)):a.keyCode=="27"&&f.cancelCurEditNode(b,null,!0);}).bind("click",function(){return!1;}).bind("dblclick",function(){return!1;});o(a,d.id.A,b).addClass(d.node.CURSELECTED_EDIT);c.curEditInput=k;c.noSelection=!1;c.curEditNode=a;}},moveNode:function moveNode(b,a,c,r,k,i){var j=m.getRoot(b),e=b.data.key.children;if(a!=c&&(!b.data.keep.leaf||!a||a.isParent||r!=d.move.TYPE_INNER)){var g=c.parentTId?c.getParentNode():j,t=a===null||a==j;t&&a===null&&(a=j);if(t)r=d.move.TYPE_INNER;j=a.parentTId?a.getParentNode():j;if(r!=d.move.TYPE_PREV&&r!=d.move.TYPE_NEXT)r=d.move.TYPE_INNER;if(r==d.move.TYPE_INNER)if(t)c.parentTId=null;else{if(!a.isParent)a.isParent=!0,a.open=!!a.open,f.setNodeLineIcos(b,a);c.parentTId=a.tId;}var p;t?p=t=b.treeObj:(!i&&r==d.move.TYPE_INNER?f.expandCollapseNode(b,a,!0,!1):i||f.expandCollapseNode(b,a.getParentNode(),!0,!1),t=o(a,b),p=o(a,d.id.UL,b),t.get(0)&&!p.get(0)&&(p=[],f.makeUlHtml(b,a,p,""),t.append(p.join(""))),p=o(a,d.id.UL,b));var q=o(c,b);q.get(0)?t.get(0)||q.remove():q=f.appendNodes(b,c.level,[c],null,-1,!1,!0).join("");p.get(0)&&r==d.move.TYPE_INNER?p.append(q):t.get(0)&&r==d.move.TYPE_PREV?t.before(q):t.get(0)&&r==d.move.TYPE_NEXT&&t.after(q);var l=-1,v=0,x=null,t=null,D=c.level;if(c.isFirstNode){if(l=0,g[e].length>1)x=g[e][1],x.isFirstNode=!0;}else if(c.isLastNode)l=g[e].length-1,x=g[e][l-1],x.isLastNode=!0;else for(p=0,q=g[e].length;p<q;p++){if(g[e][p].tId==c.tId){l=p;break;}}l>=0&&g[e].splice(l,1);if(r!=d.move.TYPE_INNER)for(p=0,q=j[e].length;p<q;p++){j[e][p].tId==a.tId&&(v=p);}if(r==d.move.TYPE_INNER){a[e]||(a[e]=[]);if(a[e].length>0)t=a[e][a[e].length-1],t.isLastNode=!1;a[e].splice(a[e].length,0,c);c.isLastNode=!0;c.isFirstNode=a[e].length==1;}else a.isFirstNode&&r==d.move.TYPE_PREV?(j[e].splice(v,0,c),t=a,t.isFirstNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!0,c.isLastNode=!1):a.isLastNode&&r==d.move.TYPE_NEXT?(j[e].splice(v+1,0,c),t=a,t.isLastNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(r==d.move.TYPE_PREV?j[e].splice(v,0,c):j[e].splice(v+1,0,c),c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!1);m.fixPIdKeyValue(b,c);m.setSonNodeLevel(b,c.getParentNode(),c);f.setNodeLineIcos(b,c);f.repairNodeLevelClass(b,c,D);!b.data.keep.parent&&g[e].length<1?(g.isParent=!1,g.open=!1,a=o(g,d.id.UL,b),r=o(g,d.id.SWITCH,b),e=o(g,d.id.ICON,b),f.replaceSwitchClass(g,r,d.folder.DOCU),f.replaceIcoClass(g,e,d.folder.DOCU),a.css("display","none")):x&&f.setNodeLineIcos(b,x);t&&f.setNodeLineIcos(b,t);b.check&&b.check.enable&&f.repairChkClass&&(f.repairChkClass(b,g),f.repairParentChkClassWithSelf(b,g),g!=c.parent&&f.repairParentChkClassWithSelf(b,c));i||f.expandCollapseParentNode(b,c.getParentNode(),!0,k);}},removeEditBtn:function removeEditBtn(b,a){o(a,d.id.EDIT,b).unbind().remove();},removeRemoveBtn:function removeRemoveBtn(b,a){o(a,d.id.REMOVE,b).unbind().remove();},removeTreeDom:function removeTreeDom(b,a){a.isHover=!1;f.removeEditBtn(b,a);f.removeRemoveBtn(b,a);g.apply(b.view.removeHoverDom,[b.treeId,a]);},repairNodeLevelClass:function repairNodeLevelClass(b,a,c){if(c!==a.level){var f=o(a,b),g=o(a,d.id.A,b),b=o(a,d.id.UL,b),c=d.className.LEVEL+c,a=d.className.LEVEL+a.level;f.removeClass(c);f.addClass(a);g.removeClass(c);g.addClass(a);b.removeClass(c);b.addClass(a);}},selectNodes:function selectNodes(b,a){for(var c=0,d=a.length;c<d;c++){f.selectNode(b,a[c],c>0);}}},event:{},data:{setSonNodeLevel:function setSonNodeLevel(b,a,c){if(c){var d=b.data.key.children;c.level=a?a.level+1:0;if(c[d])for(var a=0,f=c[d].length;a<f;a++){c[d][a]&&m.setSonNodeLevel(b,c,c[d][a]);}}}}});var H=v.fn.zTree,g=H._z.tools,d=H.consts,f=H._z.view,m=H._z.data,o=g.$;m.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});m.addInitBind(function(b){var a=b.treeObj,c=d.event;a.bind(c.RENAME,function(a,c,d,f){g.apply(b.callback.onRename,[a,c,d,f]);});a.bind(c.DRAG,function(a,c,d,f){g.apply(b.callback.onDrag,[c,d,f]);});a.bind(c.DRAGMOVE,function(a,c,d,f){g.apply(b.callback.onDragMove,[c,d,f]);});a.bind(c.DROP,function(a,c,d,f,e,m,o){g.apply(b.callback.onDrop,[c,d,f,e,m,o]);});});m.addInitUnBind(function(b){var b=b.treeObj,a=d.event;b.unbind(a.RENAME);b.unbind(a.DRAG);b.unbind(a.DRAGMOVE);b.unbind(a.DROP);});m.addInitCache(function(){});m.addInitNode(function(b,a,c){if(c)c.isHover=!1,c.editNameFlag=!1;});m.addInitProxy(function(b){var a=b.target,c=m.getSetting(b.data.treeId),f=b.relatedTarget,k="",i=null,j="",e=null,o=null;if(g.eqs(b.type,"mouseover")){if(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}]))k=g.getNodeMainDom(o).id,j="hoverOverNode";}else if(g.eqs(b.type,"mouseout"))o=g.getMDom(c,f,[{tagName:"a",attrName:"treeNode"+d.id.A}]),o||(k="remove",j="hoverOutNode");else if(g.eqs(b.type,"mousedown")&&(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}])))k=g.getNodeMainDom(o).id,j="mousedownNode";if(k.length>0)switch(i=m.getNodeCache(c,k),j){case"mousedownNode":e=x.onMousedownNode;break;case"hoverOverNode":e=x.onHoverOverNode;break;case"hoverOutNode":e=x.onHoverOutNode;}return{stop:!1,node:i,nodeEventType:j,nodeEventCallback:e,treeEventType:"",treeEventCallback:null};});m.addInitRoot(function(b){var b=m.getRoot(b),a=m.getRoots();b.curEditNode=null;b.curEditInput=null;b.curHoverNode=null;b.dragFlag=0;b.dragNodeShowBefore=[];b.dragMaskList=[];a.showHoverDom=!0;});m.addZTreeTools(function(b,a){a.cancelEditName=function(a){m.getRoot(this.setting).curEditNode&&f.cancelCurEditNode(this.setting,a?a:null,!0);};a.copyNode=function(a,b,k,i){if(!b)return null;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;var j=this,e=g.clone(b);if(!a)a=null,k=d.move.TYPE_INNER;k==d.move.TYPE_INNER?(b=function b(){f.addNodes(j.setting,a,-1,[e],i);},g.canAsync(this.setting,a)?f.asyncNode(this.setting,a,i,b):b()):(f.addNodes(this.setting,a.parentNode,-1,[e],i),f.moveNode(this.setting,a,e,k,!1,i));return e;};a.editName=function(a){a&&a.tId&&a===m.getNodeCache(this.setting,a.tId)&&(a.parentTId&&f.expandCollapseParentNode(this.setting,a.getParentNode(),!0),f.editNode(this.setting,a));};a.moveNode=function(a,b,k,i){function j(){f.moveNode(e.setting,a,b,k,!1,i);}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;else if(a&&(b.parentTId==a.tId&&k==d.move.TYPE_INNER||o(b,this.setting).find("#"+a.tId).length>0))return null;else a||(a=null);var e=this;g.canAsync(this.setting,a)&&k===d.move.TYPE_INNER?f.asyncNode(this.setting,a,i,j):j();return b;};a.setEditable=function(a){this.setting.edit.enable=a;return this.refresh();};});var N=f.cancelPreSelectedNode;f.cancelPreSelectedNode=function(b,a){for(var c=m.getRoot(b).curSelectedList,d=0,g=c.length;d<g;d++){if(!a||a===c[d])if(f.removeTreeDom(b,c[d]),a)break;}N&&N.apply(f,arguments);};var O=f.createNodes;f.createNodes=function(b,a,c,d,g){O&&O.apply(f,arguments);c&&f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(b,d);};var V=f.makeNodeUrl;f.makeNodeUrl=function(b,a){return b.edit.enable?null:V.apply(f,arguments);};var L=f.removeNode;f.removeNode=function(b,a){var c=m.getRoot(b);if(c.curEditNode===a)c.curEditNode=null;L&&L.apply(f,arguments);};var P=f.selectNode;f.selectNode=function(b,a,c){var d=m.getRoot(b);if(m.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag)return!1;P&&P.apply(f,arguments);f.addHoverDom(b,a);return!0;};var Q=g.uCanDo;g.uCanDo=function(b,a){var c=m.getRoot(b);if(a&&(g.eqs(a.type,"mouseover")||g.eqs(a.type,"mouseout")||g.eqs(a.type,"mousedown")||g.eqs(a.type,"mouseup")))return!0;if(c.curEditNode)f.editNodeBlur=!1,c.curEditInput.focus();return!c.curEditNode&&(Q?Q.apply(f,arguments):!0);};})(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var beop=window.beop||{};beop.baseMap=beop.baseMap||{};(function(window,$,nsBaseMap){var CONSTS={AMap:{name:'',url:location.protocol+'//webapi.amap.com/maps',params:{key:'9cc89c68a4bd6f3f5f65589f85ad7685',v:'1.3'}},GLoader:{name:'Google Loader',url:'https://www.google.com/jsapi'},GMap:{name:'Google Map',url:'http://maps.googleapis.com/maps/api/js',params:{key:'AIzaSyAzzOzAmrGov5GLacve9w8_Q8dS-xBYCgc',libraries:'geometry,places'}}};var defaults={mapContainer:'mapContainer',defaultLng:'121.6283679',defaultLat:'31.2114943',markerImgPath:'/static/images/map_marker_online.png'};var util={inherits:function inherits(clazz,base){var clazzPrototype=clazz.prototype;var F=function F(){};F.prototype=base.prototype;clazz.prototype=new F();for(var prop in clazzPrototype){clazz.prototype[prop]=clazzPrototype[prop];}
clazz.constructor=clazz;},loadJS:function loadJS(url,callback){var done=false;var script=document.createElement('script');script.type='text/javascript';script.language='javascript';script.src=url;script.onload=script.onreadystatechange=function(){if(!done&&(!script.readyState||script.readyState=='loaded'||script.readyState=='complete')){done=true;script.onload=script.onreadystatechange=null;typeof callback==='function'&&callback.call(script);}};document.getElementsByTagName("head")[0].appendChild(script);},runJS:function runJS(url,callback){this.loadJS(url,function(){document.getElementsByTagName('head')[0].removeChild(this);typeof callback==='function'&&callback();});}};function PaneMapSearch(map,iptSch,paneSchRes){this.map=map;this.$iptSch=$(iptSch);this.$paneSchRes=$(paneSchRes);this.$liSets=[];this.rs=null;this.rsCount=0;this.showLimits=5;this.curSelect=-1;this.isPaneShow=false;this.bindEvents();this.$iptSch.parent('div').show();}
PaneMapSearch.prototype.bindEvents=function(){var _this=this;this.$iptSch.keyup(function(e){var kc=e.keyCode;switch(kc){case 38:_this.prev();e.preventDefault();break;case 40:_this.next();e.preventDefault();break;case 13:_this.doSearch();break;default:_this.autoComplete();break;}});this.$paneSchRes.on('click','a',function(e){var $this=$(this);var index=$this.attr('data-sort')||0;_this.to(index);_this.doSearch();e.preventDefault();});};PaneMapSearch.prototype.showPane=function(){this.$paneSchRes.show();this.isPaneShow=true;};PaneMapSearch.prototype.hidePane=function(){this.$paneSchRes.hide();this.isPaneShow=false;};PaneMapSearch.prototype.prev=function(){this.to(this.curSelect-1);};PaneMapSearch.prototype.next=function(){this.to(this.curSelect+1);};PaneMapSearch.prototype.to=function(index){if(!this.isPaneShow){this.showPane();return;}
index=Math.min(Math.max(0,index),this.rsCount-1);if(index===this.curSelect)return;this.curSelect=index;this.$liSets.removeClass('on');this.$liSets.eq(index).addClass('on');this.$iptSch.val(this.rs[index].name);};PaneMapSearch.prototype.doSearch=function(){var _this=this;var keywords=this.$iptSch.val().trim();var options;if(keywords==='')return;_this.hidePane();if(this.curSelect>-1){options={pageSize:1,city:this.rs[this.curSelect].adcode};}
this.map.placeSearch(keywords,options,function(rs){if(rs.status!==0)return;rs=rs.data;if(_this.curSelect<0){_this.map.setCenter(rs[0].lng,rs[0].lat);_this.map.setZoom(15);}else{_this.map.trigger('click',{lnglat:rs[0]});}});};PaneMapSearch.prototype.autoComplete=function(){var _this=this;var keywords=this.$iptSch.val().trim();keywords=keywords.replace(/[\\\?\.\+\^\$]/g,'');if(keywords==='')return;this.map.search(keywords,function(rs){if(rs.status!==0)return;rs=rs.data;var arrHtml=[];_this.rsCount=Math.min(rs.length,_this.showLimits);_this.rs=rs;_this.curSelect=-1;if(_this.rsCount<=0){_this.hidePane();return;}
for(var i=0;i<_this.rsCount;i++){arrHtml.push('<li><a data-sort="'+i+'" href="javascript:;"><span class="rs-name">'+rs[i].name.replace(new RegExp(keywords.replace(/([\(\)])/g,'\\$1')),'<span class="keywords">'+keywords+'</span>')+'</span><span class="rs-district">'+rs[i].district+'</span</a></li>');};_this.$paneSchRes.html(arrHtml.join(''));_this.showPane();_this.$liSets=_this.$paneSchRes.children('li');});};PaneMapSearch.prototype.destroy=function(){this.$iptSch.unbind();this.$paneSchRes.off();};var BaseMap=function BaseMap(options){this.options=$.extend({},defaults,options);this.markers=[];};BaseMap.load=function(type,callback){var _this=this;var url=CONSTS[type].url;var params=CONSTS[type].params;var p=[];for(var i in params){if(params.hasOwnProperty(i)){p.push(i+'='+params[i]);}}
if(p.length)url=url+'?';util.runJS(url+p.join('&'),function(){window.console&&console.log('load JS: '+url+' success!');(typeof callback==='undefined'?'undefined':_typeof(callback))&&callback.call(_this);});};var GDMap=function GDMap(options){BaseMap.call(this,options);this.markers=[];this.controls=[];this.zoom=15;this.init();};GDMap.load=function(options,callback){if(typeof options==='function'){callback=options;options=null;}
if(!GDMap.isLoaded()){BaseMap.load('AMap',function(){var ins=new GDMap(options);AMap.event.addListenerOnce(ins.map,'complete',function(){typeof callback==='function'&&callback(ins);});});}else{callback(new GDMap(options));}};GDMap.isLoaded=function(){return window.AMap&&window.AMap.Map;};GDMap.prototype.init=function(){this.map=new AMap.Map(this.options.mapContainer,{resizeEnable:true,view:new AMap.View2D({zoom:this.zoom})});};GDMap.prototype.setCenter=function(lng,lat){return this.map.setCenter(this.getPoint(lng,lat));};GDMap.prototype.setZoom=function(level){return this.map.setZoom(level);};GDMap.prototype.getPoint=function(lng,lat){return new AMap.LngLat(lng,lat);};GDMap.prototype.addMarker=function(lng,lat){var marker;lng=lng||this.options.defaultLng;lat=lat||this.options.defaultLat;marker=new AMap.Marker({map:this.map,icon:this.options.markerImgPath,position:this.getPoint(lng,lat)});marker&&this.markers.push(marker);return marker;};GDMap.prototype.removeMarker=function(marker){var removed;for(var i=this.markers.length-1;i>=0;i--){if(this.markers[i]===marker){removed=this.markers.splice(i,1);removed.setMap(null);}};};GDMap.prototype.removeAllMarkers=function(){for(var i=this.markers.length-1;i>=0;i--){this.markers[i].setMap(null);}
this.markers.length=0;};GDMap.prototype.addListener=function(eventName,handler){AMap.event.addListener(this.map,eventName,handler);};GDMap.prototype.trigger=function(eventName,args){AMap.event.trigger(this.map,eventName,args);};GDMap.prototype.getAddress=function(lng,lat,callback){var _this=this;var geocoder;var format=[],statusCode=-1;AMap.service(["AMap.Geocoder"],function(){var geocoder=new AMap.Geocoder();geocoder.getAddress(_this.getPoint(lng,lat),function(status,rs){var geoinfo=rs.regeocode;if(status==='complete'&&rs.info==='OK'){format.push({name:geoinfo.formattedAddress,components:{city:geoinfo.addressComponent.city,province:geoinfo.addressComponent.province}});statusCode=0;}
typeof callback==='function'&&callback({status:statusCode,data:format});});});};GDMap.prototype.getLocation=function(addr,callback){var _this=this;var format=[],statusCode=-1;AMap.service(["AMap.Geocoder"],function(){var geocoder=new AMap.Geocoder();geocoder.getLocation(addr,function(status,rs){var point;if(status==='complete'&&rs.info==='OK'){for(var i=0,len=rs.geocodes.length;i<len;i+=1){point=rs.geocodes[i].location;format.push({lng:point.lng,lat:point.lat});}
statusCode=0;}
typeof callback==='function'&&callback({status:statusCode,data:format});});});};GDMap.prototype.search=function(keywords,callback){var format=[],statusCode=-1;AMap.service(['AMap.Autocomplete'],function(){var auto=new AMap.Autocomplete();if(keywords.length>0){auto.search(keywords,function(status,result){if(status==='complete'&&result.info==='OK'){for(var i=0,len=result.tips.length;i<len;i++){format.push({name:result.tips[i].name,district:result.tips[i].district,adcode:result.tips[i].adcode});};statusCode=0;typeof callback==='function'&&callback({status:statusCode,data:format});}});}});};GDMap.prototype.placeSearch=function(keywords,options,callback){var pSearch;if(typeof options==='function'){callback=options;options=null;}
AMap.service(['AMap.PlaceSearch'],function(){pSearch=new AMap.PlaceSearch(options);pSearch.search(keywords,function(status,rs){var format=[],statusCode=-1;var row;if(status==='complete'&&rs.info==='OK'){for(var i=0,len=rs.poiList.pois.length;i<len;i++){row=rs.poiList.pois[i];format.push({lng:row.location.getLng(),lat:row.location.getLat(),address:row.address});}
statusCode=0;}
typeof callback==='function'&&callback({status:statusCode,data:format});});});};GDMap.prototype.setFitView=function(){this.map.setFitView();};GDMap.prototype.addSearchBox=function(iptSch,mapSchPane){this.controls.push(new PaneMapSearch(this,iptSch,mapSchPane));};GDMap.prototype.destroy=function(){for(var i=this.controls.length-1;i>=0;i--){if(typeof this.controls[i].destroy!=='function'){console.warn('one map UI control not destroy!');continue;}
this.controls[i].destroy();};this.map.destroy();};var GoogleMap=function GoogleMap(options){BaseMap.call(this,options);this.markers=[];this.controls=[];this.zoom=16;this.init();};GoogleMap.load=function(options,_callback){if(typeof options==='function'){_callback=options;options=null;}
if(!GoogleMap.isLoaded()){BaseMap.load('GLoader',function(){var params=CONSTS['GMap'].params;var p=[];for(var i in params){if(params.hasOwnProperty(i)){p.push(i+'='+params[i]);}}
google.load('maps',3,{other_params:p.join('&'),callback:function callback(){var ins=new GoogleMap(options);google.maps.event.addListenerOnce(ins.map,'tilesloaded',function(){typeof _callback==='function'&&_callback(ins);});}});});}else{_callback(new GoogleMap(options));}};GoogleMap.isLoaded=function(){return window.google&&window.google.maps;};GoogleMap.prototype.init=function(){this.map=new google.maps.Map($('#'+this.options.mapContainer)[0],{zoom:this.zoom,disableDefaultUI:true,center:this.getPoint(this.options.defaultLng,this.options.defaultLat)});};GoogleMap.prototype.setCenter=function(lng,lat){return this.map.setCenter(this.getPoint(lng,lat));};GoogleMap.prototype.setZoom=function(level){return this.map.setZoom(level);};GoogleMap.prototype.getPoint=function(lng,lat){return new google.maps.LatLng(lat,lng);};GoogleMap.prototype.addMarker=function(lng,lat){var marker;lng=lng||this.options.defaultLng;lat=lat||this.options.defaultLat;marker=new google.maps.Marker({map:this.map,icon:this.options.markerImgPath,position:this.getPoint(lng,lat)});marker&&this.markers.push(marker);return marker;};GoogleMap.prototype.removeMarker=function(marker){var removed;for(var i=this.markers.length-1;i>=0;i--){if(this.markers[i]===marker){removed=this.markers.splice(i,1);removed.setMap(null);}};};GoogleMap.prototype.removeAllMarkers=function(){for(var i=this.markers.length-1;i>=0;i--){this.markers[i].setMap(null);}
this.markers.length=0;};GoogleMap.prototype.addListener=function(eventName,handler){var _this=this;return google.maps.event.addListener(this.map,eventName,function(e){_this.formatEventResult(e);handler.call(this,e);});};GoogleMap.prototype.removeAllListener=function(){google.maps.event.clearInstanceListeners(this.map);};GoogleMap.prototype.trigger=function(eventName,args){args.latLng=args.lnglat;delete args.lnglat;return google.maps.event.trigger(this.map,eventName,args);};GoogleMap.prototype.formatEventResult=function(rs){if(rs.latLng){rs.lnglat={lng:rs.latLng.lng(),lat:rs.latLng.lat()};}};GoogleMap.prototype.getAddress=function(lng,lat,callback){var _this=this;var geocoder=new google.maps.Geocoder();var format=[],statusCode=-1;geocoder.geocode({latLng:this.getPoint(lng,lat)},function(rs,status){if(status==google.maps.GeocoderStatus.OK){for(var i=0,len=rs.length;i<len;i++){format.push({name:rs[0].formatted_address,components:_this._formatAddressComponents(rs[i].address_components)});};statusCode=0;}
typeof callback==='function'&&callback({status:statusCode,data:format});});};GoogleMap.prototype.getLocation=function(addr,callback){var geocoder=new google.maps.Geocoder();var format=[],statusCode=-1;geocoder.geocode({address:addr},function(rs,status){if(status==google.maps.GeocoderStatus.OK){for(var i=0,len=rs.length;i<len;i++){format.push({name:rs[i].formatted_address,lng:rs[i].geometry.location.lng(),lat:rs[i].geometry.location.lat()});};statusCode=0;}
typeof callback==='function'&&callback({status:statusCode,data:format});});};GoogleMap.prototype.search=function(keywords,callback){};GoogleMap.prototype.setFitView=function(){if(this.markers.length<=0)return;this.map.panTo(this.markers[0].getPosition());};GoogleMap.prototype.addSearchBox=function(iptSch){var _this=this;var input=document.getElementById('btnGoogleSch');var searchBox;this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);searchBox=new google.maps.places.SearchBox(input);google.maps.event.addListener(searchBox,'places_changed',function(){var places=searchBox.getPlaces();if(places.length<=0)return;_this.trigger('click',{latLng:places[0].geometry.location});});input.style.display='block';};GoogleMap.prototype.destroy=function(){for(var i=this.controls.length-1;i>=0;i--){if(typeof this.controls[i].destroy!=='function'){console.warn('one map UI control does not destroy!');continue;}
this.controls[i].destroy();};this.removeAllMarkers();this.removeAllListener();};GoogleMap.prototype._formatAddressComponents=function(addressComponents,type){var format={};for(var i=addressComponents.length-1;i>=0;i--){switch(addressComponents[i].types[0]){case'administrative_area_level_1':format.province=addressComponents[i].long_name;break;case'locality':format.city=addressComponents[i].long_name;break;}}
return format;};nsBaseMap.load=function(callback){var isGoogleAvailable=localStorage.getItem('isGoogleAvailable');if((typeof isGoogleAvailable==='undefined'?'undefined':_typeof(isGoogleAvailable))!==(typeof undefined==='undefined'?'undefined':_typeof(undefined))&&isGoogleAvailable!=='error'){return isGoogleAvailable==='true'?new GoogleMap():new GaodeMap();}
if(I18n.type==='zh'){return new GaodeMap();}else{return new GoogleMap();}};nsBaseMap.loadAccurateMap=function(type,callback){if(type==='AMap'){GDMap.load(callback);}else if(type==='GMap'){GoogleMap.load(callback);}else{throw new SyntaxError('Map type is illegal !');}};})(window,jQuery,beop.baseMap,undefined);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var Validator=function($,undefined){var push=[].push;var rulesMap={};function RuleWrap(ele,name,rule){this.$ele=$(ele);this.name=name;this.rule=rule;this.defer=$.Deferred();this.value=this.$ele.val();};RuleWrap.prototype.valid=function(){var handler=this.rule.valid;var _this=this;var type=$.type(handler);if(type!=='function'&&type!=='string'){console.warn('rule is illigal!');return;}
else if(type==='string'&&rulesMap[handler]===undefined){console.warn('rule is not exists!');return;}
else if(type==='string'){handler=rulesMap[handler];}
return handler;};RuleWrap.prototype.success=function(){this.defer.resolveWith(this);};RuleWrap.prototype.fail=function(){this.defer.rejectWith(this);};function Validator(ele,options){if(arguments.length===0)return this;if(arguments.length===1){options=ele;ele='body';}
this.$ele=$.type(ele)==='object'?ele:$(ele);this.options=$.extend({},Validator.DEFAULTS,options);this.__merge(this,this.options.elements||[]);this.__init();return this;}
Validator.prototype.__init=function(){var $selectors;var html='<span class="glyphicon'+(this.options.icon?' glyphicon-pencil':'')+' form-control-feedback"></span>';for(var i=0,row,len=this.length;i<len;i++){row=this[i];$selectors=$.type(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);$selectors.each(function(i,ele){var $ele=$(ele),$formGroup;$formGroup=$ele.closest('.form-group');$formGroup.addClass('has-feedback');if($formGroup.children('form-control-feedback').length===0){$(html).insertAfter($ele);}});}};Validator.prototype.valid=function(callback){var self=this;var row,results=[];var $selectors;var deferGroups=[];this.resetStatus();for(var i=0,len=this.length;i<len;i++){row=this[i];$selectors=$.type(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);if($selectors.length===0)continue;$selectors.each(function(i,ele){var $ele=$(ele);var val=$ele.val();var defers=[];var obj;for(var t=0,len2=row.rules.length;t<len2;t++){obj=new RuleWrap(ele,row.name,row.rules[t]);defers.push(obj);}
defers[0].valid().call(defers[0],defers[0].value);defers=defers.map(function(row,i,arr){if(i+1<len2){row.defer.done(function(){arr[i+1].valid().call(arr[i+1],defers[0].value);});}
return row.defer;});deferGroups.push(defers);});}
deferGroups=deferGroups.map(function(deferGrp,i){var newDefer=$.Deferred();$.when.apply($,deferGrp).done(function(){var $ele,$formGroup;var _this,obj={};if(this.length)_this=this[0];else _this=this;$ele=_this.$ele;self.setStatus($ele,'success');obj[_this.name]=_this.value;newDefer.resolve(obj);}).fail(function(){var $ele=this.$ele,ele=$ele[0];self.setStatus($ele,'error');if(ele.timer!==null){window.clearTimeout(ele.timer);ele.timer=null;}
$ele.tooltip({placement:'top',trigger:'manual'}).attr('data-original-title',this.rule['msg']).tooltip('show');ele.timer=window.setTimeout(function($ele){return function(){$ele.tooltip('hide');$ele[0].timer=null;};}($ele),2000);newDefer.reject();});return newDefer;});return $.when.apply($,deferGroups).then(function(rs){return $.extend.apply($,[].slice.call(arguments));});};Validator.prototype.setStatus=function($ele,type){if(!this.options.icon)return;if(type==='error'){$ele.closest('.form-group').addClass('has-error').children('.form-control-feedback').removeClass(['glyphicon-ok','glyphicon-pencil'].join(' ')).addClass('glyphicon-remove');}else if(type==='success'){$ele.closest('.form-group').addClass('has-success').children('.form-control-feedback').removeClass(['glyphicon-pencil','glyphicon-remove'].join(' ')).addClass('glyphicon-ok');}};Validator.prototype.resetStatus=function(){var $selectors,row,$ele,ele,data;for(var i=0,len=this.length;i<len;i++){row=this[i];$selectors=_typeof(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);for(var t=0,len2=$selectors.length;t<len2;t++){$ele=$selectors.eq(t);ele=$selectors[t];$ele.parents('.form-group').removeClass('has-error has-success');if(ele.timer){window.clearTimeout(ele.timer);ele.timer=null;}
if(data=$ele.data('bs.tooltip')){data.$tip.detach();}}}};Validator.prototype.filter=function(selector){return this.__seek(selector,true);};Validator.prototype.not=function(selector){return this.__seek(selector,false);};Validator.prototype.__seek=function(selector,isNeed){var results=[],ret;var eles=this.options.elements;var regx=$.type(selector)==='string'?new RegExp('^'+selector+'$'):regx;if($.type(regx)!=='regexp'){throw'selector is not a RegExp object or a string!';}
isNeed=isNeed||false;for(var i=0,len=eles.length;i<len;i++){if(!!regx.test(eles[i]['name'])===isNeed)results.push(eles[i]);}
ret=this.__merge(new this.constructor(),results);ret.prevObj=this;ret.$ele=this.$ele;ret.options=this.options;return ret;};Validator.prototype.__merge=function(newObj,arr){for(var i=0,len=arr.length;i<len;i++){push.call(newObj,arr[i]);}
return newObj;};Validator.prototype.length=0;Validator.prototype.splice=[].splice;Validator.extendRules=function(name,handler){var rules={},fn;if($.type(name)==='string')rules[name]=handler;else if($.type(name)==='object')rules=name;else return;for(var i in rules){if(!rules.hasOwnProperty(i))continue;fn=rules[i];if($.type(fn)!=='function')continue;rulesMap[i]=fn;}};Validator.extendRules({'require':function require(val){if(val.trim()==='')this.fail();else this.success();},'word':function word(val){if(/^\w+$/.test(val))this.success();else this.fail();},'wordWithSpace':function wordWithSpace(val){if(val.trim()!==val){this.fail();}else{if(/^[\w\s]+$/.test(val))this.success();else this.fail();}}});Validator.DEFAULTS={tooltipDelay:2000,icon:true};return Validator;}(jQuery);var Internationalization=function(){function Internationalization(lang,resource){this.type=lang||localStorage["language"];this.resource=resource||{};}
Internationalization.prototype={getResource:function getResource(){return this.resource;},fillPage:function fillPage(){this.fill2($('[i18n]'));},fillArea:function fillArea(element){this.fill2(element.find('[i18n]'));try{Permission.check(element);}catch(e){console.log('check permission failed:'+e);}},fillAreaAttribute:function fillAreaAttribute(element,attributeName){this.fill(element.find('[i18n]['+attributeName+']'),attributeName);},fill:function fill(arrElement,attributeName){for(var i=0,arrPath,text,len=arrElement.length;i<len;i++){arrPath=arrElement[i].attributes["i18n"].value.split('.');text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
if(!attributeName){arrElement[i].innerHTML=text;}else{arrElement[i].setAttribute(attributeName,text);}}},getI18nValue:function getI18nValue(i18nKey){if(!i18nKey){return'';}
var arrPath=i18nKey.split('.');var text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
return text;},fill2:function fill2(arrElement){for(var i=0,len=arrElement.length;i<len;i++){var i18nValue=arrElement[i].attributes["i18n"];var items=i18nValue.value.split(';'),item,attrMap;for(var j=0;j<items.length;j++){item=items[j];if(!item){continue;}
if(item.indexOf('=')===-1){i18nValue=this.getI18nValue(item);arrElement[i].innerHTML=i18nValue;}else{attrMap=item.split('=');if(!attrMap[0]){continue;}
arrElement[i].setAttribute(attrMap[0],this.getI18nValue(attrMap[1]));}}}},findContent:function findContent(strPath){var arrPath=strPath.split('.');var text=this.resource;for(var i=0,len=arrPath.length;i<len;i++){text=text&&text[arrPath[i]];}
return text;}};return Internationalization;}();function InitI18nResource(strLanguage,isForce,filePath){if(!strLanguage){strLanguage=localStorage["isUserSelectedLanguage"]||navigator.language.split('-')[0];}
if(isForce){localStorage["isUserSelectedLanguage"]=strLanguage;}else if(localStorage["isUserSelectedLanguage"]){strLanguage=localStorage["isUserSelectedLanguage"];}
filePath=filePath||'/static/views/js/i18n/';return $.ajax({async:false,url:filePath+strLanguage+".js",dataType:"script"}).then(function(){localStorage["language"]=strLanguage;return i18n_resource;},function(){return $.ajax({async:false,url:filePath+"en.js",dataType:'script'}).then(function(){localStorage["language"]="en";return i18n_resource;},function(){console.warn('i18n files loading failed!');return{};});});}
var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var infoBox=infoBox||{};(function($){var infoBoxBase={$el:null,options:{position:'center'},_init:function _init(){this._removeAll();this._createBox();if(this.options.movable){this._makeMovable();}},_createBox:function _createBox(){var me=this,$box;$('.infoBox-unique.'+me.options.boxType).remove();$box=$('<div class="infoBox infoBox-unique '+me.options.boxType+'"></div>');this.$el=$box;if(me.options.position){$box.addClass(me.options.position);}
if(me.options.hasHeader){var $header=$('<div class="infoBox-header"></div>');if(me.options.movable){$header.addClass('movable');}
if(me.options.title){$header.append('<div class="ellipsis infoBox-title">'+me.options.title+'</div>');}
if(me.options.hasClose){var $close=$('<div class="infoBox-close"></div>');$header.append($close);$close.click(function(){me._destroy();});}
if(me.options.hasResize){var $zoomIn=$('<div class="infoBox-resize"><span class="glyphicon glyphicon-resize-full" aria-hidden="true"></span></div>');$header.append($zoomIn);$zoomIn.off('click.resizeFull').on('click.resizeFull','.glyphicon-resize-full',function(){me._resizeFull();});$zoomIn.off('click.resizeSmall').on('click.resizeSmall','.glyphicon-resize-small',function(){me._resizeSmall();});}
$box.append($header);}
var $body=$('<div class="infoBox-body scrollbar"></div>');if(me.options.icon){$body.append('<div class="infoBox-icon"><img src="/static/scripts/lib/beopNotification/image/'+me.options.icon+'"></div>');}
if(_typeof(me.options.msg)===_typeof(1)){me.options.msg=String(me.options.msg);}
if(!me.options.msg){me.options.msg='';}
me.options.msg=me.options.msg.replace(/\n/g,'<br/>');var infoBoxMsgBox=$('<div class="infoBox-msg">').appendTo($body);infoBoxMsgBox.append('<div style="margin-top: 10px;">'+me.options.msg+'</div>');if(me.options.input){infoBoxMsgBox.append('<input class="form-control" style="width:250px;margin-top:10px;display:inline-block" />');}
$box.append($body);if(me.options.buttons){var $footer=$('<div class="infoBox-footer"></div>');$box.append($footer);for(var btnKey in me.options.buttons){if(me.options.buttons.hasOwnProperty(btnKey)){$footer.append(me._createBtn(me.options.buttons[btnKey]));}}}
if(me.options.delay){var $progress=$('<div class="progress progress-bar-success"><div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><span class="sr-only"</span></div></div>');$progress.insertBefore($body);$progress.animate({width:"100%"},+me.options.delay?+me.options.delay:20000,function(){me._destroy();});}
if(me.options.modal&&$('#infoBoxModal').length==0){var modalHtml='<div id="infoBoxModal"></div>';$('body').append(modalHtml);}
$box.appendTo(document.body);return $box;},_processInput:function _processInput(options){options.boxType=this.constructor.name?this.constructor.name:'';return options;},_show:function _show(){this.$el.fadeIn('fast');I18n.fillArea(this.$el);var $btn=this.$el.find('[i18n]');$btn.each(function(i,item){var arr=['OK','Cancel'];var $item=$(item);if(I18n.getI18nValue($item.attr('i18n'))===undefined){$item.html(arr[i]);}});},_hide:function _hide(){this.$el.hide();},_click:function _click(){var _this=this;this.$el.click(function(){_this._destroy();});},_destroy:function _destroy(){var me=this;me.$el.fadeOut('fast',function(){me.$el.remove();});if(me.options.modal){$('#infoBoxModal').remove();}},_resizeFull:function _resizeFull(){this.$el.addClass('full-size');this.$el.find('.infoBox-resize>.glyphicon').removeClass('glyphicon-resize-full').addClass('glyphicon-resize-small');},_resizeSmall:function _resizeSmall(){this.$el.removeClass('full-size');this.$el.find('.infoBox-resize>.glyphicon').removeClass('glyphicon-resize-small').addClass('glyphicon-resize-full');},_makeMovable:function _makeMovable(){var me=this;me.$el.mousedown(function(){me.$el.mousemove(function(e){var thisX=event.pageX-$(this).width()/2,thisY=event.pageY-$(this).height()/2;me.$el.offset({left:thisX,top:thisY});});}).mouseup(function(){me.$el.off('mousemove');});},_removeAll:function _removeAll(){if(this.options.boxType){if(this.options.boxType=='remind'){$(document.body).children('.remind').remove();}else{}}else{$(document.body).children('.infoBox-unique').remove();}},_createBtn:function _createBtn(option){var me=this;var $button=$('<button class="btn btn-info alert-button"></button>');$button.attr('i18n',option.i18n);$button.text(option.text);$button.click(function(){me._destroy();option.callback&&option.callback();});$button.addClass(option.css);this.$el.find('.infoBox-footer').append($button);},close:function close(){this._destroy();}};function infoBoxTip(msg,options){var _this=this;this.type=options&&options.type||infoBox.tip.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
this.options=this._processInput(options);this._init();this._show();this._click();if(!options.delay){options.delay=2000;}
setTimeout(function(){_this._destroy();},options.delay);}
infoBoxTip.prototype=$.extend({},infoBoxBase,{constructor:infoBoxTip,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.tip.base,infoBox.tip.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.tip=function(msg,options){return new infoBoxTip(msg,options);};infoBox.tip.base={position:'center',type:'info',modal:true,movable:false};infoBox.tip.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxPrompt(msg,_callback,cancelCallback,options){var _this=this;this.type=options&&options.type||infoBox.prompt.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
options=$.extend(true,options,{buttons:{ok:{callback:function callback(){_callback(_this.$el.find('input').val());}},cancel:{callback:cancelCallback}}});this.options=this._processInput(options);this._init();this._show();if(options.delay&&!isNaN(options.delay)){var timeout=setTimeout(function(){_this._destroy();timeout=null;},option.delay);}}
infoBoxPrompt.prototype=$.extend({},infoBoxBase,{constructor:infoBoxPrompt,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.prompt.base,infoBox.prompt.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.prompt=function(msg,callback,cancelCallback,options){return new infoBoxPrompt(msg,callback,cancelCallback,options);};infoBox.prompt.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:function callback(){return true;}},cancel:{text:'Cancel',i18n:'common.CANCEL',class:'alert-button',callback:function callback(){return false;}}},input:{},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.prompt.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxAlert(msg,options){var _this=this;this.type=options&&options.type||infoBox.alert.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
this.options=this._processInput(options);this._init();this._show();if(options.delay&&!isNaN(options.delay)){var timeout=setTimeout(function(){_this._destroy();timeout=null;},options.delay);}}
infoBoxAlert.prototype=$.extend({},infoBoxBase,{constructor:infoBoxAlert,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.alert.base,infoBox.alert.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.alert=function(msg,options){if(!options){options={};}
options['type']='info';return new infoBoxAlert(msg,options);};infoBox.alert.warning=function(msg,options){if(!options){options={};}
options['type']='warning';return new infoBoxAlert(msg,options);};infoBox.alert.success=function(msg,options){if(!options){options={};}
options['type']='success';return new infoBoxAlert(msg,options);};infoBox.alert.danger=function(msg,options){if(!options){options={};}
options['type']='danger';return new infoBoxAlert(msg,options);};infoBox.alert.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:''}},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.alert.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxConfirm(msg,okCallback,cancelCallback,options){this.type=options&&options.type||infoBox.confirm.base.type;if(!okCallback&&!cancelCallback){okCallback=function okCallback(){};cancelCallback=function cancelCallback(){};this.type='danger';msg='warning:you not pass the callback to confirm function';}
options=$.extend(options,{msg:msg,buttons:{ok:{callback:okCallback},cancel:{callback:cancelCallback}}});this.options=this._processInput(options);this._init();this._show();}
infoBoxConfirm.prototype=$.extend({},infoBoxBase,{constructor:infoBoxConfirm,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.confirm.base,infoBox.confirm.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.confirm=function(msg,okCallback,cancelCallback,options){return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.danger=function(msg,okCallback,cancelCallback,options){if(!options){options={};}
options['type']='danger';return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.warn=function(msg,okCallback,cancelCallback,options){if(!options){options={};}
options['type']='warn';return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:function callback(){return true;}},cancel:{text:'Cancel',i18n:'common.CANCEL',class:'alert-button',callback:function callback(){return false;}}},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.confirm.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxRemind(typeOrMsg,options){if(!options){this.type=infoBox.remind.base.type;options={msg:typeOrMsg};}
if(!typeOrMsg){this.type=infoBox.remind.base.type;}else if(infoBox.remind.options[typeOrMsg]){this.type=typeOrMsg;}else{options=$.extend(options,{msg:typeOrMsg});}
this.options=this._processInput(options);this._init();this.$el.slideDown(1000);}
infoBoxRemind.prototype=$.extend({},infoBoxBase,{constructor:infoBoxRemind,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.remind.base,infoBox.remind.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.remind=function(type,options){return new infoBoxRemind(type,options);};infoBox.remind.base={type:'info',modal:false,hasHeader:true,hasClose:true};infoBox.remind.options={};function infoBoxVersion(title,content){this.options=this._processInput({'msg':content});this._init();var $versionTitle='<div class="ellipsis infoBoxVersion-title" title="'+title+'">'+'<span class="dib mr5"></span><span>'+title+'</span></div>';this.$el.find('.infoBox-header').append($versionTitle);this.$el.slideDown(1000);}
infoBoxVersion.prototype=$.extend({},infoBoxBase,{constructor:infoBoxVersion,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.version.base,infoBox.version.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.version=function(title,content){return new infoBoxVersion(title,content);};infoBox.version.base={modal:false,hasHeader:true,hasClose:true,delay:10000};infoBox.version.options={};function infoBoxMessage(content,options){this.options=this._processInput({'msg':content});this._init();var $messageTitle='<div style="position: relative; top: -10px;"><span class="fl">'+i18n_resource.workflow.message.MESSAGE+'</span>'+'<span class="fr header-right" style="cursor: pointer;"><span class="mr5 markAsAllRead">'+i18n_resource.workflow.message.ALL_READ+'</span><span class="glyphicon glyphicon-envelope"></span></span></div>';this.$el.find('.infoBox-header').append($messageTitle);options.initCb&&options.initCb.call(this);this.$el.slideDown(300);}
infoBoxMessage.prototype=$.extend({},infoBoxBase,{constructor:infoBoxMessage,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.message.base,infoBox.message.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.message=function(content,options){return new infoBoxMessage(content,options);};infoBox.message.base={modal:false,hasHeader:true};infoBox.message.options={};})(jQuery);try{if(infoBox){alert=infoBox.alert;tip=infoBox.tip;confirm=infoBox.confirm;remindInfoBox=infoBox.remind;versionInfoBox=infoBox.version;messageInfoBox=infoBox.message;}}catch(e){console.warn(''+e);}
var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var beop=beop||{};beop.constant={project_img_path:'/static/images/project_img/',project_default_img:'default.jpg',BEOP_IMG_HOST:'http://images.rnbtech.com.hk',OSS_PROJECT_IMG_PATH:'/custom/project_img/'};var ObjectId=function ObjectId(){var timestamp=new Date().valueOf();var userId=('000'+(window.AppConfig&&window.AppConfig.userId||'000')).slice(-3);var hex8=('00000000'+Math.floor(Math.random()*0xFFFFFFFF).toString(16)).slice(-8);return timestamp+userId+hex8;};(function(exports){exports.namespace=function(path){var obj=window;path=path.split('.');path.forEach(function(p,i){p=p.trim();if(i===0&&p==='window')return;obj=obj[p]=obj[p]||{};});return obj;};})(window);(function(exports){exports.Mixin=function(){var prototype={};var methods;for(var i=0,len=arguments.length;i<len;i++){methods=arguments[i];for(var m in methods){prototype[m]=methods[m];}}
return prototype;};})(window);(function(){var ENUM_LEVEL={LOG:1,INFO:2,DEBUG:3,WARN:4,ERROR:5,EXCEPTION:6};window.Log={level:ENUM_LEVEL.WARN,log:function log(){if(this.level>ENUM_LEVEL.LOG)return;Log._out('log',arguments);},info:function info(){if(this.level>ENUM_LEVEL.INFO)return;Log._out('info',arguments);},debug:function debug(){if(this.level>ENUM_LEVEL.DEBUG)return;Log._out('debug',arguments);},warn:function warn(){if(this.level>ENUM_LEVEL.WARN)return;Log._out('warn',arguments);},error:function error(){if(this.level>ENUM_LEVEL.ERROR)return;Log._out('error',arguments);},exception:function exception(message,_exception){if(this.level>ENUM_LEVEL.EXCEPTION)return;if(_exception){Log.error('Exception: ',message,_exception.stack||_exception);}else{Log.error('Exception: ',message);}},_out:function _out(type,args){console[type].apply(console,args);}};})();if(!Array.toMap){Array.toMap=function(arr,key){var map={};arr.forEach(function(row,i){map[row[key]]=row;});return map;};}
var FullScreenManager=function(){var manager=Object.create({init:function init(){var _this=this;$(document).off('webkitfullscreenchange');$(document).on('webkitfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('mozfullscreenchange');$(document).on('mozfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('msfullscreenchange');$(document).on('msfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});if(typeof onError==='function'){$(document).off('webkitfullscreenerror');$(document).on('webkitfullscreenerror',this.onFullScreenError);$(document).off('mozfullscreenerror');$(document).on('mozfullscreenerror',this.onFullScreenError);$(document).off('msfullscreenerror');$(document).on('msfullscreenerror',this.onFullScreenError);}},onFullScreenEnter:function onFullScreenEnter(){},onFullScreenOut:function onFullScreenOut(){},onFullScreenError:function onFullScreenError(){},toggle:function toggle(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen();}else if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen();}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen();}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}}else{if(document.exitFullscreen){document.exitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}}}});manager.init();return manager;}();function StringBuilder(){this.data=Array("");}
StringBuilder.prototype.append=function(){this.data.push(arguments[0]);return this;};StringBuilder.prototype.toString=function(){return this.data.join("");};StringBuilder.prototype.getLength=function(){return this.data.length;};if(!String.prototype.format){String.prototype.format=function(){if(arguments[0]===undefined){return'';}
if(arguments[0].constructor===Array){var args=arguments[0];}else{var args=arguments;}
return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};}
if(!String.prototype.formatEL){String.prototype.formatEL=function(o,defaultVal){var str=this.toString();if(!str||!o)return'';for(var p in o){if(o.hasOwnProperty(p)){str=str.replace(new RegExp('{'+p+'}','g'),o[p]);}}
if(typeof defaultVal!=='undefined'){str=str.replace(/{[^{}]*?}/g,defaultVal);}
return str;};}
String.prototype.toDate=function(){var str=this;if(str.indexOf('-')>-1)
str=str.replace('-','/').replace('-','/');return new Date(str);};if(!String.prototype.startsWith){String.prototype.startsWith=function(word){return new RegExp('^'+word).test(this);};}
Number.prototype.toDate=function(){return new Date(this);};function Alert(targetElement,type,msg){this.element=targetElement;this.str=new StringBuilder();this.str.append('<div style="display:none;" class="alert beop-alert alert-').append(type).append(' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>').append('<div class="alert-msg">'+msg+'</div>').append('</div>');this.$alert=$(this.str.toString());}
Alert.danger=function(targetElement,msg){return new Alert(targetElement,Alert.type.danger,msg);};Alert.warning=function(targetElement,msg){return new Alert(targetElement,Alert.type.warning,msg);};Alert.success=function(targetElement,msg){return new Alert(targetElement,Alert.type.success,msg);};Alert.info=function(targetElement,msg){return new Alert(targetElement,Alert.type.info,msg);};Alert.closeAll=function(){$('.beop-alert').remove();};Alert.type={danger:'danger',warning:'warning',success:'success',info:'info'};Alert.prototype.show=function(duration){Alert.closeAll();if(duration){var _this=this;setTimeout(function(){_this.close();},duration);}
$(this.element).append(this.$alert);this.$alert.slideDown(500);return this;};Alert.prototype.close=function(){var _this=this;this.$alert.slideUp(500,function(){_this.$alert.remove();_this=null;});};Alert.prototype.setMessage=function(msg){if(!msg){return false;}
this.$alert.find('.alert-msg').text(msg);};Alert.prototype.setStyle=function(style){if(style&&typeof style!=='string'){this.$alert.css(style);}
return this;};Alert.prototype.showAtTop=function(duration){this.setStyle({position:'absolute',top:0,left:0,right:0,margin:'auto',width:'30%',textAlign:'center',zIndex:10000});if(!duration){duration=2000;}
this.show(duration);};function showDialog(url){return WebAPI.get(url).done(function(resultHtml){$("#dialogContent").html(resultHtml);$('#dialogModal').modal({});});}
function clone(obj){if(obj==null||(typeof obj==='undefined'?'undefined':_typeof(obj))!='object')return obj;var temp=obj.constructor();for(var key in obj){if(obj.hasOwnProperty(key)){temp[key]=clone(obj[key]);}}
return temp;}
Date.prototype.format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};var week={"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}
if(/(E+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+week[this.getDay()+""]);}
for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));}}
return fmt;};Date.prototype.timeFormat=function(format,type,language,option){var date=this;if(format&&(typeof format=='string'||(typeof format==='undefined'?'undefined':_typeof(format))=='object')){if((typeof format==='undefined'?'undefined':_typeof(format))=='object'&&(!format.separators||!format.parts)){format='yyyy-mm-dd hh:ii:ss';}}else{format='yyyy-mm-dd hh:ii:ss';}
if(arguments.length>=2){var paramArr=function(arrayish){return[].slice.call(arrayish);}(arguments);paramArr.shift();type=language=option=null;paramArr.forEach(function(it,i){if(typeof it=='string'){language=it;}else if(typeof it=='number'){type=it;}else if((typeof it==='undefined'?'undefined':_typeof(it))=='object'){option=it;}});}
var isReturnNull=false;if(option){for(var k in option){if(k=='isReturnNull'){isReturnNull=option[k];}}}
if(date=='Invalid Date'){console.warn("Invalid date.");if(isReturnNull){return'';}else{return date.toString();}}
var DATES={en:{"days":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],"daysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],"daysMin":["Su","Mo","Tu","We","Th","Fr","Sa","Su"],"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"meridiem":["am","pm"]}};language=language?DATES[language]?language:'en':'en';var formatObj=function(formatStr){if((typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return formatStr;}
if(type){formatStr=timeFormatChange(formatStr,type);}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(format);var val={yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear(),m:date.getMonth()+1,M:DATES[language].monthsShort[date.getMonth()],MM:DATES[language].months[date.getMonth()],d:date.getDate(),D:DATES[language].daysShort[date.getDay()],DD:DATES[language].days[date.getDay()],p:DATES[language].meridiem.length==2?DATES[language].meridiem[date.getHours()<12?0:1]:'',h:date.getHours(),i:date.getMinutes(),s:date.getSeconds()};if(DATES[language].meridiem.length==2){val.H=val.h%12==0?12:val.h%12;}else{val.H=val.h;}
val.HH=(val.H<10?'0':'')+val.H;val.P=val.p.toUpperCase();val.hh=(val.h<10?'0':'')+val.h;val.ii=(val.i<10?'0':'')+val.i;val.ss=(val.s<10?'0':'')+val.s;val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;var finTime='';for(var i=0,len=formatObj.separators.length;i<len;i++){finTime+=formatObj.separators[i]+(formatObj.parts[i]?val[formatObj.parts[i]]:'');}
return finTime;};var DateUtil=function(){var dateLocale={month:{en:{month_names:['January','February','March','April','May','June','July','August','September','October','November','December'],month_names_short:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']},zh:{month_names:['','','','','','','','','','','',''],month_names_short:['','','','','','','','','','','','']}}};function getWeekNumber(d){d=new Date(+d);d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1);var weekNo=Math.ceil(((d-yearStart)/86400000+1)/7);return[d.getFullYear(),weekNo];}
function getLastWeekNumberOf(y,w){w-=1;if(w===0){y=y-1;w=52;}
return[y,w];}
function getNextWeekNumberOf(y,w){w+=1;if(w===53){y+=1;w=1;}
return[y,w];}
function isLeapYear(y){if(Object.prototype.toString.call(y)==='[object Date]'){y=y.getFullYear();}
return y%4===0&&y%100!==0||y%400===0;}
function daysInMonth(dt){var m=dt.getMonth();if(m===1){return isLeapYear(dt)?29:28;}
return[31,28,31,30,31,30,31,31,30,31,30,31][m];}
function getFirstDayOfWeek(year,week){var d=new Date(year,0,1),offset=d.getTimezoneOffset();d.setDate(d.getDate()+4-(d.getDay()||7));d.setTime(d.getTime()+7*24*60*60*1000*(week+(year==d.getFullYear()?-1:0)));d.setTime(d.getTime()+(d.getTimezoneOffset()-offset)*60*1000);d.setDate(d.getDate()-3);return d;}
function getDateRangeOnWeekNumber(year,week){if(!year||!week){return;}
var firstDay=getFirstDayOfWeek(year,week),lastDay=new Date(firstDay);lastDay.setDate(firstDay.getDate()+6);return[firstDay,lastDay];}
function getMonthName(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names:dateLocale.month['en'].month_names;return monthList[index];}
function getMonthNameShort(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names_short:dateLocale.month['en'].month_names_short;return monthList[index];}
function getLastMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===1){return 12;}else{return currentMonth-1;}}
function getNextMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===12){return 1;}else{return currentMonth+1;}}
function getRelativeDateInfo(date1,date2){var now=new Date();var lang=I18n.type;var value1,value2,ts,info;if(!date1&&!date2)return'';value1=(date1||now).valueOf();value2=(date2||now).valueOf();ts=Math.floor(Math.abs(value1-value2)/1000);switch(true){case ts<60:info=ts+(ts===1?' second':' seconds');break;case ts<3600:ts=Math.floor(ts/60);info=ts+(ts===1?' minute':' minutes');break;case ts<86400:ts=Math.floor(ts/3600);info=ts+(ts===1?' hour':' hours');break;case ts<31536000:ts=Math.floor(ts/86400);info=ts+(ts===1?' day':' days');break;default:ts=Math.floor(ts/31536000);info=ts+(ts===1?' year':' years');break;}
info+=value1>value2?' ago':' later';if(lang==='zh'){info=info.replace(/\s(seconds?|minutes?|hours?|days?|years?)\s(ago|later)$/,function($0,$1,$2){var rs='';if($1.indexOf('second')>-1)rs+='';if($1.indexOf('minute')>-1)rs+='';if($1.indexOf('hour')>-1)rs+='';if($1.indexOf('day')>-1)rs+='';if($1.indexOf('year')>-1)rs+='';if($2==='ago')rs+='';if($2==='later')rs+='';return rs;});}
return info;}
return{getWeekNumber:getWeekNumber,isLeapYear:isLeapYear,daysInMonth:daysInMonth,getLastWeekNumberOf:getLastWeekNumberOf,getNextWeekNumberOf:getNextWeekNumberOf,getDateRangeOnWeekNumber:getDateRangeOnWeekNumber,getFirstDayOfWeek:getFirstDayOfWeek,getMonthName:getMonthName,getMonthNameShort:getMonthNameShort,getLastMonth:getLastMonth,getNextMonth:getNextMonth,getRelativeDateInfo:getRelativeDateInfo,DATA_FORMAT:{FULL_DATETIME:'yyyy-mm-dd hh:ii:ss',FULL_DATETIME_CHANGE:'yyyy-MM-dd HH:mm:ss',FULL_DATETIME_ALL_SEC_CHANGE:'yyyy-MM-dd 00:00:00',FULL_DATETIME_ZERO_SEC_CHANGE:'yyyy-MM-dd HH:mm:00',FULL_DATETIME_NO_SEC_CHANGE:'yyyy-MM-dd HH:mm',FULL_DATETIME_ZERO_SEC:'yyyy-mm-dd hh:ii:00',FULL_DATETIME_HH_00_00:'yyyy-mm-dd hh:00:00',FULL_DATETIME_00_00_00:'yyyy-mm-dd 00:00:00',FULL_DATETIME_NO_SEC:'yyyy-mm-dd hh:ii',FULL_DATETIME_HH_00:'yyyy-mm-dd hh:00',FULL_DATETIME_00_00:'yyyy-mm-dd 00:00',FULL_DATE:'yyyy-mm-dd',TIME:'hh:ii:ss',TIME_HOUR_MINUTE:'hh:ii',TIME_ZERO_SEC:'hh:ii:00'}};}();var StringUtil=function(){var HTML_ENTITIES={'&':'&amp;','>':'&gt;','<':'&lt;','"':'&quot;',"'":'&#39;','`':'&#x60;'},HTML_ENTITIES_INVERT=invert(HTML_ENTITIES);function invert(obj){var result={},keys=Object.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;}
function padLeft(oldStr,padNum,padStr){if(!padStr){return oldStr;}
return new Array(padNum-String(oldStr).length+1).join(padStr)+oldStr;}
function htmlEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES[character];});}
function htmlUnEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES_INVERT).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES_INVERT[character];});}
var getI18nProjectName=function getI18nProjectName(project){if(!I18n||!project){return'';}
var result='';switch(I18n.type){case'en':{result=project.name_english;break;}
case'zh':{result=project.name_cn;break;}
default:{result=project.name_english;}}
return result||'';};return{padLeft:padLeft,htmlEscape:htmlEscape,htmlUnEscape:htmlUnEscape,getI18nProjectName:getI18nProjectName};}();var BEOPUtil=function(){var jsType={function:_typeof($.noop),number:_typeof(0),string:_typeof(''),undefined:typeof undefined==='undefined'?'undefined':_typeof(undefined)};var projectImgPath=beop.constant.project_img_path;var setRelativePosition=function setRelativePosition($obj,$target,topOffset,leftOffset){$target.css({"left":$obj.offset().left+$obj.width()+(leftOffset||5),"top":$obj.offset().top+(topOffset||10)});};var projectDefaultImgPath=projectImgPath+beop.constant.project_default_img;var getProjectImgPath=function getProjectImgPath(project){if(project){return project.pic?projectImgPath+project.pic:projectDefaultImgPath;}};var getProjectFromAppConfig=function getProjectFromAppConfig(projectId){for(var m=0,len=AppConfig.projectList.length;m<len;m++){if(AppConfig.projectList[m].id==projectId){return AppConfig.projectList[m];}}};function getFunctionName(func){if(!func||(typeof func==='undefined'?'undefined':_typeof(func))!=jsType.function){return'';}
var ret=func.toString();ret=ret.substr('function '.length);ret=ret.substr(0,ret.indexOf('('));return ret;}
function isUndefined(obj){return(typeof obj==='undefined'?'undefined':_typeof(obj))===jsType.undefined;}
function getCookie(name){var value="; "+document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)return parts.pop().split(";").shift();}
function logicContentHandle(content){if(content){content=content.replace(/\t/g,'    ');}
return content;}
function copyToClipboard(text,valueContainer){var valueContainer=valueContainer?valueContainer:document.body;if(window.clipboardData&&window.clipboardData.setData){return clipboardData.setData("Text",text);}else if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=text;textarea.style.position="fixed";valueContainer.appendChild(textarea);textarea.select();try{return document.execCommand("copy");}catch(ex){console.warn("Copy to clipboard failed.",ex);return false;}finally{valueContainer.removeChild(textarea);}}}
var projectImgType={logo:'logo.png',pdfCover:'pdf_cover.jpg'};function getProjectImgByType(projectId,name,extension){var img='';if(projectId){img+=projectId+'_';}
img+=name;if(extension){img+='.'+extension;}
return beop.constant.BEOP_IMG_HOST+beop.constant.OSS_PROJECT_IMG_PATH+img;}
function getProjectById(id){if(!id||!AppConfig.projectList){return null;}
for(var i=0;i<AppConfig.projectList.length;i++){var project=AppConfig.projectList[i];if(project.id==id){return project;}}
return null;}
return{setRelativePosition:setRelativePosition,getProjectImgPath:getProjectImgPath,getFunctionName:getFunctionName,isUndefined:isUndefined,getCookie:getCookie,getProjectFromAppConfig:getProjectFromAppConfig,logicContentHandle:logicContentHandle,copyToClipboard:copyToClipboard,getProjectImgByType:getProjectImgByType,getProjectById:getProjectById,projectImgType:projectImgType};}();(function(){var beop_tmpl_cache={};this.beopTmpl=function tmpl(str,data,htmlStr){var fn=!/\W/.test(str)?beop_tmpl_cache[str]=beop_tmpl_cache[str]||tmpl(htmlStr?htmlStr:document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split(/<!/).join("\t").replace(/((^|!>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)!>/g,"',$1,'").split("\t").join("');").split(/!>/).join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn;};})();var SidebarMenuEffect=function(){function SidebarMenuEffect(){}
SidebarMenuEffect.prototype.init=function(center,left,right){var _this=this;this.$paneCt=$(center);this.$leftBtn=$(center).find('#leftCt');this.$rightBtn=$(center).find('#rightCt');var container=document.getElementById('st-container'),buttons=Array.prototype.slice.call(document.querySelectorAll('.sideTrans')),refresh=function refresh(){var leftCol=0,rightCol=0,centerCol=0;var leftArrow='<span class="glyphicon glyphicon-chevron-left"></span>';var rightArrow='<span class="glyphicon glyphicon-chevron-right"></span>';if(_this.$leftBtn.length>0){if(container.className.indexOf('st-effect-7')>0){var prev=_this.$paneCt.prev('div')[0];if(prev&&prev.className.indexOf('col-')>-1){leftCol=parseInt(prev.classList[0].split('-')[2]);}else{leftCol=0;}
_this.$leftBtn.removeClass('leftCtClose').addClass('leftCtOpen').html(leftArrow);}else{leftCol=0;_this.$leftBtn.removeClass('leftCtOpen').addClass('leftCtClose').html(rightArrow);}}
if(_this.$rightBtn.length>0){if(container.className.indexOf('st-effect-1')>0){var next=_this.$paneCt.next('div')[0];if(next&&next.className.indexOf('col-')>-1){rightCol=parseInt(next.classList[0].split('-')[2]);}else{rightCol=0;}
_this.$rightBtn.removeClass('rightCtClose').addClass('rightCtOpen').html(rightArrow);}else{rightCol=0;_this.$rightBtn.removeClass('rightCtOpen').addClass('rightCtClose').html(leftArrow);}}
centerCol=12-leftCol-rightCol;_this.$paneCt.removeClass().addClass('col-sm-'+centerCol+' st-content');};buttons.forEach(function(el,i){var effect=el.getAttribute('data-effect');el.addEventListener('click',function(ev){var target=ev.target.getAttribute('data-effect')!=null?ev.target.getAttribute('data-effect'):ev.target.parentNode.getAttribute('data-effect');var stCtClass=document.getElementById('st-container').className;if(stCtClass.indexOf(target)<0){ev.stopPropagation();ev.preventDefault();container.classList.add(effect);setTimeout(function(){if($(container.children[0]).children('div').length==3){container.classList.add('st-menu-open');}
refresh();},250);}else{container.classList.remove(target);refresh();}});});};return SidebarMenuEffect;}();(function(window){{var unknown='-';var screenSize='';if(screen.width){var width=screen.width?screen.width:'';var height=screen.height?screen.height:'';screenSize+=''+width+" x "+height;}
var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browser=navigator.appName;var version=''+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=nAgt.indexOf('Opera'))!=-1){browser='Opera';version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('MSIE'))!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(verOffset+5);}
else if((verOffset=nAgt.indexOf('Chrome'))!=-1){browser='Chrome';version=nAgt.substring(verOffset+7);}
else if((verOffset=nAgt.indexOf('Safari'))!=-1){browser='Safari';version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('Firefox'))!=-1){browser='Firefox';version=nAgt.substring(verOffset+8);}
else if(nAgt.indexOf('Trident/')!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(nAgt.indexOf('rv:')+3);}
else if((nameOffset=nAgt.lastIndexOf(' ')+1)<(verOffset=nAgt.lastIndexOf('/'))){browser=nAgt.substring(nameOffset,verOffset);version=nAgt.substring(verOffset+1);if(browser.toLowerCase()==browser.toUpperCase()){browser=navigator.appName;}}
if((ix=version.indexOf(';'))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(' '))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(')'))!=-1)version=version.substring(0,ix);majorVersion=parseInt(''+version,10);if(isNaN(majorVersion)){version=''+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10);}
var mobile=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=='undefined'&&!cookieEnabled){document.cookie='testcookie';cookieEnabled=document.cookie.indexOf('testcookie')!=-1?true:false;}
var os=unknown;var clientStrings=[{s:'Windows 3.11',r:/Win16/},{s:'Windows 95',r:/(Windows 95|Win95|Windows_95)/},{s:'Windows ME',r:/(Win 9x 4.90|Windows ME)/},{s:'Windows 98',r:/(Windows 98|Win98)/},{s:'Windows CE',r:/Windows CE/},{s:'Windows 2000',r:/(Windows NT 5.0|Windows 2000)/},{s:'Windows XP',r:/(Windows NT 5.1|Windows XP)/},{s:'Windows Server 2003',r:/Windows NT 5.2/},{s:'Windows Vista',r:/Windows NT 6.0/},{s:'Windows 7',r:/(Windows 7|Windows NT 6.1)/},{s:'Windows 8.1',r:/(Windows 8.1|Windows NT 6.3)/},{s:'Windows 8',r:/(Windows 8|Windows NT 6.2)/},{s:'Windows NT 4.0',r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:'Windows ME',r:/Windows ME/},{s:'Android',r:/Android/},{s:'Open BSD',r:/OpenBSD/},{s:'Sun OS',r:/SunOS/},{s:'Linux',r:/(Linux|X11)/},{s:'iOS',r:/(iPhone|iPad|iPod)/},{s:'Mac OS X',r:/Mac OS X/},{s:'Mac OS',r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:'QNX',r:/QNX/},{s:'UNIX',r:/UNIX/},{s:'BeOS',r:/BeOS/},{s:'OS/2',r:/OS\/2/},{s:'Search Bot',r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var id in clientStrings){var cs=clientStrings[id];if(cs.r.test(nAgt)){os=cs.s;break;}}
var osVersion=unknown;if(/Windows/.test(os)){osVersion=/Windows (.*)/.exec(os)[1];os='Windows';}
switch(os){case'Mac OS X':osVersion=/Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];break;case'Android':osVersion=/Android ([\.\_\d]+)/.exec(nAgt)[1];break;case'iOS':osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);osVersion=osVersion[1]+'.'+osVersion[2]+'.'+(osVersion[3]|0);break;}}
window.jscd={screen:screenSize,browser:browser,browserVersion:version,mobile:mobile,os:os,osVersion:osVersion,cookies:cookieEnabled};})(this);var getUrlParams=function getUrlParams(){var search=window.location.search.substring(1);var kvArr=search.split('&');var rs={};kvArr.forEach(function(kv){var arr=kv.split('=');if(typeof arr[1]!=='undefined'){rs[arr[0]]=arr[1];}});return rs;};$.fn.serializeObject=function(){var obj={};this.serializeArray().map(function(item){if(/\[\]$/.test(item.name)){if(obj[item.name]){obj[item.name].push(item.value);}else{obj[item.name]=[item.value];}}else{obj[item.name]=item.value;}});return obj;};function kIntSeparate(num,n){var number=num.toFixed(n?n:0);var source=String(number).split(".");source[0]=source[0].replace(new RegExp('(\\d)(?=(\\d{3})+$)','ig'),"$1,");return source.join(".");}
function timeFormatChange(format,type){var lastStr='';var formatObj=function(formatStr){if(!formatStr||(typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return;}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){return;}
return{separators:separators,parts:parts};}(format);if(formatObj){format='';for(var i=0,len=formatObj.separators.length-1;i<len;i++){format+=formatObj.separators[i]+formatObj.parts[i];}
lastStr=formatObj.separators[len];}
var formatArr=['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'];var formatChangeArr=[['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'],['M d, yyyy hh:ii:ss','M d, yyyy hh:ii','M d, yyyy hh','M d, yyyy','M, yyyy','M d hh:ii:ss','M d hh:ii','M d hh','M d'],['dd/mm/yyyy hh:ii:ss','dd/mm/yyyy hh:ii','dd/mm/yyyy hh','dd/mm/yyyy','mm/yyyy','dd/mm hh:ii:ss','dd/mm hh:ii','dd/mm hh','dd/mm']];if(formatArr.findIndex){var index=formatArr.findIndex(function(v){return v===format;});}else{for(var i=0;i<formatArr.length;i++){if(formatArr[i]===format){var index=i;break;}}}
type=Number(type);type&&type>=formatChangeArr.length&&(type=formatChangeArr.length-1);if(index==-1){console.log('format is not defined');return format+lastStr;}else{if(type===0){return formatChangeArr[0][index]+lastStr;}
return formatChangeArr[type||AppConfig.projectTimeFormat||0][index]+lastStr;}}
function timeFormat(time,format,language,option){var date,arr,arr2;var sort=function sort(year,month,day,time){year=year==undefined?'2001':year;month=month==undefined?'01':month;day=day==undefined?'01':day;time=time==undefined?'':' '+time;return new Date(year+'/'+month+'/'+day+time);};if(time instanceof Date){date=time;}else if(typeof time=='string'){if(/^\d{1,2}-\d{1,2}/.test(time)){arr=time.split(' ');arr2=arr[0].split('-');time=arr2[1]+'-'+arr2[0]+(arr2[2]==undefined?'':'-'+arr2[2])+(arr[1]==undefined?'':' '+arr[1]);}
time=time.replace(/-/g,"/");arr=time.split(' ');arr2=arr[0].split('/');if(/^\d{4}/.test(time)){date=sort(arr2[0],arr2[1],arr2[2],arr[1]);}else if(/^\d{1,2}\/\d{4}/.test(time)){date=sort(arr2[1],arr2[0],'01',arr[1]);}else if(/^\d{1,2}\/\d{1,2}/.test(time)){date=sort(arr2[2],arr2[1],arr2[0],arr[1]);}else{date=new Date(time);}}else{date=new Date(time);}
return date.timeFormat(format,language,option);}
(function(exports){var MINITE_1=60000;var MINITE_5=300000;var HOUR_1=3600000;var DAY_1=86400000;var DAY_365=31536000000;function _formatTimeStr(str,format){var arr=str.split(' ');var date=arr[0].split('-');var time=arr[1].split(':');return format.replace('yyyy',date[0]).replace('MM',date[1]).replace('dd',date[2]).replace('HH',time[0]).replace('mm',time[1]).replace('ss',time[2]);}
function _explainPattern(timeShaft){var startTime=new Date(timeShaft[0]);var endTime=new Date(timeShaft[timeShaft.length-1]);var timeRange=endTime.valueOf()-startTime.valueOf();var timeInterval=timeRange/(timeShaft.length-1);var pattern='MM-dd HH:mm';if(timeInterval<=MINITE_5){if(timeRange<=HOUR_1){pattern='HH:mm';}else if(timeRange<=DAY_1){pattern='HH:mm';}}
else if(timeInterval<=HOUR_1){if(timeRange<=DAY_1){pattern='HH:mm';}else{pattern='MM-dd HH:mm';}}
else if(timeInterval<=DAY_1){if(timeRange<=DAY_365){pattern='MM-dd';}else{pattern='yyyy-MM-dd';}}
else{pattern='yyyy-MM';}
return pattern;}
function _explain(timeShaft){pattern=getPattern(timeShaft);if(pattern){timeShaft=timeShaft.map(function(row){return _formatTimeStr(row,pattern);});}
return timeShaft;}
function _valid(params){var flag=Object.prototype.toString.call(params)==='[object Array]';return flag&&/^[\d-]{10} [\d:]{8}$/.test(params[0]);}
var _getTimePattern=function _getTimePattern(timeShaft){if(!_valid(timeShaft)){return;}
if(timeShaft.length<=1){return;}
return _explainPattern(timeShaft);};var formatTimeShaft=exports.formatTimeShaft=function(timeShaft){if(!_valid(timeShaft)){console.warn('function arguments is not a valid time shaft array!');return timeShaft;}
if(timeShaft.length<=1){return timeShaft;}
return _explain(timeShaft);};function _formatTimeStrByAppConfig(data){var formatArr,formatStr,regularArr,language,formatObj;switch(AppConfig.projectTimeFormat||0){case 0:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';break;case 1:formatArr=['M d, yyyy','M d hh:ii','M, yyyy','M, yyyy','M d'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;case 2:formatArr=['dd/mm/yyyy','dd/mm hh:ii','mm/yyyy','mm/yyyy','dd/mm'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;default:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';}
for(var i=0,len=regularArr.length;i<len;i++){if(regularArr[i].test(data)){formatStr=formatArr[i];break;}}
if(formatStr){formatObj=function _parseFormat(formatStr){var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(formatStr);return{formatStr:formatStr,language:language,formatObj:formatObj};}else{return;}}
if(window.echarts){echarts.registerPreprocessor(function(option){var pattern;var formatInfo,firstValue;if(option.formatTime===false){pattern=_getTimePattern(option.xAxis[0].data);echarts.formatTimePattern=pattern;return;}
if(option.xAxis&&option.xAxis.length){option.xAxis.forEach(function(row){if(row.data&&row.data.length){pattern=_getTimePattern(row.data);formatInfo=_formatTimeStrByAppConfig(row.data[0]);if(pattern){row.data=row.data.map(function(row){return row.substr(0,16);});firstValue=_formatTimeStr(row.data[0],pattern);formatInfo=_formatTimeStrByAppConfig(firstValue);if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}else{row.data=row.data.map(function(it,i){return _formatTimeStr(it,pattern);});}}else if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}}});}});}})(window);var generateTimeOption=function generateTimeOption(option){var timeConfig=clone(option);!timeConfig.timeStart&&(timeConfig.timeStart=timeConfig.startTime);!timeConfig.timeEnd&&(timeConfig.timeEnd=timeConfig.endTime);!timeConfig.timeFormat&&(timeConfig.timeFormat=timeConfig.format);var recentTime={};var now=new Date();if(typeof option=='string'){recentTime=generateRecentTime(option);}else if(option&&option.timeRecent){if(typeof option.timeRecent=='string'){recentTime=generateRecentTime(option.timeRecent);}else if(option.timeRecent.hasOwnProperty('unit')&&option.timeRecent.hasOwnProperty('val')){recentTime=generateRecentTimeCustom(option.timeRecent);}}
if(recentTime&&Object.keys(recentTime).length>0){timeConfig.timeStart=recentTime.timeStart;timeConfig.timeEnd=recentTime.timeEnd;if(recentTime.format){timeConfig.timeFormat=recentTime.format;}
switch(timeConfig.timeFormat){case'h1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd HH:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd HH:00:00');break;case'd1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd 00:00:00');break;case'M1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-01 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-01 00:00:00');break;}}
timeConfig.startTime=timeConfig.timeStart;timeConfig.endTime=timeConfig.timeEnd;timeConfig.format=timeConfig.timeFormat;return timeConfig;function generateRecentTime(time){var startTime,endTime,format;switch(time){case'today':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-86400000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'threeDay':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-259200000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'yesterday':endTime=new Date(new Date().setDate(now.getDate()-1)).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(new Date().setDate(now.getDate()-2)).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'thisWeek':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now-604800000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'lastWeek':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'thisYear':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='M1';break;}
return{timeStart:startTime,timeEnd:endTime,format:format};}
function generateRecentTimeCustom(time){var startTime,endTime,format;switch(time.unit){case'hour':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-3600000*time.val).format('yyyy-MM-dd HH:mm:ss');break;case'day':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-86400000*time.val).format('yyyy-MM-dd HH:00:00');break;case'month':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-2592000000*time.val).format('yyyy-MM-dd HH:00:00');break;}
return{timeStart:startTime,timeEnd:endTime};}};var WebAPI=function(){var siteId;switch(window.location.hostname){case'beop.rnbtech.com.hk':siteId='b79c068f77198848e22fe79758836e53';break;case'beop6.rnbtech.com.hk':siteId='f1f6b2b9e6b64592c0b4cb5e9b8bd79e';break;case'beopdemo.rnbtech.com.hk':siteId='ac0df98f274d9a5980a571297248d80b';break;default:break;}
(function(){if(siteId){var hm=document.createElement("script");hm.src="//hm.baidu.com/hm.js?"+siteId;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);}})();var mockList={'/static/mock/analysis_workspace_saveLayout.json':/\/analysis\/workspace\/saveLayout\/\d+\/[01]/i,'/static/mock/analysis_template_get.json':/\/analysis\/template\/get\/\d+/i};function mock(url){var match=null;for(var i in mockList){match=url.match(mockList[i]);if(match!==null)return i;}
return url;}
function requestFailHandle(result){if(result&&result.status==401){alert(i18n_resource.error.noPermission);}}
function WebAPI(){}
WebAPI.isMock=false;$.ajaxSetup({converters:{"text json":true},dataFilter:function dataFilter(result,type){var data=result;if(type==='script'){return data;}else if(typeof data==='string'){if(/^\s*</.test(data)){return data;}
try{data=JSON.parse(result);}catch(e){console.log('request error: '+e+', the data is :'+data);return data;}}
if(data){if(data.error){switch(data.error){case'token_invalid':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');if(typeof LoginValidate!='undefined'){var validate=new LoginValidate();validate.show();return;}
confirm(i18n_resource.error.token[data.msg]+'. '+i18n_resource.error.relogin+'.',function(){if(AppConfig.isMobile){location.reload();}else{location.href='/';}});break;}
case'historyData':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');alert(data.msg);return{};}
default:break;}}
if(data.code==403){console.log(this.url+' ('+data.msg+'")');alert(I18n.resource.error.noPermission);return{};}}
return data;}});WebAPI.post=function(url,data,isMock){var mockUrl;isMock=isMock===undefined?WebAPI.isMock:isMock;if(isMock){mockUrl=mock(url);if(url!==mockUrl)return this.get(mockUrl,false);}
if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'POST',data:JSON.stringify(data),contentType:'application/json'}).fail(requestFailHandle);};WebAPI.get=function(url,isMock){isMock=isMock===undefined?WebAPI.isMock:isMock;url=isMock?mock(url):url;if(window._hmt&&url.indexOf('.html')>0)window._hmt.push(['_trackPageview',url]);if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'Get',contentType:'application/json'}).fail(requestFailHandle);};WebAPI.getHistoryDS=function(callback){};WebAPI.getHistory=function(callback){};return WebAPI;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var EventAdapter=function(){var eventData,eventStatus;function EventAdapter($){}
EventAdapter.on=function(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<3||arguments.length>5){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(arguments[0])!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}}
if(typeof arguments[1]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[1];}
if(typeof arguments[2]=='function'){eventFunction=arguments[2];eventSelector=null;eventHmt=arguments[3];}else if(typeof arguments[2]=='string'){if(arguments[3]&&typeof arguments[3]=='function'){eventSelector=arguments[2];eventFunction=arguments[3];eventHmt=arguments[4];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':eventTarget.on('touchstart',eventSelector,function(e){mobileDragStart.call(this,e,eventTarget,finalFunction);});break;case'dragover':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragOver.call(this,e,eventTarget,finalFunction);});break;case'dragleave':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragLeave.call(this,e,eventTarget,finalFunction);});break;case'drop':$(document).on('touchend.drop',eventSelector,function(e){mobileDrop.call(this,e,eventTarget,finalFunction);});break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;};EventAdapter.off=function(){if(arguments.length>3||arguments.length<1||arguments[0]&&typeof arguments[1]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}
if(arguments.length==1){eventTarget.off();return eventTarget;}
if(typeof arguments[1]=='string'){eventType=arguments[1];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[2]=='string'){eventSelector=arguments[2];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;};$.fn.extend({'eventOn':function eventOn(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<2||arguments.length>4){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(this)!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(this instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=this;}}
if(typeof arguments[0]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[0];}
if(typeof arguments[1]=='function'){eventFunction=arguments[1];eventSelector=null;eventHmt=arguments[2];}else if(typeof arguments[1]=='string'){if(arguments[2]&&typeof arguments[2]=='function'){eventSelector=arguments[1];eventFunction=arguments[2];eventHmt=arguments[3];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':mobileDragStart(eventTarget,eventSelector,finalFunction);break;case'dragover':mobileDragOver(eventTarget,eventSelector,finalFunction);break;case'dragleave':mobileDragLeave(eventTarget,eventSelector,finalFunction);break;case'drop':mobileDrop(eventTarget,eventSelector,finalFunction);break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;},'eventOff':function eventOff(){if(arguments.length>2||arguments[0]&&typeof arguments[0]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(this instanceof jQuery)){eventTarget=jQuery(this);}else{eventTarget=this;}
if(arguments.length==0){eventTarget.off();return eventTarget;}
if(typeof arguments[0]=='string'){eventType=arguments[0];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[1]=='string'){eventSelector=arguments[1];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector,mobileDragStart);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;}});EventAdapter.setData=function(date){if(date==undefined)return;eventData=date;};EventAdapter.getData=function(){return eventData;};document.addEventListener('drop',function(){eventData=null;},false);document.addEventListener('touchend',function(){eventData=null;},false);EventAdapter.clearEvent=function(){$(document).off('touchmove.copy');$(document).off('touchmove.drag');$(document).off('touchend.drop');};EventAdapter.analyse=function(e,eventType,hmtInfo){var mainInfo='',initArrTag,finalArrTag,tag,unitTag;var target=$(e.currentTarget);if(hmtInfo instanceof Array&&hmtInfo[0]){mainInfo=judgeWay(hmtInfo[0]);initArrTag=hmtInfo.filter(function(ele,index){return index>0&&ele!='';});finalArrTag=[];for(var i=0;i<initArrTag.length;i++){unitTag=judgeWay(initArrTag[i]);if(unitTag=='')continue;finalArrTag.push(unitTag);}
tag=finalArrTag.join('-');}else{if(hmtInfo!=undefined){mainInfo=judgeWay(hmtInfo);}else{mainInfo=getInfo(target);}
mainInfo=mainInfo?mainInfo:'';tag=mainInfo;}
_hmt.push(['_trackEvent',mainInfo.substr(0,30),eventType,'user-'+(AppConfig.userId?AppConfig.userId:0)+'/project-'+(AppConfig.projectId?AppConfig.projectId:0)]);function getInfo(tar){if(tar.length==0)return;var tarInfo;if(tar.attr('id')){tarInfo=tar.attr('id');}else if(tar.attr('i18n')){tarInfo=tar.attr('i18n');}else if(tar.attr('title')){tarInfo=tar.attr('title');}else{tarInfo=tar[0].innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}
return tarInfo;}
function judgeWay(arg){if(typeof arg=='undefined'){return'';}
if(arg instanceof Function){return arg.call(this,e);}else if(typeof arg=='string'){if(arg=='text'){return e.currentTarget.innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}else{return $(e.currentTarget).attr(arg)?$(e.currentTarget).attr(arg):arg;}}else if(typeof arg=='number'){return arg;}}};var mobileDragStart=function mobileDragStart(e,target,eventFunction){var originalTarget=$(e.target).closest('[draggable="true"]')[0];var ev=e.type=='touchstart'?e.originalEvent.touches[0]:e,startPos={left:$(originalTarget).css('left'),top:$(originalTarget).css('top'),zIndex:$(originalTarget).css('z-index')},disX=originalTarget.offsetWidth/2,disY=originalTarget.offsetHeight/2;var $copyTarget=$(originalTarget).clone();$copyTarget.data('startPos',startPos);$copyTarget.css('z-index',10000);$copyTarget.css('position','absolute');$copyTarget.css('opacity','0.5');$copyTarget.css('pointer-events','none');var $container=$('body');$container.append($copyTarget);var sPos=$(originalTarget)[0].getBoundingClientRect();$copyTarget.css('left',sPos.left-$container[0].offsetLeft+'px');$copyTarget.css('top',sPos.top-$container[0].offsetTop+'px');$copyTarget[0].cssText=originalTarget.cssText;$copyTarget.css('width',originalTarget.offsetWidth);$copyTarget.css('height',originalTarget.offsetHeight);eventStatus='dragStart';eventFunction.call(this,ev);$(document).off('touchend.copy').on('touchend.copy',function(e){$copyTarget.remove();eventStatus='dragEnd';});$(document).on('touchmove.copy',function(e){eventStatus='dragMove';var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var $parent=$copyTarget.offsetParent();$parent=$parent.is(':root')?$(window):$parent;var targetLeft=ev.pageX-disX;var targetTop=ev.pageY-disY;$copyTarget.css({left:targetLeft+'px',top:targetTop+'px','z-index':10000});});};var mobileDragOver=function mobileDragOver(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn'&&eventStatus!='dragMoveOut')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveIn';eventFunction.call(this,e);break;}}};var mobileDragLeave=function mobileDragLeave(e,target,eventFunction){if(eventStatus!='dragMoveIn')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(!(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY)){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveOut';eventFunction.call(this,e);}}};var mobileDragEnd=function mobileDragEnd(e,target,eventFunction){eventFunction.call(this,e);};var mobileDrop=function mobileDrop(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn')return;var ev=e.type=='touchend'?e.originalEvent.changedTouches[0]:e;var eventTarget=target;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventFunction.call(this,e);break;}}};return EventAdapter;}(jQuery);var theme={};theme.Dark={backgroundColor:'transport',color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500'],title:{textStyle:{fontWeight:'normal',color:'#fff'}},legend:{textStyle:{color:'#999999'},top:30},visualMap:{itemWidth:15,color:['#FFF808','#21BCF9'],textStyle:{color:'#ccc'}},toolbox:{showTitle:false},tooltip:{trigger:'axis',backgroundColor:'rgba(250,250,250,0.9)',axisPointer:{type:'line',lineStyle:{color:'#aaa'},crossStyle:{color:'#aaa'},shadowStyle:{color:'rgba(200,200,200,0.2)'}},textStyle:{color:'#333'},extraCssText:'text-align: left;'},dataZoom:{dataBackgroundColor:'#555',fillerColor:'rgba(200,200,200,0.2)',handleColor:'#eee'},grid:{borderWidth:0,left:80,bottom:40,right:80,top:80},valueAxis:{axisLine:{show:false},axisTick:{show:false},axisLabel:{textStyle:{color:'#a2adbc'},margin:10},splitLine:{lineStyle:{color:['#4e5d77'],type:"solid",opacity:'0.6'}},nameTextStyle:{color:'#999999'}},categoryAxis:{axisLine:{lineStyle:{color:'#4e5d77'}},axisTick:{show:false},axisLabel:{textStyle:{color:'#a2adbc'},margin:10},splitLine:{show:false},nameTextStyle:{color:'#999999'}},textStyle:{fontFamily:'Microsoft YaHei, Arial, Verdana, sans-serif'},polar:{name:{textStyle:{color:'#ccc'}},axisLine:{lineStyle:{color:'#ddd'}},splitArea:{show:true,areaStyle:{color:['rgba(250,250,250,0.2)','rgba(200,200,200,0.2)']}},splitLine:{lineStyle:{color:'#ddd'}}},timeline:{label:{textStyle:{color:'#ccc'}},lineStyle:{color:'#aaa'},controlStyle:{normal:{color:'#fff'},emphasis:{color:'#FE8463'}},symbolSize:3},line:{smooth:true},pie:{type:'pie',radius:['50%','70%'],labelLine:{normal:{show:true,lineStyle:{width:[2]}}},hoverAnimation:false},gauge:{center:['50%','70%'],itemStyle:{normal:{color:['#d7603f']}},detail:{offsetCenter:['0','20%'],textStyle:{color:'#ccc'}},radius:'105%',data:[{value:50,name:''}],startAngle:180,endAngle:0,axisLine:{show:true,lineStyle:{color:[[0.25,'#04A0D6'],[0.5,'#689C0F'],[0.75,'#FEC500'],[1,'#109d83']],width:5}},axisTick:{length:35,lineStyle:{color:'auto',width:3}},axisLabel:{textStyle:{color:'#a2adbc'}},splitLine:{length:45,lineStyle:{width:4,color:'auto'}}}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var ConfigModal=function(){function ConfigModal(opt,modal){_classCallCheck(this,ConfigModal);this.modal=modal instanceof jQuery?modal[0]:modal;this.modalContent=undefined;this.modalBody=undefined;this.modalStyle=undefined;this.opt=$.extend(true,{},opt);this.initOpt=$.extend(true,{},opt);this.mapWidget=[];this.mapWidgetCls={};this.mapModuleCls={};this.store={};}
ConfigModal.prototype.setOption=function setOption(){var opt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.opt=$.extend(true,{},opt);this.initOpt=$.extend(true,{},opt);return this;};ConfigModal.prototype.init=function init(){this.destroy();this.initContainer();this.initClassMap();this.initModule();this.initResult();this.initWidgetMap();this.initWidgetByJSON();this.attachEvent();return this;};ConfigModal.prototype.initContainer=function initContainer(){if(!this.modal||!$(this.modal).hasClass('cfgModal')){var container=this.modal;this.modal=$('body>.cfgModal')[0];if(!this.modal){this.modal=document.createElement('div');this.modal.className='modal fade cfgModal';this.modal.innerHTML='\
                    <div class="modal-dialog">\
                        <style class="modal-style"></style>\
                        <div class="modal-content">\
                            <div class="modal-body"></div>\
                        </div>\
                    </div>\
                ';container?container.appendChild(this.modal):document.getElementsByTagName('body')[0].appendChild(this.modal);}}
var modalDialog=this.modal.querySelector('.modal-dialog');this.modalContent=this.modal.querySelector('.modal-content');this.modalStyle=this.modal.querySelector('.modal-style');if(!this.modalContent){this.modalContent=document.createElement('div');this.modalContent.className='modal-content';this.modalContent.innerHTML='<div class="modal-body"></div>';if(!modalDialog){modalDialog=document.createElement('div');modalDialog.className='modal-dialog';this.modal.appendChild(modalDialog);}
modalDialog.appendChild(this.modalContent);}
this.modalBody=this.modal.querySelector('.modal-body');this.modalBody.style.height=window.innerHeight*0.5+'px';this.clearDom();if(this.opt.header)this.modalContent.insertBefore(this.initModalHeader(),this.modalBody);};ConfigModal.prototype.initModalHeader=function initModalHeader(){if(!this.opt.header)return;var divHeader=document.createElement('div');divHeader.className='modal-header';if(this.opt.header.needBtnClose!==false){var btnClose=document.createElement('button');btnClose.className='close';btnClose.setAttribute('type','button');btnClose.dataset.dismiss='modal';btnClose.setAttribute('aria-label','close');btnClose.innerHTML='<span aria-hidden="true">&times;</span>';divHeader.appendChild(btnClose);}
if(this.opt.header.title){var divTitle=document.createElement('h4');divTitle.className='modal-title';divTitle.textContent=this.opt.header.title;divHeader.appendChild(divTitle);}
return divHeader;};ConfigModal.prototype.searChWidget=function searChWidget(){var widgetDom=this.modal.querySelectorAll('.cfgWidget');var type,arrWidgetDom;for(var i=0;i<widgetDom.length;i++){type=widgetDom.getAttribute('type');if(type){arrWidgetDom=this.mapWidget.get(type);arrWidgetDom instanceof Array?this.mapWidget.set(type,[widgetDom]):arrWidgetDom.push(widgetDom);}}};ConfigModal.prototype.initWidgetByDom=function initWidgetByDom(){var _this2=this;this.mapWidget.forEach(function(val,key){var widgetCls=_this2.mapWidgetCls(key);new widgetCls(_this2,val).init();});};ConfigModal.prototype.setModalData=function setModalData(data){this.opt.data=data;};ConfigModal.prototype.show=function show(){$(this.modal).modal('show');return this;};ConfigModal.prototype.hide=function hide(){$(this.modal).modal('hide');return this;};ConfigModal.prototype.attachEvent=function attachEvent(){var _this3=this;var $modal=$(this.modal);if(this.opt&&this.opt.event){if(typeof this.opt.event.beforeShow=='function'){$modal.off('show.bs.modal').on('show.bs.modal',function(e){_this3.opt.event.beforeShow();});}
if(typeof this.opt.event.afterShow=='function'){$modal.off('shown.bs.modal').on('shown.bs.modal',function(e){_this3.opt.event.afterShow();});}
if(typeof this.opt.event.beforeHide=='function'){$modal.off('hide.bs.modal').on('hide.bs.modal',function(e){_this3.opt.event.beforeHide();});}
if(typeof this.opt.event.afterHide=='function'){$modal.off('hidden.bs.modal').on('hidden.bs.modal',function(e){_this3.opt.event.afterHide();});}else{$modal.off('hidden.bs.modal').on('hidden.bs.modal',function(e){});}}};ConfigModal.prototype.initWidgetMap=function initWidgetMap(){var _this4=this;if(!(this.opt.area instanceof Array))this.opt.area=[];this.mapWidget=[];this.opt.area.forEach(function(val,index){if(!(val.widget instanceof Array))return;if(!val.dom){val.dom=document.createElement('div');val.dom.className='cfgArea div'+_this4.upperCaseText(val.name?val.name:val.type,0);val.dom.setAttribute('type',val.type);val.id=ObjectId();if(val.type=='footer'){val.dom.className+=' modal-footer';_this4.modalContent.appendChild(val.dom);}else{val.dom.className+=' row';_this4.modalBody.appendChild(val.dom);}}
for(var i=0;i<val.widget.length;i++){val.widget[i].cls=_this4.mapWidgetCls[val.widget[i].type];if(!val.widget[i].cls)continue;if(!val.widget[i].opt)val.widget[i].opt={};val.widget[i].instantiation=new val.widget[i].cls(_this4,val.widget[i],val);}
_this4.mapWidget.push(val);});};ConfigModal.prototype.initClassMap=function initClassMap(){this.mapWidgetCls={select:SelectOption,interval:IntervalOption,refreshInterval:RefreshIntervalOption,recentTime:RecentTimeOption,recentTimeCustom:recentTimeCustomOption,mode:ModeOption,date:DateOption,range:RangeOption,text:TextOption,color:InputColorOption,checkbox:CheckBoxOption,linkSelect:LinkOption,datasource:DataSourceData,dataInfoList:DataInfoListData,multiDataConfig:MultiDataConfigData,confirm:ConfirmFooter,cancel:CancelFooter};this.mapModuleCls={timeConfig:TimeConfigModule,dsDrag:DataSourceDragModule,dataInfoList:DataInfoListModule,multiDataConfig:MultiDataConfigModule,realTime:RealTimeConfigModule,gauge:GaugeConfigModule,factoryTplFooter:FactoryTplFooterModule,colorConfig:ColorConfigModule};};ConfigModal.prototype.initModule=function initModule(){var _this5=this;if(!(this.opt.area instanceof Array))this.opt.area=[];this.opt.area.forEach(function(val,index){if(!val.module||!_this5.mapModuleCls[val.module])return;val.cls=_this5.mapModuleCls[val.module];val.instantiation=new val.cls(_this5,val);val.instantiation.init();});};ConfigModal.prototype.initWidgetByJSON=function initWidgetByJSON(){this.mapWidget.forEach(function(val){if(val.widget instanceof Array){for(var i=0;i<val.widget.length;i++){val.widget[i].instantiation.init();}}});this.mapWidget.forEach(function(val){if(val.widget instanceof Array){for(var i=0;i<val.widget.length;i++){val.widget[i].instantiation.setSubWidget();}}});};ConfigModal.prototype.initResult=function initResult(){if(!this.opt.result)return;if(typeof this.opt.result.func=='function'){var areaFooter,widgetConfirm;for(var i=this.opt.area.length-1;i>=0;i--){if(!this.opt.area[i].widget)continue;for(var j=0;j<this.opt.area[i].widget.length;j++){if(this.opt.area[i].widget[j].type=='confirm')widgetConfirm=this.opt.area[i].widget[j];break;}
if(widgetConfirm){areaFooter=this.opt.area[i];break;}}
var _this=this;if(!widgetConfirm){widgetConfirm={type:'confirm',func:function func(e){_this.store=_this.getResult();_this.opt.result.func(_this.store);if(this.opt.needClose!==false)_this.hide();}};areaFooter={type:'footer',widget:[widgetConfirm]};this.opt.area.push(areaFooter);}else{widgetConfirm.func=function(){_this.store=_this.getResult();_this.opt.result.func(_this.store);if(this.opt.needClose!==false)_this.hide();};}}};ConfigModal.prototype.getResult=function getResult(){var store={},widgetStore;var storeGroup;var data;var id;for(var i=0;i<this.opt.area.length;i++){if(this.opt.area[i].instantiation){data=this.opt.area[i].instantiation.getData();if(data)Object.assign(store,data);continue;}
for(var j=0;j<this.opt.area[i].widget.length;j++){if(this.opt.area[i].widget[j].id){id=this.opt.area[i].widget[j].id;}else{id=this.opt.area[i].widget[j].type;}
widgetStore=this.opt.area[i].widget[j].instantiation.getData();widgetStore&&(store[id]=widgetStore);}}
return store;};ConfigModal.prototype.upperCaseText=function upperCaseText(text,index){if(!text[0])return'';return text[index].toUpperCase()+text.slice(index+1);};ConfigModal.prototype.clearDom=function clearDom(){if(this.modalContent){this.modalContent.querySelector('.modal-body').innerHTML='';var modalHeader=this.modalContent.querySelector('.modal-header');modalHeader&&this.modalContent.removeChild(modalHeader);var arrModalFooter=this.modalContent.querySelectorAll('.modal-footer');for(var i=0;i<arrModalFooter.length;i++){this.modalContent.removeChild(arrModalFooter[i]);}}
this.modal&&$(this.modal).find('.modal-style').html('');this.modalBody&&(this.modalBody.innerHTML='');};ConfigModal.prototype.transDomToJSON=function transDomToJSON(){};ConfigModal.prototype.extendWidget=function extendWidget(){};ConfigModal.prototype.setData=function setData(data){var _this6=this;if(!(data instanceof Array&&data.length>0))return;data.forEach(function(val){if(!val.type)return;var moduleEntity;if(val.module){moduleEntity=_this6.getModuleByType(val.module);}
_this6.getWidgetByType(val.type,moduleEntity).forEach(function(widget){widget.instantiation.setData(val.data);});});return this;};ConfigModal.prototype.getModuleByType=function getModuleByType(module){if(!module)return;var arrModule=[];for(var i=0;i<this.opt.area.length;i++){if(this.opt.area[i].module==module){arrModule.push(this.opt.area[i]);}}
return arrModule;};ConfigModal.prototype.getWidgetByType=function getWidgetByType(type,area){var arrWidget=[];if(area){if(area instanceof Array){area.forEach(function(val){for(var i=0;i<val.widget.length;i++){if(val.widget[i].type==type){arrWidget.push(val.widget[i]);}}});}else{for(var i=0;i<area.widget.length;i++){if(area.widget[i].type==type){arrWidget.push(area.widget[i]);}}}}else{for(var _i=0;_i<this.opt.widget.length;_i++){if(this.opt.widget[_i].type==type){arrWidget.push(this.opt.widget[_i]);}}}
return arrWidget;};ConfigModal.prototype.destroy=function destroy(){this.clearDom();if(!(this.opt.area instanceof Array))return;for(var i=0;i<this.opt.area.length;i++){if(this.opt.area[i].instantiation){this.opt.area[i].instantiation.destroy();this.opt.area[i].instantiation=null;}else{if(!this.opt.area[i].widget)continue;for(var j=0;j<this.opt.area[i].widget.length;j++){if(!this.opt.area[i].widget[j].instantiation)continue;this.opt.area[i].widget[j].instantiation.destroy();this.opt.area[i].widget[j].instantiation=null;}}}};return ConfigModal;}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var BaseConfigWidget=function(){function BaseConfigWidget(objModal,widget,area){_classCallCheck(this,BaseConfigWidget);this.objModal=objModal;this.widget=widget;this.area=area;this.store=undefined;this.mainWidgetOpt={};}
BaseConfigWidget.prototype.init=function init(){this.initOption();this.initData();this.setWidget();this.attachEvent();this.widget.completeInit&&this.widget.completeInit.call(this);};BaseConfigWidget.prototype.setWidget=function setWidget(){this.widget.dom=document.createElement('div');this.widget.dom.className='cfgWidget cfgOptionWidget div'+this.upperCaseText(this.widget.type);this.widget.dom.setAttribute('type',this.widget.type);this.initWidgetLabel();this.initWidgetAttr();this.initWidgetStyle();this.initWidgetId();this.widget.dom.appendChild(this.createWidgetDom(this.widget.opt));this.area.dom.appendChild(this.widget.dom);};BaseConfigWidget.prototype.initOption=function initOption(){if(this.defaultOpt){this.widget=$.extend(true,{},this.defaultOpt,this.widget);}};BaseConfigWidget.prototype.setSubWidget=function setSubWidget(){var _this2=this;if(!(this.widget.subWidget instanceof Array))return;this.widget.subWidget.forEach(function(val){var obj;for(var i=0;i<_this2.area.widget.length;i++){if(_this2.area.widget[i].type==val.type){obj=_this2.area.widget[i].instantiation;}}
if(!obj)return;if(typeof val.callback=='function'){val.callback.call(obj,_this2.widget.type,_this2.store);obj.setSubWidget();}else{obj.onMainWidgetChange(_this2.widget.type,_this2.store);}});};BaseConfigWidget.prototype.onMainWidgetChange=function onMainWidgetChange(type,val){};BaseConfigWidget.prototype.initWidgetLabel=function initWidgetLabel(){if(this.widget.name&&this.widget.opt.needLabel!==false){var label=document.createElement('label');label.className='cfgLabel';label.textContent=this.widget.name;this.widget.dom.appendChild(label);}};BaseConfigWidget.prototype.initWidgetAttr=function initWidgetAttr(){if(this.widget.opt.attr){for(var attr in this.widget.opt.attr){if(attr=='class'){this.widget.dom.className+=' '+this.widget.opt.attr[attr];continue;}
this.widget.dom.setAttribute(attr,this.widget.opt.attr[attr]);}}};BaseConfigWidget.prototype.initWidgetStyle=function initWidgetStyle(){if(this.widget.opt.style){$(this.widget.dom).css(this.widget.opt.style);}};BaseConfigWidget.prototype.initWidgetId=function initWidgetId(){if(this.widget.id){this.widget.dom.id=this.widget.id;}};BaseConfigWidget.prototype.attachEvent=function attachEvent(){};BaseConfigWidget.prototype.initData=function initData(){this.store=this.widget.store;};BaseConfigWidget.prototype.createWidgetDom=function createWidgetDom(opt){};BaseConfigWidget.prototype.setData=function setData(data){this.store=data;};BaseConfigWidget.prototype.getData=function getData(){return this.store;};BaseConfigWidget.prototype.upperCaseText=function upperCaseText(text,index){if(!index)index=0;return text[index].toUpperCase()+text.slice(index+1);};BaseConfigWidget.prototype.destroy=function destroy(){this.objModal=null;this.widget=null;this.area=null;this.store=null;this.mainWidgetOpt=null;};return BaseConfigWidget;}();var baseModuleOperateBtn=function(){function baseModuleOperateBtn(module){_classCallCheck(this,baseModuleOperateBtn);this.module=module;this.btn=undefined;}
baseModuleOperateBtn.prototype.init=function init(){this.createButton();this.attachEvent();};baseModuleOperateBtn.prototype.createButton=function createButton(){};baseModuleOperateBtn.prototype.attachEvent=function attachEvent(){};return baseModuleOperateBtn;}();var btnModuleAdd=function(_baseModuleOperateBtn){_inherits(btnModuleAdd,_baseModuleOperateBtn);function btnModuleAdd(module){_classCallCheck(this,btnModuleAdd);return _possibleConstructorReturn(this,_baseModuleOperateBtn.call(this,module));}
btnModuleAdd.prototype.createButton=function createButton(){this.btn=document.createElement('span');this.btn.className='glyphicon glyphicon-plus btnModuleAdd btnModuleOperate';this.module.dom.appendChild(this.btn,this.module.dom.children[0]);};btnModuleAdd.prototype.attachEvent=function attachEvent(){var _this=this;this.btn.onclick=function(){$(_this.module.dom).after('');};};return btnModuleAdd;}(baseModuleOperateBtn);var btnModuleDel=function(_baseModuleOperateBtn2){_inherits(btnModuleDel,_baseModuleOperateBtn2);function btnModuleDel(module){_classCallCheck(this,btnModuleDel);return _possibleConstructorReturn(this,_baseModuleOperateBtn2.call(this,module));}
btnModuleDel.prototype.createButton=function createButton(){this.btn=document.createElement('span');this.btn.className='glyphicon glyphicon-plus btnModuleDel btnModuleOperate';this.module.dom.appendChild(this.btn,this.module.dom.children[0]);};btnModuleDel.prototype.attachEvent=function attachEvent(){var _this=this;this.btn.onclick=function(){$(_this.module.dom).after('');};};return btnModuleDel;}(baseModuleOperateBtn);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var BaseOptionWidget=function(_BaseConfigWidget){_inherits(BaseOptionWidget,_BaseConfigWidget);function BaseOptionWidget(objModal,widget,area){_classCallCheck(this,BaseOptionWidget);return _possibleConstructorReturn(this,_BaseConfigWidget.call(this,objModal,widget,area));}
return BaseOptionWidget;}(BaseConfigWidget);var SelectOption=function(_BaseOptionWidget){_inherits(SelectOption,_BaseOptionWidget);function SelectOption(objModal,widget,area){_classCallCheck(this,SelectOption);var _this3=_possibleConstructorReturn(this,_BaseOptionWidget.call(this,objModal,widget,area));_this3.defaultOpt={type:'select',opt:{attr:{class:'col-xs-3'}}};return _this3;}
SelectOption.prototype.setWidget=function setWidget(){this.widget.dom=document.createElement('div');this.widget.dom.className='cfgWidget cfgOptionWidget div'+this.upperCaseText(this.widget.type);this.widget.dom.setAttribute('type',this.widget.type);this.initWidgetLabel();this.initWidgetAttr();this.initWidgetStyle();this.initWidgetId();this.widget.dom.appendChild(this.createWidgetDom(this.widget.opt));this.area.dom.appendChild(this.widget.dom);};SelectOption.prototype.createWidgetDom=function createWidgetDom(opt){var select=document.createElement('select');select.className='form-control';var option;for(var i=0;i<opt.option.length;i++){option=new Option();option.value=opt.option[i].val;option.text=opt.option[i].name;if(this.store.val==opt.option[i].val){option.selected=true;}
select.options.add(option);}
if(!this.store.val)select.options[0].selected=true;return select;};SelectOption.prototype.attachEvent=function attachEvent(){var _this4=this;$(this.widget.dom).find('select').off('change').on('change',function(e){_this4.store={val:e.currentTarget.value,name:e.currentTarget.querySelector('[value="'+e.currentTarget.value+'"]').textContent};_this4.setSubWidget();});};SelectOption.prototype.initData=function initData(){if(this.widget.data&&this.widget.data.val){for(var i=0;i<this.widget.opt.option.length;i++){if(this.widget.opt.option[i].val==this.widget.data.val){this.store={val:this.widget.opt.option[i].val,name:this.widget.opt.option[i].name};return;}}}
this.store={val:this.widget.opt.option[0].val,name:this.widget.opt.option[0].name};};return SelectOption;}(BaseOptionWidget);var IntervalOption=function(_SelectOption){_inherits(IntervalOption,_SelectOption);function IntervalOption(objModal,widget,area){_classCallCheck(this,IntervalOption);var _this5=_possibleConstructorReturn(this,_SelectOption.call(this,objModal,widget,area));_this5.defaultOpt={type:'interval',opt:{option:[{val:'m1',name:'1'},{val:'m5',name:'5'},{val:'h1',name:'1'},{val:'d1',name:'1'},{val:'M1',name:'1'}],attr:{class:'col-xs-3'}},name:''};return _this5;}
IntervalOption.prototype.initData=function initData(){if(this.widget.data&&this.widget.data.val){for(var i=0;i<this.widget.opt.option.length;i++){if(this.widget.opt.option[i].val==this.widget.data.val){this.store={val:this.widget.opt.option[i].val,name:this.widget.opt.option[i].name};return;}}}
this.store={val:this.widget.opt.option[0].val,name:this.widget.opt.option[0].name};};return IntervalOption;}(SelectOption);var RefreshIntervalOption=function(_SelectOption2){_inherits(RefreshIntervalOption,_SelectOption2);function RefreshIntervalOption(objModal,widget,area){_classCallCheck(this,RefreshIntervalOption);var _this6=_possibleConstructorReturn(this,_SelectOption2.call(this,objModal,widget,area));_this6.defaultOpt={type:'refreshInterval',opt:{option:[{val:'30s',name:'30'},{val:'m1',name:'1'},{val:'m5',name:'5'},{val:'10m',name:'10'},{val:'30m',name:'30'},{val:'h1',name:'1'},{val:'d1',name:'1'},{val:'M1',name:'1'}],attr:{class:'col-xs-3'}},name:''};return _this6;}
return RefreshIntervalOption;}(SelectOption);var ModeOption=function(_SelectOption3){_inherits(ModeOption,_SelectOption3);function ModeOption(objModal,widget,area){var opt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,ModeOption);var _this7=_possibleConstructorReturn(this,_SelectOption3.call(this,objModal,widget,area,opt));_this7.defaultOpt={type:'mode',opt:{option:[{val:'0',name:''},{val:'1',name:''},{val:'2',name:''}],attr:{class:'col-xs-3'}},name:''};return _this7;}
return ModeOption;}(SelectOption);var RecentTimeOption=function(_SelectOption4){_inherits(RecentTimeOption,_SelectOption4);function RecentTimeOption(objModal,widget,area){var opt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,RecentTimeOption);var _this8=_possibleConstructorReturn(this,_SelectOption4.call(this,objModal,widget,area,opt));_this8.defaultOpt={type:'recentTime',opt:{option:[{val:'today',name:'24'},{val:'threeDay',name:'72'},{val:'yesterday',name:'24'},{val:'thisWeek',name:'7'},{val:'lastWeek',name:'7'},{val:'thisYear',name:'12'}],attr:{class:'col-xs-3'}},name:''};return _this8;}
RecentTimeOption.prototype.getData=function getData(){var startTime,endTime,format;var now=new Date();switch(this.store.val){case'today':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-86400000).format('yyyy-MM-dd HH:00:00');format='h1';break;case'threeDay':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-259200000).format('yyyy-MM-dd HH:00:00');format='h1';break;case'yesterday':endTime=new Date(new Date().setDate(now.getDate()-1)).format('yyyy-MM-dd 00:00:00');startTime=new Date(new Date().setDate(now.getDate()-1)).format('yyyy-MM-dd 00:00:00');format='h1';break;case'thisWeek':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now-604800000).format('yyyy-MM-dd 00:00:00');format='d1';break;case'lastWeek':endTime=new Date(now-now.getDay()*86400000).format('yyyy-MM-dd 00:00:00');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd 00:00:00');format='d1';break;case'thisYear':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now-31536000000).format('yyyy-MM-dd 00:00:00');format='M1';break;}
return{startTime:startTime,endTime:endTime,recentTime:this.store.val,format:format};};RecentTimeOption.prototype.initData=function initData(){if(this.widget.data){for(var i=0;i<this.widget.opt.option.length;i++){if(this.widget.opt.option[i].val==this.widget.data){this.store={val:this.widget.opt.option[i].val,name:this.widget.opt.option[i].name};break;}}}else{this.store={val:this.widget.opt.option[0].val,name:this.widget.opt.option[0].name};}};return RecentTimeOption;}(SelectOption);var TextWithSelectOption=function(_BaseOptionWidget2){_inherits(TextWithSelectOption,_BaseOptionWidget2);function TextWithSelectOption(objModal,widget,area){_classCallCheck(this,TextWithSelectOption);var _this9=_possibleConstructorReturn(this,_BaseOptionWidget2.call(this,objModal,widget,area));_this9.defaultOpt={type:'textWithSelect',opt:{attr:{class:'col-xs-6'}}};return _this9;}
TextWithSelectOption.prototype.createWidgetDom=function createWidgetDom(opt){var divIptGrp=document.createElement('div');divIptGrp.className='input-group';divIptGrp.style.width='100%';var iptText=document.createElement('input');iptText.className='form-control';iptText.setAttribute('type','text');iptText.style.width='50%';var select=document.createElement('select');select.className='form-control';select.style.width='50%';var option;for(var ele in opt.option){option=new Option();option.value=opt.option[ele].val;option.text=opt.option[ele].name;select.options.add(option);}
divIptGrp.appendChild(iptText);divIptGrp.appendChild(select);return divIptGrp;};TextWithSelectOption.prototype.initData=function initData(){this.store={};if(this.widget.data&&this.widget.data.val){this.store.val=this.widget.data.val;}
if(this.widget.data&&this.widget.data.unit){this.store.unit=this.widget.data.unit;}else{this.store.unit=this.widget.opt.option[0].val;}};TextWithSelectOption.prototype.attachEvent=function attachEvent(){var _this=this;this.widget.dom.querySelector('select').onchange=function(e){_this.store.unit=e.currentTarget.value;_this.setSubWidget();};this.widget.dom.querySelector('input').onchange=function(e){_this.store.val=e.currentTarget.value;};};return TextWithSelectOption;}(BaseOptionWidget);var recentTimeCustomOption=function(_TextWithSelectOption){_inherits(recentTimeCustomOption,_TextWithSelectOption);function recentTimeCustomOption(objModal,widget,area){_classCallCheck(this,recentTimeCustomOption);var _this10=_possibleConstructorReturn(this,_TextWithSelectOption.call(this,objModal,widget,area));_this10.defaultOpt={type:'recentTimeCustom',opt:{option:[{val:'hour',name:''},{val:'day',name:''},{val:'month',name:''}],attr:{class:'col-xs-6'}},name:''};return _this10;}
recentTimeCustomOption.prototype.getData=function getData(){return this.store;};recentTimeCustomOption.prototype.createWidgetDom=function createWidgetDom(opt){var divIptGrp=document.createElement('div');divIptGrp.className='input-group';divIptGrp.style.width='100%';var iptText=document.createElement('input');iptText.className='form-control';iptText.setAttribute('type','text');iptText.style.width='50%';if(this.store&&this.store.val){iptText.value=this.store.val;}
var select=document.createElement('select');select.className='form-control';select.style.width='50%';var option;for(var ele in opt.option){option=new Option();option.value=opt.option[ele].val;option.text=opt.option[ele].name;select.options.add(option);if(this.store&&this.store.unit===option.value){option.selected=true;}}
divIptGrp.appendChild(iptText);divIptGrp.appendChild(select);return divIptGrp;};return recentTimeCustomOption;}(TextWithSelectOption);var DateOption=function(_BaseOptionWidget3){_inherits(DateOption,_BaseOptionWidget3);function DateOption(objModal,widget,area){_classCallCheck(this,DateOption);var _this11=_possibleConstructorReturn(this,_BaseOptionWidget3.call(this,objModal,widget,area));_this11.defaultOpt={type:'date',opt:{input:[{val:new Date(),role:'timeStart',suffix:'To'},{val:new Date(),role:'timeEnd'}],attr:{class:'col-xs-6'}},name:''};return _this11;}
DateOption.prototype.initData=function initData(){this.store={};if(this.widget.data){this.store.timeStart=this.widget.data.timeStart;this.store.timeEnd=this.widget.data.timeEnd;return;}
for(var i=0;i<this.widget.opt.input.length;i++){var date=new Date(this.widget.opt.input[i].val);if(!date||date=='Invalid Date')date=new Date();this.store[this.widget.opt.input[i].role]=date.format('yyyy-MM-dd HH:mm:ss');}};DateOption.prototype.createWidgetDom=function createWidgetDom(opt){var divIptDateGrp=document.createElement('div');divIptDateGrp.className='input-group';var iptDate,spDateSuffix;if(opt.input instanceof Array&&opt.input.length>0){for(var i=0;i<opt.input.length;i++){iptDate=document.createElement('input');iptDate.className='form-control';iptDate.setAttribute('type','text');iptDate.setAttribute('role',opt.input[i].role);if(this.store[opt.input[i].role]){iptDate.value=this.store[opt.input[i].role];}
divIptDateGrp.appendChild(iptDate);if(opt.input[i].suffix){spDateSuffix=document.createElement('span');spDateSuffix.textContent=opt.input[i].suffix;spDateSuffix.className='input-group-addon';divIptDateGrp.appendChild(spDateSuffix);}
$(iptDate).datetimepicker({initialDate:this.store[opt.input[i].role]?new Date(this.store[opt.input[i].role]):new Date(),format:'yyyy-mm-dd hh:ii:ss',todayBtn:'linked',autoclose:true});}}
return divIptDateGrp;};DateOption.prototype.onMainWidgetChange=function onMainWidgetChange(data){};DateOption.prototype.attachEvent=function attachEvent(){var _this12=this;var $iptDate=$(this.widget.dom).find('input');this.store={};$iptDate.off('change').on('change',function(e){for(var i=0;i<$iptDate.length;i++){_this12.store[e.currentTarget.getAttribute('role')]=e.currentTarget.value;}});};DateOption.prototype.getData=function getData(){var _this13=this;var $iptDate=$(this.widget.dom).find('input');this.store={};$iptDate.each(function(index,obj){_this13.store[obj.getAttribute('role')]=obj.value;});return this.store;};return DateOption;}(BaseOptionWidget);var TextOption=function(_BaseOptionWidget4){_inherits(TextOption,_BaseOptionWidget4);function TextOption(objModal,widget,area){_classCallCheck(this,TextOption);var _this14=_possibleConstructorReturn(this,_BaseOptionWidget4.call(this,objModal,widget,area));_this14.defaultOpt={type:'text',opt:{data:'',attr:{class:'col-xs-6'}}};return _this14;}
TextOption.prototype.initData=function initData(){this.store={val:this.widget.opt.data};};TextOption.prototype.createWidgetDom=function createWidgetDom(opt){var ipt=document.createElement('input');ipt.className='form-control';ipt.setAttribute('type','text');ipt.value=opt.data?opt.data:'';if(opt.attr.placeholder)ipt.setAttribute('placeholder',opt.attr.placeholder);return ipt;};TextOption.prototype.attachEvent=function attachEvent(){var _this15=this;$(this.widget.dom).find('input').off('change').on('change',function(e){_this15.store={val:e.currentTarget.value};_this15.setSubWidget();});$(this.widget.dom).find('input').off('input').on('input',function(e){_this15.store={val:e.currentTarget.value};_this15.setSubWidget();});};return TextOption;}(BaseOptionWidget);var RangeOption=function(_BaseOptionWidget5){_inherits(RangeOption,_BaseOptionWidget5);function RangeOption(objModal,widget,area){_classCallCheck(this,RangeOption);var _this16=_possibleConstructorReturn(this,_BaseOptionWidget5.call(this,objModal,widget,area));_this16.defaultOpt={type:'range',opt:{attr:{class:'col-xs-12'}}};return _this16;}
RangeOption.prototype.createWidgetDom=function createWidgetDom(opt){var divIptDateGrp=document.createElement('div');divIptDateGrp.className='input-group';var iptRange,spDateSuffix;if(opt.input instanceof Array&&opt.input.length>0){for(var i=0;i<opt.input.length;i++){iptRange=document.createElement('input');iptRange.className='form-control';opt.input[i].cls&&(iptRange.className+=' '+opt.input[i].cls);iptRange.setAttribute('type','text');iptRange.value=opt.input[i].val?opt.input[i].val:'';iptRange.setAttribute('role',opt.input[i].role?opt.input[i].role:'');divIptDateGrp.appendChild(iptRange);if(opt.input[i].suffix){spDateSuffix=document.createElement('span');spDateSuffix.className='input-group-addon';opt.input[i].suffix.cls&&(spDateSuffix.className+=' '+opt.input[i].suffix.cls);opt.input[i].suffix.text&&(spDateSuffix.textContent=opt.input[i].suffix.text);opt.input[i].suffix.style&&$.extend(spDateSuffix.style,opt.input[i].suffix.style);divIptDateGrp.appendChild(spDateSuffix);}}}
return divIptDateGrp;};RangeOption.prototype.initData=function initData(){if(this.widget.opt.input instanceof Array&&this.widget.opt.input.length>0){this.store=this.widget.opt.input.map(function(item){return{val:!isNaN(item.value)?parseFloat(item.value):0,role:item.role?item.role:''};});}else{this.store=[];}};RangeOption.prototype.attachEvent=function attachEvent(){var _this17=this;var $iptRange=$(this.widget.dom).find('input');$iptRange.off('change').on('change',function(e){_this17.getIptVal($iptRange);});};RangeOption.prototype.getIptVal=function getIptVal($iptRange){var arrRange=[];for(var i=0;i<$iptRange.length;i++){arrRange.push({val:!isNaN($iptRange[i].value)?parseFloat($iptRange[i].value):0,role:$iptRange[i].getAttribute('role')});}
this.store=arrRange;};return RangeOption;}(BaseOptionWidget);var LinkOption=function(_BaseOptionWidget6){_inherits(LinkOption,_BaseOptionWidget6);function LinkOption(objModal,widget,area){_classCallCheck(this,LinkOption);var _this18=_possibleConstructorReturn(this,_BaseOptionWidget6.call(this,objModal,widget,area));_this18.defaultOpt={type:'linkSelect',name:'',opt:{data:'',attr:{class:'col-xs-6'},option:{}}};return _this18;}
LinkOption.prototype.createWidgetDom=function createWidgetDom(opt){var divSelect=document.createElement('div');divSelect.className='divLinkSel';var selLinkType=document.createElement('select');selLinkType.className='form-control selLinkType';var typeOpt,typeIndex;typeIndex=0;for(var i=0;i<opt.option.length;i++){typeOpt=new Option();typeOpt.value=typeOpt.option[i].type;typeOpt.name=typeOpt.option[i].name;if(this.store.type==typeOpt.option[i].val){typeOpt.selected=true;typeIndex=i;}
selLinkType.options.add(typeOpt);}
var selLinkTar=document.createElement('select');selLinkTar.className='form-control selLinkTar';var linkOpt;for(var i=0;i<opt.option[typeIndex].link.length;i++){linkOpt=new Option();linkOpt.value=opt.option[typeIndex].link[i].val;linkOpt.name=opt.option[typeIndex].link[i].name;if(this.store.link==opt.option[typeIndex].link[i].val){linkOpt.selected=true;}
selLinkTar.options.add(linkOpt);}
return divSelect;};LinkOption.prototype.setChartSelTar=function setChartSelTar($dom){$dom.innerHTML='';if(!this.opt.option||!this.opt.option.chart)return;var opt;var arrOpt=this.opt.option.page;for(var i=0;i<arrOpt.length;i++){opt=new Option();opt.value=arrOpt[i].val;opt.text=arrOpt[i].name;if(this.store.val==arrOpt[i].val){opt.selected=true;}
$dom[0].options.add(opt);}};LinkOption.prototype.setPageSelTar=function setPageSelTar($dom){$dom.innerHTML='';if(!this.opt.option||!this.opt.option.page)return;var opt;var arrOpt=this.opt.option.page;for(var i=0;i<arrOpt.length;i++){opt=new Option();opt.value=arrOpt[i].val;opt.text=arrOpt[i].name;if(this.store.val==arrOpt[i].val){opt.selected=true;}
$dom[0].options.add(opt);}};LinkOption.prototype.attachEvent=function attachEvent(){var _this19=this;var $selLinkTar=$(this.widget.dom).find('.selLinkTar');$(this.widget.dom).find('.selLinkType').off('change').on('change',function(e){if(e.currentTarget.value=='chart'){_this19.setChartSelTar($selLinkTar);}else{_this19.setPageSelTar($selLinkTar);}});};return LinkOption;}(BaseOptionWidget);var CheckBoxOption=function(_BaseOptionWidget7){_inherits(CheckBoxOption,_BaseOptionWidget7);function CheckBoxOption(objModal,widget,area){_classCallCheck(this,CheckBoxOption);var _this20=_possibleConstructorReturn(this,_BaseOptionWidget7.call(this,objModal,widget,area));_this20.defaultOpt={type:'checkbox',name:'',opt:{data:'',option:{}}};return _this20;}
CheckBoxOption.prototype.createWidgetDom=function createWidgetDom(opt){var iptChkBox=document.createElement('input');iptChkBox.className='iptCheckBox';iptChkBox.style.top='2px';iptChkBox.style.left='10px';iptChkBox.style.position='relative';iptChkBox.setAttribute('type','checkbox');if(this.store==true)iptChkBox.checked=true;return iptChkBox;};CheckBoxOption.prototype.initData=function initData(){if(this.widget.data){this.store=this.widget.data;}};CheckBoxOption.prototype.getData=function getData(){var val=this.widget.dom.querySelector('.iptCheckBox').checked;this.store=val;return this.store;};return CheckBoxOption;}(BaseOptionWidget);var InputColorOption=function(_BaseOptionWidget8){_inherits(InputColorOption,_BaseOptionWidget8);function InputColorOption(objModal,widget,area){_classCallCheck(this,InputColorOption);var _this21=_possibleConstructorReturn(this,_BaseOptionWidget8.call(this,objModal,widget,area));_this21.defaultOpt={type:'color',opt:{data:'',attr:{class:'col-xs-2'}}};return _this21;}
InputColorOption.prototype.initData=function initData(){this.store={val:this.widget.opt.data};};InputColorOption.prototype.createWidgetDom=function createWidgetDom(opt){var ipt=document.createElement('input');ipt.setAttribute('type','color');ipt.className='form-control';ipt.value=opt.data?opt.data:'';return ipt;};InputColorOption.prototype.attachEvent=function attachEvent(){var _this22=this;$(this.widget.dom).find('input').off('change').on('change',function(e){_this22.store={val:e.currentTarget.value};});};return InputColorOption;}(BaseOptionWidget);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var BaseDataWidget=function(_BaseConfigWidget){_inherits(BaseDataWidget,_BaseConfigWidget);function BaseDataWidget(objModal,widget,area){_classCallCheck(this,BaseDataWidget);return _possibleConstructorReturn(this,_BaseConfigWidget.call(this,objModal,widget,area));}
BaseDataWidget.prototype.setWidget=function setWidget(){this.widget.dom=document.createElement('div');this.widget.dom.className='cfgWidget cfgDataWidget div'+this.upperCaseText(this.widget.type);this.widget.dom.setAttribute('type',this.widget.type);this.initWidgetLabel();this.initWidgetAttr();this.initWidgetStyle();this.initWidgetId();this.widget.dom.appendChild(this.createWidgetDom(this.widget.opt));this.area.dom.appendChild(this.widget.dom);};return BaseDataWidget;}(BaseConfigWidget);var DataSourceData=function(_BaseDataWidget){_inherits(DataSourceData,_BaseDataWidget);function DataSourceData(objModal,widget,area){var opt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,DataSourceData);var _this3=_possibleConstructorReturn(this,_BaseDataWidget.call(this,objModal,widget,area,opt));_this3.chartCogDom=undefined;return _this3;}
DataSourceData.prototype.initData=function initData(){this.store={};for(var i=0;i<this.widget.opt.variable.length;i++){this.store[this.widget.opt.variable[i].type]=this.widget.opt.variable[i];if(!this.store[this.widget.opt.variable[i].type].cog){this.store[this.widget.opt.variable[i].type].cog={upper:'',lower:'',unit:'',accuracy:'',markLine:[]};}}};DataSourceData.prototype.createWidgetDom=function createWidgetDom(opt){var divDataWorkspace=document.createElement('div');divDataWorkspace.className='divDsWorkspace';var divVar,spLabel,divTip,divVarData;for(var ele in opt.variable){divVar=document.createElement('div');divVar.className='divVar row divVar'+this.upperCaseText(opt.variable[ele].type);divVar.dataset.type=opt.variable[ele].type;spLabel=document.createElement('span');spLabel.className='spVarLabel';spLabel.textContent=opt.variable[ele].name;divVar.appendChild(spLabel);divVarData=document.createElement('div');divVarData.className='divVarData';for(var i=0;i<opt.variable[ele].data.length;i++){divVarData.appendChild(this.createDataUnitDom(opt.variable[ele].data[i]));}
divTip=this.createDataTipDom();divVarData.appendChild(divTip);divVar.appendChild(divVarData);if(opt.variable[ele].forChart!==false){divVar.appendChild(this.createChartCogBtnDom());}
divDataWorkspace.appendChild(divVar);}
divDataWorkspace.appendChild(this.createChartCogDom());return divDataWorkspace;};DataSourceData.prototype.createDataUnitDom=function createDataUnitDom(id){var divDs=document.createElement('div');divDs.className='divDs grow col-xs-4 col-lg-3';divDs.dataset.id=id;var spDs=document.createElement('span');spDs.className='spDs';var datasource=AppConfig.datasource.getDSItemById(id);spDs.textContent=datasource.alias===""?datasource.value:datasource.alias;spDs.title=spDs.textContent;divDs.appendChild(spDs);var spBtnDel=document.createElement('span');spBtnDel.className='glyphicon glyphicon-remove btnDsDel';divDs.appendChild(spBtnDel);$(divDs).tooltip({placement:'bottom',title:datasource.value,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div><div class="tooltipContent"><div>'+datasource.alias+'</div></div></div>'});return divDs;};DataSourceData.prototype.createDataTipDom=function createDataTipDom(){var divDsTip=document.createElement('div');divDsTip.className='divDs divDsTip col-xs-4 col-lg-3';var spDsTip=document.createElement('span');spDsTip.className='glyphicon glyphicon-plus';divDsTip.appendChild(spDsTip);return divDsTip;};DataSourceData.prototype.createChartCogBtnDom=function createChartCogBtnDom(){var divChartCog=document.createElement('div');divChartCog.className='grow btnChartCog glyphicon glyphicon-cog';var _this=this;divChartCog.onclick=function(e){var type=e.currentTarget.parentNode.dataset.type;_this.initChartCogData(type);_this.chartCogDom&&$(_this.chartCogDom).show();};return divChartCog;};DataSourceData.prototype.createChartCogDom=function createChartCogDom(){var panelCog=document.createElement('div');panelCog.className='panelChartCog form-horizontal';panelCog.innerHTML='\n                <div class="form-group">\n                    <label for="inputPtValUpper" class="col-xs-4 control-label" i18n="modalConfig.data.PT_UPPER">\u5750\u6807\u8F74\u4E0A\u9650</label>\n                    <div class="col-xs-6">\n                        <input type="text" class="form-control upper" data-role="upper" placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputPtValLower" class="col-xs-4 control-label" i18n="modalConfig.data.PT_LOWER">\u5750\u6807\u8F74\u4E0B\u9650</label>\n                    <div class="col-xs-6">\n                        <input type="text" class="form-control lower" data-role="lower" placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputPtUnit" class="col-xs-4 control-label" i18n="modalConfig.data.PT_UNIT">\u5750\u6807\u8F74\u5355\u4F4D</label>\n                    <div class="col-xs-6">\n                        <input type="text" class="form-control unit" data-role="unit" placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputPtAccuracy" class="col-xs-4 control-label" i18n="modalConfig.data.PT_ACCURACY">\u5C0F\u6570\u70B9\u4F4D\u6570</label>\n                    <div class="col-xs-6">\n                        <input type="text" class="form-control accuracy" data-role="accuracy" placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputLineName1" class="col-xs-4 control-label" i18n="modalConfig.data.PT_LINE_1">\u57FA\u7EBF1</label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineName markLine-0" data-role="mkName" placeholder="TiTle">\n                    </div>\n                    <label for="inputLineVal1" class="sr-only control-label"></label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineVal markLine-0" data-role="mkVal" placeholder="Value">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputLineName2" class="col-xs-4 control-label" i18n="modalConfig.data.PT_LINE_2">\u57FA\u7EBF2</label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineName markLine-1" data-role="mkName" placeholder="">\n                    </div>\n                    <label for="inputLineVal2" class="sr-only control-label"></label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineVal markLine-1" data-role="mkVal"  placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputLineName3" class="col-xs-4 control-label" i18n="modalConfig.data.PT_LINE_3">\u57FA\u7EBF3</label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineName markLine-2" data-role="mkName" placeholder="">\n                    </div>\n                    <label for="inputLineVal3" class="sr-only control-label"></label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineVal markLine-2" data-role="mkVal" placeholder="">\n                    </div>\n                </div>\n                <div class="form-group">\n                    <label for="inputLineName4" class="col-xs-4 control-label" i18n="modalConfig.data.PT_LINE_4">\u57FA\u7EBF4</label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineName markLine-3" data-role="mkName" placeholder="">\n                    </div>\n                    <label for="inputLineVal4" class="sr-only control-label"></label>\n                    <div class="col-xs-3">\n                        <input type="text" class="form-control inputLineVal markLine-3" data-role="mkVal" placeholder="">\n                    </div>\n                </div>\n                <span class="glyphicon glyphicon-remove btnPanelCogHide" aria-hidden="true"></span>\n                <div class="divBtnCogGrp">\n                    <button type="button" class="btn btn-primary btnCogConfirm" i18n="modalConfig.data.PT_COG_SURE">\u786E\u8BA4</button>\n                    <button type="button" class="btn btn-primary btnCogCancel" i18n="modalConfig.data.PT_COG_CANCEL">\u53D6\u6D88</button>\n                </div>\n            ';panelCog.style.display='none';var _this=this;panelCog.querySelector('.btnCogConfirm').onclick=function(){_this.setChartCogData();$(panelCog).hide();};panelCog.querySelector('.btnCogCancel').onclick=function(){$(panelCog).hide();};panelCog.querySelector('.btnPanelCogHide').onclick=function(){$(panelCog).hide();};this.chartCogDom=panelCog;return panelCog;};DataSourceData.prototype.setChartCogData=function setChartCogData(){var iptGrp=this.chartCogDom.querySelectorAll('input');for(var i=0;i<iptGrp.length;i++){if(iptGrp.dataset.role!='mkVal'&&iptGrp.dataset.role!='mkName'){this.store[this.chartCogDom.dataset.type].cog[iptGrp.dataset.role]=iptGrp;}}
this.store[this.chartCogDom.dataset.type].cog.markLine=[];for(var _i=0;_i<4;_i++){this.store[this.chartCogDom.dataset.type].cog.markLine.push({name:this.chartCogDom.querySelector('inputLineName markLine-'+(_i+1)),value:this.chartCogDom.querySelector('inputLineVal markLine-'+(_i+1))});}};DataSourceData.prototype.initChartCogData=function initChartCogData(type){var _this4=this;this.chartCogDom.dataset.type=type;Object.keys(this.store[type].cog).forEach(function(val){if(val!='markLine'){_this4.chartCogDom.querySelector('.'+val).value=_this4.store[type].cog[val];}else{for(var i=0;i<_this4.store[type].cog[val].length;i++){_this4.chartCogDom.querySelector('.inputLineName '+val+'-'+i).value=_this4.store[type].cog[val][i].name;_this4.chartCogDom.querySelector('.inputLineVal '+val+'-'+i).value=_this4.store[type].cog[val][i].value;}}});};DataSourceData.prototype.attachEvent=function attachEvent(){var _this5=this;$(this.widget.dom).find('.divVar').off('dragover').on('dragover',function(e){e.preventDefault();$(e.currentTarget).find('.divDsTip').addClass('dragover');});$(this.widget.dom).find('.divVar').off('dragleave').on('dragleave',function(e){e.preventDefault();$(e.currentTarget).find('.divDsTip').removeClass('dragover');});$(this.widget.dom).find('.divVar').off('drop').on('drop',function(e){e.preventDefault();var id=EventAdapter.getData().dsItemId;var datasource=AppConfig.datasource.getDSItemById(id);var textContent=datasource.alias===""?datasource.value:datasource.alias;var $allShowDatasource=$(e.currentTarget.querySelector('.divVarData')).find(".spDs");var num=0;$allShowDatasource.each(function(){var $thisName=$(this).text();if($thisName===textContent){num+=1;}});var divTip=e.currentTarget.querySelector('.divDsTip');$(divTip).removeClass('dragover');if(num<=0){e.currentTarget.querySelector('.divVarData').insertBefore(_this5.createDataUnitDom(id),divTip);_this5.setStore();}else{alert(I18n.resource.modalConfig.err.TYPE2);}});$(this.widget.dom).off('click').on('click','.btnDsDel',function(e){$(e.currentTarget).parent().next('.tooltip').remove().end().remove();_this5.setStore();});};DataSourceData.prototype.setStore=function setStore(){var $divParam=$(this.widget.dom).find('.divVar');var $divDs;this.store={};for(var i=0;i<$divParam.length;i++){$divDs=$divParam.eq(i).find('.divDs');if(!this.store[$divParam[i].dataset.type]){this.store[$divParam[i].dataset.type]={data:[],cog:{}};}
for(var j=0;j<$divDs.length;j++){if(!$divDs[j].dataset.id)continue;this.store[$divParam[i].dataset.type].data.push($divDs[j].dataset.id);}}};return DataSourceData;}(BaseDataWidget);var DataInfoListData=function(_BaseDataWidget2){_inherits(DataInfoListData,_BaseDataWidget2);function DataInfoListData(objModal,widget,area){var opt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,DataInfoListData);return _possibleConstructorReturn(this,_BaseDataWidget2.call(this,objModal,widget,area,opt));}
DataInfoListData.prototype.initData=function initData(){this.store=[];for(var i=0;i<this.widget.opt.variable.length;i++){this.store.push(this.widget.opt.variable[i]);}};DataInfoListData.prototype.createWidgetDom=function createWidgetDom(opt){var divDataBindList=document.createElement('div');divDataBindList.className='divDataBindList';var divParamAdd=document.createElement('div');divParamAdd.className='divBtnAddParam glyphicon glyphicon-plus';var _this=this;divParamAdd.onclick=function(){divDataBindList.appendChild(_this.createLiData({}));};divDataBindList.appendChild(divParamAdd);divDataBindList.appendChild(this.createDataListTtl());for(var i=0;i<opt.variable.length;i++){divDataBindList.appendChild(this.createLiData(opt.variable[i]));}
return divDataBindList;};DataInfoListData.prototype.createDataListTtl=function createDataListTtl(){var divTtl=document.createElement('div');divTtl.className='divDataListTtl flexCenter';divTtl.innerHTML='\
        <span class="spDataListTtl spDataListNameTtl"></span>\
        <span class="spDataListTtl spDataListDsTtl"></span>\
        <span class="spDataListTtl spDataListUnitTtl"></span>\
        <span class="spDataListTtl spDataListScaleTtl"></span>\
        ';return divTtl;};DataInfoListData.prototype.createLiData=function createLiData(variable){var divLiDataBind=document.createElement('div');divLiDataBind.className='divDataParam form-inline flexCenter';var iptName=document.createElement('input');iptName.setAttribute('type','input');iptName.className='form-control iptName';variable.name&&(iptName.value=variable.name);var iptUnit=document.createElement('input');iptUnit.setAttribute('type','input');iptUnit.className='form-control iptUnit';variable.unit&&(iptUnit.value=variable.unit);var iptScale=document.createElement('input');iptScale.setAttribute('type','input');iptScale.className='form-control iptScale';variable.unit&&(iptScale.value=variable.Scale);var id=variable.data instanceof Array?variable.data[0]:null;var divDs=this.createDataUnitDom(id);var divParamDel=document.createElement('div');divParamDel.className='btnParamDel glyphicon glyphicon-remove';divLiDataBind.appendChild(iptName);divLiDataBind.appendChild(divDs);divLiDataBind.appendChild(iptUnit);divLiDataBind.appendChild(iptScale);divLiDataBind.appendChild(divParamDel);return divLiDataBind;};DataInfoListData.prototype.createDataUnitDom=function createDataUnitDom(id){var divDs=document.createElement('div');divDs.className='divDs grow';var spDs=document.createElement('span');spDs.className='spDs';if(id){divDs.className+=' hasDs';divDs.dataset.id=id;spDs.textContent=AppConfig.datasource.getDSItemById(id).alias===""?AppConfig.datasource.getDSItemById(id).value:AppConfig.datasource.getDSItemById(id).alias;}
divDs.appendChild(spDs);var spTip=document.createElement('span');spTip.className='spDsTip';spTip.innerHTML='\n            <span class=\'spNormalTip glyphicon glyphicon-plus\'></span>\n            <span class=\'spHoverTip\'>\u8BF7\u62D6\u62FD\u6570\u636E\u6E90\u81F3\u6B64</span>\n        ';divDs.appendChild(spTip);var spBtnDel=document.createElement('span');spBtnDel.className='glyphicon glyphicon-remove btnDsDel';divDs.appendChild(spBtnDel);return divDs;};DataInfoListData.prototype.attachEvent=function attachEvent(){$(this.widget.dom).off('dragover').on('dragover','.divDs',function(e){e.preventDefault();$(e.currentTarget).addClass('dragover');});$(this.widget.dom).off('dragleave').on('dragleave','.divDs',function(e){e.preventDefault();$(e.currentTarget).removeClass('dragover');});$(this.widget.dom).off('drop').on('drop','.divDs',function(e){e.preventDefault();$(e.currentTarget).removeClass('dragover').addClass('hasDs');var id=EventAdapter.getData().dsItemId;e.currentTarget.dataset.id=id;$(e.currentTarget).find('.spDs').text(AppConfig.datasource.getDSItemById(id).alias===""?AppConfig.datasource.getDSItemById(id).value:AppConfig.datasource.getDSItemById(id).alias);});$(this.widget.dom).off('click').on('click','.btnDsDel',function(e){$(e.currentTarget).parent().removeClass('hasDs');delete e.currentTarget.dataset.id;$(e.currentTarget).find('.spDs').text('');});$(this.widget.dom).on('click','.btnParamDel',function(e){$(e.currentTarget).parent().remove();});};DataInfoListData.prototype.getData=function getData(){var arrParamDom=this.widget.dom.querySelectorAll('.divDataParam');this.store=[];var name,unit,id,scale;var nameDom,unitDom,dsDom,scaleDom;for(var i=0;i<arrParamDom.length;i++){nameDom=arrParamDom[i].querySelector('.iptName');unitDom=arrParamDom[i].querySelector('.iptUnit');dsDom=arrParamDom[i].querySelector('.divDs');scaleDom=arrParamDom[i].querySelector('.iptScale');name=nameDom.value?nameDom.value:'';unit=unitDom.value?unitDom.value:'';scale=scaleDom.value?scaleDom.value:'';id=dsDom.dataset.id?dsDom.dataset.id:'';this.store.push({name:name,unit:unit,data:id,scale:scale});}
return this.store;};return DataInfoListData;}(BaseDataWidget);var MultiDataConfigData=function(_BaseDataWidget3){_inherits(MultiDataConfigData,_BaseDataWidget3);function MultiDataConfigData(objModal,widget,area){var opt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,MultiDataConfigData);return _possibleConstructorReturn(this,_BaseDataWidget3.call(this,objModal,widget,area,opt));}
MultiDataConfigData.prototype.initData=function initData(){this.store=[];for(var i=0;i<this.widget.opt.variable.length;i++){this.store.push(this.widget.opt.variable[i]);}};MultiDataConfigData.prototype.createTitleDom=function createTitleDom(title){var opt=title?title:{};var divTitle=document.createElement('div');divTitle.className='divRoleConfigTtl clearfix';var label=document.createElement('label');label.className='divTitleLabel';label.innerHTML='';var dataTitleName=document.createElement('div');dataTitleName.className='divDataTitleName';dataTitleName.innerHTML='';var iptTtl=document.createElement('input');iptTtl.className='iptRoleTtl form-control';iptTtl.setAttribute('type','text');iptTtl.setAttribute('placeholder','');if(opt.text)iptTtl.value=opt.text;var dataSource=this.createDataUnitDom(opt.data);var iptUnit=document.createElement('input');iptUnit.className='iptRoleTtlUnit form-control';iptUnit.setAttribute('placeholder','');if(opt.unit)iptUnit.value=opt.unit;var iptScale=document.createElement('input');iptScale.className='iptRoleTtlScale form-control';iptScale.setAttribute('placeholder','');if(opt.scale)iptScale.value=opt.scale;divTitle.appendChild(label);divTitle.appendChild(iptTtl);divTitle.appendChild(dataTitleName);divTitle.appendChild(dataSource);divTitle.appendChild(iptUnit);divTitle.appendChild(iptScale);return divTitle;};MultiDataConfigData.prototype.createWidgetDom=function createWidgetDom(opt){var divMultiRoleWorkSpace=document.createElement('div');divMultiRoleWorkSpace.className='divMultiDataWorkSpace';for(var i=0;i<opt.variable.length;i++){divMultiRoleWorkSpace.appendChild(this.createRoleList(opt.variable[i]));}
if(opt.variable.length==0)divMultiRoleWorkSpace.appendChild(this.createRoleList());return divMultiRoleWorkSpace;};MultiDataConfigData.prototype.createRoleList=function createRoleList(){var opt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var divRoleList=document.createElement('div');divRoleList.className='divRoleConfig';divRoleList.appendChild(this.createTitleDom(opt.title));divRoleList.appendChild(this.createDataList(opt.param));return divRoleList;};MultiDataConfigData.prototype.createDataList=function createDataList(opt){var divDataBindList=document.createElement('div');divDataBindList.className='divDataBindList';var divParamAdd=document.createElement('div');divParamAdd.className='divBtnAddParam glyphicon glyphicon-plus glyphiconPlus';var _this=this;divDataBindList.appendChild(this.createDataListTtl());divParamAdd.onclick=function(){divDataBindList.appendChild(_this.createLiData({}));};divDataBindList.appendChild(divParamAdd);if(opt instanceof Array&&opt.length>0){for(var i=0;i<opt.length;i++){divDataBindList.appendChild(this.createLiData(opt[i]));}}else{divDataBindList.appendChild(_this.createLiData({}));}
return divDataBindList;};MultiDataConfigData.prototype.createDataListTtl=function createDataListTtl(){var divTtl=document.createElement('div');divTtl.className='divDataListTtl flexCenter';var type;for(var i=0;i<this.widget.opt.param.length;i++){type=this.widget.opt.param[i].type;type=type[0].toUpperCase()+type.slice(1);divTtl.innerHTML+='\n                <span class="spDataListTtl spDataList'+type+'Ttl">'+this.widget.opt.param[i].name+'</span>\n            ';}
return divTtl;};MultiDataConfigData.prototype.createLiData=function createLiData(){var variable=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var divLiDataBind=document.createElement('div');divLiDataBind.className='divDataParam form-inline flexCenter';var paramDom,param;for(var i=0;i<this.widget.opt.param.length;i++){param=this.widget.opt.param[i].type;if(param=='data'){var id=typeof variable.data=="string"?variable.data:null;divLiDataBind.appendChild(this.createDataUnitDom(id));continue;}
paramDom=document.createElement('input');paramDom.setAttribute('type','input');paramDom.dataset.param=param;paramDom.className='form-control iptParam ipt'+param[0].toUpperCase()+param.slice(1);variable[param]&&(paramDom.value=variable[param]);divLiDataBind.appendChild(paramDom);}
var divParamDel=document.createElement('div');divParamDel.className='btnParamDel glyphicon glyphicon-remove';divLiDataBind.appendChild(divParamDel);return divLiDataBind;};MultiDataConfigData.prototype.createDataUnitDom=function createDataUnitDom(id){var divDs=document.createElement('div');divDs.className='divDs grow';var spDs=document.createElement('span');spDs.className='spDs';if(id){divDs.className+=' hasDs';divDs.dataset.id=id;spDs.textContent=AppConfig.datasource.getDSItemById(id).alias===""?AppConfig.datasource.getDSItemById(id).value:AppConfig.datasource.getDSItemById(id).alias;}
divDs.appendChild(spDs);var spTip=document.createElement('span');spTip.className='spDsTip';spTip.innerHTML='\n            <span class=\'spNormalTip glyphicon glyphicon-plus\'></span>\n            <span class=\'spHoverTip\'>\u8BF7\u62D6\u62FD\u6570\u636E\u6E90\u81F3\u6B64</span>\n        ';divDs.appendChild(spTip);var spBtnDel=document.createElement('span');spBtnDel.className='glyphicon glyphicon-remove btnDsDel';divDs.appendChild(spBtnDel);return divDs;};MultiDataConfigData.prototype.attachEvent=function attachEvent(){$(this.widget.dom).off('dragover').on('dragover','.divDs',function(e){e.preventDefault();$(e.currentTarget).addClass('dragover');});$(this.widget.dom).off('dragleave').on('dragleave','.divDs',function(e){e.preventDefault();$(e.currentTarget).removeClass('dragover');});$(this.widget.dom).off('drop').on('drop','.divDs',function(e){e.preventDefault();$(e.currentTarget).removeClass('dragover').addClass('hasDs');var id=EventAdapter.getData().dsItemId;e.currentTarget.dataset.id=id;$(e.currentTarget).find('.spDs').text(AppConfig.datasource.getDSItemById(id).alias===""?AppConfig.datasource.getDSItemById(id).value:AppConfig.datasource.getDSItemById(id).alias);});$(this.widget.dom).off('click').on('click','.btnDsDel',function(e){$(e.currentTarget).parent().removeClass('hasDs');delete e.currentTarget.parentNode.dataset.id;$(e.currentTarget).parent().find('.spDs').text('');});$(this.widget.dom).on('click','.btnParamDel',function(e){$(e.currentTarget).parent().remove();});};MultiDataConfigData.prototype.getData=function getData(){var arrRoleDom=this.widget.dom.querySelectorAll('.divRoleConfig');this.store=[];var arrDivParamDom,dsDom,arrParamDom,divRoleTtl;var dictParam=[];var roleConfig={title:{},param:[]};var id;for(var i=0;i<arrRoleDom.length;i++){roleConfig={title:{},param:[]};divRoleTtl=arrRoleDom[i].querySelector('.divRoleConfigTtl');roleConfig.title.text=divRoleTtl.querySelector('.iptRoleTtl').value;roleConfig.title.data=divRoleTtl.querySelector('.divDs').dataset.id;roleConfig.title.unit=divRoleTtl.querySelector('.iptRoleTtlUnit').value;roleConfig.title.scale=divRoleTtl.querySelector('.iptRoleTtlScale').value;if(!roleConfig.title.data)roleConfig.title.data='';arrDivParamDom=arrRoleDom[i].querySelectorAll('.divDataParam');for(var j=0;j<arrDivParamDom.length;j++){dictParam={};dsDom=arrDivParamDom[j].querySelector('.divDs');arrParamDom=arrDivParamDom[j].querySelectorAll('.iptParam');for(var k=0;k<arrParamDom.length;k++){dictParam[arrParamDom[k].dataset.param]=arrParamDom[k].value;}
id=dsDom.dataset.id?dsDom.dataset.id:'';dictParam.data=id;roleConfig.param.push(dictParam);}
this.store.push(roleConfig);}
return this.store;};return MultiDataConfigData;}(BaseDataWidget);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var BaseFooterWidget=function(_BaseConfigWidget){_inherits(BaseFooterWidget,_BaseConfigWidget);function BaseFooterWidget(objModal,widget,area){_classCallCheck(this,BaseFooterWidget);return _possibleConstructorReturn(this,_BaseConfigWidget.call(this,objModal,widget,area));}
BaseFooterWidget.prototype.setWidget=function setWidget(){this.widget.dom=document.createElement('div');this.widget.dom.className='cfgWidget cfgFooterWidget div'+this.upperCaseText(this.widget.type);this.widget.dom.setAttribute('type',this.widget.type);this.initWidgetLabel();this.initWidgetAttr();this.initWidgetStyle();this.initWidgetId();this.widget.dom.appendChild(this.createWidgetDom(this.widget.opt));this.area.dom.appendChild(this.widget.dom);};return BaseFooterWidget;}(BaseConfigWidget);var ConfirmFooter=function(_BaseFooterWidget){_inherits(ConfirmFooter,_BaseFooterWidget);function ConfirmFooter(objModal,widget,area){_classCallCheck(this,ConfirmFooter);var _this3=_possibleConstructorReturn(this,_BaseFooterWidget.call(this,objModal,widget,area));_this3.defaultOpt={type:'confirm',name:'',opt:{needLabel:false}};return _this3;}
ConfirmFooter.prototype.createWidgetDom=function createWidgetDom(opt){var btnConfirm=document.createElement('button');btnConfirm.className='btn btn-primary btnConfirm';btnConfirm.textContent=this.widget.name;return btnConfirm;};ConfirmFooter.prototype.setData=function setData(data){this.store=data;};ConfirmFooter.prototype.attachEvent=function attachEvent(){if(typeof this.widget.func=='function'){var _this=this;this.widget.dom.onclick=function(e){var result=_this.objModal.getResult();_this.widget.func(result,_this.objModal.opt.data);};}};return ConfirmFooter;}(BaseFooterWidget);var CancelFooter=function(_BaseFooterWidget2){_inherits(CancelFooter,_BaseFooterWidget2);function CancelFooter(objModal,widget,area){_classCallCheck(this,CancelFooter);var _this4=_possibleConstructorReturn(this,_BaseFooterWidget2.call(this,objModal,widget,area));_this4.defaultOpt={type:'cancel',name:'',opt:{needLabel:false}};return _this4;}
CancelFooter.prototype.createWidgetDom=function createWidgetDom(opt){var btnCancel=document.createElement('button');btnCancel.className='btn btn-default btnCancel';btnCancel.textContent=this.widget.name;btnCancel.dataset.dismiss='modal';return btnCancel;};CancelFooter.prototype.attachEvent=function attachEvent(){var _this=this;if(typeof this.widget.func=='function'){this.widget.dom.onclick=function(e){_this.widget.func(e);};}else{this.widget.dom.onclick=function(e){_this.objModal.hide();};}};return CancelFooter;}(BaseFooterWidget);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var BaseConfigModule=function(){function BaseConfigModule(objModal,area){_classCallCheck(this,BaseConfigModule);this.objModal=objModal;this.area=area;this.store={};}
BaseConfigModule.prototype.init=function init(){this.initOption();this.initOptionDetail();this.initData();this.initStyle();this.attachEvent();};BaseConfigModule.prototype.attachEvent=function attachEvent(){};BaseConfigModule.prototype.initStyle=function initStyle(){if(this.area.style){this.objModal.modalStyle.innerHTML+=this.area.style;}};BaseConfigModule.prototype.initOption=function initOption(){if(this.defaultOpt){$.extend(true,this.area,this.defaultOpt,this.area);}};BaseConfigModule.prototype.initOptionDetail=function initOptionDetail(){};BaseConfigModule.prototype.initData=function initData(){};BaseConfigModule.prototype.getData=function getData(){var store;for(var i=0;i<this.area.widget.length;i++){store=this.area.widget[i].instantiation.getData();store&&(this.store[this.area.widget[i].type]=store);}
return this.store;};BaseConfigModule.prototype.destroy=function destroy(){for(var i=0;i<this.area.widget.length;i++){this.area.widget[i].instantiation.destroy();this.area.widget[i].instantiation=null;}};return BaseConfigModule;}();var TimeConfigModule=function(_BaseConfigModule){_inherits(TimeConfigModule,_BaseConfigModule);function TimeConfigModule(objModal,area){_classCallCheck(this,TimeConfigModule);var _this=_possibleConstructorReturn(this,_BaseConfigModule.call(this,objModal,area));_this.defaultOpt={name:'option',type:'option',module:'timeConfig',widget:[{type:'mode',subWidget:[{type:'interval',callback:function callback(type,store){if(type=='mode'){switch(store.val){case'0':$(this.widget.dom).hide();break;default:$(this.widget.dom).show();break;}}}},{type:'recentTimeCustom',callback:function callback(type,store){if(type=='mode'){switch(store.val){case'2':$(this.widget.dom).show();break;default:$(this.widget.dom).hide();break;}}}},{type:'recentTime',callback:function callback(type,store){if(type=='mode'){switch(store.val){case'0':$(this.widget.dom).show();break;default:$(this.widget.dom).hide();break;}}}},{type:'date',callback:function callback(type,store){if(type=='mode'){switch(store.val){case'1':$(this.widget.dom).show();break;default:$(this.widget.dom).hide();break;}}}}]},{type:'recentTimeCustom',subWidget:[{type:'interval',callback:function callback(type,store){if(type=='recentTimeCustom'){if(this.area.dom.querySelector('.divMode>select').value!='2')return;var firstSelect,secondSelect;switch(store.unit){case'second':firstSelect='m5';secondSelect='m1';break;case'minute':firstSelect='m5';secondSelect='m1';break;case'hour':firstSelect='h1';secondSelect='m5';break;case'day':firstSelect='d1';secondSelect='h1';break;case'month':firstSelect='M1';secondSelect='d1';break;}
$(this.widget.dom).find('option').hide();this.widget.dom.querySelector('select').value=firstSelect;$(this.widget.dom.querySelector('[value='+firstSelect+']')).show();$(this.widget.dom.querySelector('[value='+secondSelect+']')).show();this.widget.data={val:firstSelect};this.widget.instantiation.initData();}}}]},{type:'recentTime',subWidget:[{type:'interval',callback:function callback(type,store){if(type!='recentTime')return;if(this.area.dom.querySelector('.divMode>select').value!='0')return;var interval;switch(store.val){case'today':interval='h1';break;case'yesterday':interval='h1';break;case'thisWeek':interval='d1';break;case'lastWeek':interval='d1';break;case'thisYear':interval='M1';break;}
this.widget.dom.querySelector('select').value=interval;this.widget.data={val:interval};this.widget.instantiation.initData();}}]},{type:'interval'},{type:'date',subWidget:[{type:'interval',callback:function callback(){if(this.area.dom.querySelector('.divMode>select').value!='1')return;$(this.widget.dom).find('option').show();}}]}]};return _this;}
TimeConfigModule.prototype.initOptionDetail=function initOptionDetail(){if(!this.area.opt)return;for(var i=0;i<this.area.widget.length;i++){if(!this.area.widget[i].opt)this.area.widget[i].opt={};if(this.area.opt.recentTime&&this.area.widget[i].type=='recentTime'){this.area.widget[i].opt.option=this.area.opt.recentTime;}}};TimeConfigModule.prototype.initData=function initData(){if(!this.area.data)return;var data;for(var i=0;i<this.area.widget.length;i++){data=undefined;switch(this.area.widget[i].type){case'mode':if(typeof this.area.data.mode!='undefined')data={val:this.area.data.mode};break;case'interval':if(typeof this.area.data.interval!='undefined')data={val:this.area.data.interval};break;case'recentTime':if(typeof this.area.data.timeRecent=='string')data=this.area.data.timeRecent;break;case'recentTimeCustom':if(['undefined','string'].indexOf(_typeof(this.area.data.timeRecent))==-1)data=this.area.data.timeRecent;break;case'date':if(this.area.data.timeStart||this.area.data.timeEnd){data={};this.area.data.timeStart&&(data.timeStart=this.area.data.timeStart);this.area.data.timeEnd&&(data.timeEnd=this.area.data.timeEnd);}
break;}
if(typeof data!='undefined')this.area.widget[i].data=data;}};TimeConfigModule.prototype.getData=function getData(){for(var i=0;i<this.area.widget.length;i++){this.store[this.area.widget[i].type]=this.area.widget[i].instantiation.getData();}
var result={};if(this.store.mode.val=='0'){result={timeRecent:this.store.recentTime.recentTime};}else if(this.store.mode.val=='1'){result={timeStart:this.store.date.timeStart,timeEnd:this.store.date.timeEnd};}else if(this.store.mode.val=='2'){result={timeRecent:{unit:this.store.recentTimeCustom.unit,val:this.store.recentTimeCustom.val}};}
result.mode=this.store.mode.val;result.interval=this.store.interval.val;return result;};return TimeConfigModule;}(BaseConfigModule);var DataSourceDragModule=function(_BaseConfigModule2){_inherits(DataSourceDragModule,_BaseConfigModule2);function DataSourceDragModule(objModal,area){_classCallCheck(this,DataSourceDragModule);var _this2=_possibleConstructorReturn(this,_BaseConfigModule2.call(this,objModal,area));_this2.defaultOpt={name:'datasource',type:'datasource',module:'dsDrag',widget:[{type:'datasource',opt:{variable:[{type:'x',name:'X',data:[]},{type:'y',name:'Y',data:[]}]}}]};return _this2;}
DataSourceDragModule.prototype.initData=function initData(){if(!this.area.data)return;for(var i=0;i<this.area.widget.length;i++){if(this.area.widget[i].type=='datasource'){this.area.widget[i].opt.variable=this.area.data;break;}}};DataSourceDragModule.prototype.getData=function getData(){for(var i=0;i<this.area.widget.length;i++){this.store[this.area.widget[i].type]=this.area.widget[i].instantiation.getData();}
var points=[],cog=[];var arrDsParam=Object.keys(this.store['datasource']);for(var _i=0;_i<arrDsParam.length;_i++){points.push(this.store['datasource'][arrDsParam[_i]].data);cog.push(this.store['datasource'][arrDsParam[_i]].cog);}
return{points:points,chartCog:cog};};return DataSourceDragModule;}(BaseConfigModule);var DataInfoListModule=function(_BaseConfigModule3){_inherits(DataInfoListModule,_BaseConfigModule3);function DataInfoListModule(objModal,area){_classCallCheck(this,DataInfoListModule);var _this3=_possibleConstructorReturn(this,_BaseConfigModule3.call(this,objModal,area));_this3.defaultOpt={name:'dataInfoList',type:'dataInfoList',module:'dataInfoList',style:'\n                .divDataBindList .glyphicon {\n                    cursor:pointer;\n                }\n                .divDiaTitle{\n                    display: block;\n                    padding: 0;\n                    margin-top: -15px;\n                }\n                .modal-body .col-xs-2 {\n                    font-size: 16px;\n                    font-weight: bold;\n                    line-height: 34px;\n                    text-align: left;\n                    width:16.6666667%;\n                }\n                .col-xs-10{\n                    width:83.3333333%;\n                }\n                .divBtnAddParam{\n                    margin-top: 20px;\n                    left: 542px;\n                    top:20px;\n                }\n                .divBtnAddContent{\n                    left: 95%;\n                    top: -37px;\n                }\n                .divDataListTtl {\n                    font-size: 16px;\n                    margin-bottom: 20px;\n                    padding-right: 5%;\n                }\n                .spDataListTtl {\n                    width: 39%;\n                    text-align: center;\n                }\n                .spDataListNameTtl {\n                    width: 26%;\n                }\n                .spDataListUnitTtl {\n                    width: 20%;\n                }\n                .spDataListScaleTtl{\n                    width:16%;\n                }\n                .spDataListDsTtl {\n                    width: 41%;\n                }\n                .divDataParam {\n                    margin-bottom:1%;\n                }\n                .divDataParam .form-control {\n                    margin: 0 2%;\n                }\n                .divDataParam .iptName {\n                    width:26%;\n                }\n                .divDataParam .iptUnit {\n                    width:16%;\n                }\n                .divDataParam .iptScale{\n                    width:16%;\n                }\n                .divDataParam .divDs  {\n                    margin: 0 2%;\n                    width: 41%;\n                    text-align: center;\n                    color: #ccc;\n                    border: 1px dashed #ccc;\n                    height: 34px;\n                    display: inline-block;\n                    padding: 6px 15px;\n                    border-radius: 5px;\n                }\n                .divDataParam .divDs:hover  {\n                    border-color: #66afe9;\n                    cursor: pointer;\n                    outline: 0;\n                    -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);\n                    box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);\n                }\n                .divDataParam .divDs.hasDs  {\n                    background-color: #fff;\n                    border: 1px solid #dcdcdc;\n                    color: #4c9f42;\n                    border-radius: 5px;\n                }\n                .divDataParam .divDs.hasDs:hover  {\n                    cursor: pointer;\n                    outline: 0;\n                    -webkit-box-shadow: none;\n                    box-shadow: none;\n                }\n                .divDataParam .divDs .spDs{\n                    display:none;\n                    white-space: nowrap;\n                    text-overflow: ellipsis;\n                    overflow: hidden;\n                    width: 90%;\n                }\n                .divDataParam .divDs .btnDsDel{\n                    display:none;\n                    top: 2px;\n                    color: #ccc;\n                    float: right;\n                }\n                .divDataParam .divDs .spHoverTip{\n                    display:none;\n                }\n                .divDataParam .divDs:hover .spNormalTip  {\n                    display:none;\n                }\n                .divDataParam .divDs:hover .spHoverTip  {\n                    display:inline-block;\n                }\n                .divDataParam .divDs.hasDs .btnDsDel  {\n                    display:inline-block;\n                }\n                .divDataParam .divDs.hasDs:hover .btnDsDel  {\n                    color: darkorange;\n                }\n                .divDataParam .divDs.hasDs .spDsTip {\n                    display:none;\n                }\n                .divDataParam .divDs.hasDs .spDs {\n                    display:inline-block;\n                }\n                .btnParamDel {\n                    width: 4%;\n                }\n                .glyphiconPlus{\n                    position:relative;\n                    top:-16px;\n                }\n            ',widget:[{type:'dataInfoList',opt:{variable:[{name:'',unit:'',data:[]}]}}]};return _this3;}
DataInfoListModule.prototype.initData=function initData(){if(!this.area.data)return;for(var i=0;i<this.area.widget.length;i++){if(this.area.widget[i].type=='dataInfoList'){this.area.widget[i].opt.variable=this.area.data;break;}}};DataInfoListModule.prototype.getData=function getData(){for(var i=0;i<this.area.widget.length;i++){this.store[this.area.widget[i].type]=this.area.widget[i].instantiation.getData();}
return{dataInfoList:this.store['dataInfoList']};};return DataInfoListModule;}(BaseConfigModule);var MultiDataConfigModule=function(_BaseConfigModule4){_inherits(MultiDataConfigModule,_BaseConfigModule4);function MultiDataConfigModule(objModal,area){_classCallCheck(this,MultiDataConfigModule);var _this4=_possibleConstructorReturn(this,_BaseConfigModule4.call(this,objModal,area));_this4.defaultOpt={name:'multiDataConfig',type:'multiDataConfig',module:'multiDataConfig',widget:[{type:'multiDataConfig',opt:{role:'',variable:[],param:[{'type':'name','name':''},{'type':'data','name':''},{'type':'unit','name':''}]}}]};return _this4;}
MultiDataConfigModule.prototype.initData=function initData(){if(!this.area.data)return;for(var i=0;i<this.area.widget.length;i++){if(this.area.widget[i].type=='multiDataConfig'){if(!this.area.data)break;this.area.widget[i].opt.variable=this.area.data.variable?this.area.data.variable:[];this.area.data.param&&(this.area.widget[i].opt.param=this.area.data.param);break;}}};MultiDataConfigModule.prototype.getData=function getData(){for(var i=0;i<this.area.widget.length;i++){this.store[this.area.widget[i].type]=this.area.widget[i].instantiation.getData();}
return{dataInfoList:this.store['multiDataConfig']};};return MultiDataConfigModule;}(BaseConfigModule);var RealTimeConfigModule=function(_BaseConfigModule5){_inherits(RealTimeConfigModule,_BaseConfigModule5);function RealTimeConfigModule(objModal,area){_classCallCheck(this,RealTimeConfigModule);var _this5=_possibleConstructorReturn(this,_BaseConfigModule5.call(this,objModal,area));_this5.defaultOpt={type:'realTime',module:'realTime',widget:[{type:'refreshInterval'}],style:''};return _this5;}
return RealTimeConfigModule;}(BaseConfigModule);var GaugeConfigModule=function(_BaseConfigModule6){_inherits(GaugeConfigModule,_BaseConfigModule6);function GaugeConfigModule(objModal,area){_classCallCheck(this,GaugeConfigModule);var _this6=_possibleConstructorReturn(this,_BaseConfigModule6.call(this,objModal,area));_this6.defaultOpt={type:'gauge',module:'gauge',style:'',widget:[{type:'select',opt:{option:[{val:'high',name:''},{val:'low',name:''}]},subWidget:[{type:'range',callback:function callback(type,store){var iptGrp=this.widget.dom.querySelector('.input-group');if(store.val=='high'){iptGrp.insertBefore(iptGrp.querySelector('.gaugeGreen'),iptGrp.querySelectorAll('input')[1]);iptGrp.insertBefore(iptGrp.querySelector('.gaugeRed'),iptGrp.querySelectorAll('input')[3]);}else if(store.val=='low'){iptGrp.insertBefore(iptGrp.querySelector('.gaugeGreen'),iptGrp.querySelectorAll('input')[3]);iptGrp.insertBefore(iptGrp.querySelector('.gaugeRed'),iptGrp.querySelectorAll('input')[1]);}}}]},{type:'range',opt:{input:[{val:'',suffix:{text:'',style:{background:'lightseagreen'},cls:'gaugeGreen'}},{val:'',suffix:{text:'',style:{background:'#428bca'},cls:'gaugeBlue'}},{val:'',suffix:{text:'',style:{background:'#ff6c60'},cls:'gaugeRed'}},{val:''}]}}]};return _this6;}
GaugeConfigModule.prototype.initData=function initData(){if(!this.area.data)return;for(var i=0;i<this.area.widget.length;i++){if(this.area.widget[i].type=='select'){this.area.widget[i].opt.data=this.area.data.mode;}
if(this.area.widget[i].type=='range'){if(!(this.area.data.range instanceof Array&&this.area.data.range.length>=3))continue;this.area.widget[i].opt.input=[{val:this.area.data.range[0],suffix:{text:'',style:{background:'lightseagreen'},cls:'gaugeGreen'}},{val:this.area.data.range[1],suffix:{text:'',style:{background:'#428bca'},cls:'gaugeBlue'}},{val:this.area.data.range[2],suffix:{text:'',style:{background:'#ff6c60'},cls:'gaugeRed'}},{val:this.area.data.range[3]}];}}};GaugeConfigModule.prototype.getData=function getData(){for(var i=0;i<this.area.widget.length;i++){this.store[this.area.widget[i].type]=this.area.widget[i].instantiation.getData();}
return this.store;};return GaugeConfigModule;}(BaseConfigModule);var BaseFooterModule=function(_BaseConfigModule7){_inherits(BaseFooterModule,_BaseConfigModule7);function BaseFooterModule(objModal,area){_classCallCheck(this,BaseFooterModule);var _this7=_possibleConstructorReturn(this,_BaseConfigModule7.call(this,objModal,area));_this7.defaultOpt={type:'footer',module:'footer',widget:[{type:'cancel',func:function func(){}},{type:'confirm',func:function func(){}}]};return _this7;}
return BaseFooterModule;}(BaseConfigModule);var FactoryTplFooterModule=function(_BaseFooterModule){_inherits(FactoryTplFooterModule,_BaseFooterModule);function FactoryTplFooterModule(objModal,area){_classCallCheck(this,FactoryTplFooterModule);var _this8=_possibleConstructorReturn(this,_BaseFooterModule.call(this,objModal,area));_this8.defaultOpt={type:'footer',module:'factoryTplFooter',widget:[{type:'cancel'},{type:'confirm',func:_this8.createWidgetTpl}]};return _this8;}
FactoryTplFooterModule.prototype.createWidgetTpl=function createWidgetTpl(opt,data){if(!data.tpl.tplJs)return;var event=data.event;var painter=data.painter;var entity,pos;if(!data.entity){entity=THtml.prototype.createEntity();var model;entity._id=ObjectId();entity.layerId='';pos={x:event.layerX,y:event.layerY};entity.x=pos.x-50;entity.y=pos.y-25;entity.w=400;entity.h=400;entity.widgetTpl={config:data.tpl.config,tplJs:data.tpl.tplJs};data.tpl.tplJs&&eval(data.tpl.tplJs);model=new NestedModel(entity);painter.store.widgetModelSet.append(model);}else{var objEntity=data.entity;entity={};entity.widgetTpl={config:data.tpl.config,tplJs:data.tpl.tplJs};data.tpl.tplJs&&eval(data.tpl.tplJs);objEntity.property('widgetTpl');objEntity.update({'widgetTpl':entity.widgetTpl});objEntity.option($.extend(false,{},entity.option,{'html':entity.option.html,'css':entity.option.css,'js':entity.option.js}));}
painter.setActiveWidgets(entity._id);this.instantiation.objModal.hide();};return FactoryTplFooterModule;}(BaseFooterModule);var ColorConfigModule=function(_BaseConfigModule8){_inherits(ColorConfigModule,_BaseConfigModule8);function ColorConfigModule(objModal,area){_classCallCheck(this,ColorConfigModule);var _this9=_possibleConstructorReturn(this,_BaseConfigModule8.call(this,objModal,area));_this9.defaultOpt={name:'option',type:'option',module:'colorConfig',widget:[{type:'select',opt:{option:[{val:'transparent',name:''},{val:'#ffffff',name:''},{val:'#000000',name:''},{val:'#337ab7',name:''},{val:'#5cb85c',name:''},{val:'custom',name:''}],attr:{class:'col-xs-4 inlineBlock selBgColor'}},subWidget:[{'type':'color',callback:function callback(type,store){var iptBgColor=this.area.dom.querySelector('.iptBgColor input');var iptBgColorCfg=this.area.dom.querySelector('.iptBgColor');var bgColorView=this.area.dom.querySelector('.bgColorView input');switch(store.val){case'transparent':bgColorView.style.display='none';iptBgColorCfg.style.display='none';break;case'custom':iptBgColorCfg.style.display='inline-block';iptBgColor.value='';iptBgColor.focus();break;default:bgColorView.style.display='inline-block';bgColorView.value=store.val;iptBgColor.value=store.val;iptBgColorCfg.style.display='none';break;}}}],name:''},{type:'text',opt:{attr:{class:'col-xs-3 iptBgColor',placeholder:'#ffffff'}},subWidget:[{'type':'text',callback:function callback(type,store){var reg=/^#[0-9a-fA-F]{6}$/;var bgColorView=this.area.dom.querySelector('.bgColorView input');if(reg.test(store.val)){bgColorView.value=store.val;}}}],name:''},{type:'color',name:'',opt:{attr:{class:'col-xs-2 bgColorView'}}}]};return _this9;}
ColorConfigModule.prototype.initData=function initData(){};ColorConfigModule.prototype.getData=function getData(){};ColorConfigModule.prototype.attachEvent=function attachEvent(){};return ColorConfigModule;}(BaseConfigModule);(function(){function HTMLParser(htmlString){var div=document.createElement('div');div.innerHTML=htmlString;return div.firstChild;}
if(window.$){$.extend({deepClone:function deepClone(obj){var type=$.type(obj);if(type==='object'){return $.extend(true,{},obj);}
else if(type==='array'){return $.extend(true,[],obj);}
else{return obj;}}});}
if(!String.prototype.toHexString){String.prototype.toHexString=function(){return this.split('').map(function(row){return'\\'+row.charCodeAt(0).toString(16);}).join('');};}
if(!Array.toMap){Array.toMap=function(arr,key){var map={};arr.forEach(function(row,i){map[row[key]]=row;});return map;};}
if(echarts){echarts.config=echarts.config||{color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500']};}
window.HTMLParser=HTMLParser;})();(function(exports){var Events={addEventListener:function addEventListener(events,fn,context){var _this=this;var e=this.__info||(this.__info={});events=events.split(' ');events.forEach(function(event){var evt;event='event:'+event;evt=e[event]||(e[event]=[]);evt.push(fn,context);});},on:function on(events,fn,context){return this.addEventListener(events,fn,context);},once:function once(event,fn,context){var _this=this;this.addEventListener(event,function ofn(){_this.removeEventListener(event,ofn);fn.apply(context,arguments);},context);},removeEventListener:function removeEventListener(events,fn){var e=this.__info;var rs=null;if(e){events=events.split(' ');events.forEach(function(event){var i;event=e['event:'+event];if(event){i=event.indexOf(fn);if(i>-1){rs=event.splice(i,2)[0]||null;}}});}
return rs;},removeAllListeners:function removeAllListeners(event){var e=this.__info;if(e){delete e['event:'+event];}},listeners:function listeners(event){var e=this.__info;if(e){return e['event:'+event]||[];}
return[];},emit:function emit(event){var e=this.__info;if(e){e=e['event:'+event];if(e&&e.length){for(var i=0,len=e.length;i<len;i+=2){try{e[i].apply(e[i+1],arguments);}catch(_){Log.exception('emit',_);}}
return true;}}
return false;}};exports.Events=Events;})(window);(function(exports){function Model(values){this._values=values||{};this.initialize(this._values);}
Model.prototype=Object.create(Events);void function(){this.constructor=Model;this.initialize=function(o){for(var p in o){if(o.hasOwnProperty(p)){this.property(p);}}};this.property=function(name,value){if(!(name in this)){this[name]=this._makeProperty(name);}
return arguments.length===1?this[name]():this[name](value);};this.removeProperty=function(name){var arr,obj,p,lp;if(!(name in this)){return false;}
delete this[name];arr=name.split('.');lp=arr.pop();obj=this._values;while(p=arr.shift()){obj=obj[p];}delete obj[lp];for(var p in this){if(!this.hasOwnProperty(p)||p.indexOf(name)!==0)continue;delete this[p];}
return true;};this.emit=function(event){Events.emit.apply(this,arguments);};this.delayUpdate=function(fn){var pending=false;var propsPathArr=[];if(this.hasOwnProperty('emit')){try{fn.call(this);}catch(e){Log.error(e);}
return;}
try{this.emit=function(event){if(event==='update'){pending=true;}else{this.__proto__.emit.apply(this,arguments);}};propsPathArr=fn.call(this);}finally{delete this.emit;if(pending){this.emit('update',propsPathArr.join(','));}}};this.update=function(props){var _this=this;this.delayUpdate(function(){var propsPathArr=[];for(var prop in props){if(!(prop in this)){throw new Error(''+prop);}
_this[prop](props[prop]);propsPathArr.push('update.'+prop);}
return propsPathArr;});};this.serialize=function(){return this._values;};this._makeProperty=function(prop){var body='var ov = this._values.{p};if(arguments.length && (v !== ov || Object.prototype.toString.call(v) === "[object Object]") ) {this._values.{p}=v; this.emit("update.{p}"); this.emit("update", \'update.{p}\'); } return ov;';return new Function('v',body.replace(/\{p\}/g,prop));};}.call(Model.prototype);Model.prototype.compose=function(){var models=Array.prototype.slice.apply(arguments).concat(this);return{updateAsReplace:function(customEventName,fn){if(typeof fn!=='function'){return;}
customEventName=customEventName||'customEvent';models.forEach(function(model){model.emit=function(){};});fn.call(this);models.forEach(function(model){delete model.emit;});this.emit(customEventName,models);}.bind(this),update:function(customEventName,fn){if(typeof fn!=='function'){return;}
customEventName=customEventName||'customEvent';fn.call(this);this.emit(customEventName,models);}.bind(this)};};exports.Model=Model;})(window);(function(exports,Model){var class2type={};['Boolean','Number','String','Array','Function','Object','Date','RegExp','Error'].forEach(function(type){class2type['[object '+type+']']=type.toLowerCase();});function getType(o){if(o==null){return o+'';}
var type=Object.prototype.toString.call(o);return class2type[type]||'object';}
function NestedModel(){Model.apply(this,arguments);}
NestedModel.prototype=Object.create(Model.prototype);void function(){this.constructor=NestedModel;this.initialize=function(o,path,k){var keys,currentPath;path=path||[];currentPath=path.slice(0);if(typeof k!=='undefined'){currentPath.push(k);}
if(currentPath.length>0){this.property(currentPath.join('.'));}
if(getType(o)==='object'){keys=Object.keys(o);keys.forEach(function(p){this.initialize(o[p],currentPath,p);},this);}};this._makeProperty=function(prop){var body='var o = this._values, isObj = Object.prototype.toString.call(v) === \'[object Object]\', arr = \'{p}\'.split(\'.\'), n = arr.splice(arr.length-1, 1)[0], path = arr.length ? arr.slice(0) : [], row, ov; while(row = arr.shift()) { o = o[row]; }; ov = o[n]; if(arguments.length && (v !== ov || isObj )) {o[n]=v; if(isObj){this.initialize(v,path,n)};this.emit("update.{p}"); this.emit("update", \'update.{p}\'); } return ov;';return new Function('v',body.replace(/\{p\}/g,prop));};}.call(NestedModel.prototype);exports.NestedModel=NestedModel;})(window,window.Model);(function(exports){function ModelSet(models){this.models=models||[];}
ModelSet.prototype=Object.create(Model.prototype);void function(){this.constructor=ModelSet;this.length=function(){return this.models.length;};this.get=function(index){return this.models[index];};this.forEach=function(fn,ctx){return this.models.forEach(fn,ctx);};this.indexOf=function(model){return this.models.indexOf(model);};this.findByProperty=function(name,value){var models=this.models;for(var i=0,len=models.length;i<len;i++){if(models[i][name]()===value){return models[i];}}
return null;};this.findListByProperty=function(name,value){var models=this.models;var rs;rs=models.filter(function(row){if(row[name]()===value){return true;}
return false;});return rs;};this.insertAt=function(idx,model){var count;if(idx<0){idx+=this.models.length+1;}
if(Array.isArray(model)){this.models.splice.apply(this.models,[idx,0].concat(model));count=model.length;}else{this.models.splice(idx,0,model);count=1;model=[model];}
this.emit('insert',{index:idx,count:count,models:model});return count;};this.emit=function(evt){Model.prototype.emit.apply(this,arguments);};this.prepend=function(model){return this.insertAt(0,model);};this.append=function(model){return this.insertAt(-1,model);};this.remove=function(model){var fidx=-1;var count=0;var total=0;var removed=[];if(Array.isArray(model)){model.forEach(function(m){var idx=this.indexOf(m);if(idx===-1)return;total++;if(fidx===-1){fidx=idx;count++;}else if(idx===fidx+count){count++;}else{removed=removed.concat(this.models.splice(fidx,count));fidx=idx<fidx?idx:idx-count;count=1;}},this);if(count){removed=removed.concat(this.models.splice(fidx,count));this.emit('remove',{count:count,models:removed});}}else{var idx=this.indexOf(model);if(idx!==-1){this.models.splice(idx,1);this.emit('remove',{count:1,models:[model]});total=1;}}
return total;};this.removeAll=function(){var len=this.models.length;var removed;if(len){removed=this.models.splice(0,len);this.emit('remove',{count:len,models:removed});return true;}else{return false;}};this.move=function(from,to){var len=this.models.length;var moved=null;while(from<0){from+=len;}
while(to<0){from+=len;}
if(to>=len){while(len++<=to){this.models.push(undefined);}}
moved=this.models.splice(from,1);this.models.splice(to,0,moved[0]);this.emit('move',{from:from,to:to,models:moved});return true;};this.serialize=function(){var ms=[];this.forEach(function(row){ms.push(row.serialize());});return ms;};this.toMap=function(key,returnModelFormat){var map={};for(var i=0,len=this.models.length;i<len;i++){map[this.models[i][key]()]=returnModelFormat?this.models[i]:this.models[i].serialize();}
return map;};}.call(ModelSet.prototype);exports.ModelSet=ModelSet;})(window);(function(){var class2type={};['Boolean','Number','String','Array','Function','Object','Date','RegExp','Error'].forEach(function(type){class2type['[object '+type+']']=type.toLowerCase();});function Diff(kind,path){this.kind=kind;this.path=path||[];};function DiffNew(path,value){Diff.call(this,'N',path);this.rhs=value;};function DiffDelete(path,value){Diff.call(this,'D',path);this.lhs=value;};function DiffEdit(path,origin,value){Diff.call(this,'E',path);this.lhs=origin;this.rhs=value;};function DiffArray(path,index,item){Diff.call(this,'A',path);this.index=index;this.item=item;};function realTypeOf(subject){if(subject==null){return subject+'';}
var type=Object.prototype.toString.call(subject);return class2type[type]||'object';}
function deepDiff(lhs,rhs,changes,process,path,key){var currentPath;var ltype,rtype;var lkeys,rkeys;var rs;path=path||[];currentPath=path.slice(0);if(typeof key!=='undefined'){currentPath.push(key);}
if(typeof process==='function'){rs=process(lhs,rhs,currentPath);if(rs===true){changes(new DiffEdit(currentPath,lhs,rhs));return;}else if(rs===false){return;}}
ltype=realTypeOf(lhs);rtype=realTypeOf(rhs);if(ltype==='undefined'){if(rtype!=='undefined'){changes(new DiffNew(currentPath,rhs));}}else if(rtype==='undefined'){changes(new DiffDelete(currentPath,lhs));}else if(ltype!==rtype){changes(new DiffEdit(currentPath,lhs,rhs));}else if(ltype==='object'){lkeys=Object.keys(lhs);rkeys=Object.keys(rhs);lkeys.forEach(function(k){var other=rkeys.indexOf(k);if(other>=0){deepDiff(lhs[k],rhs[k],changes,process,currentPath,k);rkeys.splice(rkeys.indexOf(k),1);}else{deepDiff(lhs[k],undefined,changes,process,currentPath,k);}});rkeys.forEach(function(k){deepDiff(undefined,rhs[k],changes,process,currentPath,k);});}else if(ltype==='array'){for(var i=0,len=lhs.length;i<len;i++){if(i>=rhs.length){changes(new DiffArray(currentPath,i,new DiffDelete(undefined,lhs[i])));}else{deepDiff(lhs[i],rhs[i],changes,process,currentPath,i);}}
while(i<rhs.length){changes(new DiffArray(currentPath,i,new DiffNew(undefined,rhs[i++])));}}else if(lhs!==rhs){changes(new DiffEdit(currentPath,lhs,rhs));}};function diff(lhs,rhs,process,format,accum){var accum=accum||[];deepDiff(lhs,rhs,function(d){if(d){typeof format==='function'&&format(d);accum.push(d);}},process);return accum.length?accum:null;};window.diff=diff;}).call(this);var DataSource=function(){var _this;function DataSource(parent,opt){_this=this;this.m_parent=parent;this.m_newPointList=[];this.m_allPointList=[];this.m_allGroupList=[];this.m_arrProjIdColorMap={};this.m_dataSourceId;this.m_lang=I18n.resource.dataSource;this.m_selectItemId=0;this.m_selectGroupId=0;this.m_groupIconOpen='/static/images/dataSource/group_head_sel.png';this.m_groupIconClose='/static/images/dataSource/group_head_normal.png';this.m_cfgPanel;this.m_unassigned='unassigned';this.m_langFlag='zh'==localStorage['language']?0:1;this.$dsNavContain=undefined;this.m_curPageNum=1;this.m_arrCloudTableInfo=[];this.disableIot=opt&&opt.disableIot?true:false;this.treeObj=undefined;this.iotFilter=undefined;this.iotOpt={};}DataSource.prototype={show:function show(){var _this=this;Spinner.spin(ElScreenContainer);I18n.fillArea($('#divAnlsDatasourcePane'));I18n.fillArea($('#divEnergyAnlsPane'));_this.loadDataSourceRecord();_this.initContain();_this.initElement();Spinner.stop();},close:function close(){this.m_newPointList=null;this.m_allPointList=null;},initContain:function initContain(){this.initTreeNavStyle();},initTreeNavStyle:function initTreeNavStyle(){WebAPI.get('/static/views/observer/dataSource.html').done(function(resultHtml){_this.$dsNavContain=$(resultHtml);I18n.fillArea(_this.$dsNavContain);var $pageMine=_this.$dsNavContain.find('#pageMine');var $pageCloud=_this.$dsNavContain.find('#pageCloud');var $pageIot=_this.$dsNavContain.find('#pageIot');AppConfig.isFactory&&_this.$dsNavContain.find('#liMine').css('display','none').attr('class','');_this.$dsNavContain.find('#liMine').click(function(e){$('#liMine').attr('class','active');$('#liCloud').attr('class','');$('#liIot').attr('class','');$pageMine.show();$pageCloud.hide();$pageIot.hide();_this.currentObj='mine';});_this.$dsNavContain.find('#liCloud').click(function(e){if(_this.m_arrCloudTableInfo.length<=0){_this.initDsCloud();}$('#liMine').attr('class','');$('#liCloud').attr('class','active');$('#liIot').attr('class','');$pageMine.hide();$pageIot.hide();$pageCloud.show();_this.currentObj='cloud';});if(_this.disableIot){_this.$dsNavContain.find('#liIot').remove();}else{_this.$dsNavContain.find('#liIot').click(function(e){$('#liMine').attr('class','');$('#liCloud').attr('class','');$('#liIot').attr('class','active');$pageMine.hide();$pageIot.html('').show();$pageCloud.hide();_this.initIotFilter();_this.currentObj='iot';});_this.initIotFilter();}_this.initDsMine();$('#dataSrcContain').empty();$('#dataSrcContain').append(_this.$dsNavContain);AppConfig.isFactory&&$('#liCloud').click();var addGroup=$('<div id="dataSrcAddGroup"><input type="text" id="inputAddGroup" placeholder="+ Add group" ></div>');$pageMine.append(addGroup);$('#inputAddGroup').attr('placeholder',I18n.resource.dataSource.ADD_GROUP);$pageMine.keyup(function(e){if(13==e.keyCode){_this.addNewGroup();}});var inputAdd=addGroup.find('#inputAddGroup');inputAdd.attr('placeholder',_this.m_lang.ADD_GROUP);inputAdd.blur(function(e){_this.addNewGroup();});}).always(function(e){});},initIotFilter:function initIotFilter(){var $ctn=_this.$dsNavContain.find('#pageIot');_this.iotFilter=new HierFilter($ctn);_this.iotFilter.init();_this.iotOpt=$.extend(true,{},{base:{divideByProject:true},tree:{show:true,event:{click:[{act:onNodeClick,tar:['groups','projects']},{act:ontThingClick,tar:'things'},{act:function act(){console.log('click things');},tar:'things'}]},drag:{dragstart:[{act:onAttrDragStart,tar:'attrs'},{act:onThingsDragStart,tar:'things'}],dragend:[{act:onAttrDragEnd,tar:'attrs'}]}}},_this.iotOpt);_this.iotFilter.setOption(_this.iotOpt);function onNodeClick(event,treeId,treeNode){if(_this.iotFilter.setDefault===true){if(!treeNode.children||treeNode.children.length==0)return;var node=treeNode.children[0];_this.iotFilter.tree.selectNode(node);_this.iotFilter.tree.setting.callback.onClick({target:document.getElementById(node.tId)},node['_id'],node);_this.iotFilter.setDefault=false;}}function ontThingClick(event,treeId,treeNode){var attrs=_this.iotFilter.dictClass['things'][treeNode.type].attrs;var arrNode=[];var node;for(var pt in treeNode.arrP){if(!attrs[pt])continue;node={'_id':treeNode.arrP[pt],'name':attrs[pt].name,'attrType':pt,'baseType':'attrs'};arrNode.push(node);}if(!treeNode.children||treeNode.children.length==0){_this.iotFilter.tree.addNodes(treeNode,arrNode,true);}}function onThingsDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragEnd(){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');}function onNodeDblClick(event,treeId,treeNode,widget){}},initDsMine:function initDsMine(){var $inputSearch=_this.$dsNavContain.find('#inputDsMineSearch');$inputSearch.keyup(function(e){var searchVal=$(this).val().trim();if(13==e.keyCode&&searchVal){WebAPI.get('/analysis/datasource/searchDsItemInfo/'+AppConfig.userId+'/'+searchVal).done(function(result){var treeMine=_this.$dsNavContain.find('#treeMine');var zSetting={async:{enable:false},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false,nameIsHTML:true},edit:{enable:true,drag:{isCopy:false,isMove:false}},data:{simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove}};function addDiyDom(treeId,treeNode){var $itemLeaf=$('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}function addHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.setHoverColor(treeNode);}}function removeHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.removeHoverColor(treeNode);}}function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){_this.zTreeBeforeRemoveFunc(treeNode);}var zNodes=_this.generateSearchTree(result,searchVal);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,zNodes);$('#dataSrcAddGroup').hide();});}if(!searchVal){_this.initDsMineTree();$('#dataSrcAddGroup').show();}});_this.$dsNavContain.find('#spanDsMineSearch').click(function(e){$inputSearch.val('');_this.initDsMineTree();$('#dataSrcAddGroup').show();});_this.initDsMineTree();$('#dataSrcAddGroup').show();},initDsMineTree:function initDsMineTree(){var zSetting={async:{enable:true,type:'get',url:function url(treeId,treeNode){return'/analysis/datasource/getDsItemInfo/'+AppConfig.userId+'/'+(typeof treeNode==='undefined'?'null':treeNode.id);},dataFilter:dsItemfilter},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false},edit:{enable:true,renameTitle:I18n.resource.dataSource.RENAME,removeTitle:I18n.resource.dataSource.REMOVE,drag:{isCopy:false,isMove:false}},data:{keep:{leaf:true,parent:true},simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove,onAsyncSuccess:zTreeOnAsyncSuccess,onAsyncError:zTreeOnAsyncError,beforeEditName:zTreeBeforEditName}};function zTreeBeforEditName(treeId,treeNode){if(treeNode.note&&treeNode.note!==''&&treeNode.name.indexOf(treeNode.note)>=0){treeNode.name=treeNode.name.split('(')[1].split(')')[0];}}function dsItemfilter(treeId,parentNode,responseData){Spinner.spin(_this.$dsNavContain[8]);return _this.generateTreeEx(responseData);}function addDiyDom(treeId,treeNode){if(treeNode.num){var aObj=_this.$dsNavContain.find("#"+treeNode.tId+"_switch");var $badge=$('<span class="badge treeBadge">'+treeNode.num+'</span>');aObj.next('a').after($badge);}var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});_this.stopBubble(e);});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});EventAdapter.on($itemLeaf,'drop',function(e){var tar=$(e.target);var dstTLi=tar.closest('li');var dstId=dstTLi.eq(0).attr('id');var dstNode=_this.treeObj.getNodeByTId(dstId);var srcId=EventAdapter.getData().dsItemId;var srcJq=$('li[ptid$='+srcId+']');var srcTId=srcJq.eq(0).attr('id');var srcNode=_this.treeObj.getNodeByTId(srcTId);var dstParentId=dstNode.pId;var dstParentJq=$('li[ptid$='+dstParentId+']');var dstParentTId=dstParentJq.eq(0).attr('id');var dstParentNode=_this.treeObj.getNodeByTId(dstParentTId);var srcParentId=srcNode.pId;var srcParentJq=$('li[ptid$='+srcParentId+']');var srcParentTId=srcParentJq.eq(0).attr('id');var srcParentNode=_this.treeObj.getNodeByTId(srcParentTId);var postData={};var arrSrc=[];var arrDst=[];var srcParId=srcNode.pId;var dstParId=dstNode.pId;var saveType=0;if(srcNode.isParent&&!dstNode.isParent){return;}else if(!srcNode.isParent&&!dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){if(srcParId==dstParId){$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});postData[dstParentId]=arrDst;}else{$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstParentNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstParId]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstParId]=arrDst;}}}}else if(!srcNode.isParent&&dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'inner',true)){if(srcParentNode.children){$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});}$.each(dstNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstNode.id]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstNode.id]=arrDst;}}}else if(srcNode.isParent&&dstNode.isParent){saveType=1;var nSrcIdx=srcNode.getIndex();var nDstIdx=dstNode.getIndex();if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){var liGroup=$('#treeMine').children('li');if(liGroup&&liGroup.length>0){postData.groupIdList=[];$.each(liGroup,function(i,n){postData.groupIdList.push($(n).attr('ptid'));});}}}if(0==saveType){WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).always(function(){});}else if(1==saveType){WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).always(function(){});}_this.stopBubble(e);});if(treeNode.id==sessionStorage.getItem('dsOpenGroupId')){sessionStorage.removeItem('dsOpenGroupId');if(treeNode.isParent&&_this.treeObj){_this.treeObj.expandNode(treeNode,true,false,true);}}if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}
function addHoverDom(treeId,treeNode){if(treeNode.isParent){var sObj=$("#"+treeNode.tId+"_span");if(treeNode.editNameFlag||$("#addBtn_"+treeNode.tId).length>0){return;}
if(0==$("#addBtnFormula_"+treeNode.tId).length){var addStr="<span class='iconfont' id='addBtnFormula_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:4px'>&#xe63e;</span>";sObj.after(addStr);var btnGroup=$("#addBtnFormula_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_FORMULA);if(btnGroup)btnGroup.bind("click",function(){if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnPage_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-plus-sign button' id='addBtnPage_"+treeNode.tId+"' title='add point' onfocus='this.blur();' style='margin-left:4px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnPage_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT);if(btnGroup)btnGroup.bind("click",function(){var parentNodes=_this.treeObj.getNodesByParam('id',treeNode.id,null);if(parentNodes.length>0){if(!parentNodes[0].zAsync){_this.treeObj.expandNode(parentNodes[0],true,false,true);}}if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnGroup_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-object-align-bottom button' aria-hidden='true' id='addBtnGroup_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:20px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnGroup_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT_GROUP);if(btnGroup)btnGroup.bind("click",function(){var newName='new group';var postData={'groupId':'','name':newName,'parent':treeNode.id.toString(),'userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return;}var groupId=result.groupId;if(groupId){if(_this.treeObj){if(treeNode.zAsync){_this.treeObj.addNodes(treeNode,{id:result.groupId,pId:result.parentId,name:result.groupName,isParent:true});}else{_this.treeObj.expandNode(treeNode,true,false,true);}}}}).always(function(e){});return false;});}}else{_this.setHoverColor(treeNode);}};function removeHoverDom(treeId,treeNode){$("#addBtnGroup_"+treeNode.tId).unbind().remove();$("#addBtnPage_"+treeNode.tId).unbind().remove();$("#addBtnFormula_"+treeNode.tId).unbind().remove();if(!treeNode.isParent){_this.removeHoverColor(treeNode);}};function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){confirm(I18n.resource.dataSource.DELETE_GROUP_INFO,function(){_this.zTreeBeforeRemoveFunc(treeNode);_this.treeObj.removeNode(treeNode);});return false;}function zTreeOnAsyncSuccess(event,treeId,treeNode,msg){Spinner.stop();};function zTreeOnAsyncError(event,treeId,treeNode,XMLHttpRequest,textStatus,errorThrown){Spinner.stop();};$(document).ready(function(){var treeMine=_this.$dsNavContain.find('#treeMine');var arrInit=_this.generateTreeEx(_this.m_parent.store.group);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,arrInit);});},zTreeBeforeRenameFunc:function zTreeBeforeRenameFunc(treeNode,newName){if(treeNode.isParent){var postData={'groupId':treeNode.id,'name':newName,'parent':Boolean(treeNode.pId)?treeNode.pId.toString():'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var treeNodeNote=treeNode.note?treeNode.note:'';newName=treeNodeNote!==''?treeNodeNote+'('+newName+')':newName;var postData={itemList:[{id:treeNode.id,type:0,projId:treeNode.projId,alias:newName,note:treeNode.note,value:treeNode.value,groupId:treeNode.pId}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){return true;}return false;}).error(function(e){return false;}).always(function(e){treeNode.name=newName;$('#treeMine').find('li[ptid='+treeNode.id+']').find('a span').eq(1).text(newName);});}},zTreeBeforeRemoveFunc:function zTreeBeforeRemoveFunc(treeNode){if(treeNode.isParent){WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+treeNode.id).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);if($itemLeaf&&$itemLeaf.length>0){$itemLeaf.tooltip('destroy');}WebAPI.get('/analysis/datasource/removeSingle/'+treeNode.id).done(function(data){if(!data.success){return false;}else{var parentId=treeNode.pId;var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num-=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}return true;}}).always(function(){});}},generateTreeEx:function generateTreeEx(arr){var result=[];if(!arr){return result;}var params;var unassigned;for(var i=0,len=arr.length;i<len;i++){var item=arr[i];if(item){var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}params={id:item.id,pId:item.parentId,isParent:item.isParent,name:itemName,value:item.value,note:item.note,projId:item.projId,num:item.num,type:item.type};if(!item.isParent){var leafIcon=1==item.type?'ptFormula':'ptNormal';params['iconSkin']=leafIcon;}if('unassigned'==item.alias){unassigned=params;}else{result.push(params);}}}if(unassigned){result.push(unassigned);}return result;},generateSearchTree:function generateSearchTree(arr,searchText){var result=[];var params;for(var id in arr){params={id:id,pId:null,isParent:true,name:arr[id].groupName,value:id,note:'',projId:'',type:0,open:true};result.push(params);if(arr[id].dsList){for(var i=0,len=arr[id].dsList.length;i<len;i++){var item=arr[id].dsList[i];var keyWordName=item.alias;searchText.replace(/[^\w\d\s\u4e00-\u9fa5]/g,' ').split(/\s/g).forEach(function(search_item){if(search_item){keyWordName=keyWordName.replace(new RegExp("("+search_item+")(?![^<]*>|[^<>]*</)","gi"),'<span class="keyword">$1</span>');}});params={id:item.id,pId:id,isParent:false,name:keyWordName,value:item.value,note:item.note,projId:item.projId,type:item.type,iconSkin:1==item.type?'ptFormula':'ptNormal'};result.push(params);}}}return result;},setHoverColor:function setHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','#FFE6B0');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','#000');}$row.find('.edit').css('color','#000');$row.find('.remove').css('color','#000');}},removeHoverColor:function removeHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','');}$row.find('.edit').css('color','');$row.find('.remove').css('color','');}},initDsCloud:function initDsCloud(){var $selPrjName=_this.$dsNavContain.find('#selectPrjName');$selPrjName.empty();var opt;var prjId=AppConfig.project&&AppConfig.project.bindId?AppConfig.project.bindId:AppConfig.projectId;var nSize=AppConfig.projectList.length;var data=AppConfig.projectList.map(function(v,i){if(0==_this.m_langFlag){return{id:v.id,text:v.name_cn};}else{return{id:v.id,text:v.name_english};}});$selPrjName.select2({data:data}).off('change.myChange').on('change.myChange',function(e){var prjId=$('#selectPrjName').find('option:selected').val();_this.initDsCloudTable(prjId,1,50);}).val(prjId).trigger('change');var $inputSearch=_this.$dsNavContain.find('#inputDsCloudSearch');$inputSearch.keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}var size=50;WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:1,pageSize:size,searchText:searchVal}).done(function(result){if(result.success&&result.data){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();_this.setCloudTable(result.data.pointTable);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(1);}}).always(function(e){});}if(''==searchVal){_this.initDsCloudFunc();}});_this.$dsNavContain.find('#spanDsCloudSearch').click(function(e){$inputSearch.val('');_this.initDsCloudFunc();});},initCurPageNum:function initCurPageNum(page){this.m_curPageNum=page;},initDsCloudTable:function initDsCloudTable(prjId,page,size){if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:page,pageSize:size}).done(function(result){if(result.success&&result.data){_this.m_arrCloudTableInfo=result.data.pointTable;_this.setCloudTable(_this.m_arrCloudTableInfo);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(page);}}).always(function(e){Spinner.stop();});},initDsCloudFunc:function initDsCloudFunc(){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();var prjId=_this.$dsNavContain.find('#selectPrjName').val();_this.initDsCloudTable(prjId,1,50);},setCurrentPage:function setCurrentPage(curPageNum,size){curPageNum=parseInt(curPageNum,10);var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:curPageNum,pageSize:size,searchText:_this.$dsNavContain.find('#inputDsCloudSearch').val()}).done(function(result){if(result.success&&result.data){var ptTotal=result.data.pointTotal?result.data.pointTotal:0;var allPageNum=Math.ceil(ptTotal/size);_this.initCurPageNum(curPageNum);var liPageNum=$('#navPageNum').find('.pageNum');if(curPageNum<=3){liPageNum.eq(0).attr('value','1');liPageNum.eq(1).attr('value','2');liPageNum.eq(2).attr('value','3');liPageNum.eq(3).attr('value','4');liPageNum.eq(4).attr('value','5');liPageNum.eq(0).text('1');liPageNum.eq(1).text('2');liPageNum.eq(2).text('3');liPageNum.eq(3).text('4');liPageNum.eq(4).text('5');}else if(curPageNum>=allPageNum-2){liPageNum.eq(0).attr('value',allPageNum-4);liPageNum.eq(1).attr('value',allPageNum-3);liPageNum.eq(2).attr('value',allPageNum-2);liPageNum.eq(3).attr('value',allPageNum-1);liPageNum.eq(4).attr('value',allPageNum);liPageNum.eq(0).text(allPageNum-4);liPageNum.eq(1).text(allPageNum-3);liPageNum.eq(2).text(allPageNum-2);liPageNum.eq(3).text(allPageNum-1);liPageNum.eq(4).text(allPageNum);}else{liPageNum.eq(0).attr('value',curPageNum-2);liPageNum.eq(1).attr('value',curPageNum-1);liPageNum.eq(2).attr('value',curPageNum);liPageNum.eq(3).attr('value',curPageNum+1);liPageNum.eq(4).attr('value',curPageNum+2);liPageNum.eq(0).text(curPageNum-2);liPageNum.eq(1).text(curPageNum-1);liPageNum.eq(2).text(curPageNum);liPageNum.eq(3).text(curPageNum+1);liPageNum.eq(4).text(curPageNum+2);}
for(var i=0,len=liPageNum.length;i<len;i++){var item=liPageNum.eq(i);if(item.attr('value')==curPageNum){item.closest('li').attr('class','active');}else{item.closest('li').removeAttr('class');}}_this.setCloudTable(result.data.pointTable);}}).always(function(e){Spinner.stop();});},setCloudTable:function setCloudTable(ptTable,searchText){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');if($tableBody){$tableBody.empty();for(var i=0,len=ptTable.length;i<len;i++){var $itemTr=$('<tr ptId="'+ptTable[i]._id+'" draggable="true" title="'+ptTable[i].value+' : '+ptTable[i].alias+' "></tr>');var $itemTd=$('<td>');var $itemTdName=$('<span class="tabColName" data-value="'+ptTable[i].value+'">'+ptTable[i].value+'</span>');var $itemTdDesc=$('<span class="tabColDesc"> -- '+ptTable[i].alias+'</span>');var $itemTdIcon=$('<span class="btnFav glyphicon glyphicon-plus-sign" aria-hidden="true"></span>');$itemTdIcon.off().click(function(e){var $row=$(e.currentTarget).closest('tr');var ptId=$row.attr('ptId');for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){if(ptId==_this.m_arrCloudTableInfo[i]._id){_this.insertIntoMineTable(_this.m_arrCloudTableInfo[i]);break;}}});$itemTd.append($itemTdName);$itemTdDesc.append($itemTdIcon);$itemTd.append($itemTdDesc);$itemTr.append($itemTd);var start=null;EventAdapter.on($itemTr,'click',function(e){e=e||event;var $this=$(this);var $tableDsCloud=$('#tableDsCloud');var trArr=$tableDsCloud.find('tr');if(e.ctrlKey){if(!e.shiftKey){if($this.hasClass('activeTr')){$this.removeClass('activeTr');}else{$this.addClass('activeTr');}start=this;}else{var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);if($(start).hasClass('activeTr')){selTr.addClass('activeTr');}else{selTr.removeClass('activeTr');}}}else if(e.shiftKey){if($('.activeTr').length!==0){var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);selTr.addClass('activeTr');trArr.not(selTr).removeClass('activeTr');}else{$this.addClass('activeTr');}}else{trArr.removeClass('activeTr');$this.addClass('activeTr');start=this;}});EventAdapter.on($itemTr,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$('.activeTr').length>1?$('.activeTr'):$(e.target);var targetId=$(e.target).attr('ptid');var dragSrcId=undefined,isDragMore=false,dragId=[];if($('.activeTr').length>1){tar.each(function(i,item){var itemId=$(item).attr('ptid');if(itemId===targetId){isDragMore=true;}dragId.push(itemId);});if(isDragMore){dragSrcId=dragId;}else{dragSrcId=targetId;}}else{dragSrcId=tar.attr('ptid');}
EventAdapter.setData({'dsItemId':dragSrcId});e.originalEvent.dataTransfer.setData('dsItemId',dragSrcId);});EventAdapter.on($itemTr,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemTr,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});$tableBody.append($itemTr);}}},setCloudNav:function setCloudNav(allPageNum){var ul=$('<ul class="pagination">\
                <li><a class="pageFlag" value="First"><span aria-hidden="true">&laquo;</span></a></li>\
                <li><a class="pageFlag" value="Previous"><span aria-hidden="true">&lsaquo;</span></a></li>\
            </ul>');if(allPageNum>5){ul.append('<li class="active"><a class="pageFlag pageNum" value="1">1</a></li>\
                    <li><a class="pageFlag pageNum" value="2">2</a></li>\
                    <li><a class="pageFlag pageNum" value="3">3</a></li>\
                    <li><a class="pageFlag pageNum" value="4">4</a></li>\
                    <li><a class="pageFlag pageNum" value="5">5</a></li>');}else{for(var i=0;i<allPageNum;i++){var numTmp=i+1;if(0==i){ul.append('<li class="active"><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}else{ul.append('<li><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}}}ul.append('<li><a class="pageFlag" value="Next"><span aria-hidden="true">&rsaquo;</span></a></li>\
                        <li><a class="pageFlag" value="Last"><span aria-hidden="true">&raquo;</span></a></li>');var pageFlag=ul.find('.pageFlag');pageFlag.click(function(e){var value=$(e.currentTarget).attr('value');if('First'==value){if(_this.m_curPageNum!=1){_this.setCurrentPage(1,50);}}else if('Previous'==value){if(_this.m_curPageNum>1){_this.setCurrentPage(_this.m_curPageNum-1,50);}}else if('Next'==value){if(_this.m_curPageNum<allPageNum){_this.setCurrentPage(_this.m_curPageNum+1,50);}}else if('Last'==value){if(_this.m_curPageNum!=allPageNum){_this.setCurrentPage(allPageNum,50);}}else{if(_this.m_curPageNum!=value){_this.setCurrentPage(value,50);}}});var $navPage=_this.$dsNavContain.find('#navPageNum');$navPage.empty();$navPage.append(ul);},insertIntoMineTable:function insertIntoMineTable(newNode){var nodeParent=_this.treeObj.getNodesByParam('name','unassigned',null);if(nodeParent.length>0){var postData={itemList:[{type:0,projId:newNode.projId,alias:newNode.value,value:newNode.value,groupId:nodeParent[0].id}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){var item=data.itemIdList[0];var obj={id:item.id,pId:item.groupId,name:item.alias,isParent:false,value:item.value,note:item.note};_this.treeObj.addNodes(nodeParent[0],-1,obj);}}).always(function(e){});}},initElement:function initElement(){var _this=this;var len=AppConfig.projectList.length;var item;if(!(_this.m_parent.arrColor instanceof Array))return;var nColorSize=_this.m_parent.arrColor.length;for(var i=0;i<len;i++){item=AppConfig.projectList[i];_this.m_arrProjIdColorMap[item.id]=_this.m_parent.arrColor[i-parseInt(i/nColorSize)*nColorSize];}EventAdapter.on($('#data_source_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#data_source_formula_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#divAnlsDatasourcePane'),'click',function(e){_this.clearSelect();},false);$('#inputDsSearch').keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){$('#dataSrcPanel').empty();searchVal=searchVal.toLowerCase();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,searchVal);$('#dataSrcAddGroup').hide();}if(''==searchVal){$('#dataSrcPanel').empty();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,'');_this.colapseGroupsDefault();$('#dataSrcAddGroup').show();}});},insertIntoDataList:function insertIntoDataList(customName,ptName,ptDesc,prjName,iconColor,itemId,baseNode,bIsAppend,bIsSelected){var _this=this;var div;if(bIsSelected){div=$('<div draggable="true" class="dsItem grow dsSelected" style="height:34px"></div>');}else{div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');}div.attr('id',itemId);div.click(function(e){_this.clearSelect();var target=$(e.currentTarget);if('dsItem grow'==target.attr('class')){target.attr('class','dsItem grow dsSelected');}else{target.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var custName=$('<div class="dsValue" style="height:36px;">'+customName+'</div>');div.append(custName);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}_this.m_selectItemId=$(e.currentTarget).closest('.dsItem').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM_TIPS,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=data.deleteModal;var len=arr.length;if(len>0){var delMod;var arrDelTitle=[];for(var i=0;i<len;i++){delMod=$('#'+arr[i]);arrDelTitle.push(delMod.find('.newDivPageTitle').val());delMod.remove();}var delTitle=_this.m_lang.WORKSPACE+':';for(var i=0,len=arrDelTitle.length;i<len;i++){delTitle+=arrDelTitle[i]+' ';}delTitle+=_this.m_lang.REMOVE_RESULT;alert(delTitle);}}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var ctlPrjName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.PROJECT_NAME+': '+prjName+'</label></div>');ctlPrjName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPrjName);var ctlPtName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.POINT_NAME+': '+ptName+'</label></div>');ctlPtName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPtName);var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',ptDesc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:0,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);if(bIsAppend){baseNode.append(div);}else{baseNode.after(div);}},initToolTips:function initToolTips(parent,customName,projectName,pointName,pointDesc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:300px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="projectName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.PROJECT_NAME).append('</span>: ').append(projectName).append('</p> ');show.append('        <p class="pointName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_NAME).append('</span>: ').append(pointName).append('</p> ');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(pointDesc).append('</p> ');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var options={placement:'left',title:_this.m_lang.PARAM,template:show.toString(),trigger:'hover'};parent.tooltip(options);},setToolTipsAll:function setToolTipsAll(row,userName,customName,projectName,pointName,pointDesc){var tip=row.data('bs.tooltip').$tip;userName=': '+userName;customName=': '+customName;projectName=': '+projectName;pointName=': '+pointName;pointDesc=': '+pointDesc;tip.find('.userName').text(this.m_lang.USER_NAME+userName);tip.find('.customName').text(this.m_lang.CUSTOM_NAME+customName);tip.find('.projectName').text(this.m_lang.PROJECT_NAME+projectName);tip.find('.pointName').text(this.m_lang.POINT_NAME+pointName);tip.find('.pointDesc').text(this.m_lang.POINT_DESC+pointDesc);},setToolTipsCustomName:function setToolTipsCustomName(row,customName){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').text(this.m_lang.CUSTOM_NAME+': '+customName);},setToolTipsDesc:function setToolTipsDesc(row,ptDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.pointDesc').text(this.m_lang.POINT_DESC+': '+ptDesc);},renderTabel:function renderTabel(){var _this=this;var len=_this.m_newPointList.length;if(len<=0){return;}var div=$('#dataSrcPanel');var rowBaseNum=div.find('.dsItem').length;var rowCount;var item;var eachItem;var postData;len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};var arrOld=[];var bIsExist=false;var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){arrOld=parentNodes[0].children;}for(var i=0;i<len;i++){item=_this.m_newPointList[i];eachItem={type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};var bFlag=false;for(var j=0;j<arrOld.length;j++){if(item.prjId==arrOld[j].projId&&item.ptName==arrOld[j].value){bIsExist=true;bFlag=true;break;}}if(!bFlag){postData.itemList.push(eachItem);}}if(bIsExist){alert(I18n.resource.dataSource.ALREADY_EXIST);}var projName=_this.m_newPointList[0].prjName;var iconColor=_this.m_newPointList[0].iconColor;if(postData.itemList.length>0){WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}var list=data.itemIdList;var nAddlen=postData.itemList.length;for(var i=0;i<nAddlen;i++){if(postData.itemList[i].alias==list[i].alias){postData.itemList[i].itemId=list[i].id;}}
if(_this.treeObj){var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<postData.itemList.length;i++){var item=postData.itemList[i];var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}arrNodes.push({id:item.itemId,pId:item.groupId,isParent:false,name:itemName,value:item.value,projId:item.projId,note:item.note,type:0,iconSkin:'ptNormal'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=nAddlen;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}
_this.m_allPointList=_this.m_allPointList.concat(_this.m_newPointList);_this.calUpdateDataSources();}).error(function(){}).always(function(){});}}},modifyTable:function modifyTable(){var _this=this;var item;var eachItem;var postData;var len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};item=_this.m_newPointList[0];eachItem={id:item.itemId,type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(item.itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].prjId=item.prjId;_this.m_allPointList[i].prjName=_this.m_newPointList[0].prjName;_this.m_allPointList[i].customName=item.customName;_this.m_allPointList[i].ptName=item.ptName;_this.m_allPointList[i].ptDesc=item.ptDesc;break;}}
var divItem=$('#'+item.itemId);divItem.find('.showName').text(item.customName);_this.setToolTipsAll(divItem,item.userName,item.customName,item.prjName,item.ptName,item.ptDesc);_this.calUpdateDataSources();Beop.cache.ds.remove(item.itemId);}).error(function(){}).always(function(){});}},initDrag:function initDrag(){var _this=this;_this.dragOperateSrc($('#dataSrcPanel').get(0));_this.dragOperateCfg($('.springConfigMask').parent().get(0));},dragOperateSrc:function dragOperateSrc(tableList){if(undefined==tableList){return;}var _this=this;EventAdapter.on($(tableList),'dragstart',function(e){var tar=$(e.target);var className=tar.attr('class');if(!className){e.preventDefault();return;}if(tar.children('input').length>0){e.preventDefault();}if(-1!=className.indexOf('nav nav-list tree-group')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsGroupId':dragSrcId});}else if(-1!=className.indexOf('treeRow ui-draggable')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});}else{return;}$('.templatePara').css('display','block');});EventAdapter.on($(tableList),'dragover',function(e){e.preventDefault();});EventAdapter.on($(tableList),'drop',function(e){var tarItem=$(e.target);var tarId=0;var dstGroupId=0;var srcGroupId=0;var rowClass=tarItem.attr('class');if(!rowClass){return;}var dragType=-1;var draggedID=0;if(-1!=rowClass.indexOf('nav nav-list tree-group')||-1!=rowClass.indexOf('dsTreeHeader')){tarId=tarItem.closest('.nav').attr('id');draggedID=EventAdapter.getData().dsGroupId;if(Boolean(draggedID)){dragType=0;}else{draggedID=EventAdapter.getData().dsItemId;if(Boolean(draggedID)){dragType=2;tarId=tarItem.closest('.nav').attr('id');dstGroupId=tarId;srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}}}else if(-1!=rowClass.indexOf('showName')||-1!=rowClass.indexOf('treeRow ui-draggable')){dragType=1;draggedID=EventAdapter.getData().dsItemId;tarId=tarItem.closest('.treeRow').attr('id');dstGroupId=tarItem.closest('.nav').attr('id');srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}else{return;}if(draggedID==tarId||!draggedID){return;}if(0===dragType){var item,groupName;for(var i=0,len=_this.m_allGroupList.length;i<len;i++){item=_this.m_allGroupList[i];if(draggedID==item.id){groupName=item.name;break;}}$('#'+draggedID).remove();_this.insertTreeGroup(draggedID,groupName,1,$('#'+tarId));for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(draggedID==item.groupId){if(item.itemType==0){_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',true);}else{_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',false);}var prjName=_this.getProjectNameFromId(item.prjId,_this.m_langFlag);_this.initToolTips($('#'+item.itemId),item.customName,prjName,item.ptName,item.ptDesc);}}var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+tarId).find('.rows').find('.treeRow');srcGroup=$('#'+draggedID).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var postData={};postData[tarId]=arrDst;postData[draggedID]=arrSrc;WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).error(function(){}).always(function(){});}else if(1===dragType||2===dragType){var itemType=0;var iconColor='';var custName='';var projId=0;var pointName='';var pointDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(draggedID==_this.m_allPointList[i].itemId){_this.m_allPointList[i].groupId=dstGroupId;itemType=_this.m_allPointList[i].itemType;iconColor=_this.m_allPointList[i].iconColor;custName=_this.m_allPointList[i].customName;projId=_this.m_allPointList[i].prjId;pointName=_this.m_allPointList[i].ptName;pointDesc=_this.m_allPointList[i].ptDesc;break;}}var selItem=$('#'+draggedID);selItem.tooltip('destroy');selItem.remove();if(itemType==0){_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),true);}else{_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),false);}if(0==itemType){var prjName=_this.getProjectNameFromId(projId,_this.m_langFlag);_this.initToolTips($('#'+draggedID),custName,prjName,showName,pointDesc);}else if(1==itemType){var showName=_this.getShowNameFromFormula(pointName);_this.initFormulaToolTips($('#'+draggedID),custName,showName,pointDesc);}else{return;}var postData={};if(dstGroupId==srcGroupId){var srcGroup,arrSrc=[];srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(srcGroup,function(i,n){arrSrc.push(n.id);});postData[srcGroupId]=arrSrc;}else{var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+dstGroupId).find('.rows').find('.treeRow');srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var dstGroupCnt=0,srcGroupCnt=0;var groups=$('#dataSrcPanel .nav');$.each(groups,function(i,n){if(n.id==dstGroupId){dstGroupCnt=i;}if(n.id==srcGroupId){srcGroupCnt=i;}});if(dstGroupCnt<srcGroupCnt){postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}else{postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}}WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).error(function(){}).always(function(){});}});},dragOperateCfg:function dragOperateCfg(divItem){if(undefined==divItem){return;}var _this=this;EventAdapter.on($(divItem),'dragstart',function(e){var target=$(e.target);var className=target.attr('class');if('dsItem grow'!=className&&'dsItem grow dsSelected'!=className){return;}var dragSrcId=target.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($(divItem),'dragover',function(e){e.preventDefault();});EventAdapter.on($(divItem),'drop',function(e){var target=$(e.target);});},saveCurrentRecords:function saveCurrentRecords(){var _this=this;Spinner.spin(ElScreenContainer);WebAPI.post('/delete_data_source_records_by_userid',{userId:AppConfig.userId}).done(function(result){if(result!=0){Spinner.stop();return;}
var newPtList=[];var id;var len=_this.m_allPointList.length;var newRow;var item;$('#dataSrcPanel .dsItem').each(function(){id=$(this).attr('id');for(var i=0;i<len;i++){item=_this.m_allPointList[i];if(id==item.itemId){var _newRow;newRow=(_newRow={'itemId':id,'userId':item.userId,'userName':item.userName,'customName':item.customName,'prjId':item.prjId,'prjName':item.prjName,'ptName':item.ptName,'ptDesc':item.ptDesc,'iconColor':item.iconColor},_newRow['itemId']=item.itemId,_newRow);newPtList.push(newRow);break;}}});_this.m_allPointList=newPtList;var row;var data=[];var len=_this.m_allPointList.length;for(var i=0;i<len;i++){item=_this.m_allPointList[i];row={'userId':item.userId,'customName':item.customName,'projectId':item.prjId,'pointName':item.ptName,'pointDesc':item.ptDesc,'iconColor':item.iconColor};data.push(row);}WebAPI.post('/save_data_source_record',{sourceList:data}).done(function(result){if(0==result){}}).error(function(result){alert(I18n.resource.observer.widgets.DATABASE_OPERATION_FAILED+'');return;});}).error(function(result){alert(I18n.resource.observer.widgets.FAIL_BEFORE_EXECUTING+'');return;}).always(function(){Spinner.stop();});},loadDataSourceRecord:function loadDataSourceRecord(){var _this=this;var groupInfo=_this.m_parent.store.group;if(!groupInfo){return;}_this.m_allGroupList=[];_this.m_allPointList=[];var itemDefault=null;for(var m=0,n=groupInfo.length;m<n;m++){var groupId=groupInfo[m].groupId;var groupName=groupInfo[m].groupName;var groupIsDefault=Boolean(groupInfo[m].isDefault)?true:false;var data=groupInfo[m].datasourceList;var groupItem={'id':groupId,'name':groupName,'isDefault':groupIsDefault};if(groupIsDefault){itemDefault=groupItem;}else{_this.m_allGroupList.push(groupItem);}if(data){var len=data.length;var item;for(var i=0;i<len;i++){item={userId:AppConfig.userId,userName:AppConfig.account,customName:data[i].alias,prjId:data[i].projId,prjName:_this.getProjectNameFromId(data[i].projId),ptName:data[i].value,ptDesc:data[i].note,iconColor:_this.m_arrProjIdColorMap[data[i].projId],itemId:data[i].id,itemType:data[i].type,itemValue:data[i].value,groupId:groupId,groupName:groupName};if(item.itemType==1){item.iconColor='#000000';}_this.m_allPointList.push(item);}}}if(itemDefault){_this.m_allGroupList.push(itemDefault);}},colapseGroupsDefault:function colapseGroupsDefault(){var treeAllHead=$('.dsTreeHeader .dsGroupName');var item,row;for(var i=0,len=treeAllHead.length;i<len;i++){item=treeAllHead.eq(i);row=item.closest('.tree-group').find('.rows');if(!row||row.length<=0){continue;}if(item.text()==this.m_unassigned){row.css('display','block');}else{row.css('display','none');}}},colapseGroups:function colapseGroups(openGroupId){if(!openGroupId){return;}var treeAllRow=$('#dataSrcPanel .tree-group');var item,row;for(var i=0,len=treeAllRow.length;i<len;i++){item=treeAllRow.eq(i);row=item.find('.rows');if(!row||row.length<=0){continue;}if(item.attr('id')==openGroupId){row.css('display','block');}else{row.css('display','none');}}sessionStorage.removeItem('dsOpenGroupId');},getProjectNameFromId:function getProjectNameFromId(id,langFlag){var name;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(id==item.id){if(0==langFlag){name=item.name_cn;}else{name=item.name_en;}break;}}return name;},getProjectIdFromName:function getProjectIdFromName(projectName){var id;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(projectName==item.name_cn){id=item.id;break;}}return id;},calUpdateDataSources:function calUpdateDataSources(){return;var _this=this;var updateData=[];for(var i=0,len=_this.m_allGroupList.length;i<len;i++){var groupItem={'groupId':_this.m_allGroupList[i].id,'groupName':_this.m_allGroupList[i].name,'parentId':'','datasourceList':''};var dsList=[];for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){var curItem=_this.m_allPointList[j];if(groupItem.groupId==curItem.groupId){var pushItem={'id':curItem.itemId,'type':curItem.itemType,'projId':curItem.prjId,'alias':curItem.customName,'note':curItem.ptDesc,'value':curItem.ptName,'groupId':curItem.groupId};dsList.push(pushItem);}}groupItem.datasourceList=dsList;updateData.push(groupItem);}this.m_parent.updateDataSources(updateData);},renderFormula:function renderFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var prjId=0;var eachItem={type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var item;var arrNewFormula=[];for(var i=0,len=list.length;i<len;i++){item={'itemId':list[i].id,'itemType':1,'customName':list[i].alias,'itemValue':list[i].value,'ptName':list[i].value,'prjId':prjId,'iconColor':'#000000','ptDesc':_formulaDesc,'groupId':list[i].groupId};arrNewFormula.push(item);}
if(_this.treeObj){var parentId=arrNewFormula[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<len;i++){arrNodes.push({id:arrNewFormula[i].itemId,pId:arrNewFormula[i].groupId,isParent:false,name:arrNewFormula[i].customName,value:arrNewFormula[i].itemValue,projId:arrNewFormula[i].prjId,note:arrNewFormula[i].ptDesc,type:1,iconSkin:'ptFormula'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}_this.calUpdateDataSources();});},modifyFormula:function modifyFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var itemId=_this.m_selectItemId;var prjId=Number(AppConfig.projectId);var eachItem={id:itemId,type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;if(list.length>0){var showName=list[0].value;var arr=showName.split('<%');var arrId=[];var arrItem=[];for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''!=id){arrId.push(id);}}arrItem=_this.getDSItemById(arrId);for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''==id){continue;}for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var retVal=arrItem[m];if(null==retVal){continue;}showName=showName.replace(id,retVal.value);break;}}}showName=showName.replace(/<%/g,'');showName=showName.replace(/%>/g,'');for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=list[0].alias;_this.m_allPointList[i].ptName=list[0].value;_this.m_allPointList[i].ptDesc=list[0].note;break;}}var divFormula=$('#'+itemId);divFormula.find('.showName').text(list[0].alias);_this.setFormulaToolTipsAll(divFormula,list[0].alias,showName,list[0].note);_this.calUpdateDataSources();Beop.cache.ds.remove(itemId);}});},insertFormula:function insertFormula(itemId,customName,iconColor,formula,desc){var _this=this;var div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');div.attr('id',itemId);div.click(function(e){_this.clearSelect();var tar=$(e.currentTarget);if('dsItem grow'==tar.attr('class')){tar.attr('class','dsItem grow dsSelected');}else{tar.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var name=$('<div class="dsValue" style="height:36px"></div>');name.text(customName);div.append(name);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){var show=$(e.currentTarget).prevAll('.dsValue');show.css('display','none');var target=$(e.currentTarget).nextAll('.dsDivChange');target.attr('class','dsDivChange show');div.css('height','240px');div.css('width','100%');var item;var strName='';var strFormula='';var strDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){strName=item.customName;strFormula=item.ptName;strDesc=item.ptDesc;break;}}var temp=target.find('input');if(temp.length==2){$(temp[0]).val(strName);$(temp[1]).val(strDesc);}_this.stopBubble(e);}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var ctlFormula=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.FORMULA_NAME+': </label></div>');var showFormula=$('<span>'+formula+'</span>');showFormula.appendTo(ctlFormula.find('label')).mathquill();ctlFormula.click(function(e){_this.stopBubble(e);});divChange.append(ctlFormula);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',desc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:1,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(0==data.itemIdList.length){return;}var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);$('#dataSrcPanel').append(div);},initFormulaToolTips:function initFormulaToolTips(parent,customName,formula,desc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:400px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="formula tipStyle" style="word-break:normal;"><span class="tipTitleStyle">').append(_this.m_lang.FORMULA_NAME).append('</span>: ').append('</p>');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(desc).append('</p>');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var showFormula=$('<span>'+formula+'</span>');var showObj=$(show.toString());showFormula.appendTo(showObj.find('.formula')).mathquill();var options={placement:'left',title:_this.m_lang.PARAM,template:showObj};parent.tooltip(options);},setFormulaToolTipsAll:function setFormulaToolTipsAll(row,customName,formulaVal,formulaDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').html('<span style="font-weight:bold">'+this.m_lang.CUSTOM_NAME+'</span>: '+customName);tip.find('.pointDesc').html('<span style="font-weight:bold">'+this.m_lang.POINT_DESC+'</span>: '+formulaDesc);var showFormula=$('<span>'+formulaVal+'</span>');var dst=tip.find('.formula').html('<span style="font-weight:bold">'+this.m_lang.FORMULA_NAME+'</span>: ');showFormula.appendTo(dst).mathquill();},checkRepeatWithCustomName:function checkRepeatWithCustomName(_name){var _this=this;var bRet=false;var grids=$('#dataSrcPanel .dsItem .dsValue');$.each(grids,function(i,n){if(_name==$(n).text()){bRet=true;return false;}});return bRet;},stopBubble:function stopBubble(e){if(e&&e.stopPropagation){e.stopPropagation();}else{window.event.cancelBubble=true;}},clearSelect:function clearSelect(e){var itemList=$('#dataSrcPanel .dsItem');itemList.attr('class','dsItem grow');itemList.css('height','34px');itemList.css('width','33%');var panel=$('#dataSrcPanel');panel.find('.dsDivChange').attr('class','dsDivChange');panel.find('.dsValue').css('display','inline');},insertTreeGroup:function insertTreeGroup(groupId,groupName,type,baseGroup){var _this=this;var divContain=$('#dataSrcPanel');var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true">');var $liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});}).error(function(e){});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add"></span>');EventAdapter.on(btnAddDs,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add" /></span>');EventAdapter.on(btnAddFormula,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true"></span>');EventAdapter.on(spanEdit,'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on(inputEdit,'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-default btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on(btnEdit,'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}spanName.text(data.groupName);}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($liHd,'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');var imgPath=icon.attr('src');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').css('font-weight','400');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').css('font-weight','700');curTarHead.find('.dsTreeBtnFormula').css('display','inline');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');$ul.append(divLiRow);if(0===type){divContain.append($ul);}else if(1===type){if(''!=baseGroup){baseGroup.after($ul);}}else if(2===type){if(''!=baseGroup){baseGroup.before($ul);}}},insertTreeItem:function insertTreeItem(divParentGroup,itemId,iconColor,itemName,insertType,baseItem,bIsPoint){var _this=this;var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on(divShowName,'click',function(e){var oldCustName=$(e.currentTarget).text();var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px">');input.blur(function(e){var newCustName=$(e.currentTarget).val();if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:itemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divShowName.text(dstCustomName);_this.setToolTipsCustomName(divShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divShowName.after(input);divShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}
promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){});});}).error(function(e){});div.append(btnRemove);if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on(div,'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});if(0===insertType){divParentGroup.find('.rows').append(div);}else if(1===insertType){if(''!=baseItem){baseItem.after(div);}}else if(2===insertType){var lyRow=divParentGroup.find('.rows').find('.treeRow');if(0==lyRow.length){divParentGroup.find('.rows').append(div);}else{lyRow.eq(0).before(div);}}},insertTreeAllGroupItem:function insertTreeAllGroupItem(groupList,pointList,searchPointName){var _this=this;var divContain=$('#dataSrcPanel');var groupId,groupName,bIsDefault;for(var i=0,len=groupList.length;i<len;i++){groupId=groupList[i].id;groupName=groupList[i].name;bIsDefault=groupList[i].isDefault;var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true" dropable="true" isDefault="'+bIsDefault+'">');var $liHd;if(groupName==this.m_unassigned){$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');}else{$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon"></span></li>');}var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(btnRemove),'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add" style="display:none"></span>');if(groupName==this.m_unassigned){btnAddDs.css('display','inline');}EventAdapter.on($(btnAddDs),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add"  style="display:none"/></span>');if(groupName==this.m_unassigned){btnAddFormula.children('img').css('display','inline');}EventAdapter.on($(btnAddFormula),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(spanEdit),'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on($(inputEdit),'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-primary btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on($(btnEdit),'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var ulNav=tar.closest('.nav');var groupId=ulNav.attr('id');var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}var spanName=ulNav.find('.dsGroupName');if(Boolean(spanName)){spanName.text(data.groupName);}}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($($liHd),'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').removeClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').addClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','inline-block');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');if(groupName==_this.m_unassigned){divLiRow.css('display','block');}else{divLiRow.css('display','none');}$ul.append(divLiRow);var itemId,iconColor,itemName,itemPtName;var bHasSearched=false;for(var j=0,len2=pointList.length;j<len2;j++){if(groupId==pointList[j].groupId){itemId=pointList[j].itemId;iconColor=pointList[j].iconColor;itemName=pointList[j].customName;itemPtName=pointList[j].ptName;if(''!=searchPointName){var custNameLower=itemName.toLowerCase();var ptNameLower=itemPtName.toLowerCase();if(-1==custNameLower.indexOf(searchPointName)&&-1==ptNameLower.indexOf(searchPointName)){continue;}else{bHasSearched=true;}}var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true" dropable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on($(divShowName),'click',function(e){var divCurShowName=$(e.currentTarget);var oldCustName=divCurShowName.text();var selItemId=divCurShowName.closest('.treeRow').attr('id');var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px;background-color:#465b85">');input.blur(function(e){var $tar=$(e.currentTarget);var newCustName=$tar.val();if(''==newCustName){$tar.select();alert(I18n.resource.dataSource.CUSTOM_NOT_NULL);return;}if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(selItemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:selItemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divCurShowName.text(dstCustomName);_this.setToolTipsCustomName(divCurShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divCurShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divCurShowName.after(input);divCurShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on($(btnRemove),'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}Spinner.spin(div[0]);promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){}).always(function(e){Spinner.stop();});});});div.append(btnRemove);var bIsPoint=0==pointList[j].itemType?true:false;if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on($(div),'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});$ul.find('.rows').append(div);if(bIsPoint){var prjName=_this.getProjectNameFromId(pointList[j].prjId,_this.m_langFlag);_this.initToolTips(div,pointList[j].customName,prjName,pointList[j].ptName,pointList[j].ptDesc);}else{var showName=_this.getShowNameFromFormula(pointList[j].ptName);_this.initFormulaToolTips(div,pointList[j].customName,showName,pointList[j].ptDesc);}}}if(''==searchPointName){divContain.append($ul);}else{if(bHasSearched){divContain.append($ul);}}}},getDSItemById:function getDSItemById(datasourceItemId){var _this=this;var ret=[];var postData=[];var bIsArray=Object.prototype.toString.call(datasourceItemId)==='[object Array]';if(!bIsArray){if(this.m_parent.store.dsInfoList){var itemInfo;for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId==itemInfo.id){return itemInfo;}}}for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId==item._id){return{id:item._id,groupId:'',alias:item.alias,projId:item.projId,type:0,value:item.value};}}}else{var copyArr=datasourceItemId.slice();if(this.m_parent.store.dsInfoList){var itemInfo;for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId[j]==itemInfo.id){ret.push(itemInfo);break;}}}if(ret.length>0){return ret;}}for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId[j]==item._id){var index=copyArr.indexOf(item._id);if(index>-1){copyArr.splice(index,1);}ret.push({id:item._id,groupId:'',alias:!!item.alias?item.alias:item.value,projId:item.projId,type:0,value:item.value});}}}if(ret.length==datasourceItemId.length){return ret;}else{datasourceItemId=copyArr;}}if(!bIsArray){postData.push(datasourceItemId);}else{postData=datasourceItemId;}var dsRet=$.ajax({type:'POST',url:'/analysis/datasource/getDsItemsById',data:JSON.stringify(postData),contentType:'application/json',async:false}).responseText;if(dsRet){var temp=JSON.parse(dsRet);if(!bIsArray){ret=temp[0];if(!ret){ret={alias:undefined,groupId:undefined,id:undefined,note:undefined,projId:undefined,type:undefined,value:undefined};}}else{if(temp instanceof Array){temp.map(function(i){if(!i.alias){i.alias=i.value;}});}ret=ret.concat(temp);}return ret;}return{};},getDSItemData:function getDSItemData(target,arrDSItemIds){var _this=this.m_parent;var timeConfig;if(_this.curModal.timeRecent){timeConfig=generateTimeOption(_this.curModal);}else{timeConfig=_this.curModal;}var tmStart=timeConfig.startTime.toDate();var tmEnd=timeConfig.endTime.toDate();var tmFmt=timeConfig.format;var key;var preloadIds=[];var row=null,arrId;var ids=arrDSItemIds.concat();var postData={dsItemIds:ids,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt};var promise=$.Deferred();Beop.cache.ds.getBatch(ids,tmFmt,tmStart,tmEnd).done(function(rs){promise.resolve(rs);}).fail(function(e){console.warn(e);promise.reject();});promise.always(function(rs){var idsNotFound,cacheData;if(rs){idsNotFound=rs.idsNotFound;cacheData=rs.data;if(idsNotFound.length>0){postData.dsItemIds=idsNotFound;}else{target.spinnerStop();target.renderModal(cacheData);return;}}WebAPI.post('/analysis/startWorkspaceDataGenHistogram',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}Beop.cache.ds.set(data,tmFmt,tmStart,tmEnd).done(function(){if(cacheData&&cacheData!==null){data={list:data.list.concat(cacheData.list),timeShaft:data.timeShaft.length>0?data.timeShaft:cacheData.timeShaft};}}).fail(function(e){console.warn(e);}).always(function(){target.renderModal(data);});}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});});},getDSItemDataMulti:function getDSItemDataMulti(target,arrDSItemIds){var _this=this.m_parent;_this.curModal.arrComparePeriodLabel=[];var tmStart=_this.curModal.startTime;tmStart=tmStart.length<=10?tmStart+' 00:00:00':tmStart;var tmEnd=_this.curModal.endTime;tmEnd=tmEnd.length<=10?tmEnd+' 00:00:00':tmEnd;var tmFmt=_this.curModal.format;var comparePeriod=_this.curModal.comparePeriod;var period1,period2,time;var startDate=new Date(tmStart);var endDate=new Date(tmEnd);var compareDateI18n=I18n.resource.analysis.historyCompare;if(comparePeriod=='hour'){time=3600000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate()+' '+startDate.getHours()+':00');_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate()+' '+endDate.getHours()+':00');}if(comparePeriod=='day'){time=86400000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate());_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate());}if(comparePeriod=='week'){time=604800000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',startDate.getFullYear()).replace('<%week%>',getWeekNumber(tmStart)));_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',endDate.getFullYear()).replace('<%week%>',getWeekNumber(tmEnd)));}if(comparePeriod=='month'){var getCurrentMonthLastDay=function getCurrentMonthLastDay(date){var current=date.toDate();var currentMonth=current.getMonth();var nextMonth=++currentMonth;var nextMonthDayOne=new Date(current.getFullYear(),nextMonth,1);return new Date(nextMonthDayOne.getTime());};period1=getCurrentMonthLastDay(tmStart);period2=getCurrentMonthLastDay(tmEnd);_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1));_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1));}var postData=[{dsItemIds:arrDSItemIds,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period1.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt},{dsItemIds:arrDSItemIds,timeStart:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period2.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt}];WebAPI.post('/analysis/startWorkspaceDataGenHistogramMulti',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}
target.renderModal(data);}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});function isLeapYear(year){return year%400==0||year%4==0&&year%100!=0;}function getMonthDays(year,month){return[31,null,31,30,31,30,31,31,30,31,30,31][month]||(isLeapYear(year)?29:28);}function getWeekNumber(date){var now=date.toDate(),year=now.getFullYear(),month=now.getMonth(),days=now.getDate();for(var i=0;i<month;i++){days+=getMonthDays(year,i);}
var yearFirstDay=new Date(year,0,1).getDay()||7;var week=null;if(yearFirstDay==1){week=Math.ceil(days/yearFirstDay);}else{days-=7-yearFirstDay+1;week=Math.ceil(days/7)+1;}return week;}},getShowNameFromFormula:function getShowNameFromFormula(formula){var _this=this;var inputStr=formula;var nStart=inputStr.indexOf('<%');var nEnd=inputStr.indexOf('%>');if(-1==nStart||-1==nEnd){return inputStr;}var id=inputStr.substring(nStart+2,nEnd);if(''==id){return _this.getShowNameFromFormula(inputStr);}var retVal=_this.getDSItemById(id);if(null==retVal){return _this.getShowNameFromFormula(inputStr);}inputStr=inputStr.replace('<%'+id+'%>',retVal.value);return _this.getShowNameFromFormula(inputStr);},addNewGroup:function addNewGroup(){var groupName=$('#inputAddGroup').val();if(''==groupName){return;}var _this=this;var postData={'groupId':'','name':groupName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if('successful'!=data.error){return;}var groupId=data.groupId;if(groupId){if(_this.treeObj){var nodeUnassigned=_this.treeObj.getNodesByParam('name','unassigned',null);var index=-1;if(nodeUnassigned.length>0){index=_this.treeObj.getNodeIndex(nodeUnassigned[0]);}_this.treeObj.addNodes(null,index,{id:data.groupId,pId:data.parentId,name:data.groupName,isParent:true});}}$('#inputAddGroup').val('');$('#inputAddGroup').blur();}).fail(function(result){}).always(function(e){});}};return DataSource;}();var HierFilter=function(){function HierFilter($ctn,projectId,parent,theme){this.$ctn=$ctn;this.projectId=projectId;this.theme=theme;this.opt=undefined;this.parent=parent;this.defaultOpt={title:{show:false},base:{divideByProject:true},search:{show:true},class:{show:true,projects:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true},groups:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true},things:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true}},tree:{show:true,event:{},drag:{enable:true},base:{expandReload:true},tool:{add:{},beforeAdd:{},edit:{},del:{}},check:{enable:false}}};this.dictClass={};this.store=undefined;this.initDeferred=$.Deferred();this.$paneClass=undefined;this.$paneSearch=undefined;this.$paneTree=undefined;this.$paneAdd=undefined;this.tree=undefined;this.setDefault=false;this.prevProjId=undefined;this.isSearch=false;this.showStatus={'projects':'all','groups':'all','things':'all'};}
HierFilter.prototype={init:function init(ctn,theme){var _this=this;_this.$ctn=ctn?ctn:_this.$ctn;_this.theme=theme?theme:_this.theme;if(!_this.projectId){if(AppConfig&&AppConfig.projectId){_this.projectId=AppConfig.projectId;}else{if(window.parent&&window.parent.AppConfig.projectId){_this.projectId=window.parent.AppConfig.projectId;}}}
if(!_this.projectId)_this.projectId=-1;WebAPI.get('/static/scripts/iot/hierFilter.html').done(function(resultHTML){_this.$ctn.append(resultHTML);I18n.fillArea($('#filterWrapper'));_this.initAddPane();_this.initSearch();_this.initDeferred.resolve();});},setOption:function setOption(opt){var _this=this;_this.initDeferred.done(function(){_this.opt=$.extend(true,{},_this.defaultOpt,opt);var postData={parent:[],projId:[_this.projectId]};if(!_this.opt.base.divideByProject)delete postData.projId;$.when(WebAPI.get('/iot/getClassFamily/group/cn'),WebAPI.get('/iot/getClassFamily/thing/cn'),WebAPI.get('/iot/getClassFamily/project/cn')).done(function(groups,things,projects){_this.dictClass['groups']=groups[0];_this.dictClass['things']=things[0];_this.dictClass['projects']=projects[0];WebAPI.post('/iot/search',postData).done(function(resultDate){_this.store={groups:resultDate.groups,projects:resultDate.projects,things:resultDate.things};_this.isSearch=false;var $Deffer=$.Deferred();if(resultDate.projects.length==0&&_this.setIotProject()){_this.setIotProject().done(function(result){if(result&&result.status=='success'){_this.store.projects[0]._id=result._id;$Deffer.resolve();}else{$Deffer.reject();}}).fail(function(){$Deffer.reject();});}else{$Deffer.resolve();}
$Deffer.done(function(){for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
for(var type in _this.store){if(_this.opt.class&&_this.opt.class[type]&&_this.opt.class[type].class){if(_this.dictClass[type][_this.opt.class[type].class]&&_this.dictClass[type][_this.opt.class[type].class].parent=='BaseIOT'){_this.showStatus[type]='all';}else{_this.showStatus[type]=_this.opt.class[type].class;}}}
_this.initClassPane();_this.initTreePane(_this.store);_this.opt.tree.event.afterInit&&_this.opt.tree.event.afterInit();var node=_this.tree.getNodes();if(node.length==0)return;node=node[0];_this.tree.selectNode(node);_this.setDefault=true;_this.tree.setting.callback.onClick({target:document.getElementById(node.tId)},node['_id'],node);});});});});},setIotProject:function setIotProject(){if(!(AppConfig&&AppConfig.projectList instanceof Array))return;if(!this.projectId)return;var info;for(var i=0;i<AppConfig.projectList.length;i++){if(AppConfig.projectList[i].id==this.projectId){info=AppConfig.projectList[i];break;}}
if(!info)return;var postData={'_idMgt':'bbbbbbbbbbbbf32fbc300001',codeName:info.name_en,dictName:{cn:info.name_cn,en:info.name_en},latLng:info.latlng,arrP:{},type:'Project',projId:this.projectId};this.store.projects=[{codeName:info.name_en,name:info.name_cn,latLng:info.latlng,arrP:{},type:'Project',projId:this.projectId}];return WebAPI.post('/iot/setIotProject',postData);},refresh:function refresh(){},dispose:function dispose(){},close:function close(){},initClassPane:function initClassPane(){var _this=this;if(!(_this.opt.class&&_this.opt.class.show))return;_this.$paneClass=$('#paneIotType');_this.$paneClass.html('');setClassSel('projects');setClassSel('groups');setClassSel('things');function setClassSel(type){if(_this.opt.class&&_this.opt.class[type]&&_this.opt.class[type].show){var strType=type.slice(0,type.length-1);strType=strType[0].toLocaleUpperCase()+strType.slice(1);var $divSelect=$('\
                    <div class="divSelect" value="all">\
                        <span class="spSelRs">'+I18n.resource.iot.TREE_ALL+'</span>\
                        <span class="glyphicon glyphicon-triangle-bottom"></span>\
                    </div>');var selOpt=[];if(_this.opt.class[type].showAll){selOpt.push({value:'all',name:I18n.resource.iot.TREE_ALL});}
if(_this.opt.class[type].showNone){selOpt.push({value:'none',name:I18n.resource.iot.TREE_HIDE});}
for(var cls in _this.dictClass[type]){if(_this.dictClass[type][cls].parent=='BaseIOT')continue;selOpt.push({value:cls,name:_this.dictClass[type][cls].name,parent:_this.dictClass[type][cls].parent});}
var $selector=_this.setSel(selOpt).addClass('selClass');if($selector.find('li').length==0)return;$selector.off('click').on('click','li',function(e){e.stopPropagation();var value=$(e.currentTarget).attr('value');$selector.prevAll('.spSelRs').text($(e.currentTarget).children('span').text());$selector.attr('value');var opt={'type':type,'val':value};_this.showStatus[opt.type]=opt.val;_this.initTreeData(opt);_this.initAttrPane(opt);});$selector.attr('value',_this.showStatus[type]);if(_this.showStatus[type]=='all'){$divSelect.children('.spSelRs').text(I18n.resource.iot.TREE_ALL);}else if(_this.showStatus[type]=='none'){$divSelect.children('.spSelRs').text(I18n.resource.iot.TREE_HIDE);}else{var arrKey=Object.keys(_this.dictClass[type]);for(var i=0;i<arrKey.length;i++){if(arrKey[i]==_this.showStatus[type]){$divSelect.children('.spSelRs').text(_this.dictClass[type][arrKey[i]].name);break;}}}
$divSelect.append($selector);_this.$paneClass.append($divSelect);}}},setSel:function setSel(selOpt){var _this=this;var $selector=$('<ul>');var tempArr=[].concat(selOpt);var dictTree={};var level=0;var length=tempArr.length;var numLeft=length;var isRoot;for(var i=0;i<length;i++){isRoot=true;for(var j=0;j<length;j++){if(i==j)continue;if(selOpt[j].value==tempArr[i].parent){isRoot=false;break;}}
if(isRoot){tempArr[i].level=level;if(!dictTree[level])dictTree[level]=[];dictTree[level].push(tempArr[i]);tempArr[i]=null;}}
while(numLeft>0){numLeft=0;level++;for(var i=0;i<length;i++){if(!tempArr[i])continue;for(var j=0;j<dictTree[level-1].length;j++){if(tempArr[i].parent==dictTree[level-1][j].value){if(!dictTree[level])dictTree[level]=[];dictTree[level].push(tempArr[i]);tempArr[i]=null;break;}}}
for(var i=0;i<length;i++){if(tempArr[i])numLeft++;}}
var $option,$parent=[],$parentTemp=[];var $spName;for(var i=0;i<dictTree['0'].length;i++){$option=$('<li>');$option.addClass('level_0 '+dictTree['0'][i].value).attr('value',dictTree['0'][i].value);$spName=$('<span>').text(dictTree['0'][i].name);$option.append($spName);$option.append('<ul>');$selector.append($option);$parent.push($option);}
for(var ele in dictTree){if(ele=='0')continue;for(var i=0;i<dictTree[ele].length;i++){$option=$('<li>');$option.addClass('level_'+ele+' '+dictTree[ele][i].value).attr('value',dictTree[ele][i].value);$spName=$('<span>').text(dictTree[ele][i].name);$option.append($spName);$option.append('<ul>');for(var j=0;j<$parent.length;j++){if($parent[j].attr('value')==dictTree[ele][i].parent){$parent[j].children('ul').append($option);break;}}
$parentTemp.push($option);}
$parent=$parentTemp;$parentTemp=[];}
return $selector;},initAttrPane:function initAttrPane(opt){var _this=this;var $paneClass,cls,type,clsStore,$divAttr,attrStore,$selAttr,parentStore;cls=opt.val;type=opt.type;clsStore=_this.searchClass(cls);$paneClass=$('#paneIot-'+type).html('').removeClass('on');if(!clsStore)return;$paneClass.append('<div class="className">'+clsStore.name+'</div>');parentStore=_this.searchClass(clsStore.parent);if(parentStore&&parentStore.name){$paneClass.append('<div class="classParentName">'+parentStore.name+'</div>');}
$divAttr=$('<div class="divAttr">');for(var attr in clsStore.attrs){attrStore=clsStore.attrs[attr];setAttr(attrStore,$divAttr);$paneClass.find('.className').after($divAttr);}
if($paneClass.find('select').length>0){$paneClass.addClass('on');}
function setAttr(attrStore,$divAttr){if(attrStore.filter){$divAttr.append('<span class="label">'+attrStore.name+'</span>');$selAttr=$('<select class="filterAttr">').addClass('attr').attr('filterMode',attrStore.filter.t);if(attrStore.filter.t='enum'){for(var attrOpt in attrStore.filter.opt){$selAttr.append('<option value="'+attrOpt+'">'+attrStore.filter.opt[attrOpt]+'</option>');}}else if(attrStore.filter.t='range'){for(var j=0;j<attrStore.filter.opt.length;j++){$selAttr.append('<option value="'+attrStore.filter.opt[j]+'">'+attrStore.filter.opt[j]+'</option>');}}
$divAttr.append($selAttr);}}},initSearch:function initSearch(){var _this=this;var $iptSearch=$('#paneIotSearch').find('input');$iptSearch.next().off('click').on('click',function(){if($iptSearch.val()=='')return;$iptSearch.val('');clearSearch();});$iptSearch.on('propertychange input',function(e){if($iptSearch.val()==''){clearSearch();}});$iptSearch.keyup(function(e){if(13==e.keyCode){$iptSearch.blur();var projId;var selectNode=_this.tree.getSelectedNodes()[0];if(!selectNode||!selectNode['projId']){projId=_this.prevProjId?_this.prevProjId:_this.projectId;}else{var parentNode=selectNode.getParentNode();while(parentNode){selectNode=parentNode;parentNode=selectNode.getParentNode();}
_this.prevProjId=selectNode['projId'];}
var postData;if($iptSearch.val()==''){clearSearch();}else{postData={searchName:$iptSearch.val(),projId:projId?projId:_this.projectId};if(!_this.opt.base.divideByProject)delete postData.projId;WebAPI.post('/iot/fuzzysearch',postData).done(function(result){if(!result||!result.data)return;_this.isSearch=true;$.fn.zTree.destroy('paneIotData');_this.store={projects:[],groups:[],things:[]};_this.tree=null;for(var i=0;i<result.data.length;i++){result.data[i].pId=result.data[i]['_idPrt'];_this.store[result.data[i].baseType].push(result.data[i]);}
for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
_this.initTreePane(_this.store);});}}});function clearSearch(){var postData={parent:[],projId:[_this.projectId]};if(!_this.opt.base.divideByProject)delete postData.projId;WebAPI.post('/iot/search',postData).done(function(result){if(!result)return;_this.isSearch=false;$.fn.zTree.destroy('paneIotData');_this.store={projects:[],groups:[],things:[]};_this.tree=null;_this.store={groups:result.groups,projects:result.projects,things:result.things};for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
_this.initClassPane();_this.initTreePane(_this.store);});}},searchName:function searchName(name){var _this=this;for(var type in _this.store.class){for(var keyName in _this.store.class[type]){if(keyName==name)return _this.store.class[type][keyName];}}},searchDeviceById:function searchDeviceById(id,type){var _this=this;if(!id)return[];var arrDevice=[];var arrId=[];if(type){if(id instanceof Array){for(var i=0;i<id.length;i++){arrId[i]={id:id[i],index:i};}
for(var i=0;i<_this.store[type].length;i++){for(var j=0;j<arrId.length;j++){if(_this.store[type][i]['_id']==arrId[j].id){arrDevice[arrId[j].index]=_this.store[type][i];arrId.splice(j,1);break;}}}}else{for(var i=0;i<_this.store[type].length;i++){if(_this.store[type][i]['_id']==id){return[_this.store[type][i]];}}}}else{if(id instanceof Array){for(var i=0;i<id.length;i++){arrId[i]={id:id[i],index:i};}
for(var ele in _this.store){for(var i=0;i<_this.store[ele].length;i++){for(var j=0;j<arrId.length;j++){if(_this.store[ele][i]['_id']==arrId[j].id){arrDevice[arrId[j].index]=_this.store[ele][i];arrId.splice(j,1);break;}}}}}else{for(var ele in _this.store){for(var i=0;i<_this.store[ele].length;i++){if(_this.store[ele][i]['_id']==id){return[_this.store[ele][i]];}}}}}
return arrDevice;},searchClass:function searchClass(cls){var _this=this;for(var type in _this.dictClass){for(var keyCls in _this.dictClass[type]){if(keyCls==cls)return _this.dictClass[type][keyCls];}}},initTreePane:function initTreePane(opt,parentNode){var _this2=this;var _this=this;if(_this.tree)return;_this.$paneTree=$('#paneIotData');_this.$paneTree.off('click');if(_this.opt.tree&&_this.opt.tree.show){var setting;var zNodes;(function(){var diyParam=function diyParam(treeNode){return{parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};};var dataFilter=function dataFilter(treeId,parentNode,resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
_this.initClassPane();};var addDiyDom=function addDiyDom(treeId,treeNode){var $target=$('#'+treeNode.tId);$target.attr('ptId',treeNode['_id']);$target.addClass(treeNode.baseType);if(treeNode.baseType=='groups'||treeNode.baseType=='things'){$target.children('a').append('\
                    <span class="btnDelete btnTreeNode glyphicon glyphicon-remove-sign"></span>\
                    <span class="btnEdit btnTreeNode glyphicon glyphicon-edit"></span>\
                    ');}
if(_this.opt.tree.drag&&_this.opt.tree.drag.enable){$target.attr('draggable',true);if(_this.opt.tree.drag.dragstart){attachDragEvent('dragstart',$target,treeNode);}
if(_this.opt.tree.drag.dragend){attachDragEvent('dragend',$target.children('a'),treeNode);}
if(_this.opt.tree.drag.drop){attachDragEvent('dragover',$target.children('a'),treeNode);attachDragEvent('dragleave',$target.children('a'),treeNode);attachDragEvent('drop',$target.children('a'),treeNode);}}
if(typeof _this.opt.tree.event.addDom=='function'){_this.opt.tree.event.addDom.call(_this,treeNode,$target);}};var addHoverDom=function addHoverDom(treeId,treeNode){if(treeNode.isParent)return;var $target=$('#'+treeNode.tId);$target.css({'background-color':'rgb(76, 100, 148)'});$target.children('a').css('color','black');};var removeHoverDom=function removeHoverDom(treeId,treeNode){if(treeNode.isParent)return;var $target=$('#'+treeNode.tId);$target.css({'background-color':'transparent'});$target.children('a').css('color','inherit');};var attachDragEvent=function attachDragEvent(type,target,treeNode){if(type=='dragover'||type=='dragleave'){target.on(type,function(e){e.preventDefault();_this.opt.tree.drag[type]&&_this.opt.tree.drag[type].call(_this,e,treeNode);});return;}
if(_this.opt.tree.drag[type]){if(_this.opt.tree.drag[type]instanceof Function){target.on(type,function(e){e.preventDefault();_this.opt.tree.drag[type].call(_this,e,treeNode);});}else if(_this.opt.tree.drag[type].act instanceof Function&&_this.opt.tree.drag[type].tar==treeNode.baseType){target.on(type,function(e){_this.opt.tree.drag[type].act.call(_this,e,treeNode);});}else if(_this.opt.tree.drag[type]instanceof Array){_this.opt.tree.drag[type].forEach(function(event,i){if(event.act instanceof Function&&event.tar==treeNode.baseType){target.on(type,function(e){e.stopPropagation();event.act.call(_this,e,treeNode);});}});}}};setting={data:{simpleData:{enable:true,idKey:'_id'}},keep:{leaf:true,parent:true},check:{enable:_this.opt.tree.check.enable},edit:{enable:true,drag:{isCopy:false,isMove:false},showRemoveBtn:false,showRenameBtn:false},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,dblClickExpand:false,showIcon:true,showLine:true},callback:{beforeRename:function beforeRename(){return false;},beforeRemove:function beforeRemove(){},beforeDrag:function beforeDrag(){return false;},beforeAsync:function beforeAsync(){},onAsyncSuccess:function onAsyncSuccess(){},onDblClick:function onDblClick(event,treeId,treeNode){if(!_this.opt.tree.event.dblClick)return;_this.opt.tree.event.dblClick.call(_this,event,treeId,treeNode);},onClick:function onClick(event,treeId,treeNode){if(!_this.opt.tree.event.click)return;var that=this;var dblFlag=false;var clkInterval;if(typeof treeNode.clickTime=='undefined'){clkInterval=Infinity;}else{clkInterval=new Date()-treeNode.clickTime;}
treeNode.clickTime=new Date();$(event.target).on('click.judgeDbl',function(){dblFlag=true;});var dblJudge=window.setInterval(function(){$(event.target).off('click.judgeDbl');window.clearInterval(dblJudge);if(!dblFlag&&clkInterval>200){if(_this.opt.tree.event.click.isDefault===false){_this.opt.tree.event.click.act.call(that,event,treeId,treeNode);return;}
_this.childAppend(treeNode,function(){if(_this.opt.tree.event.click){if(!_this.opt.tree.event.click instanceof Array){_this.opt.tree.event.click.call(that,event,treeId,treeNode);}else{for(var i=0;i<_this.opt.tree.event.click.length;i++){if(_this.opt.tree.event.click[i].tar.toString().indexOf(treeNode.baseType)>-1||_this.opt.tree.event.click[i].tar=='all'){_this.opt.tree.event.click[i].act.call(that,event,treeId,treeNode);}}}}});}},200);}}};if(_this.opt.tree.extend){$.extend(true,setting,setting,_this.opt.tree.extend);}
zNodes=_this.initTreeData(opt);_this.tree=$.fn.zTree.init(_this2.$paneTree,setting,zNodes);_this.$paneTree.on('click','.btnEdit',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.parentNode.id);var parentNode=treeNode.getParentNode();new CreateDeviceModal({mode:'edit',baseType:treeNode.baseType,filter:_this,parentNode:parentNode,treeNode:treeNode});});_this.$paneTree.on('click','.btnDelete',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.parentNode.id);infoBox.confirm(' '+treeNode.name+' ? ',okCallback);function okCallback(){var postData=[{'id':[treeNode['_id']],'type':treeNode['baseType']}];WebAPI.post('/iot/delIotInfo',{itemList:postData,projId:AppConfig.projectId}).done(function(){var nodes=_this.tree.getNodesByParam('_id',$(e.target.parentNode.parentNode).attr('ptid'));for(var i=0;i<nodes.length;i++){_this.tree.removeNode(nodes[i]);}
if(typeof _this.opt.tree.tool.delete=='function'){_this.opt.tree.tool.delete.call(_this,treeNode);}});}});_this.$paneTree.on('click','.btnTemplate',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.id);var strModalContent=new StringBuilder();strModalContent.append('               <iframe style="width:100%;height:100%;" name="ifram_factory" sandbox="allow-forms allow-popups allow-scripts allow-same-origin allow-modals" frameborder="0"></iframe>');var $modalContent=$(strModalContent.toString());var $modal=$('#templateModal');$modal.find('.modal-content').append($modalContent);$modal.modal('show');$modal.off().on('shown.bs.modal',function(){var form,ipt;form=document.createElement('form');form.action='/factory/preview/8f54051d0011456903054765';form.method='post';form.target='ifram_factory';ipt=document.createElement('input');ipt.type='hidden';ipt.name='params';ipt.value=JSON.stringify(treeNode.arrP);form.appendChild(ipt);document.body.appendChild(form);form.submit();document.body.removeChild(form);});$modal.on('hidden.bs.modal',function(){$modalContent.remove();});});_this.$paneTree.on('click','.projects>.button.switch',function(e){var $target=$(e.currentTarget);var node=_this.tree.getNodeByTId($target.parent().attr('id'));_this.childAppend(node,function(){});return false;});_this.$paneTree.on('click','.groups>.button.switch',function(e){var $target=$(e.currentTarget);var node=_this.tree.getNodeByTId($target.parent().attr('id'));_this.childAppend(node,function(){});return false;});})();}},initTreeData:function initTreeData(option){var _this=this;if(!_this.tree){var data=[];data=data.concat(this.store.projects);data=data.concat(this.store.groups);data=data.concat(this.store.things);}else{var root=_this.tree.getNodes();var data=_this.tree.transformToArray(root);for(var i=0;i<data.length;i++){if(data[i].baseType==option.type){_this.tree.showNode(data[i]);if(option.val=='all'){continue;}else if(option.val=='none'){_this.tree.hideNode(data[i]);}else if(data[i].type!=option.val){_this.tree.hideNode(data[i]);}}}}
if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,data);}
return data;},getChildren:function getChildren(treeNode,func,opt){var _this=this;var postData={parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};return WebAPI.post('/iot/search',postData).done(function(resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
var tempArr=[];for(var ele in resultData){if(ele=='class')continue;if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,resultData[ele],ele);}
var flag;for(var i=0;i<resultData[ele].length;i++){for(var j=0;j<_this.store[ele].length;j++){if(_this.store[ele][j]['_id']==resultData[ele][i]['_id']){if(ele=='groups'&&!resultData[ele][i].pId){resultData[ele][i].pId=resultData[ele][i]['_idProj'];}
if(_this.store[ele][j]['pId']==resultData[ele][i]['pId']){flag=true;}else{if(treeNode.children){for(var k=0;k<treeNode.children.length;k++){if(resultData[ele][i]['_id']==treeNode.children[k]['_id']){flag=true;break;}}}}
break;}}
if(resultData[ele][i].icon){resultData[ele][i].iconSkin='iconfont '+resultData[ele][i].icon;delete resultData[ele][i].icon;}
if(_this.opt.tree.base.expandReload||!flag){if(ele=='groups'||ele=='projects'){resultData[ele][i].isParent=true;}
resultData[ele][i].baseType=ele;if(!flag){_this.store[ele].push(resultData[ele][i]);}
tempArr.push(resultData[ele][i]);}}}
if(_this.opt.tree.base.expandReload){_this.tree.removeChildNodes(treeNode);}
if(tempArr.length==0){func(resultData);return;}
if(!opt||opt.add!==false){_this.tree.addNodes(treeNode,tempArr,true);}
if(!opt||opt.expand!==false){_this.tree.expandNode(treeNode,null,false,true,true);}
_this.initClassPane();func(resultData);});},childAppend:function childAppend(treeNode,func){var _this=this;if(treeNode.open){_this.tree.expandNode(treeNode,null,false,true,true);return;}else{if(treeNode.baseType=='things'){func();_this.tree.expandNode(treeNode,null,false,true,true);return;}else{var postData={parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};WebAPI.post('/iot/search',postData).done(function(resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
var tempArr=[];for(var ele in resultData){if(ele=='class')continue;if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,resultData[ele],ele);}
var flag;for(var i=0;i<resultData[ele].length;i++){for(var j=0;j<_this.store[ele].length;j++){if(_this.store[ele][j]['_id']==resultData[ele][i]['_id']){if(ele=='groups'&&!resultData[ele][i].pId){resultData[ele][i].pId=resultData[ele][i]['_idProj'];}
if(_this.store[ele][j]['pId']==resultData[ele][i]['pId']){flag=true;}else{if(treeNode.children){for(var k=0;k<treeNode.children.length;k++){if(resultData[ele][i]['_id']==treeNode.children[k]['_id']){flag=true;break;}}}}
_this.store[ele][j]=resultData[ele][i];break;}}
if(_this.opt.tree.base.expandReload||!flag){if(ele=='groups'||ele=='projects'){resultData[ele][i].isParent=true;}
resultData[ele][i].baseType=ele;if(!flag){_this.store[ele].push(resultData[ele][i]);}
tempArr.push(resultData[ele][i]);}}}
if(_this.opt.tree.base.expandReload){_this.tree.removeChildNodes(treeNode);}
if(tempArr.length==0){func();_this.tree.expandNode(treeNode,null,false,true,true);return;}
_this.tree.addNodes(treeNode,tempArr,true);for(var base in _this.showStatus){_this.initTreeData({'type':base,'val':_this.showStatus[base]});}
_this.tree.expandNode(treeNode,null,false,true,true);_this.initClassPane();func();});}}},initAddPane:function initAddPane(){var _this=this;_this.$paneAdd=$('#paneIotAdd');var $btnAdd=$('.btnAddEle');$btnAdd.click(function(e){var parentNode=_this.tree.getSelectedNodes()[0];var callBack;if(typeof _this.opt.tree.tool.beforeAdd=='function'){callBack=_this.opt.tree.tool.beforeAdd.call(_this,parentNode);}
if(typeof _this.opt.tree.tool.beforeAdd.act=='function'){callBack=_this.opt.tree.tool.beforeAdd.act.call(_this,parentNode);}
if(callBack&&callBack.parentNode){parentNode=callBack.parentNode;}
if(parentNode.length==0){alert('');return;}
if(callBack&&callBack.isForbid){alert(callBack.msg);return;}
new CreateDeviceModal({mode:'add',baseType:$(e.currentTarget).attr('typeAdd'),filter:_this,parentNode:parentNode});});}};return HierFilter;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var CreateDeviceModal=function(){var _this;function CreateDeviceModal(opt){_this=this;this.devices=null;this.names=null;this.type=null;this.mode=opt.mode;this.baseType=opt.baseType?opt.baseType:undefined;this.filter=opt.filter?opt.filter:undefined;this.parentNode=opt.parentNode;this.treeNode=opt.treeNode;this.group=[];this.prefix=null;this.batch=null;this.batchErr={name:false,prefix:false};this.show();}
CreateDeviceModal.prototype={show:function show(){var _this=this;if(_this.mode=='add'&&_this.baseType=='things'&&_this.parentNode.baseType=='projects'){alert('');return;}
WebAPI.get("/static/scripts/iot/config/addThing.html").done(function(rsHtml){_this.content=rsHtml;_this.$createDev=$("#modalIotCfg");_this.$createDev.find("#ctnIotCfg").html(rsHtml);if(_this.mode=='add'){_this.$createDev.find('.modal-title').text(''+_this.baseType);}else{_this.$createDev.find('.modal-title').text(''+_this.baseType);}
_this.$createDev.modal({backdrop:'static',keyboard:false});_this.init();});},init:function init(){var _this=this;_this.names=[];_this.devices=[];_this.prefix=[];_this.type="";_this.batch=false;_this.$createDev.modal('show');_this.$innerSLD=$("#createModalSld");_this.closeBtn=document.getElementById("closeBtn");_this.skipBtn=document.getElementById("skipBtn");_this.nextBtn=document.getElementById("nextBtn");_this.confirmBtn=document.getElementById("confirmBtn");_this.nameInput=document.getElementById("nameInput");_this.nameConfigInput=document.getElementById("batchNameArea");_this.prefixInput=document.getElementById("prefixInput");_this.typeList=document.getElementById("typeList");_this.groupList=document.getElementById("addedGroup");_this.bindDataGroup=document.getElementById("bindDataGroup");_this.typeDataSource=null;if(_this.parentNode.baseType=='things'){_this.parentNode=_this.parentNode.getParentNode();}
_this.initTypeList();_this.initParentType();if(_this.mode=='edit'){_this.initEditMode();}
_this.attachEvent();},attachEvent:function attachEvent(){var _this=this;var btnAddParent=document.getElementById("btnAddParent");btnAddParent.addEventListener("click",_this.parentAdd,false);_this.closeBtn.onclick=function(){_this.closeModal(false);};_this.confirmBtn.onclick=function(){_this.closeModal(true);};_this.nextBtn.onclick=function(){var currentIndex=_this.$innerSLD.find('.active').index();_this.checkValid(currentIndex);};_this.$innerSLD.on('slide.bs.carousel',_this.onCarouselMove);$(".batchBtn").on("change",function(){var batch=$(this).attr("data-batch");if(batch==="true"){$("#divNameBatch").removeClass("hide");$("#divPrefixBatch").removeClass("hide");_this.batch=true;}else{$("#divNameBatch").addClass("hide");$("#divPrefixBatch").addClass("hide");_this.batch=false;}});},closeModal:function closeModal(flag){var _this=this;if(flag){if(_this.mode=='add'){_this.addModeClose();}else if(_this.mode=='edit'){_this.editModeClose();}
_this.devices=null;_this.name=null;_this.type=null;_this.group=[];_this.prefix=null;_this.batch=false;_this.$createDev.modal('hide');_this.$createDev.find("#dialogContent").empty();}else{var callback=function callback(){_this.devices=null;_this.names=null;_this.type=null;_this.group=[];_this.prefix=null;_this.batch=false;_this.$createDev.modal('hide');_this.$createDev.find("#dialogContent").empty();};var message="";infoBox.confirm(message,callback);}},editModeClose:function editModeClose(){var postData=[];var node={};for(var i=0;i<_this.devices.length;i++){node={'_id':_this.treeNode['_id'],name:_this.devices[i].name,arrP:_this.devices[i].arrP,_idProj:_this.parentNode.baseType=='projects'?_this.parentNode['_id']:_this.parentNode['_idProj'],projId:_this.parentNode.projId,pId:_this.parentNode.baseType=='projects'?undefined:_this.pId,path:null,prefix:_this.devices[i].prefix,type:_this.type,weight:0,baseType:_this.baseType};if(_this.treeNode['params'])node.params=_this.treeNode['params'];postData.push(node);}
WebAPI.post('/iot/setIotInfo',postData).done(function(result){if(result.data&&result.data.length==0)return;$.extend(true,_this.treeNode,postData[0]);_this.filter.tree.updateNode(_this.treeNode);for(var i=0;i<_this.filter.store[_this.treeNode['baseType']].length;i++){if(_this.filter.store[_this.treeNode['baseType']][i]['_id']==_this.treeNode['_id']){for(var ele in _this.filter.store[_this.treeNode['baseType']][i]){_this.filter.store[_this.treeNode['baseType']][i][ele]=_this.treeNode[ele];}
break;}}
var func;if(typeof _this.filter.opt.tree.tool.edit=='function'){func=_this.filter.opt.tree.tool.edit;}else if(typeof _this.filter.opt.tree.tool.edit.act=='function'){func=_this.filter.opt.tree.tool.edit.act;}else{return;}
if(_this.mode=='edit'){func.call(_this.filter,_this.treeNode);}});},addModeClose:function addModeClose(){var postData=[];for(var i=0;i<_this.devices.length;i++){postData.push({name:_this.devices[i].name,arrP:_this.devices[i].arrP,_idProj:_this.parentNode.baseType=='projects'?_this.parentNode['_id']:_this.parentNode['_idProj'],projId:_this.parentNode.projId,pId:_this.parentNode.baseType=='projects'?undefined:_this.pId,path:null,prefix:_this.devices[i].prefix,type:_this.type,weight:0,baseType:_this.baseType});}
WebAPI.post('/iot/setIotInfo',postData).done(function(result){if(result.data&&result.data.length==0)return;postData.forEach(function(val,index){val['_id']=result.data[index];if(_this.baseType=='groups'){val.isParent=true;}});var arrParent=[];var arrNodes=[];var parent;if(_this.pId instanceof Array){arrParent.push(_this.parentNode);_this.filter.tree.addNodes(_this.parentNode,postData);for(var i=0;i<_this.pId.length;i++){if(_this.parentNode['_id']==_this.pId[i])continue;parent=_this.filter.tree.getNodeByParam('_id',_this.pId[i]);arrParent.push(parent);_this.filter.tree.addNodes(parent,postData);}}else{_this.filter.tree.addNodes(_this.parentNode,postData);arrParent.push(_this.parentNode);}
_this.filter.store[_this.baseType]=_this.filter.store[_this.baseType].concat(postData);var func;if(typeof _this.filter.opt.tree.tool.add=='function'){func=_this.filter.opt.tree.tool.add;}else if(typeof _this.filter.opt.tree.tool.add.act=='function'){func=_this.filter.opt.tree.tool.add.act;}else{return;}
for(var i=0;i<postData.length;i++){arrNodes.push(_this.filter.tree.getNodeByParam('_id',postData[i]['_id']));}
func.call(_this.filter,arrParent,arrNodes);});},initEditMode:function initEditMode(){$('#divBatch').hide();$('#nameInput').val(_this.treeNode.name);$('#prefixInput').val(_this.treeNode.prefix);},createDevice:function createDevice(){var _this=this;var typeProp;for(var i=0,len=_this.names.length;i<len;i++){var obj={};obj.name=_this.names[i];obj.type=_this.type;if(_this.prefix&&_this.prefix[i]){obj.prefix=_this.prefix[i];}else{obj.prefix='';}
obj.attrs=[];obj.arrP={};typeProp=_this.typeDataSource[_this.type];for(var attr in typeProp['attrs']){if(typeProp['attrs'].hasOwnProperty(attr)){var att={};att['name']=attr;att["fullName"]=obj.prefix+attr;att["cnName"]=typeProp['attrs'][attr]["name"];att["value"]='--';att["id"]=null;obj["attrs"].push(att);}}
_this.devices.push(obj);}},updateDevice:function updateDevice(){var _this=this;},initTypeList:function initTypeList(){var _this=this;var arrHtml=["<option value='-1'></option>"];var $typeList=$("#typeList");var clsList=[];_this.typeDataSource=_this.filter.dictClass[_this.baseType];var baseType=_this.baseType.substring(0,_this.baseType.length-1);baseType=baseType?baseType:_this.treeNode.baseType.substring(0,_this.treeNode.baseType-1);WebAPI.get('/iot/getClassFamilyByProjId/'+_this.parentNode.getPath()[0]['_id']+'/'+baseType+'/cn').done(function(result){if(!result||$.isEmptyObject(result)){clsList=_this.typeDataSource;}else{clsList=result;}
for(var obj in clsList){if(clsList.hasOwnProperty(obj)){var name=clsList[obj]["name"];if(obj=='Thing'||obj=='Group'){arrHtml.push("<option selected value='"+obj+"'>"+name+"</option>");}else{arrHtml.push("<option value='"+obj+"'>"+name+"</option>");}}}
$typeList.html(arrHtml.join(''));if(_this.mode=='edit'){$('#typeList').val(_this.treeNode.type);}});},initParentType:function initParentType(){var _this=this;var arrHtml=['<option value="-1"></option>'];var $parentTypeList=$("#parentTypeList");var $parentList=$('.parentList');if(_this.baseType=='groups'){$parentList.html('<option value="'+_this.parentNode['_id']+'">'+_this.parentNode.name+'</option>');$parentList.attr("disabled","disabled");}else{$parentList.html(arrHtml.join(''));$('#btnAddParent').show();}
_this.groupDataSource=_this.filter.dictClass[_this.parentNode.baseType];if(_this.baseType=="groups"&&_this.groupDataSource[_this.parentNode.type]){$parentTypeList.html('<option value="'+_this.parentNode.type+'">'+_this.groupDataSource[_this.parentNode.type].name+'</option>').attr('disabled','disabled');return;}
for(var obj in _this.groupDataSource){if(_this.groupDataSource.hasOwnProperty(obj)){var name=_this.groupDataSource[obj]["name"];arrHtml.push("<option value='"+obj+"'>"+name+"</option>");}}
var arrParentList=['<option value="-1"></option>'];for(var i=0;i<_this.filter.store.groups.length;i++){if(_this.filter.store.groups[i]['_id']==_this.parentNode['_id']){$parentList.val(_this.parentNode['_id']);}
arrParentList.push('<option value="'+_this.filter.store.groups[i]['_id']+'">'+_this.filter.store.groups[i].name+'</option>');}
$parentList.html(arrParentList.join(''));$parentTypeList.html(arrHtml.join(''));if(_this.mode=='add'){$parentList.val(_this.parentNode['_id']);}else if(_this.mode=='edit'){if(typeof _this.treeNode.pId=='string'){$('.parentList').eq(0).val(_this.treeNode.pId);}else if(_this.treeNode.pId instanceof Array){$('.parentList').eq(0).val(_this.treeNode.pId[0]);for(var i=1;i<_this.treeNode.pId.length;i++){_this.parentAdd().val(_this.treeNode.pId[i]);}}}
$parentTypeList.on("change",function(){if(_this.baseType=='groups')return;var selectedOpt=$("#parentTypeList option:selected").attr("value");_this.getParentList(selectedOpt);});},getParentList:function getParentList(val){var _this=this;var arrHtml=["<option value='-1'></option>"];var $parentList=$('.parentList');for(var i=0;i<_this.filter.store.groups.length;i++){if(val==-1||_this.filter.store.groups[i].type==val){if(_this.filter.store.groups[i]['_id']==_this.parentNode['_id']){$parentList.val(_this.parentNode['_id']);}
arrHtml.push('<option value="'+_this.filter.store.groups[i]['_id']+'">'+_this.filter.store.groups[i].name+'</option>');}else{}}
$parentList.html(arrHtml.join(""));},parentAdd:function parentAdd(){var $divParentList=$($('.divParentList')[0].outerHTML);$('#boxParentList').append($divParentList);return $divParentList;},generateName:function generateName(){var _this=this;var input=_this.nameInput.value.trim();var names=[];if(_this.batch){try{var config=$("#batchNameArea").val().trim();config=config.replace(/([\w]+)(:)/g,"\"$1\"$2");config=config.replace(/'/g,"\"");if(config==''){alert('');return names;}else{var nameConfig=JSON.parse(config);for(var item in nameConfig){if(nameConfig.hasOwnProperty(item)){var reg=new RegExp('<#'+item+'#>','g');if(Object.prototype.toString.call(nameConfig[item]).slice()==='[object Array]'){for(var j=0;j<nameConfig[item].length;j++){if(names.length!==nameConfig[item].length){names.push(input.replace(reg,nameConfig[item][j]));}else{names[j]=names[j].replace(reg,nameConfig[item][j]);}}}else{var min=parseInt(nameConfig[item]["min"],10);var max=parseInt(nameConfig[item]["max"],10);var step=parseInt(nameConfig[item]["step"],10)||1;for(var k=0;k<max-min+1;k++){if(names.length!==max-min+1){names.push(input.replace(reg,k+min));}else{console.log(_typeof(names[k]));names[k]=names[k].replace(reg,k*step+min);}}}}}}}catch(e){_this.batchErr.name=true;}}else{names.push(input);}
return names;},generatePrefix:function generatePrefix(){var _this=this;var input=_this.prefixInput.value.trim();var prefix=[];if(_this.batch){try{if(input===''||input.length===0){for(var i=0;i<_this.names.length;i++){prefix.push('');}}else{var config=$("#batchPrefixArea").val().trim();config=config.replace(/([\w]+)(:)/g,"\"$1\"$2");config=config.replace(/'/g,"\"");if(config==''){alert('');return prefix;}
var prefixConfig=JSON.parse(config);for(var item in prefixConfig){if(prefixConfig.hasOwnProperty(item)){var reg=new RegExp('<#'+item+'#>','g');if(Object.prototype.toString.call(prefixConfig[item]).slice()==='[object Array]'){var pre;for(var j=0;j<prefixConfig[item].length;j++){if(prefix.length!==prefixConfig[item].length){pre=input.replace(reg,prefixConfig[item][j]);prefix.push(pre);}else{pre=prefix[j].replace(reg,prefixConfig[item][j]);prefix[j]=pre;}}}else{var min=parseInt(prefixConfig[item]["min"],10);var max=parseInt(prefixConfig[item]["max"],10);for(var k=0;k<max-min+1;k++){if(prefix.length!==max-min+1){prefix.push(input.replace(reg,k+min));}else{console.log(_typeof(prefix[k]));prefix[k]=prefix[k].replace(reg,k+min);}}}}}}}catch(e){_this.batchErr.prefix=true;}}else{if(input===''||input.length===0){prefix.push('');}else{prefix.push(input);}}
return prefix;},generatePId:function generatePId(){var $parentList=$('.parentList');var pId={};var arrPId=[];pId[_this.parentNode['_id']]=true;for(var i=0;i<$parentList.length;i++){if($parentList.eq(i).val()&&$parentList.eq(i).val()!='-1'){pId[$parentList.eq(i).val()]=true;}}
for(var ele in pId){arrPId.push(ele);}
if(arrPId.length==1)arrPId=arrPId.toString();return arrPId;},addGroup:function addGroup(){var _this=this;var groupList=document.getElementById("groupList"),subGroupList=document.getElementById("subGroupList"),group=groupList.options[groupList.selectedIndex].value,subGroup=subGroupList.options[subGroupList.selectedIndex].value,subGroupName=subGroupList.options[subGroupList.selectedIndex].text;if(group!=="-1"&&subGroup!=="-1"){var addedGroup=document.getElementById("addedGroup");var div=document.createElement("div"),name=document.createElement("span"),rmBtn=document.createElement("div"),icon=document.createElement("span");div.className="col-sm-3 btn";div.setAttribute("data-group",group);div.setAttribute("data-subgroup",subGroup);div.setAttribute("data-name",subGroupName);name.innerHTML=subGroupName;icon.className="glyphicon glyphicon-minus";rmBtn.appendChild(icon);rmBtn.style.float="right";div.appendChild(name);div.appendChild(rmBtn);addedGroup.appendChild(div);if(addedGroup.classList.contains("hide")){addedGroup.classList.remove("hide");}
rmBtn.onclick=function(e){var addedGroup=document.getElementById("addedGroup"),currentRow=e.target.parentElement.parentElement;addedGroup.removeChild(currentRow);if(addedGroup.childElementCount===0){addedGroup.classList.add("hide");}};}},removeGroup:function removeGroup(e){var addedGroup=document.getElementById("addedGroup"),currentRow=e.parentNode;addedGroup.removeChild(currentRow);if(addedGroup.childElementCount===0){addedGroup.classList.add("hide");}},getAddedGroup:function getAddedGroup(){var _this=this;var arr=[];var groupRow=document.getElementById("addedGroup").childNodes;for(var i=0;i<groupRow.length;i++){if(groupRow[i].nodeName.toLowerCase()=='div'&&groupRow[i].hasAttribute("data-group")){var g={};g.group=groupRow[i].getAttribute("data-group");g.subGroup=groupRow[i].getAttribute("data-subGroup");g.name=groupRow[i].getAttribute("data-name");arr.push(g);}}
return arr;},getBindDataSource:function getBindDataSource(){var _this=this;_this.devices.forEach(function(val,index){var device=val;var p=device.prefix;var attrs=device.attrs;var arrP=device.arrP;WebAPI.get("/point_tool/searchCloudPoint/"+_this.parentNode.projId+"/"+p+"/").done(function(result){if(result.success){var data=result.data["pointTable"];if(data.length==0){_this.initBindData(device);return;}
var idGroup=[];for(var n=0,len=data.length;n<len;n++){idGroup.push(data[n]._id);}
for(var j=0;j<attrs.length;j++){for(var k=0;k<data.length;k++){if(attrs[j]["fullName"]===data[k]["value"]){attrs[j]["id"]=data[k]["_id"];arrP[attrs[j]["name"]]=data[k]["_id"];}}}
var postData={"dsItemIds":idGroup};WebAPI.post('/analysis/startWorkspaceDataGenPieChart',postData).done(function(result){if(result.dsItemList&&result.dsItemList.length>0){var d=result["dsItemList"];for(var l=0;l<attrs.length;l++){for(var m=0;m<d.length;m++){if(attrs[l]["id"]===d[m]["dsItemId"]){attrs[l]["value"]=d[m]["data"];}}}}else{console.log("the data of bind point is not loaded");}
_this.initBindData(device);});}else{console.log("the data of prefix attrs is not loaded");}}).fail(function(){_this.initBindData(device);});});},initBindData:function initBindData(device){var _this=this;var names=_this.names;var frag=document.createDocumentFragment();var name=document.createElement("label"),wrap=document.createElement("div"),container=document.createElement("div");wrap.className="form-group row";container.className="container-fluid";container.setAttribute("data-name",device.name);name.className="text-center col-sm-12 form-control-label";name.innerHTML="(Name)"+device.name;wrap.appendChild(name);container.appendChild(wrap);for(var k=0,leng=device.attrs.length;k<leng;k++){var div=document.createElement("div"),lab=document.createElement("label"),cnlab=document.createElement("label"),btn=document.createElement("div");div.className="form-group row";lab.className="text-center col-sm-4 form-control-label";cnlab.className="text-center col-sm-4 form-control-label";btn.className="btn text-center col-sm-3";div.id=device.attrs[k]["id"];lab.innerHTML=device.attrs[k]["fullName"];cnlab.innerHTML=device.attrs[k]["cnName"];btn.innerHTML=device.attrs[k]["value"];div.appendChild(lab);div.appendChild(cnlab);div.appendChild(btn);container.appendChild(div);}
frag.appendChild(container);_this.bindDataGroup.appendChild(frag);},generateFullBindData:function generateFullBindData(){var _this=this;var arr=[];for(var i=0;i<_this.devices.length;i++){for(var attr in _this.type["attrs"]){if(_this.type["attrs"].hasOwnProperty(attr)){var obj={};obj["fullName"]=_this.devices[i]["prefix"]+attr;obj["cnName"]=_this.type["attrs"][attr]["name"];obj["value"]='--';obj["id"]=null;arr.push(obj);_this.devices[i]["attrs"].push(obj);}}}
return arr;},onCarouselMove:function onCarouselMove(){var _this=this;var currentIndex=$(this).find('.active').index()+1;if(currentIndex!==1){}else{$("#nextBtn").hide();$("#confirmBtn").removeClass("hide");}},checkValid:function checkValid(index){var _this=this;var valid;if(index===0){_this.batchErr={name:false,prefix:false};_this.names=_this.generateName();_this.prefix=_this.generatePrefix();if(_this.nameInput.value.trim()===""){alert("");_this.nameInput.focus();valid=false;}else if(_this.batch&&_this.nameConfigInput.value.trim()===""){alert("");_this.nameConfigInput.focus();}else if(_this.typeList.options[_this.typeList.selectedIndex].value==='-1'){alert("");_this.typeList.focus();valid=false;}else if(_this.batchErr.name){alert("");}else if(_this.batchErr.prefix){alert("");}else{valid=true;}
if(valid){_this.type=_this.typeList.options[_this.typeList.selectedIndex].value;_this.pId=_this.generatePId();_this.createDevice();if(_this.mode=='edit'||_this.prefix&&_this.prefix instanceof Array&&_this.prefix.join('').length>0){_this.getBindDataSource();$("#createModalSld").carousel("next");}else{_this.closeModal(true);}}}}};return CreateDeviceModal;}();(function(exports){function PagePanel(screen){this.screen=screen;this.container=screen.pagePanelCtn;this.project=screen.project;this.treeView=null;}
PagePanel.prototype.init=function(){this.treeView=new TreeView(this);this.treeView.show();};PagePanel.prototype.show=function(){};PagePanel.prototype.hide=function(){};PagePanel.prototype.save=function(data){this.screen.syncWorker.save(data);};PagePanel.prototype.getPageList=function(){return this.treeView.getPageList();};PagePanel.prototype.onPageResize=function(width,height){var page=this.screen.page;var painter=null;if(page){painter=page.painter;painter.resizePage(width,height);}};PagePanel.prototype.close=function(){this.treeView.close();this.container.innerHTML='';};exports.PagePanel=PagePanel;})(window);(function(){var _this;function TreeView(screen){_this=this;this.screen=screen;this.container=screen.container;this.treeObj=undefined;this.projectId=screen.project.id;this.init();}
TreeView.prototype.layerTools=[{id:'delGroupPage',name:'Delete',icon:'glyphicon glyphicon-trash',iconType:1},{id:'importPageTemplet',name:'import',icon:'glyphicon glyphicon-import',iconType:1},{id:'exportPageTemplet',name:'export',icon:'glyphicon glyphicon-export',iconType:1},{id:'editPage',name:'Edit',icon:'glyphicon glyphicon-edit',iconType:1},{id:'addPage',name:'Add Page',icon:'glyphicon glyphicon-file',iconType:1},{id:'addGroup',name:'Add Group',icon:'glyphicon glyphicon-folder-open',iconType:1}];TreeView.prototype.init=function(){this.container.innerHTML='<ul id="treeControl" class="ztree gray-scrollbar"></ul>';this.$treeWrap=$('#treeControl',this.container);};TreeView.prototype.show=function(){this.ajaxRequestTree=WebAPI.get('/factory/getPageList/'+_this.projectId+'/1');this.ajaxRequestTree.done(function(result){if(result&&result.status!=='OK'){alert(result.msg);return;}
if(result&&result.data){var zTreeOnNodeCreated=function zTreeOnNodeCreated(event,treeId,treeNode){$('#'+treeNode.tId+'_switch',_this.$treeWrap).prependTo($('#'+treeNode.tId+'_a',_this.$treeWrap));$("#"+treeNode.tId,_this.$treeWrap).addClass('tree-page-hover');if(treeNode.type!='DropDownList'&&treeNode.iconSkin&&treeNode.iconSkin!=''){$("#"+treeNode.tId+"_switch",_this.$treeWrap).removeClass("button").addClass("glyphicon glyphicon-"+treeNode.iconSkin);}else{$("#"+treeNode.tId+"_a",_this.$treeWrap).addClass("isFloder");}
if(treeNode.getIndex()===0&&$("#"+treeNode.tId,_this.$treeWrap).next().children('span').length===0){var row=$("#"+treeNode.tId,_this.$treeWrap).next().children('a');if(row.length>0){var icon=row.find('span').eq(1).attr('class').split(' ')[1].split('_')[0];if(icon!='ico'&&row.find('span').eq(0).hasClass('button')){row.find('span').eq(0).removeClass("button").addClass("glyphicon glyphicon-"+icon);}}}};var zTreeOnClick=function zTreeOnClick(event,treeId,treeNode){var $liLayer=$("#"+treeNode.tId);if(event.ctrlKey){if($liLayer.hasClass('curSelectedNode')){$liLayer.removeClass('curSelectedNode');}else{$liLayer.addClass('curSelectedNode');}}else{$liLayer.addClass('curSelectedNode');$('#treeControl *').not($liLayer).removeClass('curSelectedNode');}};var zTreeOnDblClick=function zTreeOnDblClick(event,treeId,treeNode){$('#declareVariablesModalWrap')&&DeclareVariablesModal.hide();if(!treeNode.isParent){if(treeNode&&treeNode.id){var openedNodes=$('#treeControl').find('.curOpenedNode');if(openedNodes){openedNodes.removeClass('curOpenedNode');}
var curNode=$('#'+treeNode.tId);curNode.removeClass('curSelectedNode');curNode.addClass('curOpenedNode');_this.screen.screen.showPage(treeNode);}}else{}};var zTreeOnCollapse=function zTreeOnCollapse(event,treeId,treeNode){$("#"+treeNode.tId+"_ico",_this.$treeWrap).addClass("glyphicon glyphicon-"+treeNode.iconSkin);};var zTreeOnExpand=function zTreeOnExpand(event,treeId,treeNode){$("#"+treeNode.tId+"_ico",_this.$treeWrap).addClass("glyphicon glyphicon-"+treeNode.iconSkin);};var zTreeBeforeDrop=function zTreeBeforeDrop(treeId,treeNodes,targetNode,moveType){if(!targetNode){return false;}
if(!targetNode.isParent&&'inner'==moveType){return false;}
else if(treeNodes[0].type!=='DropDownList'){return true;}else if('inner'==moveType&&targetNode.level>=1){alert(I18n.resource.mainPanel.layerPanel.DIRECTORY_STRUCTRUE);return false;}else if(['prev','next'].indexOf(moveType)>-1&&targetNode.level>=2){alert(I18n.resource.mainPanel.layerPanel.DIRECTORY_STRUCTRUE);return false;}else{return true;}};var zTreeOnDrop=function zTreeOnDrop(event,treeId,treeNodes,targetNode,moveType){treeNodes.forEach(function(row){$('#'+row.tId,_this.$treeWrap).addClass('curSelectedNode').find('#'+row.tId+'_a').removeClass('curSelectedNode');if(row.type!='DropDownList'&&row.iconSkin&&row.iconSkin!=''){$("#"+row.tId+"_switch",_this.$treeWrap).removeClass("button").addClass("glyphicon glyphicon-"+row.iconSkin);}});var allNode=$(_this.container).find("#treeControl li a");allNode.each(function(){var row=$(this);if(!row.hasClass('isFloder')){var icon=row.find('span').eq(1).attr('class').split(' ')[1].split('_')[0];if(icon!='ico'&&row.find('span').eq(0).hasClass('button')){row.find('span').eq(0).removeClass("button").addClass("glyphicon glyphicon-"+icon);}}});if(moveType==='inner'){treeNodes.forEach(function(row){var editData={id:row.id,parent:targetNode.id};_this.operatePage('/factory/page/edit/',editData);});}else{if(!targetNode)return;treeNodes.forEach(function(row){var editData={id:row.id,parent:targetNode.getParentNode()?targetNode.getParentNode().id:''};_this.operatePage('/factory/page/edit/',editData);});}
_this.syncPageList();};var zTreeOnRename=function zTreeOnRename(event,treeId,treeNode,isCancel){var editData={id:treeNode.id,text:treeNode.name};_this.operatePage('/factory/page/edit/',editData);};var addDiyDom=function addDiyDom(treeId,treeNode){var aObj=$("#"+treeNode.tId+"_switch");var $divTreeCfg=$('<div class="treeCfg"></div>');var $btnEye=$('<span class="nodeEye glyphicon"></span>');var $btnLock=$('<span class="iconfont"></span>');if(treeNode.isHide){$btnEye.addClass('glyphicon-eye-close');}else{$btnEye.addClass('glyphicon-eye-open');}
if(treeNode.isLock==1){$btnLock.html("&#xe670;").show();}else{$btnLock.html("&#xe68c;").show();}
$divTreeCfg.append($btnEye);$divTreeCfg.append($btnLock);aObj.next('a').after($divTreeCfg);$btnEye[0].onclick=function(){_this.switchEyeState($(this));var curTreeNode=_this.treeObj.getNodeByTId($(this).closest('li').attr('id'));var editData={id:curTreeNode.id,isHide:curTreeNode.isHide};_this.operatePage('/factory/page/edit/',editData);};$btnLock[0].onclick=function(){_this.switchLockState($(this));var curTreeNode=_this.treeObj.getNodeByTId($(this).closest('li').attr('id'));var editData={id:curTreeNode.id,isLock:curTreeNode.isLock};_this.operatePage('/factory/page/edit/',editData);};};var zSetting={view:{showIcon:false,showLine:false,fontCss:{color:"#ffffff"},addDiyDom:addDiyDom},edit:{enable:true,editNameSelectAll:true,showRenameBtn:true,showRemoveBtn:false},data:{keep:{parent:true},simpleData:{enable:true,idKey:'id',pIdKey:'pId',rootPId:0}},callback:{onClick:zTreeOnClick,onDblClick:zTreeOnDblClick.bind(_this),beforeDrop:zTreeBeforeDrop,onDrop:zTreeOnDrop,onRename:zTreeOnRename,onNodeCreated:zTreeOnNodeCreated}};;;;;;;var zProjNodes=_this.generateTreeEx(result.data);(function(){_this.treeObj=$.fn.zTree.init($('#treeControl'),zSetting,zProjNodes);var strHtml='',$ul=$('<ul class="list-inline treeToolWrap"></ul>');for(var i=0,tool;i<_this.layerTools.length;i++){tool=_this.layerTools[i];if(tool.iconType==1){strHtml+='<li id="'+tool.id+'"><span '+(tool.display?'style="display: '+tool.display+';"':'')+'" class="'+tool.icon+'" title="'+tool.name+'"></span></li>';}}
$ul.html(strHtml);$(_this.screen.container).append($ul);$('#addGroup',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.ADD_GROUP);$('#addPage',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.ADD_PAGE);$('#delGroupPage',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.DELETE_PAGE);$('#importPageTemplet',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.IMPORT_PAGE_TEMPLET);$('#exportPageTemplet',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.EXPORT_PAGE_TEMPLET);$('#editPage',_this.$treeWrap).attr('title',I18n.resource.mainPanel.layerPanel.EDIT_PAGE);$('#addGroup')[0].onclick=_this.funcAddGroup;$('#addPage')[0].onclick=_this.funcAddPage;$('#delGroupPage')[0].onclick=_this.funcDelGroupPage;$('#importPageTemplet')[0].onclick=_this.importTemplate;$('#exportPageTemplet')[0].onclick=_this.exportTemplate;$('#editPage')[0].onclick=_this.funcEditPage;})();}}).always(function(e){Spinner.stop();});};TreeView.prototype.getPurePageDataFromTreeNode=function(treeNode){var parentTreeNode=this.treeObj.getNodeByTId(treeNode.parentTId);return{_id:treeNode.id,text:treeNode.name,type:treeNode.type,pic:treeNode.iconSkin,parent:parentTreeNode===null?'':parentTreeNode.id,layerList:treeNode.layerList,projId:treeNode.projId,isHide:treeNode.isHide,isLock:treeNode.isLock,width:treeNode.width,height:treeNode.height,display:treeNode.display,option:treeNode.option};};TreeView.prototype.remove=function(){};TreeView.prototype.generateTreeEx=function(arr){var result=[];var params;for(var i=0,len=arr.length;i<len;i++){var item=arr[i];params={projId:item.projId,id:item._id,pId:item.parent,name:item.text+' - '+item.type,type:item.type};if('DropDownList'==item.type){params={projId:item.projId,id:item._id,pId:item.parent,name:item.text,type:item.type,iconSkin:item.pic};params.isParent=true;params.isHide=item.isHide;params.isLock=item.isLock;result.push(params);}else if('PageScreen'==item.type){params.isParent=false;params.isHide=item.isHide;params.isLock=item.isLock;params.width=item.width;params.height=item.height;params.display=item.display;params.iconSkin=item.pic;params.option=item.option;result.push(params);}else if(item.type==='ReportScreen'){params.isParent=false;params.isHide=item.isHide;params.isLock=item.isLock;params.reportType=item.reportType;params.reportFolder=item.reportFolder;params.iconSkin=item.pic;result.push(params);}else{params.isParent=false;params.isHide=item.isHide;params.isLock=item.isLock;params.iconSkin=item.pic;result.push(params);}}
return result;};TreeView.prototype.generateTree=function(arr){arr.sort(function(a,b){return parseInt(a._id,16)>parseInt(b._id,16);});var dataTree=[];for(var i=0,lenI=arr.length;i<lenI;i++){if('DropDownList'==arr[i].type&&!arr[i].parent){dataTree.push({'id':arr[i]._id,'name':arr[i].text,'isParent':true,'children':[]});}}
for(var i=0,lenI=arr.length;i<lenI;i++){if('DropDownList'==arr[i].type&&arr[i].parent){for(var j=0,lenJ=dataTree.length;j<lenJ;j++){this.setNode(arr[i],dataTree[j]);}}}
for(var i=0,lenI=arr.length;i<lenI;i++){if('DropDownList'!=arr[i].type){if(!arr[i].parent){dataTree.push({'id':arr[i]._id,'name':arr[i].text,'isParent':false});}else{for(var j=0,lenJ=dataTree.length;j<lenJ;j++){this.setLeaf(arr[i],dataTree[j]);}}}}
return dataTree;};TreeView.prototype.setNode=function(node,tree){if(node.parent==tree.id&&tree.isParent){tree.children.push({'id':node._id,'name':node.text,'isParent':true,'children':[]});return;}else{for(var i=0,len=tree.children.length;i<len;i++){this.setNode(node,tree.children[i]);}}};TreeView.prototype.setLeaf=function(node,tree){if(tree.children){if(node.parent==tree.id&&tree.isParent){tree.children.push({'id':node._id,'name':node.text,'isParent':false});return;}else{for(var i=0,len=tree.children.length;i<len;i++){this.setLeaf(node,tree.children[i]);}}}};TreeView.prototype.switchLockState=function($lock){var treeNodeId=$lock.parent().parent().attr('id');var model=this.getModelByTreeNode(treeNodeId);var html,isLock;if(model.isLock==0){isLock=1;html="&#xe670;";}else{isLock=0;html="&#xe68c;";}
traverse(model);function traverse(model){var childNodes=model.children;if(!model)return;model.isLock=isLock;$("#"+model.tId,_this.$treeWrap).find('.iconfont:eq(0)').html(html).show();childNodes&&childNodes.forEach(function(child){child&&traverse(child);});}};TreeView.prototype.switchEyeState=function($eye){var treeNodeId=$eye.parent().parent().attr('id');var model=this.getModelByTreeNode(treeNodeId);var className;var isHide;if($eye.hasClass('glyphicon-eye-open')){isHide=1;className='glyphicon glyphicon-eye-close';}else{isHide=0;className='glyphicon glyphicon-eye-open';}
traverse(model);function traverse(model){var childNodes=model.children;if(!model)return;model.isHide=isHide;$("#"+model.tId,_this.$treeWrap).find('.treeCfg').find('.glyphicon:eq(0)').removeClass().addClass(className);childNodes&&childNodes.forEach(function(child){child&&traverse(child);});}};TreeView.prototype.getModelByTreeNode=function(treeNodeId){return this.treeObj.getNodeByTId(treeNodeId);};TreeView.prototype.operatePage=function(url,data){return WebAPI.post(url+this.projectId,data).done(function(rs){if(rs.status==='OK'){Log.info('sync data success!');}});};TreeView.prototype.funcAddGroup=function(){if(_this.treeObj){var parentId=null,grandfatherId=null;var parentNode=null,grandfatherNode=null;var projectId=null,pId='';var index=0;var selectNodes=_this.treeObj.getSelectedNodes();if(selectNodes.length>0){parentId=selectNodes[0].parentTId;projectId=selectNodes[0].projId;pId=selectNodes[0].pId;parentNode=_this.treeObj.getNodeByTId(parentId);if(parentNode){grandfatherId=parentNode.parentTId;grandfatherNode=_this.treeObj.getNodeByTId(grandfatherId);}
index=selectNodes[0].getIndex();};if(grandfatherNode){alert('');}else{var newId=ObjectId();var newNode={projId:_this.projectId,id:newId,pId:parentId,name:'new node','isParent':true,'open':true,type:'DropDownList','isHide':0,'isLock':0,iconSkin:""};var pageData={id:newId,'isHide':0,'isLock':0,parent:pId,pic:"",projId:_this.projectId,text:'new node',type:'DropDownList'};var ret=_this.treeObj.addNodes(parentNode,index,newNode);_this.treeObj.editName(ret[0]);var pageList=_this.treeObj.transformToArray(_this.treeObj.getNodes()).map(function(row){return row.id;});var saveData={page:pageData,list:pageList};_this.operatePage('/factory/page/save/',saveData);}}};TreeView.prototype.funcAddPage=function(){$(".modal-title").attr("i18n","mainPanel.pageEditModal.ADD_PAGE_TITLE");PageEditModal.show({projId:"",name:I18n.resource.mainPanel.pageEditModal.PAGE_NAME,type:'PageScreen',width:1920,height:980,disabled:0,display:0,iconSkin:'',option:{background:{color:'',type:'',url:'',display:''}}},_this.callbackAddPage);};TreeView.prototype.callbackAddPage=function(pageCfg){if(_this.treeObj){var parentId=null;var parentNode=null;var index=0;var selectNodes=_this.treeObj.getSelectedNodes();var newNode={id:pageCfg.id||ObjectId(),pId:null,projId:pageCfg.projId,name:pageCfg.name,isParent:false,isHide:0,isLock:0,type:pageCfg.type,iconSkin:pageCfg.iconSkin,pic:pageCfg.iconSkin};if(selectNodes.length>0){parentId=selectNodes[0].parentTId;parentNode=_this.treeObj.getNodeByTId(parentId);index=selectNodes[0].getIndex();}
var Data={id:newNode.id,projId:newNode.projId,text:newNode.name,isHide:0,isLock:0,parent:parentNode?parentNode.id:'',type:newNode.type,pic:newNode.iconSkin};var ret,pageData;switch(pageCfg.type){case'PageScreen':newNode=$.extend(false,newNode,{width:pageCfg.width,height:pageCfg.height,display:pageCfg.display,option:pageCfg.option});pageData=$.extend(false,Data,{width:pageCfg.width,height:pageCfg.height,display:pageCfg.display,option:pageCfg.option});break;case'FacReportScreen':newNode.isHide=1;pageData=$.extend(false,Data,{isHide:1});break;case'ReportScreen':newNode.reportType=pageCfg.reportType;newNode.reportFolder=pageCfg.reportFolder;pageData=$.extend(false,Data,{reportType:pageCfg.reportType,reportFolder:pageCfg.reportFolder});break;default:pageData=Data;break;}
ret=_this.treeObj.addNodes(parentNode,index,newNode);var pageList=_this.treeObj.transformToArray(_this.treeObj.getNodes()).map(function(row){return row.id;});var saveDate={page:pageData,list:pageList};_this.operatePage('/factory/page/save/',saveDate).done(function(){if(pageCfg.type==="DropDownList"){$('#'+ret[0].tId+'_span',_this.$treeWrap).text(pageCfg.name);}
$('#'+ret[0].tId+'_span',_this.$treeWrap).text(pageCfg.name+' - '+pageCfg.type);$('#'+ret[0].tId+'_a',_this.$treeWrap).dblclick();});}};TreeView.prototype.callbackAddPageBatch=function(arrPageCfg,isCopy){var _this=this;var arrLayer=[];var arrWidget=[];var arrPage=[];arrPageCfg.forEach(function(pageCfg){pageCfg.page.projId=_this.projectId;pageCfg.page.type='PageScreen';arrPage.push(pageCfg.page);arrLayer=arrLayer.concat(pageCfg.layers);arrWidget=arrWidget.concat(pageCfg.widgets);renderPage(pageCfg);});_this.syncPageList();this.screen.save({pages:arrPage,layers:arrLayer,widgets:arrWidget});infoBox.alert(I18n.resource.admin.welcom.addByTpl.PAGESCREEN_ADD_SUCCESS,{delay:1500});function renderPage(pageCfg){if(_this.treeObj){var parentNode=null;var index=0;var selectNodes=_this.treeObj.getSelectedNodes();var ret;var newNode={projId:pageCfg.page.projId,id:pageCfg.page._id,pId:null,name:pageCfg.page.text,isParent:false,isHide:pageCfg.page.isHide,isLock:pageCfg.page.isLock,iconSkin:pageCfg.page.pic,type:pageCfg.page.type,width:pageCfg.page.width,height:pageCfg.page.height,display:pageCfg.page.display,option:pageCfg.page.option,parent:pageCfg.page.parent};if(selectNodes.length===1){if(selectNodes[0].isParent){parentNode=selectNodes[0];newNode.pId=parentNode.id;index=-1;pageCfg.page.parent=parentNode.id;}else{parentNode=_this.treeObj.getNodeByTId(selectNodes[0].parentTId);index=selectNodes[0].getIndex();pageCfg.page.parent=!parentNode?'':parentNode.id;}}
ret=_this.treeObj.addNodes(parentNode,index,newNode);$('#'+ret[0].tId+'_span',_this.$treeWrap).text(pageCfg.page.text+' - PageScreen');}}};TreeView.prototype.funcDelGroupPage=function(){return function(){if(_this.treeObj){var selectNodes=_this.treeObj.getSelectedNodes();if(selectNodes.length<1){return;}
var show='';for(var i=0,len=selectNodes.length;i<len;i++){show+=selectNodes[i].name+'\n';}
show+='Be sure to delete ?';confirm(show,function(){var data={removeNodesIds:[],removePageNodesIds:[]};var newData=getChildrenId(selectNodes,data);if(_this.screen.screen.page){if(newData.removePageNodesIds.indexOf(_this.screen.screen.page.page.id)>-1){_this.screen.screen.page.close();_this.screen.screen.page=null;}}
var arr=[];selectNodes.forEach(function(row){arr.push(row.id);});var pageList=_this.treeObj.transformToArray(_this.treeObj.getNodes()).map(function(row){return row.id;});var delData={page:arr,list:pageList};_this.operatePage('/factory/page/delete/',delData);});}};function getChildrenId(item,data){if(item){item.forEach(function(row){_this.treeObj.removeNode(row,true);if(!row.isParent){data.removePageNodesIds.push(row.id);data.removeNodesIds.push(row.id);}else{data.removeNodesIds.push(row.id);return getChildrenId(row.children,data);}});return data;}}}();TreeView.prototype.importTemplate=function(){var selected=_this.treeObj.getSelectedNodes();MaterialModal.show([{'title':'Template',data:['Page.PageScreen','Page.EnergyScreen','Page.EnergyScreen_M']}],function(data,isCopy){var params;if(data.length){_this.callbackAddPageBatch(data,isCopy);}else{if(data.type.indexOf('ReportScreen')>-1){alert('');return;}
params={id:ObjectId(),name:'Untitled',type:data.type.split('.')[1]};WebAPI.post('/spring/saveLayout',{creatorId:AppConfig.userId,menuItemId:params.id,isFactory:1,layout:JSON.parse(data.content.template)}).done(function(result){_this.callbackAddPage(params);});}});};TreeView.prototype.exportTemplate=function(){var selectNodes=_this.treeObj.getSelectedNodes(),node;var templateName,data;var page;if(selectNodes.length!==1){alert(I18n.resource.mainPanel.layerPanel.EXPORT_PAGE_TEMPLET_INFO);return;}
templateName=prompt(I18n.resource.mainPanel.layerPanel.WRITE_TEMPLET_NAME);if(!templateName)return;node=selectNodes[0];data={_id:ObjectId(),pageId:node.id,name:templateName,creator:AppConfig.userProfile.fullname,time:new Date().format('yyyy-MM-dd HH:mm:ss'),'public':1,isFolder:0,group:'',content:{}};if(node.type==='PageScreen'){data.type='page.PageScreen';data.content={width:node.width,height:node.height,display:node.display,iconSkin:node.iconSkin,option:node.option.background?node.option:{background:{}}};WebAPI.get('factory/getPageDetail/'+node.id+'/'+AppConfig.isFactory).done(function(result){data.content.template=JSON.stringify({list:result.page.layerList,layers:result.data.layers,widgets:result.data.widgets});_this.savePageTemplateData(data);});}else if(node.type==='EnergyScreen'||node.type==='EnergyScreen_M'){data.type='page.'+node.type;WebAPI.get("/spring/get/"+node.id+'/'+AppConfig.isFactory).done(function(result){data.content.template=JSON.stringify(result.layout);_this.savePageTemplateData(data);});}else if(node.type==='FacReportWrapScreen'){alert('');return;}else if(node.type==='FacReportScreen'){data.type='page.ReportScreen';WebAPI.get("/spring/get/"+node.id+'/'+AppConfig.isFactory).done(function(result){data.content.template=JSON.stringify({layout:result.layout[0][0]});_this.savePageTemplateData(data);});}};TreeView.prototype.savePageTemplateData=function(data){WebAPI.post('/factory/material/save',data).done(function(result){if(result&&result._id){data._id=result._id;}}).always(function(){});};TreeView.prototype.funcEditPage=function(){$(".modal-title").attr("i18n","mainPanel.pageEditModal.EDIT_PAGE_TITLE");var selectNodes=_this.treeObj.getSelectedNodes();if(selectNodes&&selectNodes.length===1){if(!selectNodes[0].display){selectNodes[0].display=0;}
var src={projId:selectNodes[0].projId,name:selectNodes[0].name,type:selectNodes[0].type,width:selectNodes[0].width,height:selectNodes[0].height,disabled:1,display:selectNodes[0].display,reportType:selectNodes[0].reportType,reportFolder:selectNodes[0].reportFolder,iconSkin:selectNodes[0].iconSkin,option:selectNodes[0].option};PageEditModal.show(src,_this.callbackEditPage);}else{alert(I18n.resource.mainPanel.layerPanel.SELECT_WORD_INFO);}};TreeView.prototype.callbackEditPage=function(pageCfg){var selectNodes=_this.treeObj.getSelectedNodes();var editData={id:selectNodes[0].id};if(selectNodes&&selectNodes.length>0){editData.projId=selectNodes[0].projId=pageCfg.projId;editData.text=selectNodes[0].name=pageCfg.name;selectNodes[0].type=pageCfg.type;if(pageCfg.type==='PageScreen'){editData.width=selectNodes[0].width=pageCfg.width;editData.height=selectNodes[0].height=pageCfg.height;editData.display=selectNodes[0].display=pageCfg.display;editData.option=selectNodes[0].option=pageCfg.option;}else if(pageCfg.type==='ReportScreen'){editData.reportType=selectNodes[0].reportType=pageCfg.reportType;editData.reportFolder=selectNodes[0].reportFolder=pageCfg.reportFolder;}
if(pageCfg.iconSkin==""||typeof pageCfg.iconSkin==="undefined"){editData.pic=selectNodes[0].pic=selectNodes[0].iconSkin;}else{editData.pic=selectNodes[0].pic=pageCfg.iconSkin;selectNodes[0].iconSkin=pageCfg.iconSkin;}
_this.treeObj.updateNode(selectNodes[0]);_this.operatePage('/factory/page/edit/',editData);if(pageCfg.type==="DropDownList"){$('#'+selectNodes[0].tId+'_span').text(pageCfg.name);}else{$('#'+selectNodes[0].tId+'_span').text(pageCfg.name+' - '+pageCfg.type);}
if(selectNodes[0].type!='DropDownList'&&selectNodes[0].iconSkin&&selectNodes[0].iconSkin!=''){$('#'+selectNodes[0].tId+'_switch').removeClass("button").addClass("glyphicon glyphicon-"+selectNodes[0].iconSkin);}
if(!_this.screen.screen.page||selectNodes[0].id===_this.screen.screen.page.page.id){$("#innerBg").css("background","");if(typeof selectNodes[0].option==="undefined"){$("#innerBg").css({'background':'#e1e3e5'});}else if(selectNodes[0].option.background.type=="image"){if(selectNodes[0].option.background.display=="tile"){$("#innerBg").css({'background-image':'url('+selectNodes[0].option.background.url+')',"background-repeat":"repeat","background-size":"contain"});}else{$("#innerBg").css({'background-image':'url('+selectNodes[0].option.background.url+')',"background-repeat":"no-repeat","background-size":"100% 100%"});}}else if(selectNodes[0].option.background.type=="color"){$("#innerBg").css("background-color",selectNodes[0].option.background.color);}
if(pageCfg.type==='PageScreen'){_this.screen.onPageResize(pageCfg.width,pageCfg.height);}}}};TreeView.prototype.getPageList=function(){if(!this.treeObj)return[];return this.treeObj.transformToArray(this.treeObj.getNodes()).map(function(row){return{_id:row.id,text:row.name,type:row.type};});};TreeView.prototype.syncPageList=function(){var pageList=[];var nodeArr=[];if(!this.treeObj)return;pageList=this.treeObj.transformToArray(this.treeObj.getNodes()).map(function(row){return row.id;});WebAPI.post('/factory/modifyPageList/'+this.projectId,{pageList:pageList}).done(function(result){if(result.status&&result.status=="OK"){}});};TreeView.prototype.close=function(){this.treeObj&&this.treeObj.destroy();if(this.ajaxRequestTree.state()==='pending'){this.ajaxRequestTree.abort();}};window.TreeView=TreeView;})();(function(){var _this;function DataSourcePanel(screen){_this=this;this.screen=screen;this.container=screen.dataSourcePanelCtn;this.project=screen.project;this.store={};window.ElScreenContainer=this.container;this.arrColor=["#ff7f50","#87cefa","#da70d6","#32cd32","#6495ed","#ff69b4","#ba55d3","#cd5c5c","#ffa500","#40e0d0","#1e90ff","#ff6347","#7b68ee","#00fa9a","#ffd700","#6699FF","#ff6666","#3cb371","#b8860b","#30e0e0"];}
DataSourcePanel.prototype.dragEndActionPerformed=function(){};DataSourcePanel.prototype.show=function(){if(typeof _this.store.group!=='undefined')return;$(_this.container).append('<div id="dataSrcContain" class="gray-scrollbar" style="height: 100%;"></div>');if(!AppConfig.datasource){Spinner.spin(_this.container);WebAPI.get('/datasource/get/'+AppConfig.userId).done(function(result){_this.store.group=result.group;AppConfig.datasource=_this.paneDatasource=new DataSource(_this);_this.paneDatasource.show();}).always(function(e){Spinner.stop();});}else{this.store.group=AppConfig.datasource.m_parent.store.group;this.paneDatasource=AppConfig.datasource=new DataSource(this);this.paneDatasource.show();}};DataSourcePanel.prototype.hide=function(){};window.DataSourcePanel=DataSourcePanel;})();(function(){var util={upload:{readURL:function readURL(ele,onSuccess,onError){var file;if(!(ele.files&&ele.files[0])){alert('file upload failed, try again.');typeof onError==='function'&&onError(1);return false;}
if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){alert('he browser not support the latest API.');typeof onError==='function'&&onError(2);return false;}
if(typeof FileReader==="undefined"){alert("The browser not support the latest API.");typeof onError==='function'&&onError(3);return false;}
file=ele.files[0];if(!/image/i.test(file.type)){alert("invalid file type.");typeof onError==='function'&&onError(4);return false;}
var reader=new FileReader();reader.onload=onSuccess;reader.readAsDataURL(file);}}};function AddProModal(){this.screen=null;}
AddProModal.prototype.show=function(screen){var _this=this;this.$addProj=undefined;this.showModal();this.screen=screen;this.map=null;this.validator=null;this.isAdvance=false;this.projId=screen.editProjId;this.projectId=undefined;this.configProjId=screen.configProjId;this.isDTUValid=true;this.isRealDbValid=true;};AddProModal.prototype.showModal=function(){var _this=this;WebAPI.get('/static/app/WebFactory/scripts/modals/addProject/addProject.html').done(function(resultHtml){if(resultHtml){$('#modalframe').append(resultHtml);_this.addEvent();}});};AddProModal.prototype.showProjModal=function(projectId){var _this=this;this.projectId=projectId;var proNameVal=_this.$addProj.find('.proName').val();$('#addProj').modal('hide');var $modalframe=$('#modalframe');Spinner.spin($modalframe[0]);var $regWizard=$('#reg-wizard');if($regWizard.length===0){WebAPI.get("/static/views/admin/paneProjectCreator.html").done(function(resultHtml){Spinner.stop();$modalframe.find('.frame-container').hide();$modalframe.append(resultHtml);$('#iptPjNameZh').val(proNameVal);if(_this.projectId)$('.header','#reg-wizard').children('span').eq(0).attr('i18n','admin.projectCreator.REGIST_STEP1_TITLE_2');I18n.fillArea($('#reg-wizard').not('input, .map_wrap'));I18n.fillAreaAttribute($('.pi_left_ct').eq(0).find('input'),'placeholder');_this.init();});}else{Spinner.stop();$modalframe.find('.frame-container').hide();$regWizard.show();if(_this.projectId)$('.header','#reg-wizard').children('span').eq(0).attr('i18n','admin.projectCreator.REGIST_STEP1_TITLE_2');$('#iptPjNameZh').val(proNameVal);_this.init();}};AddProModal.prototype.addEvent=function(){var _this=this;_this.$addProj=$('#addProj');_this.$addProj.modal();I18n.fillArea(_this.$addProj.fadeIn());if(_this.projId){_this.$addProj.find('.modal-title').html('');if(_this.configProjId){$('#addOnlinePro').html('');}else{$('#addOnlinePro').html('');}
$('#addNewPro').html('');_this.$addProj.find('.proName').val(_this.screen.editProjName);}else{_this.$addProj.find('.modal-title').html('');$('#addOnlinePro').html('');$('#addNewPro').html('');_this.$addProj.find('.proName').val('');}
var postData={},itemList={};var proNameVal,projDateFormat;$('#addNewPro').off('click').click(function(){_this.$addProj.find('.wrongAlert').html('');proNameVal=_this.$addProj.find('.proName').val();projDateFormat=_this.$pjDateFormat?+_this.$pjDateFormat.val():0;if(proNameVal===''){_this.$addProj.find('.wrongAlert').html(I18n.resource.admin.welcom.newProj.LOG_ADD);}else{if(_this.projId){if(_this.configProjId){postData={userId:AppConfig.userId,proName:proNameVal,proZhName:proNameVal,proEnName:proNameVal,projId:_this.projId,bindId:_this.configProjId,timeFormat:projDateFormat};}else{postData={userId:AppConfig.userId,proName:proNameVal,proZhName:proNameVal,proEnName:proNameVal,projId:_this.projId,timeFormat:projDateFormat};}}else{postData={userId:AppConfig.userId,proName:proNameVal,proZhName:proNameVal,proEnName:proNameVal,timeFormat:projDateFormat};}
WebAPI.post('/factory/addProject/save',postData).done(function(result){if(result.status==='OK'){var $proBox;if(!_this.projId){itemList={id:result.data._id,name_cn:proNameVal};$proBox=_this.screen.createProItem(itemList,AppConfig.userId);_this.screen.$projectList.append($proBox);_this.$addProj.remove();}else{_this.$addProj.remove();$proBox=$('#projectList').find('.divHover[projectid="'+_this.projId+'"]');$proBox.children('.proText').text(proNameVal);}
$proBox.children('.proText').click();}else{_this.$addProj.find('.wrongAlert').html(result.msg);}});}});$('#addOnlinePro').off('click').click(function(){if(_this.projId){var projectId=_this.configProjId?_this.configProjId:null;if(!BEOPUtil.isUndefined(projectId)){_this.showProjModal(projectId);}}else{proNameVal=_this.$addProj.find('.proName').val();if(proNameVal===''){_this.$addProj.find('.wrongAlert').html(I18n.resource.admin.welcom.newProj.LOG_ADD);}else{_this.showProjModal();}}});$('#addClose').off('click').click(function(){_this.$addProj.remove();});_this.$addProj.find('.close').off('click').click(function(){_this.$addProj.remove();});};AddProModal.prototype.init=function(){var _this=this;this.$formWrap=$('#formWrap');this.$pjCode=$('#iptPjCode',this.$formWrap);this.$pjNameZh=$('#iptPjNameZh',this.$formWrap);this.$pjNameEn=$('#iptPjNameEn',this.$formWrap);this.$projDataSource=$("#dtuName",this.$formWrap);this.$RP_RealTimeDS=$("#realProjectBox .realTimeDS",this.$formWrap);this.$RP_historyDS=$("#realProjectBox .historyDS",this.$formWrap);this.$VP_RealTimeDS=$("#virtualProjectBOX .realTimeDS",this.$formWrap);this.$VP_historyDS=$("#virtualProjectBOX .historyDS",this.$formWrap);this.$pjAddr=$('#iptPjAddr',this.$formWrap);this.$pjLnglat=$('#iptPjLnglat',this.$formWrap);this.$pjDateFormat=$('#iptPjDateFormat',this.$formWrap);this.$imgPreview=$('#imgPreview');this.$pjFile=$('#iptPjFile');this.$pjLogo=$('#iptPjLogo');this.$imgLogoPreview=$('#imgLogoPreview');this.$isAdvance=$('#isAdvance');this.$regStep=$('.reg-step-ct');this.$btnSubmit=$('#btnSubmit');this.$btnSwitchMap=$('#switch-map-btn');this.$realProject=$('#realProject');this.$virtualProject=$('#virtualProject');this.$DSType=$('.DSType');this.loadMap('AMap').done(function(){if(_this.projectId){WebAPI.get("/project/getinfo/"+_this.projectId).done(function(rs){_this.recoverForm(rs.projectinfo);if(rs.projectinfo){var dsType='real';if(!rs.projectinfo.datadb&&(rs.projectinfo.mysqlname||rs.projectinfo.collectionname)){dsType='virtual';}
_this.$DSType.filter('[value='+dsType+']').click();}});}});this.attachEvents();this.initValidator();};AddProModal.prototype.recoverForm=function(form){var latlng;if(!form)return;this.$pjCode.val(form.name_en).prop('readonly',true);this.$pjNameZh.val(form.name_cn);this.$pjNameEn.val(form.name_english);this.$pjDateFormat.val(form.time_format);if(form.isAdvance){this.$isAdvance.prop('disabled',true);this.$isAdvance.prop('checked',form.isAdvance?true:false);this.$regStep.addClass('advance');if(form.logo){this.$imgLogoPreview.attr('src',form.logo);}
this.isAdvance=Boolean(form.isAdvance);}
if(form.datadb){this.$projDataSource.val(form.datadb);}
if(form.mysqlname){if(form.datadb){this.$RP_RealTimeDS.text(form.mysqlname).attr('title',form.mysqlname);}else{this.$VP_RealTimeDS.val(form.mysqlname);}}
if(form.collectionname){if(form.datadb){this.$RP_historyDS.text(form.collectionname).attr('title',form.collectionname);}else{this.$VP_historyDS.val(form.collectionname);}}
if(form.latlng){this.$pjLnglat.val(form.latlng);}
if(form.address){this.$pjAddr.val(form.address);}
latlng=form.latlng.split(',');this.map&&this.map.trigger('click',{lnglat:this.map.getPoint(latlng[1],latlng[0]),updateAddress:false});this.$imgPreview.attr({'src':'/static/images/project_img/'+form.pic+'?'+new Date().getTime(),'data-name':form.pic});};AddProModal.prototype.initValidator=function(){this.validator=new Validator(this.$formWrap,{elements:[{name:'pjCode',selector:this.$pjCode,rules:[{valid:'require',msg:'Project code must not be empty!'},{valid:'word',msg:'Project code should only containes letters, numbers and \'_\''},{valid:function valid(val){var _this=this;WebAPI.post("/proj_name/check",{proName:val}).done(function(rs){if(rs.status==='OK'&&!rs.data.isExist){_this.success();}else{_this.fail();}});},msg:'Project code already exists!'}]},{name:'pjNameZh',selector:this.$pjNameZh,rules:[{valid:'require',msg:'Project chinese name cannot be empty!'}]},{name:'pjNameEn',selector:this.$pjNameEn,rules:[{valid:'require',msg:'Project english name cannot be empty!'},{valid:'wordWithSpace',msg:'Project english name should only containes letters, numbers, space and \'_\'; Space should not before or after project name.'}]},{name:'pjAddr',selector:this.$pjAddr,rules:[{valid:'require',msg:'Project address cannot be empty!'}]}]});};AddProModal.prototype.loadMap=function(type){var defer=$.Deferred();beop.baseMap.loadAccurateMap(type,function(map){this.map=map;this.attachMapEvents();this.map.addSearchBox('#btnMapSch','#mapSchPane');defer.resolve();}.bind(this));return defer;};AddProModal.prototype.attachMapEvents=function(){var _this=this;this.map.addListener('click',function(e){var point=e.lnglat;e.updateAddress=typeof e.updateAddress==='undefined'?true:e.updateAddress;_this.map.removeAllMarkers();_this.map.addMarker(point.lng,point.lat);_this.map.setFitView();if(e.updateAddress){_this.map.getAddress(point.lng,point.lat,function(rs){if(rs.status!==0)return;rs=rs.data;var components=rs[0].components;var city=components.city||components.province||rs[0].name;_this.$pjAddr.val(rs[0].name);_this.$pjLnglat.val(point.lat+','+point.lng);});}});};AddProModal.prototype.setFormFieldError=function($formField){if($formField){$formField.addClass('has-error').removeClass('has-success');}};AddProModal.prototype.setFormFieldSuccess=function($formField){if($formField){$formField.addClass('has-success').removeClass('has-error');}};AddProModal.prototype.setFormFieldHelpText=function(value){$("#prompt_information").show().text(value);};AddProModal.prototype.checkRealTimeDb=function(dbName){var _this=this;WebAPI.post('/admin/checkRealTimeDb',{realTimeDb:dbName}).done(function(result){if(result.success&&(!result.data||!result.data.length)){_this.$VP_RealTimeDS.text('beopdata_'+dbName);_this.isRealDbValid=true;}else{_this.$VP_RealTimeDS.text(' {0} '.format(dbName));_this.isRealDbValid=false;}}).fail(function(){_this.isRealDbValid=false;});};AddProModal.prototype.checkDtuName=function(dtuName){var _this=this;WebAPI.post('/admin/checkProjDataSource',{dtuName:dtuName,projectId:AppConfig.projectId}).done(function(result){if(!result.success){_this.isDTUValid=false;_this.setFormFieldError(_this.$projDataSource);_this.setFormFieldHelpText(I18n.resource.admin.projectCreator.PJ_REALITY_VALUE_TIPS_SERVER_ERROR);return;}
$("#prompt_information").hide();_this.setFormFieldSuccess(_this.$projDataSource);_this.$RP_RealTimeDS.empty().text(result.data.realTimeDS).attr('title',result.data.realTimeDS);_this.$RP_historyDS.empty().text(result.data.historyDS).attr('title',result.data.historyDS);if(!result.data.valid){_this.isDTUValid=false;_this.setFormFieldError(_this.$projDataSource);_this.setFormFieldHelpText(' {0} '.format(dtuName));return;}
if(result.data.used){_this.isDTUValid=false;_this.setFormFieldError(_this.$projDataSource);_this.setFormFieldHelpText(' {0} '.format(dtuName));return;}
_this.isDTUValid=true;}).fail(function(){_this.isDTUValid=false;_this.setFormFieldError(_this.$projDataSource);_this.setFormFieldHelpText(I18n.resource.admin.projectCreator.PJ_REALITY_VALUE_TIPS_SERVER_ERROR);});};AddProModal.prototype.attachEvents=function(){var _this=this;var isImgUploadReady=false;this.$btnSwitchMap.off().on('click',function(){var $this=$(this),attrPrefix='data-map-type',type=$this.attr(attrPrefix);var $AMapSearch=$('.map-sch-wrap');var promise;_this.map.destroy();_this.$pjAddr.val('');if(type==='AMap'){$AMapSearch.find('input').val('').end().find('#mapSchPane li').remove().end().hide();if($('#btnGoogleSch').length==0){$('#mapContainer').before('<input type="text" class="form-control" id="btnGoogleSch" style="display:none;" placeholder="Search Box" />');}
promise=_this.loadMap('GMap');$this.fadeOut(function(){$this.text(I18n.resource.admin.projectCreator.CHANGE_MAP_TO_AMAP).attr(attrPrefix,'GMap');}).fadeIn();}else if(type==='GMap'){$AMapSearch.show();promise=_this.loadMap('AMap');$this.fadeOut(function(){$this.text(I18n.resource.admin.projectCreator.CHANGE_MAP_TO_GOOGLE).attr(attrPrefix,'AMap');}).fadeIn();}else{$this.fadeOut().text(I18n.resource.admin.projectCreator.CHANGE_MAP_ERROR).fadeIn();return;}
promise.done(function(){var latlng=_this.$pjLnglat.val().split(',');if(latlng.length<2){return;}
_this.map&&_this.map.trigger('click',{lnglat:_this.map.getPoint(latlng[1],latlng[0])});});});var nameTimer=null;this.$pjCode.off().on('keyup',function(){var $this=$(this),value=$this.val().trim();nameTimer&&clearTimeout(nameTimer);if(!value){_this.$VP_RealTimeDS.text('');return;}
nameTimer=setTimeout(function(){_this.checkRealTimeDb(value);},500);});var checkTimer=null;this.$projDataSource.off().on('keyup',function(){var $this=$(this),dtuName=$this.val().trim();_this.isDTUValid=false;checkTimer&&clearTimeout(checkTimer);if(!dtuName){_this.isDTUValid=true;_this.setFormFieldSuccess(_this.$projDataSource);_this.setFormFieldHelpText('');return false;}
checkTimer=setTimeout(function(){_this.checkDtuName(dtuName);},500);});this.$DSType.on('change',function(){var $this=$(this);$this.closest('.form-ds-type').removeClass('real virtual').addClass($this.val());if($this.val()==='virtual'){_this.checkRealTimeDb(_this.$pjCode.val());}});$('#cancelRegist').click(function(){$('#modalframe').find('.frame-container').show();$("#addProj").remove();$('#reg-wizard').remove();});this.$imgPreview.click(function(e){_this.$pjFile.click();e.preventDefault();});this.$pjFile.change(function(e){var file=$(this)[0].files[0];if(file.name.match(/\.[A-Za-z0-9]+$/)[0].toLowerCase()!=='.jpg'){isImgUploadReady=false;alert('invalid image format.');return;}
util.upload.readURL($(this)[0],function(e){$('#imgPreview').attr('src',e.target.result);isImgUploadReady=true;},function(errCode){isImgUploadReady=false;});e.preventDefault();});this.$btnSubmit.off('click').click(function(ev){var defer;if(_this.configProjId)defer=_this.validator.not('pjCode').valid();else defer=_this.validator.valid();defer.then(function(form){var formData=new FormData();if(isImgUploadReady)formData.append('pro-pic-file',_this.$pjFile[0].files[0]);if(_this.isAdvance){formData.append('isAdvance',_this.isAdvance?1:0);formData.append('pro-pic-logo',_this.$pjLogo[0].files[0]);}
if(_this.projectId){formData.append('projId',_this.projectId);formData.append('projCode',_this.$pjCode.val());}else{formData.append('projCode',form.pjCode);}
if(_this.$DSType.filter(':checked').val()=='real'){if(!_this.isDTUValid){alert.danger(', ');return;}
formData.append("dtuName",_this.$projDataSource.val());}else{if(!_this.isRealDbValid){alert.danger(', ');return;}
formData.append("realTimeDS",_this.$VP_RealTimeDS.text().trim());if(_this.$VP_historyDS.val()){formData.append("historyDS",_this.$VP_historyDS.val().trim());}}
formData.append('userId',AppConfig.userId);formData.append('projNameZh',form.pjNameZh);formData.append('projNameEn',form.pjNameEn);formData.append('address',form.pjAddr);formData.append('latlng',_this.$pjLnglat.val());formData.append('weatherStationId',101020100);formData.append('projDateFormat',+_this.$pjDateFormat.val());Spinner.spin($('body')[0]);$.ajax({url:'/project/create',type:'post',data:formData,dataType:'json',cache:false,contentType:false,processData:false}).done(function(rs){if(rs.status==='OK'){if(AppConfig.systemEntrance==='add'){alert('Create project successfully');}else{alert('Edit project successfully');}
AppConfig.projectList=rs.projects;AppConfig.projectId=rs.projectId;var projDateFormat=+_this.$pjDateFormat.val();var postData={userId:AppConfig.userId,proName:form.pjNameZh,proZhName:form.pjCode,proEnName:form.pjNameEn,bindId:rs.projectId,projId:_this.projId,timeFormat:projDateFormat};if(_this.projId){postData['projId']=_this.projId;}
WebAPI.post('/factory/addProject/save',postData).done(function(result){var $proBox;if(result.status==='OK'){if(!_this.projId){itemList={id:result.data._id,name_cn:form.pjNameZh,bindId:rs.projectId};$proBox=_this.screen.createProItem(itemList,AppConfig.userId);_this.screen.$projectList.append($proBox);$proBox.attr('configProjId',rs.projectId);_this.$addProj.remove();}else{_this.$addProj.remove();$proBox=$('#projectList').find('.divHover[projectid="'+_this.projId+'"]');$proBox.attr('configProjId',rs.projectId);$proBox.find(".proText").addClass("bindPro");}}});var $modalframe=$('#modalframe');$modalframe.find('.frame-container').show();$("#addProj").remove();$('#reg-wizard').remove();}else{alert('Server is busy, Please try again later.');}}).fail(function(e){alert('Server is busy, Please try again later.');}).always(function(e){Spinner.stop();});});});this.$isAdvance.change(function(){_this.isAdvance=$(this).prop('checked');if(_this.isAdvance){_this.$regStep.addClass('advance');}else{_this.$regStep.removeClass('advance');}});this.$realProject.off('click').click(function(){$("#virtualProjectBOX").hide();$("#realProjectBox").show();});this.$virtualProject.off('click').click(function(){$("#realProjectBox").hide();$("#virtualProjectBOX").show();});};AddProModal.prototype.close=function(){this.$addProj=null;this.$btnSubmit.unbind();this.$pjCode.unbind();this.$pjAddr.unbind();this.$imgPreview.unbind();this.projId=null;this.configProjId=null;$('body').off();this.map.destroy();};window.AddProModal=new AddProModal();})();(function(){function RemoveProModal(){this.screen=undefined;this.projectId=undefined;}
RemoveProModal.prototype.show=function(screen,projectId){var _this=this;this.showModal();this.screen=screen;this.projectId=projectId;};RemoveProModal.prototype.showModal=function(){var _this=this;WebAPI.get('/static/app/WebFactory/scripts/modals/removeProject/removeProject.html').done(function(resultHtml){if(resultHtml){$('#mainframe').parent().append(resultHtml);_this.eventAll();}});};RemoveProModal.prototype.eventAll=function(){var _this=this;var $removeProModal=$('#removeProModal');$removeProModal.modal();I18n.fillArea($removeProModal.fadeIn());$removeProModal.find('.btn-primary').off('click').click(function(){$removeProModal.remove();});$removeProModal.find('.directRemove').off('click').click(function(){var $this=$(this);$removeProModal.find('.removeProFst').hide();$removeProModal.find('.removeProSnd').show();$this.html(I18n.resource.admin.welcom.deleteProj.OK);$this.off('click').click(function(){_this.screen.removeProItem(_this.projectId);});});$removeProModal.find('.close').off('click').click(function(){$removeProModal.remove();});};window.RemoveProModal=new RemoveProModal();})();(function(){function ImportProjectModal(){this.$modal=null;this.callback=null;}
+function(){this.show=function(callback){var _this=this;var $wrap=$(document.body);this.callback=callback;if(this.$modal){$wrap.append(this.$modal);this.$modal.modal('show');return;}
WebAPI.get('/static/app/WebFactory/scripts/modals/importProjectModal/importProjectModal.html').done(function(html){_this.$modal=$(html);$wrap.append(_this.$modal);_this.init();_this.$modal.modal('show');});};this.init=function(){I18n.fillArea(this.$modal);this.initProjectList();this.attachEvents();$('#selProjectList',this.$modal).trigger('change');};this.initProjectList=function(){var arrHtml=AppConfig.projectList.map(function(project){return'<option value="'+project.id+'">'+project['name_'+(I18n.type==='zh'?'cn':I18n.type)]+'</option>';});$('#selProjectList',this.$modal).empty().html(arrHtml.join(''));};this.attachEvents=function(){var _this=this;this.$modal.off();this.$modal.on('hidden.bs.modal',function(){_this.reset();_this.$modal.detach();});$('#btnSubmit',this.$modal).off().on('click',function(){var data=_this.getFormData();var $this=$(this);if(!data.iptNewProjectName.trim()){alert('');return;}
$this.prop('disabled',true);WebAPI.post('/factory/importOnlineProject',{projectId:data['selectedProject'],newProjName:data['iptNewProjectName'],userId:AppConfig.userId}).done(function(rs){if(rs.status==='OK'){_this.$modal.modal('hide');alert(rs.msg);typeof _this.callback==='function'&&_this.callback(rs.data);}
else if(rs.status==='Duplicated'){_this.$modal.modal('hide');if(rs.permission===0){alert('The project is authorized by</br><h4>'+rs.username.join(' ')+'</h4>Please contact him for access before doing project importing');}else{MergeNavModal.show(data['selectedProject'],rs.id);}}
else{alert(rs.msg);}}).always(function(){$this.prop('disabled',false);});});$('#selProjectList',this.$modal).off().on('change',function(){var title=$(this).children('[value="'+this.value+'"]')[0].innerHTML;$('#iptNewProjectName').val(title||'');});};this.getFormData=function(){var data={};$('#formProject',this.$modal).serializeArray().forEach(function(row){data[row.name]=row.value;});return data;};this.reset=function(){var $selProjectList=$('#selProjectList',this.$modal);$selProjectList.val($('option:first',$selProjectList).val());};this.close=function(){this.$modal.remove();};}.call(ImportProjectModal.prototype);window.ImportProjectModal=new ImportProjectModal();})();var PageEditModal=function(){var _this=undefined;function PageEditModal(){_this=this;_this.src=undefined;_this.callback=undefined;}
PageEditModal.prototype.show=function(src,callback){_this.src=src;_this.callback=callback;var $modalPageEdit=$('#pageEditModal');if(!$modalPageEdit||0==$modalPageEdit.length){WebAPI.get('/static/app/WebFactory/scripts/modals/pageEditModal/pageEditModal.html').done(function(resultHTML){_this.$contain=$(resultHTML);_this.init();_this.$contain.modal('show');if(_this.src.projId!==""){_this.$contain.find('.modal-title').html(i18n_resource.mainPanel.pageEditModal.EDIT_PAGE_TITLE);}else{_this.$contain.find('.modal-title').html(i18n_resource.mainPanel.pageEditModal.ADD_PAGE_TITLE);}}).always(function(e){});}else{$modalPageEdit.modal('show');_this.init();}};PageEditModal.prototype.init=function(){I18n.fillArea(_this.$contain);_this.$btnOk=_this.$contain.find('#btnOk');_this.$inputPageName=_this.$contain.find('#inputPageName');_this.$selectPageType=_this.$contain.find('#selectPageType');_this.$divPageSize=_this.$contain.find('#divPageSize');_this.$inputPageWidth=_this.$contain.find('#inputPageWidth');_this.$inputPageHeight=_this.$contain.find('#inputPageHeight');_this.$divPageDisplay=_this.$contain.find('#divPageDisplay');_this.$divReportType=_this.$contain.find('#divReportType');_this.$divPageUrl=_this.$contain.find('#divUrl');_this.$selectPageDisplay=_this.$contain.find('#selectPageDisplay');_this.$selectReportType=_this.$contain.find('#divReportType select');_this.$selectPageUrl=_this.$contain.find('#divUrl input');_this.$selectPageDisplayOption=_this.$contain.find('#selectPageDisplay option');_this.$iconBtton=_this.$contain.find('#divIcon span');_this.$divBg=_this.$contain.find('#divBg');_this.$bgBtton=_this.$contain.find('#divBg span');_this.$inputPageName.val(_this.src.name.split(' - ')[0]);_this.$selectPageType.val(_this.src.type).attr('data-type',_this.src.type);_this.$inputPageWidth.val(_this.src.width);_this.$inputPageHeight.val(_this.src.height);_this.$selectPageDisplayOption.eq(_this.src.display).prop('selected',true);_this.$iconBtton.attr("pic-name","");if(_this.src.reportType===''||typeof _this.src.reportType==="undefined"){_this.$selectReportType.val('0');}else{_this.$selectReportType.val(_this.src.reportType);}
if(_this.src.reportFolder===''||typeof _this.src.reportFolder==="undefined"){_this.$contain.find('#divUrl input').val('');}else{_this.$contain.find('#divUrl input').val(_this.src.reportFolder);}
if(_this.src.iconSkin==""||typeof _this.src.iconSkin==="undefined"){_this.$iconBtton.removeClass().addClass("btn btn-default").text(i18n_resource.mainPanel.pageEditModal.SELECT);}else{_this.$iconBtton.removeClass().text("").addClass("btn btn-default glyphicon glyphicon-"+_this.src.iconSkin);}
_this.$divBg.removeAttr("data-bg");if(typeof _this.src.option==="undefined"||_this.src.option.background.type==""){_this.$bgBtton.removeClass().addClass("btn btn-default").text(i18n_resource.mainPanel.pageEditModal.SELECT);}else{_this.$bgBtton.removeClass().addClass("btn btn-default").text(i18n_resource.mainPanel.pageEditModal.SELECTED);if(_this.src.option.background.type=="image"){_this.$divBg.attr("data-bg",_this.src.option.background.url+'_'+_this.src.option.background.display);}else{_this.$divBg.attr("data-bg",_this.src.option.background.color);}}
_this.attachEvents();if(_this.src.disabled===1){_this.$selectPageType.prop('disabled',true);}else{_this.$selectPageType.prop('disabled',false);}
_this.$selectPageType.trigger('change');};PageEditModal.prototype.close=function(){_this.$contain.remove();};PageEditModal.prototype.rgbToHex=function(rgb){var rgbArr=rgb.split(",");var r=Number(rgbArr[0].split("rgb(")[1]);var g=Number(rgbArr[1]);var b=Number(rgbArr[2].split(")")[0]);return"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1);};PageEditModal.prototype.attachEvents=function(){_this.$selectPageType.off('change').change(function(e){if('PageScreen'===this.value){_this.$divPageSize.show();_this.$divPageDisplay.show();_this.$divBg.show();_this.$divReportType.hide();_this.$divPageUrl.hide();}else if(this.value==='ReportScreen'){_this.$divPageSize.hide();_this.$divPageDisplay.hide();_this.$divBg.hide();_this.$divReportType.show();_this.$divPageUrl.show();}else{_this.$divPageSize.hide();_this.$divPageDisplay.hide();_this.$divBg.hide();_this.$divReportType.hide();_this.$divPageUrl.hide();}});_this.$iconBtton.off("click").on("click",function(){WebAPI.get('static/scripts/spring/entities/modalMonitor.html').done(function(resultHTML){var $iconContainer=$('<div class="modal fade in">');$iconContainer.appendTo($("body"));$iconContainer.append($(resultHTML)).show();$("#ttlIconTool").html("").attr("i18n","mainPanel.iconSelect.ICON_TITLE");$(".btnSure").prev().html("").attr("i18n","mainPanel.pageEditModal.CLOSE");$(".btnSure").html("").attr("i18n","mainPanel.pageEditModal.SURE");I18n.fillArea($iconContainer);$("#divColorSel").hide();var $modalIcon=$("#modalIconSel");$modalIcon.addClass("in").css("color","#666").show();var close=$modalIcon.find(".close");var closeBtn=$('button[data-dismiss = "modal"]');var btnSure=$modalIcon.find(".btnSure");close.click(function(){$iconContainer.remove();});closeBtn.click(function(){$iconContainer.remove();});$modalIcon.find('.bs-glyphicons-list>li').click(function(e){if($(e.currentTarget).hasClass('selected'))return;$('.bs-glyphicons-list>li.selected').removeClass('selected');$(e.currentTarget).addClass('selected');});btnSure.click(function(){var icon=$('.bs-glyphicons-list>li.selected>.glyphicon-class').text();if(icon==""){$("#divIcon").find("span").attr("i18n","mainPanel.pageEditModal.SELECT");}else{_this.$iconBtton.text("").removeClass().addClass("btn btn-default "+icon).attr("pic-name",icon.replace("glyphicon glyphicon-",""));}
close.trigger("click");});});});_this.$bgBtton.off("click").on("click",function(){WebAPI.get('/static/app/WebFactory/scripts/modals/bgModal/bgProp.html').done(function(resultHTML){var $bgContainer=$('<div class="modal fade in" id="bgContainer">');$bgContainer.appendTo($("body"));$bgContainer.append($(resultHTML)).show();var $modalBgSel=$("#modalBgSel");$modalBgSel.addClass("in").css("color","#666").show();$("#divBg").attr("data-bg","");if(typeof _this.src.option==="undefined"||typeof _this.src.option.background==="undefined"||_this.src.option.background.type==""){$(".ulBgVal").attr("i18n","mainPanel.bgSelect.BG_COLOR");$(".bgColor").show().val("#e1e3e5");$('#btnImg').hide();$(".bgPreviewShow").css("background","");}else{if(_this.src.option.background.type=="image"){$(".ulBgVal").attr("i18n","mainPanel.bgSelect.BG_IMAGE");$(".bgColor").hide();$("#btnImg").show();if(_this.src.option.background.display=="tile"){$(".bgPreviewShow").css({"background-image":"url("+_this.src.option.background.url+")","background-repeat":"repeat","background-size":"tile"});}else{$(".bgPreviewShow").css({"background-image":"url("+_this.src.option.background.url+")","background-repeat":"no-repeat","background-size":"100% 100%"});}}else{var color;if(_this.src.option.background.color.indexOf("#")==-1){color=_this.rgbToHex(_this.src.option.background.color);}else{color=_this.src.option.background.color;}
$(".ulBgVal").attr("i18n","mainPanel.bgSelect.BG_COLOR");$("#btnImg").hide();$(".bgColor").val(color).show();$(".bgPreviewShow").css("background",_this.src.option.background.color);}}
window.BgProp.attachEvent();});});_this.$btnOk.off().click(function(e){var projId=$("#lkName").attr("data-projId");var pageName=_this.$inputPageName.val();var pageType=_this.$selectPageType.val()===null?_this.$selectPageType.attr('data-type'):_this.$selectPageType.val();if(pageType==='ReportScreen'&&_this.$selectPageUrl.val()===''){alert('');return;}
var pageWidth=parseInt(_this.$inputPageWidth.val(),10);var pageHeight=parseInt(_this.$inputPageHeight.val(),10);var pageDisplay=parseInt(_this.$selectPageDisplay.val());var reportType=_this.$selectReportType.val();var pageUrl=_this.$selectPageUrl.val();var pageIcon=_this.$iconBtton.attr("pic-name");var pageBg=$("#divBg").attr("data-bg");var background={color:'',type:'',url:'',display:''};if(typeof pageBg==="undefined"){if(typeof _this.src.option==="undefined"){var objPageCfg={projId:projId,name:pageName,type:pageType,width:pageWidth,height:pageHeight,display:pageDisplay,reportType:reportType,reportFolder:pageUrl,iconSkin:pageIcon};}else{var objPageCfg={projId:projId,name:pageName,type:pageType,width:pageWidth,height:pageHeight,display:pageDisplay,reportType:reportType,reportFolder:pageUrl,iconSkin:pageIcon,option:{background:_this.src.option.background,variables:_this.src.option.variables}};if(_this.src.option.background.type===""){background={color:'#e1e3e5',type:'color',url:'',display:''};var objPageCfg={projId:projId,name:pageName,type:pageType,width:pageWidth,height:pageHeight,display:pageDisplay,reportType:reportType,reportFolder:pageUrl,iconSkin:pageIcon,option:{background:background,variables:_this.src.option.variables}};}}}else{if(pageBg==""||typeof pageBg=="undefined"){background={color:'#e1e3e5',type:'color',url:'',display:''};}else if(pageBg.indexOf("http")==0){background={color:'',type:'image',url:pageBg.split('_')[0],display:pageBg.split('_')[1]};}else if(pageBg.indexOf("rgb")==0||pageBg.indexOf("#")==0){background={color:pageBg,type:'color',url:'',display:''};}
var objPageCfg={projId:projId,name:pageName,type:pageType,width:pageWidth,height:pageHeight,display:pageDisplay,reportType:reportType,reportFolder:pageUrl,iconSkin:pageIcon,option:{background:background,variables:_this.src.option.variables}};}
_this.callback(objPageCfg);_this.$contain.modal('hide');$(".edit").hide();});};PageEditModal=new PageEditModal();return PageEditModal;}();;(function(exports){function BgProp(){}
+function(){this.attachEvent=function(){I18n.fillArea($("#bgContainer"));var $modalBgSel=$("#modalBgSel");var close=$modalBgSel.find(".close");var btnClose=$modalBgSel.find(".btnClose");var btnSure=$modalBgSel.find(".btnSure");var _this=this;close.off("click").on("click",function(){$("#bgContainer").remove();});btnClose.off("click").on("click",function(){close.trigger("click");});btnSure.off("click").on("click",function(){var previewShowStyle=$(".bgPreviewShow").attr("style");if(previewShowStyle==undefined){$("#divBg").find("span").removeClass().addClass("btn btn-default").text(i18n_resource.mainPanel.pageEditModal.SELECT);}else{if(previewShowStyle.indexOf("rgb")==-1){var display=$("#showDisplay").attr("data-view");var imgInfo=previewShowStyle.split(";");if(_this.imageInfo===undefined){var pattern=/\"(.*)\"/;var result=imgInfo[0].match(pattern);var image=result[1];}else{var image=_this.imageInfo.url;}
$("#divBg").attr("data-bg",image+"_"+display);}else{var color=previewShowStyle.split(": ")[1].split(";")[0];$("#divBg").attr("data-bg",color);}
$("#divBg").find("span").removeClass().addClass("btn btn-default").text(i18n_resource.mainPanel.pageEditModal.SELECTED);}
$("#bgContainer").remove();});$('#ulBg').off('click').on('click','a',function(){var $current=$(this);$(".bgPreviewShow").css("background","");_this.bgChange($current);});$(".bgColor").off().change(function(){$(".bgPreviewShow").css("background-color",$(this).val());});$('#ulStyle').off('click').on('click','a',function(){var $current=$(this);var $button=$current.closest('ul').siblings('.btn').children();$button.eq(0).html($current.html());var imageType=$current.attr("data-view");if(imageType=="tile"){$("#btnImg").find("span").eq(0).attr("data-view","tile");$(".bgPreviewShow").css({"background-repeat":"repeat","background-size":"contain"});}else{$("#btnImg").find("span").eq(0).attr("data-view","stretch");$(".bgPreviewShow").css({"background-repeat":"no-repeat","background-size":"100% 100%"});}});$("#btnBg").off("click").on("click",function(){MaterialModal.show([{'title':'Template',data:['Image']}],function(data){_this.imageInfo=data;var url=data.url;$(".bgPreviewShow").css("background-image","url("+url+")");var imgRepeat=$("#btnImg").find("span").eq(0).attr("data-view");if(imgRepeat=="tile"){$(".bgPreviewShow").css({"background-repeat":"repeat","background-size":"contain"});}else{$(".bgPreviewShow").css({"background-repeat":"no-repeat","background-size":"100% 100%"});}});});};this.bgChange=function($current,firstLoad){var $ul=$current.closest('ul');var $button=$ul.siblings('.btn').children();var $input=$ul.siblings('input');var $btnImg=$('#btnImg');var $liTxtshow=$btnImg.prev('.txtShow');var type=$current[0].dataset.view;$button.eq(0).html($current.html());if(type==='color'){$input.off().change(function(){$(".bgPreviewShow").css("background-color",$(this).val());});$input.show();$btnImg.hide();}else if(type==='image'){$input.hide();$btnImg.show();}};}.call(BgProp.prototype);exports.BgProp=new BgProp();})(window);;(function(){function MergeNavModal(){this.$modal=null;this.callback=null;this.operationType='import',this.idProjectOffline=undefined;this.idProjectOnline=undefined;this.treeOnline=undefined;this.treeOffline=undefined;this.treeResultAll=undefined;this.store={};}
+function(){this.show=function(idProjectOnline,idProjectOffline,operationType){var _this=this;if(!idProjectOnline){alert('Please create an online project first!');return;}
this.store={nodesOnlineTree:[],nodesOfflineTree:[]};this.idProjectOffline=idProjectOffline;this.idProjectOnline=idProjectOnline;this.operationType=operationType?operationType:'import';var $wrap=$(document.body);WebAPI.get('/static/app/WebFactory/scripts/modals/mergeNavModal/mergeNavModal.html').done(function(html){_this.$modal=$(html);$wrap.append(_this.$modal);_this.init();_this.$modal.modal('show');if(_this.operationType=='publish'){$('#panePublishForm').show();$('#titleResultType').text(_this.operationType.toUpperCase()+" : "+AppConfig.project.cnName);}});};this.init=function(){var _this=this;I18n.fillArea(this.$modal);$.when(this.requestOnlineNav(),this.requestOfflineNav()).then(function(){_this.initTree();_this.attachEvents();});$('#selProjectList',this.$modal).trigger('change');};this.initTree=function(){var _this=this;this.initTreeResultData();var ztreeSetting={view:{fontCss:function fontCss(treeId,node){return node.font?node.font:{};},nameIsHTML:true},edit:{enable:true,showRemoveBtn:false,showRenameBtn:false,drag:{inner:false}},check:{enable:true},data:{simpleData:{enable:true}},callback:{onCheck:function onCheck(event,treeId,treeNode){var currentTree;if(treeId==="treeNavOnline"){currentTree=_this.treeOnline;}else{currentTree=_this.treeOffline;}
var checkNodes=currentTree.getCheckedNodes(true);var outChildren=[];for(var c=0,cl=checkNodes.length;c<cl;c++){if(checkNodes[c].pId===null){outChildren.push(checkNodes[c]);}}
if(outChildren<currentTree.getNodes(true)){$("#"+treeId).prev("div").find(".allSelect").attr("checked",false);}
if(treeNode.checked){_this.treeResult.addNodes(_this.treeResult.getNodeByParam('id',treeNode.pId,null),-1,treeNode);}else{var arr=_this.treeResult.getNodesByParam('id',treeNode.id,null);for(var k=0,kl=arr.length;k<kl;k++){if(treeNode.isOnline===arr[k].isOnline){_this.treeResult.removeNode(arr[k],false);}}}},beforeDrag:function beforeDrag(treeId,treeNodes){if(treeId==='treeNavOffline'||treeId==='treeNavOnline'){return false;}
for(var i=0,l=treeNodes.length;i<l;i++){if(treeNodes[i].drag===false){return false;}}
return true;},beforeDrop:function beforeDrop(treeId,treeNodes,targetNode,moveType){if(treeId==='treeNavOffline'||treeId==='treeNavOnline'){return false;}
return targetNode?targetNode.drop!==false:true;},onDrop:function onDrop(e,treeId,treeNodes,targetNode,moveType){}}};this.treeOnline=$.fn.zTree.init($('#treeNavOnline'),ztreeSetting,this.store.nodesOnlineTree);this.treeOffline=$.fn.zTree.init($('#treeNavOffline'),ztreeSetting,this.store.nodesOfflineTree);ztreeSetting.check.enable=false;this.treeResult=$.fn.zTree.init($('#treeNavResult'),ztreeSetting,this.store.nodesResultTree);};this.attachEvents=function(){var _this=this;this.$modal.off();this.$modal.on('hidden.bs.modal',function(){_this.close();});$('#btnSubmit',this.$modal).off().on('click',function(){var url;switch(_this.operationType){case'import':url='/factory/importOnlineProjectWithMerging';break;case'publish':url='/factory/publishWithMerging';break;default:return;}
var postData=_this.prepareSubmitData();if(!postData)return;Spinner.spin($('#mergeNavModalWrap')[0]);WebAPI.post(url,postData).done(function(result){if(result.status=='OK'){_this.close();alert('Success');}else{alert(result.msg);}}).always(function(){Spinner.stop();});});$('#addClose,#addCancel',this.$modal).off().on('click',function(){_this.close();});$('.allSelect',this.$modal).off("click").on("click",function(){var $allOptionsParent=$(this).closest("div").next();$(this).siblings("input")[0].checked=false;var currentTree;if($allOptionsParent.hasClass("treeNavOnline")){currentTree=_this.treeOnline;}else{currentTree=_this.treeOffline;}
if(this.checked){var currentSelectedArr=currentTree.getCheckedNodes(true);for(var r=0,rLength=currentSelectedArr.length;r<rLength;r++){var arr=_this.treeResult.getNodesByParam('id',currentSelectedArr[r].id,null);for(var k=0,kl=arr.length;k<kl;k++){if(currentSelectedArr[r].isOnline===arr[k].isOnline){_this.treeResult.removeNode(arr[k],false);}}}
currentTree.checkAllNodes(true);var selectArr=currentTree.getCheckedNodes(true);for(var i=0,length=selectArr.length;i<length;i++){if(selectArr[i].pId===null){_this.treeResult.addNodes(_this.treeResult.getNodeByParam('id',selectArr[i].pId,null),-1,selectArr[i]);}}}else{var selectArr=currentTree.getCheckedNodes(true);currentTree.checkAllNodes(false);for(var j=0,jLength=selectArr.length;j<jLength;j++){var arr=_this.treeResult.getNodesByParam('id',selectArr[j].id,null);for(var k=0,kl=arr.length;k<kl;k++){if(selectArr[j].isOnline===arr[k].isOnline){_this.treeResult.removeNode(arr[k],false);}}}}});$('.reverseSelect',this.$modal).off("click").on("click",function(){var $allOptionsParent=$(this).closest("div").next();$(this).siblings("input")[0].checked=false;var currentTree;if($allOptionsParent.hasClass("treeNavOnline")){currentTree=_this.treeOnline;}else{currentTree=_this.treeOffline;}
var selectArr=currentTree.getCheckedNodes(true);var noSelectArr=currentTree.getCheckedNodes(false);if(selectArr.length>0){for(var i=0,length=selectArr.length;i<length;i++){var arr=_this.treeResult.getNodesByParam('id',selectArr[i].id,null);for(var k=0,kl=arr.length;k<kl;k++){if(selectArr[i].isOnline===arr[k].isOnline){_this.treeResult.removeNode(arr[k],false);}}
currentTree.checkNode(selectArr[i],false,true);}}
if(noSelectArr.length>0){for(var i=0,length=noSelectArr.length;i<length;i++){if(noSelectArr[i].pId===null){_this.treeResult.addNodes(_this.treeResult.getNodeByParam('id',noSelectArr[i].pId,null),-1,noSelectArr[i]);}
currentTree.checkNode(noSelectArr[i],true,true);}}});};this.prepareSubmitData=function(){var navIdOnline=[],navIdOffline=[],navIdResult=[],nodes;nodes=this.treeResult.transformToArray(this.treeResult.getNodes());for(var i=0;i<nodes.length;i++){if(nodes[i].isOnline){navIdOnline.push(nodes[i].id);}else{navIdOffline.push(nodes[i].id);}
navIdResult.push(nodes[i].id);}
var data={'navIdOnline':navIdOnline,'navIdOffline':navIdOffline,'navIdResult':navIdResult};if(this.operationType=='import'){data.sourceId=this.idProjectOnline;data.targetId=this.idProjectOffline;}else if(this.operationType=='publish'){var txtPwd=$('#inputPwd').val(),txtMsg=$('#inputMsg').val();if(!(txtPwd&&txtMsg)){alert('Password and log is necessary!');return undefined;}
data.sourceId=this.idProjectOffline;data.targetId=this.idProjectOnline;data.userId=AppConfig.userId;data.password=$('#inputPwd').val();data.msg=$('#inputMsg').val();}
return data;};this.requestOnlineNav=function(){var deferred=$.Deferred(),_this=this;if(this.idProjectOnline){WebAPI.get("/get_plant_pagedetails/"+this.idProjectOnline+"/all").done(function(result){_this.initTreeOnlineData(result);}).always(function(){deferred.resolve();});}else{deferred.resolve();}
return deferred.promise();};this.requestOfflineNav=function(){var deferred=$.Deferred(),_this=this;;WebAPI.get('/factory/getPageList/'+this.idProjectOffline+'/1').done(function(result){if(result.status==='OK'){_this.initTreeOfflineData(result.data);}else{alert(result.msg);}}).always(function(){deferred.resolve();});return deferred.promise();};this.initTreeOnlineData=function(rs){for(var i=0,item;i<rs.navItems.length;i++){item=rs.navItems[i];this.store.nodesOnlineTree.push({id:item.id,pId:item.parent,name:item.text,navItemType:item.type,open:true,isOnline:true,modeMerge:1});}};this.initTreeOfflineData=function(rs){for(var i=0,item;i<rs.length;i++){item=rs[i];this.store.nodesOfflineTree.push({id:item._id,pId:item.parent,name:item.text,navItemType:item.type,open:true,isOnline:false,modeMerge:1});}};this.initTreeResultData=function(){var treeSource=[],treeTarget=[];this.store.nodesResultTree=[];switch(this.operationType){case'import':treeSource=this.store.nodesOnlineTree;treeTarget=this.store.nodesOfflineTree;break;case'publish':treeSource=this.store.nodesOfflineTree;treeTarget=this.store.nodesOnlineTree;break;default:return;}
for(var i=0;i<treeSource.length;i++){for(var j=0;j<treeTarget.length;j++){if(treeTarget[j].id==treeSource[i].id){treeTarget[j].modeMerge=treeSource[i].modeMerge=0;break;}}
treeSource[i].checked=true;treeSource[i].font={'color':'#c23531'};if(treeSource[i].modeMerge==1)treeSource[i].font={'background-color':'#32cd32','color':'#c23531'};this.store.nodesResultTree.push(treeSource[i]);}
for(var i=0;i<treeTarget.length;i++){if(treeTarget[i].modeMerge==1){treeTarget[i].checked=true;treeTarget[i].font={'background-color':'#87cefa'};this.store.nodesResultTree.push(treeTarget[i]);}}
switch(this.operationType){case'import':this.store.nodesOnlineTree=treeSource;this.store.nodesOfflineTree=treeTarget;break;case'publish':this.store.nodesOfflineTree=treeSource;this.store.nodesOnlineTree=treeTarget;break;default:return;}
treeSource=null,treeTarget=null;};this.reset=function(){};this.close=function(){this.store={};this.$modal.remove();};}.call(MergeNavModal.prototype);window.MergeNavModal=new MergeNavModal();})();var pyFormat=function(){var pyFormat=function pyFormat(){this._configMap={"KEY_PY_STORY":"BEOP.WF.PY","version":"1451029779889","JSONUrl":'/static/scripts/workflow2.0/wf.pinyin.json'};};pyFormat.prototype={init:function init(){},getPYLocalStorage:function getPYLocalStorage(){var _this=this,$Dfd=$.Deferred();var setLocalStorage=function setLocalStorage(result){window.localStorage.setItem(_this._configMap.KEY_PY_STORY,JSON.stringify(result));};if(!this._isPYStored()){return $.getJSON(_this._configMap.JSONUrl).done(function(result){if(result){setLocalStorage(result);}});}else{var py=window.localStorage.getItem(this._configMap.KEY_PY_STORY);try{py=JSON.parse(py);if(py.version&&py.version==this._configMap.version){return $Dfd.resolve(py);}else{return $.getJSON(_this._configMap.JSONUrl).done(function(result){if(result){setLocalStorage(result);}});}}catch(ex){return $.getJSON(_this._configMap.JSONUrl).done(function(result){if(result){setLocalStorage(result);}});}}},getPYMap:function getPYMap(PY,value){if(!!!value||value==='undefined')return value;return this._dealPYMap(PY,value);},_getVersion:function _getVersion(){return new Date().getTime();},_dealPYMap:function _dealPYMap(PY,value){if(arguments.length!==2)return new SyntaxError('arguments \'s length isn\'t 2');var format,result=[],_this=this;[].slice.call(value).forEach(function(item){if(typeof item!='string'||!!!item||item==='undefined'){result.push({key:item,pinyin:item,acronym:item});}else{format=_this._getZH_EN(PY,item);result.push({key:item,pinyin:format.pinyin,acronym:format.acronym});}});return result;},_isPYStored:function _isPYStored(){return!!window.localStorage.getItem(this._configMap.KEY_PY_STORY);},_getZH_EN:function _getZH_EN(PinYin,first_letter){var _name='',_char='',_firstChar='',_reg=/[a-z0-9A-Z\- ]/,i=0,len=first_letter.length;for(i=0;i<len;i++){var _val=first_letter[i];if(_reg.test(_val)){_name+=_val;}else{_char=getPinYin(_val);_name+=_char;_firstChar+=_char[0];}}
return{pinyin:_name,acronym:_firstChar};function getPinYin(_val){var _key='';for(var key in PinYin){if(PinYin.hasOwnProperty(key)){if(PinYin[key].indexOf(_val)==-1){_key=_val;}else{_key=key;break;}}}
return _key;}}};return pyFormat;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(beop){var configMap={htmlURL:'/static/views/workflow/memberSelected.html',htmlTemplateId:'#wf-memberSelected-container',settable_map:{cb_dialog_hide:true,cb_dialog_show:true,userHasSelected:true,userMemberMap:true,maxSelected:true,enableDeleteMember:true,enableAddMember:true,maxDelete:true,userReadOnly:false},cb_dialog_hide:$.noop,cb_dialog_show:$.noop,userMemberMap:null,userHasSelected:[],maxSelected:null,enableDeleteMember:true,enableAddMember:true,KEY_PY_STORY:'BEOP.WF.PY',maxDelete:null,userReadOnly:false},stateMap={usersMap:[],addedUserList:[],userHasSelected:[],userHasSelectedDefault:[],allUserList:[],PYMap:[],selectedClassPrefix:'wf-member-selected',memberSelectedDiff:[],isConfirm:false,userReadOnly:false},jqueryMap={},setJqueryMap,configModel,init;var progressResultData,bindEvents,renderCheckedUsers;var filterCheckedUser,searchByFirstName,addActiveSearchBtn,setPYMap,searchByInput,showSearchByID,resetData,renderAddedUsers,onClickUser,onClickRemoveUser,removeMember,addMember,isMemberAdded,checkUserSelectedAmount,checkUserDeletedAmount,restoreSearchResult;setJqueryMap=function setJqueryMap(){var $container=stateMap.$container;jqueryMap={$container:$container,$add_user_dialog:$container.find('#wf-add-person'),$wf_check_result:$container.find('.wf-check-result')};jqueryMap.$wf_search_by_firstName_li=jqueryMap.$add_user_dialog.find('.wf-search-result-title ul li');jqueryMap.$wf_search_byInput=jqueryMap.$add_user_dialog.find('#input-search-name');jqueryMap.$wf_search_result=jqueryMap.$add_user_dialog.find('.wf-search-result');jqueryMap.$wf_search_result_list=jqueryMap.$add_user_dialog.find('.wf-member');jqueryMap.$wf_added_user_list=jqueryMap.$add_user_dialog.find('.wf-added-user-list');jqueryMap.$wf_seaych_byInput=jqueryMap.$add_user_dialog.find('#input-search-name');jqueryMap.$wf_close_btn1=jqueryMap.$add_user_dialog.find('.modal-header button');jqueryMap.$wf_search_result_list.removeClass(stateMap.selectedClassPrefix);jqueryMap.$wf_check_result.empty();jqueryMap.$wf_search_byInput.val('');};configModel=function configModel(input_map){if(!input_map.userReadOnly){configMap.userReadOnly=false;}
beop.util&&beop.util.setConfigMap({input_map:input_map,settable_map:configMap.settable_map,config_map:configMap});return true;};init=function init($container,options){if(arguments.length>2){console.warn('1$containerconfigModel');return false;}
if((typeof options==='undefined'?'undefined':_typeof(options))==='object'){var configModel=options.configModel;if((typeof configModel==='undefined'?'undefined':_typeof(configModel))==='object'){for(var key in configModel){if(configModel.hasOwnProperty(key)){configMap[key]=configModel[key];}}
if(!configMap.userHasSelected)configMap.userHasSelected=[];if(!configModel.userMemberMap)configModel.userMemberMap=[];configMap.userHasSelected.forEach(function(item,index,array){configModel.userMemberMap.forEach(function(members){if(item.id==members.id){array[index]=$.extend(true,{},members);return true;}});});}else{console.error(',configModelObject'+arguments[1]);return false;}}
stateMap.userHasSelected=configMap.userHasSelected?configMap.userHasSelected:[];if(!configMap.userMemberMap||Object.prototype.toString.call(configMap.userMemberMap)!=="[object Array]"){console.error('');return false;}
Spinner.spin($container.get(0));stateMap.$container=$container;WebAPI.get(configMap.htmlURL+'?='+new Date().getTime().toString(16)).done(function(html){stateMap.$container.append(html);resetData();setJqueryMap();var $title=jqueryMap.$container.find('#wf-add-person .modal-title');stateMap.userReadOnly=configMap.userReadOnly;if(stateMap.userReadOnly){$title.attr('i18n','workflow.memberSelected.TITLE1');$('.wf-check-result-container').remove();}else{$title.attr('i18n','workflow.memberSelected.TITLE');}
progressResultData();}).always(function(){Spinner.stop();}).fail(function(){infoBox.alert('');});};bindEvents=function bindEvents(){jqueryMap.$wf_search_result.off().on('click','.wf-member',onClickUser);jqueryMap.$wf_check_result.off().on('click','.glyphicon-remove',onClickRemoveUser);jqueryMap.$wf_search_by_firstName_li.off().on('click',searchByFirstName);jqueryMap.$wf_seaych_byInput.off().on('keyup',searchByInput);jqueryMap.$wf_comfirm_btn=jqueryMap.$add_user_dialog.find('#wf-member-comfirm-btn');jqueryMap.$wf_comfirm_btn.off().on('click',renderAddedUsers);jqueryMap.$add_user_dialog.off().on('show.bs.modal',function(){restoreSearchResult();stateMap.isConfirm=false;}).on('hidden.bs.modal',function(){jqueryMap.$wf_check_result.empty().html(beopTmpl('tpl_wf_dialog_added_member',{members:stateMap.userHasSelectedDefault}));jqueryMap.$wf_search_result_list.removeClass(stateMap.selectedClassPrefix);jqueryMap.$wf_search_result_list.each(function(){var $this=$(this);stateMap.userHasSelectedDefault.forEach(function(item){if(item.id==$this.data('user-id')){$this.addClass(stateMap.selectedClassPrefix);}});});[].slice.call(document.querySelectorAll(configMap.htmlTemplateId)).forEach(function(item){item.parentNode.removeChild(item);});});};renderAddedUsers=function renderAddedUsers(){jqueryMap.$wf_added_user_list.html(beopTmpl('tpl_wf_added_member',{members:stateMap.addedUserList}));stateMap.userHasSelectedDefault=[];stateMap.addedUserList.forEach(function(item){stateMap.userHasSelectedDefault.push(item);});configMap.cb_dialog_hide(stateMap.addedUserList);jqueryMap.$add_user_dialog.modal('hide');};renderCheckedUsers=function renderCheckedUsers(data){if(!data){data=stateMap.addedUserList;}
jqueryMap.$wf_check_result.html(beopTmpl('tpl_wf_dialog_added_member',{members:data}));};progressResultData=function progressResultData(){var addedUserMap={};stateMap.addedUserList=[];stateMap.userHasSelectedDefault=[];stateMap.userHasSelected.forEach(function(item){stateMap.addedUserList.push(item);stateMap.userHasSelectedDefault.push(item);addedUserMap[''+item.id]=item;});stateMap.allUserList=[];configMap.userMemberMap.forEach(function(item){stateMap.allUserList.push(item);});jqueryMap.$wf_search_result.html(beopTmpl('tpl_wf_member',{members:stateMap.allUserList,addUserMap:addedUserMap}));stateMap.allUserList.forEach(function(item){stateMap.usersMap[''+item.id]=item;});I18n.fillArea(stateMap.$container);setPYMap();jqueryMap.$wf_search_result_list=jqueryMap.$add_user_dialog.find('.wf-member');bindEvents();renderCheckedUsers(stateMap.userHasSelectedDefault);restoreSearchResult();Spinner.stop();jqueryMap.$add_user_dialog.modal('show');};restoreSearchResult=function restoreSearchResult(){stateMap.addedUserList=[];stateMap.userHasSelectedDefault.forEach(function(item){stateMap.addedUserList.push(item);});jqueryMap.$wf_search_result_list.show();addActiveSearchBtn(null,2);};setPYMap=function setPYMap(){var PYFormat=new pyFormat(),itemPY={};PYFormat.getPYLocalStorage().done(function(result){stateMap.usersMap.forEach(function(item){if(item.userfullname){itemPY=PYFormat.getPYMap(result.data,item.userfullname.charAt(0))[0];}else{itemPY={id:item.id,key:undefined,pinyin:undefined,acronym:undefined};}
if(item.id&&itemPY){itemPY.id=item.id;}
stateMap.PYMap.push(itemPY);});});PYFormat=null;};showSearchByID=function showSearchByID(result){if(Object.prototype.toString.call(result)!=='[object Array]')return;jqueryMap.$wf_search_result_list.hide();var i;for(i=0;i<result.length;i++){jqueryMap.$wf_search_result_list.each(function(){if($(this).data('user-id')==result[i]){$(this).show();}});}};removeMember=function removeMember(userId){for(var m=0;m<stateMap.addedUserList.length;m++){if(stateMap.addedUserList[m].id==userId){stateMap.addedUserList.splice(m,1);}}};addMember=function addMember(member){if((typeof member==='undefined'?'undefined':_typeof(member))==="object"){if(member.id&&member.userfullname&&member.useremail){!isMemberAdded(member.id)&&stateMap.addedUserList.push(member);}}else{if(stateMap.usersMap[String(member)]){!isMemberAdded(member)&&stateMap.addedUserList.push(stateMap.usersMap[String(member)]);}}
return this;};isMemberAdded=function isMemberAdded(userId){for(var m=0;m<stateMap.addedUserList.length;m++){if(stateMap.addedUserList[m].id==userId){return true;}}
return false;};resetData=function resetData(){stateMap.usersMap=[];stateMap.addedUserList=[];stateMap.allUserList=[];stateMap.PYMap=[];stateMap.memberSelectedDiff=[];stateMap.isConfirm=false;stateMap.userHasSelectedDefault=[];};checkUserSelectedAmount=function checkUserSelectedAmount(){if(configMap.maxSelected){var li=jqueryMap.$wf_check_result.find('li');var length=li.length=='undefined'?0:li.length;if(configMap.maxSelected<=length){return false;}}
return true;};checkUserDeletedAmount=function checkUserDeletedAmount(){if(configMap.maxDelete){var li=jqueryMap.$wf_check_result.find('li');var length=li.length=='undefined'?0:li.length;return configMap.maxDelete<length;}
return true;};onClickUser=function onClickUser(){if(stateMap.userReadOnly){return;}
var $this=$(this),selectedClass=stateMap.selectedClassPrefix;var userId=''+$this.data('user-id');if(configMap.maxSelected==1){if(!$this.hasClass(selectedClass)){if(!isMemberAdded(userId)){stateMap.addedUserList=[];addMember(userId);jqueryMap.$wf_search_result_list.removeClass(selectedClass);$this.addClass(selectedClass);}}}else{if(!$this.hasClass(selectedClass)){if(configMap.enableAddMember){if(checkUserSelectedAmount()){if(!isMemberAdded(userId)){addMember(userId);$this.addClass(selectedClass);}}else{Alert.danger(ElScreenContainer,'').showAtTop(300);return false;}}else{Alert.danger(ElScreenContainer,'').showAtTop(300);return false;}}else{if(configMap.enableDeleteMember){if(checkUserDeletedAmount()){$this.removeClass(selectedClass);removeMember(userId);}}else{Alert.danger(ElScreenContainer,'').showAtTop(300);return false;}}}
renderCheckedUsers();};onClickRemoveUser=function onClickRemoveUser(){var $this=$(this),userId=$this.data('user-id');if(configMap.enableDeleteMember){if(checkUserDeletedAmount()){$this.parent().remove();removeMember(userId);filterCheckedUser(userId);}}else{Alert.danger(ElScreenContainer,'').showAtTop(300);return false;}};searchByFirstName=function searchByFirstName(){var $this=$(this),searchIndex=$this.text(),result=[],key,i;addActiveSearchBtn($this,1);if($this.index()==0){jqueryMap.$wf_search_result_list.show();}else{for(i=0;i<stateMap.PYMap.length;i++){if(stateMap.PYMap[i]&&stateMap.PYMap[i].pinyin&&(stateMap.PYMap[i].pinyin.charAt(0).toLowerCase()==searchIndex||stateMap.PYMap[i].acronym.charAt(0).toLowerCase()==searchIndex)){result.push(stateMap.PYMap[i].id);}}
showSearchByID(result);}};searchByInput=function searchByInput(ev){ev.preventDefault();ev.stopPropagation();var $this=$(this);var value=$.trim($this.val());if(value==''){jqueryMap.$wf_search_result_list.show();addActiveSearchBtn(null,2);}else{var result=[];for(var i=0;i<stateMap.allUserList.length;i++){(function(i){var member=stateMap.allUserList[i];if(member.userfullname.toLowerCase().indexOf(value.toLowerCase())!=-1||member.useremail&&member.useremail.toLowerCase().indexOf(value.toLowerCase())!=-1){result.push(member.id);}})(i);}
showSearchByID(result);}};filterCheckedUser=function filterCheckedUser(userId){jqueryMap.$wf_search_result_list.each(function(){var $this=$(this);if($this.data('user-id')==userId){$this.removeClass(stateMap.selectedClassPrefix);}});};addActiveSearchBtn=function addActiveSearchBtn($which,type){if($which&&type==1){jqueryMap.$wf_search_by_firstName_li.removeClass('active');$which.addClass('active');}else if(type==2){jqueryMap.$wf_search_by_firstName_li.removeClass('active').eq(0).addClass('active');}};beop.view=beop.view||{};beop.view.memberSelected={addMember:addMember,configModel:configModel,init:init,renderCheckedUsers:renderCheckedUsers};})(beop||(beop={}));;(function(exports){function MemberSelectedModal(){this.$modalWrap=null;this.$modal=null;this.callback=null;this.state={};this.state.selectedUser=[];this.emailRegex=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/;}~function(){this.show=function(callback){var _this=this;var domWrap=document.body;this.callback=callback;if(this.$modalWrap){this.$modalWrap.appendTo(domWrap);this.initModal();return;}
WebAPI.get('/static/app/WebFactory/scripts/modals/memberSelectedModal/memberSelectedModal.html').done(function(html){_this.$modalWrap=$(html).appendTo(domWrap);_this.init();});};this.setState=function(state){this.state=$.extend(false,this.state,state);return this;};this.init=function(){this.$modal=this.$modalWrap.children('.modal');this.initModal();this.attachEvents();};this.initModal=function(){var _this=this;WebAPI.post('/admin/memberSelected/',{userId:AppConfig.userId,userList:_this.state.selectedUser.map(function(item){return item.id;})}).done(function(rs){if(rs.success){beop.view.memberSelected.init($(document.body),{configModel:{userMemberMap:rs.data,userHasSelected:_this.state.selectedUser,cb_dialog_hide:_this.onConfirmCallback.bind(_this),maxSelected:null}});}});};this.attachEvents=function(){var _this=this;this.$modal.off('hidden.bs.modal').on('hidden.bs.modal',function(){_this.hide();});$('#addPersonPower').off('click').click(function(){var inputText=$('#input-search-name').val();inputText=inputText?inputText.trim():inputText;if(!inputText||!_this.emailRegex.test(inputText)){alert('invalid input text.');}
WebAPI.post('/admin/select/searchUseId',{userEmail:inputText}).done(function(rs){if(rs.success&&rs.data){beop.view.memberSelected.addMember(rs.data).renderCheckedUsers();}else{alert('The email is not exist.');}});});};this.reset=function(){this.setState({memberSelected:[]});};this.onConfirmCallback=function(){typeof this.callback==='function'&&this.callback.apply(null,arguments);};this.hide=function(){this.reset();if(this.$modalWrap){this.$modalWrap.detach();}};}.call(MemberSelectedModal.prototype);exports.MemberSelectedModal=new MemberSelectedModal();})(window);;(function(exports,screens){var delayTimer=null;var DELAY_TIME=300;function FactoryScreen(){this.pagePanelCtn=null;this.layout={dockManager:null,documentNode:null,pagePanel:null};this.page=null;this.layerPanel=null;this.propPanel=null;this.historyPanel=null;this.windowPanel=null;this.pagePanel=null;this.dataSourcePanel=null;this.project={};this.syncWorker=null;this.init();this.initLayout();this.initSyncWorker();}
FactoryScreen.prototype.show=function(item){var _this=this;Spinner.spin(document.body);this.project=AppConfig.project={id:item.id,cnName:item.name_cn,bindId:item.bindId};AppConfig.projectTimeFormat=item.bindId?BEOPUtil.getProjectFromAppConfig(item.bindId)?BEOPUtil.getProjectFromAppConfig(item.bindId).time_format:0:0;$('#lkName').text(item.name_cn).attr("data-projId",item.id).attr("title",item.name_cn).closest('#pageNav').show().click(function(e){e.stopPropagation();$('#userNav li').toggleClass('open');});this.preLoad().done(function(){_this.initPagePanel();_this.pagePanel.show();});};FactoryScreen.prototype.preLoad=function(){var promise=$.Deferred();return promise.resolve().then(function(){return WebAPI.get('/analysis/datasource/getDsItemInfo/'+AppConfig.userId+'/null').done(function(result){AppConfig.datasource=new DataSource({store:{group:result}});});});};FactoryScreen.prototype.init=function(){this.initNav();};FactoryScreen.prototype.generateTreeEx=function(arr){var result=[];var params;for(var i=0,len=arr.length;i<len;i++){var item=arr[i];params={id:item._id,pId:item.parent,name:item.text+' - '+item.type,type:item.type};if('DropDownList'==item.type){params={id:item._id,pId:item.parent,name:item.text,type:item.type};params.isParent=true;params.isHide=item.isHide;result.push(params);}else if('PageScreen'==item.type){params.isParent=false;params.isHide=item.isHide;params.isLock=item.isLock;params.layerList=item.layerList;params.width=item.width;params.height=item.height;params.display=item.display;result.push(params);}else{params.isParent=false;params.isHide=item.isHide;params.isLock=item.isLock;result.push(params);}}
return result;};FactoryScreen.prototype.initNav=function(){var _this=this;$('#pageNav').hide();$('#pageTopTools').hide();$('#lkSwitchProject,#lkProjectLogo').off('click').click(function(){$('#mainframe').hide();$('#modalframe').show();FactoryLogin.prototype.createPro(AppConfig.userId);_this.close();});$('#lkPreviewProject').off('click').click(function(){$(this).attr('href','/factory/previewProject/'+AppConfig.userId+'/'+_this.project.id);});$('#lkRelease').off('click').click(function(){MergeNavModal.show(AppConfig.project.bindId,AppConfig.project.id,'publish');});$('#userNav').show();};FactoryScreen.prototype.initLayoutDOM=function(){this.pagePanelCtn=document.createElement('div');this.pagePanelCtn.id='pagePanel';this.pagePanelCtn.setAttribute('caption',I18n.resource.mainPanel.attrPanel.attrTab.PAGE_MANAGE);this.pagePanelCtn.dataset.type='PagePanel';};FactoryScreen.prototype.initLayout=function(){var _this=this;var divDockManager=document.querySelector('#panels');var dockManager=this.layout.dockManager=new dockspawn.DockManager(divDockManager);var onResized=function onResized(e){dockManager.resize(window.innerWidth-(divDockManager.clientLeft+divDockManager.offsetLeft),window.innerHeight-(divDockManager.clientTop+divDockManager.offsetTop));if(delayTimer){window.clearTimeout(delayTimer);delayTimer=null;}
delayTimer=window.setTimeout(function(){if(_this.page&&typeof _this.page.resize==='function'){_this.page.resize();}
window.clearTimeout(delayTimer);delayTimer=null;},DELAY_TIME);};var documentNode,pagePanel;dockManager.initialize();window.onresize=onResized;onResized(null);this.initLayoutDOM();this.layout.pagePanel=pagePanel=new dockspawn.PanelContainer(this.pagePanelCtn,dockManager);this.layout.documentNode=documentNode=dockManager.context.model.documentManagerNode;dockManager.dockRight(documentNode,pagePanel,.2);};FactoryScreen.prototype.initSyncWorker=function(){this.syncWorker&&this.syncWorker.close();this.syncWorker=new SyncWorker(this);this.syncWorker.init();};FactoryScreen.prototype.initPagePanel=function(){this.pagePanel&&this.pagePanel.close();this.pagePanel=new PagePanel(this);this.pagePanel.init();};FactoryScreen.prototype.showPage=function(page){var modalClass;if(this.page){this.page.close();this.page=null;}
modalClass=screens[page.type];if(!modalClass){Log.warn('page type not found: "'+page.type+'"');return;}
this.page=new modalClass(page,this);this.page.show();};FactoryScreen.prototype.getPageList=function(){return this.pagePanel.getPageList();};FactoryScreen.prototype.getPagesData=function(){if(!this.page)return null;return this.page.getPagesData();};FactoryScreen.prototype.getLayersData=function(){if(!this.page)return null;return this.page.getLayersData();};FactoryScreen.prototype.getWidgetsData=function(){if(!this.page)return null;return this.page.getWidgetsData();};FactoryScreen.prototype.close=function(){this.page&&this.page.close();this.page=null;this.syncWorker&&this.syncWorker.close();this.pagePanel&&this.pagePanel.close();if(this.layout.pagePanel.floatingDialog){this.layout.pagePanel.floatingDialog.destroy();}
this.layout.dockManager.context.model.rootNode.container.destroy();this.layout={};};exports.FactoryScreen=FactoryScreen;})(namespace('factory'),namespace('factory.screens'));;(function(exports,SuperClass,screens){function FactoryTplScreen(){SuperClass.apply(this,arguments);}
FactoryTplScreen.prototype=Object.create(SuperClass.prototype);+function(){this.init=function(){SuperClass.prototype.init.apply(this,arguments);};this.initNav=function(){document.querySelector('#divLogoWrap').style.display='none';document.querySelector('#pageNav').style.display='none';};this.show=function(params,type){var _this=this;Spinner.spin(document.body);this.preLoad().done(function(){this.showTemplatePage(params,type);Spinner.stop();}.bind(this));};this.showTemplatePage=function(params,type){if(type==='report'){this.page=new screens.FacReportTplScreen(params,this);this.page.show();}};this.initLayoutDOM=function(){};this.initLayout=function(){var divDockManager=document.querySelector('#panels');var dockManager=this.layout.dockManager=new dockspawn.DockManager(divDockManager);var onResized=function onResized(e){dockManager.resize(window.innerWidth-(divDockManager.clientLeft+divDockManager.offsetLeft),window.innerHeight-(divDockManager.clientTop+divDockManager.offsetTop));};dockManager.initialize();window.onresize=onResized;onResized(null);this.layout.documentNode=dockManager.context.model.documentManagerNode;};this.close=function(){this.page=null;this.syncWorker&&this.syncWorker.close();this.layout.dockManager.context.model.rootNode.container.destroy();document.querySelector('#divLogoWrap').style.display='';document.querySelector('#pageNav').style.display='';$('#mainframe').hide();$('#modalframe').show();};}.call(FactoryTplScreen.prototype);exports.FactoryTplScreen=FactoryTplScreen;})(namespace('factory'),namespace('factory.FactoryScreen'),namespace('factory.screens'));var AppConfig={projectId:122,projectName:undefined,userId:undefined,account:undefined,level:undefined,projectList:undefined,isMobile:false,isFactory:1,isReportConifgMode:1,menu:[],chartTheme:theme.Dark,syncInterval:120000};var Spinner=new LoadingSpinner({color:'#00FFFF'});var I18n=I18n||undefined;var I18N_PATH='/static/app/WebFactory/views/js/i18n/';$(document).ready(function(){initI18n(navigator.language.split('-')[0],false);});function initI18n(lang,isForce){InitI18nResource(lang,isForce,I18N_PATH).always(function(rs){I18n=new Internationalization(null,rs);new FactoryLogin().show();});};var FactoryLogin=function(FactoryScreen,TemplateList){function FactoryLogin(){this.topArr=[];this.$addProj=undefined;this.$projectList=undefined;this.projectList=undefined;}
FactoryLogin.prototype.show=function(){var _this=this;$("#selectLanguage a").off('click').click(function(e){initI18n(e.currentTarget.attributes.value.value,true);e.preventDefault();});$('#login').off('click').click(function(){_this.login();});$(document).on("keydown.login",".loginBox input",function(event){var e=event||window.event||arguments.callee.caller.arguments[0];if(e&&e.keyCode==13){_this.login();$(document).off('keydown.login');}});_this.restorePwd();if(I18n.type){$('#languageTitle').attr('class',I18n.type+'Checked country');}
var token=document.querySelector('#hidToken').value;if(token!==''){this.loginTask({token:token});}else{I18n.fillArea($('#divFactoryLanguage').fadeIn());I18n.fillArea($('#modalLogin').fadeIn());}};FactoryLogin.prototype.login=function(){var _this=this;var $btnLogin=$('#login');var loginFail=function loginFail(msg){$('.alert').remove();new Alert($("#factoryLogin"),"danger",msg).show().close();$btnLogin.prop('disabled',false);};var txtName=$("#userName").val(),txtPwd=$("#userPass").val();if(!(txtName&&txtPwd)){loginFail(I18n.resource.admin.login.LOG_IN_EMPTY);return;}
this.loginTask({name:txtName,pwd:txtPwd});};FactoryLogin.prototype.logout=function(){WebAPI.get('/logout/'+AppConfig.userId).always(function(){AppConfig={};localStorage.removeItem("userInfo");window.location.href='/factory';});};FactoryLogin.prototype.loginTask=function(loginInfo){var _this=this;var $btnLogin=$('#login');var loginFail=function loginFail(msg){$('.alert').remove();new Alert($("#factoryLogin"),"danger",msg).show().close();$btnLogin.prop('disabled',false);};$btnLogin.prop('disabled',false);_this.loadingSpinner(true);WebAPI.post("/login",loginInfo).then(function(login_result){try{if(login_result.status!=undefined&&login_result.status==true){if(login_result.projects&&login_result.projects.length>0){_this.rememberPwd();window.localStorage.setItem("versionHistory",login_result.version);AppConfig.userId=login_result.id;AppConfig.projectList=login_result.projects;AppConfig.userProfile=login_result.userProfile;AppConfig.account=login_result.userProfile.name;AppConfig.userOfRole=login_result.userProfile.userOfRole;$('#modalLogin').hide();document.onkeydown=null;I18n.fillArea($('#modalframe').fadeIn());_this.$projectList=$('#projectList');_this.createPro(login_result.id);_this.createTemlatePanel();_this.attachEvents();_this.getAvatar();}else{loginFail("<strong>"+I18n.resource.admin.login.LOG_IN_FAILED+"</strong> ");document.querySelector('#hidToken').value='';I18n.fillArea($('#divFactoryLanguage').fadeIn());I18n.fillArea($('#modalLogin').fadeIn());}}else{if(login_result.code===1){loginFail("<strong>"+I18n.resource.admin.login.LOG_IN_FAILED+"</strong> ");}else if(login_result.code===2){loginFail("<strong>"+I18n.resource.admin.login.LOG_IN_TOKEN_EXPIRED+"</strong> ");}
document.querySelector('#hidToken').value='';I18n.fillArea($('#divFactoryLanguage').fadeIn());I18n.fillArea($('#modalLogin').fadeIn());}}catch(e){loginFail("<strong>"+I18n.resource.admin.login.LOG_IN_FAILED+"</strong>");return false;}}).always(function(){_this.loadingSpinner(false);});};FactoryLogin.prototype.attachEvents=function(){var _this=this;$('#addPro').off('click').click(function(){_this.editProjId=null;_this.editProjName=null;_this.configProjId=null;AddProModal.show(_this);});$('#lkLogOut,#lkLogOut2').off('click').on('click',function(){_this.logout();});$('#btnImportProject').off('click').click(function(){ImportProjectModal.show(function(project){var $proBox=_this.createProItem(project,AppConfig.userId);_this.$projectList.append($proBox);});});var $searchProject=$('.searchProject').find(".search");var $empty=$('.searchProject').find(".searchSpan");$searchProject.keyup(function(e){var searchVal=$(e.currentTarget).val();var result=[];if(13==e.keyCode){_this.$projectList.html("");for(var i=0,length=_this.projectList.length;i<length;i++){if(_this.projectList[i].name_cn&&$.trim(_this.projectList[i].name_cn).indexOf(searchVal)!==-1||_this.projectList[i].bindId&&$.trim(_this.projectList[i].bindId).indexOf($.trim(searchVal))!==-1||_this.projectList[i].name_cn&&$.trim(_this.projectList[i].name_cn.toString()).toLowerCase().indexOf(searchVal.toLowerCase())!==-1){result.push(_this.projectList[i]);_this.createProItems(i,_this.projectList);}}}
if(''==searchVal){_this.$projectList.html("");for(var i=0,length=_this.projectList.length;i<length;i++){_this.createProItems(i,_this.projectList);}}});$empty.off("click").on("click",function(){$searchProject.val("");_this.$projectList.html("");for(var i=0,length=_this.projectList.length;i<length;i++){_this.createProItems(i,_this.projectList);}});};FactoryLogin.prototype.rememberPwd=function(){if($("#rememberPass").is(":checked")){localStorage["userInfo"]=JSON.stringify({name:$("#userName").val(),pwd:$("#userPass").val()});}else{localStorage.removeItem("userInfo");}};FactoryLogin.prototype.restorePwd=function(){if(localStorage["userInfo"]){var data=JSON.parse(localStorage["userInfo"]);if(data.pwd&&data.pwd!=""){$("#rememberPass").attr("checked",true);$("#userName").val(data.name);$("#userPass").val(data.pwd);}}};FactoryLogin.prototype.loadingSpinner=function(flag){var $spinner=$('.loginBox .spinner');var state=flag?"none":"block";var state2=!flag?"none":"block";$spinner.css('display',state2).siblings('.loginSj').css('display',state);};FactoryLogin.prototype.getAvatar=function(){$('#modalframe .userPic.small,#userNav .userPic.small').attr('src',AppConfig.userProfile.picture).attr('alt',AppConfig.userProfile.fullname||AppConfig.account);};FactoryLogin.prototype.createTemlatePanel=function(){var Template=namespace('factory.components.template.Template');this.template=new Template(document.querySelector('#tplContainer'));this.template.show();};FactoryLogin.prototype.createPro=function(loginResultId){var _this=this;_this.$projectList=$('#projectList');_this.$projectList.html("");_this.topArr=[];var $proBox,item,deleteArr=[],itemLocalList={};var userId=loginResultId;var jsonTopArr=JSON.parse(localStorage.getItem('fac_project_topArray_'+userId));if(jsonTopArr&&jsonTopArr.length!==0){_this.topArr=jsonTopArr;}
Spinner.spin(_this.$projectList[0]);WebAPI.get('/factory/getProjectList/'+userId).done(function(result){var loginResult=[];loginResult=result?result.data:[];_this.projectList=result.data;for(var i=0;i<loginResult.length;i++){_this.createProItems(i,loginResult);for(var k=_this.topArr.length-1;k>=0;k--){var info=_this.topArr[k];if(info.id===loginResult[i]._id){var item={id:loginResult[i]._id,name_cn:loginResult[i].name_cn,bindId:loginResult[i].bindId};$proBox=_this.createProItem(item,userId);_this.$projectList.prepend($proBox);}}}}).always(function(){Spinner.stop();});};FactoryLogin.prototype.createProItems=function(i,loginResult){var _this=this;item=loginResult[i];itemLocalList={id:item.id?item.id:item._id,name_cn:item.name_cn,bindId:item.bindId};$proBox=_this.createProItem(itemLocalList,AppConfig.userId);if(_this.topArr.length!==0){var isExist=false;for(var j=_this.topArr.length-1;j>=0;j--){var topArrId;topArrId=_this.topArr[j].id;if(topArrId==itemLocalList.id){isExist=true;break;return;}}
if(!isExist){_this.$projectList.append($proBox);}else{$proBox.remove();return;}}else{_this.$projectList.append($proBox);}};FactoryLogin.prototype.createProItem=function(item,userId){var _this=this;var $projectBox,$thParent;var itemId=item.bindId?item.bindId:'';$projectBox=$('<div class="divHover proHover" projectId='+item.id+' configProjId='+itemId+'>\
                    <span class="proText"></span>\
                    <div class="spanBox">\
                    <span class="glyphicon glyphicon-edit editPro" title='+I18n.resource.admin.welcom.yourProj.EDITE_PRO+' id="editPro'+item.id+'"></span>\
                    <span class="glyphicon glyphicon-share-alt exportPro" title='+I18n.resource.admin.welcom.yourProj.EXPORT+' id="exportPro'+item.id+'" style="display:none;"></span>\
                    <span class="glyphicon glyphicon-upload proTop" title='+I18n.resource.admin.welcom.yourProj.TOP+'></span>\
                    <span class="glyphicon glyphicon-remove-sign deletePro" title='+I18n.resource.admin.welcom.yourProj.DELETE+' id="deletePro_'+item.id+'"></span>\
                    <span class="glyphicon glyphicon-user editAuth" data-id="'+item.id+'" title='+I18n.resource.admin.welcom.yourProj.EDIT_AUTH+'></span>\
                    </div>\
                    <br style="clear:both"/></div>');if(itemId!==""){$projectBox.find('.proText').html(item.name_cn+' ('+itemId+')').attr('title',item.name_cn);$projectBox.find('.proText').addClass('bindPro');}else{$projectBox.find('.proText').html(item.name_cn).attr('title',item.name_cn);}
$projectBox.find('.proText').off('dblclick').dblclick(function(e){var $this=$(this);var parentBindId=$this.parent('.divHover').attr('configprojid');var nameCnText=$this.html().split(" ")[0].trim();item.bindId=parentBindId?parentBindId:item.bindId;var $empty=$('.searchProject').find(".searchSpan");$empty.trigger("click");$('#modalframe').hide();$("#pageTypesBox").hide();$("#myFrame").hide();I18n.fillArea($('#mainframe').fadeIn());if(item.name_cn!==nameCnText){item.name_cn=nameCnText;}
new FactoryScreen().show(item);});$projectBox.find('.editPro').off('click').click(function(){_this.editProjId=item.id;_this.editProjName=item.name_cn;_this.configProjId=item.bindId;AddProModal.show(_this);});$projectBox.find('.deletePro').off('click').click(function(){var projectId=this.id.split('_')[1];RemoveProModal.show(_this,projectId);});$projectBox.find('.proTop').off('click').click(function(e){var transItem;$thParent=$(this).parents('.proHover');_this.$projectList.prepend($thParent);for(var j=0;j<_this.topArr.length;j++){var tempId;tempId=_this.topArr[j].id;if(item.id==tempId){_this.topArr.splice(j,1);}}
_this.topArr.unshift(item);localStorage.setItem('fac_project_topArray_'+userId,JSON.stringify(_this.topArr));});$projectBox.find('.editAuth').off('click').click(function(e){var projId=this.dataset.id;WebAPI.get('/factory/getProjectUser/'+projId).done(function(rs){MemberSelectedModal.setState({selectedUser:rs.data}).show(function(userList){if(userList.length<=0){alert('Please select at least one user!');return;}
WebAPI.post('/factory/updateProjectAuth',{projId:projId,userIds:userList.map(function(row){return row.id;})});});});});return $projectBox;};FactoryLogin.prototype.removeProItem=function(projectId){var $removeProModal=$('#removeProModal');var password=$('#removePass').val();if(password===''){$removeProModal.find('.wrongPromt').html(I18n.resource.admin.login.PANE_PLACEHOLDER_PWD);}else{$removeProModal.find('.wrongPromt').html('');var postData={userId:AppConfig.userId,projId:projectId,proPass:password};WebAPI.post('/factory/removeProject/remove',postData).done(function(result){if(result.status==='OK'){alert(result.msg);$removeProModal.remove();var arr=JSON.parse(localStorage.getItem('fac_project_topArray_'+AppConfig.userId));if(arr){if(arr.length!==0){for(var i=0;i<arr.length;i++){if(projectId===arr[i].id){arr.splice(i,1);localStorage.setItem('fac_project_topArray_'+AppConfig.userId,JSON.stringify(arr));break;}}}}
$('.proHover').filter('[projectid="'+projectId+'"]').remove();var $ProjectRecycle=$('#ulRecycleTabs').find("li[data-type='ProjectRecycle']").children('.divTab');if($ProjectRecycle.hasClass('divCheck')){$ProjectRecycle.trigger('click');}}else{new Alert($('.wrongPromt'),'danger',result.msg).show(1000).close();}});}};FactoryLogin.prototype.close=function(){this.topArr=null;this.$addProj=null;this.$projectList=null;};return FactoryLogin;}(namespace('factory.FactoryScreen'),namespace('factory.components.TemplateList'));var Spinner=new LoadingSpinner({color:'#00FFFF'});var LoginValidate=function(){function LoginValidate(){this.topArr=[];this.$addProj=undefined;this.$projectList=undefined;this.projectList=undefined;this.loadModal='\
    <div class="modal fade"  id="loginValidateModal" data-backdrop="static">\
        <style>\
            #loginValidateModal .input-group input{\
                margin-bottom: -1px;\
                margin-top: 1px;\
            }\
            #loginValidateModal #rememberPwd{\
                margin-top: 2px;\
            }\
        </style>\
        <div class="modal-dialog">\
            <div class="modal-content">\
                <div class="modal-header">\
                    <h4 class="modal-title">Login</h4>\
                </div>\
                <div class="modal-body">\
                    <div class="" id="loginContent">\
                        <div class="input-group">\
                            <span class="input-group-addon glyphicon glyphicon-user textBefore"></span>\
                            <input type="text" required="required" class="form-control" id="loginUserName" autofocus=""  autocomplete="off" placeholder="Please enter user name">\
                        </div>\
                        <div class="input-group">\
                            <span class="input-group-addon glyphicon glyphicon-lock textBefore"></span>\
                            <input type="password" required="required" class="form-control" id="loginUserPass" autocomplete="off" placeholder="Please enter your password">\
                        </div>\
                        <div class="checkbox">\
                            <label for="rememberPwd">\
                                <input type="checkbox" class="rememberPass" id="rememberPwd" checked="checked">Remember\
                            </label>\
                        </div>\
                    </div>\
                </div>\
                <div class="modal-footer">\
                    <button type="button" class="btn btn-primary" id="confirmLogin">OK</button>\
                </div>\
            </div>\
       </div>\
    </div>';}
LoginValidate.prototype.show=function(){var bodyContent=$(document.body);if(bodyContent.find('#loginValidateModal').length>0){bodyContent.find('#loginValidateModal').remove();}
bodyContent.append(this.loadModal);var _this=this;$('#confirmLogin').off('click').click(function(){_this.login();});$(document.body).off('keydown.login').on('keydown.login',function(e){if(e&&e.keyCode==13){_this.login();$(document).off('keydown.login');}});_this.restorePwd();$('#loginValidateModal').modal('show').on('hidden.bs.modal',function(e){_this.close();});};LoginValidate.prototype.login=function(){var $btnLogin=$('#confirmLogin');var loginFail=function loginFail(msg){$('.alert').remove();new Alert($("#loginContent"),"danger",msg).show().close();$btnLogin.prop('disabled',false);};var txtName=$("#loginUserName").val(),txtPwd=$("#loginUserPass").val();if(!(txtName&&txtPwd)){loginFail('Please enter your username and password');return;}
this.loginTask({name:txtName,pwd:txtPwd});};LoginValidate.prototype.loginTask=function(loginInfo){var _this=this;var $btnLogin=$('#confirmLogin');var loginFail=function loginFail(msg){$('.alert').remove();new Alert($("#loginContent"),"danger",msg).show().close();$btnLogin.prop('disabled',false);};$btnLogin.prop('disabled',false);var target=$('#loginValidateModal').find('.modal-content')[0];Spinner.spin(target);WebAPI.post("/login",loginInfo).then(function(login_result){try{if(login_result.status!=undefined&&login_result.status==true){if(login_result.projects&&login_result.projects.length>0){_this.rememberPwd();$('#loginValidateModal').modal('hide');window.location.reload();}else{loginFail("<strong>Login failed</strong>");}}else{if(login_result.code===1){loginFail("<strong>Login failed</strong>");}else if(login_result.code===2){loginFail("<strong>Login token expired, please relogin</strong>");}}}catch(e){loginFail("<strong>Login failed</strong>");return false;}}).always(function(){Spinner.stop();});};LoginValidate.prototype.rememberPwd=function(){if($("#rememberPwd").is(":checked")){localStorage["userInfo"]=JSON.stringify({name:$("#loginUserName").val(),pwd:$("#loginUserPass").val()});}else{localStorage.removeItem("userInfo");}};LoginValidate.prototype.restorePwd=function(){if(localStorage["userInfo"]){var data=JSON.parse(localStorage["userInfo"]);if(data.pwd&&data.pwd!=""){$("#rememberPwd").attr("checked",true);$("#loginUserName").val(data.name);$("#loginUserPass").val(data.pwd);}}};LoginValidate.prototype.close=function(){this.topArr=null;this.$addProj=null;this.$projectList=null;this.loadModal=null;$('#loginValidateModal').remove();};return LoginValidate;}();