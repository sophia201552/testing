var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(a,b){"object"==(typeof module==="undefined"?"undefined":_typeof(module))&&"object"==_typeof(module.exports)?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a);}:b(a);}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.4",n=function n(a,b){return new n.fn.init(a,b);},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function r(a,b){return b.toUpperCase();};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function toArray(){return d.call(this);},get:function get(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this);},pushStack:function pushStack(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b;},each:function each(a,b){return n.each(this,a,b);},map:function map(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b);}));},slice:function slice(){return this.pushStack(d.apply(this,arguments));},first:function first(){return this.eq(0);},last:function last(){return this.eq(-1);},eq:function eq(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[]);},end:function end(){return this.prevObject||this.constructor(null);},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==(typeof g==="undefined"?"undefined":_typeof(g))||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++){if(null!=(a=arguments[h]))for(b in a){c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));}}return g;},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function error(a){throw new Error(a);},noop:function noop(){},isFunction:function isFunction(a){return"function"===n.type(a);},isArray:Array.isArray,isWindow:function isWindow(a){return null!=a&&a===a.window;},isNumeric:function isNumeric(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0;},isPlainObject:function isPlainObject(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0;},isEmptyObject:function isEmptyObject(a){var b;for(b in a){return!1;}return!0;},type:function type(a){return null==a?a+"":"object"==(typeof a==="undefined"?"undefined":_typeof(a))||"function"==typeof a?h[i.call(a)]||"object":typeof a==="undefined"?"undefined":_typeof(a);},globalEval:function globalEval(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a));},camelCase:function camelCase(a){return a.replace(p,"ms-").replace(q,r);},nodeName:function nodeName(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase();},each:function each(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++){if(d=b.apply(a[e],c),d===!1)break;}}else for(e in a){if(d=b.apply(a[e],c),d===!1)break;}}else if(g){for(;f>e;e++){if(d=b.call(a[e],e,a[e]),d===!1)break;}}else for(e in a){if(d=b.call(a[e],e,a[e]),d===!1)break;}return a;},trim:function trim(a){return null==a?"":(a+"").replace(o,"");},makeArray:function makeArray(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c;},inArray:function inArray(a,b,c){return null==b?-1:g.call(b,a,c);},merge:function merge(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++){a[e++]=b[d];}return a.length=e,a;},grep:function grep(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++){d=!b(a[f],f),d!==h&&e.push(a[f]);}return e;},map:function map(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++){d=b(a[f],f,c),null!=d&&i.push(d);}else for(f in a){d=b(a[f],f,c),null!=d&&i.push(d);}return e.apply([],i);},guid:1,proxy:function proxy(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function f(){return a.apply(b||this,e.concat(d.call(arguments)));},f.guid=a.guid=a.guid||n.guid++,f):void 0;},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase();});function s(a){var b="length"in a&&a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a;}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date(),v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function B(a,b){return a===b&&(l=!0),0;},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function J(a,b){for(var c=0,d=a.length;d>c;c++){if(a[c]===b)return c;}return-1;},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function da(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320);},ea=function ea(){m();};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType;}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b));}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]){}a.length=c-1;}};}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d;}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d;}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d;}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--){o[l]=s+ra(o[l]);}w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",");}if(x)try{return H.apply(d,w.querySelectorAll(x)),d;}catch(y){}finally{r||b.removeAttribute("id");}}}return i(a.replace(R,"$1"),b,d,e);}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e;}return b;}function ia(a){return a[u]=!0,a;}function ja(a){var b=n.createElement("div");try{return!!a(b);}catch(c){return!1;}finally{b.parentNode&&b.parentNode.removeChild(b),b=null;}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--){d.attrHandle[c[e]]=b;}}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling){if(c===b)return-1;}return a?1:-1;}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a;};}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a;};}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--){c[e=f[g]]&&(c[e]=!(d[e]=c[e]));}});});}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a;}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1;},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className");}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length;}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length;}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[];}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b;};}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b;};}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0;}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++]){1===c.nodeType&&d.push(c);}return d;}return f;},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0;},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]");}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:");})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P);}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)));}:function(a,b){if(b)while(b=b.parentNode){if(b===a)return!0;}return!1;},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1);}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode){h.unshift(c);}c=b;while(c=c.parentNode){i.unshift(c);}while(h[d]===i[d]){d++;}return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0;},g):n;},ga.matches=function(a,b){return ga(a,null,null,b);},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d;}catch(e){}return ga(b,n,null,[a]).length>0;},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b);},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null;},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a);},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++]){b===a[f]&&(e=d.push(f));}while(e--){a.splice(d[e],1);}}return k=null,a;},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling){c+=e(a);}}else if(3===f||4===f)return a.nodeValue;}else while(b=a[d++]){c+=e(b);}return c;},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function ATTR(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4);},CHILD:function CHILD(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a;},PSEUDO:function PSEUDO(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3));}},filter:{TAG:function TAG(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0;}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b;};},CLASS:function CLASS(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"");});},ATTR:function ATTR(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0;};},CHILD:function CHILD(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode;}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p]){if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;}o=p="only"===a&&!o&&"nextSibling";}return!0;}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break;}}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;}return m-=e,m===d||m%d===0&&m/d>=0;}};},PSEUDO:function PSEUDO(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--){d=J(a,f[g]),a[d]=!(c[d]=f[g]);}}):function(a){return e(a,0,c);}):e;}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--){(f=g[h])&&(a[h]=!(b[h]=f));}}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop();};}),has:ia(function(a){return function(b){return ga(a,b).length>0;};}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1;};}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");}while((b=b.parentNode)&&1===b.nodeType);return!1;};}),target:function target(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id;},root:function root(a){return a===o;},focus:function focus(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex);},enabled:function enabled(a){return a.disabled===!1;},disabled:function disabled(a){return a.disabled===!0;},checked:function checked(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected;},selected:function selected(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0;},empty:function empty(a){for(a=a.firstChild;a;a=a.nextSibling){if(a.nodeType<6)return!1;}return!0;},parent:function parent(a){return!d.pseudos.empty(a);},header:function header(a){return Z.test(a.nodeName);},input:function input(a){return Y.test(a.nodeName);},button:function button(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b;},text:function text(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase());},first:oa(function(){return[0];}),last:oa(function(a,b){return[b-1];}),eq:oa(function(a,b,c){return[0>c?c+b:c];}),even:oa(function(a,b){for(var c=0;b>c;c+=2){a.push(c);}return a;}),odd:oa(function(a,b){for(var c=1;b>c;c+=2){a.push(c);}return a;}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;){a.push(d);}return a;}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;){a.push(d);}return a;})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){d.pseudos[b]=ma(b);}for(b in{submit:!0,reset:!0}){d.pseudos[b]=na(b);}function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa(),g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter){!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));}if(!c)break;}return b?h.length:h?ga.error(a):z(a,i).slice(0);};function ra(a){for(var b=0,c=a.length,d="";c>b;b++){d+=a[b].value;}return d;}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d]){if(1===b.nodeType||e)return a(b,c,f);}}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d]){if((1===b.nodeType||e)&&a(b,c,g))return!0;}}else while(b=b[d]){if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0;}}};}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--){if(!a[e](b,c,d))return!1;}return!0;}:a[0];}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++){ga(a,b[d],c);}return c;}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++){(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));}return g;}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--){(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));}}if(f){if(e||a){if(e){j=[],k=r.length;while(k--){(l=r[k])&&j.push(q[k]=l);}e(null,r=[],j,i);}k=r.length;while(k--){(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l));}}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r);});}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b;},h,!0),l=sa(function(a){return J(b,a)>-1;},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e;}];f>i;i++){if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++){if(d.relative[a[e].type])break;}return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a));}m.push(c);}}return ta(m);}function ya(a,b){var c=b.length>0,e=a.length>0,f=function f(_f,g,h,i,k){var l,m,o,p=0,q="0",r=_f&&[],s=[],t=j,u=_f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++]){if(o(l,g,h)){i.push(l);break;}}k&&(w=v);}c&&((l=!o&&l)&&p--,_f&&r.push(l));}if(p+=q,c&&q!==p){m=0;while(o=b[m++]){o(r,s,g,h);}if(_f){if(p>0)while(q--){r[q]||s[q]||(s[q]=F.call(i));}s=va(s);}H.apply(i,s),k&&!_f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i);}return k&&(w=v,j=t),r;};return c?ia(f):f;}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--){f=xa(b[c]),f[u]?d.push(f):e.push(f);}f=A(a,ya(e,d)),f.selector=a;}return f;},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length);}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break;}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e;},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"));}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href");})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2);}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value");})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue;}),ja(function(a){return null==a.getAttribute("disabled");})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null;}),ga;}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c;});if(b.nodeType)return n.grep(a,function(a){return a===b!==c;});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a);}return n.grep(a,function(a){return g.call(b,a)>=0!==c;});}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType;}));},n.fn.extend({find:function find(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++){if(n.contains(e[b],this))return!0;}}));for(b=0;c>b;b++){n.find(a,e[b],d);}return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d;},filter:function filter(a){return this.pushStack(x(this,a||[],!1));},not:function not(a){return this.pushStack(x(this,a||[],!0));},is:function is(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length;}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b){n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);}return this;}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this;}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this));};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function dir(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType){if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a);}}return d;},sibling:function sibling(a,b){for(var c=[];a;a=a.nextSibling){1===a.nodeType&&a!==b&&c.push(a);}return c;}}),n.fn.extend({has:function has(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++){if(n.contains(this,b[a]))return!0;}});},closest:function closest(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++){for(c=this[d];c&&c!==b;c=c.parentNode){if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break;}}}return this.pushStack(f.length>1?n.unique(f):f);},index:function index(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1;},add:function add(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))));},addBack:function addBack(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a));}});function D(a,b){while((a=a[b])&&1!==a.nodeType){}return a;}n.each({parent:function parent(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null;},parents:function parents(a){return n.dir(a,"parentNode");},parentsUntil:function parentsUntil(a,b,c){return n.dir(a,"parentNode",c);},next:function next(a){return D(a,"nextSibling");},prev:function prev(a){return D(a,"previousSibling");},nextAll:function nextAll(a){return n.dir(a,"nextSibling");},prevAll:function prevAll(a){return n.dir(a,"previousSibling");},nextUntil:function nextUntil(a,b,c){return n.dir(a,"nextSibling",c);},prevUntil:function prevUntil(a,b,c){return n.dir(a,"previousSibling",c);},siblings:function siblings(a){return n.sibling((a.parentNode||{}).firstChild,a);},children:function children(a){return n.sibling(a.firstChild);},contents:function contents(a){return a.contentDocument||n.merge([],a.childNodes);}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e);};});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0;}),b;}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function j(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++){if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break;}}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable());},k={add:function add(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c);});}(arguments),d?f=h.length:b&&(e=c,j(b));}return this;},remove:function remove(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1){h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--);}}),this;},has:function has(a){return a?n.inArray(a,h)>-1:!(!h||!h.length);},empty:function empty(){return h=[],f=0,this;},disable:function disable(){return h=i=b=void 0,this;},disabled:function disabled(){return!h;},lock:function lock(){return i=void 0,b||k.disable(),this;},locked:function locked(){return!i;},fireWith:function fireWith(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this;},fire:function fire(){return k.fireWith(this,arguments),this;},fired:function fired(){return!!c;}};return k;},n.extend({Deferred:function Deferred(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function state(){return c;},always:function always(){return e.done(arguments).fail(arguments),this;},then:function then(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments);});}),a=null;}).promise();},promise:function promise(a){return null!=a?n.extend(a,d):d;}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h;},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this;},e[f[0]+"With"]=g.fireWith;}),d.promise(e),a&&a.call(e,e),e;},when:function when(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function h(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c);};},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++){c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;}return f||g.resolveWith(k,c),g.promise();}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this;},n.extend({isReady:!1,readyWait:1,holdReady:function holdReady(a){a?n.readyWait++:n.ready(!0);},ready:function ready(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))));}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready();}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b);},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c){n.access(a,b,h,c[h],!0,f,g);}}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function b(a,_b,c){return j.call(n(a),c);})),b))for(;i>h;h++){b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));}return e?a:j?b.call(a):i?b(a[0],c):f;};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType;};function K(){Object.defineProperty(this.cache={},0,{get:function get(){return{};}}),this.expando=n.expando+K.uid++;}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function key(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b);}catch(d){b[this.expando]=c,n.extend(a,b);}}return this.cache[c]||(this.cache[c]={}),c;},set:function set(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b){f[d]=b[d];}return f;},get:function get(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b];},access:function access(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b);},remove:function remove(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--){delete g[d[c]];}}},hasData:function hasData(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{});},discard:function discard(a){a[this.expando]&&delete this.cache[a[this.expando]];}};var L=new K(),M=new K(),N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c;}catch(e){}M.set(a,b,c);}else c=void 0;return c;}n.extend({hasData:function hasData(a){return M.hasData(a)||L.hasData(a);},data:function data(a,b,c){return M.access(a,b,c);},removeData:function removeData(a,b){M.remove(a,b);},_data:function _data(a,b,c){return L.access(a,b,c);},_removeData:function _removeData(a,b){L.remove(a,b);}}),n.fn.extend({data:function data(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--){g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));}L.set(f,"hasDataAttrs",!0);}return e;}return"object"==(typeof a==="undefined"?"undefined":_typeof(a))?this.each(function(){M.set(this,a);}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c;}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b);});},null,b,arguments.length>1,null,!0);},removeData:function removeData(a){return this.each(function(){M.remove(this,a);});}}),n.extend({queue:function queue(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0;},dequeue:function dequeue(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function g(){n.dequeue(a,b);};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire();},_queueHooks:function _queueHooks(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c]);})});}}),n.fn.extend({queue:function queue(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a);});},dequeue:function dequeue(a){return this.each(function(){n.dequeue(this,a);});},clearQueue:function clearQueue(a){return this.queue(a||"fx",[]);},promise:function promise(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function h(){--d||e.resolveWith(f,[f]);};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--){c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));}return h(),e.promise(b);}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function S(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a);},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue;}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0;}function $(){return!1;}function _(){try{return l.activeElement;}catch(a){}}n.event={global:{},add:function add(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return(typeof n==="undefined"?"undefined":_typeof(n))!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0;}),b=(b||"").match(E)||[""],j=b.length;while(j--){h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0);}}},remove:function remove(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--){if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--){k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));}g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o]);}else for(o in i){n.event.remove(a,o+b[j],c,d,!0);}}n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"));}},trigger:function trigger(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==(typeof b==="undefined"?"undefined":_typeof(b))&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode){p.push(g),h=g;}h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a);}f=0;while((g=p[f++])&&!b.isPropagationStopped()){b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());}return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result;}},dispatch:function dispatch(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped()){(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()));}}return k.postDispatch&&k.postDispatch.call(this,a),a.result;}},handlers:function handlers(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this){if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++){f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);}d.length&&g.push({elem:i,handlers:d});}}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function filter(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a;}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function filter(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a;}},fix:function fix(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--){c=d[b],a[c]=f[c];}return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a;},special:{load:{noBubble:!0},focus:{trigger:function trigger(){return this!==_()&&this.focus?(this.focus(),!1):void 0;},delegateType:"focusin"},blur:{trigger:function trigger(){return this===_()&&this.blur?(this.blur(),!1):void 0;},delegateType:"focusout"},click:{trigger:function trigger(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0;},_default:function _default(a){return n.nodeName(a.target,"a");}},beforeunload:{postDispatch:function postDispatch(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result);}}},simulate:function simulate(a,b,c,d){var e=n.extend(new n.Event(),c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault();}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1);},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b);},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function preventDefault(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault();},stopPropagation:function stopPropagation(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation();},stopImmediatePropagation:function stopImmediatePropagation(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation();}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function handle(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c;}};}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function c(a){n.event.simulate(b,a.target,n.event.fix(a),!0);};n.event.special[b]={setup:function setup(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1);},teardown:function teardown(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b));}};}),n.fn.extend({on:function on(a,b,c,d,e){var f,g;if("object"==(typeof a==="undefined"?"undefined":_typeof(a))){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a){this.on(g,b,c,a[g],e);}return this;}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function d(a){return n().off(a),f.apply(this,arguments);},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b);});},one:function one(a,b,c,d){return this.on(a,b,c,d,1);},off:function off(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==(typeof a==="undefined"?"undefined":_typeof(a))){for(e in a){this.off(e,b,a[e]);}return this;}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b);});},trigger:function trigger(a,b){return this.each(function(){n.event.trigger(a,b,this);});},triggerHandler:function triggerHandler(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0;}});var aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ba=/<([\w:]+)/,ca=/<|&#?\w+;/,da=/<(?:script|style|link)/i,ea=/checked\s*(?:[^=]|=\s*.checked.)/i,fa=/^$|\/(?:java|ecma)script/i,ga=/^true\/(.*)/,ha=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ia={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option,ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead,ia.th=ia.td;function ja(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a;}function ka(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a;}function la(a){var b=ga.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a;}function ma(a,b){for(var c=0,d=a.length;d>c;c++){L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"));}}function na(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j){for(c=0,d=j[e].length;d>c;c++){n.event.add(b,e,j[e][c]);}}}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i));}}function oa(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c;}function pa(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue);}n.extend({clone:function clone(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=oa(h),f=oa(a),d=0,e=f.length;e>d;d++){pa(f[d],g[d]);}if(b)if(c)for(f=f||oa(a),g=g||oa(h),d=0,e=f.length;e>d;d++){na(f[d],g[d]);}else na(a,h);return g=oa(h,"script"),g.length>0&&ma(g,!i&&oa(a,"script")),h;},buildFragment:function buildFragment(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++){if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(ca.test(e)){f=f||k.appendChild(b.createElement("div")),g=(ba.exec(e)||["",""])[1].toLowerCase(),h=ia[g]||ia._default,f.innerHTML=h[1]+e.replace(aa,"<$1></$2>")+h[2],j=h[0];while(j--){f=f.lastChild;}n.merge(l,f.childNodes),f=k.firstChild,f.textContent="";}else l.push(b.createTextNode(e));}k.textContent="",m=0;while(e=l[m++]){if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=oa(k.appendChild(e),"script"),i&&ma(f),c)){j=0;while(e=f[j++]){fa.test(e.type||"")&&c.push(e);}}}return k;},cleanData:function cleanData(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events){f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);}L.cache[e]&&delete L.cache[e];}delete M.cache[c[M.expando]];}}}),n.fn.extend({text:function text(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a);});},null,a,arguments.length);},append:function append(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.appendChild(a);}});},prepend:function prepend(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.insertBefore(a,b.firstChild);}});},before:function before(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this);});},after:function after(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling);});},remove:function remove(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++){b||1!==c.nodeType||n.cleanData(oa(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&ma(oa(c,"script")),c.parentNode.removeChild(c));}return this;},empty:function empty(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&(n.cleanData(oa(a,!1)),a.textContent="");}return this;},clone:function clone(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b);});},html:function html(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!da.test(a)&&!ia[(ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(aa,"<$1></$2>");try{for(;d>c;c++){b=this[c]||{},1===b.nodeType&&(n.cleanData(oa(b,!1)),b.innerHTML=a);}b=0;}catch(e){}}b&&this.empty().append(a);},null,a,arguments.length);},replaceWith:function replaceWith(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(oa(this)),a&&a.replaceChild(b,this);}),a&&(a.length||a.nodeType)?this:this.remove();},detach:function detach(a){return this.remove(a,!0);},domManip:function domManip(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&ea.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b);});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(oa(c,"script"),ka),g=f.length;l>j;j++){h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,oa(h,"script"))),b.call(this[j],h,j);}if(g)for(i=f[f.length-1].ownerDocument,n.map(f,la),j=0;g>j;j++){h=f[j],fa.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(ha,"")));}}return this;}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++){c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());}return this.pushStack(d);};});var qa,ra={};function sa(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f;}function ta(a){var b=l,c=ra[a];return c||(c=sa(a,b),"none"!==c&&c||(qa=(qa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qa[0].contentDocument,b.write(),b.close(),c=sa(a,b),qa.detach()),ra[a]=c),c;}var ua=/^margin/,va=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wa=function wa(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null);};function xa(a,b,c){var d,e,f,g,h=a.style;return c=c||wa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),va.test(g)&&ua.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g;}function ya(a,b){return{get:function get(){return a()?void delete this.get:(this.get=b).apply(this,arguments);}};}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){(function(){var g=function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e);};f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);a.getComputedStyle&&n.extend(k,{pixelPosition:function pixelPosition(){return g(),b;},boxSizingReliable:function boxSizingReliable(){return null==c&&g(),c;},reliableMarginRight:function reliableMarginRight(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b;}});})();}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b){g[f]=a.style[f],a.style[f]=b[f];}e=c.apply(a,d||[]);for(f in b){a.style[f]=g[f];}return e;};var za=/^(none|table(?!-c[ea]).+)/,Aa=new RegExp("^("+Q+")(.*)$","i"),Ba=new RegExp("^([+-])=("+Q+")","i"),Ca={position:"absolute",visibility:"hidden",display:"block"},Da={letterSpacing:"0",fontWeight:"400"},Ea=["Webkit","O","Moz","ms"];function Fa(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Ea.length;while(e--){if(b=Ea[e]+c,b in a)return b;}return d;}function Ga(a,b,c){var d=Aa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b;}function Ha(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2){"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));}return g;}function Ia(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wa(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xa(a,b,f),(0>e||null==e)&&(e=a.style[b]),va.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0;}return e+Ha(a,b,c||(g?"border":"content"),d,f)+"px";}function Ja(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++){d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",ta(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));}for(g=0;h>g;g++){d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));}return a;}n.extend({cssHooks:{opacity:{get:function get(a,b){if(b){var c=xa(a,"opacity");return""===c?"1":c;}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function style(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fa(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c==="undefined"?"undefined":_typeof(c),"string"===f&&(e=Ba.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0);}},css:function css(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fa(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xa(a,b,d)),"normal"===e&&b in Da&&(e=Da[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e;}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function get(a,c,d){return c?za.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Ca,function(){return Ia(a,b,d);}):Ia(a,b,d):void 0;},set:function set(a,c,d){var e=d&&wa(a);return Ga(a,c,d?Ha(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0);}};}),n.cssHooks.marginRight=ya(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xa,[a,"marginRight"]):void 0;}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function expand(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++){e[a+R[d]+b]=f[d]||f[d-2]||f[0];}return e;}},ua.test(a)||(n.cssHooks[a+b].set=Ga);}),n.fn.extend({css:function css(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wa(a),e=b.length;e>g;g++){f[b[g]]=n.css(a,b[g],!1,d);}return f;}return void 0!==c?n.style(a,b,c):n.css(a,b);},a,b,arguments.length>1);},show:function show(){return Ja(this,!0);},hide:function hide(){return Ja(this);},toggle:function toggle(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide();});}});function Ka(a,b,c,d,e){return new Ka.prototype.init(a,b,c,d,e);}n.Tween=Ka,Ka.prototype={constructor:Ka,init:function init(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px");},cur:function cur(){var a=Ka.propHooks[this.prop];return a&&a.get?a.get(this):Ka.propHooks._default.get(this);},run:function run(a){var b,c=Ka.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ka.propHooks._default.set(this),this;}},Ka.prototype.init.prototype=Ka.prototype,Ka.propHooks={_default:{get:function get(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop];},set:function set(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now;}}},Ka.propHooks.scrollTop=Ka.propHooks.scrollLeft={set:function set(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now);}},n.easing={linear:function linear(a){return a;},swing:function swing(a){return.5-Math.cos(a*Math.PI)/2;}},n.fx=Ka.prototype.init,n.fx.step={};var La,Ma,Na=/^(?:toggle|show|hide)$/,Oa=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pa=/queueHooks$/,Qa=[Va],Ra={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Oa.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Oa.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do{h=h||".5",g/=h,n.style(c.elem,a,g+f);}while(h!==(h=c.cur()/d)&&1!==h&&--i);}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c;}]};function Sa(){return setTimeout(function(){La=void 0;}),La=n.now();}function Ta(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b){c=R[d],e["margin"+c]=e["padding"+c]=a;}return b&&(e.opacity=e.width=a),e;}function Ua(a,b,c){for(var d,e=(Ra[b]||[]).concat(Ra["*"]),f=0,g=e.length;g>f;f++){if(d=e[f].call(c,b,a))return d;}}function Va(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i();}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire();});})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||ta(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2];}));for(d in b){if(e=b[d],Na.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0;}m[d]=q&&q[d]||n.style(a,d);}else j=void 0;}if(n.isEmptyObject(m))"inline"===("none"===j?ta(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide();}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m){n.style(a,b,m[b]);}});for(d in m){g=Ua(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0));}}}function Wa(a,b){var c,d,e,f,g;for(c in a){if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f){c in a||(a[c]=f[c],b[c]=e);}}else b[d]=e;}}function Xa(a,b,c){var d,e,f=0,g=Qa.length,h=n.Deferred().always(function(){delete i.elem;}),i=function i(){if(e)return!1;for(var b=La||Sa(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++){j.tweens[g].run(f);}return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1);},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:La||Sa(),duration:c.duration,tweens:[],createTween:function createTween(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d;},stop:function stop(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++){j.tweens[c].run(1);}return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this;}}),k=j.props;for(Wa(k,j.opts.specialEasing);g>f;f++){if(d=Qa[f].call(j,a,k,j.opts))return d;}return n.map(k,Ua,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always);}n.Animation=n.extend(Xa,{tweener:function tweener(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++){c=a[d],Ra[c]=Ra[c]||[],Ra[c].unshift(b);}},prefilter:function prefilter(a,b){b?Qa.unshift(a):Qa.push(a);}}),n.speed=function(a,b,c){var d=a&&"object"==(typeof a==="undefined"?"undefined":_typeof(a))?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue);},d;},n.fn.extend({fadeTo:function fadeTo(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d);},animate:function animate(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function g(){var b=Xa(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0);};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g);},stop:function stop(a,b,c){var d=function d(a){var b=a.stop;delete a.stop,b(c);};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g){g[e]&&g[e].stop&&Pa.test(e)&&d(g[e]);}for(e=f.length;e--;){f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));}(b||!c)&&n.dequeue(this,a);});},finish:function finish(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;){f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));}for(b=0;g>b;b++){d[b]&&d[b].finish&&d[b].finish.call(this);}delete c.finish;});}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Ta(b,!0),a,d,e);};}),n.each({slideDown:Ta("show"),slideUp:Ta("hide"),slideToggle:Ta("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d);};}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(La=n.now();b<c.length;b++){a=c[b],a()||c[b]!==a||c.splice(b--,1);}c.length||n.fx.stop(),La=void 0;},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop();},n.fx.interval=13,n.fx.start=function(){Ma||(Ma=setInterval(n.fx.tick,n.fx.interval));},n.fx.stop=function(){clearInterval(Ma),Ma=null;},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d);};});},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value;}();var Ya,Za,$a=n.expr.attrHandle;n.fn.extend({attr:function attr(a,b){return J(this,n.attr,a,b,arguments.length>1);},removeAttr:function removeAttr(a){return this.each(function(){n.removeAttr(this,a);});}}),n.extend({attr:function attr(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return _typeof(a.getAttribute)===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Za:Ya)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b));},removeAttr:function removeAttr(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++]){d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c);}},attrHooks:{type:{set:function set(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b;}}}}}),Za={set:function set(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c;}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$a[b]||n.find.attr;$a[b]=function(a,b,d){var e,f;return d||(f=$a[b],$a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$a[b]=f),e;};});var _a=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function prop(a,b){return J(this,n.prop,a,b,arguments.length>1);},removeProp:function removeProp(a){return this.each(function(){delete this[n.propFix[a]||a];});}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function prop(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b];},propHooks:{tabIndex:{get:function get(a){return a.hasAttribute("tabindex")||_a.test(a.nodeName)||a.href?a.tabIndex:-1;}}}}),k.optSelected||(n.propHooks.selected={get:function get(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null;}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this;});var ab=/[\t\r\n\f]/g;n.fn.extend({addClass:function addClass(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className));});if(h)for(b=(a||"").match(E)||[];j>i;i++){if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):" ")){f=0;while(e=b[f++]){d.indexOf(" "+e+" ")<0&&(d+=e+" ");}g=n.trim(d),c.className!==g&&(c.className=g);}}return this;},removeClass:function removeClass(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className));});if(h)for(b=(a||"").match(E)||[];j>i;i++){if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):"")){f=0;while(e=b[f++]){while(d.indexOf(" "+e+" ")>=0){d=d.replace(" "+e+" "," ");}}g=a?n.trim(d):"",c.className!==g&&(c.className=g);}}return this;},toggleClass:function toggleClass(a,b){var c=typeof a==="undefined"?"undefined":_typeof(a);return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b);}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++]){e.hasClass(b)?e.removeClass(b):e.addClass(b);}}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"");});},hasClass:function hasClass(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++){if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ab," ").indexOf(b)>=0)return!0;}return!1;}});var bb=/\r/g;n.fn.extend({val:function val(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+"";})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e));});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bb,""):null==c?"":c);}}}),n.extend({valHooks:{option:{get:function get(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a));}},select:{get:function get(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++){if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b);}}return g;},set:function set(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--){d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);}return c||(a.selectedIndex=-1),f;}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function set(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0;}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value;});}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b);};}),n.fn.extend({hover:function hover(a,b){return this.mouseenter(a).mouseleave(b||a);},bind:function bind(a,b,c){return this.on(a,null,b,c);},unbind:function unbind(a,b){return this.off(a,null,b);},delegate:function delegate(a,b,c,d){return this.on(b,a,c,d);},undelegate:function undelegate(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c);}});var cb=n.now(),db=/\?/;n.parseJSON=function(a){return JSON.parse(a+"");},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser(),b=c.parseFromString(a,"text/xml");}catch(d){b=void 0;}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b;};var eb=/#.*$/,fb=/([?&])_=[^&]*/,gb=/^(.*?):[ \t]*([^\r\n]*)$/gm,hb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ib=/^(?:GET|HEAD)$/,jb=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lb={},mb={},nb="*/".concat("*"),ob=a.location.href,pb=kb.exec(ob.toLowerCase())||[];function qb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++]){"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c);}};}function rb(a,b,c,d){var e={},f=a===mb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1);}),i;}return g(b.dataTypes[0])||!e["*"]&&g("*");}function sb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b){void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);}return d&&n.extend(!0,a,d),a;}function tb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0]){i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));}if(d)for(e in h){if(h[e]&&h[e].test(d)){i.unshift(e);break;}}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break;}g||(g=e);}f=f||g;}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0;}function ub(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters){j[g.toLowerCase()]=a.converters[g];}f=k.shift();while(f){if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j){if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break;}}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b);}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f};}}}return{state:"success",data:b};}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ob,type:"GET",isLocal:hb.test(pb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function ajaxSetup(a,b){return b?sb(sb(a,n.ajaxSettings),b):sb(n.ajaxSettings,a);},ajaxPrefilter:qb(lb),ajaxTransport:qb(mb),ajax:function ajax(a,b){"object"==(typeof a==="undefined"?"undefined":_typeof(a))&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function getResponseHeader(a){var b;if(2===t){if(!f){f={};while(b=gb.exec(e)){f[b[1].toLowerCase()]=b[2];}}b=f[a.toLowerCase()];}return null==b?null:b;},getAllResponseHeaders:function getAllResponseHeaders(){return 2===t?e:null;},setRequestHeader:function setRequestHeader(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this;},overrideMimeType:function overrideMimeType(a){return t||(k.mimeType=a),this;},statusCode:function statusCode(a){var b;if(a)if(2>t)for(b in a){q[b]=[q[b],a[b]];}else v.always(a[v.status]);return this;},abort:function abort(a){var b=a||u;return c&&c.abort(b),x(0,b),this;}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||ob)+"").replace(eb,"").replace(jb,pb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kb.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pb[1]&&h[2]===pb[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pb[3]||("http:"===pb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rb(lb,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ib.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(db.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fb.test(d)?d.replace(fb,"$1_="+cb++):d+(db.test(d)?"&":"?")+"_="+cb++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nb+"; q=0.01":""):k.accepts["*"]);for(j in k.headers){v.setRequestHeader(j,k.headers[j]);}if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1}){v[j](k[j]);}if(c=rb(mb,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout");},k.timeout));try{t=1,c.send(r,x);}catch(w){if(!(2>t))throw w;x(-1,w);}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tb(k,v,f)),u=ub(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")));}return v;},getJSON:function getJSON(a,b,c){return n.get(a,b,c,"json");},getScript:function getScript(a,b){return n.get(a,void 0,b,"script");}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d});};}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0});},n.fn.extend({wrapAll:function wrapAll(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b));}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild){a=a.firstElementChild;}return a;}).append(this)),this);},wrapInner:function wrapInner(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b));}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a);});},wrap:function wrap(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a);});},unwrap:function unwrap(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes);}).end();}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0;},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a);};var vb=/%20/g,wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==(typeof e==="undefined"?"undefined":_typeof(e))?b:"")+"]",e,c,d);});else if(c||"object"!==n.type(b))d(a,b);else for(e in b){Ab(a+"["+e+"]",b[e],c,d);}}n.param=function(a,b){var c,d=[],e=function e(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b);};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value);});else for(c in a){Ab(c,a[c],b,e);}return d.join("&").replace(vb,"+");},n.fn.extend({serialize:function serialize(){return n.param(this.serializeArray());},serializeArray:function serializeArray(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this;}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!T.test(a));}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")};}):{name:b.name,value:c.replace(xb,"\r\n")};}).get();}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest();}catch(a){}};var Bb=0,Cb={},Db={0:200,1223:204},Eb=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cb){Cb[a]();}}),k.cors=!!Eb&&"withCredentials"in Eb,k.ajax=Eb=!!Eb,n.ajaxTransport(function(a){var _b2;return k.cors||Eb&&!a.crossDomain?{send:function send(c,d){var e,f=a.xhr(),g=++Bb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields){f[e]=a.xhrFields[e];}a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c){f.setRequestHeader(e,c[e]);}_b2=function b(a){return function(){_b2&&(delete Cb[g],_b2=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Db[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()));};},f.onload=_b2(),f.onerror=_b2("error"),_b2=Cb[g]=_b2("abort");try{f.send(a.hasContent&&a.data||null);}catch(h){if(_b2)throw h;}},abort:function abort(){_b2&&_b2();}}:void 0;}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function textScript(a){return n.globalEval(a),a;}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET");}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,_c;return{send:function send(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",_c=function c(a){b.remove(),_c=null,a&&e("error"===a.type?404:200,a.type);}),l.head.appendChild(b[0]);},abort:function abort(){_c&&_c();}};}});var Fb=[],Gb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function jsonpCallback(){var a=Fb.pop()||n.expando+"_"+cb++;return this[a]=!0,a;}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gb,"$1"+e):b.jsonp!==!1&&(b.url+=(db.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0];},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments;},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0;}),"script"):void 0;}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes));};var Hb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hb)return Hb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==(typeof b==="undefined"?"undefined":_typeof(b))&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a);}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a]);}),this;},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a);};}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem;}).length;};var Ib=a.document.documentElement;function Jb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView;}n.offset={setOffset:function setOffset(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m);}},n.fn.extend({offset:function offset(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b);});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(_typeof(d.getBoundingClientRect)!==U&&(e=d.getBoundingClientRect()),c=Jb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e;},position:function position(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)};}},offsetParent:function offsetParent(){return this.map(function(){var a=this.offsetParent||Ib;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position")){a=a.offsetParent;}return a||Ib;});}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jb(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f);},b,e,arguments.length,null);};}),n.each(["top","left"],function(a,b){n.cssHooks[b]=ya(k.pixelPosition,function(a,c){return c?(c=xa(a,b),va.test(c)?n(a).position()[b]+"px":c):void 0;});}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g);},b,f?d:void 0,f,null);};});}),n.fn.size=function(){return this.length;},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n;});var Kb=a.jQuery,Lb=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lb),b&&a.jQuery===n&&(a.jQuery=Kb),n;},(typeof b==="undefined"?"undefined":_typeof(b))===U&&(a.jQuery=a.$=n),n;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher");}(jQuery);+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in n){if(i.style[t]!==undefined)return{end:n[t]};}return!1;}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one("bsTransitionEnd",function(){i=!0;});return r=function r(){i||n(u).trigger(n.support.transition.end);},setTimeout(r,t),this;};n(function(){(n.support.transition=t(),n.support.transition)&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function handle(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments);}});});}(jQuery);+function(n){"use strict";function u(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this));typeof i=="string"&&u[i].call(r);});}var i='[data-dismiss="alert"]',t=function t(_t){n(_t).on("click",i,this.close);},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.close=function(i){function e(){r.detach().trigger("closed.bs.alert").remove();}var f=n(this),u=f.attr("data-target"),r;(u||(u=f.attr("href"),u=u&&u.replace(/.*(?=#[^\s]*$)/,"")),r=n(u),i&&i.preventDefault(),r.length||(r=f.closest(".alert")),r.trigger(i=n.Event("close.bs.alert")),i.isDefaultPrevented())||(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e());};r=n.fn.alert;n.fn.alert=u;n.fn.alert.Constructor=t;n.fn.alert.noConflict=function(){return n.fn.alert=r,this;};n(document).on("click.bs.alert.data-api",i,t.prototype.close);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.button",r=new t(this,f));i=="toggle"?r.toggle():i&&r.setState(i);});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.isLoading=!1;},r;t.VERSION="3.3.5";t.DEFAULTS={loadingText:"loading..."};t.prototype.setState=function(t){var r="disabled",i=this.$element,f=i.is("input")?"val":"html",u=i.data();t+="Text";u.resetText==null&&i.data("resetText",i[f]());setTimeout(n.proxy(function(){i[f](u[t]==null?this.options[t]:u[t]);t=="loadingText"?(this.isLoading=!0,i.addClass(r).attr(r,r)):this.isLoading&&(this.isLoading=!1,i.removeClass(r).removeAttr(r));},this),0);};t.prototype.toggle=function(){var t=!0,i=this.$element.closest('[data-toggle="buttons"]'),n;i.length?(n=this.$element.find("input"),n.prop("type")=="radio"?(n.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):n.prop("type")=="checkbox"&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"));};r=n.fn.button;n.fn.button=i;n.fn.button.Constructor=t;n.fn.button.noConflict=function(){return n.fn.button=r,this;};n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn"));i.call(r,"toggle");n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault();}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type));});}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i),e=typeof i=="string"?i:f.slide;r||u.data("bs.carousel",r=new t(this,f));typeof i=="number"?r.to(i):e?r[e]():f.interval&&r.pause().cycle();});}var t=function t(_t2,i){this.$element=n(_t2);this.$indicators=this.$element.find(".carousel-indicators");this.options=i;this.paused=null;this.sliding=null;this.interval=null;this.$active=null;this.$items=null;this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this));this.options.pause!="hover"||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this));},u,r;t.VERSION="3.3.5";t.TRANSITION_DURATION=600;t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0};t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return;}n.preventDefault();}};t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this;};t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active);};t.prototype.getItemForDirection=function(n,t){var i=this.getItemIndex(t),f=n=="prev"&&i===0||n=="next"&&i==this.$items.length-1,r,u;return f&&!this.options.wrap?t:(r=n=="prev"?-1:1,u=(i+r)%this.$items.length,this.$items.eq(u));};t.prototype.to=function(n){var i=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(n>this.$items.length-1)&&!(n<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(n);}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n));};t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this;};t.prototype.next=function(){if(!this.sliding)return this.slide("next");};t.prototype.prev=function(){if(!this.sliding)return this.slide("prev");};t.prototype.slide=function(i,r){var e=this.$element.find(".item.active"),u=r||this.getItemForDirection(i,e),l=this.interval,f=i=="next"?"left":"right",a=this,o,s,h,c;return u.hasClass("active")?this.sliding=!1:(o=u[0],s=n.Event("slide.bs.carousel",{relatedTarget:o,direction:f}),this.$element.trigger(s),s.isDefaultPrevented())?void 0:(this.sliding=!0,l&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),h=n(this.$indicators.children()[this.getItemIndex(u)]),h&&h.addClass("active")),c=n.Event("slid.bs.carousel",{relatedTarget:o,direction:f}),n.support.transition&&this.$element.hasClass("slide")?(u.addClass(i),u[0].offsetWidth,e.addClass(f),u.addClass(f),e.one("bsTransitionEnd",function(){u.removeClass([i,f].join(" ")).addClass("active");e.removeClass(["active",f].join(" "));a.sliding=!1;setTimeout(function(){a.$element.trigger(c);},0);}).emulateTransitionEnd(t.TRANSITION_DURATION)):(e.removeClass("active"),u.addClass("active"),this.sliding=!1,this.$element.trigger(c)),l&&this.cycle(),this);};u=n.fn.carousel;n.fn.carousel=i;n.fn.carousel.Constructor=t;n.fn.carousel.noConflict=function(){return n.fn.carousel=u,this;};r=function r(t){var o,r=n(this),u=n(r.attr("data-target")||(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")),e,f;u.hasClass("carousel")&&(e=n.extend({},u.data(),r.data()),f=r.attr("data-slide-to"),f&&(e.interval=!1),i.call(u,e),f&&u.data("bs.carousel").to(f),t.preventDefault());};n(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r);n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(t){var i,r=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return n(r);}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.collapse"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);!r&&f.toggle&&/show|hide/.test(i)&&(f.toggle=!1);r||u.data("bs.collapse",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.$trigger=n('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]');this.transitioning=null;this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger);this.options.toggle&&this.toggle();},u;t.VERSION="3.3.5";t.TRANSITION_DURATION=350;t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height";};t.prototype.show=function(){var f,r,e,u,o,s;if(!this.transitioning&&!this.$element.hasClass("in")&&(r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),!r||!r.length||(f=r.data("bs.collapse"),!f||!f.transitioning))&&(e=n.Event("show.bs.collapse"),this.$element.trigger(e),!e.isDefaultPrevented())){if(r&&r.length&&(i.call(r,"hide"),f||r.data("bs.collapse",null)),u=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[u](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,o=function o(){this.$element.removeClass("collapsing").addClass("collapse in")[u]("");this.transitioning=0;this.$element.trigger("shown.bs.collapse");},!n.support.transition)return o.call(this);s=n.camelCase(["scroll",u].join("-"));this.$element.one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[u](this.$element[0][s]);}};t.prototype.hide=function(){var r,i,u;if(!this.transitioning&&this.$element.hasClass("in")&&(r=n.Event("hide.bs.collapse"),this.$element.trigger(r),!r.isDefaultPrevented())){if(i=this.dimension(),this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,u=function u(){this.transitioning=0;this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse");},!n.support.transition)return u.call(this);this.$element[i](0).one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION);}};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]();};t.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,i){var u=n(i);this.addAriaAndCollapsedClass(r(u),u);},this)).end();};t.prototype.addAriaAndCollapsedClass=function(n,t){var i=n.hasClass("in");n.attr("aria-expanded",i);t.toggleClass("collapsed",!i).attr("aria-expanded",i);};u=n.fn.collapse;n.fn.collapse=i;n.fn.collapse.Constructor=t;n.fn.collapse.noConflict=function(){return n.fn.collapse=u,this;};n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var u=n(this);u.attr("data-target")||t.preventDefault();var f=r(u),e=f.data("bs.collapse"),o=e?"toggle":u.data();i.call(f,o);});}(jQuery);+function(n){"use strict";function r(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent();}function u(t){t&&t.which===3||(n(e).remove(),n(i).each(function(){var u=n(this),i=r(u),f={relatedTarget:this};i.hasClass("open")&&(t&&t.type=="click"&&/input|textarea/i.test(t.target.tagName)&&n.contains(i[0],t.target)||(i.trigger(t=n.Event("hide.bs.dropdown",f)),t.isDefaultPrevented())||(u.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",f)));}));}function o(i){return this.each(function(){var r=n(this),u=r.data("bs.dropdown");u||r.data("bs.dropdown",u=new t(this));typeof i=="string"&&u[i].call(r);});}var e=".dropdown-backdrop",i='[data-toggle="dropdown"]',t=function t(_t3){n(_t3).on("click.bs.dropdown",this.toggle);},f;t.VERSION="3.3.5";t.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=r(f),o=i.hasClass("open"),u(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",u);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true");i.toggleClass("open").trigger("shown.bs.dropdown",e);}return!1;}};t.prototype.keydown=function(t){var e,o,s,h,f,u;if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=r(e),s=o.hasClass("open"),!s&&t.which!=27||s&&t.which==27)return t.which==27&&o.find(i).trigger("focus"),e.trigger("click");(h=" li:not(.disabled):visible a",f=o.find(".dropdown-menu"+h),f.length)&&(u=f.index(t.target),t.which==38&&u>0&&u--,t.which==40&&u<f.length-1&&u++,~u||(u=0),f.eq(u).trigger("focus"));}};f=n.fn.dropdown;n.fn.dropdown=o;n.fn.dropdown.Constructor=t;n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this;};n(document).on("click.bs.dropdown.data-api",u).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation();}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown);}(jQuery);+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);u||f.data("bs.modal",u=new t(this,e));typeof i=="string"?u[i](r):e.show&&u.show(r);});}var t=function t(_t4,i){this.options=i;this.$body=n(document.body);this.$element=n(_t4);this.$dialog=this.$element.find(".modal-dialog");this.$backdrop=null;this.isShown=null;this.originalBodyPad=null;this.scrollbarWidth=0;this.ignoreBackdropClick=!1;this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal");},this));},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=300;t.BACKDROP_TRANSITION_DURATION=150;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n);};t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});if(this.$element.trigger(u),!this.isShown&&!u.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.setScrollbar();this.$body.addClass("modal-open");this.escape();this.resize();this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0);});});this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body);r.$element.show().scrollTop(0);r.adjustDialog();f&&r.$element[0].offsetWidth;r.$element.addClass("in");r.enforceFocus();u=n.Event("shown.bs.modal",{relatedTarget:i});f?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u);}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u);});}};t.prototype.hide=function(i){(i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal());};t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus");},this));};t.prototype.escape=function(){if(this.isShown&&this.options.keyboard)this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){n.which==27&&this.hide();},this));else this.isShown||this.$element.off("keydown.dismiss.bs.modal");};t.prototype.resize=function(){if(this.isShown)n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this));else n(window).off("resize.bs.modal");};t.prototype.hideModal=function(){var n=this;this.$element.hide();this.backdrop(function(){n.$body.removeClass("modal-open");n.resetAdjustments();n.resetScrollbar();n.$element.trigger("hidden.bs.modal");});};t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null;};t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){r=n.support.transition&&f;this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+f).prependTo(this.$element);this.$backdrop.on("click.dismiss.bs.modal",n.proxy(function(n){if(this.ignoreBackdropClick){this.ignoreBackdropClick=!1;return;}n.target===n.currentTarget&&(this.options.backdrop=="static"?this.$element[0].focus():this.hide());},this));if(r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i();}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function u(){e.removeBackdrop();i&&i();},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i();};t.prototype.handleUpdate=function(){this.adjustDialog();};t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""});};t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""});};t.prototype.checkScrollbar=function(){var n=window.innerWidth,t;n||(t=document.documentElement.getBoundingClientRect(),n=t.right-Math.abs(t.left));this.bodyIsOverflowing=document.body.clientWidth<n;this.scrollbarWidth=this.measureScrollbar();};t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth);};t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad);};t.prototype.measureScrollbar=function(){var n=document.createElement("div"),t;return n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t;};r=n.fn.modal;n.fn.modal=i;n.fn.modal.Constructor=t;n.fn.modal.noConflict=function(){return n.fn.modal=r,this;};n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault();u.one("show.bs.modal",function(n){if(!n.isDefaultPrevented())u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus");});});i.call(u,e,this);});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.tooltip",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t5){this.type=null;this.options=null;this.enabled=null;this.timeout=null;this.hoverState=null;this.$element=null;this.inState=null;this.init("tooltip",n,_t5);},i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}};t.prototype.init=function(t,i,r){var f,e,u,o,s;if(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(f=this.options.trigger.split(" "),e=f.length;e--;){if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this));}}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle();};t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t;};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r);}),t;};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusin"?"focus":"hover"]=!0),i.tip().hasClass("in")||i.hoverState=="in"){i.hoverState="in";return;}if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show();},i.options.delay.show);};t.prototype.isInStateTrue=function(){for(var n in this.inState){if(this.inState[n])return!0;}return!1;};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusout"?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide();},i.options.delay.hide);}};t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,e,w,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var u=this,r=this.tip(),a=this.getUID(this.type);this.setContent();r.attr("id",a);this.$element.attr("aria-describedby",a);this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top");r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this);this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);this.$element.trigger("inserted.bs."+this.type);var f=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;y&&(p=i,e=this.getPosition(this.$viewport),i=i=="bottom"&&f.bottom+s>e.bottom?"top":i=="top"&&f.top-s<e.top?"bottom":i=="right"&&f.right+o>e.width?"left":i=="left"&&f.left-o<e.left?"right":i,r.removeClass(p).addClass(i));w=this.getCalculatedOffset(i,f,o,s);this.applyPlacement(w,i);h=function h(){var n=u.hoverState;u.$element.trigger("shown.bs."+u.type);u.hoverState=null;n=="out"&&u.leave(u);};n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h();}};t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top+=o;t.left+=s;n.offset.setOffset(r[0],n.extend({using:function using(n){r.css({top:Math.round(n.top),left:Math.round(n.left)});}},t),0);r.addClass("in");h=r[0].offsetWidth;f=r[0].offsetHeight;i=="top"&&f!=e&&(t.top=t.top+e-f);u=this.getViewportAdjustedDelta(i,t,h,f);u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?u.left*2-l+h:u.top*2-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t);this.replaceArrow(a,r[0][v],c);};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","");};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right");};t.prototype.hide=function(i){function e(){u.hoverState!="in"&&r.detach();u.$element.removeAttr("aria-describedby").trigger("hidden.bs."+u.type);i&&i();}var u=this,r=n(this.$tip),f=n.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),this.hoverState=null,this;};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","");};t.prototype.hasContent=function(){return this.getTitle();};t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r=u.tagName=="BODY",i=u.getBoundingClientRect();i.width==null&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var f=r?{top:0,left:0}:t.offset(),e={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},i,e,o,f);};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width};};t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.right&&(f.left=u.left+u.width-c)),f):f;};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);};t.prototype.getUID=function(n){do{n+=~~(Math.random()*1e6);}while(document.getElementById(n));return n;};t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),this.$tip.length!=1))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip;};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow");};t.prototype.enable=function(){this.enabled=!0;};t.prototype.disable=function(){this.enabled=!1;};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled;};t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)));t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i);};t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout);this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type);n.$tip&&n.$tip.detach();n.$tip=null;n.$arrow=null;n.$viewport=null;});};i=n.fn.tooltip;n.fn.tooltip=r;n.fn.tooltip.Constructor=t;n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this;};}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.popover",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t6){this.init("popover",n,_t6);},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.5";t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'});t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype);t.prototype.constructor=t;t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.setContent=function(){var n=this.tip(),i=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](i);n.find(".popover-content").children().detach().end()[this.options.html?typeof t=="string"?"html":"append":"text"](t);n.removeClass("fade top bottom left right in");n.find(".popover-title").html()||n.find(".popover-title").hide();};t.prototype.hasContent=function(){return this.getTitle()||this.getContent();};t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content);};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow");};i=n.fn.popover;n.fn.popover=r;n.fn.popover.Constructor=t;n.fn.popover.noConflict=function(){return n.fn.popover=i,this;};}(jQuery);+function(n){"use strict";function t(i,r){this.$body=n(document.body);this.$scrollElement=n(i).is(document.body)?n(window):n(i);this.options=n.extend({},t.DEFAULTS,r);this.selector=(this.options.target||"")+" .nav li > a";this.offsets=[];this.targets=[];this.activeTarget=null;this.scrollHeight=0;this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this));this.refresh();this.process();}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.scrollspy",r=new t(this,f));typeof i=="string"&&r[i]();});}t.VERSION="3.3.5";t.DEFAULTS={offset:10};t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight);};t.prototype.refresh=function(){var t=this,i="offset",r=0;this.offsets=[];this.targets=[];this.scrollHeight=this.getScrollHeight();n.isWindow(this.$scrollElement[0])||(i="position",r=this.$scrollElement.scrollTop());this.$body.find(this.selector).map(function(){var f=n(this),u=f.data("target")||f.attr("href"),t=/^#./.test(u)&&n(u);return t&&t.length&&t.is(":visible")&&[[t[i]().top+r,u]]||null;}).sort(function(n,t){return n[0]-t[0];}).each(function(){t.offsets.push(this[0]);t.targets.push(this[1]);});};t.prototype.process=function(){var i=this.$scrollElement.scrollTop()+this.options.offset,f=this.getScrollHeight(),e=this.options.offset+f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget,n;if(this.scrollHeight!=f&&this.refresh(),i>=e)return u!=(n=r[r.length-1])&&this.activate(n);if(u&&i<t[0])return this.activeTarget=null,this.clear();for(n=t.length;n--;){u!=r[n]&&i>=t[n]&&(t[n+1]===undefined||i<t[n+1])&&this.activate(r[n]);}};t.prototype.activate=function(t){this.activeTarget=t;this.clear();var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active"));i.trigger("activate.bs.scrollspy");};t.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active");};var r=n.fn.scrollspy;n.fn.scrollspy=i;n.fn.scrollspy.Constructor=t;n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=r,this;};n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this));typeof i=="string"&&r[i]();});}var t=function t(_t7){this.element=n(_t7);},u,i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.show=function(){var t=this.element,f=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),u;if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=f.find(".active:last a"),e=n.Event("hide.bs.tab",{relatedTarget:t[0]}),o=n.Event("show.bs.tab",{relatedTarget:r[0]});(r.trigger(e),t.trigger(o),o.isDefaultPrevented()||e.isDefaultPrevented())||(u=n(i),this.activate(t.closest("li"),f),this.activate(u,u.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]});t.trigger({type:"shown.bs.tab",relatedTarget:r[0]});}));}};t.prototype.activate=function(i,r,u){function o(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1);i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0);e?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade");i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0);u&&u();}var f=r.find("> .active"),e=u&&n.support.transition&&(f.length&&f.hasClass("fade")||!!r.find("> .fade").length);f.length&&e?f.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o();f.removeClass("in");};u=n.fn.tab;n.fn.tab=r;n.fn.tab.Constructor=t;n.fn.tab.noConflict=function(){return n.fn.tab=u,this;};i=function i(t){t.preventDefault();r.call(n(this),"show");};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition();},r;t.VERSION="3.3.5";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1;};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n;};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1);};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if((typeof r==="undefined"?"undefined":_typeof(r))!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix");}i=="bottom"&&this.$element.offset({top:h-s-u});}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this;};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t);});});}(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(root,factory){if((typeof exports==='undefined'?'undefined':_typeof(exports))=='object')module.exports=factory();else if(typeof define=='function'&&define.amd)define(factory);else root.LoadingSpinner=factory();})(this,function(){"use strict";var prefixes=['webkit','Moz','ms','O'],animations={},useCssAnimations;function createEl(tag,prop){var el=document.createElement(tag||'div'),n;for(n in prop){el[n]=prop[n];}return el;}
function ins(parent){for(var i=1,n=arguments.length;i<n;i++){parent.appendChild(arguments[i]);}return parent;}
var sheet=function(){var el=createEl('style',{type:'text/css'});ins(document.getElementsByTagName('head')[0],el);return el.sheet||el.styleSheet;}();function addAnimation(alpha,trail,i,lines){var name=['opacity',trail,~~(alpha*100),i,lines].join('-'),start=0.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf('Animation')).toLowerCase(),pre=prefix&&'-'+prefix+'-'||'';if(!animations[name]){sheet.insertRule('@'+pre+'keyframes '+name+'{'+'0%{opacity:'+z+'}'+start+'%{opacity:'+alpha+'}'+(start+0.01)+'%{opacity:1}'+(start+trail)%100+'%{opacity:'+alpha+'}'+'100%{opacity:'+z+'}'+'}',sheet.cssRules.length);animations[name]=1;}
return name;}
function vendor(el,prop){var s=el.style,pp,i;prop=prop.charAt(0).toUpperCase()+prop.slice(1);for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop;if(s[pp]!==undefined)return pp;}
if(s[prop]!==undefined)return prop;}
function css(el,prop){for(var n in prop){el.style[vendor(el,n)||n]=prop[n];}return el;}
function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def){if(obj[n]===undefined)obj[n]=def[n];}}
return obj;}
function pos(el){var o={x:el.offsetLeft,y:el.offsetTop};while(el=el.offsetParent){o.x+=el.offsetLeft,o.y+=el.offsetTop;}return o;}
function getColor(color,idx){return typeof color=='string'?color:color[idx%color.length];}
var defaults={lines:12,length:10,width:5,radius:15,rotate:0,corners:1,color:'#000',direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:1001,className:'spinner',top:'50%',left:'50%',position:'absolute'};function LoadingSpinner(o){this.opts=merge(o||{},LoadingSpinner.defaults,defaults);}
LoadingSpinner.defaults={};merge(LoadingSpinner.prototype,{spin:function spin(target){this.stop();this.opts.target=target;var divMask=document.createElement("div");divMask.className="spinnerMask";divMask.style.width=target.width;divMask.style.height=target.height;target.appendChild(divMask);this.divMask=divMask;var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width;css(el,{left:o.left,top:o.top});if(target){target.insertBefore(el,target.firstChild||null);}
el.setAttribute('role','progressbar');self.lines(el,self.opts);if(!useCssAnimations){var i=0,start=(o.lines-1)*(1-o.direction)/2,alpha,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var j=0;j<o.lines;j++){alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity);self.opacity(el,j*o.direction+start,alpha,o);}
self.timeout=self.el&&setTimeout(anim,~~(1000/fps));})();}
return self;},stop:function stop(){var el=this.el;if(el){clearTimeout(this.timeout);if(el.parentNode)el.parentNode.removeChild(el);this.el=undefined;if(this.divMask){if(this.divMask.parentNode)this.divMask.parentNode.removeChild(this.divMask);this.el=undefined;}}
return this;},lines:function lines(el,o){var i=0,start=(o.lines-1)*(1-o.direction)/2,seg;function fill(color,shadow){return css(createEl(),{position:'absolute',width:o.length+o.width+'px',height:o.width+'px',background:color,boxShadow:shadow,transformOrigin:'left',transform:'rotate('+~~(360/o.lines*i+o.rotate)+'deg) translate('+o.radius+'px'+',0)',borderRadius:(o.corners*o.width>>1)+'px'});}
for(;i<o.lines;i++){seg=css(createEl(),{position:'absolute',top:1+~(o.width/2)+'px',transform:o.hwaccel?'translate3d(0,0,0)':'',opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+' '+1/o.speed+'s linear infinite'});if(o.shadow)ins(seg,css(fill('#000','0 0 4px '+'#000'),{top:2+'px'}));ins(el,ins(seg,fill(getColor(o.color,i),'0 0 1px rgba(0,0,0,.1)')));}
return el;},opacity:function opacity(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val;}});function initVML(){function vml(tag,attr){return createEl('<'+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr);}
sheet.addRule('.spin-vml','behavior:url(#default#VML)');LoadingSpinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r;function grp(){return css(vml('group',{coordsize:s+' '+s,coordorigin:-r+' '+-r}),{width:s,height:s});}
var margin=-(o.width+o.length)*2+'px',g=css(grp(),{position:'absolute',top:margin,left:margin}),i;function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+'deg',left:~~dx}),ins(css(vml('roundrect',{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml('fill',{color:getColor(o.color,i),opacity:o.opacity}),vml('stroke',{opacity:0}))));}
if(o.shadow)for(i=1;i<=o.lines;i++){seg(i,-2,'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)');}for(i=1;i<=o.lines;i++){seg(i);}return ins(el,g);};LoadingSpinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0;if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild;if(c)c.opacity=val;}};}
var probe=css(createEl('group'),{behavior:'url(#default#VML)'});if(!vendor(probe,'transform')&&probe.adj)initVML();else useCssAnimations=vendor(probe,'animation');return LoadingSpinner;});(function(){dockspawn={version:"0.0.2"};dockspawn.TabHandle=function(parent){this.parent=parent;var undockHandler=dockspawn.TabHandle.prototype._performUndock.bind(this);this.elementBase=document.createElement('div');this.elementText=document.createElement('div');this.elementCloseButton=document.createElement('div');this.elementBase.classList.add("tab-handle");this.elementBase.classList.add("disable-selection");this.elementText.classList.add("tab-handle-text");this.elementCloseButton.classList.add("tab-handle-close-button");this.elementBase.appendChild(this.elementText);if(this.parent.host.displayCloseButton)this.elementBase.appendChild(this.elementCloseButton);this.parent.host.tabListElement.appendChild(this.elementBase);var panel=parent.container;var title=panel.getRawTitle();this.elementText.innerHTML=title;var closeIcon="icon-remove-sign";this.elementCloseButton.innerHTML='<i class="'+closeIcon+'"></i>';this._bringToFront(this.elementBase);this.undockInitiator=new dockspawn.UndockInitiator(this.elementBase,undockHandler);this.undockInitiator.enabled=true;this.mouseClickHandler=new dockspawn.EventHandler(this.elementBase,'click',this.onMouseClicked.bind(this));this.closeButtonHandler=new dockspawn.EventHandler(this.elementCloseButton,'mousedown',this.onCloseButtonClicked.bind(this));this.zIndexCounter=1000;};dockspawn.TabHandle.prototype.updateTitle=function(){if(this.parent.container instanceof dockspawn.PanelContainer){var panel=this.parent.container;var title=panel.getRawTitle();this.elementText.innerHTML=title;}};dockspawn.TabHandle.prototype.destroy=function(){this.mouseClickHandler.cancel();this.closeButtonHandler.cancel();removeNode(this.elementBase);removeNode(this.elementCloseButton);delete this.elementBase;delete this.elementCloseButton;};dockspawn.TabHandle.prototype._performUndock=function(e,dragOffset){if(this.parent.container.containerType=="panel"){this.undockInitiator.enabled=false;var panel=this.parent.container;return panel.performUndockToDialog(e,dragOffset);}else return null;};dockspawn.TabHandle.prototype.onMouseClicked=function(){this.parent.onSelected();};dockspawn.TabHandle.prototype.onCloseButtonClicked=function(){if(this.parent.container.containerType=="panel"){this.undockInitiator.enabled=false;var panel=this.parent.container;panel.performUndock();}};dockspawn.TabHandle.prototype.setSelected=function(selected){var selectedClassName="tab-handle-selected";if(selected)this.elementBase.classList.add(selectedClassName);else this.elementBase.classList.remove(selectedClassName);};dockspawn.TabHandle.prototype.setZIndex=function(zIndex){this.elementBase.style.zIndex=zIndex;};dockspawn.TabHandle.prototype._bringToFront=function(element){element.style.zIndex=this.zIndexCounter;this.zIndexCounter++;};dockspawn.TabHost=function(tabStripDirection,displayCloseButton){if(tabStripDirection===undefined)tabStripDirection=dockspawn.TabHost.DIRECTION_BOTTOM;if(displayCloseButton===undefined)displayCloseButton=false;this.tabStripDirection=tabStripDirection;this.displayCloseButton=displayCloseButton;this.pages=[];this.hostElement=document.createElement('div');this.tabListElement=document.createElement('div');this.separatorElement=document.createElement('div');this.contentElement=document.createElement('div');this.createTabPage=this._createDefaultTabPage;if(this.tabStripDirection==dockspawn.TabHost.DIRECTION_BOTTOM){this.hostElement.appendChild(this.contentElement);this.hostElement.appendChild(this.separatorElement);this.hostElement.appendChild(this.tabListElement);}else if(this.tabStripDirection==dockspawn.TabHost.DIRECTION_TOP){this.tabListElement.classList.add('hide');this.separatorElement.classList.add('hide');this.hostElement.appendChild(this.tabListElement);this.hostElement.appendChild(this.separatorElement);this.hostElement.appendChild(this.contentElement);}else throw new dockspawn.Exception("Only top and bottom tab strip orientations are supported");this.hostElement.classList.add("tab-host");this.tabListElement.classList.add("tab-handle-list-container");this.separatorElement.classList.add("tab-handle-content-seperator");this.contentElement.classList.add("tab-content");};dockspawn.TabHost.DIRECTION_TOP=0;dockspawn.TabHost.DIRECTION_BOTTOM=1;dockspawn.TabHost.DIRECTION_LEFT=2;dockspawn.TabHost.DIRECTION_RIGHT=3;dockspawn.TabHost.prototype._createDefaultTabPage=function(tabHost,container){return new dockspawn.TabPage(tabHost,container);};dockspawn.TabHost.prototype.setActiveTab=function(container){var self=this;this.pages.forEach(function(page){if(page.container===container){self.onTabPageSelected(page);return;}});};dockspawn.TabHost.prototype.resize=function(width,height){this.hostElement.style.width=width+"px";this.hostElement.style.height=height+"px";var tabHeight=this.tabListElement.clientHeight;var separatorHeight=this.separatorElement.clientHeight;var contentHeight=height-tabHeight-separatorHeight;this.contentElement.style.height=contentHeight+"px";if(this.activeTab)this.activeTab.resize(width,contentHeight);};dockspawn.TabHost.prototype.performLayout=function(children){this.pages.forEach(function(tab){tab.destroy();});this.pages.length=0;var oldActiveTab=this.activeTab;delete this.activeTab;var childPanels=children.filter(function(child){return child.containerType=="panel";});if(childPanels.length>0){var self=this;childPanels.forEach(function(child){var page=self.createTabPage(self,child);self.pages.push(page);if(oldActiveTab&&page.container===oldActiveTab.container)self.activeTab=page;});this._setTabHandlesVisible(true);}else
this._setTabHandlesVisible(false);if(this.activeTab)this.onTabPageSelected(this.activeTab);};dockspawn.TabHost.prototype._setTabHandlesVisible=function(visible){this.tabListElement.style.display=visible?"block":"none";this.separatorElement.style.display=visible?"block":"none";};dockspawn.TabHost.prototype.onTabPageSelected=function(page){var changedPages=[];this.activeTab=page;this.pages.forEach(function(tabPage){var selected=tabPage===page;if(tabPage.selected!==selected)changedPages.push(tabPage);tabPage.setSelected(selected);});var zIndexDelta=1;var zIndex=1000;this.pages.forEach(function(tabPage){tabPage.handle.setZIndex(zIndex);var selected=tabPage==page;if(selected)zIndexDelta=-1;zIndex+=zIndexDelta;});changedPages.forEach(function(tabPage){if(this.onTabChanged)this.onTabChanged(this,tabPage);},this);};dockspawn.TabHost.prototype.onTabChanged=function(host,page){var ele=page.container.elementContent;var cancelld=ele.dispatchEvent(new CustomEvent('dock.tabPage.changed',{detail:page.selected}));};dockspawn.TabPage=function(host,container){if(arguments.length==0)return;this.selected=false;this.host=host;this.container=container;this.handle=new dockspawn.TabHandle(this);this.containerElement=container.containerElement;if(container instanceof dockspawn.PanelContainer){var panel=container;panel.onTitleChanged=this.onTitleChanged.bind(this);}};dockspawn.TabPage.prototype.onTitleChanged=function(sender,title){this.handle.updateTitle();};dockspawn.TabPage.prototype.destroy=function(){this.handle.destroy();if(this.container instanceof dockspawn.PanelContainer){var panel=this.container;delete panel.onTitleChanged;}};dockspawn.TabPage.prototype.onSelected=function(){this.host.onTabPageSelected(this);};dockspawn.TabPage.prototype.setSelected=function(flag){this.selected=flag;this.handle.setSelected(flag);if(this.selected){this.host.contentElement.appendChild(this.containerElement);var width=this.host.contentElement.clientWidth;var height=this.host.contentElement.clientHeight;this.container.resize(width,height);}else removeNode(this.containerElement);$(".edit").hide();};dockspawn.TabPage.prototype.resize=function(width,height){this.container.resize(width,height);};dockspawn.Dialog=function(panel,dockManager){this.panel=panel;this.zIndexCounter=1000;this.dockManager=dockManager;this.eventListener=dockManager;this._initialize();};dockspawn.Dialog.fromElement=function(id,dockManager){return new dockspawn.Dialog(new dockspawn.PanelContainer(document.getElementById(id),dockManager),dockManager);};dockspawn.Dialog.prototype._initialize=function(){this.panel.floatingDialog=this;this.elementDialog=document.createElement('div');this.elementDialog.appendChild(this.panel.elementPanel);this.draggable=new dockspawn.DraggableContainer(this,this.panel,this.elementDialog,this.panel.elementTitle);this.resizable=new dockspawn.ResizableContainer(this,this.draggable,this.draggable.topLevelElement);document.body.appendChild(this.elementDialog);this.elementDialog.classList.add("dialog-floating");this.elementDialog.classList.add("rounded-corner-top");this.panel.elementTitle.classList.add("rounded-corner-top");this.mouseDownHandler=new dockspawn.EventHandler(this.elementDialog,'mousedown',this.onMouseDown.bind(this));this.resize(this.panel.elementPanel.clientWidth,this.panel.elementPanel.clientHeight);this.bringToFront();};dockspawn.Dialog.prototype.setPosition=function(x,y){this.elementDialog.style.left=x+"px";this.elementDialog.style.top=y+"px";};dockspawn.Dialog.prototype.onMouseDown=function(e){this.bringToFront();};dockspawn.Dialog.prototype.destroy=function(){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
this.elementDialog.classList.remove("rounded-corner-top");this.panel.elementTitle.classList.remove("rounded-corner-top");removeNode(this.elementDialog);this.draggable.removeDecorator();removeNode(this.panel.elementPanel);this.panel.floatingDialog=undefined;};dockspawn.Dialog.prototype.resize=function(width,height){this.resizable.resize(width,height);};dockspawn.Dialog.prototype.setTitle=function(title){this.panel.setTitle(title);};dockspawn.Dialog.prototype.setTitleIcon=function(iconName){this.panel.setTitleIcon(iconName);};dockspawn.Dialog.prototype.bringToFront=function(){this.elementDialog.style.zIndex=this.zIndexCounter++;};dockspawn.DraggableContainer=function(dialog,delegate,topLevelElement,dragHandle){this.dialog=dialog;this.delegate=delegate;this.containerElement=delegate.containerElement;this.dockManager=delegate.dockManager;this.topLevelElement=topLevelElement;this.containerType=delegate.containerType;this.mouseDownHandler=new dockspawn.EventHandler(dragHandle,'mousedown',this.onMouseDown.bind(this));this.topLevelElement.style.marginLeft=topLevelElement.offsetLeft+"px";this.topLevelElement.style.marginTop=topLevelElement.offsetTop+"px";this.minimumAllowedChildNodes=delegate.minimumAllowedChildNodes;};dockspawn.DraggableContainer.prototype.destroy=function(){this.removeDecorator();this.delegate.destroy();};dockspawn.DraggableContainer.prototype.saveState=function(state){this.delegate.saveState(state);};dockspawn.DraggableContainer.prototype.loadState=function(state){this.delegate.loadState(state);};dockspawn.DraggableContainer.prototype.setActiveChild=function(child){};Object.defineProperty(dockspawn.DraggableContainer.prototype,"width",{get:function get(){return this.delegate.width;}});Object.defineProperty(dockspawn.DraggableContainer.prototype,"height",{get:function get(){return this.delegate.height;}});dockspawn.DraggableContainer.prototype.name=function(value){if(value)this.delegate.name=value;return this.delegate.name;};dockspawn.DraggableContainer.prototype.resize=function(width,height){this.delegate.resize(width,height);};dockspawn.DraggableContainer.prototype.performLayout=function(children){this.delegate.performLayout(children);};dockspawn.DraggableContainer.prototype.removeDecorator=function(){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}};dockspawn.DraggableContainer.prototype.onMouseDown=function(event){this._startDragging(event);this.previousMousePosition={x:event.pageX,y:event.pageY};if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMove.bind(this));this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));};dockspawn.DraggableContainer.prototype.onMouseUp=function(event){this._stopDragging(event);this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;this.mouseUpHandler.cancel();delete this.mouseUpHandler;};dockspawn.DraggableContainer.prototype._startDragging=function(event){if(this.dialog.eventListener)this.dialog.eventListener.onDialogDragStarted(this.dialog,event);document.body.classList.add("disable-selection");};dockspawn.DraggableContainer.prototype._stopDragging=function(event){if(this.dialog.eventListener)this.dialog.eventListener.onDialogDragEnded(this.dialog,event);document.body.classList.remove("disable-selection");};dockspawn.DraggableContainer.prototype.onMouseMove=function(event){var currentMousePosition=new Point(event.pageX,event.pageY);var dx=Math.floor(currentMousePosition.x-this.previousMousePosition.x);var dy=Math.floor(currentMousePosition.y-this.previousMousePosition.y);this._performDrag(dx,dy);this.previousMousePosition=currentMousePosition;};dockspawn.DraggableContainer.prototype._performDrag=function(dx,dy){var left=dx+getPixels(this.topLevelElement.style.marginLeft);var top=dy+getPixels(this.topLevelElement.style.marginTop);this.topLevelElement.style.marginLeft=left+"px";this.topLevelElement.style.marginTop=top+"px";};dockspawn.ResizableContainer=function(dialog,delegate,topLevelElement){this.dialog=dialog;this.delegate=delegate;this.containerElement=delegate.containerElement;this.dockManager=delegate.dockManager;this.topLevelElement=topLevelElement;this.containerType=delegate.containerType;this.topLevelElement.style.marginLeft=this.topLevelElement.offsetLeft+"px";this.topLevelElement.style.marginTop=this.topLevelElement.offsetTop+"px";this.minimumAllowedChildNodes=delegate.minimumAllowedChildNodes;this._buildResizeHandles();this.readyToProcessNextResize=true;};dockspawn.ResizableContainer.prototype.setActiveChild=function(child){};dockspawn.ResizableContainer.prototype._buildResizeHandles=function(){this.resizeHandles=[];this._buildResizeHandle(false,true,true,false);this._buildResizeHandle(true,false,false,true);this._buildResizeHandle(false,true,false,true);this._buildResizeHandle(true,false,false,false);this._buildResizeHandle(false,true,false,false);this._buildResizeHandle(false,false,true,false);this._buildResizeHandle(false,false,false,true);};dockspawn.ResizableContainer.prototype._buildResizeHandle=function(east,west,north,south){var handle=new ResizeHandle();handle.east=east;handle.west=west;handle.north=north;handle.south=south;handle.element=document.createElement('div');this.topLevelElement.appendChild(handle.element);var verticalClass="";var horizontalClass="";if(north)verticalClass="n";if(south)verticalClass="s";if(east)horizontalClass="e";if(west)horizontalClass="w";var cssClass="resize-handle-"+verticalClass+horizontalClass;if(verticalClass.length>0&&horizontalClass.length>0)handle.corner=true;handle.element.classList.add(handle.corner?"resize-handle-corner":"resize-handle");handle.element.classList.add(cssClass);this.resizeHandles.push(handle);var self=this;handle.mouseDownHandler=new dockspawn.EventHandler(handle.element,'mousedown',function(e){self.onMouseDown(handle,e);});};dockspawn.ResizableContainer.prototype.saveState=function(state){this.delegate.saveState(state);};dockspawn.ResizableContainer.prototype.loadState=function(state){this.delegate.loadState(state);};Object.defineProperty(dockspawn.ResizableContainer.prototype,"width",{get:function get(){return this.delegate.width;}});Object.defineProperty(dockspawn.ResizableContainer.prototype,"height",{get:function get(){return this.delegate.height;}});dockspawn.ResizableContainer.prototype.name=function(value){if(value)this.delegate.name=value;return this.delegate.name;};dockspawn.ResizableContainer.prototype.resize=function(width,height){this.delegate.resize(width,height);this._adjustResizeHandles(width,height);};dockspawn.ResizableContainer.prototype._adjustResizeHandles=function(width,height){var self=this;this.resizeHandles.forEach(function(handle){handle.adjustSize(self.topLevelElement,width,height);});};dockspawn.ResizableContainer.prototype.performLayout=function(children){this.delegate.performLayout(children);};dockspawn.ResizableContainer.prototype.destroy=function(){this.removeDecorator();this.delegate.destroy();};dockspawn.ResizableContainer.prototype.removeDecorator=function(){};dockspawn.ResizableContainer.prototype.onMouseMoved=function(handle,e){if(!this.readyToProcessNextResize)return;this.readyToProcessNextResize=false;this.dockManager.suspendLayout();var currentMousePosition=new Point(e.pageX,e.pageY);var dx=Math.floor(currentMousePosition.x-this.previousMousePosition.x);var dy=Math.floor(currentMousePosition.y-this.previousMousePosition.y);this._performDrag(handle,dx,dy);this.previousMousePosition=currentMousePosition;this.readyToProcessNextResize=true;this.dockManager.resumeLayout();};dockspawn.ResizableContainer.prototype.onMouseDown=function(handle,event){this.previousMousePosition=new Point(event.pageX,event.pageY);if(handle.mouseMoveHandler){handle.mouseMoveHandler.cancel();delete handle.mouseMoveHandler;}
if(handle.mouseUpHandler){handle.mouseUpHandler.cancel();delete handle.mouseUpHandler;}
var self=this;handle.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',function(e){self.onMouseMoved(handle,e);});handle.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',function(e){self.onMouseUp(handle,e);});document.body.classList.add("disable-selection");};dockspawn.ResizableContainer.prototype.onMouseUp=function(handle,event){handle.mouseMoveHandler.cancel();handle.mouseUpHandler.cancel();delete handle.mouseMoveHandler;delete handle.mouseUpHandler;document.body.classList.remove("disable-selection");};dockspawn.ResizableContainer.prototype._performDrag=function(handle,dx,dy){var bounds={};bounds.left=getPixels(this.topLevelElement.style.marginLeft);bounds.top=getPixels(this.topLevelElement.style.marginTop);bounds.width=this.topLevelElement.clientWidth;bounds.height=this.topLevelElement.clientHeight;if(handle.east)this._resizeEast(dx,bounds);if(handle.west)this._resizeWest(dx,bounds);if(handle.north)this._resizeNorth(dy,bounds);if(handle.south)this._resizeSouth(dy,bounds);};dockspawn.ResizableContainer.prototype._resizeWest=function(dx,bounds){this._resizeContainer(dx,0,-dx,0,bounds);};dockspawn.ResizableContainer.prototype._resizeEast=function(dx,bounds){this._resizeContainer(0,0,dx,0,bounds);};dockspawn.ResizableContainer.prototype._resizeNorth=function(dy,bounds){this._resizeContainer(0,dy,0,-dy,bounds);};dockspawn.ResizableContainer.prototype._resizeSouth=function(dy,bounds){this._resizeContainer(0,0,0,dy,bounds);};dockspawn.ResizableContainer.prototype._resizeContainer=function(leftDelta,topDelta,widthDelta,heightDelta,bounds){bounds.left+=leftDelta;bounds.top+=topDelta;bounds.width+=widthDelta;bounds.height+=heightDelta;var minWidth=50;var minHeight=50;bounds.width=Math.max(bounds.width,minWidth);bounds.height=Math.max(bounds.height,minHeight);this.topLevelElement.style.marginLeft=bounds.left+"px";this.topLevelElement.style.marginTop=bounds.top+"px";this.resize(bounds.width,bounds.height);};function ResizeHandle(){this.element=undefined;this.handleSize=6;this.cornerSize=12;this.east=false;this.west=false;this.north=false;this.south=false;this.corner=false;}
ResizeHandle.prototype.adjustSize=function(container,clientWidth,clientHeight){if(this.corner){if(this.west)this.element.style.left="0px";if(this.east)this.element.style.left=clientWidth-this.cornerSize+"px";if(this.north)this.element.style.top="0px";if(this.south)this.element.style.top=clientHeight-this.cornerSize+"px";}else{if(this.west){this.element.style.left="0px";this.element.style.top=this.cornerSize+"px";}
if(this.east){this.element.style.left=clientWidth-this.handleSize+"px";this.element.style.top=this.cornerSize+"px";}
if(this.north){this.element.style.left=this.cornerSize+"px";this.element.style.top="0px";}
if(this.south){this.element.style.left=this.cornerSize+"px";this.element.style.top=clientHeight-this.handleSize+"px";}
if(this.west||this.east){this.element.style.height=clientHeight-this.cornerSize*2+"px";}else{this.element.style.width=clientWidth-this.cornerSize*2+"px";}}};dockspawn.Exception=function(message){this.message=message;};dockspawn.Exception.prototype.toString=function(){return this.message;};dockspawn.DockManager=function(element){if(element===undefined)throw new dockspawn.Exception("Invalid Dock Manager element provided");this.element=element;this.context=this.dockWheel=this.layoutEngine=this.mouseMoveHandler=undefined;this.layoutEventListeners=[];};dockspawn.DockManager.prototype.initialize=function(){this.context=new dockspawn.DockManagerContext(this);var documentNode=new dockspawn.DockNode(this.context.documentManagerView);this.context.model.rootNode=documentNode;this.context.model.documentManagerNode=documentNode;this.setRootNode(this.context.model.rootNode);this.resize(this.element.clientWidth,this.element.clientHeight);this.dockWheel=new dockspawn.DockWheel(this);this.layoutEngine=new dockspawn.DockLayoutEngine(this);this.rebuildLayout(this.context.model.rootNode);};dockspawn.DockManager.prototype.rebuildLayout=function(node){var self=this;node.children.forEach(function(child){self.rebuildLayout(child);});node.performLayout();};dockspawn.DockManager.prototype.invalidate=function(){this.resize(this.element.clientWidth,this.element.clientHeight);};dockspawn.DockManager.prototype.resize=function(width,height){this.element.style.width=width+"px";this.element.style.height=height+"px";this.context.model.rootNode.container.resize(width,height);};dockspawn.DockManager.prototype.setModel=function(model){removeNode(this.context.documentManagerView.containerElement);this.context.model=model;this.setRootNode(model.rootNode);this.rebuildLayout(model.rootNode);this.invalidate();};dockspawn.DockManager.prototype.setRootNode=function(node){if(this.context.model.rootNode){}
node.detachFromParent();this.context.model.rootNode=node;this.element.appendChild(node.container.containerElement);};dockspawn.DockManager.prototype.onDialogDragStarted=function(sender,e){this.dockWheel.activeNode=this._findNodeOnPoint(e.pageX,e.pageY);this.dockWheel.activeDialog=sender;this.dockWheel.showWheel();if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMoved.bind(this));};dockspawn.DockManager.prototype.onDialogDragEnded=function(sender,e){if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.dockWheel.onDialogDropped(sender);this.dockWheel.hideWheel();delete this.dockWheel.activeDialog;};dockspawn.DockManager.prototype.onMouseMoved=function(e){this.dockWheel.activeNode=this._findNodeOnPoint(e.clientX,e.clientY);};dockspawn.DockManager.prototype._findNodeOnPoint=function(x,y){var stack=[];stack.push(this.context.model.rootNode);var bestMatch;while(stack.length>0){var topNode=stack.pop();if(isPointInsideNode(x,y,topNode)){bestMatch=topNode;[].push.apply(stack,topNode.children);}}
return bestMatch;};dockspawn.DockManager.prototype.dockDialogLeft=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockLeft.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogRight=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockRight.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogUp=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockUp.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogDown=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockDown.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockDialogFill=function(referenceNode,dialog){return this._requestDockDialog(referenceNode,dialog,this.layoutEngine.dockFill.bind(this.layoutEngine));};dockspawn.DockManager.prototype.dockLeft=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockLeft.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockRight=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockRight.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockUp=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockUp.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockDown=function(referenceNode,container,ratio){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockDown.bind(this.layoutEngine),ratio);};dockspawn.DockManager.prototype.dockFill=function(referenceNode,container){return this._requestDockContainer(referenceNode,container,this.layoutEngine.dockFill.bind(this.layoutEngine));};dockspawn.DockManager.prototype._requestDockDialog=function(referenceNode,dialog,layoutDockFunction){var panel=dialog.panel;var newNode=new dockspawn.DockNode(panel);panel.prepareForDocking();dialog.destroy();layoutDockFunction(referenceNode,newNode);this.invalidate();return newNode;};dockspawn.DockManager.prototype._requestDockContainer=function(referenceNode,container,layoutDockFunction,ratio){var newNode=new dockspawn.DockNode(container);if(container.containerType=="panel"){var panel=container;panel.prepareForDocking();removeNode(panel.elementPanel);}
layoutDockFunction(referenceNode,newNode);if(ratio&&newNode.parent&&(newNode.parent.container.containerType=="vertical"||newNode.parent.container.containerType=="horizontal")){var splitter=newNode.parent.container;splitter.setContainerRatio(container,ratio);}
this.rebuildLayout(this.context.model.rootNode);this.invalidate();return newNode;};dockspawn.DockManager.prototype.requestUndockToDialog=function(container,event,dragOffset){var node=this._findNodeFromContainer(container);this.layoutEngine.undock(node);var dialog=new dockspawn.Dialog(node.container,this);var dialogWidth=dialog.elementDialog.clientWidth;if(dragOffset.x>dialogWidth)dragOffset.x=0.75*dialogWidth;dialog.setPosition(event.clientX-dragOffset.x,event.clientY-dragOffset.y);dialog.draggable.onMouseDown(event);return dialog;};dockspawn.DockManager.prototype.requestUndock=function(container){var node=this._findNodeFromContainer(container);this.layoutEngine.undock(node);};dockspawn.DockManager.prototype.requestRemove=function(container){var node=this._findNodeFromContainer(container);var parent=node.parent;node.detachFromParent();if(parent)this.rebuildLayout(parent);return node;};dockspawn.DockManager.prototype._findNodeFromContainer=function(container){var stack=[];stack.push(this.context.model.rootNode);while(stack.length>0){var topNode=stack.pop();if(topNode.container===container)return topNode;[].push.apply(stack,topNode.children);}
throw new dockspawn.Exception("Cannot find dock node belonging to the element");};dockspawn.DockManager.prototype.addLayoutListener=function(listener){this.layoutEventListeners.push(listener);};dockspawn.DockManager.prototype.removeLayoutListener=function(listener){this.layoutEventListeners.splice(this.layoutEventListeners.indexOf(listener),1);};dockspawn.DockManager.prototype.suspendLayout=function(){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onSuspendLayout)listener.onSuspendLayout(self);});};dockspawn.DockManager.prototype.resumeLayout=function(){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onResumeLayout)listener.onResumeLayout(self);});};dockspawn.DockManager.prototype.notifyOnDock=function(dockNode){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onDock){listener.onDock(self,dockNode);}});};dockspawn.DockManager.prototype.notifyOnUnDock=function(dockNode){var self=this;this.layoutEventListeners.forEach(function(listener){if(listener.onUndock){listener.onUndock(self,dockNode);}});};dockspawn.DockManager.prototype.saveState=function(){var serializer=new dockspawn.DockGraphSerializer();return serializer.serialize(this.context.model);};dockspawn.DockManager.prototype.loadState=function(json){var deserializer=new dockspawn.DockGraphDeserializer(this);this.context.model=deserializer.deserialize(json);this.setModel(this.context.model);};dockspawn.DockLayoutEngine=function(dockManager){this.dockManager=dockManager;};dockspawn.DockLayoutEngine.prototype.dockLeft=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"horizontal",true);};dockspawn.DockLayoutEngine.prototype.dockRight=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"horizontal",false);};dockspawn.DockLayoutEngine.prototype.dockUp=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"vertical",true);};dockspawn.DockLayoutEngine.prototype.dockDown=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"vertical",false);};dockspawn.DockLayoutEngine.prototype.dockFill=function(referenceNode,newNode){this._performDock(referenceNode,newNode,"fill",false);};dockspawn.DockLayoutEngine.prototype.undock=function(node){var parentNode=node.parent;if(!parentNode)throw new dockspawn.Exception("Cannot undock.  panel is not a leaf node");var siblingIndex=parentNode.children.indexOf(node);node.detachFromParent();if(parentNode.children.length<parentNode.container.minimumAllowedChildNodes){var grandParent=parentNode.parent;for(var i=0;i<parentNode.children.length;i++){var otherChild=parentNode.children[i];if(grandParent){grandParent.addChildAfter(parentNode,otherChild);parentNode.detachFromParent();parentNode.container.destroy();grandParent.performLayout();}else{parentNode.detachFromParent();parentNode.container.destroy();this.dockManager.setRootNode(otherChild);}}}else{parentNode.performLayout();if(parentNode.children.length>0){var nextActiveSibling=parentNode.children[Math.max(0,siblingIndex-1)];parentNode.container.setActiveChild(nextActiveSibling.container);}}
this.dockManager.invalidate();this.dockManager.notifyOnUnDock(node);};dockspawn.DockLayoutEngine.prototype._performDock=function(referenceNode,newNode,direction,insertBeforeReference){if(referenceNode.parent&&referenceNode.parent.container.containerType=="fill")referenceNode=referenceNode.parent;if(direction=="fill"&&referenceNode.container.containerType=="fill"){referenceNode.addChild(newNode);referenceNode.performLayout();referenceNode.container.setActiveChild(newNode.container);return;}
var model=this.dockManager.context.model;if(referenceNode===model.rootNode){var compositeContainer=this._createDockContainer(direction,newNode,referenceNode);var compositeNode=new dockspawn.DockNode(compositeContainer);if(insertBeforeReference){compositeNode.addChild(newNode);compositeNode.addChild(referenceNode);}else{compositeNode.addChild(referenceNode);compositeNode.addChild(newNode);}
this.dockManager.setRootNode(compositeNode);this.dockManager.rebuildLayout(this.dockManager.context.model.rootNode);compositeNode.container.setActiveChild(newNode.container);return;}
if(referenceNode.parent.container.containerType!=direction){var referenceParent=referenceNode.parent;var referenceNodeWidth=referenceNode.container.containerElement.clientWidth;var referenceNodeHeight=referenceNode.container.containerElement.clientHeight;var referenceNodeParentWidth=referenceParent.container.containerElement.clientWidth;var referenceNodeParentHeight=referenceParent.container.containerElement.clientHeight;var compositeContainer=this._createDockContainer(direction,newNode,referenceNode);var compositeNode=new dockspawn.DockNode(compositeContainer);referenceParent.addChildAfter(referenceNode,compositeNode);referenceNode.detachFromParent();removeNode(referenceNode.container.containerElement);if(insertBeforeReference){compositeNode.addChild(newNode);compositeNode.addChild(referenceNode);}else{compositeNode.addChild(referenceNode);compositeNode.addChild(newNode);}
referenceParent.performLayout();compositeNode.performLayout();compositeNode.container.setActiveChild(newNode.container);compositeNode.container.resize(referenceNodeWidth,referenceNodeHeight);referenceParent.container.resize(referenceNodeParentWidth,referenceNodeParentHeight);}else{var referenceParent=referenceNode.parent;if(insertBeforeReference)referenceParent.addChildBefore(referenceNode,newNode);else referenceParent.addChildAfter(referenceNode,newNode);referenceParent.performLayout();referenceParent.container.setActiveChild(newNode.container);}
var containerWidth=newNode.container.containerElement.clientWidth;var containerHeight=newNode.container.containerElement.clientHeight;newNode.container.resize(containerWidth,containerHeight);this.dockManager.notifyOnDock(newNode);};dockspawn.DockLayoutEngine.prototype._forceResizeCompositeContainer=function(container){var width=container.containerElement.clientWidth;var height=container.containerElement.clientHeight;container.resize(width,height);};dockspawn.DockLayoutEngine.prototype._createDockContainer=function(containerType,newNode,referenceNode){if(containerType=="horizontal")return new dockspawn.HorizontalDockContainer(this.dockManager,[newNode.container,referenceNode.container]);if(containerType=="vertical")return new dockspawn.VerticalDockContainer(this.dockManager,[newNode.container,referenceNode.container]);if(containerType=="fill")return new dockspawn.FillDockContainer(this.dockManager);throw new dockspawn.Exception("Failed to create dock container of type: "+containerType);};dockspawn.DockLayoutEngine.prototype.getDockBounds=function(referenceNode,containerToDock,direction,insertBeforeReference){var compositeNode;var childCount;var childPosition;if(direction=="fill"){var targetElement=referenceNode.container.containerElement;var bounds=new Rectangle();bounds.x=targetElement.offsetLeft;bounds.y=targetElement.offsetTop;bounds.width=targetElement.clientWidth;bounds.height=targetElement.clientHeight;return bounds;}
if(referenceNode.parent&&referenceNode.parent.container.containerType=="fill")
referenceNode=referenceNode.parent;var hierarchyModified=false;if(referenceNode.parent&&referenceNode.parent.container.containerType==direction){compositeNode=referenceNode.parent;childCount=compositeNode.children.length;childPosition=compositeNode.children.indexOf(referenceNode)+(insertBeforeReference?0:1);}else{compositeNode=referenceNode;childCount=1;childPosition=insertBeforeReference?0:1;hierarchyModified=true;}
var splitBarSize=5;var targetPanelSize=0;var targetPanelStart=0;if(direction=="vertical"||direction=="horizontal"){var compositeSize=this._getVaringDimension(compositeNode.container,direction)-(childCount-1)*splitBarSize;var newPanelOriginalSize=this._getVaringDimension(containerToDock,direction);var scaleMultiplier=compositeSize/(compositeSize+newPanelOriginalSize);targetPanelSize=newPanelOriginalSize*scaleMultiplier;if(hierarchyModified)targetPanelStart=insertBeforeReference?0:compositeSize*scaleMultiplier;else{for(var i=0;i<childPosition;i++){targetPanelStart+=this._getVaringDimension(compositeNode.children[i].container,direction);}targetPanelStart*=scaleMultiplier;}}
var bounds=new Rectangle();if(direction=="vertical"){bounds.x=compositeNode.container.containerElement.offsetLeft;bounds.y=compositeNode.container.containerElement.offsetTop+targetPanelStart;bounds.width=compositeNode.container.width;bounds.height=targetPanelSize;}else if(direction=="horizontal"){bounds.x=compositeNode.container.containerElement.offsetLeft+targetPanelStart;bounds.y=compositeNode.container.containerElement.offsetTop;bounds.width=targetPanelSize;bounds.height=compositeNode.container.height;}
return bounds;};dockspawn.DockLayoutEngine.prototype._getVaringDimension=function(container,direction){if(direction=="vertical")return container.height;if(direction=="horizontal")return container.width;return 0;};dockspawn.DockManagerContext=function(dockManager){this.dockManager=dockManager;this.model=new dockspawn.DockModel();this.documentManagerView=new dockspawn.DocumentManagerContainer(this.dockManager);};dockspawn.DockModel=function(){this.rootNode=this.documentManagerNode=undefined;};dockspawn.DockNode=function(container){this.container=container;this.children=[];};dockspawn.DockNode.prototype.detachFromParent=function(){if(this.parent){this.parent.removeChild(this);delete this.parent;}};dockspawn.DockNode.prototype.removeChild=function(childNode){var index=this.children.indexOf(childNode);if(index>=0)this.children.splice(index,1);};dockspawn.DockNode.prototype.addChild=function(childNode){childNode.detachFromParent();childNode.parent=this;this.children.push(childNode);};dockspawn.DockNode.prototype.addChildBefore=function(referenceNode,childNode){this._addChildWithDirection(referenceNode,childNode,true);};dockspawn.DockNode.prototype.addChildAfter=function(referenceNode,childNode){this._addChildWithDirection(referenceNode,childNode,false);};dockspawn.DockNode.prototype._addChildWithDirection=function(referenceNode,childNode,before){childNode.detachFromParent();childNode.parent=this;var referenceIndex=this.children.indexOf(referenceNode);var preList=this.children.slice(0,referenceIndex);var postList=this.children.slice(referenceIndex+1,this.children.length);this.children=preList.slice(0);if(before){this.children.push(childNode);this.children.push(referenceNode);}else{this.children.push(referenceNode);this.children.push(childNode);}
Array.prototype.push.apply(this.children,postList);};dockspawn.DockNode.prototype.performLayout=function(){var childContainers=this.children.map(function(childNode){return childNode.container;});this.container.performLayout(childContainers);};dockspawn.DockNode.prototype.debug_DumpTree=function(indent){if(indent===undefined)indent=0;var message=this.container.name;for(var i=0;i<indent;i++){message="\t"+message;}var parentType=this.parent===undefined?"null":this.parent.container.containerType;console.log(">>"+message+" ["+parentType+"]");this.children.forEach(function(childNode){childNode.debug_DumpTree(indent+1);});};dockspawn.DockWheel=function(dockManager){this.dockManager=dockManager;this.elementMainWheel=document.createElement("div");this.elementSideWheel=document.createElement("div");this.wheelItems={};var wheelTypes=["left","right","top","down","fill","left-s","right-s","top-s","down-s"];var self=this;wheelTypes.forEach(function(wheelType){self.wheelItems[wheelType]=new DockWheelItem(self,wheelType);if(wheelType.substr(-2,2)=="-s")
self.elementSideWheel.appendChild(self.wheelItems[wheelType].element);else
self.elementMainWheel.appendChild(self.wheelItems[wheelType].element);});var zIndex=100000;this.elementMainWheel.classList.add("dock-wheel-base");this.elementSideWheel.classList.add("dock-wheel-base");this.elementMainWheel.style.zIndex=zIndex+1;this.elementSideWheel.style.zIndex=zIndex;this.elementPanelPreview=document.createElement("div");this.elementPanelPreview.classList.add("dock-wheel-panel-preview");this.elementPanelPreview.style.zIndex=zIndex-1;this.activeDialog=undefined;this._activeNode=undefined;this._visible=false;};Object.defineProperty(dockspawn.DockWheel.prototype,"activeNode",{get:function get(){return this._activeNode;},set:function set(value){var previousValue=this._activeNode;this._activeNode=value;if(previousValue!==this._activeNode){if(this._visible)this.showWheel();}}});dockspawn.DockWheel.prototype.showWheel=function(){this._visible=true;if(!this.activeNode){removeNode(this.elementMainWheel);removeNode(this.elementSideWheel);return;}
var element=this.activeNode.container.containerElement;var ignore=function(ele){return ele===this.dockManager.context.documentManagerView.element||ele===this.dockManager.context.model.rootNode.container.containerElement;}.call(this,element);removeNode(this.elementMainWheel);if(!ignore){var containerWidth=element.clientWidth;var containerHeight=element.clientHeight;var baseX=Math.floor(containerWidth/2)+element.offsetLeft;var baseY=Math.floor(containerHeight/2)+element.offsetTop;this.elementMainWheel.style.left=baseX+"px";this.elementMainWheel.style.top=baseY+"px";element.appendChild(this.elementMainWheel);}
var sideMargin=20;var dockManagerWidth=this.dockManager.element.clientWidth;var dockManagerHeight=this.dockManager.element.clientHeight;var dockManagerOffsetX=this.dockManager.element.offsetLeft;var dockManagerOffsetY=this.dockManager.element.offsetTop;removeNode(this.elementSideWheel);this.dockManager.element.appendChild(this.elementSideWheel);if(!ignore){this._setWheelButtonPosition("top-s",dockManagerWidth/2,-dockManagerHeight+sideMargin);this._setWheelButtonPosition("down-s",dockManagerWidth/2,-sideMargin);}else{removeNode(this.wheelItems['top-s'].element);removeNode(this.wheelItems['down-s'].element);}
this._setWheelButtonPosition("left-s",sideMargin,-dockManagerHeight/2);this._setWheelButtonPosition("right-s",dockManagerWidth-sideMargin*2,-dockManagerHeight/2);};dockspawn.DockWheel.prototype._setWheelButtonPosition=function(wheelId,left,top){var item=this.wheelItems[wheelId];var itemHalfWidth=item.element.clientWidth/2;var itemHalfHeight=item.element.clientHeight/2;var x=Math.floor(left-itemHalfWidth);var y=Math.floor(top-itemHalfHeight);item.element.style.marginLeft=x+"px";item.element.style.marginTop=y+"px";};dockspawn.DockWheel.prototype.hideWheel=function(){this._visible=false;this.activeNode=undefined;removeNode(this.elementMainWheel);removeNode(this.elementSideWheel);removeNode(this.elementPanelPreview);for(var wheelType in this.wheelItems){this.wheelItems[wheelType].active=false;}};dockspawn.DockWheel.prototype.onMouseOver=function(wheelItem,e){if(!this.activeDialog)return;var rootNode=this.dockManager.context.model.rootNode;var bounds;if(wheelItem.id=="top"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",true);}else if(wheelItem.id=="down"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",false);}else if(wheelItem.id=="left"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",true);}else if(wheelItem.id=="right"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",false);}else if(wheelItem.id=="fill"){bounds=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"fill",false);}else if(wheelItem.id=="top-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"vertical",true);}else if(wheelItem.id=="down-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"vertical",false);}else if(wheelItem.id=="left-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"horizontal",true);}else if(wheelItem.id=="right-s"){bounds=this.dockManager.layoutEngine.getDockBounds(rootNode,this.activeDialog.panel,"horizontal",false);}
if(bounds){this.dockManager.element.appendChild(this.elementPanelPreview);this.elementPanelPreview.style.left=Math.round(bounds.x)+"px";this.elementPanelPreview.style.top=Math.round(bounds.y)+"px";this.elementPanelPreview.style.width=Math.round(bounds.width)+"px";this.elementPanelPreview.style.height=Math.round(bounds.height)+"px";}};dockspawn.DockWheel.prototype.onMouseOut=function(wheelItem,e){removeNode(this.elementPanelPreview);};dockspawn.DockWheel.prototype.onDialogDropped=function(dialog){var wheelItem=this._getActiveWheelItem();if(wheelItem)this._handleDockRequest(wheelItem,dialog);};dockspawn.DockWheel.prototype._getActiveWheelItem=function(){for(var wheelType in this.wheelItems){var wheelItem=this.wheelItems[wheelType];if(wheelItem.active)return wheelItem;}
return undefined;};dockspawn.DockWheel.prototype._handleDockRequest=function(wheelItem,dialog){if(!this.activeNode)return;if(wheelItem.id=="left"){this.dockManager.dockDialogLeft(this.activeNode,dialog);}else if(wheelItem.id=="right"){this.dockManager.dockDialogRight(this.activeNode,dialog);}else if(wheelItem.id=="top"){this.dockManager.dockDialogUp(this.activeNode,dialog);}else if(wheelItem.id=="down"){this.dockManager.dockDialogDown(this.activeNode,dialog);}else if(wheelItem.id=="fill"){this.dockManager.dockDialogFill(this.activeNode,dialog);}else if(wheelItem.id=="left-s"){this.dockManager.dockDialogLeft(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="right-s"){this.dockManager.dockDialogRight(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="top-s"){this.dockManager.dockDialogUp(this.dockManager.context.model.rootNode,dialog);}else if(wheelItem.id=="down-s"){this.dockManager.dockDialogDown(this.dockManager.context.model.rootNode,dialog);}};function DockWheelItem(wheel,id){this.wheel=wheel;this.id=id;var wheelType=id.replace("-s","");this.element=document.createElement("div");this.element.classList.add("dock-wheel-item");this.element.classList.add("disable-selection");this.element.classList.add("dock-wheel-"+wheelType);this.element.classList.add("dock-wheel-"+wheelType+"-icon");this.hoverIconClass="dock-wheel-"+wheelType+"-icon-hover";this.mouseOverHandler=new dockspawn.EventHandler(this.element,'mouseover',this.onMouseMoved.bind(this));this.mouseOutHandler=new dockspawn.EventHandler(this.element,'mouseout',this.onMouseOut.bind(this));this.active=false;};DockWheelItem.prototype.onMouseMoved=function(e){this.active=true;this.element.classList.add(this.hoverIconClass);this.wheel.onMouseOver(this,e);};DockWheelItem.prototype.onMouseOut=function(e){this.active=false;this.element.classList.remove(this.hoverIconClass);this.wheel.onMouseOut(this,e);};dockspawn.FillDockContainer=function(dockManager,tabStripDirection){if(arguments.length==0)return;if(tabStripDirection===undefined)tabStripDirection=dockspawn.TabHost.DIRECTION_BOTTOM;this.dockManager=dockManager;this.tabOrientation=tabStripDirection;this.name=getNextId("fill_");this.element=document.createElement("div");this.containerElement=this.element;this.containerType="fill";this.minimumAllowedChildNodes=2;this.element.classList.add("dock-container");this.element.classList.add("dock-container-fill");this.tabHost=new dockspawn.TabHost(this.tabOrientation);this.element.appendChild(this.tabHost.hostElement);};dockspawn.FillDockContainer.prototype.setActiveChild=function(child){this.tabHost.setActiveTab(child);};dockspawn.FillDockContainer.prototype.resize=function(width,height){this.element.style.width=width+"px";this.element.style.height=height+"px";this.tabHost.resize(width,height);};dockspawn.FillDockContainer.prototype.performLayout=function(children){this.tabHost.performLayout(children);};dockspawn.FillDockContainer.prototype.destroy=function(){if(removeNode(this.element))delete this.element;};dockspawn.FillDockContainer.prototype.saveState=function(state){state.width=this.width;state.height=this.height;};dockspawn.FillDockContainer.prototype.loadState=function(state){this.width=state.width;this.height=state.height;};Object.defineProperty(dockspawn.FillDockContainer.prototype,"width",{get:function get(){return this.element.clientWidth;},set:function set(value){this.element.style.width=value+"px";}});Object.defineProperty(dockspawn.FillDockContainer.prototype,"height",{get:function get(){return this.element.clientHeight;},set:function set(value){this.element.style.height=value+"px";}});dockspawn.DocumentManagerContainer=function(dockManager){dockspawn.FillDockContainer.call(this,dockManager,dockspawn.TabHost.DIRECTION_TOP);this.minimumAllowedChildNodes=0;this.element.classList.add("document-manager");this.tabHost.createTabPage=this._createDocumentTabPage;this.tabHost.displayCloseButton=true;};dockspawn.DocumentManagerContainer.prototype=new dockspawn.FillDockContainer();dockspawn.DocumentManagerContainer.prototype.constructor=dockspawn.DocumentManagerContainer;dockspawn.DocumentManagerContainer.prototype._createDocumentTabPage=function(tabHost,container){return new dockspawn.DocumentTabPage(tabHost,container);};dockspawn.DocumentManagerContainer.prototype.saveState=function(state){dockspawn.FillDockContainer.prototype.saveState.call(this,state);state.documentManager=true;};dockspawn.DocumentManagerContainer.prototype.selectedTab=function(){return this.tabHost.activeTab;};dockspawn.DocumentTabPage=function(host,container){dockspawn.TabPage.call(this,host,container);if(this.container.containerType=="panel"){this.panel=container;this.containerElement=this.panel.elementContent;removeNode(this.containerElement);}};dockspawn.DocumentTabPage.prototype=new dockspawn.TabPage();dockspawn.DocumentTabPage.prototype.constructor=dockspawn.DocumentTabPage;dockspawn.DocumentTabPage.prototype.destroy=function(){dockspawn.TabPage.prototype.destroy.call(this);removeNode(this.containerElement);this.panel.elementContentHost.appendChild(this.containerElement);};dockspawn.SplitterPanel=function(childContainers,stackedVertical){this.childContainers=childContainers;this.stackedVertical=stackedVertical;this.panelElement=document.createElement('div');this.spiltterBars=[];this._buildSplitterDOM();};dockspawn.SplitterPanel.prototype._buildSplitterDOM=function(){if(this.childContainers.length<=1)throw new dockspawn.Exception("Splitter panel should contain atleast 2 panels");this.spiltterBars=[];for(var i=0;i<this.childContainers.length-1;i++){var previousContainer=this.childContainers[i];var nextContainer=this.childContainers[i+1];var splitterBar=new dockspawn.SplitterBar(previousContainer,nextContainer,this.stackedVertical);this.spiltterBars.push(splitterBar);this._insertContainerIntoPanel(previousContainer);this.panelElement.appendChild(splitterBar.barElement);}
this._insertContainerIntoPanel(this.childContainers.slice(-1)[0]);};dockspawn.SplitterPanel.prototype.performLayout=function(children){this.removeFromDOM();this.childContainers=children;this._buildSplitterDOM();};dockspawn.SplitterPanel.prototype.removeFromDOM=function(){this.childContainers.forEach(function(container){if(container.containerElement){container.containerElement.classList.remove("splitter-container-vertical");container.containerElement.classList.remove("splitter-container-horizontal");removeNode(container.containerElement);}});this.spiltterBars.forEach(function(bar){removeNode(bar.barElement);});};dockspawn.SplitterPanel.prototype.destroy=function(){this.removeFromDOM();this.panelElement.parentNode.removeChild(this.panelElement);};dockspawn.SplitterPanel.prototype._insertContainerIntoPanel=function(container){if(!container){console.log('undefined');}
removeNode(container.containerElement);this.panelElement.appendChild(container.containerElement);container.containerElement.classList.add(this.stackedVertical?"splitter-container-vertical":"splitter-container-horizontal");};dockspawn.SplitterPanel.prototype.setContainerRatio=function(container,ratio){var splitPanelSize=this.stackedVertical?this.panelElement.clientHeight:this.panelElement.clientWidth;var newContainerSize=ratio>1?ratio:splitPanelSize*ratio;var barSize=this.stackedVertical?this.spiltterBars[0].barElement.clientHeight:this.spiltterBars[0].barElement.clientWidth;var otherPanelSizeQuota=splitPanelSize-newContainerSize-barSize*this.spiltterBars.length;var otherPanelScaleMultipler=otherPanelSizeQuota/splitPanelSize;for(var i=0;i<this.childContainers.length;i++){var child=this.childContainers[i];var size;if(child!==container){size=this.stackedVertical?child.containerElement.clientHeight:child.containerElement.clientWidth;size*=otherPanelScaleMultipler;}else size=newContainerSize;if(this.stackedVertical)child.resize(child.width,Math.floor(size));else child.resize(Math.floor(size),child.height);}};dockspawn.SplitterPanel.prototype.resize=function(width,height){if(this.childContainers.length<=1)return;for(var i=0;i<this.childContainers.length;i++){var childContainer=this.childContainers[i];if(this.stackedVertical)childContainer.resize(width,childContainer.height);else childContainer.resize(childContainer.width,height);if(i<this.spiltterBars.length){var splitBar=this.spiltterBars[i];if(this.stackedVertical)splitBar.barElement.style.width=width+"px";else splitBar.barElement.style.height=height+"px";}}
var totalChildPanelSize=0;var self=this;this.childContainers.forEach(function(container){var size=self.stackedVertical?container.height:container.width;totalChildPanelSize+=size;});var barSize=this.stackedVertical?this.spiltterBars[0].barElement.getBoundingClientRect().height:this.spiltterBars[0].barElement.getBoundingClientRect().width;var targetTotalChildPanelSize=this.stackedVertical?height:width;targetTotalChildPanelSize-=barSize*this.spiltterBars.length;totalChildPanelSize=Math.max(totalChildPanelSize,1);var scaleMultiplier=targetTotalChildPanelSize/totalChildPanelSize;var updatedTotalChildPanelSize=0;for(var i=0;i<this.childContainers.length;i++){var child=this.childContainers[i];var original=this.stackedVertical?child.containerElement.clientHeight:child.containerElement.clientWidth;var newSize=Math.floor(original*scaleMultiplier);updatedTotalChildPanelSize+=newSize;if(i==this.childContainers.length-1)newSize+=targetTotalChildPanelSize-updatedTotalChildPanelSize;if(this.stackedVertical)child.resize(child.width,newSize);else child.resize(newSize,child.height);}
this.panelElement.style.width=width+"px";this.panelElement.style.height=height+"px";};dockspawn.SplitterDockContainer=function(name,dockManager,childContainers){if(arguments.length==0)return;this.name=name;this.dockManager=dockManager;this.splitterPanel=new dockspawn.SplitterPanel(childContainers,this.stackedVertical);this.containerElement=this.splitterPanel.panelElement;this.minimumAllowedChildNodes=2;};dockspawn.SplitterDockContainer.prototype.resize=function(width,height){this.splitterPanel.resize(width,height);this._cachedWidth=width;this._cachedHeight=height;};dockspawn.SplitterDockContainer.prototype.performLayout=function(childContainers){this.splitterPanel.performLayout(childContainers);};dockspawn.SplitterDockContainer.prototype.setActiveChild=function(child){};dockspawn.SplitterDockContainer.prototype.destroy=function(){this.splitterPanel.destroy();};dockspawn.SplitterDockContainer.prototype.setContainerRatio=function(container,ratio){this.splitterPanel.setContainerRatio(container,ratio);this.resize(this.width,this.height);};dockspawn.SplitterDockContainer.prototype.saveState=function(state){state.width=this.width;state.height=this.height;};dockspawn.SplitterDockContainer.prototype.loadState=function(state){this.resize(state.width,state.height);};Object.defineProperty(dockspawn.SplitterDockContainer.prototype,"width",{get:function get(){if(this._cachedWidth===undefined)this._cachedWidth=this.splitterPanel.panelElement.clientWidth;return this._cachedWidth;}});Object.defineProperty(dockspawn.SplitterDockContainer.prototype,"height",{get:function get(){if(this._cachedHeight===undefined)this._cachedHeight=this.splitterPanel.panelElement.clientHeight;return this._cachedHeight;}});dockspawn.HorizontalDockContainer=function(dockManager,childContainers){this.stackedVertical=false;dockspawn.SplitterDockContainer.call(this,getNextId("horizontal_splitter_"),dockManager,childContainers);this.containerType="horizontal";};dockspawn.HorizontalDockContainer.prototype=new dockspawn.SplitterDockContainer();dockspawn.HorizontalDockContainer.prototype.constructor=dockspawn.HorizontalDockContainer;dockspawn.PanelContainer=function(elementContent,dockManager,title){if(!title)title="Panel";this.elementContent=elementContent;this.dockManager=dockManager;this.title=title;this.containerType="panel";this.iconName="icon-circle-arrow-right";this.minimumAllowedChildNodes=0;this._floatingDialog=undefined;this._initialize();};Object.defineProperty(dockspawn.PanelContainer.prototype,"floatingDialog",{get:function get(){return this._floatingDialog;},set:function set(value){this._floatingDialog=value;var canUndock=this._floatingDialog===undefined;this.undockInitiator.enabled=canUndock;}});dockspawn.PanelContainer.loadFromState=function(state,dockManager){var elementName=state.element;var elementContent=document.getElementById(elementName);var ret=new dockspawn.PanelContainer(elementContent,dockManager);ret.elementContent=elementContent;ret._initialize();ret.loadState(state);return ret;};dockspawn.PanelContainer.prototype.saveState=function(state){state.element=this.elementContent.id;state.width=this.width;state.height=this.height;};dockspawn.PanelContainer.prototype.loadState=function(state){this.width=state.width;this.height=state.height;this.resize(this.width,this.height);};dockspawn.PanelContainer.prototype.setActiveChild=function(child){};Object.defineProperty(dockspawn.PanelContainer.prototype,"containerElement",{get:function get(){return this.elementPanel;}});dockspawn.PanelContainer.prototype._initialize=function(){this.name=getNextId("panel_");this.elementPanel=document.createElement('div');this.elementTitle=document.createElement('div');this.elementTitleText=document.createElement('div');this.elementContentHost=document.createElement('div');this.elementButtonClose=document.createElement('div');this.elementPanel.appendChild(this.elementTitle);this.elementTitle.appendChild(this.elementTitleText);this.elementTitle.appendChild(this.elementButtonClose);this.elementButtonClose.innerHTML='<i class="glyphicon glyphicon-remove"></i>';this.elementButtonClose.classList.add("panel-titlebar-button-close");this.elementPanel.appendChild(this.elementContentHost);this.elementPanel.classList.add("panel-base");this.elementTitle.classList.add("panel-titlebar");this.elementTitle.classList.add("disable-selection");this.elementTitleText.classList.add("panel-titlebar-text");this.elementContentHost.classList.add("panel-content");var panelWidth=this.elementContent.clientWidth;var panelHeight=this.elementContent.clientHeight;var titleHeight=this.elementTitle.clientHeight;this._setPanelDimensions(panelWidth,panelHeight+titleHeight);document.body.appendChild(this.elementPanel);this.closeButtonClickedHandler=new dockspawn.EventHandler(this.elementButtonClose,'click',this.onCloseButtonClicked.bind(this));removeNode(this.elementContent);this.elementContentHost.appendChild(this.elementContent);var contentTitle=this.elementContent.getAttribute('caption');var contentIcon=this.elementContent.getAttribute('icon');if(contentTitle!=null)this.title=contentTitle;if(contentIcon!=null)this.iconName=contentIcon;this._updateTitle();this.undockInitiator=new dockspawn.UndockInitiator(this.elementTitle,this.performUndockToDialog.bind(this));this.floatingDialog=undefined;};dockspawn.PanelContainer.prototype.destroy=function(){removeNode(this.elementPanel);if(this.closeButtonClickedHandler){this.closeButtonClickedHandler.cancel();delete this.closeButtonClickedHandler;}};dockspawn.PanelContainer.prototype.performUndockToDialog=function(e,dragOffset){this.undockInitiator.enabled=false;return this.dockManager.requestUndockToDialog(this,e,dragOffset);};dockspawn.PanelContainer.prototype.performUndock=function(){this.undockInitiator.enabled=false;this.dockManager.requestUndock(this);};dockspawn.PanelContainer.prototype.prepareForDocking=function(){this.undockInitiator.enabled=true;};Object.defineProperty(dockspawn.PanelContainer.prototype,"width",{get:function get(){return this._cachedWidth;},set:function set(value){if(value!==this._cachedWidth){this._cachedWidth=value;this.elementPanel.style.width=value+"px";}}});Object.defineProperty(dockspawn.PanelContainer.prototype,"height",{get:function get(){return this._cachedHeight;},set:function set(value){if(value!==this._cachedHeight){this._cachedHeight=value;this.elementPanel.style.height=value+"px";}}});dockspawn.PanelContainer.prototype.resize=function(width,height){if(this._cachedWidth==width&&this._cachedHeight==height){return;}
this._setPanelDimensions(width,height);this._cachedWidth=width;this._cachedHeight=height;};dockspawn.PanelContainer.prototype._setPanelDimensions=function(width,height){this.elementTitle.style.width=width+"px";this.elementContentHost.style.width=width+"px";this.elementContent.style.width=width+"px";this.elementPanel.style.width=width+"px";var titleBarHeight=this.elementTitle.clientHeight;var contentHeight=height-titleBarHeight;this.elementContentHost.style.height=contentHeight+"px";this.elementContent.style.height=contentHeight+"px";this.elementPanel.style.height=height+"px";};dockspawn.PanelContainer.prototype.setTitle=function(title){this.title=title;this._updateTitle();if(this.onTitleChanged)this.onTitleChanged(this,title);};dockspawn.PanelContainer.prototype.setTitleIcon=function(iconName){this.iconName=iconName;this._updateTitle();};dockspawn.PanelContainer.prototype._updateTitle=function(){this.elementTitleText.innerHTML='<i class="'+this.iconName+'"></i> '+this.title;};dockspawn.PanelContainer.prototype.getRawTitle=function(){return this.elementTitleText.innerHTML;};dockspawn.PanelContainer.prototype.performLayout=function(children){};dockspawn.PanelContainer.prototype.onCloseButtonClicked=function(e){if(this.floatingDialog)this.floatingDialog.destroy();else{this.performUndock();this.destroy();}};dockspawn.VerticalDockContainer=function(dockManager,childContainers){this.stackedVertical=true;dockspawn.SplitterDockContainer.call(this,getNextId("vertical_splitter_"),dockManager,childContainers);this.containerType="vertical";};dockspawn.VerticalDockContainer.prototype=new dockspawn.SplitterDockContainer();dockspawn.VerticalDockContainer.prototype.constructor=dockspawn.VerticalDockContainer;dockspawn.SplitterBar=function(previousContainer,nextContainer,stackedVertical){this.previousContainer=previousContainer;this.nextContainer=nextContainer;this.stackedVertical=stackedVertical;this.barElement=document.createElement('div');this.barElement.classList.add(stackedVertical?"splitbar-horizontal":"splitbar-vertical");this.mouseDownHandler=new dockspawn.EventHandler(this.barElement,'mousedown',this.onMouseDown.bind(this));this.minPanelSize=50;this.readyToProcessNextDrag=true;};dockspawn.SplitterBar.prototype.onMouseDown=function(e){this._startDragging(e);};dockspawn.SplitterBar.prototype.onMouseUp=function(e){this._stopDragging(e);};dockspawn.SplitterBar.prototype.onMouseMoved=function(e){if(!this.readyToProcessNextDrag)return;this.readyToProcessNextDrag=false;var dockManager=this.previousContainer.dockManager;dockManager.suspendLayout();var dx=e.pageX-this.previousMouseEvent.pageX;var dy=e.pageY-this.previousMouseEvent.pageY;this._performDrag(dx,dy);this.previousMouseEvent=e;this.readyToProcessNextDrag=true;dockManager.resumeLayout();};dockspawn.SplitterBar.prototype._performDrag=function(dx,dy){var previousWidth=this.previousContainer.containerElement.clientWidth;var previousHeight=this.previousContainer.containerElement.clientHeight;var nextWidth=this.nextContainer.containerElement.clientWidth;var nextHeight=this.nextContainer.containerElement.clientHeight;var previousPanelSize=this.stackedVertical?previousHeight:previousWidth;var nextPanelSize=this.stackedVertical?nextHeight:nextWidth;var deltaMovement=this.stackedVertical?dy:dx;var newPreviousPanelSize=previousPanelSize+deltaMovement;var newNextPanelSize=nextPanelSize-deltaMovement;if(newPreviousPanelSize<this.minPanelSize||newNextPanelSize<this.minPanelSize){var continueProcessing=newPreviousPanelSize<this.minPanelSize&&newPreviousPanelSize>previousPanelSize||newNextPanelSize<this.minPanelSize&&newNextPanelSize>nextPanelSize;if(!continueProcessing)return;}
if(this.stackedVertical){this.previousContainer.resize(previousWidth,newPreviousPanelSize);this.nextContainer.resize(nextWidth,newNextPanelSize);}else{this.previousContainer.resize(newPreviousPanelSize,previousHeight);this.nextContainer.resize(newNextPanelSize,nextHeight);}};dockspawn.SplitterBar.prototype._startDragging=function(e){disableGlobalTextSelection();if(this.mouseMovedHandler){this.mouseMovedHandler.cancel();delete this.mouseMovedHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
this.mouseMovedHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMoved.bind(this));this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));this.previousMouseEvent=e;};dockspawn.SplitterBar.prototype._stopDragging=function(e){enableGlobalTextSelection();document.body.classList.remove("disable-selection");if(this.mouseMovedHandler){this.mouseMovedHandler.cancel();delete this.mouseMovedHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}};dockspawn.DockGraphDeserializer=function(dockManager){this.dockManager=dockManager;};dockspawn.DockGraphDeserializer.prototype.deserialize=function(json){var graphInfo=JSON.parse(_json);var model=new dockspawn.DockModel();model.rootNode=this._buildGraph(graphInfo);return model;};dockspawn.DockGraphDeserializer.prototype._buildGraph=function(nodeInfo){var childrenInfo=nodeInfo.children;var children=[];var self=this;childrenInfo.forEach(function(childInfo){var childNode=self._buildGraph(childInfo);children.push(childNode);});var container=this._createContainer(nodeInfo,children);var node=new dockspawn.DockNode(container);node.children=children;node.children.forEach(function(childNode){childNode.parent=node;});return node;};dockspawn.DockGraphDeserializer.prototype._createContainer=function(nodeInfo,children){var containerType=nodeInfo.containerType;var containerState=nodeInfo.state;var container;var childContainers=[];children.forEach(function(childNode){childContainers.push(childNode.container);});childContainers=[];if(containerType=="panel")container=new dockspawn.PanelContainer.loadFromState(containerState,this.dockManager);else if(containerType=="horizontal")container=new dockspawn.HorizontalDockContainer(this.dockManager,childContainers);else if(containerType=="vertical")container=new dockspawn.VerticalDockContainer(this.dockManager,childContainers);else if(containerType=="fill"){var typeDocumentManager=containerState.documentManager;if(typeDocumentManager)container=new DocumentManagerContainer(this.dockManager);else container=new dockspawn.FillDockContainer(this.dockManager);}else throw new dockspawn.Exception("Cannot create dock container of unknown type: "+containerType);container.loadState(containerState);container.performLayout(childContainers);return container;};dockspawn.DockGraphSerializer=function(){};dockspawn.DockGraphSerializer.prototype.serialize=function(model){var graphInfo=this._buildGraphInfo(model.rootNode);return JSON.stringify(graphInfo);};dockspawn.DockGraphSerializer.prototype._buildGraphInfo=function(node){var nodeState={};node.container.saveState(nodeState);var childrenInfo=[];var self=this;node.childNodes.forEach(function(childNode){childrenInfo.push(self._buildGraphInfo(childNode));});var nodeInfo={};nodeInfo.containerType=node.container.containerType;nodeInfo.state=nodeState;nodeInfo.children=childrenInfo;return nodeInfo;};function getPixels(pixels){if(pixels==null)return 0;return parseInt(pixels.replace("px",""));}
function disableGlobalTextSelection(){document.body.classList.add("disable-selection");}
function enableGlobalTextSelection(){document.body.classList.remove("disable-selection");}
function isPointInsideNode(px,py,node){var element=node.container.containerElement;var x=element.offsetLeft;var y=element.offsetTop;var width=element.clientWidth;var height=element.clientHeight;return px>=x&&px<=x+width&&py>=y&&py<=y+height;}
function Rectangle(){}
function getNextId(prefix){return prefix+getNextId.counter++;}
getNextId.counter=0;function removeNode(node){if(node.parentNode==null)return false;node.parentNode.removeChild(node);return true;}
function Point(x,y){this.x=x;this.y=y;}
dockspawn.EventHandler=function(source,eventName,target){this.target=target;this.eventName=eventName;this.source=source;this.source.addEventListener(eventName,this.target);};dockspawn.EventHandler.prototype.cancel=function(){this.source.removeEventListener(this.eventName,this.target);};dockspawn.UndockInitiator=function(element,listener,thresholdPixels){if(!thresholdPixels)thresholdPixels=10;this.element=element;this.listener=listener;this.thresholdPixels=thresholdPixels;this._enabled=false;};Object.defineProperty(dockspawn.UndockInitiator.prototype,"enabled",{get:function get(){return this._enabled;},set:function set(value){this._enabled=value;if(this._enabled){if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
this.mouseDownHandler=new dockspawn.EventHandler(this.element,'mousedown',this.onMouseDown.bind(this));}else{if(this.mouseDownHandler){this.mouseDownHandler.cancel();delete this.mouseDownHandler;}
if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}}}});dockspawn.UndockInitiator.prototype.onMouseDown=function(e){if(this.enabled){if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}
this.mouseUpHandler=new dockspawn.EventHandler(window,'mouseup',this.onMouseUp.bind(this));this.mouseMoveHandler=new dockspawn.EventHandler(window,'mousemove',this.onMouseMove.bind(this));this.dragStartPosition=new Point(e.pageX,e.pageY);}};dockspawn.UndockInitiator.prototype.onMouseUp=function(e){if(this.mouseUpHandler){this.mouseUpHandler.cancel();delete this.mouseUpHandler;}
if(this.mouseMoveHandler){this.mouseMoveHandler.cancel();delete this.mouseMoveHandler;}};dockspawn.UndockInitiator.prototype.onMouseMove=function(e){var position=new Point(e.pageX,e.pageY);var dx=position.x-this.dragStartPosition.x;var dy=position.y-this.dragStartPosition.y;var distance=Math.sqrt(dx*dx+dy*dy);if(distance>this.thresholdPixels){this.enabled=false;this._requestUndock(e);}};dockspawn.UndockInitiator.prototype._requestUndock=function(e){var dragOffsetX=this.dragStartPosition.x-this.element.offsetLeft;var dragOffsetY=this.dragStartPosition.y-this.element.offsetTop;var dragOffset=new Point(dragOffsetX,dragOffsetY);this.listener(e,dragOffset);};})();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(q){var I,J,K,L,M,N,v,s={},w={},x={},O={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(b){var a=b.treeObj,c=f.event;a.bind(c.NODECREATED,function(a,c,g){j.apply(b.callback.onNodeCreated,[a,c,g]);});a.bind(c.CLICK,function(a,c,g,m,h){j.apply(b.callback.onClick,[c,g,m,h]);});a.bind(c.EXPAND,function(a,c,g){j.apply(b.callback.onExpand,[a,c,g]);});a.bind(c.COLLAPSE,function(a,c,g){j.apply(b.callback.onCollapse,[a,c,g]);});a.bind(c.ASYNC_SUCCESS,function(a,c,g,h){j.apply(b.callback.onAsyncSuccess,[a,c,g,h]);});a.bind(c.ASYNC_ERROR,function(a,c,g,h,f,i){j.apply(b.callback.onAsyncError,[a,c,g,h,f,i]);});a.bind(c.REMOVE,function(a,c,g){j.apply(b.callback.onRemove,[a,c,g]);});a.bind(c.SELECTED,function(a,c,g){j.apply(b.callback.onSelected,[c,g]);});a.bind(c.UNSELECTED,function(a,c,g){j.apply(b.callback.onUnSelected,[c,g]);});}],z=[function(b){var a=f.event;b.treeObj.unbind(a.NODECREATED).unbind(a.CLICK).unbind(a.EXPAND).unbind(a.COLLAPSE).unbind(a.ASYNC_SUCCESS).unbind(a.ASYNC_ERROR).unbind(a.REMOVE).unbind(a.SELECTED).unbind(a.UNSELECTED);}],A=[function(b){var a=h.getCache(b);a||(a={},h.setCache(b,a));a.nodes=[];a.doms=[];}],B=[function(b,a,c,d,e,g){if(c){var m=h.getRoot(b),f=b.data.key.children;c.level=a;c.tId=b.treeId+"_"+ ++m.zId;c.parentTId=d?d.tId:null;c.open=typeof c.open=="string"?j.eqs(c.open,"true"):!!c.open;c[f]&&c[f].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent=typeof c.isParent=="string"?j.eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!b.async.enable?c.open:!1,c.zAsync=!c.isParent);c.isFirstNode=e;c.isLastNode=g;c.getParentNode=function(){return h.getNodeCache(b,c.parentTId);};c.getPreNode=function(){return h.getPreNode(b,c);};c.getNextNode=function(){return h.getNextNode(b,c);};c.getIndex=function(){return h.getNodeIndex(b,c);};c.getPath=function(){return h.getNodePath(b,c);};c.isAjaxing=!1;h.fixPIdKeyValue(b,c);}}],u=[function(b){var a=b.target,c=h.getSetting(b.data.treeId),d="",e=null,g="",m="",i=null,n=null,k=null;if(j.eqs(b.type,"mousedown"))m="mousedown";else if(j.eqs(b.type,"mouseup"))m="mouseup";else if(j.eqs(b.type,"contextmenu"))m="contextmenu";else if(j.eqs(b.type,"click")){if(j.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+f.id.SWITCH)!==null)d=j.getNodeMainDom(a).id,g="switchNode";else{if(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}]))d=j.getNodeMainDom(k).id,g="clickNode";}}else if(j.eqs(b.type,"dblclick")&&(m="dblclick",k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id,g="switchNode";if(m.length>0&&d.length==0&&(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id;if(d.length>0)switch(e=h.getNodeCache(c,d),g){case"switchNode":e.isParent?j.eqs(b.type,"click")||j.eqs(b.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand)?i=I:g="":g="";break;case"clickNode":i=J;}switch(m){case"mousedown":n=K;break;case"mouseup":n=L;break;case"dblclick":n=M;break;case"contextmenu":n=N;}return{stop:!1,node:e,nodeEventType:g,nodeEventCallback:i,treeEventType:m,treeEventCallback:n};}],C=[function(b){var a=h.getRoot(b);a||(a={},h.setRoot(b,a));a[b.data.key.children]=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[];a.zId=0;a._ver=new Date().getTime();}],D=[],E=[],F=[],G=[],H=[],h={addNodeCache:function addNodeCache(b,a){h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=a;},getNodeCacheId:function getNodeCacheId(b){return b.substring(b.lastIndexOf("_")+1);},addAfterA:function addAfterA(b){E.push(b);},addBeforeA:function addBeforeA(b){D.push(b);},addInnerAfterA:function addInnerAfterA(b){G.push(b);},addInnerBeforeA:function addInnerBeforeA(b){F.push(b);},addInitBind:function addInitBind(b){y.push(b);},addInitUnBind:function addInitUnBind(b){z.push(b);},addInitCache:function addInitCache(b){A.push(b);},addInitNode:function addInitNode(b){B.push(b);},addInitProxy:function addInitProxy(b,a){a?u.splice(0,0,b):u.push(b);},addInitRoot:function addInitRoot(b){C.push(b);},addNodesData:function addNodesData(b,a,c,d){var e=b.data.key.children;a[e]?c>=a[e].length&&(c=-1):(a[e]=[],c=-1);if(a[e].length>0&&c===0)a[e][0].isFirstNode=!1,i.setNodeLineIcos(b,a[e][0]);else if(a[e].length>0&&c<0)a[e][a[e].length-1].isLastNode=!1,i.setNodeLineIcos(b,a[e][a[e].length-1]);a.isParent=!0;c<0?a[e]=a[e].concat(d):(b=[c,0].concat(d),a[e].splice.apply(a[e],b));},addSelectedNode:function addSelectedNode(b,a){var c=h.getRoot(b);h.isSelectedNode(b,a)||c.curSelectedList.push(a);},addCreatedNode:function addCreatedNode(b,a){(b.callback.onNodeCreated||b.view.addDiyDom)&&h.getRoot(b).createdNodes.push(a);},addZTreeTools:function addZTreeTools(b){H.push(b);},exSetting:function exSetting(b){q.extend(!0,O,b);},fixPIdKeyValue:function fixPIdKeyValue(b,a){b.data.simpleData.enable&&(a[b.data.simpleData.pIdKey]=a.parentTId?a.getParentNode()[b.data.simpleData.idKey]:b.data.simpleData.rootPId);},getAfterA:function getAfterA(b,a,c){for(var d=0,e=E.length;d<e;d++){E[d].apply(this,arguments);}},getBeforeA:function getBeforeA(b,a,c){for(var d=0,e=D.length;d<e;d++){D[d].apply(this,arguments);}},getInnerAfterA:function getInnerAfterA(b,a,c){for(var d=0,e=G.length;d<e;d++){G[d].apply(this,arguments);}},getInnerBeforeA:function getInnerBeforeA(b,a,c){for(var d=0,e=F.length;d<e;d++){F[d].apply(this,arguments);}},getCache:function getCache(b){return x[b.treeId];},getNodeIndex:function getNodeIndex(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e;}return-1;},getNextNode:function getNextNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e==g?null:d[c][e+1];}return null;},getNodeByParam:function getNodeByParam(b,a,c,d){if(!a||!c)return null;for(var e=b.data.key.children,g=0,f=a.length;g<f;g++){if(a[g][c]==d)return a[g];var i=h.getNodeByParam(b,a[g][e],c,d);if(i)return i;}return null;},getNodeCache:function getNodeCache(b,a){if(!a)return null;var c=x[b.treeId].nodes[h.getNodeCacheId(a)];return c?c:null;},getNodeName:function getNodeName(b,a){return""+a[b.data.key.name];},getNodePath:function getNodePath(b,a){if(!a)return null;var c;(c=a.parentTId?a.getParentNode().getPath():[])&&c.push(a);return c;},getNodeTitle:function getNodeTitle(b,a){return""+a[b.data.key.title===""?b.data.key.name:b.data.key.title];},getNodes:function getNodes(b){return h.getRoot(b)[b.data.key.children];},getNodesByParam:function getNodesByParam(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],f=0,i=a.length;f<i;f++){a[f][c]==d&&g.push(a[f]),g=g.concat(h.getNodesByParam(b,a[f][e],c,d));}return g;},getNodesByParamFuzzy:function getNodesByParamFuzzy(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],d=d.toLowerCase(),f=0,i=a.length;f<i;f++){typeof a[f][c]=="string"&&a[f][c].toLowerCase().indexOf(d)>-1&&g.push(a[f]),g=g.concat(h.getNodesByParamFuzzy(b,a[f][e],c,d));}return g;},getNodesByFilter:function getNodesByFilter(b,a,c,d,e){if(!a)return d?null:[];for(var g=b.data.key.children,f=d?null:[],i=0,n=a.length;i<n;i++){if(j.apply(c,[a[i],e],!1)){if(d)return a[i];f.push(a[i]);}var k=h.getNodesByFilter(b,a[i][g],c,d,e);if(d&&k)return k;f=d?k:f.concat(k);}return f;},getPreNode:function getPreNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length;e<g;e++){if(d[c][e]===a)return e==0?null:d[c][e-1];}return null;},getRoot:function getRoot(b){return b?w[b.treeId]:null;},getRoots:function getRoots(){return w;},getSetting:function getSetting(b){return s[b];},getSettings:function getSettings(){return s;},getZTreeTools:function getZTreeTools(b){return(b=this.getRoot(this.getSetting(b)))?b.treeTools:null;},initCache:function initCache(b){for(var a=0,c=A.length;a<c;a++){A[a].apply(this,arguments);}},initNode:function initNode(b,a,c,d,e,g){for(var f=0,h=B.length;f<h;f++){B[f].apply(this,arguments);}},initRoot:function initRoot(b){for(var a=0,c=C.length;a<c;a++){C[a].apply(this,arguments);}},isSelectedNode:function isSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d])return!0;}return!1;},removeNodeCache:function removeNodeCache(b,a){var c=b.data.key.children;if(a[c])for(var d=0,e=a[c].length;d<e;d++){arguments.callee(b,a[c][d]);}h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=null;},removeSelectedNode:function removeSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d]||!h.getNodeCache(b,c.curSelectedList[d].tId))c.curSelectedList.splice(d,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,a]),d--,e--;}},setCache:function setCache(b,a){x[b.treeId]=a;},setRoot:function setRoot(b,a){w[b.treeId]=a;},setZTreeTools:function setZTreeTools(b,a){for(var c=0,d=H.length;c<d;c++){H[c].apply(this,arguments);}},transformToArrayFormat:function transformToArrayFormat(b,a){if(!a)return[];var c=b.data.key.children,d=[];if(j.isArray(a))for(var e=0,g=a.length;e<g;e++){d.push(a[e]),a[e][c]&&(d=d.concat(h.transformToArrayFormat(b,a[e][c])));}else d.push(a),a[c]&&(d=d.concat(h.transformToArrayFormat(b,a[c])));return d;},transformTozTreeFormat:function transformTozTreeFormat(b,a){var c,d,e=b.data.simpleData.idKey,g=b.data.simpleData.pIdKey,f=b.data.key.children;if(!e||e==""||!a)return[];if(j.isArray(a)){var h=[],i=[];for(c=0,d=a.length;c<d;c++){i[a[c][e]]=a[c];}for(c=0,d=a.length;c<d;c++){i[a[c][g]]&&a[c][e]!=a[c][g]?(i[a[c][g]][f]||(i[a[c][g]][f]=[]),i[a[c][g]][f].push(a[c])):h.push(a[c]);}return h;}else return[a];}},l={bindEvent:function bindEvent(b){for(var a=0,c=y.length;a<c;a++){y[a].apply(this,arguments);}},unbindEvent:function unbindEvent(b){for(var a=0,c=z.length;a<c;a++){z[a].apply(this,arguments);}},bindTree:function bindTree(b){var a={treeId:b.treeId},c=b.treeObj;b.view.txtSelectedEnable||c.bind("selectstart",v).css({"-moz-user-select":"-moz-none"});c.bind("click",a,l.proxy);c.bind("dblclick",a,l.proxy);c.bind("mouseover",a,l.proxy);c.bind("mouseout",a,l.proxy);c.bind("mousedown",a,l.proxy);c.bind("mouseup",a,l.proxy);c.bind("contextmenu",a,l.proxy);},unbindTree:function unbindTree(b){b.treeObj.unbind("selectstart",v).unbind("click",l.proxy).unbind("dblclick",l.proxy).unbind("mouseover",l.proxy).unbind("mouseout",l.proxy).unbind("mousedown",l.proxy).unbind("mouseup",l.proxy).unbind("contextmenu",l.proxy);},doProxy:function doProxy(b){for(var a=[],c=0,d=u.length;c<d;c++){var e=u[c].apply(this,arguments);a.push(e);if(e.stop)break;}return a;},proxy:function proxy(b){var a=h.getSetting(b.data.treeId);if(!j.uCanDo(a,b))return!0;for(var a=l.doProxy(b),c=!0,d=0,e=a.length;d<e;d++){var g=a[d];g.nodeEventCallback&&(c=g.nodeEventCallback.apply(g,[b,g.node])&&c);g.treeEventCallback&&(c=g.treeEventCallback.apply(g,[b,g.node])&&c);}return c;}};I=function I(b,a){var c=h.getSetting(b.data.treeId);if(a.open){if(j.apply(c.callback.beforeCollapse,[c.treeId,a],!0)==!1)return!0;}else if(j.apply(c.callback.beforeExpand,[c.treeId,a],!0)==!1)return!0;h.getRoot(c).expandTriggerFlag=!0;i.switchNode(c,a);return!0;};J=function J(b,a){var c=h.getSetting(b.data.treeId),d=c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&h.isSelectedNode(c,a)?0:c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&c.view.selectedMulti?2:1;if(j.apply(c.callback.beforeClick,[c.treeId,a,d],!0)==!1)return!0;d===0?i.cancelPreSelectedNode(c,a):i.selectNode(c,a,d===2);c.treeObj.trigger(f.event.CLICK,[b,c.treeId,a,d]);return!0;};K=function K(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseDown,[c.treeId,a],!0)&&j.apply(c.callback.onMouseDown,[b,c.treeId,a]);return!0;};L=function L(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseUp,[c.treeId,a],!0)&&j.apply(c.callback.onMouseUp,[b,c.treeId,a]);return!0;};M=function M(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeDblClick,[c.treeId,a],!0)&&j.apply(c.callback.onDblClick,[b,c.treeId,a]);return!0;};N=function N(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeRightClick,[c.treeId,a],!0)&&j.apply(c.callback.onRightClick,[b,c.treeId,a]);return typeof c.callback.onRightClick!="function";};v=function v(b){b=b.originalEvent.srcElement.nodeName.toLowerCase();return b==="input"||b==="textarea";};var j={apply:function apply(b,a,c){return typeof b=="function"?b.apply(P,a?a:[]):c;},canAsync:function canAsync(b,a){var c=b.data.key.children;return b.async.enable&&a&&a.isParent&&!(a.zAsync||a[c]&&a[c].length>0);},clone:function clone(b){if(b===null)return null;var a=j.isArray(b)?[]:{},c;for(c in b){a[c]=b[c]instanceof Date?new Date(b[c].getTime()):_typeof(b[c])==="object"?arguments.callee(b[c]):b[c];}return a;},eqs:function eqs(b,a){return b.toLowerCase()===a.toLowerCase();},isArray:function isArray(b){return Object.prototype.toString.apply(b)==="[object Array]";},$:function $(b,a,c){a&&typeof a!="string"&&(c=a,a="");return typeof b=="string"?q(b,c?c.treeObj.get(0).ownerDocument:null):q("#"+b.tId+a,c?c.treeObj:null);},getMDom:function getMDom(b,a,c){if(!a)return null;for(;a&&a.id!==b.treeId;){for(var d=0,e=c.length;a.tagName&&d<e;d++){if(j.eqs(a.tagName,c[d].tagName)&&a.getAttribute(c[d].attrName)!==null)return a;}a=a.parentNode;}return null;},getNodeMainDom:function getNodeMainDom(b){return q(b).parent("li").get(0)||q(b).parentsUntil("li").parent().get(0);},isChildOrSelf:function isChildOrSelf(b,a){return q(b).closest("#"+a).length>0;},uCanDo:function uCanDo(){return!0;}},i={addNodes:function addNodes(b,a,c,d,e){if(!b.data.keep.leaf||!a||a.isParent)if(j.isArray(d)||(d=[d]),b.data.simpleData.enable&&(d=h.transformTozTreeFormat(b,d)),a){var g=k(a,f.id.SWITCH,b),m=k(a,f.id.ICON,b),o=k(a,f.id.UL,b);if(!a.open)i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,m,f.folder.CLOSE),a.open=!1,o.css({display:"none"});h.addNodesData(b,a,c,d);i.createNodes(b,a.level+1,d,a,c);e||i.expandCollapseParentNode(b,a,!0);}else h.addNodesData(b,h.getRoot(b),c,d),i.createNodes(b,0,d,null,c);},appendNodes:function appendNodes(b,a,c,d,e,g,f){if(!c)return[];var j=[],k=b.data.key.children,l=(d?d:h.getRoot(b))[k],r,Q;if(!l||e>=l.length)e=-1;for(var t=0,q=c.length;t<q;t++){var p=c[t];g&&(r=(e===0||l.length==c.length)&&t==0,Q=e<0&&t==c.length-1,h.initNode(b,a,p,d,r,Q,f),h.addNodeCache(b,p));r=[];p[k]&&p[k].length>0&&(r=i.appendNodes(b,a+1,p[k],p,-1,g,f&&p.open));f&&(i.makeDOMNodeMainBefore(j,b,p),i.makeDOMNodeLine(j,b,p),h.getBeforeA(b,p,j),i.makeDOMNodeNameBefore(j,b,p),h.getInnerBeforeA(b,p,j),i.makeDOMNodeIcon(j,b,p),h.getInnerAfterA(b,p,j),i.makeDOMNodeNameAfter(j,b,p),h.getAfterA(b,p,j),p.isParent&&p.open&&i.makeUlHtml(b,p,j,r.join("")),i.makeDOMNodeMainAfter(j,b,p),h.addCreatedNode(b,p));}return j;},appendParentULDom:function appendParentULDom(b,a){var c=[],d=k(a,b);!d.get(0)&&a.parentTId&&(i.appendParentULDom(b,a.getParentNode()),d=k(a,b));var e=k(a,f.id.UL,b);e.get(0)&&e.remove();e=i.appendNodes(b,a.level+1,a[b.data.key.children],a,-1,!1,!0);i.makeUlHtml(b,a,c,e.join(""));d.append(c.join(""));},asyncNode:function asyncNode(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;else if(a&&a.isAjaxing)return!1;else if(j.apply(b.callback.beforeAsync,[b.treeId,a],!0)==!1)return j.apply(d),!1;if(a)a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:"","class":f.className.BUTTON+" "+f.className.ICO_LOADING});var m={};for(e=0,g=b.async.autoParam.length;a&&e<g;e++){var o=b.async.autoParam[e].split("="),n=o;o.length>1&&(n=o[1],o=o[0]);m[n]=a[o];}if(j.isArray(b.async.otherParam))for(e=0,g=b.async.otherParam.length;e<g;e+=2){m[b.async.otherParam[e]]=b.async.otherParam[e+1];}else for(var l in b.async.otherParam){m[l]=b.async.otherParam[l];}var r=h.getRoot(b)._ver;q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:m,dataType:b.async.dataType,success:function success(e){if(r==h.getRoot(b)._ver){var g=[];try{g=!e||e.length==0?[]:typeof e=="string"?eval("("+e+")"):e;}catch(m){g=e;}if(a)a.isAjaxing=null,a.zAsync=!0;i.setNodeLineIcos(b,a);g&&g!==""?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c);b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]);j.apply(d);}},error:function error(c,d,e){if(r==h.getRoot(b)._ver){if(a)a.isAjaxing=null;i.setNodeLineIcos(b,a);b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,c,d,e]);}}});return!0;},cancelPreSelectedNode:function cancelPreSelectedNode(b,a,c){var d=h.getRoot(b).curSelectedList,e,g;for(e=d.length-1;e>=0;e--){if(g=d[e],a===g||!a&&(!c||c!==g))if(k(g,f.id.A,b).removeClass(f.node.CURSELECTED),a){h.removeSelectedNode(b,a);break;}else d.splice(e,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,g]);}},createNodeCallback:function createNodeCallback(b){if(b.callback.onNodeCreated||b.view.addDiyDom)for(var a=h.getRoot(b);a.createdNodes.length>0;){var c=a.createdNodes.shift();j.apply(b.view.addDiyDom,[b.treeId,c]);b.callback.onNodeCreated&&b.treeObj.trigger(f.event.NODECREATED,[b.treeId,c]);}},createNodes:function createNodes(b,a,c,d,e){if(c&&c.length!=0){var g=h.getRoot(b),j=b.data.key.children,j=!d||d.open||!!k(d[j][0],b).get(0);g.createdNodes=[];var a=i.appendNodes(b,a,c,d,e,!0,j),o,n;d?(d=k(d,f.id.UL,b),d.get(0)&&(o=d)):o=b.treeObj;o&&(e>=0&&(n=o.children()[e]),e>=0&&n?q(n).before(a.join("")):o.append(a.join("")));i.createNodeCallback(b);}},destroy:function destroy(b){b&&(h.initCache(b),h.initRoot(b),l.unbindTree(b),l.unbindEvent(b),b.treeObj.empty(),delete s[b.treeId]);},expandCollapseNode:function expandCollapseNode(b,a,c,d,e){var g=h.getRoot(b),m=b.data.key.children;if(a){if(g.expandTriggerFlag){var o=e,e=function e(){o&&o();a.open?b.treeObj.trigger(f.event.EXPAND,[b.treeId,a]):b.treeObj.trigger(f.event.COLLAPSE,[b.treeId,a]);};g.expandTriggerFlag=!1;}if(!a.open&&a.isParent&&(!k(a,f.id.UL,b).get(0)||a[m]&&a[m].length>0&&!k(a[m][0],b).get(0)))i.appendParentULDom(b,a),i.createNodeCallback(b);if(a.open==c)j.apply(e,[]);else{var c=k(a,f.id.UL,b),g=k(a,f.id.SWITCH,b),n=k(a,f.id.ICON,b);a.isParent?(a.open=!a.open,a.iconOpen&&a.iconClose&&n.attr("style",i.makeNodeIcoStyle(b,a)),a.open?(i.replaceSwitchClass(a,g,f.folder.OPEN),i.replaceIcoClass(a,n,f.folder.OPEN),d==!1||b.view.expandSpeed==""?(c.show(),j.apply(e,[])):a[m]&&a[m].length>0?c.slideDown(b.view.expandSpeed,e):(c.show(),j.apply(e,[]))):(i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,n,f.folder.CLOSE),d==!1||b.view.expandSpeed==""||!(a[m]&&a[m].length>0)?(c.hide(),j.apply(e,[])):c.slideUp(b.view.expandSpeed,e))):j.apply(e,[]);}}else j.apply(e,[]);},expandCollapseParentNode:function expandCollapseParentNode(b,a,c,d,e){a&&(a.parentTId?(i.expandCollapseNode(b,a,c,d),a.parentTId&&i.expandCollapseParentNode(b,a.getParentNode(),c,d,e)):i.expandCollapseNode(b,a,c,d,e));},expandCollapseSonNode:function expandCollapseSonNode(b,a,c,d,e){var g=h.getRoot(b),f=b.data.key.children,g=a?a[f]:g[f],f=a?!1:d,j=h.getRoot(b).expandTriggerFlag;h.getRoot(b).expandTriggerFlag=!1;if(g)for(var k=0,l=g.length;k<l;k++){g[k]&&i.expandCollapseSonNode(b,g[k],c,f);}h.getRoot(b).expandTriggerFlag=j;i.expandCollapseNode(b,a,c,d,e);},isSelectedNode:function isSelectedNode(b,a){if(!a)return!1;var c=h.getRoot(b).curSelectedList,d;for(d=c.length-1;d>=0;d--){if(a===c[d])return!0;}return!1;},makeDOMNodeIcon:function makeDOMNodeIcon(b,a,c){var d=h.getNodeName(a,c),d=a.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.push("<span id='",c.tId,f.id.ICON,"' title='' treeNode",f.id.ICON," class='",i.makeNodeIcoClass(a,c),"' style='",i.makeNodeIcoStyle(a,c),"'></span><span id='",c.tId,f.id.SPAN,"'>",d,"</span>");},makeDOMNodeLine:function makeDOMNodeLine(b,a,c){b.push("<span id='",c.tId,f.id.SWITCH,"' title='' class='",i.makeNodeLineClass(a,c),"' treeNode",f.id.SWITCH,"></span>");},makeDOMNodeMainAfter:function makeDOMNodeMainAfter(b){b.push("</li>");},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(b,a,c){b.push("<li id='",c.tId,"' class='",f.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>");},makeDOMNodeNameAfter:function makeDOMNodeNameAfter(b){b.push("</a>");},makeDOMNodeNameBefore:function makeDOMNodeNameBefore(b,a,c){var d=h.getNodeTitle(a,c),e=i.makeNodeUrl(a,c),g=i.makeNodeFontCss(a,c),m=[],k;for(k in g){m.push(k,":",g[k],";");}b.push("<a id='",c.tId,f.id.A,"' class='",f.className.LEVEL,c.level,"' treeNode",f.id.A,' onclick="',c.click||"",'" ',e!=null&&e.length>0?"href='"+e+"'":""," target='",i.makeNodeTarget(c),"' style='",m.join(""),"'");j.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&d&&b.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");b.push(">");},makeNodeFontCss:function makeNodeFontCss(b,a){var c=j.apply(b.view.fontCss,[b.treeId,a],b.view.fontCss);return c&&typeof c!="function"?c:{};},makeNodeIcoClass:function makeNodeIcoClass(b,a){var c=["ico"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+"_":"")+c[0],a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU));return f.className.BUTTON+" "+c.join("_");},makeNodeIcoStyle:function makeNodeIcoStyle(b,a){var c=[];if(!a.isAjaxing){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a[b.data.key.icon];d&&c.push("background:url(",d,") 0 0 no-repeat;");(b.view.showIcon==!1||!j.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push("width:0px;height:0px;");}return c.join("");},makeNodeLineClass:function makeNodeLineClass(b,a){var c=[];b.view.showLine?a.level==0&&a.isFirstNode&&a.isLastNode?c.push(f.line.ROOT):a.level==0&&a.isFirstNode?c.push(f.line.ROOTS):a.isLastNode?c.push(f.line.BOTTOM):c.push(f.line.CENTER):c.push(f.line.NOLINE);a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU);return i.makeNodeLineClassEx(a)+c.join("_");},makeNodeLineClassEx:function makeNodeLineClassEx(b){return f.className.BUTTON+" "+f.className.LEVEL+b.level+" "+f.className.SWITCH+" ";},makeNodeTarget:function makeNodeTarget(b){return b.target||"_blank";},makeNodeUrl:function makeNodeUrl(b,a){var c=b.data.key.url;return a[c]?a[c]:null;},makeUlHtml:function makeUlHtml(b,a,c,d){c.push("<ul id='",a.tId,f.id.UL,"' class='",f.className.LEVEL,a.level," ",i.makeUlLineClass(b,a),"' style='display:",a.open?"block":"none","'>");c.push(d);c.push("</ul>");},makeUlLineClass:function makeUlLineClass(b,a){return b.view.showLine&&!a.isLastNode?f.line.LINE:"";},removeChildNodes:function removeChildNodes(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){for(var e=0,g=d.length;e<g;e++){h.removeNodeCache(b,d[e]);}h.removeSelectedNode(b);delete a[c];b.data.keep.parent?k(a,f.id.UL,b).empty():(a.isParent=!1,a.open=!1,c=k(a,f.id.SWITCH,b),d=k(a,f.id.ICON,b),i.replaceSwitchClass(a,c,f.folder.DOCU),i.replaceIcoClass(a,d,f.folder.DOCU),k(a,f.id.UL,b).remove());}}},setFirstNode:function setFirstNode(b,a){var c=b.data.key.children;if(a[c].length>0)a[c][0].isFirstNode=!0;},setLastNode:function setLastNode(b,a){var c=b.data.key.children,d=a[c].length;if(d>0)a[c][d-1].isLastNode=!0;},removeNode:function removeNode(b,a){var c=h.getRoot(b),d=b.data.key.children,e=a.parentTId?a.getParentNode():c;a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null;};a.getNextNode=function(){return null;};if(h.getNodeCache(b,a.tId)){k(a,b).remove();h.removeNodeCache(b,a);h.removeSelectedNode(b,a);for(var g=0,j=e[d].length;g<j;g++){if(e[d][g].tId==a.tId){e[d].splice(g,1);break;}}i.setFirstNode(b,e);i.setLastNode(b,e);var o,g=e[d].length;if(!b.data.keep.parent&&g==0)e.isParent=!1,e.open=!1,g=k(e,f.id.UL,b),j=k(e,f.id.SWITCH,b),o=k(e,f.id.ICON,b),i.replaceSwitchClass(e,j,f.folder.DOCU),i.replaceIcoClass(e,o,f.folder.DOCU),g.css("display","none");else if(b.view.showLine&&g>0){var n=e[d][g-1],g=k(n,f.id.UL,b),j=k(n,f.id.SWITCH,b);o=k(n,f.id.ICON,b);e==c?e[d].length==1?i.replaceSwitchClass(n,j,f.line.ROOT):(c=k(e[d][0],f.id.SWITCH,b),i.replaceSwitchClass(e[d][0],c,f.line.ROOTS),i.replaceSwitchClass(n,j,f.line.BOTTOM)):i.replaceSwitchClass(n,j,f.line.BOTTOM);g.removeClass(f.line.LINE);}}},replaceIcoClass:function replaceIcoClass(b,a,c){if(a&&!b.isAjaxing&&(b=a.attr("class"),b!=void 0)){b=b.split("_");switch(c){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:b[b.length-1]=c;}a.attr("class",b.join("_"));}},replaceSwitchClass:function replaceSwitchClass(b,a,c){if(a){var d=a.attr("class");if(d!=void 0){d=d.split("_");switch(c){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:d[0]=i.makeNodeLineClassEx(b)+c;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:d[1]=c;}a.attr("class",d.join("_"));c!==f.folder.DOCU?a.removeAttr("disabled"):a.attr("disabled","disabled");}}},selectNode:function selectNode(b,a,c){c||i.cancelPreSelectedNode(b,null,a);k(a,f.id.A,b).addClass(f.node.CURSELECTED);h.addSelectedNode(b,a);b.treeObj.trigger(f.event.SELECTED,[b.treeId,a]);},setNodeFontCss:function setNodeFontCss(b,a){var c=k(a,f.id.A,b),d=i.makeNodeFontCss(b,a);d&&c.css(d);},setNodeLineIcos:function setNodeLineIcos(b,a){if(a){var c=k(a,f.id.SWITCH,b),d=k(a,f.id.UL,b),e=k(a,f.id.ICON,b),g=i.makeUlLineClass(b,a);g.length==0?d.removeClass(f.line.LINE):d.addClass(g);c.attr("class",i.makeNodeLineClass(b,a));a.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");e.removeAttr("style");e.attr("style",i.makeNodeIcoStyle(b,a));e.attr("class",i.makeNodeIcoClass(b,a));}},setNodeName:function setNodeName(b,a){var c=h.getNodeTitle(b,a),d=k(a,f.id.SPAN,b);d.empty();b.view.nameIsHTML?d.html(h.getNodeName(b,a)):d.text(h.getNodeName(b,a));j.apply(b.view.showTitle,[b.treeId,a],b.view.showTitle)&&k(a,f.id.A,b).attr("title",!c?"":c);},setNodeTarget:function setNodeTarget(b,a){k(a,f.id.A,b).attr("target",i.makeNodeTarget(a));},setNodeUrl:function setNodeUrl(b,a){var c=k(a,f.id.A,b),d=i.makeNodeUrl(b,a);d==null||d.length==0?c.removeAttr("href"):c.attr("href",d);},switchNode:function switchNode(b,a){a.open||!j.canAsync(b,a)?i.expandCollapseNode(b,a,!a.open):b.async.enable?i.asyncNode(b,a)||i.expandCollapseNode(b,a,!a.open):a&&i.expandCollapseNode(b,a,!a.open);}};q.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:l,data:h},getZTreeObj:function getZTreeObj(b){return(b=h.getZTreeTools(b))?b:null;},destroy:function destroy(b){if(b&&b.length>0)i.destroy(h.getSetting(b));else for(var a in s){i.destroy(s[a]);}},init:function init(b,a,c){var d=j.clone(O);q.extend(!0,d,a);d.treeId=b.attr("id");d.treeObj=b;d.treeObj.empty();s[d.treeId]=d;if(typeof document.body.style.maxHeight==="undefined")d.view.expandSpeed="";h.initRoot(d);b=h.getRoot(d);a=d.data.key.children;c=c?j.clone(j.isArray(c)?c:[c]):[];b[a]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c;h.initCache(d);l.unbindTree(d);l.bindTree(d);l.unbindEvent(d);l.bindEvent(d);c={setting:d,addNodes:function addNodes(a,b,c,f){function h(){i.addNodes(d,a,b,l,f==!0);}a||(a=null);if(a&&!a.isParent&&d.data.keep.leaf)return null;var k=parseInt(b,10);isNaN(k)?(f=!!c,c=b,b=-1):b=k;if(!c)return null;var l=j.clone(j.isArray(c)?c:[c]);j.canAsync(d,a)?i.asyncNode(d,a,f,h):h();return l;},cancelSelectedNode:function cancelSelectedNode(a){i.cancelPreSelectedNode(d,a);},destroy:function destroy(){i.destroy(d);},expandAll:function expandAll(a){a=!!a;i.expandCollapseSonNode(d,null,a,!0);return a;},expandNode:function expandNode(a,b,c,f,n){if(!a||!a.isParent)return null;b!==!0&&b!==!1&&(b=!a.open);if((n=!!n)&&b&&j.apply(d.callback.beforeExpand,[d.treeId,a],!0)==!1)return null;else if(n&&!b&&j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)==!1)return null;b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1);if(b===a.open&&!c)return null;h.getRoot(d).expandTriggerFlag=n;if(!j.canAsync(d,a)&&c)i.expandCollapseSonNode(d,a,b,!0,function(){if(f!==!1)try{k(a,d).focus().blur();}catch(b){}});else if(a.open=!b,i.switchNode(this.setting,a),f!==!1)try{k(a,d).focus().blur();}catch(l){}return b;},getNodes:function getNodes(){return h.getNodes(d);},getNodeByParam:function getNodeByParam(a,b,c){return!a?null:h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodeByTId:function getNodeByTId(a){return h.getNodeCache(d,a);},getNodesByParam:function getNodesByParam(a,b,c){return!a?null:h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByParamFuzzy:function getNodesByParamFuzzy(a,b,c){return!a?null:h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByFilter:function getNodesByFilter(a,b,c,f){b=!!b;return!a||typeof a!="function"?b?null:[]:h.getNodesByFilter(d,c?c[d.data.key.children]:h.getNodes(d),a,b,f);},getNodeIndex:function getNodeIndex(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),f=0,i=c[b].length;f<i;f++){if(c[b][f]==a)return f;}return-1;},getSelectedNodes:function getSelectedNodes(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,f=b.length;c<f;c++){a.push(b[c]);}return a;},isSelectedNode:function isSelectedNode(a){return h.isSelectedNode(d,a);},reAsyncChildNodes:function reAsyncChildNodes(a,b,c){if(this.setting.async.enable){var j=!a;j&&(a=h.getRoot(d));if(b=="refresh"){for(var b=this.setting.data.key.children,l=0,q=a[b]?a[b].length:0;l<q;l++){h.removeNodeCache(d,a[b][l]);}h.removeSelectedNode(d);a[b]=[];j?this.setting.treeObj.empty():k(a,f.id.UL,d).empty();}i.asyncNode(this.setting,j?null:a,!!c);}},refresh:function refresh(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d);a[d.data.key.children]=b;h.initCache(d);i.createNodes(d,0,a[d.data.key.children],null,-1);},removeChildNodes:function removeChildNodes(a){if(!a)return null;var b=a[d.data.key.children];i.removeChildNodes(d,a);return b?b:null;},removeNode:function removeNode(a,b){a&&(b=!!b,b&&j.apply(d.callback.beforeRemove,[d.treeId,a],!0)==!1||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(f.event.REMOVE,[d.treeId,a])));},selectNode:function selectNode(a,b){if(a&&j.uCanDo(d)){b=d.view.selectedMulti&&b;if(a.parentTId)i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{k(a,d).focus().blur();}catch(b){}});else try{k(a,d).focus().blur();}catch(c){}i.selectNode(d,a,b);}},transformTozTreeNodes:function transformTozTreeNodes(a){return h.transformTozTreeFormat(d,a);},transformToArray:function transformToArray(a){return h.transformToArrayFormat(d,a);},updateNode:function updateNode(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a));}};b.treeTools=c;h.setZTreeTools(d,c);b[a]&&b[a].length>0?i.createNodes(d,0,b[a],null,-1):d.async.enable&&d.async.url&&d.async.url!==""&&i.asyncNode(d);return c;}};var P=q.fn.zTree,k=j.$,f=P.consts;})(jQuery);(function(m){var p,q,r,o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};p=function p(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=b.data.key.checked;if(k.apply(b.callback.beforeCheck,[b.treeId,a],!0)==!1)return!0;a[d]=!a[d];e.checkNodeRelation(b,a);d=n(a,j.id.CHECK,b);e.setChkClass(b,d,a);e.repairParentChkClassWithSelf(b,a);b.treeObj.trigger(j.event.CHECK,[c,b.treeId,a]);return!0;};q=function q(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!0;e.setChkClass(b,d,a);return!0;};r=function r(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!1;e.setChkClass(b,d,a);return!0;};m.extend(!0,m.fn.zTree.consts,o);m.extend(!0,m.fn.zTree._z,{tools:{},view:{checkNodeRelation:function checkNodeRelation(c,a){var b,d,h,i=c.data.key.children,l=c.data.key.checked;b=j.radio;if(c.check.chkStyle==b.STYLE){var f=g.getRadioCheckedList(c);if(a[l]){if(c.check.radioType==b.TYPE_ALL){for(d=f.length-1;d>=0;d--){b=f[d],b[l]&&b!=a&&(b[l]=!1,f.splice(d,1),e.setChkClass(c,n(b,j.id.CHECK,c),b),b.parentTId!=a.parentTId&&e.repairParentChkClassWithSelf(c,b));}f.push(a);}else{f=a.parentTId?a.getParentNode():g.getRoot(c);for(d=0,h=f[i].length;d<h;d++){b=f[i][d],b[l]&&b!=a&&(b[l]=!1,e.setChkClass(c,n(b,j.id.CHECK,c),b));}}}else if(c.check.radioType==b.TYPE_ALL)for(d=0,h=f.length;d<h;d++){if(a==f[d]){f.splice(d,1);break;}}}else a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.Y.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!0),!a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.N.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!1),a[l]&&c.check.chkboxType.Y.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!0),!a[l]&&c.check.chkboxType.N.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!1);},makeChkClass:function makeChkClass(c,a){var b=c.data.key.checked,d=j.checkbox,h=j.radio,i="",i=a.chkDisabled===!0?d.DISABLED:a.halfCheck?d.PART:c.check.chkStyle==h.STYLE?a.check_Child_State<1?d.FULL:d.PART:a[b]?a.check_Child_State===2||a.check_Child_State===-1?d.FULL:d.PART:a.check_Child_State<1?d.FULL:d.PART,b=c.check.chkStyle+"_"+(a[b]?d.TRUE:d.FALSE)+"_"+i,b=a.check_Focus&&a.chkDisabled!==!0?b+"_"+d.FOCUS:b;return j.className.BUTTON+" "+d.DEFAULT+" "+b;},repairAllChk:function repairAllChk(c,a){if(c.check.enable&&c.check.chkStyle===j.checkbox.STYLE)for(var b=c.data.key.checked,d=c.data.key.children,h=g.getRoot(c),i=0,l=h[d].length;i<l;i++){var f=h[d][i];f.nocheck!==!0&&f.chkDisabled!==!0&&(f[b]=a);e.setSonNodeCheckBox(c,f,a);}},repairChkClass:function repairChkClass(c,a){if(a&&(g.makeChkFlag(c,a),a.nocheck!==!0)){var b=n(a,j.id.CHECK,c);e.setChkClass(c,b,a);}},repairParentChkClass:function repairParentChkClass(c,a){if(a&&a.parentTId){var b=a.getParentNode();e.repairChkClass(c,b);e.repairParentChkClass(c,b);}},repairParentChkClassWithSelf:function repairParentChkClassWithSelf(c,a){if(a){var b=c.data.key.children;a[b]&&a[b].length>0?e.repairParentChkClass(c,a[b][0]):e.repairParentChkClass(c,a);}},repairSonChkDisabled:function repairSonChkDisabled(c,a,b,d){if(a){var h=c.data.key.children;if(a.chkDisabled!=b)a.chkDisabled=b;e.repairChkClass(c,a);if(a[h]&&d)for(var i=0,l=a[h].length;i<l;i++){e.repairSonChkDisabled(c,a[h][i],b,d);}}},repairParentChkDisabled:function repairParentChkDisabled(c,a,b,d){if(a){if(a.chkDisabled!=b&&d)a.chkDisabled=b;e.repairChkClass(c,a);e.repairParentChkDisabled(c,a.getParentNode(),b,d);}},setChkClass:function setChkClass(c,a,b){a&&(b.nocheck===!0?a.hide():a.show(),a.attr("class",e.makeChkClass(c,b)));},setParentNodeCheckBox:function setParentNodeCheckBox(c,a,b,d){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);g.makeChkFlag(c,a);a.nocheck!==!0&&a.chkDisabled!==!0&&(a[i]=b,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]));if(a.parentTId){l=!0;if(!b)for(var h=a.getParentNode()[h],f=0,k=h.length;f<k;f++){if(h[f].nocheck!==!0&&h[f].chkDisabled!==!0&&h[f][i]||(h[f].nocheck===!0||h[f].chkDisabled===!0)&&h[f].check_Child_State>0){l=!1;break;}}l&&e.setParentNodeCheckBox(c,a.getParentNode(),b,d);}},setSonNodeCheckBox:function setSonNodeCheckBox(c,a,b,d){if(a){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);var f=!1;if(a[h])for(var k=0,m=a[h].length;k<m&&a.chkDisabled!==!0;k++){var o=a[h][k];e.setSonNodeCheckBox(c,o,b,d);o.chkDisabled===!0&&(f=!0);}if(a!=g.getRoot(c)&&a.chkDisabled!==!0){f&&a.nocheck!==!0&&g.makeChkFlag(c,a);if(a.nocheck!==!0&&a.chkDisabled!==!0){if(a[i]=b,!f)a.check_Child_State=a[h]&&a[h].length>0?b?2:0:-1;}else a.check_Child_State=-1;e.setChkClass(c,l,a);c.check.autoCheckTrigger&&a!=d&&a.nocheck!==!0&&a.chkDisabled!==!0&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]);}}}},event:{},data:{getRadioCheckedList:function getRadioCheckedList(c){for(var a=g.getRoot(c).radioCheckedList,b=0,d=a.length;b<d;b++){g.getNodeCache(c,a[b].tId)||(a.splice(b,1),b--,d--);}return a;},getCheckStatus:function getCheckStatus(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled)return null;var b=c.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:c.check.chkStyle==j.radio.STYLE?a.check_Child_State===2:a[b]?a.check_Child_State>-1&&a.check_Child_State<2:a.check_Child_State>0};},getTreeCheckedNodes:function getTreeCheckedNodes(c,a,b,d){if(!a)return[];for(var h=c.data.key.children,i=c.data.key.checked,e=b&&c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL,d=!d?[]:d,f=0,k=a.length;f<k;f++){if(a[f].nocheck!==!0&&a[f].chkDisabled!==!0&&a[f][i]==b&&(d.push(a[f]),e))break;g.getTreeCheckedNodes(c,a[f][h],b,d);if(e&&d.length>0)break;}return d;},getTreeChangeCheckedNodes:function getTreeChangeCheckedNodes(c,a,b){if(!a)return[];for(var d=c.data.key.children,h=c.data.key.checked,b=!b?[]:b,i=0,e=a.length;i<e;i++){a[i].nocheck!==!0&&a[i].chkDisabled!==!0&&a[i][h]!=a[i].checkedOld&&b.push(a[i]),g.getTreeChangeCheckedNodes(c,a[i][d],b);}return b;},makeChkFlag:function makeChkFlag(c,a){if(a){var b=c.data.key.children,d=c.data.key.checked,h=-1;if(a[b])for(var i=0,e=a[b].length;i<e;i++){var f=a[b][i],g=-1;if(c.check.chkStyle==j.radio.STYLE){if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?2:f[d]?2:f.check_Child_State>0?2:0,g==2){h=2;break;}else g==0&&(h=0);}else if(c.check.chkStyle==j.checkbox.STYLE)if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?1:f[d]?f.check_Child_State===-1||f.check_Child_State===2?2:1:f.check_Child_State>0?1:0,g===1){h=1;break;}else if(g===2&&h>-1&&i>0&&g!==h){h=1;break;}else if(h===2&&g>-1&&g<2){h=1;break;}else g>-1&&(h=g);}a.check_Child_State=h;}}}});var m=m.fn.zTree,k=m._z.tools,j=m.consts,e=m._z.view,g=m._z.data,n=k.$;g.exSetting(v);g.addInitBind(function(c){c.treeObj.bind(j.event.CHECK,function(a,b,d,h){a.srcEvent=b;k.apply(c.callback.onCheck,[a,d,h]);});});g.addInitUnBind(function(c){c.treeObj.unbind(j.event.CHECK);});g.addInitCache(function(){});g.addInitNode(function(c,a,b,d){if(b){a=c.data.key.checked;typeof b[a]=="string"&&(b[a]=k.eqs(b[a],"true"));b[a]=!!b[a];b.checkedOld=b[a];if(typeof b.nocheck=="string")b.nocheck=k.eqs(b.nocheck,"true");b.nocheck=!!b.nocheck||c.check.nocheckInherit&&d&&!!d.nocheck;if(typeof b.chkDisabled=="string")b.chkDisabled=k.eqs(b.chkDisabled,"true");b.chkDisabled=!!b.chkDisabled||c.check.chkDisabledInherit&&d&&!!d.chkDisabled;if(typeof b.halfCheck=="string")b.halfCheck=k.eqs(b.halfCheck,"true");b.halfCheck=!!b.halfCheck;b.check_Child_State=-1;b.check_Focus=!1;b.getCheckStatus=function(){return g.getCheckStatus(c,b);};c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL&&b[a]&&g.getRoot(c).radioCheckedList.push(b);}});g.addInitProxy(function(c){var a=c.target,b=g.getSetting(c.data.treeId),d="",h=null,e="",l=null;if(k.eqs(c.type,"mouseover")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoverCheck";}else if(k.eqs(c.type,"mouseout")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoutCheck";}else if(k.eqs(c.type,"click")&&b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="checkNode";if(d.length>0)switch(h=g.getNodeCache(b,d),e){case"checkNode":l=p;break;case"mouseoverCheck":l=q;break;case"mouseoutCheck":l=r;}return{stop:e==="checkNode",node:h,nodeEventType:e,nodeEventCallback:l,treeEventType:"",treeEventCallback:null};},!0);g.addInitRoot(function(c){g.getRoot(c).radioCheckedList=[];});g.addBeforeA(function(c,a,b){c.check.enable&&(g.makeChkFlag(c,a),b.push("<span ID='",a.tId,j.id.CHECK,"' class='",e.makeChkClass(c,a),"' treeNode",j.id.CHECK,a.nocheck===!0?" style='display:none;'":"","></span>"));});g.addZTreeTools(function(c,a){a.checkNode=function(a,b,c,g){var f=this.setting.data.key.checked;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[f]),g=!!g,(a[f]!==b||c)&&!(g&&k.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)==!1)&&k.uCanDo(this.setting)&&this.setting.check.enable&&a.nocheck!==!0))a[f]=b,b=n(a,j.id.CHECK,this.setting),(c||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,a),e.setChkClass(this.setting,b,a),e.repairParentChkClassWithSelf(this.setting,a),g&&this.setting.treeObj.trigger(j.event.CHECK,[null,this.setting.treeId,a]);};a.checkAllNodes=function(a){e.repairAllChk(this.setting,!!a);};a.getCheckedNodes=function(a){var b=this.setting.data.key.children;return g.getTreeCheckedNodes(this.setting,g.getRoot(this.setting)[b],a!==!1);};a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return g.getTreeChangeCheckedNodes(this.setting,g.getRoot(this.setting)[a]);};a.setChkDisabled=function(a,b,c,g){b=!!b;c=!!c;e.repairSonChkDisabled(this.setting,a,b,!!g);e.repairParentChkDisabled(this.setting,a.getParentNode(),b,c);};var b=a.updateNode;a.updateNode=function(c,g){b&&b.apply(a,arguments);if(c&&this.setting.check.enable&&n(c,this.setting).get(0)&&k.uCanDo(this.setting)){var i=n(c,j.id.CHECK,this.setting);(g==!0||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,c);e.setChkClass(this.setting,i,c);e.repairParentChkClassWithSelf(this.setting,c);}};});var s=e.createNodes;e.createNodes=function(c,a,b,d,g){s&&s.apply(e,arguments);b&&e.repairParentChkClassWithSelf(c,d);};var t=e.removeNode;e.removeNode=function(c,a){var b=a.getParentNode();t&&t.apply(e,arguments);a&&b&&(e.repairChkClass(c,b),e.repairParentChkClass(c,b));};var u=e.appendNodes;e.appendNodes=function(c,a,b,d,h,i,j){var f="";u&&(f=u.apply(e,arguments));d&&g.makeChkFlag(c,d);return f;};})(jQuery);(function(i){i.extend(!0,i.fn.zTree._z,{view:{clearOldFirstNode:function clearOldFirstNode(c,a){for(var b=a.getNextNode();b;){if(b.isFirstNode){b.isFirstNode=!1;d.setNodeLineIcos(c,b);break;}if(b.isLastNode)break;b=b.getNextNode();}},clearOldLastNode:function clearOldLastNode(c,a,b){for(a=a.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1;b&&d.setNodeLineIcos(c,a);break;}if(a.isFirstNode)break;a=a.getPreNode();}},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(c,a,b){c.push("<li ",b.isHidden?"style='display:none;' ":"","id='",b.tId,"' class='",l.className.LEVEL,b.level,"' tabindex='0' hidefocus='true' treenode>");},showNode:function showNode(c,a){a.isHidden=!1;f.initShowForExCheck(c,a);j(a,c).show();},showNodes:function showNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if(!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.showNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForShow(c,a),d.setLastNodeForShow(c,a);}}},hideNode:function hideNode(c,a){a.isHidden=!0;a.isFirstNode=!1;a.isLastNode=!1;f.initHideForExCheck(c,a);d.cancelPreSelectedNode(c,a);j(a,c).hide();},hideNodes:function hideNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if((h.isFirstNode||h.isLastNode)&&!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.hideNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForHide(c,a),d.setLastNodeForHide(c,a);}}},setFirstNode:function setFirstNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][0].isFirstNode=!0:e>0&&d.setFirstNodeForHide(c,a[b]);},setLastNode:function setLastNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][e-1].isLastNode=!0:e>0&&d.setLastNodeForHide(c,a[b]);},setFirstNodeForHide:function setFirstNodeForHide(c,a){var b,e,g;for(e=0,g=a.length;e<g;e++){b=a[e];if(b.isFirstNode)break;if(!b.isHidden&&!b.isFirstNode){b.isFirstNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setFirstNodeForShow:function setFirstNodeForShow(c,a){var b,e,g,f,h;for(e=0,g=a.length;e<g;e++){if(b=a[e],!f&&!b.isHidden&&b.isFirstNode){f=b;break;}else if(!f&&!b.isHidden&&!b.isFirstNode)b.isFirstNode=!0,f=b,d.setNodeLineIcos(c,b);else if(f&&b.isFirstNode){b.isFirstNode=!1;h=b;d.setNodeLineIcos(c,b);break;}}return{"new":f,old:h};},setLastNodeForHide:function setLastNodeForHide(c,a){var b,e;for(e=a.length-1;e>=0;e--){b=a[e];if(b.isLastNode)break;if(!b.isHidden&&!b.isLastNode){b.isLastNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setLastNodeForShow:function setLastNodeForShow(c,a){var b,e,g,f;for(e=a.length-1;e>=0;e--){if(b=a[e],!g&&!b.isHidden&&b.isLastNode){g=b;break;}else if(!g&&!b.isHidden&&!b.isLastNode)b.isLastNode=!0,g=b,d.setNodeLineIcos(c,b);else if(g&&b.isLastNode){b.isLastNode=!1;f=b;d.setNodeLineIcos(c,b);break;}}return{"new":g,old:f};}},data:{initHideForExCheck:function initHideForExCheck(c,a){if(a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck=="undefined")a._nocheck=!!a.nocheck,a.nocheck=!0;a.check_Child_State=-1;d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}},initShowForExCheck:function initShowForExCheck(c,a){if(!a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck!="undefined")a.nocheck=a._nocheck,delete a._nocheck;if(d.setChkClass){var b=j(a,l.id.CHECK,c);d.setChkClass(c,b,a);}d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}}}});var i=i.fn.zTree,m=i._z.tools,l=i.consts,d=i._z.view,f=i._z.data,j=m.$;f.addInitNode(function(c,a,b){if(typeof b.isHidden=="string")b.isHidden=m.eqs(b.isHidden,"true");b.isHidden=!!b.isHidden;f.initHideForExCheck(c,b);});f.addBeforeA(function(){});f.addZTreeTools(function(c,a){a.showNodes=function(a,b){d.showNodes(c,a,b);};a.showNode=function(a,b){a&&d.showNodes(c,[a],b);};a.hideNodes=function(a,b){d.hideNodes(c,a,b);};a.hideNode=function(a,b){a&&d.hideNodes(c,[a],b);};var b=a.checkNode;if(b)a.checkNode=function(c,d,f,h){(!c||!c.isHidden)&&b.apply(a,arguments);};});var n=f.initNode;f.initNode=function(c,a,b,e,g,i,h){var j=(e?e:f.getRoot(c))[c.data.key.children];f.tmpHideFirstNode=d.setFirstNodeForHide(c,j);f.tmpHideLastNode=d.setLastNodeForHide(c,j);h&&(d.setNodeLineIcos(c,f.tmpHideFirstNode),d.setNodeLineIcos(c,f.tmpHideLastNode));g=f.tmpHideFirstNode===b;i=f.tmpHideLastNode===b;n&&n.apply(f,arguments);h&&i&&d.clearOldLastNode(c,b,h);};var o=f.makeChkFlag;if(o)f.makeChkFlag=function(c,a){(!a||!a.isHidden)&&o.apply(f,arguments);};var p=f.getTreeCheckedNodes;if(p)f.getTreeCheckedNodes=function(c,a,b,e){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return p.apply(f,arguments);};var q=f.getTreeChangeCheckedNodes;if(q)f.getTreeChangeCheckedNodes=function(c,a,b){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return q.apply(f,arguments);};var r=d.expandCollapseSonNode;if(r)d.expandCollapseSonNode=function(c,a,b,e,f){(!a||!a.isHidden)&&r.apply(d,arguments);};var s=d.setSonNodeCheckBox;if(s)d.setSonNodeCheckBox=function(c,a,b,e){(!a||!a.isHidden)&&s.apply(d,arguments);};var t=d.repairParentChkClassWithSelf;if(t)d.repairParentChkClassWithSelf=function(c,a){(!a||!a.isHidden)&&t.apply(d,arguments);};})(jQuery);(function(v){var I={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},x={onHoverOverNode:function onHoverOverNode(b,a){var c=m.getSetting(b.data.treeId),d=m.getRoot(c);if(d.curHoverNode!=a)x.onHoverOutNode(b);d.curHoverNode=a;f.addHoverDom(c,a);},onHoverOutNode:function onHoverOutNode(b){var b=m.getSetting(b.data.treeId),a=m.getRoot(b);if(a.curHoverNode&&!m.isSelectedNode(b,a.curHoverNode))f.removeTreeDom(b,a.curHoverNode),a.curHoverNode=null;},onMousedownNode:function onMousedownNode(b,a){function c(b){if(B.dragFlag==0&&Math.abs(N-b.clientX)<e.edit.drag.minMoveSize&&Math.abs(O-b.clientY)<e.edit.drag.minMoveSize)return!0;var a,c,n,k,i;i=e.data.key.children;M.css("cursor","pointer");if(B.dragFlag==0){if(g.apply(e.callback.beforeDrag,[e.treeId,l],!0)==!1)return r(b),!0;for(a=0,c=l.length;a<c;a++){if(a==0)B.dragNodeShowBefore=[];n=l[a];n.isParent&&n.open?(f.expandCollapseNode(e,n,!n.open),B.dragNodeShowBefore[n.tId]=!0):B.dragNodeShowBefore[n.tId]=!1;}B.dragFlag=1;t.showHoverDom=!1;g.showIfameMask(e,!0);n=!0;k=-1;if(l.length>1){var j=l[0].parentTId?l[0].getParentNode()[i]:m.getNodes(e);i=[];for(a=0,c=j.length;a<c;a++){if(B.dragNodeShowBefore[j[a].tId]!==void 0&&(n&&k>-1&&k+1!==a&&(n=!1),i.push(j[a]),k=a),l.length===i.length){l=i;break;}}}n&&(H=l[0].getPreNode(),R=l[l.length-1].getNextNode());D=o("<ul class='zTreeDragUL'></ul>",e);for(a=0,c=l.length;a<c;a++){n=l[a],n.editNameFlag=!1,f.selectNode(e,n,a>0),f.removeTreeDom(e,n),a>e.edit.drag.maxShowNodeNum-1||(k=o("<li id='"+n.tId+"_tmp'></li>",e),k.append(o(n,d.id.A,e).clone()),k.css("padding","0"),k.children("#"+n.tId+d.id.A).removeClass(d.node.CURSELECTED),D.append(k),a==e.edit.drag.maxShowNodeNum-1&&(k=o("<li id='"+n.tId+"_moretmp'><a>  ...  </a></li>",e),D.append(k)));}D.attr("id",l[0].tId+d.id.UL+"_tmp");D.addClass(e.treeObj.attr("class"));D.appendTo(M);A=o("<span class='tmpzTreeMove_arrow'></span>",e);A.attr("id","zTreeMove_arrow_tmp");A.appendTo(M);e.treeObj.trigger(d.event.DRAG,[b,e.treeId,l]);}if(B.dragFlag==1){s&&A.attr("id")==b.target.id&&u&&b.clientX+F.scrollLeft()+2>v("#"+u+d.id.A,s).offset().left?(n=v("#"+u+d.id.A,s),b.target=n.length>0?n.get(0):b.target):s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));u=s=null;J=!1;h=e;n=m.getSettings();for(var y in n){if(n[y].treeId&&n[y].edit.enable&&n[y].treeId!=e.treeId&&(b.target.id==n[y].treeId||v(b.target).parents("#"+n[y].treeId).length>0))J=!0,h=n[y];}y=F.scrollTop();k=F.scrollLeft();i=h.treeObj.offset();a=h.treeObj.get(0).scrollHeight;n=h.treeObj.get(0).scrollWidth;c=b.clientY+y-i.top;var p=h.treeObj.height()+i.top-b.clientY-y,q=b.clientX+k-i.left,x=h.treeObj.width()+i.left-b.clientX-k;i=c<e.edit.drag.borderMax&&c>e.edit.drag.borderMin;var j=p<e.edit.drag.borderMax&&p>e.edit.drag.borderMin,K=q<e.edit.drag.borderMax&&q>e.edit.drag.borderMin,G=x<e.edit.drag.borderMax&&x>e.edit.drag.borderMin,p=c>e.edit.drag.borderMin&&p>e.edit.drag.borderMin&&q>e.edit.drag.borderMin&&x>e.edit.drag.borderMin,q=i&&h.treeObj.scrollTop()<=0,x=j&&h.treeObj.scrollTop()+h.treeObj.height()+10>=a,P=K&&h.treeObj.scrollLeft()<=0,Q=G&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=n;if(b.target&&g.isChildOrSelf(b.target,h.treeId)){for(var E=b.target;E&&E.tagName&&!g.eqs(E.tagName,"li")&&E.id!=h.treeId;){E=E.parentNode;}var S=!0;for(a=0,c=l.length;a<c;a++){if(n=l[a],E.id===n.tId){S=!1;break;}else if(o(n,e).find("#"+E.id).length>0){S=!1;break;}}if(S&&b.target&&g.isChildOrSelf(b.target,E.id+d.id.A))s=v(E),u=E.id;}n=l[0];if(p&&g.isChildOrSelf(b.target,h.treeId)){if(!s&&(b.target.id==h.treeId||q||x||P||Q)&&(J||!J&&n.parentTId))s=h.treeObj;i?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):j&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10);K?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):G&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10);s&&s!=h.treeObj&&s.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+s.offset().left-h.treeObj.offset().left);}D.css({top:b.clientY+y+3+"px",left:b.clientX+k+3+"px"});i=a=0;if(s&&s.attr("id")!=h.treeId){var z=u==null?null:m.getNodeCache(h,u);c=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;a=!!(H&&u===H.tId);i=!!(R&&u===R.tId);k=n.parentTId&&n.parentTId==u;n=(c||!i)&&g.apply(h.edit.drag.prev,[h.treeId,l,z],!!h.edit.drag.prev);a=(c||!a)&&g.apply(h.edit.drag.next,[h.treeId,l,z],!!h.edit.drag.next);G=(c||!k)&&!(h.data.keep.leaf&&!z.isParent)&&g.apply(h.edit.drag.inner,[h.treeId,l,z],!!h.edit.drag.inner);if(!n&&!a&&!G){if(s=null,u="",w=d.move.TYPE_INNER,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;}else{c=v("#"+u+d.id.A,s);i=z.isLastNode?null:v("#"+z.getNextNode().tId+d.id.A,s.next());j=c.offset().top;k=c.offset().left;K=n?G?0.25:a?0.5:1:-1;G=a?G?0.75:n?0.5:0:-1;y=(b.clientY+y-j)/c.height();(K==1||y<=K&&y>=-0.2)&&n?(a=1-A.width(),i=j-A.height()/2,w=d.move.TYPE_PREV):(G==0||y>=G&&y<=1.2)&&a?(a=1-A.width(),i=i==null||z.isParent&&z.open?j+c.height()-A.height()/2:i.offset().top-A.height()/2,w=d.move.TYPE_NEXT):(a=5-A.width(),i=j,w=d.move.TYPE_INNER);A.css({display:"block",top:i+"px",left:k+a+"px"});c.addClass(d.node.TMPTARGET_NODE+"_"+w);if(T!=u||U!=w)L=new Date().getTime();if(z&&z.isParent&&w==d.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==z.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===z.tId&&(y=!1),y))window.zTreeMoveTimer=setTimeout(function(){w==d.move.TYPE_INNER&&z&&z.isParent&&!z.open&&new Date().getTime()-L>h.edit.drag.autoOpenTime&&g.apply(h.callback.beforeDragOpen,[h.treeId,z],!0)&&(f.switchNode(h,z),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(d.event.EXPAND,[h.treeId,z]));},h.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=z.tId;}}else if(w=d.move.TYPE_INNER,s&&g.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?s.addClass(d.node.TMPTARGET_TREE):s=null,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;T=u;U=w;e.treeObj.trigger(d.event.DRAGMOVE,[b,e.treeId,l]);}return!1;}function r(b){if(window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;U=T=null;F.unbind("mousemove",c);F.unbind("mouseup",r);F.unbind("selectstart",k);M.css("cursor","auto");s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));g.showIfameMask(e,!1);t.showHoverDom=!0;if(B.dragFlag!=0){B.dragFlag=0;var a,i,j;for(a=0,i=l.length;a<i;a++){j=l[a],j.isParent&&B.dragNodeShowBefore[j.tId]&&!j.open&&(f.expandCollapseNode(e,j,!j.open),delete B.dragNodeShowBefore[j.tId]);}D&&D.remove();A&&A.remove();var p=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;!p&&s&&u&&l[0].parentTId&&u==l[0].parentTId&&w==d.move.TYPE_INNER&&(s=null);if(s){var q=u==null?null:m.getNodeCache(h,u);if(g.apply(e.callback.beforeDrop,[h.treeId,l,q,w,p],!0)==!1)f.selectNodes(x,l);else{var C=p?g.clone(l):l;a=function a(){if(J){if(!p)for(var a=0,c=l.length;a<c;a++){f.removeNode(e,l[a]);}w==d.move.TYPE_INNER?f.addNodes(h,q,-1,C):f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);}else if(p&&w==d.move.TYPE_INNER)f.addNodes(h,q,-1,C);else if(p)f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);else if(w!=d.move.TYPE_NEXT)for(a=0,c=C.length;a<c;a++){f.moveNode(h,q,C[a],w,!1);}else for(a=-1,c=C.length-1;a<c;c--){f.moveNode(h,q,C[c],w,!1);}f.selectNodes(h,C);o(C[0],e).focus().blur();e.treeObj.trigger(d.event.DROP,[b,h.treeId,C,q,w,p]);};w==d.move.TYPE_INNER&&g.canAsync(h,q)?f.asyncNode(h,q,!1,a):a();}}else f.selectNodes(x,l),e.treeObj.trigger(d.event.DROP,[b,e.treeId,l,null,null,null]);}}function k(){return!1;}var i,j,e=m.getSetting(b.data.treeId),B=m.getRoot(e),t=m.getRoots();if(b.button==2||!e.edit.enable||!e.edit.drag.isCopy&&!e.edit.drag.isMove)return!0;var p=b.target,q=m.getRoot(e).curSelectedList,l=[];if(m.isSelectedNode(e,a))for(i=0,j=q.length;i<j;i++){if(q[i].editNameFlag&&g.eqs(p.tagName,"input")&&p.getAttribute("treeNode"+d.id.INPUT)!==null)return!0;l.push(q[i]);if(l[0].parentTId!==q[i].parentTId){l=[a];break;}}else l=[a];f.editNodeBlur=!0;f.cancelCurEditNode(e);var F=v(e.treeObj.get(0).ownerDocument),M=v(e.treeObj.get(0).ownerDocument.body),D,A,s,J=!1,h=e,x=e,H,R,T=null,U=null,u=null,w=d.move.TYPE_INNER,N=b.clientX,O=b.clientY,L=new Date().getTime();g.uCanDo(e)&&F.bind("mousemove",c);F.bind("mouseup",r);F.bind("selectstart",k);b.preventDefault&&b.preventDefault();return!0;}};v.extend(!0,v.fn.zTree.consts,I);v.extend(!0,v.fn.zTree._z,{tools:{getAbs:function getAbs(b){b=b.getBoundingClientRect();return[b.left+(document.body.scrollLeft+document.documentElement.scrollLeft),b.top+(document.body.scrollTop+document.documentElement.scrollTop)];},inputFocus:function inputFocus(b){b.get(0)&&(b.focus(),g.setCursorPosition(b.get(0),b.val().length));},inputSelect:function inputSelect(b){b.get(0)&&(b.focus(),b.select());},setCursorPosition:function setCursorPosition(b,a){if(b.setSelectionRange)b.focus(),b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0);c.moveEnd("character",a);c.moveStart("character",a);c.select();}},showIfameMask:function showIfameMask(b,a){for(var c=m.getRoot(b);c.dragMaskList.length>0;){c.dragMaskList[0].remove(),c.dragMaskList.shift();}if(a)for(var d=o("iframe",b),f=0,i=d.length;f<i;f++){var j=d.get(f),e=g.getAbs(j),j=o("<div id='zTreeMask_"+f+"' class='zTreeMask' style='top:"+e[1]+"px; left:"+e[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>",b);j.appendTo(o("body",b));c.dragMaskList.push(j);}}},view:{addEditBtn:function addEditBtn(b,a){if(!(a.editNameFlag||o(a,d.id.EDIT,b).length>0)&&g.apply(b.edit.showRenameBtn,[b.treeId,a],b.edit.showRenameBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" edit' id='"+a.tId+d.id.EDIT+"' title='"+g.apply(b.edit.renameTitle,[b.treeId,a],b.edit.renameTitle)+"' treeNode"+d.id.EDIT+" style='display:none;'></span>";c.append(r);o(a,d.id.EDIT,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeEditName,[b.treeId,a],!0)==!1)return!1;f.editNode(b,a);return!1;}).show();}},addRemoveBtn:function addRemoveBtn(b,a){if(!(a.editNameFlag||o(a,d.id.REMOVE,b).length>0)&&g.apply(b.edit.showRemoveBtn,[b.treeId,a],b.edit.showRemoveBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" remove' id='"+a.tId+d.id.REMOVE+"' title='"+g.apply(b.edit.removeTitle,[b.treeId,a],b.edit.removeTitle)+"' treeNode"+d.id.REMOVE+" style='display:none;'></span>";c.append(r);o(a,d.id.REMOVE,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeRemove,[b.treeId,a],!0)==!1)return!1;f.removeNode(b,a);b.treeObj.trigger(d.event.REMOVE,[b.treeId,a]);return!1;}).bind("mousedown",function(){return!0;}).show();}},addHoverDom:function addHoverDom(b,a){if(m.getRoots().showHoverDom)a.isHover=!0,b.edit.enable&&(f.addEditBtn(b,a),f.addRemoveBtn(b,a)),g.apply(b.view.addHoverDom,[b.treeId,a]);},cancelCurEditNode:function cancelCurEditNode(b,a,c){var r=m.getRoot(b),k=b.data.key.name,i=r.curEditNode;if(i){var j=r.curEditInput,a=a?a:c?i[k]:j.val();if(g.apply(b.callback.beforeRename,[b.treeId,i,a,c],!0)===!1)return!1;i[k]=a;o(i,d.id.A,b).removeClass(d.node.CURSELECTED_EDIT);j.unbind();f.setNodeName(b,i);i.editNameFlag=!1;r.curEditNode=null;r.curEditInput=null;f.selectNode(b,i,!1);b.treeObj.trigger(d.event.RENAME,[b.treeId,i,c]);}return r.noSelection=!0;},editNode:function editNode(b,a){var c=m.getRoot(b);f.editNodeBlur=!1;if(m.isSelectedNode(b,a)&&c.curEditNode==a&&a.editNameFlag)setTimeout(function(){g.inputFocus(c.curEditInput);},0);else{var r=b.data.key.name;a.editNameFlag=!0;f.removeTreeDom(b,a);f.cancelCurEditNode(b);f.selectNode(b,a,!1);o(a,d.id.SPAN,b).html("<input type=text class='rename' id='"+a.tId+d.id.INPUT+"' treeNode"+d.id.INPUT+" >");var k=o(a,d.id.INPUT,b);k.attr("value",a[r]);b.edit.editNameSelectAll?g.inputSelect(k):g.inputFocus(k);k.bind("blur",function(){f.editNodeBlur||f.cancelCurEditNode(b);}).bind("keydown",function(a){a.keyCode=="13"?(f.editNodeBlur=!0,f.cancelCurEditNode(b)):a.keyCode=="27"&&f.cancelCurEditNode(b,null,!0);}).bind("click",function(){return!1;}).bind("dblclick",function(){return!1;});o(a,d.id.A,b).addClass(d.node.CURSELECTED_EDIT);c.curEditInput=k;c.noSelection=!1;c.curEditNode=a;}},moveNode:function moveNode(b,a,c,r,k,i){var j=m.getRoot(b),e=b.data.key.children;if(a!=c&&(!b.data.keep.leaf||!a||a.isParent||r!=d.move.TYPE_INNER)){var g=c.parentTId?c.getParentNode():j,t=a===null||a==j;t&&a===null&&(a=j);if(t)r=d.move.TYPE_INNER;j=a.parentTId?a.getParentNode():j;if(r!=d.move.TYPE_PREV&&r!=d.move.TYPE_NEXT)r=d.move.TYPE_INNER;if(r==d.move.TYPE_INNER)if(t)c.parentTId=null;else{if(!a.isParent)a.isParent=!0,a.open=!!a.open,f.setNodeLineIcos(b,a);c.parentTId=a.tId;}var p;t?p=t=b.treeObj:(!i&&r==d.move.TYPE_INNER?f.expandCollapseNode(b,a,!0,!1):i||f.expandCollapseNode(b,a.getParentNode(),!0,!1),t=o(a,b),p=o(a,d.id.UL,b),t.get(0)&&!p.get(0)&&(p=[],f.makeUlHtml(b,a,p,""),t.append(p.join(""))),p=o(a,d.id.UL,b));var q=o(c,b);q.get(0)?t.get(0)||q.remove():q=f.appendNodes(b,c.level,[c],null,-1,!1,!0).join("");p.get(0)&&r==d.move.TYPE_INNER?p.append(q):t.get(0)&&r==d.move.TYPE_PREV?t.before(q):t.get(0)&&r==d.move.TYPE_NEXT&&t.after(q);var l=-1,v=0,x=null,t=null,D=c.level;if(c.isFirstNode){if(l=0,g[e].length>1)x=g[e][1],x.isFirstNode=!0;}else if(c.isLastNode)l=g[e].length-1,x=g[e][l-1],x.isLastNode=!0;else for(p=0,q=g[e].length;p<q;p++){if(g[e][p].tId==c.tId){l=p;break;}}l>=0&&g[e].splice(l,1);if(r!=d.move.TYPE_INNER)for(p=0,q=j[e].length;p<q;p++){j[e][p].tId==a.tId&&(v=p);}if(r==d.move.TYPE_INNER){a[e]||(a[e]=[]);if(a[e].length>0)t=a[e][a[e].length-1],t.isLastNode=!1;a[e].splice(a[e].length,0,c);c.isLastNode=!0;c.isFirstNode=a[e].length==1;}else a.isFirstNode&&r==d.move.TYPE_PREV?(j[e].splice(v,0,c),t=a,t.isFirstNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!0,c.isLastNode=!1):a.isLastNode&&r==d.move.TYPE_NEXT?(j[e].splice(v+1,0,c),t=a,t.isLastNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(r==d.move.TYPE_PREV?j[e].splice(v,0,c):j[e].splice(v+1,0,c),c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!1);m.fixPIdKeyValue(b,c);m.setSonNodeLevel(b,c.getParentNode(),c);f.setNodeLineIcos(b,c);f.repairNodeLevelClass(b,c,D);!b.data.keep.parent&&g[e].length<1?(g.isParent=!1,g.open=!1,a=o(g,d.id.UL,b),r=o(g,d.id.SWITCH,b),e=o(g,d.id.ICON,b),f.replaceSwitchClass(g,r,d.folder.DOCU),f.replaceIcoClass(g,e,d.folder.DOCU),a.css("display","none")):x&&f.setNodeLineIcos(b,x);t&&f.setNodeLineIcos(b,t);b.check&&b.check.enable&&f.repairChkClass&&(f.repairChkClass(b,g),f.repairParentChkClassWithSelf(b,g),g!=c.parent&&f.repairParentChkClassWithSelf(b,c));i||f.expandCollapseParentNode(b,c.getParentNode(),!0,k);}},removeEditBtn:function removeEditBtn(b,a){o(a,d.id.EDIT,b).unbind().remove();},removeRemoveBtn:function removeRemoveBtn(b,a){o(a,d.id.REMOVE,b).unbind().remove();},removeTreeDom:function removeTreeDom(b,a){a.isHover=!1;f.removeEditBtn(b,a);f.removeRemoveBtn(b,a);g.apply(b.view.removeHoverDom,[b.treeId,a]);},repairNodeLevelClass:function repairNodeLevelClass(b,a,c){if(c!==a.level){var f=o(a,b),g=o(a,d.id.A,b),b=o(a,d.id.UL,b),c=d.className.LEVEL+c,a=d.className.LEVEL+a.level;f.removeClass(c);f.addClass(a);g.removeClass(c);g.addClass(a);b.removeClass(c);b.addClass(a);}},selectNodes:function selectNodes(b,a){for(var c=0,d=a.length;c<d;c++){f.selectNode(b,a[c],c>0);}}},event:{},data:{setSonNodeLevel:function setSonNodeLevel(b,a,c){if(c){var d=b.data.key.children;c.level=a?a.level+1:0;if(c[d])for(var a=0,f=c[d].length;a<f;a++){c[d][a]&&m.setSonNodeLevel(b,c,c[d][a]);}}}}});var H=v.fn.zTree,g=H._z.tools,d=H.consts,f=H._z.view,m=H._z.data,o=g.$;m.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});m.addInitBind(function(b){var a=b.treeObj,c=d.event;a.bind(c.RENAME,function(a,c,d,f){g.apply(b.callback.onRename,[a,c,d,f]);});a.bind(c.DRAG,function(a,c,d,f){g.apply(b.callback.onDrag,[c,d,f]);});a.bind(c.DRAGMOVE,function(a,c,d,f){g.apply(b.callback.onDragMove,[c,d,f]);});a.bind(c.DROP,function(a,c,d,f,e,m,o){g.apply(b.callback.onDrop,[c,d,f,e,m,o]);});});m.addInitUnBind(function(b){var b=b.treeObj,a=d.event;b.unbind(a.RENAME);b.unbind(a.DRAG);b.unbind(a.DRAGMOVE);b.unbind(a.DROP);});m.addInitCache(function(){});m.addInitNode(function(b,a,c){if(c)c.isHover=!1,c.editNameFlag=!1;});m.addInitProxy(function(b){var a=b.target,c=m.getSetting(b.data.treeId),f=b.relatedTarget,k="",i=null,j="",e=null,o=null;if(g.eqs(b.type,"mouseover")){if(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}]))k=g.getNodeMainDom(o).id,j="hoverOverNode";}else if(g.eqs(b.type,"mouseout"))o=g.getMDom(c,f,[{tagName:"a",attrName:"treeNode"+d.id.A}]),o||(k="remove",j="hoverOutNode");else if(g.eqs(b.type,"mousedown")&&(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}])))k=g.getNodeMainDom(o).id,j="mousedownNode";if(k.length>0)switch(i=m.getNodeCache(c,k),j){case"mousedownNode":e=x.onMousedownNode;break;case"hoverOverNode":e=x.onHoverOverNode;break;case"hoverOutNode":e=x.onHoverOutNode;}return{stop:!1,node:i,nodeEventType:j,nodeEventCallback:e,treeEventType:"",treeEventCallback:null};});m.addInitRoot(function(b){var b=m.getRoot(b),a=m.getRoots();b.curEditNode=null;b.curEditInput=null;b.curHoverNode=null;b.dragFlag=0;b.dragNodeShowBefore=[];b.dragMaskList=[];a.showHoverDom=!0;});m.addZTreeTools(function(b,a){a.cancelEditName=function(a){m.getRoot(this.setting).curEditNode&&f.cancelCurEditNode(this.setting,a?a:null,!0);};a.copyNode=function(a,b,k,i){if(!b)return null;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;var j=this,e=g.clone(b);if(!a)a=null,k=d.move.TYPE_INNER;k==d.move.TYPE_INNER?(b=function b(){f.addNodes(j.setting,a,-1,[e],i);},g.canAsync(this.setting,a)?f.asyncNode(this.setting,a,i,b):b()):(f.addNodes(this.setting,a.parentNode,-1,[e],i),f.moveNode(this.setting,a,e,k,!1,i));return e;};a.editName=function(a){a&&a.tId&&a===m.getNodeCache(this.setting,a.tId)&&(a.parentTId&&f.expandCollapseParentNode(this.setting,a.getParentNode(),!0),f.editNode(this.setting,a));};a.moveNode=function(a,b,k,i){function j(){f.moveNode(e.setting,a,b,k,!1,i);}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;else if(a&&(b.parentTId==a.tId&&k==d.move.TYPE_INNER||o(b,this.setting).find("#"+a.tId).length>0))return null;else a||(a=null);var e=this;g.canAsync(this.setting,a)&&k===d.move.TYPE_INNER?f.asyncNode(this.setting,a,i,j):j();return b;};a.setEditable=function(a){this.setting.edit.enable=a;return this.refresh();};});var N=f.cancelPreSelectedNode;f.cancelPreSelectedNode=function(b,a){for(var c=m.getRoot(b).curSelectedList,d=0,g=c.length;d<g;d++){if(!a||a===c[d])if(f.removeTreeDom(b,c[d]),a)break;}N&&N.apply(f,arguments);};var O=f.createNodes;f.createNodes=function(b,a,c,d,g){O&&O.apply(f,arguments);c&&f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(b,d);};var V=f.makeNodeUrl;f.makeNodeUrl=function(b,a){return b.edit.enable?null:V.apply(f,arguments);};var L=f.removeNode;f.removeNode=function(b,a){var c=m.getRoot(b);if(c.curEditNode===a)c.curEditNode=null;L&&L.apply(f,arguments);};var P=f.selectNode;f.selectNode=function(b,a,c){var d=m.getRoot(b);if(m.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag)return!1;P&&P.apply(f,arguments);f.addHoverDom(b,a);return!0;};var Q=g.uCanDo;g.uCanDo=function(b,a){var c=m.getRoot(b);if(a&&(g.eqs(a.type,"mouseover")||g.eqs(a.type,"mouseout")||g.eqs(a.type,"mousedown")||g.eqs(a.type,"mouseup")))return!0;if(c.curEditNode)f.editNodeBlur=!1,c.curEditInput.focus();return!c.curEditNode&&(Q?Q.apply(f,arguments):!0);};})(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(t){"use strict";var e=Math.PI/180,n={version:"1.2.2",stages:[],idCounter:0,ids:{},names:{},shapes:{},listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,showWarnings:!0,Filters:{},isDragging:function isDragging(){var t=n.DD;return!!t&&t.isDragging;},isDragReady:function isDragReady(){var t=n.DD;return!!t&&!!t.node;},_addId:function _addId(t,e){void 0!==e&&(this.ids[e]=t);},_removeId:function _removeId(t){void 0!==t&&delete this.ids[t];},_addName:function _addName(t,e){e&&(this.names[e]||(this.names[e]=[]),this.names[e].push(t));},_removeName:function _removeName(t,e){if(t){var n=this.names[t];if(n){for(var i=0;i<n.length;i++){var a=n[i];a._id===e&&n.splice(i,1);}0===n.length&&delete this.names[t];}}},getAngle:function getAngle(t){return this.angleDeg?t*e:t;},_detectIE:function _detectIE(t){var e=t.indexOf("msie ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);var n=t.indexOf("trident/");if(n>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10);}var a=t.indexOf("edge/");return a>0&&parseInt(t.substring(a+5,t.indexOf(".",a)),10);},_parseUA:function _parseUA(t){var e=t.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],a=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),r=!!t.match(/IEMobile/i);return{browser:i[1]||"",version:i[2]||"0",isIE:n._detectIE(e),mobile:a,ieMobile:r};},UA:void 0},i="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof WorkerGlobalScope?self:{};if(n.UA=n._parseUA(i.navigator&&i.navigator.userAgent||""),i.Konva&&console.error("Konva instance is already exist in current eviroment. Please use only one instance."),i.Konva=n,n.global=i,"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))){if(i.window&&i.window.document)n.document=i.window.document,n.window=i.window;else{var a=require("canvas"),r=require("jsdom").jsdom;n.window=r("<!DOCTYPE html><html><head></head><body></body></html>").defaultView,n.document=n.window.document,n.window.Image=a.Image,n._nodeCanvas=a;}return void(module.exports=n);}"function"==typeof define&&define.amd&&define(function(){return n;}),n.document=document,n.window=window;}("undefined"!=typeof window?window:global),function(){"use strict";Konva.Collection=function(){var t=[].slice.call(arguments),e=t.length,n=0;for(this.length=e;n<e;n++){this[n]=t[n];}return this;},Konva.Collection.prototype=[],Konva.Collection.prototype.each=function(t){for(var e=0;e<this.length;e++){t(this[e],e);}},Konva.Collection.prototype.toArray=function(){var t,e=[],n=this.length;for(t=0;t<n;t++){e.push(this[t]);}return e;},Konva.Collection.toCollection=function(t){var e,n=new Konva.Collection(),i=t.length;for(e=0;e<i;e++){n.push(t[e]);}return n;},Konva.Collection._mapMethod=function(t){Konva.Collection.prototype[t]=function(){var e,n=this.length,i=[].slice.call(arguments);for(e=0;e<n;e++){this[e][t].apply(this[e],i);}return this;};},Konva.Collection.mapMethods=function(t){var e=t.prototype;for(var n in e){Konva.Collection._mapMethod(n);}},Konva.Transform=function(t){this.m=t&&t.slice()||[1,0,0,1,0,0];},Konva.Transform.prototype={copy:function copy(){return new Konva.Transform(this.m);},point:function point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]};},translate:function translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this;},scale:function scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this;},rotate:function rotate(t){var e=Math.cos(t),n=Math.sin(t),i=this.m[0]*e+this.m[2]*n,a=this.m[1]*e+this.m[3]*n,r=this.m[0]*-n+this.m[2]*e,o=this.m[1]*-n+this.m[3]*e;return this.m[0]=i,this.m[1]=a,this.m[2]=r,this.m[3]=o,this;},getTranslation:function getTranslation(){return{x:this.m[4],y:this.m[5]};},skew:function skew(t,e){var n=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,a=this.m[2]+this.m[0]*t,r=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=i,this.m[2]=a,this.m[3]=r,this;},multiply:function multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],a=this.m[1]*t.m[2]+this.m[3]*t.m[3],r=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=a,this.m[4]=r,this.m[5]=o,this;},invert:function invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,i=-this.m[2]*t,a=this.m[0]*t,r=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=a,this.m[4]=r,this.m[5]=o,this;},getMatrix:function getMatrix(){return this.m;},setAbsolutePosition:function setAbsolutePosition(t,e){var n=this.m[0],i=this.m[1],a=this.m[2],r=this.m[3],o=this.m[4],s=this.m[5],h=(n*(e-s)-i*(t-o))/(n*r-i*a),l=(t-o-a*h)/n;return this.translate(l,h);}};var t="2d",e="[object Array]",n="[object Number]",i="[object String]",a=Math.PI/180,r=180/Math.PI,o="#",s="",h="0",l="Konva warning: ",c="Konva error: ",d="rgb(",u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},g=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Konva.Util={_isElement:function _isElement(t){return!(!t||1!=t.nodeType);},_isFunction:function _isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply);},_isObject:function _isObject(t){return!!t&&t.constructor===Object;},_isArray:function _isArray(t){return Object.prototype.toString.call(t)===e;},_isNumber:function _isNumber(t){return Object.prototype.toString.call(t)===n;},_isString:function _isString(t){return Object.prototype.toString.call(t)===i;},_throttle:function _throttle(t,e,n){var i,a,r,o=null,s=0,h=n||{},l=function l(){s=h.leading===!1?0:new Date().getTime(),o=null,r=t.apply(i,a),i=a=null;};return function(){var n=new Date().getTime();s||h.leading!==!1||(s=n);var c=e-(n-s);return i=this,a=arguments,c<=0?(clearTimeout(o),o=null,s=n,r=t.apply(i,a),i=a=null):o||h.trailing===!1||(o=setTimeout(l,c)),r;};},_hasMethods:function _hasMethods(t){var e,n=[];for(e in t){t.hasOwnProperty(e)&&this._isFunction(t[e])&&n.push(e);}return n.length>0;},isValidSelector:function isValidSelector(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase();},createCanvasElement:function createCanvasElement(){var t=Konva.document.createElement("canvas");try{t.style=t.style||{};}catch(t){}return t;},isBrowser:function isBrowser(){return"object"!=(typeof exports==="undefined"?"undefined":_typeof(exports));},_isInDocument:function _isInDocument(t){for(;t=t.parentNode;){if(t==Konva.document)return!0;}return!1;},_simplifyArray:function _simplifyArray(t){var e,n,i=[],a=t.length,r=Konva.Util;for(e=0;e<a;e++){n=t[e],r._isNumber(n)?n=Math.round(1e3*n)/1e3:r._isString(n)||(n=n.toString()),i.push(n);}return i;},_getImage:function _getImage(e,n){var i,a;if(e){if(this._isElement(e))n(e);else if(this._isString(e))i=new Konva.window.Image(),i.onload=function(){n(i);},i.src=e;else if(e.data){a=Konva.Util.createCanvasElement(),a.width=e.width,a.height=e.height;var r=a.getContext(t);r.putImageData(e,0,0),this._getImage(a.toDataURL(),n);}else n(null);}else n(null);},_getRGBAString:function _getRGBAString(t){var e=t.red||0,n=t.green||0,i=t.blue||0,a=t.alpha||1;return["rgba(",e,",",n,",",i,",",a,")"].join(s);},_rgbToHex:function _rgbToHex(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1);},_hexToRgb:function _hexToRgb(t){t=t.replace(o,s);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e};},getRandomColor:function getRandomColor(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;){t=h+t;}return o+t;},get:function get(t,e){return void 0===t?e:t;},getRGB:function getRGB(t){var e;return t in u?(e=u[t],{r:e[0],g:e[1],b:e[2]}):t[0]===o?this._hexToRgb(t.substring(1)):t.substr(0,4)===d?(e=g.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0};},colorToRGBA:function colorToRGBA(t){return t=t||"black",Konva.Util._namedColorToRBA(t)||Konva.Util._hex3ColorToRGBA(t)||Konva.Util._hex6ColorToRGBA(t)||Konva.Util._rgbColorToRGBA(t)||Konva.Util._rgbaColorToRGBA(t);},_namedColorToRBA:function _namedColorToRBA(t){var e=u[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null;},_rgbColorToRGBA:function _rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1};}},_rgbaColorToRGBA:function _rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]};}},_hex6ColorToRGBA:function _hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1};},_hex3ColorToRGBA:function _hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1};},_merge:function _merge(t,e){var n=this._clone(e);for(var i in t){this._isObject(t[i])?n[i]=this._merge(t[i],n[i]):n[i]=t[i];}return n;},cloneObject:function cloneObject(t){var e={};for(var n in t){this._isObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];}return e;},cloneArray:function cloneArray(t){return t.slice(0);},_degToRad:function _degToRad(t){return t*a;},_radToDeg:function _radToDeg(t){return t*r;},_capitalize:function _capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1);},throw:function _throw(t){throw new Error(c+t);},error:function error(t){console.error(c+t);},warn:function warn(t){Konva.global.console&&console.warn&&Konva.showWarnings&&console.warn(l+t);},extend:function extend(t,e){function n(){this.constructor=t;}n.prototype=e.prototype;var i=t.prototype;t.prototype=new n();for(var a in i){i.hasOwnProperty(a)&&(t.prototype[a]=i[a]);}t.__super__=e.prototype,t.super=e;},addMethods:function addMethods(t,e){var n;for(n in e){t.prototype[n]=e[n];}},_getControlPoints:function _getControlPoints(t,e,n,i,a,r,o){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),h=Math.sqrt(Math.pow(a-n,2)+Math.pow(r-i,2)),l=o*s/(s+h),c=o*h/(s+h),d=n-l*(a-t),u=i-l*(r-e),g=n+c*(a-t),f=i+c*(r-e);return[d,u,g,f];},_expandPoints:function _expandPoints(t,e){var n,i,a=t.length,r=[];for(n=2;n<a-2;n+=2){i=Konva.Util._getControlPoints(t[n-2],t[n-1],t[n],t[n+1],t[n+2],t[n+3],e),r.push(i[0]),r.push(i[1]),r.push(t[n]),r.push(t[n+1]),r.push(i[2]),r.push(i[3]);}return r;},_removeLastLetter:function _removeLastLetter(t){return t.substring(0,t.length-1);},each:function each(t,e){for(var n in t){e(n,t[n]);}},_getProjectionToSegment:function _getProjectionToSegment(t,e,n,i,a,r){var o,s,h,l=(t-n)*(t-n)+(e-i)*(e-i);if(0==l)o=t,s=e,h=(a-n)*(a-n)+(r-i)*(r-i);else{var c=((a-t)*(n-t)+(r-e)*(i-e))/l;c<0?(o=t,s=e,h=(t-a)*(t-a)+(e-r)*(e-r)):c>1?(o=n,s=i,h=(n-a)*(n-a)+(i-r)*(i-r)):(o=t+c*(n-t),s=e+c*(i-e),h=(o-a)*(o-a)+(s-r)*(s-r));}return[o,s,h];},_getProjectionToLine:function _getProjectionToLine(t,e,n){var i=Konva.Util.cloneObject(t),a=Number.MAX_VALUE;return e.forEach(function(r,o){if(n||o!==e.length-1){var s=e[(o+1)%e.length],h=Konva.Util._getProjectionToSegment(r.x,r.y,s.x,s.y,t.x,t.y),l=h[0],c=h[1],d=h[2];d<a&&(i.x=l,i.y=c,a=d);}}),i;},_prepareArrayForTween:function _prepareArrayForTween(t,e,n){var i,a=[],r=[];if(t.length>e.length){var o=e;e=t,t=o;}for(i=0;i<t.length;i+=2){a.push({x:t[i],y:t[i+1]});}for(i=0;i<e.length;i+=2){r.push({x:e[i],y:e[i+1]});}var s=[];return r.forEach(function(t){var e=Konva.Util._getProjectionToLine(t,a,n);s.push(e.x),s.push(e.y);}),s;},_prepareToStringify:function _prepareToStringify(t){var e;t.visitedByCircularReferenceRemoval=!0;for(var n in t){if(t.hasOwnProperty(n)&&t[n]&&"object"==_typeof(t[n]))if(e=Object.getOwnPropertyDescriptor(t,n),t[n].visitedByCircularReferenceRemoval||Konva.Util._isElement(t[n])){if(!e.configurable)return null;delete t[n];}else if(null===Konva.Util._prepareToStringify(t[n])){if(!e.configurable)return null;delete t[n];}}return delete t.visitedByCircularReferenceRemoval,t;}};}(),function(){"use strict";var t=Konva.Util.createCanvasElement(),e=t.getContext("2d"),n=function(){var t=Konva.window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n;}();Konva.Canvas=function(t){this.init(t);},Konva.Canvas.prototype={init:function init(t){var e=t||{},i=e.pixelRatio||Konva.pixelRatio||n;this.pixelRatio=i,this._canvas=Konva.Util.createCanvasElement(),this._canvas.style.padding=0,this._canvas.style.margin=0,this._canvas.style.border=0,this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top=0,this._canvas.style.left=0;},getContext:function getContext(){return this.context;},getPixelRatio:function getPixelRatio(){return this.pixelRatio;},setPixelRatio:function setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e);},setWidth:function setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e);},setHeight:function setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e);},getWidth:function getWidth(){return this.width;},getHeight:function getHeight(){return this.height;},setSize:function setSize(t,e){this.setWidth(t),this.setHeight(e);},toDataURL:function toDataURL(t,e){try{return this._canvas.toDataURL(t,e);}catch(t){try{return this._canvas.toDataURL();}catch(t){return Konva.Util.warn("Unable to get data URL. "+t.message),"";}}}},Konva.SceneCanvas=function(t){var e=t||{},n=e.width||0,i=e.height||0;Konva.Canvas.call(this,e),this.context=new Konva.SceneContext(this),this.setSize(n,i);},Konva.Util.extend(Konva.SceneCanvas,Konva.Canvas),Konva.HitCanvas=function(t){var e=t||{},n=e.width||0,i=e.height||0;Konva.Canvas.call(this,e),this.context=new Konva.HitContext(this),this.setSize(n,i),this.hitCanvas=!0;},Konva.Util.extend(Konva.HitCanvas,Konva.Canvas);}(),function(){"use strict";var t=",",e="(",n=")",i="([",a="])",r=";",o="()",s="=",h=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],l=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation"];Konva.Context=function(t){this.init(t);},Konva.Context.prototype={init:function init(t){this.canvas=t,this._context=t._canvas.getContext("2d"),Konva.enableTrace&&(this.traceArr=[],this._enableTrace());},fillShape:function fillShape(t){t.getFillEnabled()&&this._fill(t);},strokeShape:function strokeShape(t){t.getStrokeEnabled()&&this._stroke(t);},fillStrokeShape:function fillStrokeShape(t){var e=t.getFillEnabled();e&&this._fill(t),t.getStrokeEnabled()&&this._stroke(t);},getTrace:function getTrace(h){var l,c,d,u,g=this.traceArr,f=g.length,v="";for(l=0;l<f;l++){c=g[l],d=c.method,d?(u=c.args,v+=d,v+=h?o:Konva.Util._isArray(u[0])?i+u.join(t)+a:e+u.join(t)+n):(v+=c.property,h||(v+=s+c.val)),v+=r;}return v;},clearTrace:function clearTrace(){this.traceArr=[];},_trace:function _trace(t){var e,n=this.traceArr;n.push(t),e=n.length,e>=Konva.traceArrMax&&n.shift();},reset:function reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0);},getCanvas:function getCanvas(){return this.canvas;},clear:function clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio);},_applyLineCap:function _applyLineCap(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e);},_applyOpacity:function _applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e);},_applyLineJoin:function _applyLineJoin(t){var e=t.getLineJoin();e&&this.setAttr("lineJoin",e);},setAttr:function setAttr(t,e){this._context[t]=e;},arc:function arc(){var t=arguments;this._context.arc(t[0],t[1],t[2],t[3],t[4],t[5]);},beginPath:function beginPath(){this._context.beginPath();},bezierCurveTo:function bezierCurveTo(){var t=arguments;this._context.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]);},clearRect:function clearRect(){var t=arguments;this._context.clearRect(t[0],t[1],t[2],t[3]);},clip:function clip(){this._context.clip();},closePath:function closePath(){this._context.closePath();},createImageData:function createImageData(){var t=arguments;return 2===t.length?this._context.createImageData(t[0],t[1]):1===t.length?this._context.createImageData(t[0]):void 0;},createLinearGradient:function createLinearGradient(){var t=arguments;return this._context.createLinearGradient(t[0],t[1],t[2],t[3]);},createPattern:function createPattern(){var t=arguments;return this._context.createPattern(t[0],t[1]);},createRadialGradient:function createRadialGradient(){var t=arguments;return this._context.createRadialGradient(t[0],t[1],t[2],t[3],t[4],t[5]);},drawImage:function drawImage(){var t=arguments,e=this._context;3===t.length?e.drawImage(t[0],t[1],t[2]):5===t.length?e.drawImage(t[0],t[1],t[2],t[3],t[4]):9===t.length&&e.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);},isPointInPath:function isPointInPath(t,e){return this._context.isPointInPath(t,e);},fill:function fill(){this._context.fill();},fillRect:function fillRect(t,e,n,i){this._context.fillRect(t,e,n,i);},strokeRect:function strokeRect(t,e,n,i){this._context.strokeRect(t,e,n,i);},fillText:function fillText(){var t=arguments;this._context.fillText(t[0],t[1],t[2]);},measureText:function measureText(t){return this._context.measureText(t);},getImageData:function getImageData(){var t=arguments;return this._context.getImageData(t[0],t[1],t[2],t[3]);},lineTo:function lineTo(){var t=arguments;this._context.lineTo(t[0],t[1]);},moveTo:function moveTo(){var t=arguments;this._context.moveTo(t[0],t[1]);},rect:function rect(){var t=arguments;this._context.rect(t[0],t[1],t[2],t[3]);},putImageData:function putImageData(){var t=arguments;this._context.putImageData(t[0],t[1],t[2]);},quadraticCurveTo:function quadraticCurveTo(){var t=arguments;this._context.quadraticCurveTo(t[0],t[1],t[2],t[3]);},restore:function restore(){this._context.restore();},rotate:function rotate(){var t=arguments;this._context.rotate(t[0]);},save:function save(){this._context.save();},scale:function scale(){var t=arguments;this._context.scale(t[0],t[1]);},setLineDash:function setLineDash(){var t=arguments,e=this._context;this._context.setLineDash?e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0]);},getLineDash:function getLineDash(){return this._context.getLineDash();},setTransform:function setTransform(){var t=arguments;this._context.setTransform(t[0],t[1],t[2],t[3],t[4],t[5]);},stroke:function stroke(){this._context.stroke();},strokeText:function strokeText(){var t=arguments;this._context.strokeText(t[0],t[1],t[2]);},transform:function transform(){var t=arguments;this._context.transform(t[0],t[1],t[2],t[3],t[4],t[5]);},translate:function translate(){var t=arguments;this._context.translate(t[0],t[1]);},_enableTrace:function _enableTrace(){var t,e,n=this,i=h.length,a=Konva.Util._simplifyArray,r=this.setAttr,o=function o(t){var i,r=n[t];n[t]=function(){return e=a(Array.prototype.slice.call(arguments,0)),i=r.apply(n,arguments),n._trace({method:t,args:e}),i;};};for(t=0;t<i;t++){o(h[t]);}n.setAttr=function(){r.apply(n,arguments),n._trace({property:arguments[0],val:arguments[1]});};}},l.forEach(function(t){Object.defineProperty(Konva.Context.prototype,t,{get:function get(){return this._context[t];},set:function set(e){this._context[t]=e;}});}),Konva.SceneContext=function(t){Konva.Context.call(this,t);},Konva.SceneContext.prototype={_fillColor:function _fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this);},_fillPattern:function _fillPattern(t){var e=t.getFillPatternX(),n=t.getFillPatternY(),i=t.getFillPatternScale(),a=Konva.getAngle(t.getFillPatternRotation()),r=t.getFillPatternOffset();(e||n)&&this.translate(e||0,n||0),a&&this.rotate(a),i&&this.scale(i.x,i.y),r&&this.translate(-1*r.x,-1*r.y),this.setAttr("fillStyle",this.createPattern(t.getFillPatternImage(),t.getFillPatternRepeat()||"repeat")),this.fill();},_fillLinearGradient:function _fillLinearGradient(t){var e=t.getFillLinearGradientStartPoint(),n=t.getFillLinearGradientEndPoint(),i=t.getFillLinearGradientColorStops(),a=this.createLinearGradient(e.x,e.y,n.x,n.y);if(i){for(var r=0;r<i.length;r+=2){a.addColorStop(i[r],i[r+1]);}this.setAttr("fillStyle",a),t._fillFunc(this);}},_fillRadialGradient:function _fillRadialGradient(t){for(var e=t.getFillRadialGradientStartPoint(),n=t.getFillRadialGradientEndPoint(),i=t.getFillRadialGradientStartRadius(),a=t.getFillRadialGradientEndRadius(),r=t.getFillRadialGradientColorStops(),o=this.createRadialGradient(e.x,e.y,i,n.x,n.y,a),s=0;s<r.length;s+=2){o.addColorStop(r[s],r[s+1]);}this.setAttr("fillStyle",o),this.fill();},_fill:function _fill(t){var e=t.fill(),n=t.getFillPatternImage(),i=t.getFillLinearGradientColorStops(),a=t.getFillRadialGradientColorStops(),r=t.getFillPriority();e&&"color"===r?this._fillColor(t):n&&"pattern"===r?this._fillPattern(t):i&&"linear-gradient"===r?this._fillLinearGradient(t):a&&"radial-gradient"===r?this._fillRadialGradient(t):e?this._fillColor(t):n?this._fillPattern(t):i?this._fillLinearGradient(t):a&&this._fillRadialGradient(t);},_stroke:function _stroke(t){var e=t.dash(),n=t.getStrokeScaleEnabled()||t instanceof Konva.Text;t.hasStroke()&&(n||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(t),e&&t.dashEnabled()&&this.setLineDash(e),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.stroke()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t._strokeFunc(this),n||this.restore());},_applyShadow:function _applyShadow(t){var e=Konva.Util,n=e.get(t.getShadowRGBA(),"black"),i=e.get(t.getShadowBlur(),5),a=e.get(t.getShadowOffset(),{x:0,y:0}),r=t.getAbsoluteScale(),o=r.x,s=r.y;this.setAttr("shadowColor",n),this.setAttr("shadowBlur",i),this.setAttr("shadowOffsetX",a.x*o),this.setAttr("shadowOffsetY",a.y*s);}},Konva.Util.extend(Konva.SceneContext,Konva.Context),Konva.HitContext=function(t){Konva.Context.call(this,t);},Konva.HitContext.prototype={_fill:function _fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore();},_stroke:function _stroke(t){if(t.hasStroke()&&t.strokeHitEnabled()){var e=t.getStrokeScaleEnabled()||t instanceof Konva.Text;e||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(t),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore();}}},Konva.Util.extend(Konva.HitContext,Konva.Context);}(),function(){"use strict";var t="get",e="set";Konva.Factory={addGetterSetter:function addGetterSetter(t,e,n,i,a){this.addGetter(t,e,n),this.addSetter(t,e,i,a),this.addOverloadedGetterSetter(t,e);},addGetter:function addGetter(e,n,i){var a=t+Konva.Util._capitalize(n);e.prototype[a]=function(){var t=this.attrs[n];return void 0===t?i:t;};},addSetter:function addSetter(t,n,i,a){var r=e+Konva.Util._capitalize(n);t.prototype[r]=function(t){return i&&(t=i.call(this,t)),this._setAttr(n,t),a&&a.call(this),this;};},addComponentsGetterSetter:function addComponentsGetterSetter(n,i,a,r,o){var s,h,l=a.length,c=Konva.Util._capitalize,d=t+c(i),u=e+c(i);n.prototype[d]=function(){var t={};for(s=0;s<l;s++){h=a[s],t[h]=this.getAttr(i+c(h));}return t;},n.prototype[u]=function(t){var e,n=this.attrs[i];r&&(t=r.call(this,t));for(e in t){t.hasOwnProperty(e)&&this._setAttr(i+c(e),t[e]);}return this._fireChangeEvent(i,n,t),o&&o.call(this),this;},this.addOverloadedGetterSetter(n,i);},addOverloadedGetterSetter:function addOverloadedGetterSetter(n,i){var a=Konva.Util._capitalize(i),r=e+a,o=t+a;n.prototype[i]=function(){return arguments.length?(this[r](arguments[0]),this):this[o]();};},addDeprecatedGetterSetter:function addDeprecatedGetterSetter(e,n,i,a){var r=t+Konva.Util._capitalize(n),o=n+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[r]=function(){Konva.Util.error(o);var t=this.attrs[n];return void 0===t?i:t;},this.addSetter(e,n,a,function(){Konva.Util.error(o);}),this.addOverloadedGetterSetter(e,n);},backCompat:function backCompat(t,e){Konva.Util.each(e,function(e,n){var i=t.prototype[n];t.prototype[e]=function(){i.apply(this,arguments),Konva.Util.error(e+" method is deprecated and will be removed soon. Use "+n+" instead");};});},afterSetFilter:function afterSetFilter(){this._filterUpToDate=!1;}},Konva.Validators={RGBComponent:function RGBComponent(t){return t>255?255:t<0?0:Math.round(t);},alphaComponent:function alphaComponent(t){return t>1?1:t<1e-4?1e-4:t;}};}(),function(t){"use strict";var e="absoluteOpacity",n="absoluteTransform",i="absoluteScale",a="Change",r="children",o=".",s="",h="get",l="id",c="konva",d="listening",u="mouseenter",g="mouseleave",f="name",v="set",p="Shape",m=" ",_="stage",y="transform",S="Stage",C="visible",K=["id"],w=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(m),x=["scaleXChange.konva","scaleYChange.konva"].join(m);t.Node=function(t){this._init(t);},t.Util.addMethods(t.Node,{_init:function _init(a){var r=this;this._id=t.idCounter++,this.eventListeners={},this.attrs={},this._cache={},this._filterUpToDate=!1,this.setAttrs(a),this.on(w,function(){this._clearCache(y),r._clearSelfAndDescendantCache(n);}),this.on(x,function(){r._clearSelfAndDescendantCache(i);}),this.on("visibleChange.konva",function(){r._clearSelfAndDescendantCache(C);}),this.on("listeningChange.konva",function(){r._clearSelfAndDescendantCache(d);}),this.on("opacityChange.konva",function(){r._clearSelfAndDescendantCache(e);});},_clearCache:function _clearCache(t){t?delete this._cache[t]:this._cache={};},_getCache:function _getCache(t,e){var n=this._cache[t];return void 0===n&&(this._cache[t]=e.call(this)),this._cache[t];},_clearSelfAndDescendantCache:function _clearSelfAndDescendantCache(t){this._clearCache(t),this.children&&this.getChildren().each(function(e){e._clearSelfAndDescendantCache(t);});},clearCache:function clearCache(){return delete this._cache.canvas,this._filterUpToDate=!1,this;},cache:function cache(e){var n=e||{},i=this.getClientRect(!0),a=n.width||i.width,r=n.height||i.height,o=n.x||i.x,s=n.y||i.y,h=n.offset||0,l=n.drawBorder||!1;if(!a||!r)throw new Error("Width or height of caching configuration equals 0.");a+=2*h,r+=2*h,o-=h,s-=h;var c=new t.SceneCanvas({width:a,height:r}),d=new t.SceneCanvas({width:a,height:r}),u=new t.HitCanvas({pixelRatio:1,width:a,height:r}),g=c.getContext(),f=u.getContext();return u.isCache=!0,this.clearCache(),g.save(),f.save(),g.translate(-o,-s),f.translate(-o,-s),this.drawScene(c,this,!0),this.drawHit(u,this,!0),g.restore(),f.restore(),l&&(g.save(),g.beginPath(),g.rect(0,0,a,r),g.closePath(),g.setAttr("strokeStyle","red"),g.setAttr("lineWidth",5),g.stroke(),g.restore()),this._cache.canvas={scene:c,filter:d,hit:u,x:o,y:s},this;},getClientRect:function getClientRect(){throw new Error('abstract "getClientRect" method call');},_transformedRect:function _transformedRect(t){var e,n,i,a,r=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o=this.getTransform();return r.forEach(function(t){var r=o.point(t);void 0===e&&(e=i=r.x,n=a=r.y),e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x),a=Math.max(a,r.y);}),{x:e,y:n,width:i-e,height:a-n};},_drawCachedSceneCanvas:function _drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t.translate(this._cache.canvas.x,this._cache.canvas.y);var e=this._getCachedSceneCanvas(),n=e.pixelRatio;t.drawImage(e._canvas,0,0,e.width/n,e.height/n),t.restore();},_drawCachedHitCanvas:function _drawCachedHitCanvas(t){var e=this._cache.canvas,n=e.hit;t.save(),t.translate(this._cache.canvas.x,this._cache.canvas.y),t.drawImage(n._canvas,0,0),t.restore();},_getCachedSceneCanvas:function _getCachedSceneCanvas(){var e,n,i,a,r=this.filters(),o=this._cache.canvas,s=o.scene,h=o.filter,l=h.getContext();if(r){if(!this._filterUpToDate){var c=s.pixelRatio;try{for(e=r.length,l.clear(),l.drawImage(s._canvas,0,0,s.getWidth()/c,s.getHeight()/c),n=l.getImageData(0,0,h.getWidth(),h.getHeight()),i=0;i<e;i++){a=r[i],"function"==typeof a?(a.call(this,n),l.putImageData(n,0,0)):t.Util.error("Filter should be type of function, but got "+(typeof a==="undefined"?"undefined":_typeof(a))+" insted. Please check correct filters");}}catch(e){t.Util.error("Unable to apply filter. "+e.message);}this._filterUpToDate=!0;}return h;}return s;},on:function on(t,e){if(3===arguments.length)return this._delegate.apply(this,arguments);var n,i,a,r,h,l=t.split(m),c=l.length;for(n=0;n<c;n++){i=l[n],a=i.split(o),r=a[0],h=a[1]||s,this.eventListeners[r]||(this.eventListeners[r]=[]),this.eventListeners[r].push({name:h,handler:e});}return this;},off:function off(t){var e,n,i,a,r,s,h=(t||"").split(m),l=h.length;if(!t)for(n in this.eventListeners){this._off(n);}for(e=0;e<l;e++){if(i=h[e],a=i.split(o),r=a[0],s=a[1],r)this.eventListeners[r]&&this._off(r,s);else for(n in this.eventListeners){this._off(n,s);}}return this;},dispatchEvent:function dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this;},addEventListener:function addEventListener(t,e){return this.on(t,function(t){e.call(this,t.evt);}),this;},removeEventListener:function removeEventListener(t){return this.off(t),this;},_delegate:function _delegate(e,n,i){var a=this;this.on(e,function(e){for(var r=e.target.findAncestors(n,!0,a),o=0;o<r.length;o++){e=t.Util.cloneObject(e),e.currentTarget=r[o],i.call(r[o],e);}});},remove:function remove(){var t=this.getParent();return t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),delete this.parent),this._clearSelfAndDescendantCache(_),this._clearSelfAndDescendantCache(n),this._clearSelfAndDescendantCache(C),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(e),this;},destroy:function destroy(){return t._removeId(this.getId()),t._removeName(this.getName(),this._id),this.remove(),this;},getAttr:function getAttr(e){var n=h+t.Util._capitalize(e);return t.Util._isFunction(this[n])?this[n]():this.attrs[e];},getAncestors:function getAncestors(){for(var e=this.getParent(),n=new t.Collection();e;){n.push(e),e=e.getParent();}return n;},getAttrs:function getAttrs(){return this.attrs||{};},setAttrs:function setAttrs(e){var n,i;if(!e)return this;for(n in e){n!==r&&(i=v+t.Util._capitalize(n),t.Util._isFunction(this[i])?this[i](e[n]):this._setAttr(n,e[n]));}return this;},isListening:function isListening(){return this._getCache(d,this._isListening);},_isListening:function _isListening(){var t=this.getListening(),e=this.getParent();return"inherit"===t?!e||e.isListening():t;},isVisible:function isVisible(){return this._getCache(C,this._isVisible);},_isVisible:function _isVisible(){var t=this.getVisible(),e=this.getParent();return"inherit"===t?!e||e.isVisible():t;},shouldDrawHit:function shouldDrawHit(t){var e=this.getLayer();return t&&t.isCache||e&&e.hitGraphEnabled()&&this.isListening()&&this.isVisible();},show:function show(){return this.setVisible(!0),this;},hide:function hide(){return this.setVisible(!1),this;},getZIndex:function getZIndex(){return this.index||0;},getAbsoluteZIndex:function getAbsoluteZIndex(){function t(h){for(e=[],n=h.length,i=0;i<n;i++){a=h[i],s++,a.nodeType!==p&&(e=e.concat(a.getChildren().toArray())),a._id===o._id&&(i=n);}e.length>0&&e[0].getDepth()<=r&&t(e);}var e,n,i,a,r=this.getDepth(),o=this,s=0;return o.nodeType!==S&&t(o.getStage().getChildren()),s;},getDepth:function getDepth(){for(var t=0,e=this.parent;e;){t++,e=e.parent;}return t;},setPosition:function setPosition(t){return this.setX(t.x),this.setY(t.y),this;},getPosition:function getPosition(){return{x:this.getX(),y:this.getY()};},getAbsolutePosition:function getAbsolutePosition(e){var n=this.getAbsoluteTransform(e).getMatrix(),i=new t.Transform(),a=this.offset();return i.m=n.slice(),i.translate(a.x,a.y),i.getTranslation();},setAbsolutePosition:function setAbsolutePosition(t){var e,n=this._clearTransform();return this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,e=this.getAbsoluteTransform(),e.invert(),e.translate(t.x,t.y),t={x:this.attrs.x+e.getTranslation().x,y:this.attrs.y+e.getTranslation().y},this.setPosition({x:t.x,y:t.y}),this._setTransform(n),this;},_setTransform:function _setTransform(t){var e;for(e in t){this.attrs[e]=t[e];}this._clearCache(y),this._clearSelfAndDescendantCache(n);},_clearTransform:function _clearTransform(){var t={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(y),this._clearSelfAndDescendantCache(n),t;},move:function move(t){var e=t.x,n=t.y,i=this.getX(),a=this.getY();return void 0!==e&&(i+=e),void 0!==n&&(a+=n),this.setPosition({x:i,y:a}),this;},_eachAncestorReverse:function _eachAncestorReverse(t,e){var n,i,a=[],r=this.getParent();if(e&&e._id===this._id)return t(this),!0;for(a.unshift(this);r&&(!e||r._id!==e._id);){a.unshift(r),r=r.parent;}for(n=a.length,i=0;i<n;i++){t(a[i]);}},rotate:function rotate(t){return this.setRotation(this.getRotation()+t),this;},moveToTop:function moveToTop(){if(!this.parent)return t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index;return this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0;},moveUp:function moveUp(){if(!this.parent)return t.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1&&(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0);},moveDown:function moveDown(){if(!this.parent)return t.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0);},moveToBottom:function moveToBottom(){if(!this.parent)return t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0);},setZIndex:function setZIndex(e){if(!this.parent)return t.Util.warn("Node has no parent. zIndex parameter is ignored."),!1;var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this;},getAbsoluteOpacity:function getAbsoluteOpacity(){return this._getCache(e,this._getAbsoluteOpacity);},_getAbsoluteOpacity:function _getAbsoluteOpacity(){var t=this.getOpacity();return this.getParent()&&(t*=this.getParent().getAbsoluteOpacity()),t;},moveTo:function moveTo(t){return this.getParent()!==t&&(this.remove(),t.add(this)),this;},toObject:function toObject(){var e,n,i,a,r={},o=this.getAttrs();r.attrs={};for(e in o){n=o[e],i=this[e],delete o[e],a=i?i.call(this):null,o[e]=n,a!==n&&(r.attrs[e]=n);}return r.className=this.getClassName(),t.Util._prepareToStringify(r);},toJSON:function toJSON(){return JSON.stringify(this.toObject());},getParent:function getParent(){return this.parent;},findAncestors:function findAncestors(t,e,n){var i=[];e&&this._isMatch(t)&&i.push(this);for(var a=this.parent;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent;}return i;},findAncestor:function findAncestor(t,e,n){return this.findAncestors(t,e,n)[0];},_isMatch:function _isMatch(e){if(!e)return!1;var n,i,a=e.replace(/ /g,"").split(","),r=a.length;for(n=0;n<r;n++){if(i=a[n],t.Util.isValidSelector(i)||(t.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),t.Util.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0;}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0;}else if(0!==this._get(i).length)return!0;}return!1;},getLayer:function getLayer(){var t=this.getParent();return t?t.getLayer():null;},getStage:function getStage(){return this._getCache(_,this._getStage);},_getStage:function _getStage(){var t=this.getParent();return t?t.getStage():void 0;},fire:function fire(t,e,n){return e=e||{},e.target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this;},getAbsoluteTransform:function getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(n,this._getAbsoluteTransform);},_getAbsoluteTransform:function _getAbsoluteTransform(e){var n,i,a=new t.Transform();return this._eachAncestorReverse(function(t){n=t.transformsEnabled(),i=t.getTransform(),"all"===n?a.multiply(i):"position"===n&&a.translate(t.x(),t.y());},e),a;},getAbsoluteScale:function getAbsoluteScale(t){return t?this._getAbsoluteTransform(t):this._getCache(i,this._getAbsoluteScale);},_getAbsoluteScale:function _getAbsoluteScale(t){var e=1,n=1;return this._eachAncestorReverse(function(t){e*=t.scaleX(),n*=t.scaleY();},t),{x:e,y:n};},getTransform:function getTransform(){return this._getCache(y,this._getTransform);},_getTransform:function _getTransform(){var e=new t.Transform(),n=this.getX(),i=this.getY(),a=t.getAngle(this.getRotation()),r=this.getScaleX(),o=this.getScaleY(),s=this.getSkewX(),h=this.getSkewY(),l=this.getOffsetX(),c=this.getOffsetY();return 0===n&&0===i||e.translate(n,i),0!==a&&e.rotate(a),0===s&&0===h||e.skew(s,h),1===r&&1===o||e.scale(r,o),0===l&&0===c||e.translate(-1*l,-1*c),e;},clone:function clone(e){var n,i,a,r,o,s=t.Util.cloneObject(this.attrs);for(var h in K){var l=K[h];delete s[l];}for(n in e){s[n]=e[n];}var d=new this.constructor(s);for(n in this.eventListeners){for(i=this.eventListeners[n],a=i.length,r=0;r<a;r++){o=i[r],o.name.indexOf(c)<0&&(d.eventListeners[n]||(d.eventListeners[n]=[]),d.eventListeners[n].push(o));}}return d;},toDataURL:function toDataURL(e){e=e||{};var n=e.mimeType||null,i=e.quality||null,a=this.getStage(),r=e.x||0,o=e.y||0,s=e.pixelRatio||1,h=new t.SceneCanvas({width:e.width||this.getWidth()||(a?a.getWidth():0),height:e.height||this.getHeight()||(a?a.getHeight():0),pixelRatio:s}),l=h.getContext();return l.save(),(r||o)&&l.translate(-1*r,-1*o),this.drawScene(h),l.restore(),h.toDataURL(n,i);},toImage:function toImage(e){if(!e||!e.callback)throw"callback required for toImage method config argument";t.Util._getImage(this.toDataURL(e),function(t){e.callback(t);});},setSize:function setSize(t){return this.setWidth(t.width),this.setHeight(t.height),this;},getSize:function getSize(){return{width:this.getWidth(),height:this.getHeight()};},getWidth:function getWidth(){return this.attrs.width||0;},getHeight:function getHeight(){return this.attrs.height||0;},getClassName:function getClassName(){return this.className||this.nodeType;},getType:function getType(){return this.nodeType;},getDragDistance:function getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():t.dragDistance;},_get:function _get(t){return this.className===t||this.nodeType===t?[this]:[];},_off:function _off(t,e){var n,i,a=this.eventListeners[t];for(n=0;n<a.length;n++){if(i=a[n].name,!("konva"===i&&"konva"!==e||e&&i!==e)){if(a.splice(n,1),0===a.length){delete this.eventListeners[t];break;}n--;}}},_fireChangeEvent:function _fireChangeEvent(t,e,n){this._fire(t+a,{oldVal:e,newVal:n});},setId:function setId(e){var n=this.getId();return t._removeId(n),t._addId(this,e),this._setAttr(l,e),this;},setName:function setName(e){var n,i,a=(this.getName()||"").split(/\s/g),r=(e||"").split(/\s/g);for(i=0;i<a.length;i++){n=a[i],r.indexOf(n)===-1&&n&&t._removeName(n,this._id);}for(i=0;i<r.length;i++){n=r[i],a.indexOf(n)===-1&&n&&t._addName(this,n);}return this._setAttr(f,e),this;},addName:function addName(t){if(!this.hasName(t)){var e=this.name(),n=e?e+" "+t:t;this.setName(n);}return this;},hasName:function hasName(t){var e=(this.name()||"").split(/\s/g);return e.indexOf(t)!==-1;},removeName:function removeName(t){var e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return n!==-1&&(e.splice(n,1),this.setName(e.join(" "))),this;},setAttr:function setAttr(e,n){var i=v+t.Util._capitalize(e),a=this[i];return t.Util._isFunction(a)?a.call(this,n):this._setAttr(e,n),this;},_setAttr:function _setAttr(t,e){var n;n=this.attrs[t],n!==e&&(void 0===e||null===e?delete this.attrs[t]:this.attrs[t]=e,this._fireChangeEvent(t,n,e));},_setComponentAttr:function _setComponentAttr(t,e,n){var i;void 0!==n&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,i,n));},_fireAndBubble:function _fireAndBubble(t,e,n){var i=!0;if(e&&this.nodeType===p&&(e.target=this),t===u&&n&&(this._id===n._id||this.isAncestorOf&&this.isAncestorOf(n))?i=!1:t===g&&n&&(this._id===n._id||this.isAncestorOf&&this.isAncestorOf(n))&&(i=!1),i){this._fire(t,e);var a=(t===u||t===g)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!a&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n.parent):this._fireAndBubble.call(this.parent,t,e));}},_fire:function _fire(t,e){var n,i=this.eventListeners[t];if(e=e||{},e.currentTarget=this,e.type=t,i)for(n=0;n<i.length;n++){i[n].handler.call(this,e);}},draw:function draw(){return this.drawScene(),this.drawHit(),this;}}),t.Node.create=function(e,n){return t.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n);},t.Node._createNode=function(e,n){var i,a,r,o=t.Node.prototype.getClassName.call(e),s=e.children;if(n&&(e.attrs.container=n),i=new t[o](e.attrs),s)for(a=s.length,r=0;r<a;r++){i.add(this._createNode(s[r]));}return i;},t.Factory.addOverloadedGetterSetter(t.Node,"position"),t.Factory.addGetterSetter(t.Node,"x",0),t.Factory.addGetterSetter(t.Node,"y",0),t.Factory.addGetterSetter(t.Node,"opacity",1),t.Factory.addGetter(t.Node,"name"),t.Factory.addOverloadedGetterSetter(t.Node,"name"),t.Factory.addGetter(t.Node,"id"),t.Factory.addOverloadedGetterSetter(t.Node,"id"),t.Factory.addGetterSetter(t.Node,"rotation",0),t.Factory.addComponentsGetterSetter(t.Node,"scale",["x","y"]),t.Factory.addGetterSetter(t.Node,"scaleX",1),t.Factory.addGetterSetter(t.Node,"scaleY",1),t.Factory.addComponentsGetterSetter(t.Node,"skew",["x","y"]),t.Factory.addGetterSetter(t.Node,"skewX",0),t.Factory.addGetterSetter(t.Node,"skewY",0),t.Factory.addComponentsGetterSetter(t.Node,"offset",["x","y"]),t.Factory.addGetterSetter(t.Node,"offsetX",0),t.Factory.addGetterSetter(t.Node,"offsetY",0),t.Factory.addSetter(t.Node,"dragDistance"),t.Factory.addOverloadedGetterSetter(t.Node,"dragDistance"),t.Factory.addSetter(t.Node,"width",0),t.Factory.addOverloadedGetterSetter(t.Node,"width"),t.Factory.addSetter(t.Node,"height",0),t.Factory.addOverloadedGetterSetter(t.Node,"height"),t.Factory.addGetterSetter(t.Node,"listening","inherit"),t.Factory.addGetterSetter(t.Node,"preventDefault",!0),t.Factory.addGetterSetter(t.Node,"filters",void 0,function(t){return this._filterUpToDate=!1,t;}),t.Factory.addGetterSetter(t.Node,"visible","inherit"),t.Factory.addGetterSetter(t.Node,"transformsEnabled","all"),t.Factory.addOverloadedGetterSetter(t.Node,"size"),t.Factory.backCompat(t.Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),t.Collection.mapMethods(t.Node);}(Konva),function(){"use strict";Konva.Container=function(t){this.__init(t);},Konva.Util.addMethods(Konva.Container,{__init:function __init(t){this.children=new Konva.Collection(),Konva.Node.call(this,t);},getChildren:function getChildren(t){if(!t)return this.children;var e=new Konva.Collection();return this.children.each(function(n){t(n)&&e.push(n);}),e;},hasChildren:function hasChildren(){return this.getChildren().length>0;},removeChildren:function removeChildren(){for(var t,e=Konva.Collection.toCollection(this.children),n=0;n<e.length;n++){t=e[n],delete t.parent,t.index=0,t.remove();}return e=null,this.children=new Konva.Collection(),this;},destroyChildren:function destroyChildren(){for(var t,e=Konva.Collection.toCollection(this.children),n=0;n<e.length;n++){t=e[n],delete t.parent,t.index=0,t.destroy();}return e=null,this.children=new Konva.Collection(),this;},add:function add(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++){this.add(arguments[e]);}return this;}if(t.getParent())return t.moveTo(this),this;var n=this.children;return this._validateAdd(t),t.index=n.length,t.parent=this,n.push(t),this._fire("add",{child:t}),Konva.DD&&t.isDragging()&&Konva.DD.anim.setLayers(t.getLayer()),this;},destroy:function destroy(){return this.hasChildren()&&this.destroyChildren(),Konva.Node.prototype.destroy.call(this),this;},find:function find(t){var e,n,i,a,r,o,s,h=[],l=t.replace(/ /g,"").split(","),c=l.length;for(e=0;e<c;e++){if(i=l[e],Konva.Util.isValidSelector(i)||(Konva.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Konva.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Konva.Util.warn("Konva is awesome, right?")),"#"===i.charAt(0))r=this._getNodeById(i.slice(1)),r&&h.push(r);else if("."===i.charAt(0))a=this._getNodesByName(i.slice(1)),h=h.concat(a);else for(o=this.getChildren(),s=o.length,n=0;n<s;n++){h=h.concat(o[n]._get(i));}}return Konva.Collection.toCollection(h);},findOne:function findOne(t){return this.find(t)[0];},_getNodeById:function _getNodeById(t){var e=Konva.ids[t];return void 0!==e&&this.isAncestorOf(e)?e:null;},_getNodesByName:function _getNodesByName(t){var e=Konva.names[t]||[];return this._getDescendants(e);},_get:function _get(t){for(var e=Konva.Node.prototype._get.call(this,t),n=this.getChildren(),i=n.length,a=0;a<i;a++){e=e.concat(n[a]._get(t));}return e;},toObject:function toObject(){var t=Konva.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),n=e.length,i=0;i<n;i++){var a=e[i];t.children.push(a.toObject());}return t;},_getDescendants:function _getDescendants(t){for(var e=[],n=t.length,i=0;i<n;i++){var a=t[i];this.isAncestorOf(a)&&e.push(a);}return e;},isAncestorOf:function isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent();}return!1;},clone:function clone(t){var e=Konva.Node.prototype.clone.call(this,t);return this.getChildren().each(function(t){e.add(t.clone());}),e;},getAllIntersections:function getAllIntersections(t){var e=[];return this.find("Shape").each(function(n){n.isVisible()&&n.intersects(t)&&e.push(n);}),e;},_setChildrenIndices:function _setChildrenIndices(){this.children.each(function(t,e){t.index=e;});},drawScene:function drawScene(t,e,n){var i=this.getLayer(),a=t||i&&i.getCanvas(),r=a&&a.getContext(),o=this._cache.canvas,s=o&&o.scene;return this.isVisible()&&(!n&&s?(r.save(),i._applyTransform(this,r,e),this._drawCachedSceneCanvas(r),r.restore()):this._drawChildren(a,"drawScene",e,!1,n)),this;},drawHit:function drawHit(t,e,n){var i=this.getLayer(),a=t||i&&i.hitCanvas,r=a&&a.getContext(),o=this._cache.canvas,s=o&&o.hit;return this.shouldDrawHit(a)&&(i&&i.clearHitCache(),!n&&s?(r.save(),i._applyTransform(this,r,e),this._drawCachedHitCanvas(r),r.restore()):this._drawChildren(a,"drawHit",e)),this;},_drawChildren:function _drawChildren(t,e,n,i,a){var r,o,s=this.getLayer(),h=t&&t.getContext(),l=this.getClipWidth(),c=this.getClipHeight(),d=this.getClipFunc(),u=l&&c||d;u&&s&&(h.save(),s._applyTransform(this,h),h.beginPath(),d?d.call(this,h,this):(r=this.getClipX(),o=this.getClipY(),h.rect(r,o,l,c)),h.clip(),h.reset()),this.children.each(function(r){r[e](t,n,i,a);}),u&&h.restore();},shouldDrawHit:function shouldDrawHit(t){var e=this.getLayer(),n=Konva.DD,i=n&&Konva.isDragging()&&Konva.DD.anim.getLayers().indexOf(e)!==-1;return t&&t.isCache||e&&e.hitGraphEnabled()&&this.isVisible()&&!i;},getClientRect:function getClientRect(t){var e,n,i,a,r={x:0,y:0,width:0,height:0};return this.children.each(function(t){var r=t.getClientRect();void 0===e?(e=r.x,n=r.y,i=r.x+r.width,a=r.y+r.height):(e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x+r.width),a=Math.max(a,r.y+r.height));}),0!==this.children.length&&(r={x:e,y:n,width:i-e,height:a-n}),t?r:this._transformedRect(r);}}),Konva.Util.extend(Konva.Container,Konva.Node),Konva.Container.prototype.get=Konva.Container.prototype.find,Konva.Factory.addComponentsGetterSetter(Konva.Container,"clip",["x","y","width","height"]),Konva.Factory.addGetterSetter(Konva.Container,"clipX"),Konva.Factory.addGetterSetter(Konva.Container,"clipY"),Konva.Factory.addGetterSetter(Konva.Container,"clipWidth"),Konva.Factory.addGetterSetter(Konva.Container,"clipHeight"),Konva.Factory.addGetterSetter(Konva.Container,"clipFunc"),Konva.Collection.mapMethods(Konva.Container);}(),function(t){"use strict";function e(t){t.fill();}function n(t){t.stroke();}function i(t){t.fill();}function a(t){t.stroke();}function r(){this._clearCache(s);}function o(){this._clearCache(h);}var s="hasShadow",h="shadowRGBA";t.Shape=function(t){this.__init(t);},t.Util.addMethods(t.Shape,{__init:function __init(s){this.nodeType="Shape",this._fillFunc=e,this._strokeFunc=n,this._fillFuncHit=i,this._strokeFuncHit=a;for(var h,l=t.shapes;;){if(h=t.Util.getRandomColor(),h&&!(h in l))break;}this.colorKey=h,l[h]=this,t.Node.call(this,s),this.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",r),this.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",o);},hasChildren:function hasChildren(){return!1;},getChildren:function getChildren(){return[];},getContext:function getContext(){return this.getLayer().getContext();},getCanvas:function getCanvas(){return this.getLayer().getCanvas();},hasShadow:function hasShadow(){return this._getCache(s,this._hasShadow);},_hasShadow:function _hasShadow(){return this.getShadowEnabled()&&0!==this.getShadowOpacity()&&!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY());},getShadowRGBA:function getShadowRGBA(){return this._getCache(h,this._getShadowRGBA);},_getShadowRGBA:function _getShadowRGBA(){if(this.hasShadow()){var e=t.Util.colorToRGBA(this.shadowColor());return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.getShadowOpacity()||1)+")";}},hasFill:function hasFill(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops());},hasStroke:function hasStroke(){return this.strokeEnabled()&&!!this.stroke();},intersects:function intersects(t){var e,n=this.getStage(),i=n.bufferHitCanvas;return i.getContext().clear(),this.drawScene(i),e=i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0;},destroy:function destroy(){return t.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],this;},_useBufferCanvas:function _useBufferCanvas(t){return!t&&this.perfectDrawEnabled()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage()||this.perfectDrawEnabled()&&this.hasShadow()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage();},getSelfRect:function getSelfRect(){var t=this.getSize();return{x:this._centroid?Math.round(-t.width/2):0,y:this._centroid?Math.round(-t.height/2):0,width:t.width,height:t.height};},getClientRect:function getClientRect(t){var e=this.getSelfRect(),n=this.hasStroke()&&this.strokeWidth()||0,i=e.width+n,a=e.height+n,r=this.hasShadow()?this.shadowOffsetX():0,o=this.hasShadow()?this.shadowOffsetY():0,s=i+Math.abs(r),h=a+Math.abs(o),l=this.hasShadow()&&this.shadowBlur()||0,c=s+2*l,d=h+2*l,u=0;Math.round(n/2)!==n/2&&(u=1);var g={width:c+u,height:d+u,x:-Math.round(n/2+l)+Math.min(r,0)+e.x,y:-Math.round(n/2+l)+Math.min(o,0)+e.y};return t?g:this._transformedRect(g);},drawScene:function drawScene(t,e,n,i){var a,r,o,s=this.getLayer(),h=t||s.getCanvas(),l=h.getContext(),c=this._cache.canvas,d=this.sceneFunc(),u=this.hasShadow(),g=this.hasStroke();if(!this.isVisible())return this;if(c)return l.save(),s._applyTransform(this,l,e),this._drawCachedSceneCanvas(l),l.restore(),this;if(!d)return this;if(l.save(),this._useBufferCanvas(n)&&!i){if(a=this.getStage(),r=a.bufferCanvas,o=r.getContext(),o.clear(),o.save(),o._applyLineJoin(this),!n)if(s)s._applyTransform(this,o,e);else{var f=this.getAbsoluteTransform(e).getMatrix();l.transform(f[0],f[1],f[2],f[3],f[4],f[5]);}d.call(this,o),o.restore();var v=r.pixelRatio;u&&!h.hitCanvas?(l.save(),l._applyShadow(this),l._applyOpacity(this),l.drawImage(r._canvas,0,0,r.width/v,r.height/v),l.restore()):(l._applyOpacity(this),l.drawImage(r._canvas,0,0,r.width/v,r.height/v));}else{if(l._applyLineJoin(this),!n)if(s)s._applyTransform(this,l,e);else{var p=this.getAbsoluteTransform(e).getMatrix();l.transform(p[0],p[1],p[2],p[3],p[4],p[5]);}u&&g&&!h.hitCanvas?(l.save(),n||l._applyOpacity(this),l._applyShadow(this),d.call(this,l),l.restore(),this.hasFill()&&this.getShadowForStrokeEnabled()&&d.call(this,l)):u&&!h.hitCanvas?(l.save(),n||l._applyOpacity(this),l._applyShadow(this),d.call(this,l),l.restore()):(n||l._applyOpacity(this),d.call(this,l));}return l.restore(),this;},drawHit:function drawHit(t,e,n){var i=this.getLayer(),a=t||i.hitCanvas,r=a.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._cache.canvas,h=s&&s.hit;if(!this.shouldDrawHit(a))return this;if(i&&i.clearHitCache(),h)return r.save(),i._applyTransform(this,r,e),this._drawCachedHitCanvas(r),r.restore(),this;if(!o)return this;if(r.save(),r._applyLineJoin(this),!n)if(i)i._applyTransform(this,r,e);else{var l=this.getAbsoluteTransform(e).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]);}return o.call(this,r),r.restore(),this;},drawHitFromCache:function drawHitFromCache(e){var n,i,a,r,o,s,h=e||0,l=this._cache.canvas,c=this._getCachedSceneCanvas(),d=l.hit,u=d.getContext(),g=d.getWidth(),f=d.getHeight();u.clear(),u.drawImage(c._canvas,0,0,g,f);try{for(n=u.getImageData(0,0,g,f),i=n.data,a=i.length,r=t.Util._hexToRgb(this.colorKey),o=0;o<a;o+=4){s=i[o+3],s>h?(i[o]=r.r,i[o+1]=r.g,i[o+2]=r.b,i[o+3]=255):i[o+3]=0;}u.putImageData(n,0,0);}catch(e){t.Util.error("Unable to draw hit graph from cached scene canvas. "+e.message);}return this;}}),t.Util.extend(t.Shape,t.Node),t.Factory.addGetterSetter(t.Shape,"stroke"),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"strokeWidth",2),t.Factory.addGetterSetter(t.Shape,"strokeHitEnabled",!0),t.Factory.addGetterSetter(t.Shape,"perfectDrawEnabled",!0),t.Factory.addGetterSetter(t.Shape,"shadowForStrokeEnabled",!0),t.Factory.addGetterSetter(t.Shape,"lineJoin"),t.Factory.addGetterSetter(t.Shape,"lineCap"),t.Factory.addGetterSetter(t.Shape,"sceneFunc"),t.Factory.addGetterSetter(t.Shape,"hitFunc"),t.Factory.addGetterSetter(t.Shape,"dash"),t.Factory.addGetterSetter(t.Shape,"shadowColor"),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"shadowBlur"),t.Factory.addGetterSetter(t.Shape,"shadowOpacity"),t.Factory.addComponentsGetterSetter(t.Shape,"shadowOffset",["x","y"]),t.Factory.addGetterSetter(t.Shape,"shadowOffsetX",0),t.Factory.addGetterSetter(t.Shape,"shadowOffsetY",0),t.Factory.addGetterSetter(t.Shape,"fillPatternImage"),t.Factory.addGetterSetter(t.Shape,"fill"),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"fillPatternX",0),t.Factory.addGetterSetter(t.Shape,"fillPatternY",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientColorStops"),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartRadius",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndRadius",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientColorStops"),t.Factory.addGetterSetter(t.Shape,"fillPatternRepeat","repeat"),t.Factory.addGetterSetter(t.Shape,"fillEnabled",!0),t.Factory.addGetterSetter(t.Shape,"strokeEnabled",!0),t.Factory.addGetterSetter(t.Shape,"shadowEnabled",!0),t.Factory.addGetterSetter(t.Shape,"dashEnabled",!0),t.Factory.addGetterSetter(t.Shape,"strokeScaleEnabled",!0),t.Factory.addGetterSetter(t.Shape,"fillPriority","color"),t.Factory.addComponentsGetterSetter(t.Shape,"fillPatternOffset",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillPatternOffsetX",0),t.Factory.addGetterSetter(t.Shape,"fillPatternOffsetY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillPatternScale",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillPatternScaleX",1),t.Factory.addGetterSetter(t.Shape,"fillPatternScaleY",1),t.Factory.addComponentsGetterSetter(t.Shape,"fillLinearGradientStartPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientStartPointX",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientStartPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillLinearGradientEndPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientEndPointX",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientEndPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillRadialGradientStartPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartPointX",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillRadialGradientEndPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndPointX",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndPointY",0),t.Factory.addGetterSetter(t.Shape,"fillPatternRotation",0),t.Factory.backCompat(t.Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),t.Collection.mapMethods(t.Shape);}(Konva),function(){"use strict";function t(t,e){t.content.addEventListener(e,function(n){t[M+e](n);},!1);}var e="Stage",n="string",i="px",a="mouseout",r="mouseleave",o="mouseover",s="mouseenter",h="mousemove",l="mousedown",c="mouseup",d="click",u="dblclick",g="touchstart",f="touchend",v="tap",p="dbltap",m="touchmove",_="DOMMouseScroll",y="mousewheel",S="wheel",C="contentMouseout",K="contentMouseover",w="contentMousemove",x="contentMousedown",b="contentMouseup",D="contentClick",T="contentDblclick",A="contentTouchstart",F="contentTouchend",P="contentDbltap",G="contentTap",k="contentTouchmove",L="contentWheel",R="div",I="relative",U="konvajs-content",N=" ",M="_",O="container",B="",H=[l,h,c,a,g,m,f,o,_,y,S],E=H.length;Konva.Stage=function(t){this.___init(t);},Konva.Util.addMethods(Konva.Stage,{___init:function ___init(t){this.nodeType=e,Konva.Container.call(this,t),this._id=Konva.idCounter++,this._buildDOM(),this._bindContentEvents(),this._enableNestedTransforms=!1,Konva.stages.push(this);},_validateAdd:function _validateAdd(t){"Layer"!==t.getType()&&Konva.Util.throw("You may only add layers to the stage.");},setContainer:function setContainer(t){if((typeof t==="undefined"?"undefined":_typeof(t))===n){if("."===t.charAt(0)){var e=t.slice(1);t=Konva.document.getElementsByClassName(e)[0];}else{var i;i="#"!==t.charAt(0)?t:t.slice(1),t=Konva.document.getElementById(i);}if(!t)throw"Can not find container in document with id "+i;}return this._setAttr(O,t),this;},shouldDrawHit:function shouldDrawHit(){return!0;},draw:function draw(){return Konva.Node.prototype.draw.call(this),this;},setHeight:function setHeight(t){return Konva.Node.prototype.setHeight.call(this,t),this._resizeDOM(),this;},setWidth:function setWidth(t){return Konva.Node.prototype.setWidth.call(this,t),this._resizeDOM(),this;},clear:function clear(){var t,e=this.children,n=e.length;for(t=0;t<n;t++){e[t].clear();}return this;},clone:function clone(t){return t||(t={}),t.container=Konva.document.createElement(R),Konva.Container.prototype.clone.call(this,t);},destroy:function destroy(){var t=this.content;Konva.Container.prototype.destroy.call(this),t&&Konva.Util._isInDocument(t)&&this.getContainer().removeChild(t);var e=Konva.stages.indexOf(this);return e>-1&&Konva.stages.splice(e,1),this;},getPointerPosition:function getPointerPosition(){return this.pointerPos;},getStage:function getStage(){return this;},getContent:function getContent(){return this.content;},toDataURL:function toDataURL(t){t=t||{};var e=t.mimeType||null,n=t.quality||null,i=t.x||0,a=t.y||0,r=new Konva.SceneCanvas({width:t.width||this.getWidth(),height:t.height||this.getHeight(),pixelRatio:t.pixelRatio}),o=r.getContext()._context,s=this.children;(i||a)&&o.translate(-1*i,-1*a),s.each(function(t){var e=t.getCanvas().getWidth(),n=t.getCanvas().getHeight(),i=t.getCanvas().getPixelRatio();o.drawImage(t.getCanvas()._canvas,0,0,e/i,n/i);});var h=r.toDataURL(e,n);return t.callback&&t.callback(h),h;},toImage:function toImage(t){var e=t.callback;t.callback=function(t){Konva.Util._getImage(t,function(t){e(t);});},this.toDataURL(t);},getIntersection:function getIntersection(t,e){var n,i,a=this.getChildren(),r=a.length,o=r-1;for(n=o;n>=0;n--){if(i=a[n].getIntersection(t,e))return i;}return null;},_resizeDOM:function _resizeDOM(){if(this.content){var t,e,n=this.getWidth(),a=this.getHeight(),r=this.getChildren(),o=r.length;for(this.content.style.width=n+i,this.content.style.height=a+i,this.bufferCanvas.setSize(n,a),this.bufferHitCanvas.setSize(n,a),t=0;t<o;t++){e=r[t],e.setSize(n,a),e.draw();}}},add:function add(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++){this.add(arguments[e]);}return this;}return Konva.Container.prototype.add.call(this,t),t._setCanvasSize(this.width(),this.height()),t.draw(),this.content.appendChild(t.canvas._canvas),this;},getParent:function getParent(){return null;},getLayer:function getLayer(){return null;},getLayers:function getLayers(){return this.getChildren();},_bindContentEvents:function _bindContentEvents(){for(var e=0;e<E;e++){t(this,H[e]);}},_mouseover:function _mouseover(t){Konva.UA.mobile||(this._setPointerPosition(t),this._fire(K,{evt:t}));},_mouseout:function _mouseout(t){if(!Konva.UA.mobile){this._setPointerPosition(t);var e=this.targetShape;e&&!Konva.isDragging()&&(e._fireAndBubble(a,{evt:t}),e._fireAndBubble(r,{evt:t}),this.targetShape=null),this.pointerPos=void 0,this._fire(C,{evt:t});}},_mousemove:function _mousemove(t){if(Konva.UA.ieMobile)return this._touchmove(t);if(("undefined"!=typeof t.movementX||"undefined"!=typeof t.movementY)&&0===t.movementY&&0===t.movementX)return null;if(Konva.UA.mobile)return null;this._setPointerPosition(t);var e;Konva.isDragging()||(e=this.getIntersection(this.getPointerPosition()),e&&e.isListening()?Konva.isDragging()||this.targetShape&&this.targetShape._id===e._id?e._fireAndBubble(h,{evt:t}):(this.targetShape&&(this.targetShape._fireAndBubble(a,{evt:t},e),this.targetShape._fireAndBubble(r,{evt:t},e)),e._fireAndBubble(o,{evt:t},this.targetShape),e._fireAndBubble(s,{evt:t},this.targetShape),this.targetShape=e):this.targetShape&&!Konva.isDragging()&&(this.targetShape._fireAndBubble(a,{evt:t}),this.targetShape._fireAndBubble(r,{evt:t}),this.targetShape=null),this._fire(w,{evt:t})),t.preventDefault&&t.preventDefault();},_mousedown:function _mousedown(t){if(Konva.UA.ieMobile)return this._touchstart(t);if(!Konva.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());Konva.listenClickTap=!0,e&&e.isListening()&&(this.clickStartShape=e,e._fireAndBubble(l,{evt:t})),this._fire(x,{evt:t});}t.preventDefault&&t.preventDefault();},_mouseup:function _mouseup(t){if(Konva.UA.ieMobile)return this._touchend(t);if(!Konva.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),n=this.clickStartShape,i=!1,a=Konva.DD;Konva.inDblClickWindow?(i=!0,Konva.inDblClickWindow=!1):a&&a.justDragged?a&&(a.justDragged=!1):Konva.inDblClickWindow=!0,setTimeout(function(){Konva.inDblClickWindow=!1;},Konva.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(c,{evt:t}),Konva.listenClickTap&&n&&n._id===e._id&&(e._fireAndBubble(d,{evt:t}),i&&e._fireAndBubble(u,{evt:t}))),this._fire(b,{evt:t}),Konva.listenClickTap&&(this._fire(D,{evt:t}),i&&this._fire(T,{evt:t})),Konva.listenClickTap=!1;}t.preventDefault&&t.preventDefault();},_touchstart:function _touchstart(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());Konva.listenClickTap=!0,e&&e.isListening()&&(this.tapStartShape=e,e._fireAndBubble(g,{evt:t}),e.isListening()&&e.preventDefault()&&t.preventDefault&&t.preventDefault()),this._fire(A,{evt:t});},_touchend:function _touchend(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),n=!1;Konva.inDblClickWindow?(n=!0,Konva.inDblClickWindow=!1):Konva.inDblClickWindow=!0,setTimeout(function(){Konva.inDblClickWindow=!1;},Konva.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(f,{evt:t}),Konva.listenClickTap&&this.tapStartShape&&e._id===this.tapStartShape._id&&(e._fireAndBubble(v,{evt:t}),n&&e._fireAndBubble(p,{evt:t})),e.isListening()&&e.preventDefault()&&t.preventDefault&&t.preventDefault()),this._fire(F,{evt:t}),Konva.listenClickTap&&(this._fire(G,{evt:t}),n&&this._fire(P,{evt:t})),Konva.listenClickTap=!1;},_touchmove:function _touchmove(t){this._setPointerPosition(t);var e,n=Konva.DD;Konva.isDragging()||(e=this.getIntersection(this.getPointerPosition()),e&&e.isListening()&&(e._fireAndBubble(m,{evt:t}),e.isListening()&&e.preventDefault()&&t.preventDefault&&t.preventDefault()),this._fire(k,{evt:t})),n&&Konva.isDragging()&&Konva.DD.node.preventDefault()&&t.preventDefault();},_DOMMouseScroll:function _DOMMouseScroll(t){this._mousewheel(t);},_mousewheel:function _mousewheel(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()&&e._fireAndBubble(S,{evt:t}),this._fire(L,{evt:t});},_wheel:function _wheel(t){this._mousewheel(t);},_setPointerPosition:function _setPointerPosition(t){var e=this._getContentPosition(),n=null,i=null;if(t=t?t:window.event,void 0!==t.touches){if(t.touches.length>0){var a=t.touches[0];n=a.clientX-e.left,i=a.clientY-e.top;}}else n=t.clientX-e.left,i=t.clientY-e.top;null!==n&&null!==i&&(this.pointerPos={x:n,y:i});},_getContentPosition:function _getContentPosition(){var t=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:t.top,left:t.left};},_buildDOM:function _buildDOM(){var t=this.getContainer();if(!t){if(Konva.Util.isBrowser())throw"Stage has no container. A container is required.";t=Konva.document.createElement(R);}t.innerHTML=B,this.content=Konva.document.createElement(R),this.content.style.position=I,this.content.className=U,this.content.setAttribute("role","presentation"),t.appendChild(this.content),this.bufferCanvas=new Konva.SceneCanvas(),this.bufferHitCanvas=new Konva.HitCanvas({pixelRatio:1}),this._resizeDOM();},_onContent:function _onContent(t,e){var n,i,a=t.split(N),r=a.length;for(n=0;n<r;n++){i=a[n],this.content.addEventListener(i,e,!1);}},cache:function cache(){Konva.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.");},clearCache:function clearCache(){}}),Konva.Util.extend(Konva.Stage,Konva.Container),Konva.Factory.addGetter(Konva.Stage,"container"),Konva.Factory.addOverloadedGetterSetter(Konva.Stage,"container");}(),function(){"use strict";Konva.BaseLayer=function(t){this.___init(t);},Konva.Util.addMethods(Konva.BaseLayer,{___init:function ___init(t){this.nodeType="Layer",Konva.Container.call(this,t);},createPNGStream:function createPNGStream(){return this.canvas._canvas.createPNGStream();},getCanvas:function getCanvas(){return this.canvas;},getHitCanvas:function getHitCanvas(){return this.hitCanvas;},getContext:function getContext(){return this.getCanvas().getContext();},clear:function clear(t){return this.getContext().clear(t),this;},clearHitCache:function clearHitCache(){this._hitImageData=void 0;},setZIndex:function setZIndex(t){Konva.Node.prototype.setZIndex.call(this,t);var e=this.getStage();return e&&(e.content.removeChild(this.getCanvas()._canvas),t<e.getChildren().length-1?e.content.insertBefore(this.getCanvas()._canvas,e.getChildren()[t+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas)),this;},moveToTop:function moveToTop(){Konva.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas)),this;},moveUp:function moveUp(){var t=Konva.Node.prototype.moveUp.call(this);if(!t)return this;var e=this.getStage();return e?(e.content.removeChild(this.getCanvas()._canvas),this.index<e.getChildren().length-1?e.content.insertBefore(this.getCanvas()._canvas,e.getChildren()[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas),this):this;},moveDown:function moveDown(){if(Konva.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas);}}return this;},moveToBottom:function moveToBottom(){if(Konva.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas);}}return this;},getLayer:function getLayer(){return this;},remove:function remove(){var t=this.getCanvas()._canvas;return Konva.Node.prototype.remove.call(this),t&&t.parentNode&&Konva.Util._isInDocument(t)&&t.parentNode.removeChild(t),this;},getStage:function getStage(){return this.parent;},setSize:function setSize(t,e){return this.canvas.setSize(t,e),this;},getWidth:function getWidth(){if(this.parent)return this.parent.getWidth();},setWidth:function setWidth(){Konva.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.');},getHeight:function getHeight(){if(this.parent)return this.parent.getHeight();},setHeight:function setHeight(){Konva.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.');},_applyTransform:function _applyTransform(t,e,n){var i=t.getAbsoluteTransform(n).getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5]);}}),Konva.Util.extend(Konva.BaseLayer,Konva.Container),Konva.Factory.addGetterSetter(Konva.BaseLayer,"clearBeforeDraw",!0),Konva.Collection.mapMethods(Konva.BaseLayer);}(),function(){"use strict";var t="#",e="beforeDraw",n="draw",i=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],a=i.length;Konva.Layer=function(t){this.____init(t);},Konva.Util.addMethods(Konva.Layer,{____init:function ____init(t){this.nodeType="Layer",this.canvas=new Konva.SceneCanvas(),this.hitCanvas=new Konva.HitCanvas({pixelRatio:1}),Konva.BaseLayer.call(this,t);},_setCanvasSize:function _setCanvasSize(t,e){this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e);},_validateAdd:function _validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Konva.Util.throw("You may only add groups and shapes to a layer.");},getIntersection:function getIntersection(t,e){var n,r,o,s;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var h=1,l=!1;;){for(r=0;r<a;r++){if(o=i[r],n=this._getIntersection({x:t.x+o.x*h,y:t.y+o.y*h}),s=n.shape,s&&e)return s.findAncestor(e,!0);if(s)return s;if(l=!!n.antialiased,!n.antialiased)break;}if(!l)return null;h+=1;}},_getImageData:function _getImageData(t,e){var n=this.hitCanvas.width||1,i=this.hitCanvas.height||1,a=Math.round(e)*n+Math.round(t);return this._hitImageData||(this._hitImageData=this.hitCanvas.context.getImageData(0,0,n,i)),[this._hitImageData.data[4*a+0],this._hitImageData.data[4*a+1],this._hitImageData.data[4*a+2],this._hitImageData.data[4*a+3]];},_getIntersection:function _getIntersection(e){var n,i,a=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*a),Math.round(e.y*a),1,1).data,o=r[3];return 255===o?(n=Konva.Util._rgbToHex(r[0],r[1],r[2]),i=Konva.shapes[t+n],i?{shape:i}:{antialiased:!0}):o>0?{antialiased:!0}:{};},drawScene:function drawScene(t,i){var a=this.getLayer(),r=t||a&&a.getCanvas();return this._fire(e,{node:this}),this.getClearBeforeDraw()&&r.getContext().clear(),Konva.Container.prototype.drawScene.call(this,r,i),this._fire(n,{node:this}),this;},drawHit:function drawHit(t,e){var n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.getClearBeforeDraw()&&n.getHitCanvas().getContext().clear(),Konva.Container.prototype.drawHit.call(this,i,e),this.imageData=null,this;},clear:function clear(t){return Konva.BaseLayer.prototype.clear.call(this,t),this.getHitCanvas().getContext().clear(t),this.imageData=null,this;},setVisible:function setVisible(t){return Konva.Node.prototype.setVisible.call(this,t),t?(this.getCanvas()._canvas.style.display="block",this.hitCanvas._canvas.style.display="block"):(this.getCanvas()._canvas.style.display="none",this.hitCanvas._canvas.style.display="none"),this;},enableHitGraph:function enableHitGraph(){return this.setHitGraphEnabled(!0),this;},disableHitGraph:function disableHitGraph(){return this.setHitGraphEnabled(!1),this;},setSize:function setSize(t,e){return Konva.BaseLayer.prototype.setSize.call(this,t,e),this.hitCanvas.setSize(t,e),this;}}),Konva.Util.extend(Konva.Layer,Konva.BaseLayer),Konva.Factory.addGetterSetter(Konva.Layer,"hitGraphEnabled",!0),Konva.Collection.mapMethods(Konva.Layer);}(),function(){"use strict";Konva.FastLayer=function(t){this.____init(t);},Konva.Util.addMethods(Konva.FastLayer,{____init:function ____init(t){this.nodeType="Layer",this.canvas=new Konva.SceneCanvas(),Konva.BaseLayer.call(this,t);},_validateAdd:function _validateAdd(t){var e=t.getType();"Shape"!==e&&Konva.Util.throw("You may only add shapes to a fast layer.");},_setCanvasSize:function _setCanvasSize(t,e){this.canvas.setSize(t,e);},hitGraphEnabled:function hitGraphEnabled(){return!1;},getIntersection:function getIntersection(){return null;},drawScene:function drawScene(t){var e=this.getLayer(),n=t||e&&e.getCanvas();return this.getClearBeforeDraw()&&n.getContext().clear(),Konva.Container.prototype.drawScene.call(this,n),this;},draw:function draw(){return this.drawScene(),this;},setVisible:function setVisible(t){return Konva.Node.prototype.setVisible.call(this,t),t?this.getCanvas()._canvas.style.display="block":this.getCanvas()._canvas.style.display="none",this;}}),Konva.Util.extend(Konva.FastLayer,Konva.BaseLayer),Konva.Collection.mapMethods(Konva.FastLayer);}(),function(){"use strict";Konva.Group=function(t){this.___init(t);},Konva.Util.addMethods(Konva.Group,{___init:function ___init(t){this.nodeType="Group",Konva.Container.call(this,t);},_validateAdd:function _validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Konva.Util.throw("You may only add groups and shapes to groups.");}}),Konva.Util.extend(Konva.Group,Konva.Container),Konva.Collection.mapMethods(Konva.Group);}(),function(t){"use strict";function e(t){setTimeout(t,1e3/60);}function n(){return a.apply(t.global,arguments);}var i=function(){return t.global.performance&&t.global.performance.now?function(){return t.global.performance.now();}:function(){return new Date().getTime();};}(),a=function(){return t.global.requestAnimationFrame||t.global.webkitRequestAnimationFrame||t.global.mozRequestAnimationFrame||t.global.oRequestAnimationFrame||t.global.msRequestAnimationFrame||e;}();t.Animation=function(e,n){var a=t.Animation;this.func=e,this.setLayers(n),this.id=a.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:i()};},t.Animation.prototype={setLayers:function setLayers(t){var e=[];return e=t?t.length>0?t:[t]:[],this.layers=e,this;},getLayers:function getLayers(){return this.layers;},addLayer:function addLayer(t){var e,n=this.layers,i=n.length;for(e=0;e<i;e++){if(n[e]._id===t._id)return!1;}return this.layers.push(t),!0;},isRunning:function isRunning(){var e,n=t.Animation,i=n.animations,a=i.length;for(e=0;e<a;e++){if(i[e].id===this.id)return!0;}return!1;},start:function start(){var e=t.Animation;return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=i(),e._addAnimation(this),this;},stop:function stop(){return t.Animation._removeAnimation(this),this;},_updateFrameObject:function _updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff;}},t.Animation.animations=[],t.Animation.animIdCounter=0,t.Animation.animRunning=!1,t.Animation._addAnimation=function(t){this.animations.push(t),this._handleAnimation();},t.Animation._removeAnimation=function(t){var e,n=t.id,i=this.animations,a=i.length;for(e=0;e<a;e++){if(i[e].id===n){this.animations.splice(e,1);break;}}},t.Animation._runFrames=function(){var t,e,n,a,r,o,s,h,l,c={},d=this.animations;for(a=0;a<d.length;a++){if(t=d[a],e=t.layers,n=t.func,t._updateFrameObject(i()),o=e.length,l=!n||n.call(t,t.frame)!==!1)for(r=0;r<o;r++){s=e[r],void 0!==s._id&&(c[s._id]=s);}}for(h in c){c.hasOwnProperty(h)&&c[h].draw();}},t.Animation._animationLoop=function(){var e=t.Animation;e.animations.length?(e._runFrames(),n(e._animationLoop)):e.animRunning=!1;},t.Animation._handleAnimation=function(){this.animRunning||(this.animRunning=!0,n(this._animationLoop));},t.BaseLayer.prototype.batchDraw=function(){var e=this,n=t.Animation;return this.batchAnim||(this.batchAnim=new n(function(){e.batchAnim.stop();},this)),this.lastBatchDrawTime=i(),this.batchAnim.isRunning()||this.batchAnim.start(),this;},t.Stage.prototype.batchDraw=function(){return this.getChildren().each(function(t){t.batchDraw();}),this;};}(Konva),function(){"use strict";Konva.DD={anim:new Konva.Animation(function(){var t=this.dirty;return this.dirty=!1,t;}),isDragging:!1,justDragged:!1,offset:{x:0,y:0},node:null,_drag:function _drag(t){var e=Konva.DD,n=e.node;if(n){if(!e.isDragging){var i=n.getStage().getPointerPosition(),a=n.dragDistance(),r=Math.max(Math.abs(i.x-e.startPointerPos.x),Math.abs(i.y-e.startPointerPos.y));if(r<a)return;}n.getStage()._setPointerPosition(t),n._setDragPosition(t),e.isDragging||(e.isDragging=!0,n.fire("dragstart",{type:"dragstart",target:n,evt:t},!0)),n.fire("dragmove",{type:"dragmove",target:n,evt:t},!0);}},_endDragBefore:function _endDragBefore(t){var e,n=Konva.DD,i=n.node;i&&(e=i.getLayer(),n.anim.stop(),n.isDragging&&(n.isDragging=!1,n.justDragged=!0,Konva.listenClickTap=!1,t&&(t.dragEndNode=i)),delete n.node,(i.getLayer()||e||i instanceof Konva.Stage)&&(e||i).draw());},_endDragAfter:function _endDragAfter(t){t=t||{};var e=t.dragEndNode;t&&e&&e.fire("dragend",{type:"dragend",target:e,evt:t},!0);}},Konva.Node.prototype.startDrag=function(){var t=Konva.DD,e=this.getStage(),n=this.getLayer(),i=e.getPointerPosition(),a=this.getAbsolutePosition();i&&(t.node&&t.node.stopDrag(),t.node=this,t.startPointerPos=i,t.offset.x=i.x-a.x,t.offset.y=i.y-a.y,t.anim.setLayers(n||this.getLayers()),t.anim.start(),this._setDragPosition());},Konva.Node.prototype._setDragPosition=function(t){var e=Konva.DD,n=this.getStage().getPointerPosition(),i=this.getDragBoundFunc();if(n){var a={x:n.x-e.offset.x,y:n.y-e.offset.y};void 0!==i&&(a=i.call(this,a,t)),this.setAbsolutePosition(a),this._lastPos&&this._lastPos.x===a.x&&this._lastPos.y===a.y||(e.anim.dirty=!0),this._lastPos=a;}},Konva.Node.prototype.stopDrag=function(){var t=Konva.DD,e={};t._endDragBefore(e),t._endDragAfter(e);},Konva.Node.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange();};var t=Konva.Node.prototype.destroy;Konva.Node.prototype.destroy=function(){var e=Konva.DD;e.node&&e.node._id===this._id&&this.stopDrag(),t.call(this);},Konva.Node.prototype.isDragging=function(){var t=Konva.DD;return!(!t.node||t.node._id!==this._id||!t.isDragging);},Konva.Node.prototype._listenDrag=function(){var t=this;this._dragCleanup(),"Stage"===this.getClassName()?this.on("contentMousedown.konva contentTouchstart.konva",function(e){Konva.DD.node||t.startDrag(e);}):this.on("mousedown.konva touchstart.konva",function(e){1!==e.evt.button&&2!==e.evt.button&&(Konva.DD.node||t.startDrag(e));});},Konva.Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage(),e=Konva.DD;t&&e.node&&e.node._id===this._id&&e.node.stopDrag();}},Konva.Node.prototype._dragCleanup=function(){"Stage"===this.getClassName()?(this.off("contentMousedown.konva"),this.off("contentTouchstart.konva")):(this.off("mousedown.konva"),this.off("touchstart.konva"));},Konva.Factory.addGetterSetter(Konva.Node,"dragBoundFunc"),Konva.Factory.addGetter(Konva.Node,"draggable",!1),Konva.Factory.addOverloadedGetterSetter(Konva.Node,"draggable");var e=Konva.document.documentElement;e.addEventListener("mouseup",Konva.DD._endDragBefore,!0),e.addEventListener("touchend",Konva.DD._endDragBefore,!0),e.addEventListener("mousemove",Konva.DD._drag),e.addEventListener("touchmove",Konva.DD._drag),e.addEventListener("mouseup",Konva.DD._endDragAfter,!1),e.addEventListener("touchend",Konva.DD._endDragAfter,!1);}(),function(){"use strict";Konva.Rect=function(t){this.___init(t);},Konva.Rect.prototype={___init:function ___init(t){Konva.Shape.call(this,t),this.className="Rect",this.sceneFunc(this._sceneFunc);},_sceneFunc:function _sceneFunc(t){var e=this.getCornerRadius(),n=this.getWidth(),i=this.getHeight();t.beginPath(),e?(e=Math.min(e,n/2,i/2),t.moveTo(e,0),t.lineTo(n-e,0),t.arc(n-e,e,e,3*Math.PI/2,0,!1),t.lineTo(n,i-e),t.arc(n-e,i-e,e,0,Math.PI/2,!1),t.lineTo(e,i),t.arc(e,i-e,e,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this);}},Konva.Util.extend(Konva.Rect,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Rect,"cornerRadius",0),Konva.Collection.mapMethods(Konva.Rect);}(),function(){"use strict";var t="Image";Konva.Image=function(t){this.___init(t);},Konva.Image.prototype={___init:function ___init(e){Konva.Shape.call(this,e),this.className=t,this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc);},_useBufferCanvas:function _useBufferCanvas(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()&&this.getStage();},_sceneFunc:function _sceneFunc(t){var e,n,i,a=this.getWidth(),r=this.getHeight(),o=this.getImage();o&&(e=this.getCropWidth(),n=this.getCropHeight(),i=e&&n?[o,this.getCropX(),this.getCropY(),e,n,0,0,a,r]:[o,0,0,a,r]),(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,a,r),t.closePath(),t.fillStrokeShape(this)),o&&t.drawImage.apply(t,i);},_hitFunc:function _hitFunc(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this);},getWidth:function getWidth(){var t=this.getImage();return this.attrs.width||(t?t.width:0);},getHeight:function getHeight(){var t=this.getImage();return this.attrs.height||(t?t.height:0);}},Konva.Util.extend(Konva.Image,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Image,"image"),Konva.Factory.addComponentsGetterSetter(Konva.Image,"crop",["x","y","width","height"]),Konva.Factory.addGetterSetter(Konva.Image,"cropX",0),Konva.Factory.addGetterSetter(Konva.Image,"cropY",0),Konva.Factory.addGetterSetter(Konva.Image,"cropWidth",0),Konva.Factory.addGetterSetter(Konva.Image,"cropHeight",0),Konva.Collection.mapMethods(Konva.Image),Konva.Image.fromURL=function(t,e){var n=new Image();n.onload=function(){var t=new Konva.Image({image:n});e(t);},n.src=t;};}(),function(){"use strict";function t(t){t.fillText(this.partialText,0,0);}function e(t){t.strokeText(this.partialText,0,0);}var n="auto",i="center",a="Change.konva",r="2d",o="-",s="",h="left",l="text",c="Text",d="middle",u="normal",g="px ",f=" ",v="right",p="word",m="char",_="none",y=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","lineHeight","text","width","height","wrap"],S=y.length,C=Konva.Util.createCanvasElement().getContext(r);Konva.Text=function(t){this.___init(t);},Konva.Text.prototype={___init:function ___init(n){n=n||{},n.fillLinearGradientColorStops||n.fillRadialGradientColorStops||(n.fill=n.fill||"black"),Konva.Shape.call(this,n),this._fillFunc=t,this._strokeFunc=e,this.className=c;for(var i=0;i<S;i++){this.on(y[i]+a,this._setTextData);}this._setTextData(),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc);},_sceneFunc:function _sceneFunc(t){var e,n=this.getPadding(),a=this.getTextHeight(),r=this.getLineHeight()*a,o=this.textArr,s=o.length,l=this.getWidth();for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",d),t.setAttr("textAlign",h),t.save(),n?(t.translate(n,0),t.translate(0,n+a/2)):t.translate(0,a/2),e=0;e<s;e++){var c=o[e],u=c.text,g=c.width;t.save(),this.getAlign()===v?t.translate(l-g-2*n,0):this.getAlign()===i&&t.translate((l-g-2*n)/2,0),this.partialText=u,t.fillStrokeShape(this),t.restore(),t.translate(0,r);}t.restore();},_hitFunc:function _hitFunc(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this);},setText:function setText(t){var e=Konva.Util._isString(t)?t:(t||"").toString();return this._setAttr(l,e),this;},getWidth:function getWidth(){var t=this.attrs.width===n||void 0===this.attrs.width;return t?this.getTextWidth()+2*this.getPadding():this.attrs.width;},getHeight:function getHeight(){var t=this.attrs.height===n||void 0===this.attrs.height;return t?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height;},getTextWidth:function getTextWidth(){return this.textWidth;},getTextHeight:function getTextHeight(){return this.textHeight;},_getTextSize:function _getTextSize(t){var e,n=C,i=this.getFontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:parseInt(i,10)};},_getContextFont:function _getContextFont(){return Konva.UA.isIE?this.getFontStyle()+f+this.getFontSize()+g+this.getFontFamily():this.getFontStyle()+f+this.getFontVariant()+f+this.getFontSize()+g+this.getFontFamily();},_addTextLine:function _addTextLine(t,e){return this.textArr.push({text:t,width:e});},_getTextWidth:function _getTextWidth(t){return C.measureText(t).width;},_setTextData:function _setTextData(){var t=this.getText().split("\n"),e=+this.getFontSize(),i=0,a=this.getLineHeight()*e,r=this.attrs.width,s=this.attrs.height,h=r!==n,l=s!==n,c=this.getPadding(),d=r-2*c,u=s-2*c,g=0,v=this.getWrap(),p=v!==_,y=v!==m&&p;this.textArr=[],C.save(),C.font=this._getContextFont();for(var S=0,K=t.length;S<K;++S){var w=t[S],x=this._getTextWidth(w);if(h&&x>d)for(;w.length>0;){for(var b=0,D=w.length,T="",A=0;b<D;){var F=b+D>>>1,P=w.slice(0,F+1),G=this._getTextWidth(P);G<=d?(b=F+1,T=P,A=G):D=F;}if(!T)break;if(y){var k=Math.max(T.lastIndexOf(f),T.lastIndexOf(o))+1;k>0&&(b=k,T=T.slice(0,b),A=this._getTextWidth(T));}if(this._addTextLine(T,A),i=Math.max(i,A),g+=a,!p||l&&g+a>u)break;if(w=w.slice(b),w.length>0&&(x=this._getTextWidth(w),x<=d)){this._addTextLine(w,x),g+=a,i=Math.max(i,x);break;}}else this._addTextLine(w,x),g+=a,i=Math.max(i,x);if(l&&g+a>u)break;}C.restore(),this.textHeight=e,this.textWidth=i;}},Konva.Util.extend(Konva.Text,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Text,"fontFamily","Arial"),Konva.Factory.addGetterSetter(Konva.Text,"fontSize",12),Konva.Factory.addGetterSetter(Konva.Text,"fontStyle",u),Konva.Factory.addGetterSetter(Konva.Text,"fontVariant",u),Konva.Factory.addGetterSetter(Konva.Text,"padding",0),Konva.Factory.addGetterSetter(Konva.Text,"align",h),Konva.Factory.addGetterSetter(Konva.Text,"lineHeight",1),Konva.Factory.addGetterSetter(Konva.Text,"wrap",p),Konva.Factory.addGetter(Konva.Text,"text",s),Konva.Factory.addOverloadedGetterSetter(Konva.Text,"text"),Konva.Collection.mapMethods(Konva.Text);}(),function(){"use strict";Konva.Line=function(t){this.___init(t);},Konva.Line.prototype={___init:function ___init(t){Konva.Shape.call(this,t),this.className="Line",this.on("pointsChange.konva tensionChange.konva closedChange.konva",function(){this._clearCache("tensionPoints");}),this.sceneFunc(this._sceneFunc);},_sceneFunc:function _sceneFunc(t){var e,n,i,a=this.getPoints(),r=a.length,o=this.getTension(),s=this.getClosed();if(r){if(t.beginPath(),t.moveTo(a[0],a[1]),0!==o&&r>4){for(e=this.getTensionPoints(),n=e.length,i=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);i<n-2;){t.bezierCurveTo(e[i++],e[i++],e[i++],e[i++],e[i++],e[i++]);}s||t.quadraticCurveTo(e[n-2],e[n-1],a[r-2],a[r-1]);}else for(i=2;i<r;i+=2){t.lineTo(a[i],a[i+1]);}s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this);}},getTensionPoints:function getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints);},_getTensionPoints:function _getTensionPoints(){return this.getClosed()?this._getTensionPointsClosed():Konva.Util._expandPoints(this.getPoints(),this.getTension());},_getTensionPointsClosed:function _getTensionPointsClosed(){var t=this.getPoints(),e=t.length,n=this.getTension(),i=Konva.Util,a=i._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),r=i._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),o=Konva.Util._expandPoints(t,n),s=[a[2],a[3]].concat(o).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],a[0],a[1],t[0],t[1]]);return s;},getWidth:function getWidth(){return this.getSelfRect().width;},getHeight:function getHeight(){return this.getSelfRect().height;},getSelfRect:function getSelfRect(){var t;t=0!==this.getTension()?this._getTensionPoints():this.getPoints();for(var e,n,i=t[0],a=t[0],r=t[1],o=t[1],s=0;s<t.length/2;s++){e=t[2*s],n=t[2*s+1],i=Math.min(i,e),a=Math.max(a,e),r=Math.min(r,n),o=Math.max(o,n);}return{x:Math.round(i),y:Math.round(r),width:Math.round(a-i),height:Math.round(o-r)};}},Konva.Util.extend(Konva.Line,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Line,"closed",!1),Konva.Factory.addGetterSetter(Konva.Line,"tension",0),Konva.Factory.addGetterSetter(Konva.Line,"points",[]),Konva.Collection.mapMethods(Konva.Line);}(),function(){"use strict";var t=["fontFamily","fontSize","fontStyle","padding","lineHeight","text"],e="Change.konva",n="none",i="up",a="right",r="down",o="left",s="Label",h=t.length;Konva.Label=function(t){this.____init(t);},Konva.Label.prototype={____init:function ____init(t){var e=this;Konva.Group.call(this,t),this.className=s,this.on("add.konva",function(t){e._addListeners(t.child),e._sync();});},getText:function getText(){return this.find("Text")[0];},getTag:function getTag(){return this.find("Tag")[0];},_addListeners:function _addListeners(n){var i,a=this,r=function r(){a._sync();};for(i=0;i<h;i++){n.on(t[i]+e,r);}},getWidth:function getWidth(){return this.getText().getWidth();},getHeight:function getHeight(){return this.getText().getHeight();},_sync:function _sync(){var t,e,n,s,h,l,c,d=this.getText(),u=this.getTag();if(d&&u){switch(t=d.getWidth(),e=d.getHeight(),n=u.getPointerDirection(),s=u.getPointerWidth(),c=u.getPointerHeight(),h=0,l=0,n){case i:h=t/2,l=-1*c;break;case a:h=t+s,l=e/2;break;case r:h=t/2,l=e+c;break;case o:h=-1*s,l=e/2;}u.setAttrs({x:-1*h,y:-1*l,width:t,height:e}),d.setAttrs({x:-1*h,y:-1*l});}}},Konva.Util.extend(Konva.Label,Konva.Group),Konva.Collection.mapMethods(Konva.Label),Konva.Tag=function(t){this.___init(t);},Konva.Tag.prototype={___init:function ___init(t){Konva.Shape.call(this,t),this.className="Tag",this.sceneFunc(this._sceneFunc);},_sceneFunc:function _sceneFunc(t){var e=this.getWidth(),n=this.getHeight(),s=this.getPointerDirection(),h=this.getPointerWidth(),l=this.getPointerHeight(),c=Math.min(this.getCornerRadius(),e/2,n/2);t.beginPath(),c?t.moveTo(c,0):t.moveTo(0,0),s===i&&(t.lineTo((e-h)/2,0),t.lineTo(e/2,-1*l),t.lineTo((e+h)/2,0)),c?(t.lineTo(e-c,0),t.arc(e-c,c,c,3*Math.PI/2,0,!1)):t.lineTo(e,0),s===a&&(t.lineTo(e,(n-l)/2),t.lineTo(e+h,n/2),t.lineTo(e,(n+l)/2)),c?(t.lineTo(e,n-c),t.arc(e-c,n-c,c,0,Math.PI/2,!1)):t.lineTo(e,n),s===r&&(t.lineTo((e+h)/2,n),t.lineTo(e/2,n+l),t.lineTo((e-h)/2,n)),c?(t.lineTo(c,n),t.arc(c,n-c,c,Math.PI/2,Math.PI,!1)):t.lineTo(0,n),s===o&&(t.lineTo(0,(n+l)/2),t.lineTo(-1*h,n/2),t.lineTo(0,(n-l)/2)),c&&(t.lineTo(0,c),t.arc(c,c,c,Math.PI,3*Math.PI/2,!1)),t.closePath(),t.fillStrokeShape(this);},getSelfRect:function getSelfRect(){var t=0,e=0,n=this.getPointerWidth(),s=this.getPointerHeight(),h=this.pointerDirection(),l=this.getWidth(),c=this.getHeight();return h===i?(e-=s,c+=s):h===r?c+=s:h===o?(t-=1.5*n,l+=n):h===a&&(l+=1.5*n),{x:t,y:e,width:l,height:c};}},Konva.Util.extend(Konva.Tag,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Tag,"pointerDirection",n),Konva.Factory.addGetterSetter(Konva.Tag,"pointerWidth",0),Konva.Factory.addGetterSetter(Konva.Tag,"pointerHeight",0),Konva.Factory.addGetterSetter(Konva.Tag,"cornerRadius",0),Konva.Collection.mapMethods(Konva.Tag);}(),function(){"use strict";Konva.Arrow=function(t){this.____init(t);},Konva.Arrow.prototype={____init:function ____init(t){Konva.Line.call(this,t),this.className="Arrow";},_sceneFunc:function _sceneFunc(t){Konva.Line.prototype._sceneFunc.apply(this,arguments);var e=2*Math.PI,n=this.points(),i=n.length,a=n[i-2]-n[i-4],r=n[i-1]-n[i-3],o=(Math.atan2(r,a)+e)%e,s=this.pointerLength(),h=this.pointerWidth();t.save(),t.beginPath(),t.translate(n[i-2],n[i-1]),t.rotate(o),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore(),this.pointerAtBeginning()&&(t.save(),t.translate(n[0],n[1]),a=n[2]-n[0],r=n[3]-n[1],t.rotate((Math.atan2(-r,-a)+e)%e),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore()),t.fillStrokeShape(this);}},Konva.Util.extend(Konva.Arrow,Konva.Line),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerLength",10),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerWidth",10),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerAtBeginning",!1),Konva.Collection.mapMethods(Konva.Arrow);}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(e){if("object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.React=e();}}(function(){return function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l;}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e);},c,c.exports,e,t,n,r);}return n[i].exports;}for(var a="function"==typeof require&&require,i=0;i<r.length;i++){o(r[i]);}return o;}({1:[function(e,t,n){"use strict";var r=e(40),o=e(148),a={focusDOMComponent:function focusDOMComponent(){o(r.getNodeFromInstance(this));}};t.exports=a;},{148:148,40:40}],2:[function(e,t,n){"use strict";function r(){var e=window.opera;return"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&"function"==typeof e.version&&parseInt(e.version(),10)<=12;}function o(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey);}function a(e){switch(e){case k.topCompositionStart:return M.compositionStart;case k.topCompositionEnd:return M.compositionEnd;case k.topCompositionUpdate:return M.compositionUpdate;}}function i(e,t){return e===k.topKeyDown&&t.keyCode===_;}function s(e,t){switch(e){case k.topKeyUp:return C.indexOf(t.keyCode)!==-1;case k.topKeyDown:return t.keyCode!==_;case k.topKeyPress:case k.topMouseDown:case k.topBlur:return!0;default:return!1;}}function u(e){var t=e.detail;return"object"==(typeof t==="undefined"?"undefined":_typeof(t))&&"data"in t?t.data:null;}function l(e,t,n,r){var o,l;if(E?o=a(e):R?s(e,n)&&(o=M.compositionEnd):i(e,n)&&(o=M.compositionStart),!o)return null;N&&(R||o!==M.compositionStart?o===M.compositionEnd&&R&&(l=R.getData()):R=v.getPooled(r));var c=g.getPooled(o,t,n,r);if(l)c.data=l;else{var p=u(n);null!==p&&(c.data=p);}return h.accumulateTwoPhaseDispatches(c),c;}function c(e,t){switch(e){case k.topCompositionEnd:return u(t);case k.topKeyPress:var n=t.which;return n!==w?null:(S=!0,P);case k.topTextInput:var r=t.data;return r===P&&S?null:r;default:return null;}}function p(e,t){if(R){if(e===k.topCompositionEnd||s(e,t)){var n=R.getData();return v.release(R),R=null,n;}return null;}switch(e){case k.topPaste:return null;case k.topKeyPress:return t.which&&!o(t)?String.fromCharCode(t.which):null;case k.topCompositionEnd:return N?null:t.data;default:return null;}}function d(e,t,n,r){var o;if(o=T?c(e,n):p(e,n),!o)return null;var a=y.getPooled(M.beforeInput,t,n,r);return a.data=o,h.accumulateTwoPhaseDispatches(a),a;}var f=e(16),h=e(20),m=e(140),v=e(21),g=e(95),y=e(99),b=e(158),C=[9,13,27,32],_=229,E=m.canUseDOM&&"CompositionEvent"in window,x=null;m.canUseDOM&&"documentMode"in document&&(x=document.documentMode);var T=m.canUseDOM&&"TextEvent"in window&&!x&&!r(),N=m.canUseDOM&&(!E||x&&x>8&&x<=11),w=32,P=String.fromCharCode(w),k=f.topLevelTypes,M={beforeInput:{phasedRegistrationNames:{bubbled:b({onBeforeInput:null}),captured:b({onBeforeInputCapture:null})},dependencies:[k.topCompositionEnd,k.topKeyPress,k.topTextInput,k.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:b({onCompositionEnd:null}),captured:b({onCompositionEndCapture:null})},dependencies:[k.topBlur,k.topCompositionEnd,k.topKeyDown,k.topKeyPress,k.topKeyUp,k.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:b({onCompositionStart:null}),captured:b({onCompositionStartCapture:null})},dependencies:[k.topBlur,k.topCompositionStart,k.topKeyDown,k.topKeyPress,k.topKeyUp,k.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:b({onCompositionUpdate:null}),captured:b({onCompositionUpdateCapture:null})},dependencies:[k.topBlur,k.topCompositionUpdate,k.topKeyDown,k.topKeyPress,k.topKeyUp,k.topMouseDown]}},S=!1,R=null,O={eventTypes:M,extractEvents:function extractEvents(e,t,n,r){return[l(e,t,n,r),d(e,t,n,r)];}};t.exports=O;},{140:140,158:158,16:16,20:20,21:21,95:95,99:99}],3:[function(e,t,n){"use strict";function r(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1);}var o={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(e){a.forEach(function(t){o[r(t,e)]=o[e];});});var i={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},s={isUnitlessNumber:o,shorthandPropertyExpansions:i};t.exports=s;},{}],4:[function(e,t,n){"use strict";var r=e(3),o=e(140),a=(e(66),e(142),e(113)),i=e(153),s=e(159),u=(e(161),s(function(e){return i(e);})),l=!1,c="cssFloat";if(o.canUseDOM){var p=document.createElement("div").style;try{p.font="";}catch(e){l=!0;}void 0===document.documentElement.style.cssFloat&&(c="styleFloat");}var d={createMarkupForStyles:function createMarkupForStyles(e,t){var n="";for(var r in e){if(e.hasOwnProperty(r)){var o=e[r];null!=o&&(n+=u(r)+":",n+=a(r,o,t)+";");}}return n||null;},setValueForStyles:function setValueForStyles(e,t,n){var o=e.style;for(var i in t){if(t.hasOwnProperty(i)){var s=a(i,t[i],n);if("float"!==i&&"cssFloat"!==i||(i=c),s)o[i]=s;else{var u=l&&r.shorthandPropertyExpansions[i];if(u)for(var p in u){o[p]="";}else o[i]="";}}}}};t.exports=d;},{113:113,140:140,142:142,153:153,159:159,161:161,3:3,66:66}],5:[function(e,t,n){"use strict";function r(){this._callbacks=null,this._contexts=null;}var o=e(132),a=e(162),i=e(25);e(154);a(r.prototype,{enqueue:function enqueue(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t);},notifyAll:function notifyAll(){var e=this._callbacks,t=this._contexts;if(e){e.length!==t.length?o("24"):void 0,this._callbacks=null,this._contexts=null;for(var n=0;n<e.length;n++){e[n].call(t[n]);}e.length=0,t.length=0;}},checkpoint:function checkpoint(){return this._callbacks?this._callbacks.length:0;},rollback:function rollback(e){this._callbacks&&(this._callbacks.length=e,this._contexts.length=e);},reset:function reset(){this._callbacks=null,this._contexts=null;},destructor:function destructor(){this.reset();}}),i.addPoolingTo(r),t.exports=r;},{132:132,154:154,162:162,25:25}],6:[function(e,t,n){"use strict";function r(e){var t=e.nodeName&&e.nodeName.toLowerCase();return"select"===t||"input"===t&&"file"===e.type;}function o(e){var t=T.getPooled(S.change,O,e,N(e));C.accumulateTwoPhaseDispatches(t),x.batchedUpdates(a,t);}function a(e){b.enqueueEvents(e),b.processEventQueue(!1);}function i(e,t){R=e,O=t,R.attachEvent("onchange",o);}function s(){R&&(R.detachEvent("onchange",o),R=null,O=null);}function u(e,t){if(e===M.topChange)return t;}function l(e,t,n){e===M.topFocus?(s(),i(t,n)):e===M.topBlur&&s();}function c(e,t){R=e,O=t,I=e.value,D=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(R,"value",U),R.attachEvent?R.attachEvent("onpropertychange",d):R.addEventListener("propertychange",d,!1);}function p(){R&&(delete R.value,R.detachEvent?R.detachEvent("onpropertychange",d):R.removeEventListener("propertychange",d,!1),R=null,O=null,I=null,D=null);}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==I&&(I=t,o(e));}}function f(e,t){if(e===M.topInput)return t;}function h(e,t,n){e===M.topFocus?(p(),c(t,n)):e===M.topBlur&&p();}function m(e,t){if((e===M.topSelectionChange||e===M.topKeyUp||e===M.topKeyDown)&&R&&R.value!==I)return I=R.value,O;}function v(e){return e.nodeName&&"input"===e.nodeName.toLowerCase()&&("checkbox"===e.type||"radio"===e.type);}function g(e,t){if(e===M.topClick)return t;}var y=e(16),b=e(17),C=e(20),_=e(140),E=e(40),x=e(88),T=e(97),N=e(121),w=e(128),P=e(129),k=e(158),M=y.topLevelTypes,S={change:{phasedRegistrationNames:{bubbled:k({onChange:null}),captured:k({onChangeCapture:null})},dependencies:[M.topBlur,M.topChange,M.topClick,M.topFocus,M.topInput,M.topKeyDown,M.topKeyUp,M.topSelectionChange]}},R=null,O=null,I=null,D=null,A=!1;_.canUseDOM&&(A=w("change")&&(!("documentMode"in document)||document.documentMode>8));var L=!1;_.canUseDOM&&(L=w("input")&&(!("documentMode"in document)||document.documentMode>11));var U={get:function get(){return D.get.call(this);},set:function set(e){I=""+e,D.set.call(this,e);}},F={eventTypes:S,extractEvents:function extractEvents(e,t,n,o){var a,i,s=t?E.getNodeFromInstance(t):window;if(r(s)?A?a=u:i=l:P(s)?L?a=f:(a=m,i=h):v(s)&&(a=g),a){var c=a(e,t);if(c){var p=T.getPooled(S.change,c,n,o);return p.type="change",C.accumulateTwoPhaseDispatches(p),p;}}i&&i(e,s,t);}};t.exports=F;},{121:121,128:128,129:129,140:140,158:158,16:16,17:17,20:20,40:40,88:88,97:97}],7:[function(e,t,n){"use strict";function r(e,t){return Array.isArray(t)&&(t=t[1]),t?t.nextSibling:e.firstChild;}function o(e,t,n){c.insertTreeBefore(e,t,n);}function a(e,t,n){Array.isArray(t)?s(e,t[0],t[1],n):v(e,t,n);}function i(e,t){if(Array.isArray(t)){var n=t[1];t=t[0],u(e,t,n),e.removeChild(n);}e.removeChild(t);}function s(e,t,n,r){for(var o=t;;){var a=o.nextSibling;if(v(e,o,r),o===n)break;o=a;}}function u(e,t,n){for(;;){var r=t.nextSibling;if(r===n)break;e.removeChild(r);}}function l(e,t,n){var r=e.parentNode,o=e.nextSibling;o===t?n&&v(r,document.createTextNode(n),o):n?(m(o,n),u(r,o,t)):u(r,e,t);}var c=e(8),p=e(12),d=e(70),f=(e(40),e(66),e(112)),h=e(134),m=e(135),v=f(function(e,t,n){e.insertBefore(t,n);}),g=p.dangerouslyReplaceNodeWithMarkup,y={dangerouslyReplaceNodeWithMarkup:g,replaceDelimitedText:l,processUpdates:function processUpdates(e,t){for(var n=0;n<t.length;n++){var s=t[n];switch(s.type){case d.INSERT_MARKUP:o(e,s.content,r(e,s.afterNode));break;case d.MOVE_EXISTING:a(e,s.fromNode,r(e,s.afterNode));break;case d.SET_MARKUP:h(e,s.content);break;case d.TEXT_CONTENT:m(e,s.content);break;case d.REMOVE_NODE:i(e,s.fromNode);}}}};t.exports=y;},{112:112,12:12,134:134,135:135,40:40,66:66,70:70,8:8}],8:[function(e,t,n){"use strict";function r(e){if(v){var t=e.node,n=e.children;if(n.length)for(var r=0;r<n.length;r++){g(t,n[r],null);}else null!=e.html?p(t,e.html):null!=e.text&&f(t,e.text);}}function o(e,t){e.parentNode.replaceChild(t.node,e),r(t);}function a(e,t){v?e.children.push(t):e.node.appendChild(t.node);}function i(e,t){v?e.html=t:p(e.node,t);}function s(e,t){v?e.text=t:f(e.node,t);}function u(){return this.node.nodeName;}function l(e){return{node:e,children:[],html:null,text:null,toString:u};}var c=e(9),p=e(134),d=e(112),f=e(135),h=1,m=11,v="undefined"!=typeof document&&"number"==typeof document.documentMode||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&/\bEdge\/\d/.test(navigator.userAgent),g=d(function(e,t,n){t.node.nodeType===m||t.node.nodeType===h&&"object"===t.node.nodeName.toLowerCase()&&(null==t.node.namespaceURI||t.node.namespaceURI===c.html)?(r(t),e.insertBefore(t.node,n)):(e.insertBefore(t.node,n),r(t));});l.insertTreeBefore=g,l.replaceChildWithTree=o,l.queueChild=a,l.queueHTML=i,l.queueText=s,t.exports=l;},{112:112,134:134,135:135,9:9}],9:[function(e,t,n){"use strict";var r={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};t.exports=r;},{}],10:[function(e,t,n){"use strict";function r(e,t){return(e&t)===t;}var o=e(132),a=(e(154),{MUST_USE_PROPERTY:1,HAS_BOOLEAN_VALUE:4,HAS_NUMERIC_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:24,HAS_OVERLOADED_BOOLEAN_VALUE:32,injectDOMPropertyConfig:function injectDOMPropertyConfig(e){var t=a,n=e.Properties||{},i=e.DOMAttributeNamespaces||{},u=e.DOMAttributeNames||{},l=e.DOMPropertyNames||{},c=e.DOMMutationMethods||{};e.isCustomAttribute&&s._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var p in n){s.properties.hasOwnProperty(p)?o("48",p):void 0;var d=p.toLowerCase(),f=n[p],h={attributeName:d,attributeNamespace:null,propertyName:p,mutationMethod:null,mustUseProperty:r(f,t.MUST_USE_PROPERTY),hasBooleanValue:r(f,t.HAS_BOOLEAN_VALUE),hasNumericValue:r(f,t.HAS_NUMERIC_VALUE),hasPositiveNumericValue:r(f,t.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:r(f,t.HAS_OVERLOADED_BOOLEAN_VALUE)};if(h.hasBooleanValue+h.hasNumericValue+h.hasOverloadedBooleanValue<=1?void 0:o("50",p),u.hasOwnProperty(p)){var m=u[p];h.attributeName=m;}i.hasOwnProperty(p)&&(h.attributeNamespace=i[p]),l.hasOwnProperty(p)&&(h.propertyName=l[p]),c.hasOwnProperty(p)&&(h.mutationMethod=c[p]),s.properties[p]=h;}}}),i=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",s={ID_ATTRIBUTE_NAME:"data-reactid",ROOT_ATTRIBUTE_NAME:"data-reactroot",ATTRIBUTE_NAME_START_CHAR:i,ATTRIBUTE_NAME_CHAR:i+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function isCustomAttribute(e){for(var t=0;t<s._isCustomAttributeFunctions.length;t++){var n=s._isCustomAttributeFunctions[t];if(n(e))return!0;}return!1;},injection:a};t.exports=s;},{132:132,154:154}],11:[function(e,t,n){"use strict";function r(e){return!!l.hasOwnProperty(e)||!u.hasOwnProperty(e)&&(s.test(e)?(l[e]=!0,!0):(u[e]=!0,!1));}function o(e,t){return null==t||e.hasBooleanValue&&!t||e.hasNumericValue&&isNaN(t)||e.hasPositiveNumericValue&&t<1||e.hasOverloadedBooleanValue&&t===!1;}var a=e(10),i=(e(40),e(66),e(131)),s=(e(161),new RegExp("^["+a.ATTRIBUTE_NAME_START_CHAR+"]["+a.ATTRIBUTE_NAME_CHAR+"]*$")),u={},l={},c={createMarkupForID:function createMarkupForID(e){return a.ID_ATTRIBUTE_NAME+"="+i(e);},setAttributeForID:function setAttributeForID(e,t){e.setAttribute(a.ID_ATTRIBUTE_NAME,t);},createMarkupForRoot:function createMarkupForRoot(){return a.ROOT_ATTRIBUTE_NAME+'=""';},setAttributeForRoot:function setAttributeForRoot(e){e.setAttribute(a.ROOT_ATTRIBUTE_NAME,"");},createMarkupForProperty:function createMarkupForProperty(e,t){var n=a.properties.hasOwnProperty(e)?a.properties[e]:null;if(n){if(o(n,t))return"";var r=n.attributeName;return n.hasBooleanValue||n.hasOverloadedBooleanValue&&t===!0?r+'=""':r+"="+i(t);}return a.isCustomAttribute(e)?null==t?"":e+"="+i(t):null;},createMarkupForCustomAttribute:function createMarkupForCustomAttribute(e,t){return r(e)&&null!=t?e+"="+i(t):"";},setValueForProperty:function setValueForProperty(e,t,n){var r=a.properties.hasOwnProperty(t)?a.properties[t]:null;if(r){var i=r.mutationMethod;if(i)i(e,n);else{if(o(r,n))return void this.deleteValueForProperty(e,t);if(r.mustUseProperty)e[r.propertyName]=n;else{var s=r.attributeName,u=r.attributeNamespace;u?e.setAttributeNS(u,s,""+n):r.hasBooleanValue||r.hasOverloadedBooleanValue&&n===!0?e.setAttribute(s,""):e.setAttribute(s,""+n);}}}else if(a.isCustomAttribute(t))return void c.setValueForAttribute(e,t,n);},setValueForAttribute:function setValueForAttribute(e,t,n){r(t)&&(null==n?e.removeAttribute(t):e.setAttribute(t,""+n));},deleteValueForAttribute:function deleteValueForAttribute(e,t){e.removeAttribute(t);},deleteValueForProperty:function deleteValueForProperty(e,t){var n=a.properties.hasOwnProperty(t)?a.properties[t]:null;if(n){var r=n.mutationMethod;if(r)r(e,void 0);else if(n.mustUseProperty){var o=n.propertyName;n.hasBooleanValue?e[o]=!1:e[o]="";}else e.removeAttribute(n.attributeName);}else a.isCustomAttribute(t)&&e.removeAttribute(t);}};t.exports=c;},{10:10,131:131,161:161,40:40,66:66}],12:[function(e,t,n){"use strict";var r=e(132),o=e(8),a=e(140),i=e(145),s=e(146),u=(e(154),{dangerouslyReplaceNodeWithMarkup:function dangerouslyReplaceNodeWithMarkup(e,t){if(a.canUseDOM?void 0:r("56"),t?void 0:r("57"),"HTML"===e.nodeName?r("58"):void 0,"string"==typeof t){var n=i(t,s)[0];e.parentNode.replaceChild(n,e);}else o.replaceChildWithTree(e,t);}});t.exports=u;},{132:132,140:140,145:145,146:146,154:154,8:8}],13:[function(e,t,n){"use strict";var r=e(158),o=[r({ResponderEventPlugin:null}),r({SimpleEventPlugin:null}),r({TapEventPlugin:null}),r({EnterLeaveEventPlugin:null}),r({ChangeEventPlugin:null}),r({SelectEventPlugin:null}),r({BeforeInputEventPlugin:null})];t.exports=o;},{158:158}],14:[function(e,t,n){"use strict";var r={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},o={getHostProps:function getHostProps(e,t){if(!t.disabled)return t;var n={};for(var o in t){!r[o]&&t.hasOwnProperty(o)&&(n[o]=t[o]);}return n;}};t.exports=o;},{}],15:[function(e,t,n){"use strict";var r=e(16),o=e(20),a=e(40),i=e(101),s=e(158),u=r.topLevelTypes,l={mouseEnter:{registrationName:s({onMouseEnter:null}),dependencies:[u.topMouseOut,u.topMouseOver]},mouseLeave:{registrationName:s({onMouseLeave:null}),dependencies:[u.topMouseOut,u.topMouseOver]}},c={eventTypes:l,extractEvents:function extractEvents(e,t,n,r){if(e===u.topMouseOver&&(n.relatedTarget||n.fromElement))return null;if(e!==u.topMouseOut&&e!==u.topMouseOver)return null;var s;if(r.window===r)s=r;else{var c=r.ownerDocument;s=c?c.defaultView||c.parentWindow:window;}var p,d;if(e===u.topMouseOut){p=t;var f=n.relatedTarget||n.toElement;d=f?a.getClosestInstanceFromNode(f):null;}else p=null,d=t;if(p===d)return null;var h=null==p?s:a.getNodeFromInstance(p),m=null==d?s:a.getNodeFromInstance(d),v=i.getPooled(l.mouseLeave,p,n,r);v.type="mouseleave",v.target=h,v.relatedTarget=m;var g=i.getPooled(l.mouseEnter,d,n,r);return g.type="mouseenter",g.target=m,g.relatedTarget=h,o.accumulateEnterLeaveDispatches(v,g,p,d),[v,g];}};t.exports=c;},{101:101,158:158,16:16,20:20,40:40}],16:[function(e,t,n){"use strict";var r=e(157),o=r({bubbled:null,captured:null}),a=r({topAbort:null,topAnimationEnd:null,topAnimationIteration:null,topAnimationStart:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topInvalid:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topTransitionEnd:null,topVolumeChange:null,topWaiting:null,topWheel:null}),i={topLevelTypes:a,PropagationPhases:o};t.exports=i;},{157:157}],17:[function(e,t,n){"use strict";var r=e(132),o=e(18),a=e(19),i=e(58),s=e(108),u=e(117),l=(e(154),{}),c=null,p=function p(e,t){e&&(a.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e));},d=function d(e){return p(e,!0);},f=function f(e){return p(e,!1);},h=function h(e){return"."+e._rootNodeID;},m={injection:{injectEventPluginOrder:o.injectEventPluginOrder,injectEventPluginsByName:o.injectEventPluginsByName},putListener:function putListener(e,t,n){"function"!=typeof n?r("94",t,typeof n==="undefined"?"undefined":_typeof(n)):void 0;var a=h(e),i=l[t]||(l[t]={});i[a]=n;var s=o.registrationNameModules[t];s&&s.didPutListener&&s.didPutListener(e,t,n);},getListener:function getListener(e,t){var n=l[t],r=h(e);return n&&n[r];},deleteListener:function deleteListener(e,t){var n=o.registrationNameModules[t];n&&n.willDeleteListener&&n.willDeleteListener(e,t);var r=l[t];if(r){var a=h(e);delete r[a];}},deleteAllListeners:function deleteAllListeners(e){var t=h(e);for(var n in l){if(l.hasOwnProperty(n)&&l[n][t]){var r=o.registrationNameModules[n];r&&r.willDeleteListener&&r.willDeleteListener(e,n),delete l[n][t];}}},extractEvents:function extractEvents(e,t,n,r){for(var a,i=o.plugins,u=0;u<i.length;u++){var l=i[u];if(l){var c=l.extractEvents(e,t,n,r);c&&(a=s(a,c));}}return a;},enqueueEvents:function enqueueEvents(e){e&&(c=s(c,e));},processEventQueue:function processEventQueue(e){var t=c;c=null,e?u(t,d):u(t,f),c?r("95"):void 0,i.rethrowCaughtError();},__purge:function __purge(){l={};},__getListenerBank:function __getListenerBank(){return l;}};t.exports=m;},{108:108,117:117,132:132,154:154,18:18,19:19,58:58}],18:[function(e,t,n){"use strict";function r(){if(s)for(var e in u){var t=u[e],n=s.indexOf(e);if(n>-1?void 0:i("96",e),!l.plugins[n]){t.extractEvents?void 0:i("97",e),l.plugins[n]=t;var r=t.eventTypes;for(var a in r){o(r[a],t,a)?void 0:i("98",a,e);}}}}function o(e,t,n){l.eventNameDispatchConfigs.hasOwnProperty(n)?i("99",n):void 0,l.eventNameDispatchConfigs[n]=e;var r=e.phasedRegistrationNames;if(r){for(var o in r){if(r.hasOwnProperty(o)){var s=r[o];a(s,t,n);}}return!0;}return!!e.registrationName&&(a(e.registrationName,t,n),!0);}function a(e,t,n){l.registrationNameModules[e]?i("100",e):void 0,l.registrationNameModules[e]=t,l.registrationNameDependencies[e]=t.eventTypes[n].dependencies;}var i=e(132),s=(e(154),null),u={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},possibleRegistrationNames:null,injectEventPluginOrder:function injectEventPluginOrder(e){s?i("101"):void 0,s=Array.prototype.slice.call(e),r();},injectEventPluginsByName:function injectEventPluginsByName(e){var t=!1;for(var n in e){if(e.hasOwnProperty(n)){var o=e[n];u.hasOwnProperty(n)&&u[n]===o||(u[n]?i("102",n):void 0,u[n]=o,t=!0);}}t&&r();},getPluginModuleForEvent:function getPluginModuleForEvent(e){var t=e.dispatchConfig;if(t.registrationName)return l.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames){if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=l.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r;}}return null;},_resetEventPlugins:function _resetEventPlugins(){s=null;for(var e in u){u.hasOwnProperty(e)&&delete u[e];}l.plugins.length=0;var t=l.eventNameDispatchConfigs;for(var n in t){t.hasOwnProperty(n)&&delete t[n];}var r=l.registrationNameModules;for(var o in r){r.hasOwnProperty(o)&&delete r[o];}}};t.exports=l;},{132:132,154:154}],19:[function(e,t,n){"use strict";function r(e){return e===y.topMouseUp||e===y.topTouchEnd||e===y.topTouchCancel;}function o(e){return e===y.topMouseMove||e===y.topTouchMove;}function a(e){return e===y.topMouseDown||e===y.topTouchStart;}function i(e,t,n,r){var o=e.type||"unknown-event";e.currentTarget=b.getNodeFromInstance(r),t?v.invokeGuardedCallbackWithCatch(o,n,e):v.invokeGuardedCallback(o,n,e),e.currentTarget=null;}function s(e,t){var n=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(n))for(var o=0;o<n.length&&!e.isPropagationStopped();o++){i(e,t,n[o],r[o]);}else n&&i(e,t,n,r);e._dispatchListeners=null,e._dispatchInstances=null;}function u(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++){if(t[r](e,n[r]))return n[r];}}else if(t&&t(e,n))return n;return null;}function l(e){var t=u(e);return e._dispatchInstances=null,e._dispatchListeners=null,t;}function c(e){var t=e._dispatchListeners,n=e._dispatchInstances;Array.isArray(t)?h("103"):void 0,e.currentTarget=t?b.getNodeFromInstance(n):null;var r=t?t(e):null;return e.currentTarget=null,e._dispatchListeners=null,e._dispatchInstances=null,r;}function p(e){return!!e._dispatchListeners;}var d,f,h=e(132),m=e(16),v=e(58),g=(e(154),e(161),{injectComponentTree:function injectComponentTree(e){d=e;},injectTreeTraversal:function injectTreeTraversal(e){f=e;}}),y=m.topLevelTypes,b={isEndish:r,isMoveish:o,isStartish:a,executeDirectDispatch:c,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:l,hasDispatches:p,getInstanceFromNode:function getInstanceFromNode(e){return d.getInstanceFromNode(e);},getNodeFromInstance:function getNodeFromInstance(e){return d.getNodeFromInstance(e);},isAncestor:function isAncestor(e,t){return f.isAncestor(e,t);},getLowestCommonAncestor:function getLowestCommonAncestor(e,t){return f.getLowestCommonAncestor(e,t);},getParentInstance:function getParentInstance(e){return f.getParentInstance(e);},traverseTwoPhase:function traverseTwoPhase(e,t,n){return f.traverseTwoPhase(e,t,n);},traverseEnterLeave:function traverseEnterLeave(e,t,n,r,o){return f.traverseEnterLeave(e,t,n,r,o);},injection:g};t.exports=b;},{132:132,154:154,16:16,161:161,58:58}],20:[function(e,t,n){"use strict";function r(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return b(e,r);}function o(e,t,n){var o=t?y.bubbled:y.captured,a=r(e,n,o);a&&(n._dispatchListeners=v(n._dispatchListeners,a),n._dispatchInstances=v(n._dispatchInstances,e));}function a(e){e&&e.dispatchConfig.phasedRegistrationNames&&m.traverseTwoPhase(e._targetInst,o,e);}function i(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst,n=t?m.getParentInstance(t):null;m.traverseTwoPhase(n,o,e);}}function s(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,o=b(e,r);o&&(n._dispatchListeners=v(n._dispatchListeners,o),n._dispatchInstances=v(n._dispatchInstances,e));}}function u(e){e&&e.dispatchConfig.registrationName&&s(e._targetInst,null,e);}function l(e){g(e,a);}function c(e){g(e,i);}function p(e,t,n,r){m.traverseEnterLeave(n,r,s,e,t);}function d(e){g(e,u);}var f=e(16),h=e(17),m=e(19),v=e(108),g=e(117),y=(e(161),f.PropagationPhases),b=h.getListener,C={accumulateTwoPhaseDispatches:l,accumulateTwoPhaseDispatchesSkipTarget:c,accumulateDirectDispatches:d,accumulateEnterLeaveDispatches:p};t.exports=C;},{108:108,117:117,16:16,161:161,17:17,19:19}],21:[function(e,t,n){"use strict";function r(e){this._root=e,this._startText=this.getText(),this._fallbackText=null;}var o=e(162),a=e(25),i=e(125);o(r.prototype,{destructor:function destructor(){this._root=null,this._startText=null,this._fallbackText=null;},getText:function getText(){return"value"in this._root?this._root.value:this._root[i()];},getData:function getData(){if(this._fallbackText)return this._fallbackText;var e,t,n=this._startText,r=n.length,o=this.getText(),a=o.length;for(e=0;e<r&&n[e]===o[e];e++){}var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++){}var s=t>1?1-t:void 0;return this._fallbackText=o.slice(e,s),this._fallbackText;}}),a.addPoolingTo(r),t.exports=r;},{125:125,162:162,25:25}],22:[function(e,t,n){"use strict";var r=e(10),o=r.injection.MUST_USE_PROPERTY,a=r.injection.HAS_BOOLEAN_VALUE,i=r.injection.HAS_NUMERIC_VALUE,s=r.injection.HAS_POSITIVE_NUMERIC_VALUE,u=r.injection.HAS_OVERLOADED_BOOLEAN_VALUE,l={isCustomAttribute:RegExp.prototype.test.bind(new RegExp("^(data|aria)-["+r.ATTRIBUTE_NAME_CHAR+"]*$")),Properties:{accept:0,acceptCharset:0,accessKey:0,action:0,allowFullScreen:a,allowTransparency:0,alt:0,async:a,autoComplete:0,autoPlay:a,capture:a,cellPadding:0,cellSpacing:0,charSet:0,challenge:0,checked:o|a,cite:0,classID:0,className:0,cols:s,colSpan:0,content:0,contentEditable:0,contextMenu:0,controls:a,coords:0,crossOrigin:0,data:0,dateTime:0,default:a,defer:a,dir:0,disabled:a,download:u,draggable:0,encType:0,form:0,formAction:0,formEncType:0,formMethod:0,formNoValidate:a,formTarget:0,frameBorder:0,headers:0,height:0,hidden:a,high:0,href:0,hrefLang:0,htmlFor:0,httpEquiv:0,icon:0,id:0,inputMode:0,integrity:0,is:0,keyParams:0,keyType:0,kind:0,label:0,lang:0,list:0,loop:a,low:0,manifest:0,marginHeight:0,marginWidth:0,max:0,maxLength:0,media:0,mediaGroup:0,method:0,min:0,minLength:0,multiple:o|a,muted:o|a,name:0,nonce:0,noValidate:a,open:a,optimum:0,pattern:0,placeholder:0,poster:0,preload:0,profile:0,radioGroup:0,readOnly:a,referrerPolicy:0,rel:0,required:a,reversed:a,role:0,rows:s,rowSpan:i,sandbox:0,scope:0,scoped:a,scrolling:0,seamless:a,selected:o|a,shape:0,size:s,sizes:0,span:s,spellCheck:0,src:0,srcDoc:0,srcLang:0,srcSet:0,start:i,step:0,style:0,summary:0,tabIndex:0,target:0,title:0,type:0,useMap:0,value:0,width:0,wmode:0,wrap:0,about:0,datatype:0,inlist:0,prefix:0,property:0,resource:0,typeof:0,vocab:0,autoCapitalize:0,autoCorrect:0,autoSave:0,color:0,itemProp:0,itemScope:a,itemType:0,itemID:0,itemRef:0,results:0,security:0,unselectable:0},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{}};t.exports=l;},{10:10}],23:[function(e,t,n){"use strict";function r(e){var t=/[=:]/g,n={"=":"=0",":":"=2"},r=(""+e).replace(t,function(e){return n[e];});return"$"+r;}function o(e){var t=/(=0|=2)/g,n={"=0":"=","=2":":"},r="."===e[0]&&"$"===e[1]?e.substring(2):e.substring(1);return(""+r).replace(t,function(e){return n[e];});}var a={escape:r,unescape:o};t.exports=a;},{}],24:[function(e,t,n){"use strict";function r(e){null!=e.checkedLink&&null!=e.valueLink?s("87"):void 0;}function o(e){r(e),null!=e.value||null!=e.onChange?s("88"):void 0;}function a(e){r(e),null!=e.checked||null!=e.onChange?s("89"):void 0;}function i(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`.";}return"";}var s=e(132),u=e(76),l=e(75),c=e(77),p=(e(154),e(161),{button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0}),d={value:function value(e,t,n){return!e[t]||p[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.");},checked:function checked(e,t,n){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.");},onChange:u.func},f={},h={checkPropTypes:function checkPropTypes(e,t,n){for(var r in d){if(d.hasOwnProperty(r))var o=d[r](t,r,e,l.prop,null,c);o instanceof Error&&!(o.message in f)&&(f[o.message]=!0,i(n));}},getValue:function getValue(e){return e.valueLink?(o(e),e.valueLink.value):e.value;},getChecked:function getChecked(e){return e.checkedLink?(a(e),e.checkedLink.value):e.checked;},executeOnChange:function executeOnChange(e,t){return e.valueLink?(o(e),e.valueLink.requestChange(t.target.value)):e.checkedLink?(a(e),e.checkedLink.requestChange(t.target.checked)):e.onChange?e.onChange.call(void 0,t):void 0;}};t.exports=h;},{132:132,154:154,161:161,75:75,76:76,77:77}],25:[function(e,t,n){"use strict";var r=e(132),o=(e(154),function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n;}return new t(e);}),a=function a(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r;}return new n(e,t);},i=function i(e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,e,t,n),o;}return new r(e,t,n);},s=function s(e,t,n,r){var o=this;if(o.instancePool.length){var a=o.instancePool.pop();return o.call(a,e,t,n,r),a;}return new o(e,t,n,r);},u=function u(e,t,n,r,o){var a=this;if(a.instancePool.length){var i=a.instancePool.pop();return a.call(i,e,t,n,r,o),i;}return new a(e,t,n,r,o);},l=function l(e){var t=this;e instanceof t?void 0:r("25"),e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e);},c=10,p=o,d=function d(e,t){var n=e;return n.instancePool=[],n.getPooled=t||p,n.poolSize||(n.poolSize=c),n.release=l,n;},f={addPoolingTo:d,oneArgumentPooler:o,twoArgumentPooler:a,threeArgumentPooler:i,fourArgumentPooler:s,fiveArgumentPooler:u};t.exports=f;},{132:132,154:154}],26:[function(e,t,n){"use strict";var r=e(162),o=e(29),a=e(31),i=e(78),s=e(30),u=e(43),l=e(56),c=e(76),p=e(89),d=e(130),f=(e(161),l.createElement),h=l.createFactory,m=l.cloneElement,v=r,g={Children:{map:o.map,forEach:o.forEach,count:o.count,toArray:o.toArray,only:d},Component:a,PureComponent:i,createElement:f,cloneElement:m,isValidElement:l.isValidElement,PropTypes:c,createClass:s.createClass,createFactory:h,createMixin:function createMixin(e){return e;},DOM:u,version:p,__spread:v};t.exports=g;},{130:130,161:161,162:162,29:29,30:30,31:31,43:43,56:56,76:76,78:78,89:89}],27:[function(e,t,n){"use strict";function r(e){return Object.prototype.hasOwnProperty.call(e,v)||(e[v]=h++,d[e[v]]={}),d[e[v]];}var o,a=e(162),i=e(16),s=e(18),u=e(59),l=e(107),c=e(126),p=e(128),d={},f=!1,h=0,m={topAbort:"abort",topAnimationEnd:c("animationend")||"animationend",topAnimationIteration:c("animationiteration")||"animationiteration",topAnimationStart:c("animationstart")||"animationstart",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:c("transitionend")||"transitionend",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},v="_reactListenersID"+String(Math.random()).slice(2),g=a({},u,{ReactEventListener:null,injection:{injectReactEventListener:function injectReactEventListener(e){e.setHandleTopLevel(g.handleTopLevel),g.ReactEventListener=e;}},setEnabled:function setEnabled(e){g.ReactEventListener&&g.ReactEventListener.setEnabled(e);},isEnabled:function isEnabled(){return!(!g.ReactEventListener||!g.ReactEventListener.isEnabled());},listenTo:function listenTo(e,t){for(var n=t,o=r(n),a=s.registrationNameDependencies[e],u=i.topLevelTypes,l=0;l<a.length;l++){var c=a[l];o.hasOwnProperty(c)&&o[c]||(c===u.topWheel?p("wheel")?g.ReactEventListener.trapBubbledEvent(u.topWheel,"wheel",n):p("mousewheel")?g.ReactEventListener.trapBubbledEvent(u.topWheel,"mousewheel",n):g.ReactEventListener.trapBubbledEvent(u.topWheel,"DOMMouseScroll",n):c===u.topScroll?p("scroll",!0)?g.ReactEventListener.trapCapturedEvent(u.topScroll,"scroll",n):g.ReactEventListener.trapBubbledEvent(u.topScroll,"scroll",g.ReactEventListener.WINDOW_HANDLE):c===u.topFocus||c===u.topBlur?(p("focus",!0)?(g.ReactEventListener.trapCapturedEvent(u.topFocus,"focus",n),g.ReactEventListener.trapCapturedEvent(u.topBlur,"blur",n)):p("focusin")&&(g.ReactEventListener.trapBubbledEvent(u.topFocus,"focusin",n),g.ReactEventListener.trapBubbledEvent(u.topBlur,"focusout",n)),o[u.topBlur]=!0,o[u.topFocus]=!0):m.hasOwnProperty(c)&&g.ReactEventListener.trapBubbledEvent(c,m[c],n),o[c]=!0);}},trapBubbledEvent:function trapBubbledEvent(e,t,n){return g.ReactEventListener.trapBubbledEvent(e,t,n);},trapCapturedEvent:function trapCapturedEvent(e,t,n){return g.ReactEventListener.trapCapturedEvent(e,t,n);},ensureScrollValueMonitoring:function ensureScrollValueMonitoring(){if(void 0===o&&(o=document.createEvent&&"pageX"in document.createEvent("MouseEvent")),!o&&!f){var e=l.refreshScrollValues;g.ReactEventListener.monitorScrollValue(e),f=!0;}}});t.exports=g;},{107:107,126:126,128:128,16:16,162:162,18:18,59:59}],28:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r){var o=void 0===e[n];null!=t&&o&&(e[n]=a(t,!0));}var o=e(80),a=e(127),i=(e(23),e(136)),s=e(137);e(161);"undefined"!=typeof n&&n.env,1;var u={instantiateChildren:function instantiateChildren(e,t,n,o){if(null==e)return null;var a={};return s(e,r,a),a;},updateChildren:function updateChildren(e,t,n,r,s,u,l,c,p){if(t||e){var d,f;for(d in t){if(t.hasOwnProperty(d)){f=e&&e[d];var h=f&&f._currentElement,m=t[d];if(null!=f&&i(h,m))o.receiveComponent(f,m,s,c),t[d]=f;else{f&&(r[d]=o.getHostNode(f),o.unmountComponent(f,!1));var v=a(m,!0);t[d]=v;var g=o.mountComponent(v,s,u,l,c,p);n.push(g);}}}for(d in e){!e.hasOwnProperty(d)||t&&t.hasOwnProperty(d)||(f=e[d],r[d]=o.getHostNode(f),o.unmountComponent(f,!1));}}},unmountChildren:function unmountChildren(e,t){for(var n in e){if(e.hasOwnProperty(n)){var r=e[n];o.unmountComponent(r,t);}}}};t.exports=u;}).call(this,void 0);},{127:127,136:136,137:137,161:161,23:23,80:80}],29:[function(e,t,n){"use strict";function r(e){return(""+e).replace(C,"$&/");}function o(e,t){this.func=e,this.context=t,this.count=0;}function a(e,t,n){var r=e.func,o=e.context;r.call(o,t,e.count++);}function i(e,t,n){if(null==e)return e;var r=o.getPooled(t,n);g(e,a,r),o.release(r);}function s(e,t,n,r){this.result=e,this.keyPrefix=t,this.func=n,this.context=r,this.count=0;}function u(e,t,n){var o=e.result,a=e.keyPrefix,i=e.func,s=e.context,u=i.call(s,t,e.count++);Array.isArray(u)?l(u,o,n,v.thatReturnsArgument):null!=u&&(m.isValidElement(u)&&(u=m.cloneAndReplaceKey(u,a+(!u.key||t&&t.key===u.key?"":r(u.key)+"/")+n)),o.push(u));}function l(e,t,n,o,a){var i="";null!=n&&(i=r(n)+"/");var l=s.getPooled(t,i,o,a);g(e,u,l),s.release(l);}function c(e,t,n){if(null==e)return e;var r=[];return l(e,r,null,t,n),r;}function p(e,t,n){return null;}function d(e,t){return g(e,p,null);}function f(e){var t=[];return l(e,t,null,v.thatReturnsArgument),t;}var h=e(25),m=e(56),v=e(146),g=e(137),y=h.twoArgumentPooler,b=h.fourArgumentPooler,C=/\/+/g;o.prototype.destructor=function(){this.func=null,this.context=null,this.count=0;},h.addPoolingTo(o,y),s.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0;},h.addPoolingTo(s,b);var _={forEach:i,map:c,mapIntoWithKeyPrefixInternal:l,count:d,toArray:f};t.exports=_;},{137:137,146:146,25:25,56:56}],30:[function(e,t,n){"use strict";function r(e,t){var n=E.hasOwnProperty(t)?E[t]:null;T.hasOwnProperty(t)&&(n!==C.OVERRIDE_BASE?p("73",t):void 0),e&&(n!==C.DEFINE_MANY&&n!==C.DEFINE_MANY_MERGED?p("74",t):void 0);}function o(e,t){if(t){"function"==typeof t?p("75"):void 0,h.isValidElement(t)?p("76"):void 0;var n=e.prototype,o=n.__reactAutoBindPairs;t.hasOwnProperty(b)&&x.mixins(e,t.mixins);for(var a in t){if(t.hasOwnProperty(a)&&a!==b){var i=t[a],l=n.hasOwnProperty(a);if(r(l,a),x.hasOwnProperty(a))x[a](e,i);else{var c=E.hasOwnProperty(a),d="function"==typeof i,f=d&&!c&&!l&&t.autobind!==!1;if(f)o.push(a,i),n[a]=i;else if(l){var m=E[a];!c||m!==C.DEFINE_MANY_MERGED&&m!==C.DEFINE_MANY?p("77",m,a):void 0,m===C.DEFINE_MANY_MERGED?n[a]=s(n[a],i):m===C.DEFINE_MANY&&(n[a]=u(n[a],i));}else n[a]=i;}}}}}function a(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var o=n in x;o?p("78",n):void 0;var a=n in e;a?p("79",n):void 0,e[n]=r;}}}function i(e,t){e&&t&&"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&"object"==(typeof t==="undefined"?"undefined":_typeof(t))?void 0:p("80");for(var n in t){t.hasOwnProperty(n)&&(void 0!==e[n]?p("81",n):void 0,e[n]=t[n]);}return e;}function s(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return i(o,n),i(o,r),o;};}function u(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments);};}function l(e,t){var n=t.bind(e);return n;}function c(e){for(var t=e.__reactAutoBindPairs,n=0;n<t.length;n+=2){var r=t[n],o=t[n+1];e[r]=l(e,o);}}var p=e(132),d=e(162),f=e(31),h=e(56),m=(e(75),e(74),e(72)),v=e(147),g=(e(154),e(157)),y=e(158),b=(e(161),y({mixins:null})),C=g({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),_=[],E={mixins:C.DEFINE_MANY,statics:C.DEFINE_MANY,propTypes:C.DEFINE_MANY,contextTypes:C.DEFINE_MANY,childContextTypes:C.DEFINE_MANY,getDefaultProps:C.DEFINE_MANY_MERGED,getInitialState:C.DEFINE_MANY_MERGED,getChildContext:C.DEFINE_MANY_MERGED,render:C.DEFINE_ONCE,componentWillMount:C.DEFINE_MANY,componentDidMount:C.DEFINE_MANY,componentWillReceiveProps:C.DEFINE_MANY,shouldComponentUpdate:C.DEFINE_ONCE,componentWillUpdate:C.DEFINE_MANY,componentDidUpdate:C.DEFINE_MANY,componentWillUnmount:C.DEFINE_MANY,updateComponent:C.OVERRIDE_BASE},x={displayName:function displayName(e,t){e.displayName=t;},mixins:function mixins(e,t){if(t)for(var n=0;n<t.length;n++){o(e,t[n]);}},childContextTypes:function childContextTypes(e,t){e.childContextTypes=d({},e.childContextTypes,t);},contextTypes:function contextTypes(e,t){e.contextTypes=d({},e.contextTypes,t);},getDefaultProps:function getDefaultProps(e,t){e.getDefaultProps?e.getDefaultProps=s(e.getDefaultProps,t):e.getDefaultProps=t;},propTypes:function propTypes(e,t){e.propTypes=d({},e.propTypes,t);},statics:function statics(e,t){a(e,t);},autobind:function autobind(){}},T={replaceState:function replaceState(e,t){this.updater.enqueueReplaceState(this,e),t&&this.updater.enqueueCallback(this,t,"replaceState");},isMounted:function isMounted(){return this.updater.isMounted(this);}},N=function N(){};d(N.prototype,f.prototype,T);var w={createClass:function createClass(e){var t=function t(e,n,r){this.__reactAutoBindPairs.length&&c(this),this.props=e,this.context=n,this.refs=v,this.updater=r||m,this.state=null;var o=this.getInitialState?this.getInitialState():null;"object"!=(typeof o==="undefined"?"undefined":_typeof(o))||Array.isArray(o)?p("82",t.displayName||"ReactCompositeComponent"):void 0,this.state=o;};t.prototype=new N(),t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],_.forEach(o.bind(null,t)),o(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),t.prototype.render?void 0:p("83");for(var n in E){t.prototype[n]||(t.prototype[n]=null);}return t;},injection:{injectMixin:function injectMixin(e){_.push(e);}}};t.exports=w;},{132:132,147:147,154:154,157:157,158:158,161:161,162:162,31:31,56:56,72:72,74:74,75:75}],31:[function(e,t,n){"use strict";function r(e,t,n){this.props=e,this.context=t,this.refs=i,this.updater=n||a;}var o=e(132),a=e(72),i=(e(110),e(147));e(154),e(161);r.prototype.isReactComponent={},r.prototype.setState=function(e,t){"object"!=(typeof e==="undefined"?"undefined":_typeof(e))&&"function"!=typeof e&&null!=e?o("85"):void 0,this.updater.enqueueSetState(this,e),t&&this.updater.enqueueCallback(this,t,"setState");},r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this),e&&this.updater.enqueueCallback(this,e,"forceUpdate");};t.exports=r;},{110:110,132:132,147:147,154:154,161:161,72:72}],32:[function(e,t,n){"use strict";var r=e(7),o=e(45),a={processChildrenUpdates:o.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup};t.exports=a;},{45:45,7:7}],33:[function(e,t,n){"use strict";var r=e(132),o=(e(154),!1),a={replaceNodeWithMarkup:null,processChildrenUpdates:null,injection:{injectEnvironment:function injectEnvironment(e){o?r("104"):void 0,a.replaceNodeWithMarkup=e.replaceNodeWithMarkup,a.processChildrenUpdates=e.processChildrenUpdates,o=!0;}}};t.exports=a;},{132:132,154:154}],34:[function(e,t,n){"use strict";function r(e){}function o(e,t){}function a(e){return!(!e.prototype||!e.prototype.isReactComponent);}function i(e){return!(!e.prototype||!e.prototype.isPureReactComponent);}var s=e(132),u=e(162),l=e(33),c=e(35),p=e(56),d=e(58),f=e(65),h=(e(66),e(71)),m=(e(75),e(80)),v=e(111),g=e(147),y=(e(154),e(160)),b=e(136),C=(e(161),{ImpureClass:0,PureClass:1,StatelessFunctional:2});r.prototype.render=function(){var e=f.get(this)._currentElement.type,t=e(this.props,this.context,this.updater);return o(e,t),t;};var _=1,E={construct:function construct(e){this._currentElement=e,this._rootNodeID=0,this._compositeType=null,this._instance=null,this._hostParent=null,this._hostContainerInfo=null,this._updateBatchNumber=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedNodeType=null,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null,this._calledComponentWillUnmount=!1;},mountComponent:function mountComponent(e,t,n,u){this._context=u,this._mountOrder=_++,this._hostParent=t,this._hostContainerInfo=n;var l,c=this._currentElement.props,d=this._processContext(u),h=this._currentElement.type,m=e.getUpdateQueue(),v=a(h),y=this._constructComponent(v,c,d,m);v||null!=y&&null!=y.render?i(h)?this._compositeType=C.PureClass:this._compositeType=C.ImpureClass:(l=y,o(h,l),null===y||y===!1||p.isValidElement(y)?void 0:s("105",h.displayName||h.name||"Component"),y=new r(h),this._compositeType=C.StatelessFunctional),y.props=c,y.context=d,y.refs=g,y.updater=m,this._instance=y,f.set(y,this);var b=y.state;void 0===b&&(y.state=b=null),"object"!=(typeof b==="undefined"?"undefined":_typeof(b))||Array.isArray(b)?s("106",this.getName()||"ReactCompositeComponent"):void 0,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1;var E;return E=y.unstable_handleError?this.performInitialMountWithErrorHandling(l,t,n,e,u):this.performInitialMount(l,t,n,e,u),y.componentDidMount&&e.getReactMountReady().enqueue(y.componentDidMount,y),E;},_constructComponent:function _constructComponent(e,t,n,r){return this._constructComponentWithoutOwner(e,t,n,r);},_constructComponentWithoutOwner:function _constructComponentWithoutOwner(e,t,n,r){var o,a=this._currentElement.type;return o=e?new a(t,n,r):a(t,n,r);},performInitialMountWithErrorHandling:function performInitialMountWithErrorHandling(e,t,n,r,o){var a,i=r.checkpoint();try{a=this.performInitialMount(e,t,n,r,o);}catch(s){r.rollback(i),this._instance.unstable_handleError(s),this._pendingStateQueue&&(this._instance.state=this._processPendingState(this._instance.props,this._instance.context)),i=r.checkpoint(),this._renderedComponent.unmountComponent(!0),r.rollback(i),a=this.performInitialMount(e,t,n,r,o);}return a;},performInitialMount:function performInitialMount(e,t,n,r,o){var a=this._instance;a.componentWillMount&&(a.componentWillMount(),this._pendingStateQueue&&(a.state=this._processPendingState(a.props,a.context))),void 0===e&&(e=this._renderValidatedComponent());var i=h.getType(e);this._renderedNodeType=i;var s=this._instantiateReactComponent(e,i!==h.EMPTY);this._renderedComponent=s;var u=0,l=m.mountComponent(s,r,t,n,this._processChildContext(o),u);return l;},getHostNode:function getHostNode(){return m.getHostNode(this._renderedComponent);},unmountComponent:function unmountComponent(e){if(this._renderedComponent){var t=this._instance;if(t.componentWillUnmount&&!t._calledComponentWillUnmount)if(t._calledComponentWillUnmount=!0,e){var n=this.getName()+".componentWillUnmount()";d.invokeGuardedCallback(n,t.componentWillUnmount.bind(t));}else t.componentWillUnmount();this._renderedComponent&&(m.unmountComponent(this._renderedComponent,e),this._renderedNodeType=null,this._renderedComponent=null,this._instance=null),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=0,this._topLevelWrapper=null,f.remove(t);}},_maskContext:function _maskContext(e){var t=this._currentElement.type,n=t.contextTypes;if(!n)return g;var r={};for(var o in n){r[o]=e[o];}return r;},_processContext:function _processContext(e){var t=this._maskContext(e);return t;},_processChildContext:function _processChildContext(e){var t=this._currentElement.type,n=this._instance,r=n.getChildContext&&n.getChildContext();if(r){"object"!=_typeof(t.childContextTypes)?s("107",this.getName()||"ReactCompositeComponent"):void 0;for(var o in r){o in t.childContextTypes?void 0:s("108",this.getName()||"ReactCompositeComponent",o);}return u({},e,r);}return e;},_checkContextTypes:function _checkContextTypes(e,t,n){v(e,t,n,this.getName(),null,this._debugID);},receiveComponent:function receiveComponent(e,t,n){var r=this._currentElement,o=this._context;this._pendingElement=null,this.updateComponent(t,r,e,o,n);},performUpdateIfNecessary:function performUpdateIfNecessary(e){null!=this._pendingElement?m.receiveComponent(this,this._pendingElement,e,this._context):null!==this._pendingStateQueue||this._pendingForceUpdate?this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context):this._updateBatchNumber=null;},updateComponent:function updateComponent(e,t,n,r,o){var a=this._instance;null==a?s("136",this.getName()||"ReactCompositeComponent"):void 0;var i,u=!1;this._context===o?i=a.context:(i=this._processContext(o),u=!0);var l=t.props,c=n.props;t!==n&&(u=!0),u&&a.componentWillReceiveProps&&a.componentWillReceiveProps(c,i);var p=this._processPendingState(c,i),d=!0;this._pendingForceUpdate||(a.shouldComponentUpdate?d=a.shouldComponentUpdate(c,p,i):this._compositeType===C.PureClass&&(d=!y(l,c)||!y(a.state,p))),this._updateBatchNumber=null,d?(this._pendingForceUpdate=!1,this._performComponentUpdate(n,c,p,i,e,o)):(this._currentElement=n,this._context=o,a.props=c,a.state=p,a.context=i);},_processPendingState:function _processPendingState(e,t){var n=this._instance,r=this._pendingStateQueue,o=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!r)return n.state;if(o&&1===r.length)return r[0];for(var a=u({},o?r[0]:n.state),i=o?1:0;i<r.length;i++){var s=r[i];u(a,"function"==typeof s?s.call(n,a,e,t):s);}return a;},_performComponentUpdate:function _performComponentUpdate(e,t,n,r,o,a){var i,s,u,l=this._instance,c=Boolean(l.componentDidUpdate);c&&(i=l.props,s=l.state,u=l.context),l.componentWillUpdate&&l.componentWillUpdate(t,n,r),this._currentElement=e,this._context=a,l.props=t,l.state=n,l.context=r,this._updateRenderedComponent(o,a),c&&o.getReactMountReady().enqueue(l.componentDidUpdate.bind(l,i,s,u),l);},_updateRenderedComponent:function _updateRenderedComponent(e,t){var n=this._renderedComponent,r=n._currentElement,o=this._renderValidatedComponent();if(b(r,o))m.receiveComponent(n,o,e,this._processChildContext(t));else{var a=m.getHostNode(n);m.unmountComponent(n,!1);var i=h.getType(o);this._renderedNodeType=i;var s=this._instantiateReactComponent(o,i!==h.EMPTY);this._renderedComponent=s;var u=0,l=m.mountComponent(s,e,this._hostParent,this._hostContainerInfo,this._processChildContext(t),u);this._replaceNodeWithMarkup(a,l,n);}},_replaceNodeWithMarkup:function _replaceNodeWithMarkup(e,t,n){l.replaceNodeWithMarkup(e,t,n);},_renderValidatedComponentWithoutOwnerOrContext:function _renderValidatedComponentWithoutOwnerOrContext(){var e=this._instance,t=e.render();return t;},_renderValidatedComponent:function _renderValidatedComponent(){var e;if(this._compositeType!==C.StatelessFunctional){c.current=this;try{e=this._renderValidatedComponentWithoutOwnerOrContext();}finally{c.current=null;}}else e=this._renderValidatedComponentWithoutOwnerOrContext();return null===e||e===!1||p.isValidElement(e)?void 0:s("109",this.getName()||"ReactCompositeComponent"),e;},attachRef:function attachRef(e,t){var n=this.getPublicInstance();null==n?s("110"):void 0;var r=t.getPublicInstance(),o=n.refs===g?n.refs={}:n.refs;o[e]=r;},detachRef:function detachRef(e){var t=this.getPublicInstance().refs;delete t[e];},getName:function getName(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null;},getPublicInstance:function getPublicInstance(){var e=this._instance;return this._compositeType===C.StatelessFunctional?null:e;},_instantiateReactComponent:null},x={Mixin:E};t.exports=x;},{111:111,132:132,136:136,147:147,154:154,160:160,161:161,162:162,33:33,35:35,56:56,58:58,65:65,66:66,71:71,75:75,80:80}],35:[function(e,t,n){"use strict";var r={current:null};t.exports=r;},{}],36:[function(e,t,n){"use strict";var r=e(40),o=e(55),a=e(68),i=e(80),s=e(88),u=e(89),l=e(115),c=e(122),p=e(133);e(161);o.inject();var d={findDOMNode:l,render:a.render,unmountComponentAtNode:a.unmountComponentAtNode,version:u,unstable_batchedUpdates:s.batchedUpdates,unstable_renderSubtreeIntoContainer:p};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({ComponentTree:{getClosestInstanceFromNode:r.getClosestInstanceFromNode,getNodeFromInstance:function getNodeFromInstance(e){return e._renderedComponent&&(e=c(e)),e?r.getNodeFromInstance(e):null;}},Mount:a,Reconciler:i});t.exports=d;},{115:115,122:122,133:133,161:161,40:40,55:55,68:68,80:80,88:88,89:89}],37:[function(e,t,n){"use strict";var r=e(14),o={getHostProps:r.getHostProps};t.exports=o;},{14:14}],38:[function(e,t,n){"use strict";function r(e){if(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" This DOM node was rendered by `"+n+"`.";}}return"";}function o(e,t){t&&($[e._tag]&&(null!=t.children||null!=t.dangerouslySetInnerHTML?m("137",e._tag,e._currentElement._owner?" Check the render method of "+e._currentElement._owner.getName()+".":""):void 0),null!=t.dangerouslySetInnerHTML&&(null!=t.children?m("60"):void 0,"object"==_typeof(t.dangerouslySetInnerHTML)&&K in t.dangerouslySetInnerHTML?void 0:m("61")),null!=t.style&&"object"!=_typeof(t.style)?m("62",r(e)):void 0);}function a(e,t,n,r){if(!(r instanceof A)){var o=e._hostContainerInfo,a=o._node&&o._node.nodeType===z,s=a?o._node:o._ownerDocument;B(t,s),r.getReactMountReady().enqueue(i,{inst:e,registrationName:t,listener:n});}}function i(){var e=this;T.putListener(e.inst,e.registrationName,e.listener);}function s(){var e=this;S.postMountWrapper(e);}function u(){var e=this;I.postMountWrapper(e);}function l(){var e=this;R.postMountWrapper(e);}function c(){var e=this;e._rootNodeID?void 0:m("63");var t=j(e);switch(t?void 0:m("64"),e._tag){case"iframe":case"object":e._wrapperState.listeners=[w.trapBubbledEvent(x.topLevelTypes.topLoad,"load",t)];break;case"video":case"audio":e._wrapperState.listeners=[];for(var n in X){X.hasOwnProperty(n)&&e._wrapperState.listeners.push(w.trapBubbledEvent(x.topLevelTypes[n],X[n],t));}break;case"source":e._wrapperState.listeners=[w.trapBubbledEvent(x.topLevelTypes.topError,"error",t)];break;case"img":e._wrapperState.listeners=[w.trapBubbledEvent(x.topLevelTypes.topError,"error",t),w.trapBubbledEvent(x.topLevelTypes.topLoad,"load",t)];break;case"form":e._wrapperState.listeners=[w.trapBubbledEvent(x.topLevelTypes.topReset,"reset",t),w.trapBubbledEvent(x.topLevelTypes.topSubmit,"submit",t)];break;case"input":case"select":case"textarea":e._wrapperState.listeners=[w.trapBubbledEvent(x.topLevelTypes.topInvalid,"invalid",t)];}}function p(){O.postUpdateWrapper(this);}function d(e){ee.call(J,e)||(Z.test(e)?void 0:m("65",e),J[e]=!0);}function f(e,t){return e.indexOf("-")>=0||null!=t.is;}function h(e){var t=e.type;d(t),this._currentElement=e,this._tag=t.toLowerCase(),this._namespaceURI=null,this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._hostNode=null,this._hostParent=null,this._rootNodeID=0,this._domID=0,this._hostContainerInfo=null,this._wrapperState=null,this._topLevelWrapper=null,this._flags=0;}var m=e(132),v=e(162),g=e(1),y=e(4),b=e(8),C=e(9),_=e(10),E=e(11),x=e(16),T=e(17),N=e(18),w=e(27),P=e(37),k=e(39),M=e(40),S=e(46),R=e(47),O=e(48),I=e(52),D=(e(66),e(69)),A=e(84),L=(e(146),e(114)),U=(e(154),e(128),e(158)),F=(e(160),e(138),e(161),k),V=T.deleteListener,j=M.getNodeFromInstance,B=w.listenTo,W=N.registrationNameModules,H={string:!0,number:!0},q=U({style:null}),K=U({__html:null}),Y={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null},z=11,X={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},G={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Q={listing:!0,pre:!0,textarea:!0},$=v({menuitem:!0},G),Z=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,J={},ee={}.hasOwnProperty,te=1;h.displayName="ReactDOMComponent",h.Mixin={mountComponent:function mountComponent(e,t,n,r){this._rootNodeID=te++,this._domID=n._idCounter++,this._hostParent=t,this._hostContainerInfo=n;var a=this._currentElement.props;switch(this._tag){case"audio":case"form":case"iframe":case"img":case"link":case"object":case"source":case"video":this._wrapperState={listeners:null},e.getReactMountReady().enqueue(c,this);break;case"button":a=P.getHostProps(this,a,t);break;case"input":S.mountWrapper(this,a,t),a=S.getHostProps(this,a),e.getReactMountReady().enqueue(c,this);break;case"option":R.mountWrapper(this,a,t),a=R.getHostProps(this,a);break;case"select":O.mountWrapper(this,a,t),a=O.getHostProps(this,a),e.getReactMountReady().enqueue(c,this);break;case"textarea":I.mountWrapper(this,a,t),a=I.getHostProps(this,a),e.getReactMountReady().enqueue(c,this);}o(this,a);var i,p;null!=t?(i=t._namespaceURI,p=t._tag):n._tag&&(i=n._namespaceURI,p=n._tag),(null==i||i===C.svg&&"foreignobject"===p)&&(i=C.html),i===C.html&&("svg"===this._tag?i=C.svg:"math"===this._tag&&(i=C.mathml)),this._namespaceURI=i;var d;if(e.useCreateElement){var f,h=n._ownerDocument;if(i===C.html){if("script"===this._tag){var m=h.createElement("div"),v=this._currentElement.type;m.innerHTML="<"+v+"></"+v+">",f=m.removeChild(m.firstChild);}else f=a.is?h.createElement(this._currentElement.type,a.is):h.createElement(this._currentElement.type);}else f=h.createElementNS(i,this._currentElement.type);M.precacheNode(this,f),this._flags|=F.hasCachedChildNodes,this._hostParent||E.setAttributeForRoot(f),this._updateDOMProperties(null,a,e);var y=b(f);this._createInitialChildren(e,a,r,y),d=y;}else{var _=this._createOpenTagMarkupAndPutListeners(e,a),x=this._createContentMarkup(e,a,r);d=!x&&G[this._tag]?_+"/>":_+">"+x+"</"+this._currentElement.type+">";}switch(this._tag){case"input":e.getReactMountReady().enqueue(s,this),a.autoFocus&&e.getReactMountReady().enqueue(g.focusDOMComponent,this);break;case"textarea":e.getReactMountReady().enqueue(u,this),a.autoFocus&&e.getReactMountReady().enqueue(g.focusDOMComponent,this);break;case"select":a.autoFocus&&e.getReactMountReady().enqueue(g.focusDOMComponent,this);break;case"button":a.autoFocus&&e.getReactMountReady().enqueue(g.focusDOMComponent,this);break;case"option":e.getReactMountReady().enqueue(l,this);}return d;},_createOpenTagMarkupAndPutListeners:function _createOpenTagMarkupAndPutListeners(e,t){var n="<"+this._currentElement.type;for(var r in t){if(t.hasOwnProperty(r)){var o=t[r];if(null!=o)if(W.hasOwnProperty(r))o&&a(this,r,o,e);else{r===q&&(o&&(o=this._previousStyleCopy=v({},t.style)),o=y.createMarkupForStyles(o,this));var i=null;null!=this._tag&&f(this._tag,t)?Y.hasOwnProperty(r)||(i=E.createMarkupForCustomAttribute(r,o)):i=E.createMarkupForProperty(r,o),i&&(n+=" "+i);}}}return e.renderToStaticMarkup?n:(this._hostParent||(n+=" "+E.createMarkupForRoot()),n+=" "+E.createMarkupForID(this._domID));},_createContentMarkup:function _createContentMarkup(e,t,n){var r="",o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&(r=o.__html);else{var a=H[_typeof(t.children)]?t.children:null,i=null!=a?null:t.children;if(null!=a)r=L(a);else if(null!=i){var s=this.mountChildren(i,e,n);r=s.join("");}}return Q[this._tag]&&"\n"===r.charAt(0)?"\n"+r:r;},_createInitialChildren:function _createInitialChildren(e,t,n,r){var o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&b.queueHTML(r,o.__html);else{var a=H[_typeof(t.children)]?t.children:null,i=null!=a?null:t.children;if(null!=a)b.queueText(r,a);else if(null!=i)for(var s=this.mountChildren(i,e,n),u=0;u<s.length;u++){b.queueChild(r,s[u]);}}},receiveComponent:function receiveComponent(e,t,n){var r=this._currentElement;this._currentElement=e,this.updateComponent(t,r,e,n);},updateComponent:function updateComponent(e,t,n,r){var a=t.props,i=this._currentElement.props;switch(this._tag){case"button":a=P.getHostProps(this,a),i=P.getHostProps(this,i);break;case"input":a=S.getHostProps(this,a),i=S.getHostProps(this,i);break;case"option":a=R.getHostProps(this,a),i=R.getHostProps(this,i);break;case"select":a=O.getHostProps(this,a),i=O.getHostProps(this,i);break;case"textarea":a=I.getHostProps(this,a),i=I.getHostProps(this,i);}switch(o(this,i),this._updateDOMProperties(a,i,e),this._updateDOMChildren(a,i,e,r),this._tag){case"input":S.updateWrapper(this);break;case"textarea":I.updateWrapper(this);break;case"select":e.getReactMountReady().enqueue(p,this);}},_updateDOMProperties:function _updateDOMProperties(e,t,n){var r,o,i;for(r in e){if(!t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&null!=e[r])if(r===q){var s=this._previousStyleCopy;for(o in s){s.hasOwnProperty(o)&&(i=i||{},i[o]="");}this._previousStyleCopy=null;}else W.hasOwnProperty(r)?e[r]&&V(this,r):f(this._tag,e)?Y.hasOwnProperty(r)||E.deleteValueForAttribute(j(this),r):(_.properties[r]||_.isCustomAttribute(r))&&E.deleteValueForProperty(j(this),r);}for(r in t){var u=t[r],l=r===q?this._previousStyleCopy:null!=e?e[r]:void 0;if(t.hasOwnProperty(r)&&u!==l&&(null!=u||null!=l))if(r===q){if(u?u=this._previousStyleCopy=v({},u):this._previousStyleCopy=null,l){for(o in l){!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(i=i||{},i[o]="");}for(o in u){u.hasOwnProperty(o)&&l[o]!==u[o]&&(i=i||{},i[o]=u[o]);}}else i=u;}else if(W.hasOwnProperty(r))u?a(this,r,u,n):l&&V(this,r);else if(f(this._tag,t))Y.hasOwnProperty(r)||E.setValueForAttribute(j(this),r,u);else if(_.properties[r]||_.isCustomAttribute(r)){var c=j(this);null!=u?E.setValueForProperty(c,r,u):E.deleteValueForProperty(c,r);}}i&&y.setValueForStyles(j(this),i,this);},_updateDOMChildren:function _updateDOMChildren(e,t,n,r){var o=H[_typeof(e.children)]?e.children:null,a=H[_typeof(t.children)]?t.children:null,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,s=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,u=null!=o?null:e.children,l=null!=a?null:t.children,c=null!=o||null!=i,p=null!=a||null!=s;null!=u&&null==l?this.updateChildren(null,n,r):c&&!p&&this.updateTextContent(""),null!=a?o!==a&&this.updateTextContent(""+a):null!=s?i!==s&&this.updateMarkup(""+s):null!=l&&this.updateChildren(l,n,r);},getHostNode:function getHostNode(){return j(this);},unmountComponent:function unmountComponent(e){switch(this._tag){case"audio":case"form":case"iframe":case"img":case"link":case"object":case"source":case"video":var t=this._wrapperState.listeners;if(t)for(var n=0;n<t.length;n++){t[n].remove();}break;case"html":case"head":case"body":m("66",this._tag);}this.unmountChildren(e),M.uncacheNode(this),T.deleteAllListeners(this),this._rootNodeID=0,this._domID=0,this._wrapperState=null;},getPublicInstance:function getPublicInstance(){return j(this);}},v(h.prototype,h.Mixin,D.Mixin),t.exports=h;},{1:1,10:10,11:11,114:114,128:128,132:132,138:138,146:146,154:154,158:158,16:16,160:160,161:161,162:162,17:17,18:18,27:27,37:37,39:39,4:4,40:40,46:46,47:47,48:48,52:52,66:66,69:69,8:8,84:84,9:9}],39:[function(e,t,n){"use strict";var r={hasCachedChildNodes:1};t.exports=r;},{}],40:[function(e,t,n){"use strict";function r(e){for(var t;t=e._renderedComponent;){e=t;}return e;}function o(e,t){var n=r(e);n._hostNode=t,t[m]=n;}function a(e){var t=e._hostNode;t&&(delete t[m],e._hostNode=null);}function i(e,t){if(!(e._flags&h.hasCachedChildNodes)){var n=e._renderedChildren,a=t.firstChild;e:for(var i in n){if(n.hasOwnProperty(i)){var s=n[i],u=r(s)._domID;if(0!==u){for(;null!==a;a=a.nextSibling){if(1===a.nodeType&&a.getAttribute(f)===String(u)||8===a.nodeType&&a.nodeValue===" react-text: "+u+" "||8===a.nodeType&&a.nodeValue===" react-empty: "+u+" "){o(s,a);continue e;}}c("32",u);}}}e._flags|=h.hasCachedChildNodes;}}function s(e){if(e[m])return e[m];for(var t=[];!e[m];){if(t.push(e),!e.parentNode)return null;e=e.parentNode;}for(var n,r;e&&(r=e[m]);e=t.pop()){n=r,t.length&&i(r,e);}return n;}function u(e){var t=s(e);return null!=t&&t._hostNode===e?t:null;}function l(e){if(void 0===e._hostNode?c("33"):void 0,e._hostNode)return e._hostNode;for(var t=[];!e._hostNode;){t.push(e),e._hostParent?void 0:c("34"),e=e._hostParent;}for(;t.length;e=t.pop()){i(e,e._hostNode);}return e._hostNode;}var c=e(132),p=e(10),d=e(39),f=(e(154),p.ID_ATTRIBUTE_NAME),h=d,m="__reactInternalInstance$"+Math.random().toString(36).slice(2),v={getClosestInstanceFromNode:s,getInstanceFromNode:u,getNodeFromInstance:l,precacheChildNodes:i,precacheNode:o,uncacheNode:a};t.exports=v;},{10:10,132:132,154:154,39:39}],41:[function(e,t,n){"use strict";function r(e,t){var n={_topLevelWrapper:e,_idCounter:1,_ownerDocument:t?t.nodeType===o?t:t.ownerDocument:null,_node:t,_tag:t?t.nodeName.toLowerCase():null,_namespaceURI:t?t.namespaceURI:null};return n;}var o=(e(138),9);t.exports=r;},{138:138}],42:[function(e,t,n){"use strict";var r=e(162),o=e(8),a=e(40),i=function i(e){this._currentElement=null,this._hostNode=null,this._hostParent=null,this._hostContainerInfo=null,this._domID=0;};r(i.prototype,{mountComponent:function mountComponent(e,t,n,r){var i=n._idCounter++;this._domID=i,this._hostParent=t,this._hostContainerInfo=n;var s=" react-empty: "+this._domID+" ";if(e.useCreateElement){var u=n._ownerDocument,l=u.createComment(s);return a.precacheNode(this,l),o(l);}return e.renderToStaticMarkup?"":"<!--"+s+"-->";},receiveComponent:function receiveComponent(){},getHostNode:function getHostNode(){return a.getNodeFromInstance(this);},unmountComponent:function unmountComponent(){a.uncacheNode(this);}}),t.exports=i;},{162:162,40:40,8:8}],43:[function(e,t,n){"use strict";var r=e(56),o=r.createFactory,a={a:o("a"),abbr:o("abbr"),address:o("address"),area:o("area"),article:o("article"),aside:o("aside"),audio:o("audio"),b:o("b"),base:o("base"),bdi:o("bdi"),bdo:o("bdo"),big:o("big"),blockquote:o("blockquote"),body:o("body"),br:o("br"),button:o("button"),canvas:o("canvas"),caption:o("caption"),cite:o("cite"),code:o("code"),col:o("col"),colgroup:o("colgroup"),data:o("data"),datalist:o("datalist"),dd:o("dd"),del:o("del"),details:o("details"),dfn:o("dfn"),dialog:o("dialog"),div:o("div"),dl:o("dl"),dt:o("dt"),em:o("em"),embed:o("embed"),fieldset:o("fieldset"),figcaption:o("figcaption"),figure:o("figure"),footer:o("footer"),form:o("form"),h1:o("h1"),h2:o("h2"),h3:o("h3"),h4:o("h4"),h5:o("h5"),h6:o("h6"),head:o("head"),header:o("header"),hgroup:o("hgroup"),hr:o("hr"),html:o("html"),i:o("i"),iframe:o("iframe"),img:o("img"),input:o("input"),ins:o("ins"),kbd:o("kbd"),keygen:o("keygen"),label:o("label"),legend:o("legend"),li:o("li"),link:o("link"),main:o("main"),map:o("map"),mark:o("mark"),menu:o("menu"),menuitem:o("menuitem"),meta:o("meta"),meter:o("meter"),nav:o("nav"),noscript:o("noscript"),object:o("object"),ol:o("ol"),optgroup:o("optgroup"),option:o("option"),output:o("output"),p:o("p"),param:o("param"),picture:o("picture"),pre:o("pre"),progress:o("progress"),q:o("q"),rp:o("rp"),rt:o("rt"),ruby:o("ruby"),s:o("s"),samp:o("samp"),script:o("script"),section:o("section"),select:o("select"),small:o("small"),source:o("source"),span:o("span"),strong:o("strong"),style:o("style"),sub:o("sub"),summary:o("summary"),sup:o("sup"),table:o("table"),tbody:o("tbody"),td:o("td"),textarea:o("textarea"),tfoot:o("tfoot"),th:o("th"),thead:o("thead"),time:o("time"),title:o("title"),tr:o("tr"),track:o("track"),u:o("u"),ul:o("ul"),var:o("var"),video:o("video"),wbr:o("wbr"),circle:o("circle"),clipPath:o("clipPath"),defs:o("defs"),ellipse:o("ellipse"),g:o("g"),image:o("image"),line:o("line"),linearGradient:o("linearGradient"),mask:o("mask"),path:o("path"),pattern:o("pattern"),polygon:o("polygon"),polyline:o("polyline"),radialGradient:o("radialGradient"),rect:o("rect"),stop:o("stop"),svg:o("svg"),text:o("text"),tspan:o("tspan")};t.exports=a;},{56:56}],44:[function(e,t,n){"use strict";var r={useCreateElement:!0};t.exports=r;},{}],45:[function(e,t,n){"use strict";var r=e(7),o=e(40),a={dangerouslyProcessChildrenUpdates:function dangerouslyProcessChildrenUpdates(e,t){var n=o.getNodeFromInstance(e);r.processUpdates(n,t);}};t.exports=a;},{40:40,7:7}],46:[function(e,t,n){"use strict";function r(){this._rootNodeID&&d.updateWrapper(this);}function o(e){var t=this._currentElement.props,n=l.executeOnChange(t,e);p.asap(r,this);var o=t.name;if("radio"===t.type&&null!=o){for(var i=c.getNodeFromInstance(this),s=i;s.parentNode;){s=s.parentNode;}for(var u=s.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),d=0;d<u.length;d++){var f=u[d];if(f!==i&&f.form===i.form){var h=c.getInstanceFromNode(f);h?void 0:a("90"),p.asap(r,h);}}}return n;}var a=e(132),i=e(162),s=e(14),u=e(11),l=e(24),c=e(40),p=e(88),d=(e(154),e(161),{getHostProps:function getHostProps(e,t){var n=l.getValue(t),r=l.getChecked(t),o=i({type:void 0,step:void 0,min:void 0,max:void 0},s.getHostProps(e,t),{defaultChecked:void 0,defaultValue:void 0,value:null!=n?n:e._wrapperState.initialValue,checked:null!=r?r:e._wrapperState.initialChecked,onChange:e._wrapperState.onChange});return o;},mountWrapper:function mountWrapper(e,t){var n=t.defaultValue;e._wrapperState={initialChecked:null!=t.checked?t.checked:t.defaultChecked,initialValue:null!=t.value?t.value:n,listeners:null,onChange:o.bind(e)};},updateWrapper:function updateWrapper(e){var t=e._currentElement.props,n=t.checked;null!=n&&u.setValueForProperty(c.getNodeFromInstance(e),"checked",n||!1);var r=c.getNodeFromInstance(e),o=l.getValue(t);if(null!=o){var a=""+o;a!==r.value&&(r.value=a);}else null==t.value&&null!=t.defaultValue&&(r.defaultValue=""+t.defaultValue),null==t.checked&&null!=t.defaultChecked&&(r.defaultChecked=!!t.defaultChecked);},postMountWrapper:function postMountWrapper(e){var t=e._currentElement.props,n=c.getNodeFromInstance(e);switch(t.type){case"submit":case"reset":break;case"color":case"date":case"datetime":case"datetime-local":case"month":case"time":case"week":n.value="",n.value=n.defaultValue;break;default:n.value=n.value;}var r=n.name;""!==r&&(n.name=""),n.defaultChecked=!n.defaultChecked,n.defaultChecked=!n.defaultChecked,""!==r&&(n.name=r);}});t.exports=d;},{11:11,132:132,14:14,154:154,161:161,162:162,24:24,40:40,88:88}],47:[function(e,t,n){"use strict";function r(e){var t="";return a.forEach(e,function(e){null!=e&&("string"==typeof e||"number"==typeof e?t+=e:u||(u=!0));}),t;}var o=e(162),a=e(29),i=e(40),s=e(48),u=(e(161),!1),l={mountWrapper:function mountWrapper(e,t,n){var o=null;if(null!=n){var a=n;"optgroup"===a._tag&&(a=a._hostParent),null!=a&&"select"===a._tag&&(o=s.getSelectValueContext(a));}var i=null;if(null!=o){var u;if(u=null!=t.value?t.value+"":r(t.children),i=!1,Array.isArray(o)){for(var l=0;l<o.length;l++){if(""+o[l]===u){i=!0;break;}}}else i=""+o===u;}e._wrapperState={selected:i};},postMountWrapper:function postMountWrapper(e){var t=e._currentElement.props;if(null!=t.value){var n=i.getNodeFromInstance(e);n.setAttribute("value",t.value);}},getHostProps:function getHostProps(e,t){var n=o({selected:void 0,children:void 0},t);null!=e._wrapperState.selected&&(n.selected=e._wrapperState.selected);var a=r(t.children);return a&&(n.children=a),n;}};t.exports=l;},{161:161,162:162,29:29,40:40,48:48}],48:[function(e,t,n){"use strict";function r(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var e=this._currentElement.props,t=u.getValue(e);null!=t&&o(this,Boolean(e.multiple),t);}}function o(e,t,n){var r,o,a=l.getNodeFromInstance(e).options;if(t){for(r={},o=0;o<n.length;o++){r[""+n[o]]=!0;}for(o=0;o<a.length;o++){var i=r.hasOwnProperty(a[o].value);a[o].selected!==i&&(a[o].selected=i);}}else{for(r=""+n,o=0;o<a.length;o++){if(a[o].value===r)return void(a[o].selected=!0);}a.length&&(a[0].selected=!0);}}function a(e){var t=this._currentElement.props,n=u.executeOnChange(t,e);return this._rootNodeID&&(this._wrapperState.pendingUpdate=!0),c.asap(r,this),n;}var i=e(162),s=e(14),u=e(24),l=e(40),c=e(88),p=(e(161),!1),d={getHostProps:function getHostProps(e,t){return i({},s.getHostProps(e,t),{onChange:e._wrapperState.onChange,value:void 0});},mountWrapper:function mountWrapper(e,t){var n=u.getValue(t);e._wrapperState={pendingUpdate:!1,initialValue:null!=n?n:t.defaultValue,listeners:null,onChange:a.bind(e),wasMultiple:Boolean(t.multiple)},void 0===t.value||void 0===t.defaultValue||p||(p=!0);},getSelectValueContext:function getSelectValueContext(e){return e._wrapperState.initialValue;},postUpdateWrapper:function postUpdateWrapper(e){var t=e._currentElement.props;e._wrapperState.initialValue=void 0;var n=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=Boolean(t.multiple);var r=u.getValue(t);null!=r?(e._wrapperState.pendingUpdate=!1,o(e,Boolean(t.multiple),r)):n!==Boolean(t.multiple)&&(null!=t.defaultValue?o(e,Boolean(t.multiple),t.defaultValue):o(e,Boolean(t.multiple),t.multiple?[]:""));}};t.exports=d;},{14:14,161:161,162:162,24:24,40:40,88:88}],49:[function(e,t,n){"use strict";function r(e,t,n,r){return e===n&&t===r;}function o(e){var t=document.selection,n=t.createRange(),r=n.text.length,o=n.duplicate();o.moveToElementText(e),o.setEndPoint("EndToStart",n);var a=o.text.length,i=a+r;return{start:a,end:i};}function a(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,a=t.focusNode,i=t.focusOffset,s=t.getRangeAt(0);try{s.startContainer.nodeType,s.endContainer.nodeType;}catch(e){return null;}var u=r(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),l=u?0:s.toString().length,c=s.cloneRange();c.selectNodeContents(e),c.setEnd(s.startContainer,s.startOffset);var p=r(c.startContainer,c.startOffset,c.endContainer,c.endOffset),d=p?0:c.toString().length,f=d+l,h=document.createRange();h.setStart(n,o),h.setEnd(a,i);var m=h.collapsed;return{start:m?f:d,end:m?d:f};}function i(e,t){var n,r,o=document.selection.createRange().duplicate();void 0===t.end?(n=t.start,r=n):t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),o.moveToElementText(e),o.moveStart("character",n),o.setEndPoint("EndToStart",o),o.moveEnd("character",r-n),o.select();}function s(e,t){if(window.getSelection){var n=window.getSelection(),r=e[c()].length,o=Math.min(t.start,r),a=void 0===t.end?o:Math.min(t.end,r);if(!n.extend&&o>a){var i=a;a=o,o=i;}var s=l(e,o),u=l(e,a);if(s&&u){var p=document.createRange();p.setStart(s.node,s.offset),n.removeAllRanges(),o>a?(n.addRange(p),n.extend(u.node,u.offset)):(p.setEnd(u.node,u.offset),n.addRange(p));}}}var u=e(140),l=e(124),c=e(125),p=u.canUseDOM&&"selection"in document&&!("getSelection"in window),d={getOffsets:p?o:a,setOffsets:p?i:s};t.exports=d;},{124:124,125:125,140:140}],50:[function(e,t,n){"use strict";var r=e(55),o=e(83),a=e(89);r.inject();var i={renderToString:o.renderToString,renderToStaticMarkup:o.renderToStaticMarkup,version:a};t.exports=i;},{55:55,83:83,89:89}],51:[function(e,t,n){"use strict";var r=e(132),o=e(162),a=e(7),i=e(8),s=e(40),u=e(114),l=(e(154),e(138),function(e){this._currentElement=e,this._stringText=""+e,this._hostNode=null,this._hostParent=null,this._domID=0,this._mountIndex=0,this._closingComment=null,this._commentNodes=null;});o(l.prototype,{mountComponent:function mountComponent(e,t,n,r){var o=n._idCounter++,a=" react-text: "+o+" ",l=" /react-text ";if(this._domID=o,this._hostParent=t,e.useCreateElement){var c=n._ownerDocument,p=c.createComment(a),d=c.createComment(l),f=i(c.createDocumentFragment());return i.queueChild(f,i(p)),this._stringText&&i.queueChild(f,i(c.createTextNode(this._stringText))),i.queueChild(f,i(d)),s.precacheNode(this,p),this._closingComment=d,f;}var h=u(this._stringText);return e.renderToStaticMarkup?h:"<!--"+a+"-->"+h+"<!--"+l+"-->";},receiveComponent:function receiveComponent(e,t){if(e!==this._currentElement){this._currentElement=e;var n=""+e;if(n!==this._stringText){this._stringText=n;var r=this.getHostNode();a.replaceDelimitedText(r[0],r[1],n);}}},getHostNode:function getHostNode(){var e=this._commentNodes;if(e)return e;if(!this._closingComment)for(var t=s.getNodeFromInstance(this),n=t.nextSibling;;){if(null==n?r("67",this._domID):void 0,8===n.nodeType&&" /react-text "===n.nodeValue){this._closingComment=n;break;}n=n.nextSibling;}return e=[this._hostNode,this._closingComment],this._commentNodes=e,e;},unmountComponent:function unmountComponent(){this._closingComment=null,this._commentNodes=null,s.uncacheNode(this);}}),t.exports=l;},{114:114,132:132,138:138,154:154,162:162,40:40,7:7,8:8}],52:[function(e,t,n){"use strict";function r(){this._rootNodeID&&p.updateWrapper(this);}function o(e){var t=this._currentElement.props,n=u.executeOnChange(t,e);return c.asap(r,this),n;}var a=e(132),i=e(162),s=e(14),u=e(24),l=e(40),c=e(88),p=(e(154),e(161),{getHostProps:function getHostProps(e,t){null!=t.dangerouslySetInnerHTML?a("91"):void 0;var n=i({},s.getHostProps(e,t),{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue,onChange:e._wrapperState.onChange});return n;},mountWrapper:function mountWrapper(e,t){var n=u.getValue(t),r=n;if(null==n){var i=t.defaultValue,s=t.children;null!=s&&(null!=i?a("92"):void 0,Array.isArray(s)&&(s.length<=1?void 0:a("93"),s=s[0]),i=""+s),null==i&&(i=""),r=i;}e._wrapperState={initialValue:""+r,listeners:null,onChange:o.bind(e)};},updateWrapper:function updateWrapper(e){var t=e._currentElement.props,n=l.getNodeFromInstance(e),r=u.getValue(t);if(null!=r){var o=""+r;o!==n.value&&(n.value=o),null==t.defaultValue&&(n.defaultValue=o);}null!=t.defaultValue&&(n.defaultValue=t.defaultValue);},postMountWrapper:function postMountWrapper(e){var t=l.getNodeFromInstance(e);t.value=t.textContent;}});t.exports=p;},{132:132,14:14,154:154,161:161,162:162,24:24,40:40,88:88}],53:[function(e,t,n){"use strict";function r(e,t){"_hostNode"in e?void 0:u("33"),"_hostNode"in t?void 0:u("33");for(var n=0,r=e;r;r=r._hostParent){n++;}for(var o=0,a=t;a;a=a._hostParent){o++;}for(;n-o>0;){e=e._hostParent,n--;}for(;o-n>0;){t=t._hostParent,o--;}for(var i=n;i--;){if(e===t)return e;e=e._hostParent,t=t._hostParent;}return null;}function o(e,t){"_hostNode"in e?void 0:u("35"),"_hostNode"in t?void 0:u("35");for(;t;){if(t===e)return!0;t=t._hostParent;}return!1;}function a(e){return"_hostNode"in e?void 0:u("36"),e._hostParent;}function i(e,t,n){for(var r=[];e;){r.push(e),e=e._hostParent;}var o;for(o=r.length;o-->0;){t(r[o],!1,n);}for(o=0;o<r.length;o++){t(r[o],!0,n);}}function s(e,t,n,o,a){for(var i=e&&t?r(e,t):null,s=[];e&&e!==i;){s.push(e),e=e._hostParent;}for(var u=[];t&&t!==i;){u.push(t),t=t._hostParent;}var l;for(l=0;l<s.length;l++){n(s[l],!0,o);}for(l=u.length;l-->0;){n(u[l],!1,a);}}var u=e(132);e(154);t.exports={isAncestor:o,getLowestCommonAncestor:r,getParentInstance:a,traverseTwoPhase:i,traverseEnterLeave:s};},{132:132,154:154}],54:[function(e,t,n){"use strict";function r(){this.reinitializeTransaction();}var o=e(162),a=e(88),i=e(106),s=e(146),u={initialize:s,close:function close(){d.isBatchingUpdates=!1;}},l={initialize:s,close:a.flushBatchedUpdates.bind(a)},c=[l,u];o(r.prototype,i.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return c;}});var p=new r(),d={isBatchingUpdates:!1,batchedUpdates:function batchedUpdates(e,t,n,r,o,a){var i=d.isBatchingUpdates;d.isBatchingUpdates=!0,i?e(t,n,r,o,a):p.perform(e,null,t,n,r,o,a);}};t.exports=d;},{106:106,146:146,162:162,88:88}],55:[function(e,t,n){"use strict";function r(){E||(E=!0,g.EventEmitter.injectReactEventListener(v),g.EventPluginHub.injectEventPluginOrder(i),g.EventPluginUtils.injectComponentTree(p),g.EventPluginUtils.injectTreeTraversal(f),g.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:_,EnterLeaveEventPlugin:s,ChangeEventPlugin:a,SelectEventPlugin:C,BeforeInputEventPlugin:o}),g.HostComponent.injectGenericComponentClass(c),g.HostComponent.injectTextComponentClass(h),g.DOMProperty.injectDOMPropertyConfig(u),g.DOMProperty.injectDOMPropertyConfig(b),g.EmptyComponent.injectEmptyComponentFactory(function(e){return new d(e);}),g.Updates.injectReconcileTransaction(y),g.Updates.injectBatchingStrategy(m),g.Component.injectEnvironment(l));}var o=e(2),a=e(6),i=e(13),s=e(15),u=e(22),l=e(32),c=e(38),p=e(40),d=e(42),f=e(53),h=e(51),m=e(54),v=e(60),g=e(63),y=e(79),b=e(90),C=e(91),_=e(92),E=!1;t.exports={inject:r};},{13:13,15:15,2:2,22:22,32:32,38:38,40:40,42:42,51:51,53:53,54:54,6:6,60:60,63:63,79:79,90:90,91:91,92:92}],56:[function(e,t,n){"use strict";function r(e){return void 0!==e.ref;}function o(e){return void 0!==e.key;}var a=e(162),i=e(35),s=(e(161),e(110),Object.prototype.hasOwnProperty),u="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,l={key:!0,ref:!0,__self:!0,__source:!0},c=function c(e,t,n,r,o,a,i){var s={$$typeof:u,type:e,key:t,ref:n,props:i,_owner:a};return s;};c.createElement=function(e,t,n){var a,u={},p=null,d=null,f=null,h=null;if(null!=t){r(t)&&(d=t.ref),o(t)&&(p=""+t.key),f=void 0===t.__self?null:t.__self,h=void 0===t.__source?null:t.__source;for(a in t){s.call(t,a)&&!l.hasOwnProperty(a)&&(u[a]=t[a]);}}var m=arguments.length-2;if(1===m)u.children=n;else if(m>1){for(var v=Array(m),g=0;g<m;g++){v[g]=arguments[g+2];}u.children=v;}if(e&&e.defaultProps){var y=e.defaultProps;for(a in y){void 0===u[a]&&(u[a]=y[a]);}}return c(e,p,d,f,h,i.current,u);},c.createFactory=function(e){var t=c.createElement.bind(null,e);return t.type=e,t;},c.cloneAndReplaceKey=function(e,t){var n=c(e.type,t,e.ref,e._self,e._source,e._owner,e.props);return n;},c.cloneElement=function(e,t,n){var u,p=a({},e.props),d=e.key,f=e.ref,h=e._self,m=e._source,v=e._owner;if(null!=t){r(t)&&(f=t.ref,v=i.current),o(t)&&(d=""+t.key);var g;e.type&&e.type.defaultProps&&(g=e.type.defaultProps);for(u in t){s.call(t,u)&&!l.hasOwnProperty(u)&&(void 0===t[u]&&void 0!==g?p[u]=g[u]:p[u]=t[u]);}}var y=arguments.length-2;if(1===y)p.children=n;else if(y>1){for(var b=Array(y),C=0;C<y;C++){b[C]=arguments[C+2];}p.children=b;}return c(e.type,d,f,h,m,v,p);},c.isValidElement=function(e){return"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&null!==e&&e.$$typeof===u;},c.REACT_ELEMENT_TYPE=u,t.exports=c;},{110:110,161:161,162:162,35:35}],57:[function(e,t,n){"use strict";var r,o={injectEmptyComponentFactory:function injectEmptyComponentFactory(e){r=e;}},a={create:function create(e){return r(e);}};a.injection=o,t.exports=a;},{}],58:[function(e,t,n){"use strict";function r(e,t,n,r){try{return t(n,r);}catch(e){return void(null===o&&(o=e));}}var o=null,a={invokeGuardedCallback:r,invokeGuardedCallbackWithCatch:r,rethrowCaughtError:function rethrowCaughtError(){if(o){var e=o;throw o=null,e;}}};t.exports=a;},{}],59:[function(e,t,n){"use strict";function r(e){o.enqueueEvents(e),o.processEventQueue(!1);}var o=e(17),a={handleTopLevel:function handleTopLevel(e,t,n,a){var i=o.extractEvents(e,t,n,a);r(i);}};t.exports=a;},{17:17}],60:[function(e,t,n){"use strict";function r(e){for(;e._hostParent;){e=e._hostParent;}var t=p.getNodeFromInstance(e),n=t.parentNode;return p.getClosestInstanceFromNode(n);}function o(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[];}function a(e){var t=f(e.nativeEvent),n=p.getClosestInstanceFromNode(t),o=n;do{e.ancestors.push(o),o=o&&r(o);}while(o);for(var a=0;a<e.ancestors.length;a++){n=e.ancestors[a],m._handleTopLevel(e.topLevelType,n,e.nativeEvent,f(e.nativeEvent));}}function i(e){var t=h(window);e(t);}var s=e(162),u=e(139),l=e(140),c=e(25),p=e(40),d=e(88),f=e(121),h=e(151);s(o.prototype,{destructor:function destructor(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0;}}),c.addPoolingTo(o,c.twoArgumentPooler);var m={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:l.canUseDOM?window:null,setHandleTopLevel:function setHandleTopLevel(e){m._handleTopLevel=e;},setEnabled:function setEnabled(e){m._enabled=!!e;},isEnabled:function isEnabled(){return m._enabled;},trapBubbledEvent:function trapBubbledEvent(e,t,n){var r=n;return r?u.listen(r,t,m.dispatchEvent.bind(null,e)):null;},trapCapturedEvent:function trapCapturedEvent(e,t,n){var r=n;return r?u.capture(r,t,m.dispatchEvent.bind(null,e)):null;},monitorScrollValue:function monitorScrollValue(e){var t=i.bind(null,e);u.listen(window,"scroll",t);},dispatchEvent:function dispatchEvent(e,t){if(m._enabled){var n=o.getPooled(e,t);try{d.batchedUpdates(a,n);}finally{o.release(n);}}}};t.exports=m;},{121:121,139:139,140:140,151:151,162:162,25:25,40:40,88:88}],61:[function(e,t,n){"use strict";var r={logTopLevelRenders:!1};t.exports=r;},{}],62:[function(e,t,n){"use strict";function r(e){return u?void 0:i("111",e.type),new u(e);}function o(e){return new c(e);}function a(e){return e instanceof c;}var i=e(132),s=e(162),u=(e(154),null),l={},c=null,p={injectGenericComponentClass:function injectGenericComponentClass(e){u=e;},injectTextComponentClass:function injectTextComponentClass(e){c=e;},injectComponentClasses:function injectComponentClasses(e){s(l,e);}},d={createInternalComponent:r,createInstanceForText:o,isTextComponent:a,injection:p};t.exports=d;},{132:132,154:154,162:162}],63:[function(e,t,n){"use strict";var r=e(10),o=e(17),a=e(19),i=e(33),s=e(30),u=e(57),l=e(27),c=e(62),p=e(88),d={Component:i.injection,Class:s.injection,DOMProperty:r.injection,EmptyComponent:u.injection,EventPluginHub:o.injection,EventPluginUtils:a.injection,EventEmitter:l.injection,HostComponent:c.injection,Updates:p.injection};t.exports=d;},{10:10,17:17,19:19,27:27,30:30,33:33,57:57,62:62,88:88}],64:[function(e,t,n){"use strict";function r(e){return a(document.documentElement,e);}var o=e(49),a=e(143),i=e(148),s=e(149),u={hasSelectionCapabilities:function hasSelectionCapabilities(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable);},getSelectionInformation:function getSelectionInformation(){var e=s();return{focusedElem:e,selectionRange:u.hasSelectionCapabilities(e)?u.getSelection(e):null};},restoreSelection:function restoreSelection(e){var t=s(),n=e.focusedElem,o=e.selectionRange;t!==n&&r(n)&&(u.hasSelectionCapabilities(n)&&u.setSelection(n,o),i(n));},getSelection:function getSelection(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)});}else t=o.getOffsets(e);return t||{start:0,end:0};},setSelection:function setSelection(e,t){var n=t.start,r=t.end;if(void 0===r&&(r=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length);else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var a=e.createTextRange();a.collapse(!0),a.moveStart("character",n),a.moveEnd("character",r-n),a.select();}else o.setOffsets(e,t);}};t.exports=u;},{143:143,148:148,149:149,49:49}],65:[function(e,t,n){"use strict";var r={remove:function remove(e){e._reactInternalInstance=void 0;},get:function get(e){return e._reactInternalInstance;},has:function has(e){return void 0!==e._reactInternalInstance;},set:function set(e,t){e._reactInternalInstance=t;}};t.exports=r;},{}],66:[function(e,t,n){"use strict";var r=null;t.exports={debugTool:r};},{}],67:[function(e,t,n){"use strict";var r=e(109),o=/\/?>/,a=/^<\!\-\-/,i={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function addChecksumToMarkup(e){var t=r(e);return a.test(e)?e:e.replace(o," "+i.CHECKSUM_ATTR_NAME+'="'+t+'"$&');},canReuseMarkup:function canReuseMarkup(e,t){var n=t.getAttribute(i.CHECKSUM_ATTR_NAME);n=n&&parseInt(n,10);var o=r(e);return o===n;}};t.exports=i;},{109:109}],68:[function(e,t,n){"use strict";function r(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){if(e.charAt(r)!==t.charAt(r))return r;}return e.length===t.length?-1:n;}function o(e){return e?e.nodeType===D?e.documentElement:e.firstChild:null;}function a(e){return e.getAttribute&&e.getAttribute(R)||"";}function i(e,t,n,r,o){var a;if(_.logTopLevelRenders){var i=e._currentElement.props,s=i.type;a="React mount: "+("string"==typeof s?s:s.displayName||s.name),console.time(a);}var u=T.mountComponent(e,n,null,y(e,t),o,0);a&&console.timeEnd(a),e._renderedComponent._topLevelWrapper=e,V._mountImageIntoNode(u,t,e,r,n);}function s(e,t,n,r){var o=w.ReactReconcileTransaction.getPooled(!n&&b.useCreateElement);o.perform(i,null,e,t,o,n,r),w.ReactReconcileTransaction.release(o);}function u(e,t,n){for(T.unmountComponent(e,n),t.nodeType===D&&(t=t.documentElement);t.lastChild;){t.removeChild(t.lastChild);}}function l(e){var t=o(e);if(t){var n=g.getInstanceFromNode(t);return!(!n||!n._hostParent);}}function c(e){return!(!e||e.nodeType!==I&&e.nodeType!==D&&e.nodeType!==A);}function p(e){var t=o(e),n=t&&g.getInstanceFromNode(t);return n&&!n._hostParent?n:null;}function d(e){var t=p(e);return t?t._hostContainerInfo._topLevelWrapper:null;}var f=e(132),h=e(8),m=e(10),v=e(27),g=(e(35),e(40)),y=e(41),b=e(44),C=e(56),_=e(61),E=e(65),x=(e(66),e(67)),T=e(80),N=e(87),w=e(88),P=e(147),k=e(127),M=(e(154),e(134)),S=e(136),R=(e(161),m.ID_ATTRIBUTE_NAME),O=m.ROOT_ATTRIBUTE_NAME,I=1,D=9,A=11,L={},U=1,F=function F(){this.rootID=U++;};F.prototype.isReactComponent={},F.prototype.render=function(){return this.props;};var V={TopLevelWrapper:F,_instancesByReactRootID:L,scrollMonitor:function scrollMonitor(e,t){t();},_updateRootComponent:function _updateRootComponent(e,t,n,r,o){return V.scrollMonitor(r,function(){N.enqueueElementInternal(e,t,n),o&&N.enqueueCallbackInternal(e,o);}),e;},_renderNewRootComponent:function _renderNewRootComponent(e,t,n,r){c(t)?void 0:f("37"),v.ensureScrollValueMonitoring();var o=k(e,!1);w.batchedUpdates(s,o,t,n,r);var a=o._instance.rootID;return L[a]=o,o;},renderSubtreeIntoContainer:function renderSubtreeIntoContainer(e,t,n,r){return null!=e&&E.has(e)?void 0:f("38"),V._renderSubtreeIntoContainer(e,t,n,r);},_renderSubtreeIntoContainer:function _renderSubtreeIntoContainer(e,t,n,r){N.validateCallback(r,"ReactDOM.render"),C.isValidElement(t)?void 0:f("39","string"==typeof t?" Instead of passing a string like 'div', pass React.createElement('div') or <div />.":"function"==typeof t?" Instead of passing a class like Foo, pass React.createElement(Foo) or <Foo />.":null!=t&&void 0!==t.props?" This may be caused by unintentionally loading two independent copies of React.":"");var i,s=C(F,null,null,null,null,null,t);if(e){var u=E.get(e);i=u._processChildContext(u._context);}else i=P;var c=d(n);if(c){var p=c._currentElement,h=p.props;if(S(h,t)){var m=c._renderedComponent.getPublicInstance(),v=r&&function(){r.call(m);};return V._updateRootComponent(c,s,i,n,v),m;}V.unmountComponentAtNode(n);}var g=o(n),y=g&&!!a(g),b=l(n),_=y&&!c&&!b,x=V._renderNewRootComponent(s,n,_,i)._renderedComponent.getPublicInstance();return r&&r.call(x),x;},render:function render(e,t,n){return V._renderSubtreeIntoContainer(null,e,t,n);},unmountComponentAtNode:function unmountComponentAtNode(e){c(e)?void 0:f("40");var t=d(e);return t?(delete L[t._instance.rootID],w.batchedUpdates(u,t,e,!1),!0):(l(e),1===e.nodeType&&e.hasAttribute(O),!1);},_mountImageIntoNode:function _mountImageIntoNode(e,t,n,a,i){if(c(t)?void 0:f("41"),a){var s=o(t);if(x.canReuseMarkup(e,s))return void g.precacheNode(n,s);var u=s.getAttribute(x.CHECKSUM_ATTR_NAME);s.removeAttribute(x.CHECKSUM_ATTR_NAME);var l=s.outerHTML;s.setAttribute(x.CHECKSUM_ATTR_NAME,u);var p=e,d=r(p,l),m=" (client) "+p.substring(d-20,d+20)+"\n (server) "+l.substring(d-20,d+20);t.nodeType===D?f("42",m):void 0;}if(t.nodeType===D?f("43"):void 0,i.useCreateElement){for(;t.lastChild;){t.removeChild(t.lastChild);}h.insertTreeBefore(t,e,null);}else M(t,e),g.precacheNode(n,t.firstChild);}};t.exports=V;},{10:10,127:127,132:132,134:134,136:136,147:147,154:154,161:161,27:27,35:35,40:40,41:41,44:44,56:56,61:61,65:65,66:66,67:67,8:8,80:80,87:87,88:88}],69:[function(e,t,n){"use strict";function r(e,t,n){return{type:d.INSERT_MARKUP,content:e,fromIndex:null,fromNode:null,toIndex:n,afterNode:t};}function o(e,t,n){return{type:d.MOVE_EXISTING,content:null,fromIndex:e._mountIndex,fromNode:f.getHostNode(e),toIndex:n,afterNode:t};}function a(e,t){return{type:d.REMOVE_NODE,content:null,fromIndex:e._mountIndex,fromNode:t,toIndex:null,afterNode:null};}function i(e){return{type:d.SET_MARKUP,content:e,fromIndex:null,fromNode:null,toIndex:null,afterNode:null};}function s(e){return{type:d.TEXT_CONTENT,content:e,fromIndex:null,fromNode:null,toIndex:null,afterNode:null};}function u(e,t){return t&&(e=e||[],e.push(t)),e;}function l(e,t){p.processChildrenUpdates(e,t);}var c=e(132),p=e(33),d=(e(65),e(66),e(70)),f=(e(35),e(80)),h=e(28),m=(e(146),e(116)),v=(e(154),{Mixin:{_reconcilerInstantiateChildren:function _reconcilerInstantiateChildren(e,t,n){return h.instantiateChildren(e,t,n);},_reconcilerUpdateChildren:function _reconcilerUpdateChildren(e,t,n,r,o,a){var i,s=0;return i=m(t,s),h.updateChildren(e,i,n,r,o,this,this._hostContainerInfo,a,s),i;},mountChildren:function mountChildren(e,t,n){var r=this._reconcilerInstantiateChildren(e,t,n);this._renderedChildren=r;var o=[],a=0;for(var i in r){if(r.hasOwnProperty(i)){var s=r[i],u=0,l=f.mountComponent(s,t,this,this._hostContainerInfo,n,u);s._mountIndex=a++,o.push(l);}}return o;},updateTextContent:function updateTextContent(e){var t=this._renderedChildren;h.unmountChildren(t,!1);for(var n in t){t.hasOwnProperty(n)&&c("118");}var r=[s(e)];l(this,r);},updateMarkup:function updateMarkup(e){var t=this._renderedChildren;h.unmountChildren(t,!1);for(var n in t){t.hasOwnProperty(n)&&c("118");}var r=[i(e)];l(this,r);},updateChildren:function updateChildren(e,t,n){this._updateChildren(e,t,n);},_updateChildren:function _updateChildren(e,t,n){var r=this._renderedChildren,o={},a=[],i=this._reconcilerUpdateChildren(r,e,a,o,t,n);if(i||r){var s,c=null,p=0,d=0,h=0,m=null;for(s in i){if(i.hasOwnProperty(s)){var v=r&&r[s],g=i[s];v===g?(c=u(c,this.moveChild(v,m,p,d)),d=Math.max(v._mountIndex,d),v._mountIndex=p):(v&&(d=Math.max(v._mountIndex,d)),c=u(c,this._mountChildAtIndex(g,a[h],m,p,t,n)),h++),p++,m=f.getHostNode(g);}}for(s in o){o.hasOwnProperty(s)&&(c=u(c,this._unmountChild(r[s],o[s])));}c&&l(this,c),this._renderedChildren=i;}},unmountChildren:function unmountChildren(e){var t=this._renderedChildren;h.unmountChildren(t,e),this._renderedChildren=null;},moveChild:function moveChild(e,t,n,r){if(e._mountIndex<r)return o(e,t,n);},createChild:function createChild(e,t,n){return r(n,t,e._mountIndex);},removeChild:function removeChild(e,t){return a(e,t);},_mountChildAtIndex:function _mountChildAtIndex(e,t,n,r,o,a){return e._mountIndex=r,this.createChild(e,n,t);},_unmountChild:function _unmountChild(e,t){var n=this.removeChild(e,t);return e._mountIndex=null,n;}}});t.exports=v;},{116:116,132:132,146:146,154:154,28:28,33:33,35:35,65:65,66:66,70:70,80:80}],70:[function(e,t,n){"use strict";var r=e(157),o=r({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});t.exports=o;},{157:157}],71:[function(e,t,n){"use strict";var r=e(132),o=e(56),a=(e(154),{HOST:0,COMPOSITE:1,EMPTY:2,getType:function getType(e){return null===e||e===!1?a.EMPTY:o.isValidElement(e)?"function"==typeof e.type?a.COMPOSITE:a.HOST:void r("26",e);}});t.exports=a;},{132:132,154:154,56:56}],72:[function(e,t,n){"use strict";function r(e,t){}var o=(e(161),{isMounted:function isMounted(e){return!1;},enqueueCallback:function enqueueCallback(e,t){},enqueueForceUpdate:function enqueueForceUpdate(e){r(e,"forceUpdate");},enqueueReplaceState:function enqueueReplaceState(e,t){r(e,"replaceState");},enqueueSetState:function enqueueSetState(e,t){r(e,"setState");}});t.exports=o;},{161:161}],73:[function(e,t,n){"use strict";var r=e(132),o=(e(154),{isValidOwner:function isValidOwner(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef);},addComponentAsRefTo:function addComponentAsRefTo(e,t,n){o.isValidOwner(n)?void 0:r("119"),n.attachRef(t,e);},removeComponentAsRefFrom:function removeComponentAsRefFrom(e,t,n){o.isValidOwner(n)?void 0:r("120");var a=n.getPublicInstance();a&&a.refs[t]===e.getPublicInstance()&&n.detachRef(t);}});t.exports=o;},{132:132,154:154}],74:[function(e,t,n){"use strict";var r={};t.exports=r;},{}],75:[function(e,t,n){"use strict";var r=e(157),o=r({prop:null,context:null,childContext:null});t.exports=o;},{157:157}],76:[function(e,t,n){"use strict";function r(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t;}function o(e){this.message=e,this.stack="";}function a(e){function t(t,n,r,a,i,s,u){if(a=a||w,s=s||r,null==n[r]){var l=E[i];return t?new o("Required "+l+" `"+s+"` was not specified in "+("`"+a+"`.")):null;}return e(n,r,a,i,s);}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n;}function i(e){function t(t,n,r,a,i,s){var u=t[n],l=y(u);if(l!==e){var c=E[a],p=b(u);return new o("Invalid "+c+" `"+i+"` of type "+("`"+p+"` supplied to `"+r+"`, expected ")+("`"+e+"`."));}return null;}return a(t);}function s(){return a(T.thatReturns(null));}function u(e){function t(t,n,r,a,i){if("function"!=typeof e)return new o("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var s=t[n];if(!Array.isArray(s)){var u=E[a],l=y(s);return new o("Invalid "+u+" `"+i+"` of type "+("`"+l+"` supplied to `"+r+"`, expected an array."));}for(var c=0;c<s.length;c++){var p=e(s,c,r,a,i+"["+c+"]",x);if(p instanceof Error)return p;}return null;}return a(t);}function l(){function e(e,t,n,r,a){var i=e[t];if(!_.isValidElement(i)){var s=E[r],u=y(i);return new o("Invalid "+s+" `"+a+"` of type "+("`"+u+"` supplied to `"+n+"`, expected a single ReactElement."));}return null;}return a(e);}function c(e){function t(t,n,r,a,i){if(!(t[n]instanceof e)){var s=E[a],u=e.name||w,l=C(t[n]);return new o("Invalid "+s+" `"+i+"` of type "+("`"+l+"` supplied to `"+r+"`, expected ")+("instance of `"+u+"`."));}return null;}return a(t);}function p(e){function t(t,n,a,i,s){for(var u=t[n],l=0;l<e.length;l++){if(r(u,e[l]))return null;}var c=E[i],p=JSON.stringify(e);return new o("Invalid "+c+" `"+s+"` of value `"+u+"` "+("supplied to `"+a+"`, expected one of "+p+"."));}return Array.isArray(e)?a(t):T.thatReturnsNull;}function d(e){function t(t,n,r,a,i){if("function"!=typeof e)return new o("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var s=t[n],u=y(s);if("object"!==u){var l=E[a];return new o("Invalid "+l+" `"+i+"` of type "+("`"+u+"` supplied to `"+r+"`, expected an object."));}for(var c in s){if(s.hasOwnProperty(c)){var p=e(s,c,r,a,i+"."+c,x);if(p instanceof Error)return p;}}return null;}return a(t);}function f(e){function t(t,n,r,a,i){for(var s=0;s<e.length;s++){var u=e[s];if(null==u(t,n,r,a,i,x))return null;}var l=E[a];return new o("Invalid "+l+" `"+i+"` supplied to "+("`"+r+"`."));}return Array.isArray(e)?a(t):T.thatReturnsNull;}function h(){function e(e,t,n,r,a){if(!v(e[t])){var i=E[r];return new o("Invalid "+i+" `"+a+"` supplied to "+("`"+n+"`, expected a ReactNode."));}return null;}return a(e);}function m(e){function t(t,n,r,a,i){var s=t[n],u=y(s);if("object"!==u){var l=E[a];return new o("Invalid "+l+" `"+i+"` of type `"+u+"` "+("supplied to `"+r+"`, expected `object`."));}for(var c in e){var p=e[c];if(p){var d=p(s,c,r,a,i+"."+c,x);if(d)return d;}}return null;}return a(t);}function v(e){switch(typeof e==="undefined"?"undefined":_typeof(e)){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(v);if(null===e||_.isValidElement(e))return!0;var t=N(e);if(!t)return!1;var n,r=t.call(e);if(t!==e.entries){for(;!(n=r.next()).done;){if(!v(n.value))return!1;}}else for(;!(n=r.next()).done;){var o=n.value;if(o&&!v(o[1]))return!1;}return!0;default:return!1;}}function g(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol;}function y(e){var t=typeof e==="undefined"?"undefined":_typeof(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":g(t,e)?"symbol":t;}function b(e){var t=y(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp";}return t;}function C(e){return e.constructor&&e.constructor.name?e.constructor.name:w;}var _=e(56),E=e(74),x=e(77),T=e(146),N=e(123),w=(e(161),"<<anonymous>>"),P={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),symbol:i("symbol"),any:s(),arrayOf:u,element:l(),instanceOf:c,node:h(),objectOf:d,oneOf:p,oneOfType:f,shape:m};o.prototype=Error.prototype,t.exports=P;},{123:123,146:146,161:161,56:56,74:74,77:77}],77:[function(e,t,n){"use strict";var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";t.exports=r;},{}],78:[function(e,t,n){"use strict";function r(e,t,n){this.props=e,this.context=t,this.refs=u,this.updater=n||s;}function o(){}var a=e(162),i=e(31),s=e(72),u=e(147);o.prototype=i.prototype,r.prototype=new o(),r.prototype.constructor=r,a(r.prototype,i.prototype),r.prototype.isPureReactComponent=!0,t.exports=r;},{147:147,162:162,31:31,72:72}],79:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=a.getPooled(null),this.useCreateElement=e;}var o=e(162),a=e(5),i=e(25),s=e(27),u=e(64),l=(e(66),e(106)),c=e(87),p={initialize:u.getSelectionInformation,close:u.restoreSelection},d={initialize:function initialize(){var e=s.isEnabled();return s.setEnabled(!1),e;},close:function close(e){s.setEnabled(e);}},f={initialize:function initialize(){this.reactMountReady.reset();},close:function close(){this.reactMountReady.notifyAll();}},h=[p,d,f],m={getTransactionWrappers:function getTransactionWrappers(){return h;},getReactMountReady:function getReactMountReady(){return this.reactMountReady;},getUpdateQueue:function getUpdateQueue(){return c;},checkpoint:function checkpoint(){return this.reactMountReady.checkpoint();},rollback:function rollback(e){this.reactMountReady.rollback(e);},destructor:function destructor(){a.release(this.reactMountReady),this.reactMountReady=null;}};o(r.prototype,l.Mixin,m),i.addPoolingTo(r),t.exports=r;},{106:106,162:162,25:25,27:27,5:5,64:64,66:66,87:87}],80:[function(e,t,n){"use strict";function r(){o.attachRefs(this,this._currentElement);}var o=e(81),a=(e(66),e(161),{mountComponent:function mountComponent(e,t,n,o,a,i){var s=e.mountComponent(t,n,o,a,i);return e._currentElement&&null!=e._currentElement.ref&&t.getReactMountReady().enqueue(r,e),s;},getHostNode:function getHostNode(e){return e.getHostNode();},unmountComponent:function unmountComponent(e,t){o.detachRefs(e,e._currentElement),e.unmountComponent(t);},receiveComponent:function receiveComponent(e,t,n,a){var i=e._currentElement;if(t!==i||a!==e._context){var s=o.shouldUpdateRefs(i,t);s&&o.detachRefs(e,i),e.receiveComponent(t,n,a),s&&e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(r,e);}},performUpdateIfNecessary:function performUpdateIfNecessary(e,t,n){e._updateBatchNumber===n&&e.performUpdateIfNecessary(t);}});t.exports=a;},{161:161,66:66,81:81}],81:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e?e(t.getPublicInstance()):a.addComponentAsRefTo(t,e,n);}function o(e,t,n){"function"==typeof e?e(null):a.removeComponentAsRefFrom(t,e,n);}var a=e(73),i={};i.attachRefs=function(e,t){if(null!==t&&t!==!1){var n=t.ref;null!=n&&r(n,e,t._owner);}},i.shouldUpdateRefs=function(e,t){var n=null===e||e===!1,r=null===t||t===!1;return n||r||t.ref!==e.ref||"string"==typeof t.ref&&t._owner!==e._owner;},i.detachRefs=function(e,t){if(null!==t&&t!==!1){var n=t.ref;null!=n&&o(n,e,t._owner);}},t.exports=i;},{73:73}],82:[function(e,t,n){"use strict";var r={isBatchingUpdates:!1,batchedUpdates:function batchedUpdates(e){}};t.exports=r;},{}],83:[function(e,t,n){"use strict";function r(e,t){var n;try{return h.injection.injectBatchingStrategy(d),n=f.getPooled(t),g++,n.perform(function(){var r=v(e,!0),o=p.mountComponent(r,n,null,s(),m,0);return t||(o=c.addChecksumToMarkup(o)),o;},null);}finally{g--,f.release(n),g||h.injection.injectBatchingStrategy(u);}}function o(e){return l.isValidElement(e)?void 0:i("46"),r(e,!1);}function a(e){return l.isValidElement(e)?void 0:i("47"),r(e,!0);}var i=e(132),s=e(41),u=e(54),l=e(56),c=(e(66),e(67)),p=e(80),d=e(82),f=e(84),h=e(88),m=e(147),v=e(127),g=(e(154),0);t.exports={renderToString:o,renderToStaticMarkup:a};},{127:127,132:132,147:147,154:154,41:41,54:54,56:56,66:66,67:67,80:80,82:82,84:84,88:88}],84:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.useCreateElement=!1,this.updateQueue=new s(this);}var o=e(162),a=e(25),i=e(106),s=(e(66),e(85)),u=[],l={enqueue:function enqueue(){}},c={getTransactionWrappers:function getTransactionWrappers(){return u;},getReactMountReady:function getReactMountReady(){return l;},getUpdateQueue:function getUpdateQueue(){return this.updateQueue;},destructor:function destructor(){},checkpoint:function checkpoint(){},rollback:function rollback(){}};o(r.prototype,i.Mixin,c),a.addPoolingTo(r),t.exports=r;},{106:106,162:162,25:25,66:66,85:85}],85:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function o(e,t){}var a=e(87),i=(e(106),e(161),function(){function e(t){r(this,e),this.transaction=t;}return e.prototype.isMounted=function(e){return!1;},e.prototype.enqueueCallback=function(e,t,n){this.transaction.isInTransaction()&&a.enqueueCallback(e,t,n);},e.prototype.enqueueForceUpdate=function(e){this.transaction.isInTransaction()?a.enqueueForceUpdate(e):o(e,"forceUpdate");},e.prototype.enqueueReplaceState=function(e,t){this.transaction.isInTransaction()?a.enqueueReplaceState(e,t):o(e,"replaceState");},e.prototype.enqueueSetState=function(e,t){this.transaction.isInTransaction()?a.enqueueSetState(e,t):o(e,"setState");},e;}());t.exports=i;},{106:106,161:161,87:87}],86:[function(e,t,n){"use strict";var r=e(162),o=e(36),a=e(50),i=e(26),b=e(65),c=e(69),d=e(88),s=r({__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:o,__SECRET_DOM_SERVER_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:a,ReactInstanceMap:b,ReactMultiChild:c,ReactUpdates:d},i);t.exports=s;},{162:162,26:26,36:36,50:50,65:65,69:69,88:88}],87:[function(e,t,n){"use strict";function r(e){u.enqueueUpdate(e);}function o(e){var t=typeof e==="undefined"?"undefined":_typeof(e);if("object"!==t)return t;var n=e.constructor&&e.constructor.name||t,r=Object.keys(e);return r.length>0&&r.length<20?n+" (keys: "+r.join(", ")+")":n;}function a(e,t){var n=s.get(e);return n?n:null;}var i=e(132),s=(e(35),e(65)),u=(e(66),e(88)),l=(e(154),e(161),{isMounted:function isMounted(e){var t=s.get(e);return!!t&&!!t._renderedComponent;},enqueueCallback:function enqueueCallback(e,t,n){l.validateCallback(t,n);var o=a(e);return o?(o._pendingCallbacks?o._pendingCallbacks.push(t):o._pendingCallbacks=[t],void r(o)):null;},enqueueCallbackInternal:function enqueueCallbackInternal(e,t){e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t],r(e);},enqueueForceUpdate:function enqueueForceUpdate(e){var t=a(e,"forceUpdate");t&&(t._pendingForceUpdate=!0,r(t));},enqueueReplaceState:function enqueueReplaceState(e,t){var n=a(e,"replaceState");n&&(n._pendingStateQueue=[t],n._pendingReplaceState=!0,r(n));},enqueueSetState:function enqueueSetState(e,t){var n=a(e,"setState");if(n){var o=n._pendingStateQueue||(n._pendingStateQueue=[]);o.push(t),r(n);}},enqueueElementInternal:function enqueueElementInternal(e,t,n){e._pendingElement=t,e._context=n,r(e);},validateCallback:function validateCallback(e,t){e&&"function"!=typeof e?i("122",t,o(e)):void 0;}});t.exports=l;},{132:132,154:154,161:161,35:35,65:65,66:66,88:88}],88:[function(e,t,n){"use strict";function r(){P.ReactReconcileTransaction&&_?void 0:c("123");}function o(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=d.getPooled(),this.reconcileTransaction=P.ReactReconcileTransaction.getPooled(!0);}function a(e,t,n,o,a,i){r(),_.batchedUpdates(e,t,n,o,a,i);}function i(e,t){return e._mountOrder-t._mountOrder;}function s(e){var t=e.dirtyComponentsLength;t!==g.length?c("124",t,g.length):void 0,g.sort(i),y++;for(var n=0;n<t;n++){var r=g[n],o=r._pendingCallbacks;r._pendingCallbacks=null;var a;if(h.logTopLevelRenders){var s=r;r._currentElement.props===r._renderedComponent._currentElement&&(s=r._renderedComponent),a="React update: "+s.getName(),console.time(a);}if(m.performUpdateIfNecessary(r,e.reconcileTransaction,y),a&&console.timeEnd(a),o)for(var u=0;u<o.length;u++){e.callbackQueue.enqueue(o[u],r.getPublicInstance());}}}function u(e){return r(),_.isBatchingUpdates?(g.push(e),void(null==e._updateBatchNumber&&(e._updateBatchNumber=y+1))):void _.batchedUpdates(u,e);}function l(e,t){_.isBatchingUpdates?void 0:c("125"),b.enqueue(e,t),C=!0;}var c=e(132),p=e(162),d=e(5),f=e(25),h=e(61),m=e(80),v=e(106),g=(e(154),[]),y=0,b=d.getPooled(),C=!1,_=null,E={initialize:function initialize(){this.dirtyComponentsLength=g.length;},close:function close(){this.dirtyComponentsLength!==g.length?(g.splice(0,this.dirtyComponentsLength),N()):g.length=0;}},x={initialize:function initialize(){this.callbackQueue.reset();},close:function close(){this.callbackQueue.notifyAll();}},T=[E,x];p(o.prototype,v.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return T;},destructor:function destructor(){this.dirtyComponentsLength=null,d.release(this.callbackQueue),this.callbackQueue=null,P.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null;},perform:function perform(e,t,n){return v.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n);}}),f.addPoolingTo(o);var N=function N(){for(;g.length||C;){if(g.length){var e=o.getPooled();e.perform(s,null,e),o.release(e);}if(C){C=!1;var t=b;b=d.getPooled(),t.notifyAll(),d.release(t);}}},w={injectReconcileTransaction:function injectReconcileTransaction(e){e?void 0:c("126"),P.ReactReconcileTransaction=e;},injectBatchingStrategy:function injectBatchingStrategy(e){e?void 0:c("127"),"function"!=typeof e.batchedUpdates?c("128"):void 0,"boolean"!=typeof e.isBatchingUpdates?c("129"):void 0,_=e;}},P={ReactReconcileTransaction:null,batchedUpdates:a,enqueueUpdate:u,flushBatchedUpdates:N,injection:w,asap:l};t.exports=P;},{106:106,132:132,154:154,162:162,25:25,5:5,61:61,80:80}],89:[function(e,t,n){"use strict";t.exports="15.3.1";},{}],90:[function(e,t,n){"use strict";var r={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},o={accentHeight:"accent-height",accumulate:0,additive:0,alignmentBaseline:"alignment-baseline",allowReorder:"allowReorder",alphabetic:0,amplitude:0,arabicForm:"arabic-form",ascent:0,attributeName:"attributeName",attributeType:"attributeType",autoReverse:"autoReverse",azimuth:0,baseFrequency:"baseFrequency",baseProfile:"baseProfile",baselineShift:"baseline-shift",bbox:0,begin:0,bias:0,by:0,calcMode:"calcMode",capHeight:"cap-height",clip:0,clipPath:"clip-path",clipRule:"clip-rule",clipPathUnits:"clipPathUnits",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",contentScriptType:"contentScriptType",contentStyleType:"contentStyleType",cursor:0,cx:0,cy:0,d:0,decelerate:0,descent:0,diffuseConstant:"diffuseConstant",direction:0,display:0,divisor:0,dominantBaseline:"dominant-baseline",dur:0,dx:0,dy:0,edgeMode:"edgeMode",elevation:0,enableBackground:"enable-background",end:0,exponent:0,externalResourcesRequired:"externalResourcesRequired",fill:0,fillOpacity:"fill-opacity",fillRule:"fill-rule",filter:0,filterRes:"filterRes",filterUnits:"filterUnits",floodColor:"flood-color",floodOpacity:"flood-opacity",focusable:0,fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",format:0,from:0,fx:0,fy:0,g1:0,g2:0,glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",glyphRef:"glyphRef",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",hanging:0,horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",ideographic:0,imageRendering:"image-rendering",in:0,in2:0,intercept:0,k:0,k1:0,k2:0,k3:0,k4:0,kernelMatrix:"kernelMatrix",kernelUnitLength:"kernelUnitLength",kerning:0,keyPoints:"keyPoints",keySplines:"keySplines",keyTimes:"keyTimes",lengthAdjust:"lengthAdjust",letterSpacing:"letter-spacing",lightingColor:"lighting-color",limitingConeAngle:"limitingConeAngle",local:0,markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",markerHeight:"markerHeight",markerUnits:"markerUnits",markerWidth:"markerWidth",mask:0,maskContentUnits:"maskContentUnits",maskUnits:"maskUnits",mathematical:0,mode:0,numOctaves:"numOctaves",offset:0,opacity:0,operator:0,order:0,orient:0,orientation:0,origin:0,overflow:0,overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pathLength:"pathLength",patternContentUnits:"patternContentUnits",patternTransform:"patternTransform",patternUnits:"patternUnits",pointerEvents:"pointer-events",points:0,pointsAtX:"pointsAtX",pointsAtY:"pointsAtY",pointsAtZ:"pointsAtZ",preserveAlpha:"preserveAlpha",preserveAspectRatio:"preserveAspectRatio",primitiveUnits:"primitiveUnits",r:0,radius:0,refX:"refX",refY:"refY",renderingIntent:"rendering-intent",repeatCount:"repeatCount",repeatDur:"repeatDur",requiredExtensions:"requiredExtensions",requiredFeatures:"requiredFeatures",restart:0,result:0,rotate:0,rx:0,ry:0,scale:0,seed:0,shapeRendering:"shape-rendering",slope:0,spacing:0,specularConstant:"specularConstant",specularExponent:"specularExponent",speed:0,spreadMethod:"spreadMethod",startOffset:"startOffset",stdDeviation:"stdDeviation",stemh:0,stemv:0,stitchTiles:"stitchTiles",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",string:0,stroke:0,strokeDasharray:"stroke-dasharray",strokeDashoffset:"stroke-dashoffset",strokeLinecap:"stroke-linecap",strokeLinejoin:"stroke-linejoin",strokeMiterlimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",surfaceScale:"surfaceScale",systemLanguage:"systemLanguage",tableValues:"tableValues",targetX:"targetX",targetY:"targetY",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",textLength:"textLength",to:0,transform:0,u1:0,u2:0,underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicode:0,unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",values:0,vectorEffect:"vector-effect",version:0,vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",viewBox:"viewBox",viewTarget:"viewTarget",visibility:0,widths:0,wordSpacing:"word-spacing",writingMode:"writing-mode",x:0,xHeight:"x-height",x1:0,x2:0,xChannelSelector:"xChannelSelector",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlns:0,xmlnsXlink:"xmlns:xlink",xmlLang:"xml:lang",xmlSpace:"xml:space",y:0,y1:0,y2:0,yChannelSelector:"yChannelSelector",z:0,zoomAndPan:"zoomAndPan"},a={Properties:{},DOMAttributeNamespaces:{xlinkActuate:r.xlink,xlinkArcrole:r.xlink,xlinkHref:r.xlink,xlinkRole:r.xlink,xlinkShow:r.xlink,xlinkTitle:r.xlink,xlinkType:r.xlink,xmlBase:r.xml,xmlLang:r.xml,xmlSpace:r.xml},DOMAttributeNames:{}};Object.keys(o).forEach(function(e){a.Properties[e]=0,o[e]&&(a.DOMAttributeNames[e]=o[e]);}),t.exports=a;},{}],91:[function(e,t,n){"use strict";function r(e){if("selectionStart"in e&&l.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset};}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft};}}function o(e,t){if(_||null==y||y!==p())return null;var n=r(y);if(!C||!h(C,n)){C=n;var o=c.getPooled(g.select,b,e,t);return o.type="select",o.target=y,i.accumulateTwoPhaseDispatches(o),o;}return null;}var a=e(16),i=e(20),s=e(140),u=e(40),l=e(64),c=e(97),p=e(149),d=e(129),f=e(158),h=e(160),m=a.topLevelTypes,v=s.canUseDOM&&"documentMode"in document&&document.documentMode<=11,g={select:{phasedRegistrationNames:{bubbled:f({onSelect:null}),captured:f({onSelectCapture:null})},dependencies:[m.topBlur,m.topContextMenu,m.topFocus,m.topKeyDown,m.topMouseDown,m.topMouseUp,m.topSelectionChange]}},y=null,b=null,C=null,_=!1,E=!1,x=f({onSelect:null}),T={eventTypes:g,extractEvents:function extractEvents(e,t,n,r){if(!E)return null;var a=t?u.getNodeFromInstance(t):window;switch(e){case m.topFocus:(d(a)||"true"===a.contentEditable)&&(y=a,b=t,C=null);break;case m.topBlur:y=null,b=null,C=null;break;case m.topMouseDown:_=!0;break;case m.topContextMenu:case m.topMouseUp:return _=!1,o(n,r);case m.topSelectionChange:if(v)break;case m.topKeyDown:case m.topKeyUp:return o(n,r);}return null;},didPutListener:function didPutListener(e,t,n){t===x&&(E=!0);}};t.exports=T;},{129:129,140:140,149:149,158:158,16:16,160:160,20:20,40:40,64:64,97:97}],92:[function(e,t,n){"use strict";function r(e){return"."+e._rootNodeID;}var o=e(132),a=e(16),i=e(139),s=e(20),u=e(40),l=e(93),c=e(94),p=e(97),d=e(98),f=e(100),h=e(101),m=e(96),v=e(102),g=e(103),y=e(104),b=e(105),C=e(146),_=e(118),E=(e(154),e(158)),x=a.topLevelTypes,T={abort:{phasedRegistrationNames:{bubbled:E({onAbort:!0}),captured:E({onAbortCapture:!0})}},animationEnd:{phasedRegistrationNames:{bubbled:E({onAnimationEnd:!0}),captured:E({onAnimationEndCapture:!0})}},animationIteration:{phasedRegistrationNames:{bubbled:E({onAnimationIteration:!0}),captured:E({onAnimationIterationCapture:!0})}},animationStart:{phasedRegistrationNames:{bubbled:E({onAnimationStart:!0}),captured:E({onAnimationStartCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:E({onBlur:!0}),captured:E({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:E({onCanPlay:!0}),captured:E({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:E({onCanPlayThrough:!0}),captured:E({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:E({onClick:!0}),captured:E({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:E({onContextMenu:!0}),captured:E({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:E({onCopy:!0}),captured:E({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:E({onCut:!0}),captured:E({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:E({onDoubleClick:!0}),captured:E({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:E({onDrag:!0}),captured:E({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:E({onDragEnd:!0}),captured:E({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:E({onDragEnter:!0}),captured:E({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:E({onDragExit:!0}),captured:E({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:E({onDragLeave:!0}),captured:E({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:E({onDragOver:!0}),captured:E({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:E({onDragStart:!0}),captured:E({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:E({onDrop:!0}),captured:E({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:E({onDurationChange:!0}),captured:E({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:E({onEmptied:!0}),captured:E({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:E({onEncrypted:!0}),captured:E({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:E({onEnded:!0}),captured:E({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:E({onError:!0}),captured:E({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:E({onFocus:!0}),captured:E({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:E({onInput:!0}),captured:E({onInputCapture:!0})}},invalid:{phasedRegistrationNames:{bubbled:E({onInvalid:!0}),captured:E({onInvalidCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:E({onKeyDown:!0}),captured:E({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:E({onKeyPress:!0}),captured:E({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:E({onKeyUp:!0}),captured:E({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:E({onLoad:!0}),captured:E({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:E({onLoadedData:!0}),captured:E({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:E({onLoadedMetadata:!0}),captured:E({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:E({onLoadStart:!0}),captured:E({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:E({onMouseDown:!0}),captured:E({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:E({onMouseMove:!0}),captured:E({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:E({onMouseOut:!0}),captured:E({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:E({onMouseOver:!0}),captured:E({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:E({onMouseUp:!0}),captured:E({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:E({onPaste:!0}),captured:E({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:E({onPause:!0}),captured:E({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:E({onPlay:!0}),captured:E({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:E({onPlaying:!0}),captured:E({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:E({onProgress:!0}),captured:E({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:E({onRateChange:!0}),captured:E({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:E({onReset:!0}),captured:E({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:E({onScroll:!0}),captured:E({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:E({onSeeked:!0}),captured:E({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:E({onSeeking:!0}),captured:E({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:E({onStalled:!0}),captured:E({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:E({onSubmit:!0}),captured:E({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:E({onSuspend:!0}),captured:E({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:E({onTimeUpdate:!0}),captured:E({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:E({onTouchCancel:!0}),captured:E({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:E({onTouchEnd:!0}),captured:E({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:E({onTouchMove:!0}),captured:E({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:E({onTouchStart:!0}),captured:E({onTouchStartCapture:!0})}},transitionEnd:{phasedRegistrationNames:{bubbled:E({onTransitionEnd:!0}),captured:E({onTransitionEndCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:E({onVolumeChange:!0}),captured:E({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:E({onWaiting:!0}),captured:E({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:E({onWheel:!0}),captured:E({onWheelCapture:!0})}}},N={topAbort:T.abort,topAnimationEnd:T.animationEnd,topAnimationIteration:T.animationIteration,topAnimationStart:T.animationStart,topBlur:T.blur,topCanPlay:T.canPlay,topCanPlayThrough:T.canPlayThrough,topClick:T.click,topContextMenu:T.contextMenu,topCopy:T.copy,topCut:T.cut,topDoubleClick:T.doubleClick,topDrag:T.drag,topDragEnd:T.dragEnd,topDragEnter:T.dragEnter,topDragExit:T.dragExit,topDragLeave:T.dragLeave,topDragOver:T.dragOver,topDragStart:T.dragStart,topDrop:T.drop,topDurationChange:T.durationChange,topEmptied:T.emptied,topEncrypted:T.encrypted,topEnded:T.ended,topError:T.error,topFocus:T.focus,topInput:T.input,topInvalid:T.invalid,topKeyDown:T.keyDown,topKeyPress:T.keyPress,topKeyUp:T.keyUp,topLoad:T.load,topLoadedData:T.loadedData,topLoadedMetadata:T.loadedMetadata,topLoadStart:T.loadStart,topMouseDown:T.mouseDown,topMouseMove:T.mouseMove,topMouseOut:T.mouseOut,topMouseOver:T.mouseOver,topMouseUp:T.mouseUp,topPaste:T.paste,topPause:T.pause,topPlay:T.play,topPlaying:T.playing,topProgress:T.progress,topRateChange:T.rateChange,topReset:T.reset,topScroll:T.scroll,topSeeked:T.seeked,topSeeking:T.seeking,topStalled:T.stalled,topSubmit:T.submit,topSuspend:T.suspend,topTimeUpdate:T.timeUpdate,topTouchCancel:T.touchCancel,topTouchEnd:T.touchEnd,topTouchMove:T.touchMove,topTouchStart:T.touchStart,topTransitionEnd:T.transitionEnd,topVolumeChange:T.volumeChange,topWaiting:T.waiting,topWheel:T.wheel};for(var w in N){N[w].dependencies=[w];}var P=E({onClick:null}),k={},M={eventTypes:T,extractEvents:function extractEvents(e,t,n,r){var a=N[e];if(!a)return null;var i;switch(e){case x.topAbort:case x.topCanPlay:case x.topCanPlayThrough:case x.topDurationChange:case x.topEmptied:case x.topEncrypted:case x.topEnded:case x.topError:case x.topInput:case x.topInvalid:case x.topLoad:case x.topLoadedData:case x.topLoadedMetadata:case x.topLoadStart:case x.topPause:case x.topPlay:case x.topPlaying:case x.topProgress:case x.topRateChange:case x.topReset:case x.topSeeked:case x.topSeeking:case x.topStalled:case x.topSubmit:case x.topSuspend:case x.topTimeUpdate:case x.topVolumeChange:case x.topWaiting:i=p;break;case x.topKeyPress:if(0===_(n))return null;case x.topKeyDown:case x.topKeyUp:i=f;break;case x.topBlur:case x.topFocus:i=d;break;case x.topClick:if(2===n.button)return null;case x.topContextMenu:case x.topDoubleClick:case x.topMouseDown:case x.topMouseMove:case x.topMouseOut:case x.topMouseOver:case x.topMouseUp:i=h;break;case x.topDrag:case x.topDragEnd:case x.topDragEnter:case x.topDragExit:case x.topDragLeave:case x.topDragOver:case x.topDragStart:case x.topDrop:i=m;break;case x.topTouchCancel:case x.topTouchEnd:case x.topTouchMove:case x.topTouchStart:i=v;break;case x.topAnimationEnd:case x.topAnimationIteration:case x.topAnimationStart:i=l;break;case x.topTransitionEnd:i=g;break;case x.topScroll:i=y;break;case x.topWheel:i=b;break;case x.topCopy:case x.topCut:case x.topPaste:i=c;}i?void 0:o("86",e);var u=i.getPooled(a,t,n,r);return s.accumulateTwoPhaseDispatches(u),u;},didPutListener:function didPutListener(e,t,n){if(t===P){var o=r(e),a=u.getNodeFromInstance(e);k[o]||(k[o]=i.listen(a,"click",C));}},willDeleteListener:function willDeleteListener(e,t){if(t===P){var n=r(e);k[n].remove(),delete k[n];}}};t.exports=M;},{100:100,101:101,102:102,103:103,104:104,105:105,118:118,132:132,139:139,146:146,154:154,158:158,16:16,20:20,40:40,93:93,94:94,96:96,97:97,98:98}],93:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a={animationName:null,elapsedTime:null,pseudoElement:null};o.augmentClass(r,a),t.exports=r;},{97:97}],94:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a={clipboardData:function clipboardData(e){return"clipboardData"in e?e.clipboardData:window.clipboardData;}};o.augmentClass(r,a),t.exports=r;},{97:97}],95:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a={data:null};o.augmentClass(r,a),t.exports=r;},{97:97}],96:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(101),a={dataTransfer:null};o.augmentClass(r,a),t.exports=r;},{101:101}],97:[function(e,t,n){"use strict";function r(e,t,n,r){this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n;var o=this.constructor.Interface;for(var a in o){if(o.hasOwnProperty(a)){var s=o[a];s?this[a]=s(n):"target"===a?this.target=r:this[a]=n[a];}}var u=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;return u?this.isDefaultPrevented=i.thatReturnsTrue:this.isDefaultPrevented=i.thatReturnsFalse,this.isPropagationStopped=i.thatReturnsFalse,this;}var o=e(162),a=e(25),i=e(146),s=(e(161),"function"==typeof Proxy,["dispatchConfig","_targetInst","nativeEvent","isDefaultPrevented","isPropagationStopped","_dispatchListeners","_dispatchInstances"]),u={type:null,target:null,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function timeStamp(e){return e.timeStamp||Date.now();},defaultPrevented:null,isTrusted:null};o(r.prototype,{preventDefault:function preventDefault(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=i.thatReturnsTrue);},stopPropagation:function stopPropagation(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=i.thatReturnsTrue);},persist:function persist(){this.isPersistent=i.thatReturnsTrue;},isPersistent:i.thatReturnsFalse,destructor:function destructor(){var e=this.constructor.Interface;for(var t in e){this[t]=null;}for(var n=0;n<s.length;n++){this[s[n]]=null;}}}),r.Interface=u,r.augmentClass=function(e,t){var n=this,r=function r(){};r.prototype=n.prototype;var i=new r();o(i,e.prototype),e.prototype=i,e.prototype.constructor=e,e.Interface=o({},n.Interface,t),e.augmentClass=n.augmentClass,a.addPoolingTo(e,a.fourArgumentPooler);},a.addPoolingTo(r,a.fourArgumentPooler),t.exports=r;},{146:146,161:161,162:162,25:25}],98:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(104),a={relatedTarget:null};o.augmentClass(r,a),t.exports=r;},{104:104}],99:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a={data:null};o.augmentClass(r,a),t.exports=r;},{97:97}],100:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(104),a=e(118),i=e(119),s=e(120),u={key:i,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:s,charCode:function charCode(e){return"keypress"===e.type?a(e):0;},keyCode:function keyCode(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0;},which:function which(e){return"keypress"===e.type?a(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0;}};o.augmentClass(r,u),t.exports=r;},{104:104,118:118,119:119,120:120}],101:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(104),a=e(107),i=e(120),s={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:i,button:function button(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0;},buttons:null,relatedTarget:function relatedTarget(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement);},pageX:function pageX(e){return"pageX"in e?e.pageX:e.clientX+a.currentScrollLeft;},pageY:function pageY(e){return"pageY"in e?e.pageY:e.clientY+a.currentScrollTop;}};o.augmentClass(r,s),t.exports=r;},{104:104,107:107,120:120}],102:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(104),a=e(120),i={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:a};o.augmentClass(r,i),t.exports=r;},{104:104,120:120}],103:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a={propertyName:null,elapsedTime:null,pseudoElement:null};o.augmentClass(r,a),t.exports=r;},{97:97}],104:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(97),a=e(121),i={view:function view(e){if(e.view)return e.view;var t=a(e);if(t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window;},detail:function detail(e){return e.detail||0;}};o.augmentClass(r,i),t.exports=r;},{121:121,97:97}],105:[function(e,t,n){"use strict";function r(e,t,n,r){return o.call(this,e,t,n,r);}var o=e(101),a={deltaX:function deltaX(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0;},deltaY:function deltaY(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0;},deltaZ:null,deltaMode:null};o.augmentClass(r,a),t.exports=r;},{101:101}],106:[function(e,t,n){"use strict";var r=e(132),o=(e(154),{reinitializeTransaction:function reinitializeTransaction(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1;},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function isInTransaction(){return!!this._isInTransaction;},perform:function perform(e,t,n,o,a,i,s,u){this.isInTransaction()?r("27"):void 0;var l,c;try{this._isInTransaction=!0,l=!0,this.initializeAll(0),c=e.call(t,n,o,a,i,s,u),l=!1;}finally{try{if(l)try{this.closeAll(0);}catch(e){}else this.closeAll(0);}finally{this._isInTransaction=!1;}}return c;},initializeAll:function initializeAll(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=a.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null;}finally{if(this.wrapperInitData[n]===a.OBSERVED_ERROR)try{this.initializeAll(n+1);}catch(e){}}}},closeAll:function closeAll(e){this.isInTransaction()?void 0:r("28");for(var t=this.transactionWrappers,n=e;n<t.length;n++){var o,i=t[n],s=this.wrapperInitData[n];try{o=!0,s!==a.OBSERVED_ERROR&&i.close&&i.close.call(this,s),o=!1;}finally{if(o)try{this.closeAll(n+1);}catch(e){}}}this.wrapperInitData.length=0;}}),a={Mixin:o,OBSERVED_ERROR:{}};t.exports=a;},{132:132,154:154}],107:[function(e,t,n){"use strict";var r={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function refreshScrollValues(e){r.currentScrollLeft=e.x,r.currentScrollTop=e.y;}};t.exports=r;},{}],108:[function(e,t,n){"use strict";function r(e,t){return null==t?o("30"):void 0,null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t];}var o=e(132);e(154);t.exports=r;},{132:132,154:154}],109:[function(e,t,n){"use strict";function r(e){for(var t=1,n=0,r=0,a=e.length,i=a&-4;r<i;){for(var s=Math.min(r+4096,i);r<s;r+=4){n+=(t+=e.charCodeAt(r))+(t+=e.charCodeAt(r+1))+(t+=e.charCodeAt(r+2))+(t+=e.charCodeAt(r+3));}t%=o,n%=o;}for(;r<a;r++){n+=t+=e.charCodeAt(r);}return t%=o,n%=o,t|n<<16;}var o=65521;t.exports=r;},{}],110:[function(e,t,n){"use strict";var r=!1;t.exports=r;},{}],111:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r,u,l){for(var c in e){if(e.hasOwnProperty(c)){var p;try{"function"!=typeof e[c]?o("84",r||"React class",a[n],c):void 0,p=e[c](t,c,r,n,null,i);}catch(e){p=e;}p instanceof Error&&!(p.message in s)&&(s[p.message]=!0);}}}var o=e(132),a=e(74),i=e(77);e(154),e(161);"undefined"!=typeof n&&n.env,1;var s={};t.exports=r;}).call(this,void 0);},{132:132,154:154,161:161,74:74,77:77}],112:[function(e,t,n){"use strict";var r=function r(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o);});}:e;};t.exports=r;},{}],113:[function(e,t,n){"use strict";function r(e,t,n){var r=null==t||"boolean"==typeof t||""===t;if(r)return"";var o=isNaN(t);return o||0===t||a.hasOwnProperty(e)&&a[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px");}var o=e(3),a=(e(161),o.isUnitlessNumber);t.exports=r;},{161:161,3:3}],114:[function(e,t,n){"use strict";function r(e){var t=""+e,n=a.exec(t);if(!n)return t;var r,o="",i=0,s=0;for(i=n.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#x27;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue;}s!==i&&(o+=t.substring(s,i)),s=i+1,o+=r;}return s!==i?o+t.substring(s,i):o;}function o(e){return"boolean"==typeof e||"number"==typeof e?""+e:r(e);}var a=/["'&<>]/;t.exports=o;},{}],115:[function(e,t,n){"use strict";function r(e){if(null==e)return null;if(1===e.nodeType)return e;var t=i.get(e);return t?(t=s(t),t?a.getNodeFromInstance(t):null):void("function"==typeof e.render?o("44"):o("45",Object.keys(e)));}var o=e(132),a=(e(35),e(40)),i=e(65),s=e(122);e(154),e(161);t.exports=r;},{122:122,132:132,154:154,161:161,35:35,40:40,65:65}],116:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r){if(e&&"object"==(typeof e==="undefined"?"undefined":_typeof(e))){var o=e,a=void 0===o[n];a&&null!=t&&(o[n]=t);}}function o(e,t){if(null==e)return e;var n={};return a(e,r,n),n;}var a=(e(23),e(137));e(161);"undefined"!=typeof n&&n.env,t.exports=o;}).call(this,void 0);},{137:137,161:161,23:23}],117:[function(e,t,n){"use strict";function r(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e);}t.exports=r;},{}],118:[function(e,t,n){"use strict";function r(e){var t,n=e.keyCode;return"charCode"in e?(t=e.charCode,0===t&&13===n&&(t=13)):t=n,t>=32||13===t?t:0;}t.exports=r;},{}],119:[function(e,t,n){"use strict";function r(e){if(e.key){var t=a[e.key]||e.key;if("Unidentified"!==t)return t;}if("keypress"===e.type){var n=o(e);return 13===n?"Enter":String.fromCharCode(n);}return"keydown"===e.type||"keyup"===e.type?i[e.keyCode]||"Unidentified":"";}var o=e(118),a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=r;},{118:118}],120:[function(e,t,n){"use strict";function r(e){var t=this,n=t.nativeEvent;if(n.getModifierState)return n.getModifierState(e);var r=a[e];return!!r&&!!n[r];}function o(e){return r;}var a={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=o;},{}],121:[function(e,t,n){"use strict";function r(e){var t=e.target||e.srcElement||window;return t.correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t;}t.exports=r;},{}],122:[function(e,t,n){"use strict";function r(e){for(var t;(t=e._renderedNodeType)===o.COMPOSITE;){e=e._renderedComponent;}return t===o.HOST?e._renderedComponent:t===o.EMPTY?null:void 0;}var o=e(71);t.exports=r;},{71:71}],123:[function(e,t,n){"use strict";function r(e){var t=e&&(o&&e[o]||e[a]);if("function"==typeof t)return t;}var o="function"==typeof Symbol&&Symbol.iterator,a="@@iterator";t.exports=r;},{}],124:[function(e,t,n){"use strict";function r(e){for(;e&&e.firstChild;){e=e.firstChild;}return e;}function o(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode;}}function a(e,t){for(var n=r(e),a=0,i=0;n;){if(3===n.nodeType){if(i=a+n.textContent.length,a<=t&&i>=t)return{node:n,offset:t-a};a=i;}n=r(o(n));}}t.exports=a;},{}],125:[function(e,t,n){"use strict";function r(){return!a&&o.canUseDOM&&(a="textContent"in document.documentElement?"textContent":"innerText"),a;}var o=e(140),a=null;t.exports=r;},{140:140}],126:[function(e,t,n){"use strict";function r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n["ms"+e]="MS"+t,n["O"+e]="o"+t.toLowerCase(),n;}function o(e){if(s[e])return s[e];if(!i[e])return e;var t=i[e];for(var n in t){if(t.hasOwnProperty(n)&&n in u)return s[e]=t[n];}return"";}var a=e(140),i={animationend:r("Animation","AnimationEnd"),animationiteration:r("Animation","AnimationIteration"),animationstart:r("Animation","AnimationStart"),transitionend:r("Transition","TransitionEnd")},s={},u={};a.canUseDOM&&(u=document.createElement("div").style,"AnimationEvent"in window||(delete i.animationend.animation,delete i.animationiteration.animation,delete i.animationstart.animation),"TransitionEvent"in window||delete i.transitionend.transition),t.exports=o;},{140:140}],127:[function(e,t,n){"use strict";function r(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`.";}return"";}function o(e){return"function"==typeof e&&"undefined"!=typeof e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent;}function a(e,t){var n;if(null===e||e===!1)n=l.create(a);else if("object"==(typeof e==="undefined"?"undefined":_typeof(e))){var s=e;!s||"function"!=typeof s.type&&"string"!=typeof s.type?i("130",null==s.type?s.type:_typeof(s.type),r(s._owner)):void 0,"string"==typeof s.type?n=c.createInternalComponent(s):o(s.type)?(n=new s.type(s),n.getHostNode||(n.getHostNode=n.getNativeNode)):n=new p(s);}else"string"==typeof e||"number"==typeof e?n=c.createInstanceForText(e):i("131",typeof e==="undefined"?"undefined":_typeof(e));return n._mountIndex=0,n._mountImage=null,n;}var i=e(132),s=e(162),u=e(34),l=e(57),c=e(62),p=(e(154),e(161),function(e){this.construct(e);});s(p.prototype,u.Mixin,{_instantiateReactComponent:a});t.exports=a;},{132:132,154:154,161:161,162:162,34:34,57:57,62:62}],128:[function(e,t,n){"use strict";function r(e,t){if(!a.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,r=n in document;if(!r){var i=document.createElement("div");i.setAttribute(n,"return;"),r="function"==typeof i[n];}return!r&&o&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r;}var o,a=e(140);a.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=r;},{140:140}],129:[function(e,t,n){"use strict";function r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!o[e.type]:"textarea"===t;}var o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=r;},{}],130:[function(e,t,n){"use strict";function r(e){return a.isValidElement(e)?void 0:o("143"),e;}var o=e(132),a=e(56);e(154);t.exports=r;},{132:132,154:154,56:56}],131:[function(e,t,n){"use strict";function r(e){return'"'+o(e)+'"';}var o=e(114);t.exports=r;},{114:114}],132:[function(e,t,n){"use strict";function r(e){for(var t=arguments.length-1,n="Minified React error #"+e+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+e,r=0;r<t;r++){n+="&args[]="+encodeURIComponent(arguments[r+1]);}n+=" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";var o=new Error(n);throw o.name="Invariant Violation",o.framesToPop=1,o;}t.exports=r;},{}],133:[function(e,t,n){"use strict";var r=e(68);t.exports=r.renderSubtreeIntoContainer;},{68:68}],134:[function(e,t,n){"use strict";var r,o=e(140),a=e(9),i=/^[ \r\n\t\f]/,s=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,u=e(112),l=u(function(e,t){if(e.namespaceURI!==a.svg||"innerHTML"in e)e.innerHTML=t;else{r=r||document.createElement("div"),r.innerHTML="<svg>"+t+"</svg>";for(var n=r.firstChild.childNodes,o=0;o<n.length;o++){e.appendChild(n[o]);}}});if(o.canUseDOM){var c=document.createElement("div");c.innerHTML=" ",""===c.innerHTML&&(l=function l(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),i.test(t)||"<"===t[0]&&s.test(t)){e.innerHTML=String.fromCharCode(65279)+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1);}else e.innerHTML=t;}),c=null;}t.exports=l;},{112:112,140:140,9:9}],135:[function(e,t,n){"use strict";var r=e(140),o=e(114),a=e(134),i=function i(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t);}e.textContent=t;};r.canUseDOM&&("textContent"in document.documentElement||(i=function i(e,t){a(e,o(t));})),t.exports=i;},{114:114,134:134,140:140}],136:[function(e,t,n){"use strict";function r(e,t){var n=null===e||e===!1,r=null===t||t===!1;if(n||r)return n===r;var o=typeof e==="undefined"?"undefined":_typeof(e),a=typeof t==="undefined"?"undefined":_typeof(t);return"string"===o||"number"===o?"string"===a||"number"===a:"object"===a&&e.type===t.type&&e.key===t.key;}t.exports=r;},{}],137:[function(e,t,n){"use strict";function r(e,t){return e&&"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&null!=e.key?l.escape(e.key):t.toString(36);}function o(e,t,n,a){var d=typeof e==="undefined"?"undefined":_typeof(e);if("undefined"!==d&&"boolean"!==d||(e=null),null===e||"string"===d||"number"===d||s.isValidElement(e))return n(a,e,""===t?c+r(e,0):t),1;var f,h,m=0,v=""===t?c:t+p;if(Array.isArray(e))for(var g=0;g<e.length;g++){f=e[g],h=v+r(f,g),m+=o(f,h,n,a);}else{var y=u(e);if(y){var b,C=y.call(e);if(y!==e.entries)for(var _=0;!(b=C.next()).done;){f=b.value,h=v+r(f,_++),m+=o(f,h,n,a);}else for(;!(b=C.next()).done;){var E=b.value;E&&(f=E[1],h=v+l.escape(E[0])+p+r(f,0),m+=o(f,h,n,a));}}else if("object"===d){var x="",T=String(e);i("31","[object Object]"===T?"object with keys {"+Object.keys(e).join(", ")+"}":T,x);}}return m;}function a(e,t,n){return null==e?0:o(e,"",t,n);}var i=e(132),s=(e(35),e(56)),u=e(123),l=(e(154),e(23)),c=(e(161),"."),p=":";t.exports=a;},{123:123,132:132,154:154,161:161,23:23,35:35,56:56}],138:[function(e,t,n){"use strict";var r=(e(162),e(146)),o=(e(161),r);t.exports=o;},{146:146,161:161,162:162}],139:[function(e,t,n){"use strict";var r=e(146),o={listen:function listen(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function remove(){e.removeEventListener(t,n,!1);}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function remove(){e.detachEvent("on"+t,n);}}):void 0;},capture:function capture(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function remove(){e.removeEventListener(t,n,!0);}}):{remove:r};},registerDefault:function registerDefault(){}};t.exports=o;},{146:146}],140:[function(e,t,n){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};t.exports=o;},{}],141:[function(e,t,n){"use strict";function r(e){return e.replace(o,function(e,t){return t.toUpperCase();});}var o=/-(.)/g;t.exports=r;},{}],142:[function(e,t,n){"use strict";function r(e){return o(e.replace(a,"ms-"));}var o=e(141),a=/^-ms-/;t.exports=r;},{141:141}],143:[function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e===t||!o(e)&&(o(t)?r(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))));}var o=e(156);t.exports=r;},{156:156}],144:[function(e,t,n){"use strict";function r(e){var t=e.length;if(Array.isArray(e)||"object"!=(typeof e==="undefined"?"undefined":_typeof(e))&&"function"!=typeof e?i(!1):void 0,"number"!=typeof t?i(!1):void 0,0===t||t-1 in e?void 0:i(!1),"function"==typeof e.callee?i(!1):void 0,e.hasOwnProperty)try{return Array.prototype.slice.call(e);}catch(e){}for(var n=Array(t),r=0;r<t;r++){n[r]=e[r];}return n;}function o(e){return!!e&&("object"==(typeof e==="undefined"?"undefined":_typeof(e))||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e);}function a(e){return o(e)?Array.isArray(e)?e.slice():r(e):[e];}var i=e(154);t.exports=a;},{154:154}],145:[function(e,t,n){"use strict";function r(e){var t=e.match(c);return t&&t[1].toLowerCase();}function o(e,t){var n=l;l?void 0:u(!1);var o=r(e),a=o&&s(o);if(a){n.innerHTML=a[1]+e+a[2];for(var c=a[0];c--;){n=n.lastChild;}}else n.innerHTML=e;var p=n.getElementsByTagName("script");p.length&&(t?void 0:u(!1),i(p).forEach(t));for(var d=Array.from(n.childNodes);n.lastChild;){n.removeChild(n.lastChild);}return d;}var a=e(140),i=e(144),s=e(150),u=e(154),l=a.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;t.exports=o;},{140:140,144:144,150:150,154:154}],146:[function(e,t,n){"use strict";function r(e){return function(){return e;};}var o=function o(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this;},o.thatReturnsArgument=function(e){return e;},t.exports=o;},{}],147:[function(e,t,n){"use strict";var r={};t.exports=r;},{}],148:[function(e,t,n){"use strict";function r(e){try{e.focus();}catch(e){}}t.exports=r;},{}],149:[function(e,t,n){"use strict";function r(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body;}catch(e){return document.body;}}t.exports=r;},{}],150:[function(e,t,n){"use strict";function r(e){return i?void 0:a(!1),d.hasOwnProperty(e)||(e="*"),s.hasOwnProperty(e)||("*"===e?i.innerHTML="<link />":i.innerHTML="<"+e+"></"+e+">",s[e]=!i.firstChild),s[e]?d[e]:null;}var o=e(140),a=e(154),i=o.canUseDOM?document.createElement("div"):null,s={},u=[1,'<select multiple="true">',"</select>"],l=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],p=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],d={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:u,option:u,caption:l,colgroup:l,tbody:l,tfoot:l,thead:l,td:c,th:c},f=["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"];f.forEach(function(e){d[e]=p,s[e]=!0;}),t.exports=r;},{140:140,154:154}],151:[function(e,t,n){"use strict";function r(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop};}t.exports=r;},{}],152:[function(e,t,n){"use strict";function r(e){return e.replace(o,"-$1").toLowerCase();}var o=/([A-Z])/g;t.exports=r;},{}],153:[function(e,t,n){"use strict";function r(e){return o(e).replace(a,"-ms-");}var o=e(152),a=/^ms-/;t.exports=r;},{152:152}],154:[function(e,t,n){"use strict";function r(e,t,n,r,o,a,i,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,a,i,s],c=0;u=new Error(t.replace(/%s/g,function(){return l[c++];})),u.name="Invariant Violation";}throw u.framesToPop=1,u;}}t.exports=r;},{}],155:[function(e,t,n){"use strict";function r(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==(typeof e==="undefined"?"undefined":_typeof(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName));}t.exports=r;},{}],156:[function(e,t,n){"use strict";function r(e){return o(e)&&3==e.nodeType;}var o=e(155);t.exports=r;},{155:155}],157:[function(e,t,n){"use strict";var r=e(154),o=function o(e){var t,n={};e instanceof Object&&!Array.isArray(e)?void 0:r(!1);for(t in e){e.hasOwnProperty(t)&&(n[t]=t);}return n;};t.exports=o;},{154:154}],158:[function(e,t,n){"use strict";var r=function r(e){var t;for(t in e){if(e.hasOwnProperty(t))return t;}return null;};t.exports=r;},{}],159:[function(e,t,n){"use strict";function r(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n];};}t.exports=r;},{}],160:[function(e,t,n){"use strict";function r(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t;}function o(e,t){if(r(e,t))return!0;if("object"!=(typeof e==="undefined"?"undefined":_typeof(e))||null===e||"object"!=(typeof t==="undefined"?"undefined":_typeof(t))||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++){if(!a.call(t,n[i])||!r(e[n[i]],t[n[i]]))return!1;}return!0;}var a=Object.prototype.hasOwnProperty;t.exports=o;},{}],161:[function(e,t,n){"use strict";var r=e(146),o=r;t.exports=o;},{146:146}],162:[function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e);}function o(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++){t["_"+String.fromCharCode(n)]=n;}var r=Object.getOwnPropertyNames(t).map(function(e){return t[e];});if("0123456789"!==r.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e;}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("");}catch(e){return!1;}}var a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=o()?Object.assign:function(e,t){for(var n,o,s=r(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n){a.call(n,l)&&(s[l]=n[l]);}if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(n);for(var c=0;c<o.length;c++){i.call(n,o[c])&&(s[o[c]]=n[o[c]]);}}}return s;};},{}]},{},[86])(86);});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(e){if("object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e(require("react"));else if("function"==typeof define&&define.amd)define(["react"],e);else{var f;f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,f.ReactDOM=e(f.React);}}(function(e){return e.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(window.React,function(exports){var classIdSplit=/([\.#]?[a-zA-Z0-9_:-]+)/;var notClassId=/^\.|#/;function parseTag(tag,props){if(!tag){return'div';}
var noId=!('id'in props);var tagParts=tag.split(classIdSplit);var tagName=null;if(notClassId.test(tagParts[1])){tagName='div';}
var classes;var part;var type;var i;for(i=0;i<tagParts.length;i++){part=tagParts[i];if(!part){continue;}
type=part.charAt(0);if(!tagName){tagName=part;}else if(type==='.'){classes=classes||[];classes.push(part.substring(1,part.length));}else if(type==='#'&&noId){props.id=part.substring(1,part.length);}}
if(classes){if(props.className){classes.push(props.className);}
props.className=classes.join(' ');}
return tagName?tagName.toLowerCase():'div';}
function h(componentOrTag,properties,children){if(!children&&isChildren(properties)){children=properties;properties={};}else if(arguments.length===2){children=[];}
properties=properties||{};if(properties.children){children=properties.children;delete properties.children;}
if(typeof componentOrTag==='string'){componentOrTag=parseTag(componentOrTag,properties);}
var args=[componentOrTag,properties].concat(children);return React.createElement.apply(React,args);}
function isChildren(x){return typeof x==='string'||typeof x==='number'||Array.isArray(x);}
exports.h=h;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(window.React,function(exports){var cachedHandlerList=[];var cachedWrapFuncList=[];exports.linkEvent=function(data,handler){var idx,wrapFunc;if((idx=cachedHandlerList.indexOf(handler))>-1){wrapFunc=cachedWrapFuncList[idx];}else{idx=cachedHandlerList.length;}
if(!wrapFunc){wrapFunc=function wrapFunc(e){handler(data,e);};cachedWrapFuncList[idx]=wrapFunc;}
return wrapFunc;};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','Konva'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('Konva'));}else{factory(root,root.React,root.Konva);}})(window,function(exports,React,Konva){var ReactInstanceMap=React.ReactInstanceMap;var ReactMultiChild=React.ReactMultiChild;var ReactUpdates=React.ReactUpdates;var assign=Object.assign;var emptyObject={};var oldAdd=Konva.Container.prototype.add;Konva.Container.prototype.add=function(child){child.parentNode=this;oldAdd.apply(this,arguments);};Konva.Container.prototype.replaceChild=function(newChild,oldChild){var index=oldChild.index;var parent=oldChild.parent;oldChild.destroy();oldChild.parentNode=null;parent.add(newChild);if(newChild.index!==index){newChild.setZIndex(index);}
parent.getLayer().batchDraw();};function createComponent(name){var ReactKonvaComponent=function ReactKonvaComponent(element){this.node=null;this.subscriptions=null;this.listeners=null;this._mountImage=null;this._renderedChildren=null;this._mostRecentlyPlacedChild=null;this._initialProps=element.props;this._currentElement=element;};ReactKonvaComponent.displayName=name;for(var i=1,l=arguments.length;i<l;i++){assign(ReactKonvaComponent.prototype,arguments[i]);}
return ReactKonvaComponent;}
var ContainerMixin=assign({},ReactMultiChild.Mixin,{moveChild:function moveChild(prevChild,lastPlacedNode,nextIndex,lastIndex){var childNode=prevChild._mountImage.node;if(childNode.index!==nextIndex){childNode.setZIndex(nextIndex);var layer=childNode.getLayer();layer&&layer.batchDraw();}},createChild:function createChild(child,afterNode,mountImage){child._mountImage=mountImage;var childNode=mountImage.node;childNode.moveTo(this.node);childNode.parentNode=this.node;if(child._mountIndex!==childNode.index){childNode.setZIndex(child._mountIndex);}
this._mostRecentlyPlacedChild=childNode;var layer=childNode.getLayer();layer&&layer.batchDraw();},removeChild:function removeChild(child,node){var layer=child._mountImage.node.getLayer();child._mountImage.node.destroy();child._mountImage.node.parentNode=null;layer&&layer.batchDraw();child._mountImage=null;},updateChildrenAtRoot:function updateChildrenAtRoot(nextChildren,transaction){this.updateChildren(nextChildren,transaction,emptyObject);},mountAndInjectChildrenAtRoot:function mountAndInjectChildrenAtRoot(children,transaction){this.mountAndInjectChildren(children,transaction,emptyObject);},updateChildren:function updateChildren(nextChildren,transaction,context){this._mostRecentlyPlacedChild=null;this._updateChildren(nextChildren,transaction,context);},mountAndInjectChildren:function mountAndInjectChildren(children,transaction,context){var mountedImages=this.mountChildren(children,transaction,context);var i=0;for(var key in this._renderedChildren){if(this._renderedChildren.hasOwnProperty(key)){var child=this._renderedChildren[key];child._mountImage=mountedImages[i];var node=mountedImages[i].node;if(!node instanceof Konva.Node){var message="Looks like one of child element is not Konva.Node."+"react-konva do not support in for now.";"if you have empty(null) child, replace it with <Group/>";console.error(message,this);continue;}
if(node.parent!==this.node){node.moveTo(this.node);}
i++;}}},mountAndAddChildren:function mountAndAddChildren(){console.log('mountAndAddChildren');}});var propsToSkip={children:true,ref:true,key:true};var NodeMixin={construct:function construct(element){this._currentElement=element;},receiveComponent:function receiveComponent(nextComponent,transaction,context){var props=nextComponent.props;var oldProps=this._currentElement.props||this._initialProps;this.applyNodeProps(oldProps,props);this.updateChildren(props.children,transaction,context);this._currentElement=nextComponent;},getPublicInstance:function getPublicInstance(){return this.node;},putEventListener:function putEventListener(type,listener){},handleEvent:function handleEvent(event){},getNativeNode:function getNativeNode(){return this.node;},applyNodeProps:function applyNodeProps(oldProps,props){var updatedProps={};var hasUpdates=false;for(var key in oldProps){if(propsToSkip[key]){continue;}
var isEvent=key.slice(0,2)==='on';var propChanged=oldProps[key]!==props[key];if(isEvent&&propChanged){var eventName=key.substr(2).toLowerCase();if(eventName.substr(0,7)==="content"){eventName="content"+eventName.substr(7,1).toUpperCase()+eventName.substr(8);}
this.node.off(eventName,oldProps[key]);}
var toRemove=!props.hasOwnProperty(key);if(toRemove){this.node.setAttr(key,undefined);}}
for(var key in props){if(propsToSkip[key]){continue;}
var isEvent=key.slice(0,2)==='on';var toAdd=oldProps[key]!==props[key];if(isEvent&&toAdd){var eventName=key.substr(2).toLowerCase();if(eventName.substr(0,7)==="content"){eventName="content"+eventName.substr(7,1).toUpperCase()+eventName.substr(8);}
this.node.on(eventName,props[key]);}
if(!isEvent&&(props[key]!==oldProps[key]||props[key]!==this.node.getAttr(key))){hasUpdates=true;updatedProps[key]=props[key];}}
if(hasUpdates){this.node.setAttrs(updatedProps);var drawingNode=this.node.getLayer()||this.node.getStage();drawingNode&&drawingNode.batchDraw();var val,prop;for(prop in updatedProps){val=updatedProps[prop];if(val instanceof Image&&!val.complete){var node=this.node;val.addEventListener('load',function(){var layer=node.getLayer();layer&&layer.batchDraw();});}}}},unmountComponent:function unmountComponent(){},mountComponentIntoNode:function mountComponentIntoNode(rootID,container){throw new Error('You cannot render an ART component standalone. '+'You need to wrap it in a Stage.');}};var Stage=React.createClass({propTypes:{width:React.PropTypes.oneOfType([React.PropTypes.number,React.PropTypes.string]),height:React.PropTypes.oneOfType([React.PropTypes.number,React.PropTypes.string])},displayName:'Stage',mixins:[ContainerMixin],componentDidMount:function componentDidMount(){this.node=new Konva.Stage({container:this.domNode,width:this.props.width,height:this.props.height});this.applyNodeProps(emptyObject,this.props);this._debugID=this._reactInternalInstance._debugID;var transaction=ReactUpdates.ReactReconcileTransaction.getPooled();transaction.perform(this.mountAndInjectChildren,this,this.props.children,transaction,ReactInstanceMap.get(this)._context);ReactUpdates.ReactReconcileTransaction.release(transaction);this.node.draw();},getStage:function getStage(){return this.node;},componentDidUpdate:function componentDidUpdate(oldProps){var node=this.node;this.applyNodeProps(oldProps,this.props);var transaction=ReactUpdates.ReactReconcileTransaction.getPooled();transaction.perform(this.updateChildren,this,this.props.children,transaction,ReactInstanceMap.get(this)._context);ReactUpdates.ReactReconcileTransaction.release(transaction);},componentWillUnmount:function componentWillUnmount(){this.unmountChildren();this.node.destroy();this.node.parentNode=null;},applyNodeProps:NodeMixin.applyNodeProps,render:function render(){var props=this.props;return React.createElement('div',{ref:function(c){return this.domNode=c;}.bind(this),className:props.className,role:props.role,style:props.style,tabIndex:props.tabIndex,title:props.title});}});var GroupMixin={mountComponent:function mountComponent(transaction,nativeParent,nativeContainerInfo,context){this.node=new Konva[this.constructor.displayName]();nativeParent.node.add(this.node);var props=this._initialProps;this.applyNodeProps(emptyObject,props);this.mountAndInjectChildren(props.children,transaction,context);return{children:[],node:this.node,html:null,text:null};},unmountComponent:function unmountComponent(){this.unmountChildren();}};var ShapeMixin={construct:function construct(element){this._currentElement=element;this._oldPath=null;},mountComponent:function mountComponent(transaction,nativeParent,nativeContainerInfo,context){this.node=new Konva[this.constructor.displayName]();if(nativeParent){nativeParent.node.add(this.node);}
this.applyNodeProps(emptyObject,this._initialProps);return{children:[],node:this.node,html:null,text:null};},receiveComponent:function receiveComponent(nextComponent,transaction,context){var props=nextComponent.props;var oldProps=this._currentElement.props||this._initialProps;this.applyNodeProps(oldProps,props);this._currentElement=nextComponent;}};var Group=createComponent('Group',NodeMixin,ContainerMixin,GroupMixin);var Layer=createComponent('Layer',NodeMixin,ContainerMixin,GroupMixin);var FastLayer=createComponent('FastLayer',NodeMixin,ContainerMixin,GroupMixin);var Label=createComponent('Label',NodeMixin,ContainerMixin,GroupMixin);var ReactKonva={Stage:Stage,Group:Group,Layer:Layer,FastLayer:FastLayer,Label:Label};var shapes=['Rect','Line','Image','Text','Label','Arrow','Shape'];shapes.forEach(function(shapeName){ReactKonva[shapeName]=createComponent(shapeName,NodeMixin,ShapeMixin);});exports.ReactKonva=ReactKonva;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(){'use strict';var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg==='undefined'?'undefined':_typeof(arg);if(argType==='string'||argType==='number'){classes.push(arg);}else if(Array.isArray(arg)){classes.push(classNames.apply(null,arg));}else if(argType==='object'){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key);}}}}
return classes.join(' ');}
if(typeof module!=='undefined'&&module.exports){module.exports=classNames;}else if(typeof define==='function'&&_typeof(define.amd)==='object'&&define.amd){define('classnames',[],function(){return classNames;});}else{window.classNames=classNames;}})();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(mod){if((typeof exports==="undefined"?"undefined":_typeof(exports))=="object"&&(typeof module==="undefined"?"undefined":_typeof(module))=="object")
module.exports=mod();else if(typeof define=="function"&&define.amd)
return define([],mod);else
(this||window).CodeMirror=mod();})(function(){"use strict";var userAgent=navigator.userAgent;var platform=navigator.platform;var gecko=/gecko\/\d/i.test(userAgent);var ie_upto10=/MSIE \d/.test(userAgent);var ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(userAgent);var ie=ie_upto10||ie_11up;var ie_version=ie&&(ie_upto10?document.documentMode||6:ie_11up[1]);var webkit=/WebKit\//.test(userAgent);var qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(userAgent);var chrome=/Chrome\//.test(userAgent);var presto=/Opera\//.test(userAgent);var safari=/Apple Computer/.test(navigator.vendor);var mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(userAgent);var phantom=/PhantomJS/.test(userAgent);var ios=/AppleWebKit/.test(userAgent)&&/Mobile\/\w+/.test(userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);var mac=ios||/Mac/.test(platform);var windows=/win/i.test(platform);var presto_version=presto&&userAgent.match(/Version\/(\d*\.\d*)/);if(presto_version)presto_version=Number(presto_version[1]);if(presto_version&&presto_version>=15){presto=false;webkit=true;}
var flipCtrlCmd=mac&&(qtwebkit||presto&&(presto_version==null||presto_version<12.11));var captureRightClick=gecko||ie&&ie_version>=9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options?copyObj(options):{};copyObj(defaults,options,false);setGuttersForLineNumbers(options);var doc=options.value;if(typeof doc=="string")doc=new Doc(doc,options.mode,null,options.lineSeparator);this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this);var display=this.display=new Display(place,doc,input);display.wrapper.CodeMirror=this;updateGutters(this);themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=" CodeMirror-wrap";if(options.autofocus&&!mobile)display.input.focus();initScrollbars(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new Delayed(),keySeq:null,specialChars:null};var cm=this;if(ie&&ie_version<11)setTimeout(function(){cm.display.input.reset(true);},20);registerEventHandlers(this);ensureGlobalHandlers();startOperation(this);this.curOp.forceUpdate=true;attachDoc(this,doc);if(options.autofocus&&!mobile||cm.hasFocus())setTimeout(bind(onFocus,this),20);else onBlur(this);for(var opt in optionHandlers){if(optionHandlers.hasOwnProperty(opt))optionHandlers[opt](this,options[opt],Init);}maybeUpdateLineNumberWidth(this);if(options.finishInit)options.finishInit(this);for(var i=0;i<initHooks.length;++i){initHooks[i](this);}endOperation(this);if(webkit&&options.lineWrapping&&getComputedStyle(display.lineDiv).textRendering=="optimizelegibility")display.lineDiv.style.textRendering="auto";}
function Display(place,doc,input){var d=this;this.input=input;d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler");d.scrollbarFiller.setAttribute("cm-not-content","true");d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler");d.gutterFiller.setAttribute("cm-not-content","true");d.lineDiv=elt("div",null,"CodeMirror-code");d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1");d.cursorDiv=elt("div",null,"CodeMirror-cursors");d.measure=elt("div",null,"CodeMirror-measure");d.lineMeasure=elt("div",null,"CodeMirror-measure");d.lineSpace=elt("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none");d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative");d.sizer=elt("div",[d.mover],"CodeMirror-sizer");d.sizerWidth=null;d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;");d.gutters=elt("div",null,"CodeMirror-gutters");d.lineGutter=null;d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll");d.scroller.setAttribute("tabIndex","-1");d.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror");if(ie&&ie_version<8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0;}if(!webkit&&!(gecko&&mobile))d.scroller.draggable=true;if(place){if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper);}
d.viewFrom=d.viewTo=doc.first;d.reportedViewFrom=d.reportedViewTo=doc.first;d.view=[];d.renderedView=null;d.externalMeasured=null;d.viewOffset=0;d.lastWrapHeight=d.lastWrapWidth=0;d.updateLineNumbers=null;d.nativeBarWidth=d.barHeight=d.barWidth=0;d.scrollbarsClipped=false;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.alignWidgets=false;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;d.shift=false;d.selForContextMenu=null;d.activeTouch=null;input.init(d);}
function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);resetModeState(cm);}function resetModeState(cm){cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm);}function wrappingChanged(cm){if(cm.options.lineWrapping){addClass(cm.display.wrapper,"CodeMirror-wrap");cm.display.sizer.style.minWidth="";cm.display.sizerWidth=null;}else{rmClass(cm.display.wrapper,"CodeMirror-wrap");findMaxLine(cm);}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm);},100);}
function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;var widgetsHeight=0;if(line.widgets)for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].height)widgetsHeight+=line.widgets[i].height;}if(wrapping)return widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th;else return widgetsHeight+th;};}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight);});}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-");clearCaches(cm);}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){alignHorizontally(cm);},20);}
function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));if(gutterClass=="CodeMirror-linenumbers"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+"px";}}gutters.style.display=i?"":"none";updateGutterSpace(cm);}function updateGutterSpace(cm){var width=cm.display.gutters.offsetWidth;cm.display.sizer.style.marginLeft=width+"px";}
function lineLength(line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find(0,true);cur=found.from.line;len+=found.from.ch-found.to.ch;}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find(0,true);len-=cur.text.length-found.from.ch;cur=found.to.line;len+=cur.text.length-found.to.ch;}return len;}
function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line;}});}
function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");if(found==-1&&options.lineNumbers){options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]);}else if(found>-1&&!options.lineNumbers){options.gutters=options.gutters.slice(0);options.gutters.splice(found,1);}}
function measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth;var docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW};}function NativeScrollbars(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");place(vert);place(horiz);on(vert,"scroll",function(){if(vert.clientHeight)scroll(vert.scrollTop,"vertical");});on(horiz,"scroll",function(){if(horiz.clientWidth)scroll(horiz.scrollLeft,"horizontal");});this.checkedZeroWidth=false;if(ie&&ie_version<8)this.horiz.style.minHeight=this.vert.style.minWidth="18px";}NativeScrollbars.prototype=copyObj({update:function update(measure){var needsH=measure.scrollWidth>measure.clientWidth+1;var needsV=measure.scrollHeight>measure.clientHeight+1;var sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block";this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);this.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px";}else{this.vert.style.display="";this.vert.firstChild.style.height="0";}if(needsH){this.horiz.style.display="block";this.horiz.style.right=needsV?sWidth+"px":"0";this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=measure.scrollWidth-measure.clientWidth+totalWidth+"px";}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0";}if(!this.checkedZeroWidth&&measure.clientHeight>0){if(sWidth==0)this.zeroWidthHack();this.checkedZeroWidth=true;}return{right:needsV?sWidth:0,bottom:needsH?sWidth:0};},setScrollLeft:function setScrollLeft(pos){if(this.horiz.scrollLeft!=pos)this.horiz.scrollLeft=pos;if(this.disableHoriz)this.enableZeroWidthBar(this.horiz,this.disableHoriz);},setScrollTop:function setScrollTop(pos){if(this.vert.scrollTop!=pos)this.vert.scrollTop=pos;if(this.disableVert)this.enableZeroWidthBar(this.vert,this.disableVert);},zeroWidthHack:function zeroWidthHack(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=w;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new Delayed();this.disableVert=new Delayed();},enableZeroWidthBar:function enableZeroWidthBar(bar,delay){bar.style.pointerEvents="auto";function maybeDisable(){var box=bar.getBoundingClientRect();var elt=document.elementFromPoint(box.left+1,box.bottom-1);if(elt!=bar)bar.style.pointerEvents="none";else delay.set(1000,maybeDisable);}delay.set(1000,maybeDisable);},clear:function clear(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz);parent.removeChild(this.vert);}},NativeScrollbars.prototype);function NullScrollbars(){}NullScrollbars.prototype=copyObj({update:function update(){return{bottom:0,right:0};},setScrollLeft:function setScrollLeft(){},setScrollTop:function setScrollTop(){},clear:function clear(){}},NullScrollbars.prototype);CodeMirror.scrollbarModel={"native":NativeScrollbars,"null":NullScrollbars};function initScrollbars(cm){if(cm.display.scrollbars){cm.display.scrollbars.clear();if(cm.display.scrollbars.addClass)rmClass(cm.display.wrapper,cm.display.scrollbars.addClass);}cm.display.scrollbars=new CodeMirror.scrollbarModel[cm.options.scrollbarStyle](function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller);on(node,"mousedown",function(){if(cm.state.focused)setTimeout(function(){cm.display.input.focus();},0);});node.setAttribute("cm-not-content","true");},function(pos,axis){if(axis=="horizontal")setScrollLeft(cm,pos);else setScrollTop(cm,pos);},cm);if(cm.display.scrollbars.addClass)addClass(cm.display.wrapper,cm.display.scrollbars.addClass);}function updateScrollbars(cm,measure){if(!measure)measure=measureForScrollbars(cm);var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;i<4&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++){if(startWidth!=cm.display.barWidth&&cm.options.lineWrapping)updateHeightsInViewport(cm);updateScrollbarsInner(cm,measureForScrollbars(cm));startWidth=cm.display.barWidth;startHeight=cm.display.barHeight;}}
function updateScrollbarsInner(cm,measure){var d=cm.display;var sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px";d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px";if(sizes.right&&sizes.bottom){d.scrollbarFiller.style.display="block";d.scrollbarFiller.style.height=sizes.bottom+"px";d.scrollbarFiller.style.width=sizes.right+"px";}else d.scrollbarFiller.style.display="";if(sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display="block";d.gutterFiller.style.height=sizes.bottom+"px";d.gutterFiller.style.width=measure.gutterWidth+"px";}else d.gutterFiller.style.display="";}
function visibleLines(display,doc,viewport){var top=viewport&&viewport.top!=null?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&viewport.bottom!=null?viewport.bottom:top+display.wrapper.clientHeight;var from=_lineAtHeight(doc,top),to=_lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;if(ensureFrom<from){from=ensureFrom;to=_lineAtHeight(doc,_heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight);}else if(Math.min(ensureTo,doc.lastLine())>=to){from=_lineAtHeight(doc,_heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight);to=ensureTo;}}return{from:from,to:Math.max(to,from+1)};}
function alignHorizontally(cm){var display=cm.display,view=display.view;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,left=comp+"px";for(var i=0;i<view.length;i++){if(!view[i].hidden){if(cm.options.fixedGutter&&view[i].gutter)view[i].gutter.style.left=left;var align=view[i].alignable;if(align)for(var j=0;j<align.length;j++){align[j].style.left=left;}}}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+"px";}
function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width="";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1;display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+"px";updateGutterSpace(cm);return true;}return false;}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber));}
function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left;}
function DisplayUpdate(cm,viewport,force){var display=cm.display;this.viewport=viewport;this.visible=visibleLines(display,cm.doc,viewport);this.editorIsHidden=!display.wrapper.offsetWidth;this.wrapperHeight=display.wrapper.clientHeight;this.wrapperWidth=display.wrapper.clientWidth;this.oldDisplayWidth=displayWidth(cm);this.force=force;this.dims=getDimensions(cm);this.events=[];}DisplayUpdate.prototype.signal=function(emitter,type){if(hasHandler(emitter,type))this.events.push(arguments);};DisplayUpdate.prototype.finish=function(){for(var i=0;i<this.events.length;i++){signal.apply(null,this.events[i]);}};function maybeClipScrollbars(cm){var display=cm.display;if(!display.scrollbarsClipped&&display.scroller.offsetWidth){display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth;display.heightForcer.style.height=scrollGap(cm)+"px";display.sizer.style.marginBottom=-display.nativeBarWidth+"px";display.sizer.style.borderRightWidth=scrollGap(cm)+"px";display.scrollbarsClipped=true;}}
function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden){resetView(cm);return false;}
if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&countDirtyView(cm)==0)return false;if(maybeUpdateLineNumberWidth(cm)){resetView(cm);update.dims=getDimensions(cm);}
var end=doc.first+doc.size;var from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,update.visible.to+cm.options.viewportMargin);if(display.viewFrom<from&&from-display.viewFrom<20)from=Math.max(doc.first,display.viewFrom);if(display.viewTo>to&&display.viewTo-to<20)to=Math.min(end,display.viewTo);if(sawCollapsedSpans){from=visualLineNo(cm.doc,from);to=visualLineEndNo(cm.doc,to);}var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to);display.viewOffset=_heightAtLine(getLine(cm.doc,display.viewFrom));cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&toUpdate==0&&!update.force&&display.renderedView==display.view&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo))return false;var focused=activeElt();if(toUpdate>4)display.lineDiv.style.display="none";patchDisplay(cm,display.updateLineNumbers,update.dims);if(toUpdate>4)display.lineDiv.style.display="";display.renderedView=display.view;if(focused&&activeElt()!=focused&&focused.offsetHeight)focused.focus();removeChildren(display.cursorDiv);removeChildren(display.selectionDiv);display.gutters.style.height=display.sizer.style.minHeight=0;if(different){display.lastWrapHeight=update.wrapperHeight;display.lastWrapWidth=update.wrapperWidth;startWorker(cm,400);}display.updateLineNumbers=null;return true;}function postUpdateDisplay(cm,update){var viewport=update.viewport;for(var first=true;;first=false){if(!first||!cm.options.lineWrapping||update.oldDisplayWidth==displayWidth(cm)){if(viewport&&viewport.top!=null)viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)};update.visible=visibleLines(cm.display,cm.doc,viewport);if(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo)break;}if(!updateDisplayIfNeeded(cm,update))break;updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm);setDocumentHeight(cm,barMeasure);updateScrollbars(cm,barMeasure);}update.signal(cm,"update",cm);if(cm.display.viewFrom!=cm.display.reportedViewFrom||cm.display.viewTo!=cm.display.reportedViewTo){update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo);cm.display.reportedViewFrom=cm.display.viewFrom;cm.display.reportedViewTo=cm.display.viewTo;}}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm);postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm);setDocumentHeight(cm,barMeasure);updateScrollbars(cm,barMeasure);update.finish();}}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px";var total=measure.docHeight+cm.display.barHeight;cm.display.heightForcer.style.top=total+"px";cm.display.gutters.style.height=Math.max(total+scrollGap(cm),measure.clientHeight)+"px";}
function updateHeightsInViewport(cm){var display=cm.display;var prevBottom=display.lineDiv.offsetTop;for(var i=0;i<display.view.length;i++){var cur=display.view[i],height;if(cur.hidden)continue;if(ie&&ie_version<8){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom;prevBottom=bot;}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top;}var diff=cur.line.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(cur.line,height);updateWidgetHeight(cur.line);if(cur.rest)for(var j=0;j<cur.rest.length;j++){updateWidgetHeight(cur.rest[j]);}}}}
function updateWidgetHeight(line){if(line.widgets)for(var i=0;i<line.widgets.length;++i){line.widgets[i].height=line.widgets[i].node.parentNode.offsetHeight;}}
function getDimensions(cm){var d=cm.display,left={},width={};var gutterLeft=d.gutters.clientLeft;for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft+n.clientLeft+gutterLeft;width[cm.options.gutters[i]]=n.clientWidth;}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth};}
function patchDisplay(cm,updateNumbersFrom,dims){var display=cm.display,lineNumbers=cm.options.lineNumbers;var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node)node.style.display="none";else node.parentNode.removeChild(node);return next;}var view=display.view,lineN=display.viewFrom;for(var i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden){}else if(!lineView.node||lineView.node.parentNode!=container){var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur);}else{while(cur!=lineView.node){cur=rm(cur);}var updateNumber=lineNumbers&&updateNumbersFrom!=null&&updateNumbersFrom<=lineN&&lineView.lineNumber;if(lineView.changes){if(indexOf(lineView.changes,"gutter")>-1)updateNumber=false;updateLineForChanges(cm,lineView,lineN,dims);}if(updateNumber){removeChildren(lineView.lineNumber);lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)));}cur=lineView.node.nextSibling;}lineN+=lineView.size;}while(cur){cur=rm(cur);}}
function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];if(type=="text")updateLineText(cm,lineView);else if(type=="gutter")updateLineGutter(cm,lineView,lineN,dims);else if(type=="class")updateLineClasses(lineView);else if(type=="widget")updateLineWidgets(cm,lineView,dims);}lineView.changes=null;}
function ensureLineWrapped(lineView){if(lineView.node==lineView.text){lineView.node=elt("div",null,null,"position: relative");if(lineView.text.parentNode)lineView.text.parentNode.replaceChild(lineView.node,lineView.text);lineView.node.appendChild(lineView.text);if(ie&&ie_version<8)lineView.node.style.zIndex=2;}return lineView.node;}function updateLineBackground(lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls)cls+=" CodeMirror-linebackground";if(lineView.background){if(cls)lineView.background.className=cls;else{lineView.background.parentNode.removeChild(lineView.background);lineView.background=null;}}else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild);}}
function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;if(ext&&ext.line==lineView.line){cm.display.externalMeasured=null;lineView.measure=ext.measure;return ext.built;}return buildLineContent(cm,lineView);}
function updateLineText(cm,lineView){var cls=lineView.text.className;var built=getLineContent(cm,lineView);if(lineView.text==lineView.node)lineView.node=built.pre;lineView.text.parentNode.replaceChild(built.pre,lineView.text);lineView.text=built.pre;if(built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass){lineView.bgClass=built.bgClass;lineView.textClass=built.textClass;updateLineClasses(lineView);}else if(cls){lineView.text.className=cls;}}function updateLineClasses(lineView){updateLineBackground(lineView);if(lineView.line.wrapClass)ensureLineWrapped(lineView).className=lineView.line.wrapClass;else if(lineView.node!=lineView.text)lineView.node.className="";var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||"";}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter){lineView.node.removeChild(lineView.gutter);lineView.gutter=null;}if(lineView.gutterBackground){lineView.node.removeChild(lineView.gutterBackground);lineView.gutterBackground=null;}if(lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px");wrap.insertBefore(lineView.gutterBackground,lineView.text);}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap=ensureLineWrapped(lineView);var gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");cm.display.input.setUneditable(gutterWrap);wrap.insertBefore(gutterWrap,lineView.text);if(lineView.line.gutterClass)gutterWrap.className+=" "+lineView.line.gutterClass;if(cm.options.lineNumbers&&(!markers||!markers["CodeMirror-linenumbers"]))lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"));}}}function updateLineWidgets(cm,lineView,dims){if(lineView.alignable)lineView.alignable=null;for(var node=lineView.node.firstChild,next;node;node=next){var next=node.nextSibling;if(node.className=="CodeMirror-linewidget")lineView.node.removeChild(node);}insertLineWidgets(cm,lineView,dims);}
function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);lineView.text=lineView.node=built.pre;if(built.bgClass)lineView.bgClass=built.bgClass;if(built.textClass)lineView.textClass=built.textClass;updateLineClasses(lineView);updateLineGutter(cm,lineView,lineN,dims);insertLineWidgets(cm,lineView,dims);return lineView.node;}
function insertLineWidgets(cm,lineView,dims){insertLineWidgetsFor(cm,lineView.line,lineView,dims,true);if(lineView.rest)for(var i=0;i<lineView.rest.length;i++){insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,false);}}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(!line.widgets)return;var wrap=ensureLineWrapped(lineView);for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");if(!widget.handleMouseEvents)node.setAttribute("cm-ignore-events","true");positionLineWidget(widget,node,lineView,dims);cm.display.input.setUneditable(node);if(allowAbove&&widget.above)wrap.insertBefore(node,lineView.gutter||lineView.text);else wrap.appendChild(node);signalLater(widget,"redraw");}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+"px";}node.style.width=width+"px";}if(widget.coverGutter){node.style.zIndex=5;node.style.position="relative";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+"px";}}
var Pos=CodeMirror.Pos=function(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch;};var cmp=CodeMirror.cmpPos=function(a,b){return a.line-b.line||a.ch-b.ch;};function copyPos(x){return Pos(x.line,x.ch);}function maxPos(a,b){return cmp(a,b)<0?b:a;}function minPos(a,b){return cmp(a,b)<0?a:b;}
function ensureFocus(cm){if(!cm.state.focused){cm.display.input.focus();onFocus(cm);}}
var lastCopied=null;function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=false;if(!sel)sel=doc.sel;var paste=cm.state.pasteIncoming||origin=="paste";var textLines=doc.splitLines(inserted),multiPaste=null;if(paste&&sel.ranges.length>1){if(lastCopied&&lastCopied.join("\n")==inserted){if(sel.ranges.length%lastCopied.length==0){multiPaste=[];for(var i=0;i<lastCopied.length;i++){multiPaste.push(doc.splitLines(lastCopied[i]));}}}else if(textLines.length==sel.ranges.length){multiPaste=map(textLines,function(l){return[l];});}}
for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];var from=range.from(),to=range.to();if(range.empty()){if(deleted&&deleted>0)
from=Pos(from.line,from.ch-deleted);else if(cm.state.overwrite&&!paste)
to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length));}var updateInput=cm.curOp.updateInput;var changeEvent={from:from,to:to,text:multiPaste?multiPaste[i%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming?"cut":"+input")};makeChange(cm.doc,changeEvent);signalLater(cm,"inputRead",cm,changeEvent);}if(inserted&&!paste)triggerElectric(cm,inserted);ensureCursorVisible(cm);cm.curOp.updateInput=updateInput;cm.curOp.typing=true;cm.state.pasteIncoming=cm.state.cutIncoming=false;}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("text/plain");if(pasted){e.preventDefault();if(!cm.isReadOnly()&&!cm.options.disableInput)runInOp(cm,function(){applyTextInput(cm,pasted,0,null,"paste");});return true;}}function triggerElectric(cm,inserted){if(!cm.options.electricChars||!cm.options.smartIndent)return;var sel=cm.doc.sel;for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line)continue;var mode=cm.getModeAt(range.head);var indented=false;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++){if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break;}}}else if(mode.electricInput){if(mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch)))indented=indentLine(cm,range.head.line,"smart");}if(indented)signalLater(cm,"electricInput",cm,range.head.line);}}function copyableRanges(cm){var text=[],ranges=[];for(var i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line;var lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange);text.push(cm.getRange(lineRange.anchor,lineRange.head));}return{text:text,ranges:ranges};}function disableBrowserMagic(field){field.setAttribute("autocorrect","off");field.setAttribute("autocapitalize","off");field.setAttribute("spellcheck","false");}
function TextareaInput(cm){this.cm=cm;this.prevInput="";this.pollingFast=false;this.polling=new Delayed();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null;};function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(webkit)te.style.width="1000px";else te.setAttribute("wrap","off");if(ios)te.style.border="1px solid black";disableBrowserMagic(te);return div;}TextareaInput.prototype=copyObj({init:function init(display){var input=this,cm=this.cm;var div=this.wrapper=hiddenTextarea();var te=this.textarea=div.firstChild;display.wrapper.insertBefore(div,display.wrapper.firstChild);if(ios)te.style.width="0px";on(te,"input",function(){if(ie&&ie_version>=9&&input.hasSelection)input.hasSelection=null;input.poll();});on(te,"paste",function(e){if(signalDOMEvent(cm,e)||handlePaste(e,cm))return;cm.state.pasteIncoming=true;input.fastPoll();});function prepareCopyCut(e){if(signalDOMEvent(cm,e))return;if(cm.somethingSelected()){lastCopied=cm.getSelections();if(input.inaccurateSelection){input.prevInput="";input.inaccurateSelection=false;te.value=lastCopied.join("\n");selectInput(te);}}else if(!cm.options.lineWiseCopyCut){return;}else{var ranges=copyableRanges(cm);lastCopied=ranges.text;if(e.type=="cut"){cm.setSelections(ranges.ranges,null,sel_dontScroll);}else{input.prevInput="";te.value=ranges.text.join("\n");selectInput(te);}}if(e.type=="cut")cm.state.cutIncoming=true;}on(te,"cut",prepareCopyCut);on(te,"copy",prepareCopyCut);on(display.scroller,"paste",function(e){if(eventInWidget(display,e)||signalDOMEvent(cm,e))return;cm.state.pasteIncoming=true;input.focus();});on(display.lineSpace,"selectstart",function(e){if(!eventInWidget(display,e))e_preventDefault(e);});on(te,"compositionstart",function(){var start=cm.getCursor("from");if(input.composing)input.composing.range.clear();input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})};});on(te,"compositionend",function(){if(input.composing){input.poll();input.composing.range.clear();input.composing=null;}});},prepareSelection:function prepareSelection(){var cm=this.cm,display=cm.display,doc=cm.doc;var result=_prepareSelection(cm);if(cm.options.moveInputWithCursor){var headPos=_cursorCoords(cm,doc.sel.primary().head,"div");var wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top));result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left));}return result;},showSelection:function showSelection(drawn){var cm=this.cm,display=cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors);removeChildrenAndAdd(display.selectionDiv,drawn.selection);if(drawn.teTop!=null){this.wrapper.style.top=drawn.teTop+"px";this.wrapper.style.left=drawn.teLeft+"px";}},reset:function reset(typing){if(this.contextMenuPending)return;var minimal,selected,cm=this.cm,doc=cm.doc;if(cm.somethingSelected()){this.prevInput="";var range=doc.sel.primary();minimal=hasCopyEvent&&(range.to().line-range.from().line>100||(selected=cm.getSelection()).length>1000);var content=minimal?"-":selected||cm.getSelection();this.textarea.value=content;if(cm.state.focused)selectInput(this.textarea);if(ie&&ie_version>=9)this.hasSelection=content;}else if(!typing){this.prevInput=this.textarea.value="";if(ie&&ie_version>=9)this.hasSelection=null;}this.inaccurateSelection=minimal;},getField:function getField(){return this.textarea;},supportsTouch:function supportsTouch(){return false;},focus:function focus(){if(this.cm.options.readOnly!="nocursor"&&(!mobile||activeElt()!=this.textarea)){try{this.textarea.focus();}catch(e){}}},blur:function blur(){this.textarea.blur();},resetPosition:function resetPosition(){this.wrapper.style.top=this.wrapper.style.left=0;},receivedFocus:function receivedFocus(){this.slowPoll();},slowPoll:function slowPoll(){var input=this;if(input.pollingFast)return;input.polling.set(this.cm.options.pollInterval,function(){input.poll();if(input.cm.state.focused)input.slowPoll();});},fastPoll:function fastPoll(){var missed=false,input=this;input.pollingFast=true;function p(){var changed=input.poll();if(!changed&&!missed){missed=true;input.polling.set(60,p);}else{input.pollingFast=false;input.slowPoll();}}input.polling.set(20,p);},poll:function poll(){var cm=this.cm,input=this.textarea,prevInput=this.prevInput;if(this.contextMenuPending||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||cm.isReadOnly()||cm.options.disableInput||cm.state.keySeq)return false;var text=input.value;if(text==prevInput&&!cm.somethingSelected())return false;if(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text)){cm.display.input.reset();return false;}if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(first==0x200b&&!prevInput)prevInput="\u200B";if(first==0x21da){this.reset();return this.cm.execCommand("undo");}}
var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same)){++same;}var self=this;runInOp(cm,function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,self.composing?"*compose":null);if(text.length>1000||text.indexOf("\n")>-1)input.value=self.prevInput="";else self.prevInput=text;if(self.composing){self.composing.range.clear();self.composing.range=cm.markText(self.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"});}});return true;},ensurePolled:function ensurePolled(){if(this.pollingFast&&this.poll())this.pollingFast=false;},onKeyPress:function onKeyPress(){if(ie&&ie_version>=9)this.hasSelection=null;this.fastPoll();},onContextMenu:function onContextMenu(e){var input=this,cm=input.cm,display=cm.display,te=input.textarea;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||presto)return;var reset=cm.options.resetSelectionOnContextMenu;if(reset&&cm.doc.sel.contains(pos)==-1)operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);var oldCSS=te.style.cssText;input.wrapper.style.position="absolute";te.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(webkit)var oldScrollY=window.scrollY;display.input.focus();if(webkit)window.scrollTo(null,oldScrollY);display.input.reset();if(!cm.somethingSelected())te.value=input.prevInput=" ";input.contextMenuPending=true;display.selForContextMenu=cm.doc.sel;clearTimeout(display.detectingSelectAll);function prepareSelectAllHack(){if(te.selectionStart!=null){var selected=cm.somethingSelected();var extval="\u200B"+(selected?te.value:"");te.value="\u21DA";te.value=extval;input.prevInput=selected?"":"\u200B";te.selectionStart=1;te.selectionEnd=extval.length;display.selForContextMenu=cm.doc.sel;}}function rehide(){input.contextMenuPending=false;input.wrapper.style.position="relative";te.style.cssText=oldCSS;if(ie&&ie_version<9)display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos);if(te.selectionStart!=null){if(!ie||ie&&ie_version<9)prepareSelectAllHack();var i=0,poll=function poll(){if(display.selForContextMenu==cm.doc.sel&&te.selectionStart==0&&te.selectionEnd>0&&input.prevInput=="\u200B")operation(cm,commands.selectAll)(cm);else if(i++<10)display.detectingSelectAll=setTimeout(poll,500);else display.input.reset();};display.detectingSelectAll=setTimeout(poll,200);}}if(ie&&ie_version>=9)prepareSelectAllHack();if(captureRightClick){e_stop(e);var mouseup=function mouseup(){off(window,"mouseup",mouseup);setTimeout(rehide,20);};on(window,"mouseup",mouseup);}else{setTimeout(rehide,50);}},readOnlyChanged:function readOnlyChanged(val){if(!val)this.reset();},setUneditable:nothing,needsContentAttribute:false},TextareaInput.prototype);function ContentEditableInput(cm){this.cm=cm;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new Delayed();this.gracePeriod=false;}ContentEditableInput.prototype=copyObj({init:function init(display){var input=this,cm=input.cm;var div=input.div=display.lineDiv;disableBrowserMagic(div);on(div,"paste",function(e){if(!signalDOMEvent(cm,e))handlePaste(e,cm);});on(div,"compositionstart",function(e){var data=e.data;input.composing={sel:cm.doc.sel,data:data,startData:data};if(!data)return;var prim=cm.doc.sel.primary();var line=cm.getLine(prim.head.line);var found=line.indexOf(data,Math.max(0,prim.head.ch-data.length));if(found>-1&&found<=prim.head.ch)input.composing.sel=simpleSelection(Pos(prim.head.line,found),Pos(prim.head.line,found+data.length));});on(div,"compositionupdate",function(e){input.composing.data=e.data;});on(div,"compositionend",function(e){var ours=input.composing;if(!ours)return;if(e.data!=ours.startData&&!/\u200b/.test(e.data))ours.data=e.data;setTimeout(function(){if(!ours.handled)input.applyComposition(ours);if(input.composing==ours)input.composing=null;},50);});on(div,"touchstart",function(){input.forceCompositionEnd();});on(div,"input",function(){if(input.composing)return;if(cm.isReadOnly()||!input.pollContent())runInOp(input.cm,function(){regChange(cm);});});function onCopyCut(e){if(signalDOMEvent(cm,e))return;if(cm.somethingSelected()){lastCopied=cm.getSelections();if(e.type=="cut")cm.replaceSelection("",null,"cut");}else if(!cm.options.lineWiseCopyCut){return;}else{var ranges=copyableRanges(cm);lastCopied=ranges.text;if(e.type=="cut"){cm.operation(function(){cm.setSelections(ranges.ranges,0,sel_dontScroll);cm.replaceSelection("",null,"cut");});}}
if(e.clipboardData&&!ios){e.preventDefault();e.clipboardData.clearData();e.clipboardData.setData("text/plain",lastCopied.join("\n"));}else{var kludge=hiddenTextarea(),te=kludge.firstChild;cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild);te.value=lastCopied.join("\n");var hadFocus=document.activeElement;selectInput(te);setTimeout(function(){cm.display.lineSpace.removeChild(kludge);hadFocus.focus();},50);}}on(div,"copy",onCopyCut);on(div,"cut",onCopyCut);},prepareSelection:function prepareSelection(){var result=_prepareSelection(this.cm,false);result.focus=this.cm.state.focused;return result;},showSelection:function showSelection(info){if(!info||!this.cm.display.view.length)return;if(info.focus)this.showPrimarySelection();this.showMultipleSelections(info);},showPrimarySelection:function showPrimarySelection(){var sel=window.getSelection(),prim=this.cm.doc.sel.primary();var curAnchor=domToPos(this.cm,sel.anchorNode,sel.anchorOffset);var curFocus=domToPos(this.cm,sel.focusNode,sel.focusOffset);if(curAnchor&&!curAnchor.bad&&curFocus&&!curFocus.bad&&cmp(minPos(curAnchor,curFocus),prim.from())==0&&cmp(maxPos(curAnchor,curFocus),prim.to())==0)return;var start=posToDOM(this.cm,prim.from());var end=posToDOM(this.cm,prim.to());if(!start&&!end)return;var view=this.cm.display.view;var old=sel.rangeCount&&sel.getRangeAt(0);if(!start){start={node:view[0].measure.map[2],offset:0};}else if(!end){var measure=view[view.length-1].measure;var map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]};}try{var rng=range(start.node,start.offset,end.offset,end.node);}catch(e){}
if(rng){if(!gecko&&this.cm.state.focused){sel.collapse(start.node,start.offset);if(!rng.collapsed)sel.addRange(rng);}else{sel.removeAllRanges();sel.addRange(rng);}if(old&&sel.anchorNode==null)sel.addRange(old);else if(gecko)this.startGracePeriod();}this.rememberSelection();},startGracePeriod:function startGracePeriod(){var input=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){input.gracePeriod=false;if(input.selectionChanged())input.cm.operation(function(){input.cm.curOp.selectionChanged=true;});},20);},showMultipleSelections:function showMultipleSelections(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors);removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection);},rememberSelection:function rememberSelection(){var sel=window.getSelection();this.lastAnchorNode=sel.anchorNode;this.lastAnchorOffset=sel.anchorOffset;this.lastFocusNode=sel.focusNode;this.lastFocusOffset=sel.focusOffset;},selectionInEditor:function selectionInEditor(){var sel=window.getSelection();if(!sel.rangeCount)return false;var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node);},focus:function focus(){if(this.cm.options.readOnly!="nocursor")this.div.focus();},blur:function blur(){this.div.blur();},getField:function getField(){return this.div;},supportsTouch:function supportsTouch(){return true;},receivedFocus:function receivedFocus(){var input=this;if(this.selectionInEditor())this.pollSelection();else runInOp(this.cm,function(){input.cm.curOp.selectionChanged=true;});function poll(){if(input.cm.state.focused){input.pollSelection();input.polling.set(input.cm.options.pollInterval,poll);}}this.polling.set(this.cm.options.pollInterval,poll);},selectionChanged:function selectionChanged(){var sel=window.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset;},pollSelection:function pollSelection(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var sel=window.getSelection(),cm=this.cm;this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset);var head=domToPos(cm,sel.focusNode,sel.focusOffset);if(anchor&&head)runInOp(cm,function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll);if(anchor.bad||head.bad)cm.curOp.selectionChanged=true;});}},pollContent:function pollContent(){var cm=this.cm,display=cm.display,sel=cm.doc.sel.primary();var from=sel.from(),to=sel.to();if(from.line<display.viewFrom||to.line>display.viewTo-1)return false;var fromIndex;if(from.line==display.viewFrom||(fromIndex=findViewIndex(cm,from.line))==0){var fromLine=lineNo(display.view[0].line);var fromNode=display.view[0].node;}else{var fromLine=lineNo(display.view[fromIndex].line);var fromNode=display.view[fromIndex-1].node.nextSibling;}var toIndex=findViewIndex(cm,to.line);if(toIndex==display.view.length-1){var toLine=display.viewTo-1;var toNode=display.lineDiv.lastChild;}else{var toLine=lineNo(display.view[toIndex+1].line)-1;var toNode=display.view[toIndex+1].node.previousSibling;}var newText=cm.doc.splitLines(domTextBetween(cm,fromNode,toNode,fromLine,toLine));var oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));while(newText.length>1&&oldText.length>1){if(lst(newText)==lst(oldText)){newText.pop();oldText.pop();toLine--;}else if(newText[0]==oldText[0]){newText.shift();oldText.shift();fromLine++;}else break;}var cutFront=0,cutEnd=0;var newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);while(cutFront<maxCutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront)){++cutFront;}var newBot=lst(newText),oldBot=lst(oldText);var maxCutEnd=Math.min(newBot.length-(newText.length==1?cutFront:0),oldBot.length-(oldText.length==1?cutFront:0));while(cutEnd<maxCutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1)){++cutEnd;}newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd);newText[0]=newText[0].slice(cutFront);var chFrom=Pos(fromLine,cutFront);var chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);if(newText.length>1||newText[0]||cmp(chFrom,chTo)){_replaceRange(cm.doc,newText,chFrom,chTo,"+input");return true;}},ensurePolled:function ensurePolled(){this.forceCompositionEnd();},reset:function reset(){this.forceCompositionEnd();},forceCompositionEnd:function forceCompositionEnd(){if(!this.composing||this.composing.handled)return;this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus();},applyComposition:function applyComposition(composing){if(this.cm.isReadOnly())operation(this.cm,regChange)(this.cm);else if(composing.data&&composing.data!=composing.startData)operation(this.cm,applyTextInput)(this.cm,composing.data,0,composing.sel);},setUneditable:function setUneditable(node){node.contentEditable="false";},onKeyPress:function onKeyPress(e){e.preventDefault();if(!this.cm.isReadOnly())operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0);},readOnlyChanged:function readOnlyChanged(val){this.div.contentEditable=String(val!="nocursor");},onContextMenu:nothing,resetPosition:nothing,needsContentAttribute:true},ContentEditableInput.prototype);function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden)return null;var line=getLine(cm.doc,pos.line);var info=mapFromLineView(view,line,pos.line);var order=getOrder(line),side="left";if(order){var partPos=getBidiPartAt(order,pos.ch);side=partPos%2?"right":"left";}var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);result.offset=result.collapse=="right"?result.end:result.start;return result;}function badPos(pos,bad){if(bad)pos.bad=true;return pos;}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){lineNode=cm.display.lineDiv.childNodes[offset];if(!lineNode)return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),true);node=null;offset=0;}else{for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv)return null;if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv)break;}}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode)return locateNodeInLineView(lineView,node,offset);}}function locateNodeInLineView(lineView,node,offset){var wrapper=lineView.text.firstChild,bad=false;if(!node||!contains(wrapper,node))return badPos(Pos(lineNo(lineView.line),0),true);if(node==wrapper){bad=true;node=wrapper.childNodes[offset];offset=0;if(!node){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad);}}var textNode=node.nodeType==3?node:null,topNode=node;if(!textNode&&node.childNodes.length==1&&node.firstChild.nodeType==3){textNode=node.firstChild;if(offset)offset=textNode.nodeValue.length;}while(topNode.parentNode!=wrapper){topNode=topNode.parentNode;}var measure=lineView.measure,maps=measure.maps;function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++){var map=i<0?measure.map:maps[i];for(var j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(i<0?lineView.line:lineView.rest[i]);var ch=map[j]+offset;if(offset<0||curNode!=textNode)ch=map[j+(offset?1:0)];return Pos(line,ch);}}}}var found=find(textNode,topNode,offset);if(found)return badPos(found,bad);for(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){found=find(after,after.firstChild,0);if(found)return badPos(Pos(found.line,found.ch-dist),bad);else dist+=after.textContent.length;}for(var before=topNode.previousSibling,dist=offset;before;before=before.previousSibling){found=find(before,before.firstChild,-1);if(found)return badPos(Pos(found.line,found.ch+dist),bad);else dist+=after.textContent.length;}}function domTextBetween(cm,from,to,fromLine,toLine){var text="",closing=false,lineSep=cm.doc.lineSeparator();function recognizeMarker(id){return function(marker){return marker.id==id;};}function walk(node){if(node.nodeType==1){var cmText=node.getAttribute("cm-text");if(cmText!=null){if(cmText=="")cmText=node.textContent.replace(/\u200b/g,"");text+=cmText;return;}var markerID=node.getAttribute("cm-marker"),range;if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),recognizeMarker(+markerID));if(found.length&&(range=found[0].find()))text+=getBetween(cm.doc,range.from,range.to).join(lineSep);return;}if(node.getAttribute("contenteditable")=="false")return;for(var i=0;i<node.childNodes.length;i++){walk(node.childNodes[i]);}if(/^(pre|div|p)$/i.test(node.nodeName))closing=true;}else if(node.nodeType==3){var val=node.nodeValue;if(!val)return;if(closing){text+=lineSep;closing=false;}text+=val;}}for(;;){walk(from);if(from==to)break;from=from.nextSibling;}return text;}CodeMirror.inputStyles={"textarea":TextareaInput,"contenteditable":ContentEditableInput};function Selection(ranges,primIndex){this.ranges=ranges;this.primIndex=primIndex;}Selection.prototype={primary:function primary(){return this.ranges[this.primIndex];},equals:function equals(other){if(other==this)return true;if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length)return false;for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(cmp(here.anchor,there.anchor)!=0||cmp(here.head,there.head)!=0)return false;}return true;},deepCopy:function deepCopy(){for(var out=[],i=0;i<this.ranges.length;i++){out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head));}return new Selection(out,this.primIndex);},somethingSelected:function somethingSelected(){for(var i=0;i<this.ranges.length;i++){if(!this.ranges[i].empty())return true;}return false;},contains:function contains(pos,end){if(!end)end=pos;for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0)return i;}return-1;}};function Range(anchor,head){this.anchor=anchor;this.head=head;}Range.prototype={from:function from(){return minPos(this.anchor,this.head);},to:function to(){return maxPos(this.anchor,this.head);},empty:function empty(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch;}};function normalizeSelection(ranges,primIndex){var prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from());});primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];if(cmp(prev.to(),cur.from())>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to());var inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;if(i<=primIndex)--primIndex;ranges.splice(--i,2,new Range(inv?to:from,inv?from:to));}}return new Selection(ranges,primIndex);}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0);}
function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1));}function _clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length);}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos;}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size;}function clipPosArray(doc,array){for(var out=[],i=0;i<array.length;i++){out[i]=_clipPos(doc,array[i]);}return out;}
function extendRange(doc,range,head,other){if(doc.cm&&doc.cm.display.shift||doc.extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;if(posBefore!=cmp(other,anchor)<0){anchor=head;head=other;}else if(posBefore!=cmp(head,other)<0){head=other;}}return new Range(anchor,head);}else{return new Range(other||head,head);}}
function extendSelection(doc,head,other,options){setSelection(doc,new Selection([extendRange(doc,doc.sel.primary(),head,other)],0),options);}
function extendSelections(doc,heads,options){for(var out=[],i=0;i<doc.sel.ranges.length;i++){out[i]=extendRange(doc,doc.sel.ranges[i],heads[i],null);}var newSel=normalizeSelection(out,doc.sel.primIndex);setSelection(doc,newSel,options);}
function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range;setSelection(doc,normalizeSelection(ranges,doc.sel.primIndex),options);}
function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options);}
function filterSelectionChange(doc,sel,options){var obj={ranges:sel.ranges,update:function update(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++){this.ranges[i]=new Range(_clipPos(doc,ranges[i].anchor),_clipPos(doc,ranges[i].head));}},origin:options&&options.origin};signal(doc,"beforeSelectionChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeSelectionChange",doc.cm,obj);if(obj.ranges!=sel.ranges)return normalizeSelection(obj.ranges,obj.ranges.length-1);else return sel;}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);if(last&&last.ranges){done[done.length-1]=sel;setSelectionNoUndo(doc,sel,options);}else{setSelection(doc,sel,options);}}
function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options);addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:NaN,options);}function setSelectionNoUndo(doc,sel,options){if(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange"))sel=filterSelectionChange(doc,sel,options);var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,true));if(!(options&&options.scroll===false)&&doc.cm)ensureCursorVisible(doc.cm);}function setSelectionInner(doc,sel){if(sel.equals(doc.sel))return;doc.sel=sel;if(doc.cm){doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=true;signalCursorActivity(doc.cm);}signalLater(doc,"cursorActivity",doc);}
function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,false),sel_dontScroll);}
function skipAtomicInSelection(doc,sel,bias,mayClear){var out;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];var old=sel.ranges.length==doc.sel.ranges.length&&doc.sel.ranges[i];var newAnchor=skipAtomic(doc,range.anchor,old&&old.anchor,bias,mayClear);var newHead=skipAtomic(doc,range.head,old&&old.head,bias,mayClear);if(out||newAnchor!=range.anchor||newHead!=range.head){if(!out)out=sel.ranges.slice(0,i);out[i]=new Range(newAnchor,newHead);}}return out?normalizeSelection(out,sel.primIndex):sel;}function skipAtomicInner(doc,pos,oldPos,dir,mayClear){var line=getLine(doc,pos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=pos.ch:sp.from<pos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=pos.ch:sp.to>pos.ch))){if(mayClear){signal(m,"beforeCursorEnter");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue;}}}if(!m.atomic)continue;if(oldPos){var near=m.find(dir<0?1:-1),diff;if(dir<0?m.inclusiveRight:m.inclusiveLeft)near=movePos(doc,near,-dir,line);if(near&&near.line==pos.line&&(diff=cmp(near,oldPos))&&(dir<0?diff<0:diff>0))return skipAtomicInner(doc,near,pos,dir,mayClear);}var far=m.find(dir<0?-1:1);if(dir<0?m.inclusiveLeft:m.inclusiveRight)far=movePos(doc,far,dir,line);return far?skipAtomicInner(doc,far,pos,dir,mayClear):null;}}return pos;}
function skipAtomic(doc,pos,oldPos,bias,mayClear){var dir=bias||1;var found=skipAtomicInner(doc,pos,oldPos,dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,dir,true)||skipAtomicInner(doc,pos,oldPos,-dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,-dir,true);if(!found){doc.cantEdit=true;return Pos(doc.first,0);}return found;}function movePos(doc,pos,dir,line){if(dir<0&&pos.ch==0){if(pos.line>doc.first)return _clipPos(doc,Pos(pos.line-1));else return null;}else if(dir>0&&pos.ch==(line||getLine(doc,pos.line)).text.length){if(pos.line<doc.first+doc.size-1)return Pos(pos.line+1,0);else return null;}else{return new Pos(pos.line,pos.ch+dir);}}
function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection());}function _prepareSelection(cm,primary){var doc=cm.doc,result={};var curFragment=result.cursors=document.createDocumentFragment();var selFragment=result.selection=document.createDocumentFragment();for(var i=0;i<doc.sel.ranges.length;i++){if(primary===false&&i==doc.sel.primIndex)continue;var range=doc.sel.ranges[i];var collapsed=range.empty();if(collapsed||cm.options.showCursorWhenSelecting)drawSelectionCursor(cm,range.head,curFragment);if(!collapsed)drawSelectionRange(cm,range,selFragment);}return result;}
function drawSelectionCursor(cm,head,output){var pos=_cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine);var cursor=output.appendChild(elt("div","\xA0","CodeMirror-cursor"));cursor.style.left=pos.left+"px";cursor.style.top=pos.top+"px";cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px";if(pos.other){var otherCursor=output.appendChild(elt("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="";otherCursor.style.left=pos.other.left+"px";otherCursor.style.top=pos.other.top+"px";otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+"px";}}
function drawSelectionRange(cm,range,output){var display=cm.display,doc=cm.doc;var fragment=document.createDocumentFragment();var padding=paddingH(cm.display),leftSide=padding.left;var rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right;function add(left,top,width,bottom){if(top<0)top=0;top=Math.round(top);bottom=Math.round(bottom);fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(width==null?rightSide-left:width)+"px; height: "+(bottom-top)+"px"));}function drawForLine(line,fromArg,toArg){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length;var start,end;function coords(ch,bias){return _charCoords(cm,Pos(line,ch),"div",lineObj,bias);}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from,"left"),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left;}else{rightPos=coords(to-1,"right");if(dir=="rtl"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp;}left=leftPos.left;right=rightPos.right;}if(fromArg==null&&from==0)left=leftSide;if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=leftSide;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top);}if(toArg==null&&to==lineLen)right=rightSide;if(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)start=leftPos;if(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)end=rightPos;if(left<leftSide+1)left=leftSide;add(left,rightPos.top,right-left,rightPos.bottom);});return{start:start,end:end};}var sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line){drawForLine(sFrom.line,sFrom.ch,sTo.ch);}else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line);var singleVLine=visualLine(fromLine)==visualLine(toLine);var leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end;var rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;if(singleVLine){if(leftEnd.top<rightStart.top-2){add(leftEnd.right,leftEnd.top,null,leftEnd.bottom);add(leftSide,rightStart.top,rightStart.left,rightStart.bottom);}else{add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom);}}if(leftEnd.bottom<rightStart.top)add(leftSide,leftEnd.bottom,null,rightStart.top);}output.appendChild(fragment);}
function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursorDiv.style.visibility="";if(cm.options.cursorBlinkRate>0)display.blinker=setInterval(function(){display.cursorDiv.style.visibility=(on=!on)?"":"hidden";},cm.options.cursorBlinkRate);else if(cm.options.cursorBlinkRate<0)display.cursorDiv.style.visibility="hidden";}
function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.viewTo)cm.state.highlight.set(time,bind(highlightWorker,cm));}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.viewTo)return;var end=+new Date()+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changedLines=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(doc.frontier>=cm.display.viewFrom){var oldStyles=line.styles,tooLong=line.text.length>cm.options.maxHighlightLength;var highlighted=highlightLine(cm,line,tooLong?copyState(doc.mode,state):state,true);line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;if(newCls)line.styleClasses=newCls;else if(oldCls)line.styleClasses=null;var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass);for(var i=0;!ischange&&i<oldStyles.length;++i){ischange=oldStyles[i]!=line.styles[i];}if(ischange)changedLines.push(doc.frontier);line.stateAfter=tooLong?state:copyState(doc.mode,state);}else{if(line.text.length<=cm.options.maxHighlightLength)processLine(cm,line.text,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null;}++doc.frontier;if(+new Date()>end){startWorker(cm,cm.options.workDelay);return true;}});if(changedLines.length)runInOp(cm,function(){for(var i=0;i<changedLines.length;i++){regLineChange(cm,changedLines[i],"text");}});}
function findStartLine(cm,n,precise){var minindent,minline,doc=cm.doc;var lim=precise?-1:n-(cm.doc.mode.innerMode?1000:100);for(var search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented;}}return minline;}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos;});if(precise)doc.frontier=pos;return state;}
function paddingTop(display){return display.lineSpace.offsetTop;}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight;}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x"));var style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};if(!isNaN(data.left)&&!isNaN(data.right))display.cachedPaddingH=data;return data;}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth;}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth;}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight;}
function ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping;var curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;var rects=lineView.text.firstChild.getClientRects();for(var i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];if(Math.abs(cur.bottom-next.bottom)>2)heights.push((cur.bottom+next.top)/2-rect.top);}}heights.push(rect.bottom-rect.top);}}
function mapFromLineView(lineView,line,lineN){if(lineView.line==line)return{map:lineView.measure.map,cache:lineView.measure.cache};for(var i=0;i<lineView.rest.length;i++){if(lineView.rest[i]==line)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};}for(var i=0;i<lineView.rest.length;i++){if(lineNo(lineView.rest[i])>lineN)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i],before:true};}}
function updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line);var view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);view.text=built.pre;removeChildrenAndAdd(cm.display.lineMeasure,built.pre);return view;}
function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias);}
function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo)return cm.display.view[findViewIndex(cm,lineN)];var ext=cm.display.externalMeasured;if(ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size)return ext;}
function prepareMeasureForLine(cm,line){var lineN=lineNo(line);var view=findViewForLine(cm,lineN);if(view&&!view.text){view=null;}else if(view&&view.changes){updateLineForChanges(cm,view,lineN,getDimensions(cm));cm.curOp.forceUpdate=true;}if(!view)view=updateExternalMeasurement(cm,line);var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:false};}
function measureCharPrepared(cm,prepared,ch,bias,varHeight){if(prepared.before)ch=-1;var key=ch+(bias||""),found;if(prepared.cache.hasOwnProperty(key)){found=prepared.cache[key];}else{if(!prepared.rect)prepared.rect=prepared.view.text.getBoundingClientRect();if(!prepared.hasHeights){ensureLineHeights(cm,prepared.view,prepared.rect);prepared.hasHeights=true;}found=measureCharInner(cm,prepared,ch,bias);if(!found.bogus)prepared.cache[key]=found;}return{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom};}var nullRect={left:0,right:0,top:0,bottom:0};function nodeAndOffsetInLineMap(map,ch,bias){var node,start,end,collapse;for(var i=0;i<map.length;i+=3){var mStart=map[i],mEnd=map[i+1];if(ch<mStart){start=0;end=1;collapse="left";}else if(ch<mEnd){start=ch-mStart;end=start+1;}else if(i==map.length-3||ch==mEnd&&map[i+3]>ch){end=mEnd-mStart;start=end-1;if(ch>=mEnd)collapse="right";}if(start!=null){node=map[i+2];if(mStart==mEnd&&bias==(node.insertLeft?"left":"right"))collapse=bias;if(bias=="left"&&start==0)while(i&&map[i-2]==map[i-3]&&map[i-1].insertLeft){node=map[(i-=3)+2];collapse="left";}if(bias=="right"&&start==mEnd-mStart)while(i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft){node=map[(i+=3)+2];collapse="right";}break;}}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd};}function measureCharInner(cm,prepared,ch,bias){var place=nodeAndOffsetInLineMap(prepared.map,ch,bias);var node=place.node,start=place.start,end=place.end,collapse=place.collapse;var rect;if(node.nodeType==3){for(var i=0;i<4;i++){while(start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start))){--start;}while(place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end))){++end;}if(ie&&ie_version<9&&start==0&&end==place.coverEnd-place.coverStart){rect=node.parentNode.getBoundingClientRect();}else if(ie&&cm.options.lineWrapping){var rects=range(node,start,end).getClientRects();if(rects.length)rect=rects[bias=="right"?rects.length-1:0];else rect=nullRect;}else{rect=range(node,start,end).getBoundingClientRect()||nullRect;}if(rect.left||rect.right||start==0)break;end=start;start=start-1;collapse="right";}if(ie&&ie_version<11)rect=maybeUpdateRectForZooming(cm.display.measure,rect);}else{if(start>0)collapse=bias="right";var rects;if(cm.options.lineWrapping&&(rects=node.getClientRects()).length>1)rect=rects[bias=="right"?rects.length-1:0];else rect=node.getBoundingClientRect();}if(ie&&ie_version<9&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];if(rSpan)rect={left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom};else rect=nullRect;}var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top;var mid=(rtop+rbot)/2;var heights=prepared.view.measure.heights;for(var i=0;i<heights.length-1;i++){if(mid<heights[i])break;}var top=i?heights[i-1]:0,bot=heights[i];var result={left:(collapse=="right"?rect.right:rect.left)-prepared.rect.left,right:(collapse=="left"?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};if(!rect.left&&!rect.right)result.bogus=true;if(!cm.options.singleCursorHeightPerLine){result.rtop=rtop;result.rbottom=rbot;}return result;}
function maybeUpdateRectForZooming(measure,rect){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure))return rect;var scaleX=screen.logicalXDPI/screen.deviceXDPI;var scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY};}function clearLineMeasurementCacheFor(lineView){if(lineView.measure){lineView.measure.cache={};lineView.measure.heights=null;if(lineView.rest)for(var i=0;i<lineView.rest.length;i++){lineView.measure.caches[i]={};}}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null;removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++){clearLineMeasurementCacheFor(cm.display.view[i]);}}function clearCaches(cm){clearLineMeasurementCache(cm);cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null;}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft;}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop;}
function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i){if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size;}}if(context=="line")return rect;if(!context)context="local";var yOff=_heightAtLine(lineObj);if(context=="local")yOff+=paddingTop(cm.display);else yOff-=cm.display.viewOffset;if(context=="page"||context=="window"){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+(context=="window"?0:pageScrollY());var xOff=lOff.left+(context=="window"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff;}rect.top+=yOff;rect.bottom+=yOff;return rect;}
function fromCoordSystem(cm,coords,context){if(context=="div")return coords;var left=coords.left,top=coords.top;if(context=="page"){left-=pageScrollX();top-=pageScrollY();}else if(context=="local"||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left;top+=localBox.top;}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top};}function _charCoords(cm,pos,context,lineObj,bias){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context);}
function _cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){lineObj=lineObj||getLine(cm.doc,pos.line);if(!preparedMeasure)preparedMeasure=prepareMeasureForLine(cm,lineObj);function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context);}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true;}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false;}if(right&&ch==part.to&&ch>part.from)return get(ch-1);return get(ch,right);}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null)val.other=getBidi(ch,bidiOther);return val;}
function estimateCoords(cm,pos){var left=0,pos=_clipPos(cm.doc,pos);if(!cm.options.lineWrapping)left=charWidth(cm.display)*pos.ch;var lineObj=getLine(cm.doc,pos.line);var top=_heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height};}
function PosWithInfo(line,ch,outside,xRel){var pos=Pos(line,ch);pos.xRel=xRel;if(outside)pos.outside=true;return pos;}
function _coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosWithInfo(doc.first,0,true,-1);var lineN=_lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,true,1);if(x<0)x=0;var lineObj=getLine(doc,lineN);for(;;){var found=coordsCharInner(cm,lineObj,lineN,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find(0,true);if(merged&&(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0))lineN=lineNo(lineObj=mergedPos.to.line);else return found;}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-_heightAtLine(lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var preparedMeasure=prepareMeasureForLine(cm,lineObj);function getX(ch){var sp=_cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,preparedMeasure);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left;}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var ch=x<fromX||x-fromX<=toX-x?from:to;var xDiff=x-(ch==from?fromX:toX);while(isExtendingChar(lineObj.text.charAt(ch))){++ch;}var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,xDiff<-1?-1:xDiff>1?1:0);return pos;}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i){middle=moveVisually(lineObj,middle,1);}}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1000;dist=step;}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step;}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt("pre");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode("x"));measureText.appendChild(elt("br"));}measureText.appendChild(document.createTextNode("x"));}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1;}
function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt("span","xxxxxxxxxx");var pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;if(width>2)display.cachedCharWidth=width;return width||10;}
var operationGroup=null;var nextOpId=0;function startOperation(cm){cm.curOp={cm:cm,viewChanged:false,startHeight:cm.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++nextOpId};if(operationGroup){operationGroup.ops.push(cm.curOp);}else{cm.curOp.ownsGroup=operationGroup={ops:[cm.curOp],delayedCallbacks:[]};}}function fireCallbacksForOps(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++){callbacks[i].call(null);}for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers)while(op.cursorActivityCalled<op.cursorActivityHandlers.length){op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm);}}}while(i<callbacks.length);}
function endOperation(cm){var op=cm.curOp,group=op.ownsGroup;if(!group)return;try{fireCallbacksForOps(group);}finally{operationGroup=null;for(var i=0;i<group.ops.length;i++){group.ops[i].cm.curOp=null;}endOperations(group);}}
function endOperations(group){var ops=group.ops;for(var i=0;i<ops.length;i++){endOperation_R1(ops[i]);}for(var i=0;i<ops.length;i++){endOperation_W1(ops[i]);}for(var i=0;i<ops.length;i++){endOperation_R2(ops[i]);}for(var i=0;i<ops.length;i++){endOperation_W2(ops[i]);}for(var i=0;i<ops.length;i++){endOperation_finish(ops[i]);}}function endOperation_R1(op){var cm=op.cm,display=cm.display;maybeClipScrollbars(cm);if(op.updateMaxLine)findMaxLine(cm);op.mustUpdate=op.viewChanged||op.forceUpdate||op.scrollTop!=null||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping;op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate);}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update);}function endOperation_R2(op){var cm=op.cm,display=cm.display;if(op.updatedDisplay)updateHeightsInViewport(cm);op.barMeasure=measureForScrollbars(cm);if(display.maxLineChanged&&!cm.options.lineWrapping){op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3;cm.display.sizerWidth=op.adjustWidthTo;op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth);op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm));}if(op.updatedDisplay||op.selectionChanged)op.preparedSelection=display.input.prepareSelection();}function endOperation_W2(op){var cm=op.cm;if(op.adjustWidthTo!=null){cm.display.sizer.style.minWidth=op.adjustWidthTo+"px";if(op.maxScrollLeft<cm.doc.scrollLeft)setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),true);cm.display.maxLineChanged=false;}if(op.preparedSelection)cm.display.input.showSelection(op.preparedSelection);if(op.updatedDisplay)setDocumentHeight(cm,op.barMeasure);if(op.updatedDisplay||op.startHeight!=cm.doc.height)updateScrollbars(cm,op.barMeasure);if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)cm.display.input.reset(op.typing);if(op.focus&&op.focus==activeElt()&&(!document.hasFocus||document.hasFocus()))ensureFocus(op.cm);}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.updatedDisplay)postUpdateDisplay(cm,op.update);if(display.wheelStartX!=null&&(op.scrollTop!=null||op.scrollLeft!=null||op.scrollToPos))display.wheelStartX=display.wheelStartY=null;if(op.scrollTop!=null&&(display.scroller.scrollTop!=op.scrollTop||op.forceScroll)){doc.scrollTop=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,op.scrollTop));display.scrollbars.setScrollTop(doc.scrollTop);display.scroller.scrollTop=doc.scrollTop;}if(op.scrollLeft!=null&&(display.scroller.scrollLeft!=op.scrollLeft||op.forceScroll)){doc.scrollLeft=Math.max(0,Math.min(display.scroller.scrollWidth-displayWidth(cm),op.scrollLeft));display.scrollbars.setScrollLeft(doc.scrollLeft);display.scroller.scrollLeft=doc.scrollLeft;alignHorizontally(cm);}
if(op.scrollToPos){var coords=scrollPosIntoView(cm,_clipPos(doc,op.scrollToPos.from),_clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);if(op.scrollToPos.isCursor&&cm.state.focused)maybeScrollWindow(cm,coords);}
var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i){if(!hidden[i].lines.length)signal(hidden[i],"hide");}if(unhidden)for(var i=0;i<unhidden.length;++i){if(unhidden[i].lines.length)signal(unhidden[i],"unhide");}if(display.wrapper.offsetHeight)doc.scrollTop=cm.display.scroller.scrollTop;if(op.changeObjs)signal(cm,"changes",cm,op.changeObjs);if(op.update)op.update.finish();}
function runInOp(cm,f){if(cm.curOp)return f();startOperation(cm);try{return f();}finally{endOperation(cm);}}
function operation(cm,f){return function(){if(cm.curOp)return f.apply(cm,arguments);startOperation(cm);try{return f.apply(cm,arguments);}finally{endOperation(cm);}};}
function methodOp(f){return function(){if(this.curOp)return f.apply(this,arguments);startOperation(this);try{return f.apply(this,arguments);}finally{endOperation(this);}};}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp)return f.apply(this,arguments);startOperation(cm);try{return f.apply(this,arguments);}finally{endOperation(cm);}};}
function LineView(doc,line,lineN){this.line=line;this.rest=visualLineContinued(line);this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1;this.node=this.text=null;this.hidden=lineIsHidden(doc,line);}
function buildViewArray(cm,from,to){var array=[],nextPos;for(var pos=from;pos<to;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size;array.push(view);}return array;}
function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;if(!lendiff)lendiff=0;var display=cm.display;if(lendiff&&to<display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>from))display.updateLineNumbers=from;cm.curOp.viewChanged=true;if(from>=display.viewTo){if(sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo)resetView(cm);}else if(to<=display.viewFrom){if(sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom){resetView(cm);}else{display.viewFrom+=lendiff;display.viewTo+=lendiff;}}else if(from<=display.viewFrom&&to>=display.viewTo){resetView(cm);}else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);if(cut){display.view=display.view.slice(cut.index);display.viewFrom=cut.lineN;display.viewTo+=lendiff;}else{resetView(cm);}}else if(to>=display.viewTo){var cut=viewCuttingPoint(cm,from,from,-1);if(cut){display.view=display.view.slice(0,cut.index);display.viewTo=cut.lineN;}else{resetView(cm);}}else{var cutTop=viewCuttingPoint(cm,from,from,-1);var cutBot=viewCuttingPoint(cm,to,to+lendiff,1);if(cutTop&&cutBot){display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index));display.viewTo+=lendiff;}else{resetView(cm);}}var ext=display.externalMeasured;if(ext){if(to<ext.lineN)ext.lineN+=lendiff;else if(from<ext.lineN+ext.size)display.externalMeasured=null;}}
function regLineChange(cm,line,type){cm.curOp.viewChanged=true;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size)display.externalMeasured=null;if(line<display.viewFrom||line>=display.viewTo)return;var lineView=display.view[findViewIndex(cm,line)];if(lineView.node==null)return;var arr=lineView.changes||(lineView.changes=[]);if(indexOf(arr,type)==-1)arr.push(type);}
function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first;cm.display.view=[];cm.display.viewOffset=0;}
function findViewIndex(cm,n){if(n>=cm.display.viewTo)return null;n-=cm.display.viewFrom;if(n<0)return null;var view=cm.display.view;for(var i=0;i<view.length;i++){n-=view[i].size;if(n<0)return i;}}function viewCuttingPoint(cm,oldN,newN,dir){var index=findViewIndex(cm,oldN),diff,view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size)return{index:index,lineN:newN};for(var i=0,n=cm.display.viewFrom;i<index;i++){n+=view[i].size;}if(n!=oldN){if(dir>0){if(index==view.length-1)return null;diff=n+view[index].size-oldN;index++;}else{diff=n-oldN;}oldN+=diff;newN+=diff;}while(visualLineNo(cm.doc,newN)!=newN){if(index==(dir<0?0:view.length-1))return null;newN+=dir*view[index-(dir<0?1:0)].size;index+=dir;}return{index:index,lineN:newN};}
function adjustView(cm,from,to){var display=cm.display,view=display.view;if(view.length==0||from>=display.viewTo||to<=display.viewFrom){display.view=buildViewArray(cm,from,to);display.viewFrom=from;}else{if(display.viewFrom>from)display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view);else if(display.viewFrom<from)display.view=display.view.slice(findViewIndex(cm,from));display.viewFrom=from;if(display.viewTo<to)display.view=display.view.concat(buildViewArray(cm,display.viewTo,to));else if(display.viewTo>to)display.view=display.view.slice(0,findViewIndex(cm,to));}display.viewTo=to;}
function countDirtyView(cm){var view=cm.display.view,dirty=0;for(var i=0;i<view.length;i++){var lineView=view[i];if(!lineView.hidden&&(!lineView.node||lineView.changes))++dirty;}return dirty;}
function registerEventHandlers(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown));if(ie&&ie_version<11)on(d.scroller,"dblclick",operation(cm,function(e){if(signalDOMEvent(cm,e))return;var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head);}));else on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e);});if(!captureRightClick)on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e);});var touchFinished,prevTouch={end:0};function finishTouch(){if(d.activeTouch){touchFinished=setTimeout(function(){d.activeTouch=null;},1000);prevTouch=d.activeTouch;prevTouch.end=+new Date();}};function isMouseLikeTouchEvent(e){if(e.touches.length!=1)return false;var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1;}function farAway(touch,other){if(other.left==null)return true;var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>20*20;}on(d.scroller,"touchstart",function(e){if(!signalDOMEvent(cm,e)&&!isMouseLikeTouchEvent(e)){clearTimeout(touchFinished);var now=+new Date();d.activeTouch={start:now,moved:false,prev:now-prevTouch.end<=300?prevTouch:null};if(e.touches.length==1){d.activeTouch.left=e.touches[0].pageX;d.activeTouch.top=e.touches[0].pageY;}}});on(d.scroller,"touchmove",function(){if(d.activeTouch)d.activeTouch.moved=true;});on(d.scroller,"touchend",function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&touch.left!=null&&!touch.moved&&new Date()-touch.start<300){var pos=cm.coordsChar(d.activeTouch,"page"),range;if(!touch.prev||farAway(touch,touch.prev))
range=new Range(pos,pos);else if(!touch.prev.prev||farAway(touch,touch.prev.prev))
range=cm.findWordAt(pos);else
range=new Range(Pos(pos.line,0),_clipPos(cm.doc,Pos(pos.line+1,0)));cm.setSelection(range.anchor,range.head);cm.focus();e_preventDefault(e);}finishTouch();});on(d.scroller,"touchcancel",finishTouch);on(d.scroller,"scroll",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,"scroll",cm);}});on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e);});on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e);});on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0;});d.dragFunctions={enter:function enter(e){if(!signalDOMEvent(cm,e))e_stop(e);},over:function over(e){if(!signalDOMEvent(cm,e)){onDragOver(cm,e);e_stop(e);}},start:function start(e){onDragStart(cm,e);},drop:operation(cm,onDrop),leave:function leave(){clearDragCursor(cm);}};var inp=d.input.getField();on(inp,"keyup",function(e){onKeyUp.call(cm,e);});on(inp,"keydown",operation(cm,onKeyDown));on(inp,"keypress",operation(cm,onKeyPress));on(inp,"focus",bind(onFocus,cm));on(inp,"blur",bind(onBlur,cm));}function dragDropChanged(cm,value,old){var wasOn=old&&old!=CodeMirror.Init;if(!value!=!wasOn){var funcs=cm.display.dragFunctions;var toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start);toggle(cm.display.scroller,"dragenter",funcs.enter);toggle(cm.display.scroller,"dragover",funcs.over);toggle(cm.display.scroller,"dragleave",funcs.leave);toggle(cm.display.scroller,"drop",funcs.drop);}}
function onResize(cm){var d=cm.display;if(d.lastWrapHeight==d.wrapper.clientHeight&&d.lastWrapWidth==d.wrapper.clientWidth)return;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.scrollbarsClipped=false;cm.setSize();}
function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.nodeType==1&&n.getAttribute("cm-ignore-events")=="true"||n.parentNode==display.sizer&&n!=display.mover)return true;}}
function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&e_target(e).getAttribute("cm-not-content")=="true")return null;var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left;y=e.clientY-space.top;}catch(e){return null;}var coords=_coordsChar(cm,x,y),line;if(forRect&&coords.xRel==1&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff));}return coords;}
function onMouseDown(e){var cm=this,display=cm.display;if(signalDOMEvent(cm,e)||display.activeTouch&&display.input.supportsTouch())return;display.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true;},100);}return;}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);window.focus();switch(e_button(e)){case 1:if(cm.state.selectingText)cm.state.selectingText(e);else if(start)leftButtonDown(cm,e,start);else if(e_target(e)==display.scroller)e_preventDefault(e);break;case 2:if(webkit)cm.state.lastMiddleDown=+new Date();if(start)extendSelection(cm.doc,start);setTimeout(function(){display.input.focus();},20);e_preventDefault(e);break;case 3:if(captureRightClick)onContextMenu(cm,e);else delayBlurEvent(cm);break;}}var lastClick,lastDoubleClick;function leftButtonDown(cm,e,start){if(ie)setTimeout(bind(ensureFocus,cm),0);else cm.curOp.focus=activeElt();var now=+new Date(),type;if(lastDoubleClick&&lastDoubleClick.time>now-400&&cmp(lastDoubleClick.pos,start)==0){type="triple";}else if(lastClick&&lastClick.time>now-400&&cmp(lastClick.pos,start)==0){type="double";lastDoubleClick={time:now,pos:start};}else{type="single";lastClick={time:now,pos:start};}var sel=cm.doc.sel,modifier=mac?e.metaKey:e.ctrlKey,contained;if(cm.options.dragDrop&&dragAndDrop&&!cm.isReadOnly()&&type=="single"&&(contained=sel.contains(start))>-1&&(cmp((contained=sel.ranges[contained]).from(),start)<0||start.xRel>0)&&(cmp(contained.to(),start)>0||start.xRel<0))leftButtonStartDrag(cm,e,start,modifier);else leftButtonSelect(cm,e,start,type,modifier);}
function leftButtonStartDrag(cm,e,start,modifier){var display=cm.display,startTime=+new Date();var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,"mouseup",dragEnd);off(display.scroller,"drop",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);if(!modifier&&+new Date()-200<startTime)extendSelection(cm.doc,start);if(webkit||ie&&ie_version==9)setTimeout(function(){document.body.focus();display.input.focus();},20);else display.input.focus();}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,"mouseup",dragEnd);on(display.scroller,"drop",dragEnd);}
function leftButtonSelect(cm,e,start,type,addNew){var display=cm.display,doc=cm.doc;e_preventDefault(e);var ourRange,ourIndex,startSel=doc.sel,ranges=startSel.ranges;if(addNew&&!e.shiftKey){ourIndex=doc.sel.contains(start);if(ourIndex>-1)ourRange=ranges[ourIndex];else ourRange=new Range(start,start);}else{ourRange=doc.sel.primary();ourIndex=doc.sel.primIndex;}if(e.altKey){type="rect";if(!addNew)ourRange=new Range(start,start);start=posFromMouse(cm,e,true,true);ourIndex=-1;}else if(type=="double"){var word=cm.findWordAt(start);if(cm.display.shift||doc.extend)ourRange=extendRange(doc,ourRange,word.anchor,word.head);else ourRange=word;}else if(type=="triple"){var line=new Range(Pos(start.line,0),_clipPos(doc,Pos(start.line+1,0)));if(cm.display.shift||doc.extend)ourRange=extendRange(doc,ourRange,line.anchor,line.head);else ourRange=line;}else{ourRange=extendRange(doc,ourRange,start);}if(!addNew){ourIndex=0;setSelection(doc,new Selection([ourRange],0),sel_mouse);startSel=doc.sel;}else if(ourIndex==-1){ourIndex=ranges.length;setSelection(doc,normalizeSelection(ranges.concat([ourRange]),ourIndex),{scroll:false,origin:"*mouse"});}else if(ranges.length>1&&ranges[ourIndex].empty()&&type=="single"&&!e.shiftKey){setSelection(doc,normalizeSelection(ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:false,origin:"*mouse"});startSel=doc.sel;}else{replaceOneSelection(doc,ourIndex,ourRange,sel_mouse);}var lastPos=start;function extendTo(pos){if(cmp(lastPos,pos)==0)return;lastPos=pos;if(type=="rect"){var ranges=[],tabSize=cm.options.tabSize;var startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize);var posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize);var left=Math.min(startCol,posCol),right=Math.max(startCol,posCol);for(var line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));line<=end;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);if(left==right)ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos)));else if(text.length>leftPos)ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))));}if(!ranges.length)ranges.push(new Range(start,start));setSelection(doc,normalizeSelection(startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:false});cm.scrollIntoView(pos);}else{var oldRange=ourRange;var anchor=oldRange.anchor,head=pos;if(type!="single"){if(type=="double")var range=cm.findWordAt(pos);else var range=new Range(Pos(pos.line,0),_clipPos(doc,Pos(pos.line+1,0)));if(cmp(range.anchor,anchor)>0){head=range.head;anchor=minPos(oldRange.from(),range.anchor);}else{head=range.anchor;anchor=maxPos(oldRange.to(),range.head);}}var ranges=startSel.ranges.slice(0);ranges[ourIndex]=new Range(_clipPos(doc,anchor),head);setSelection(doc,normalizeSelection(ranges,ourIndex),sel_mouse);}}var editorSize=display.wrapper.getBoundingClientRect();var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true,type=="rect");if(!cur)return;if(cmp(cur,lastPos)!=0){cm.curOp.focus=activeElt();extendTo(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e);}),150);}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e);}),50);}}function done(e){cm.state.selectingText=false;counter=Infinity;e_preventDefault(e);display.input.focus();off(document,"mousemove",move);off(document,"mouseup",up);doc.history.lastSelOrigin=null;}var move=operation(cm,function(e){if(!e_button(e))done(e);else extend(e);});var up=operation(cm,done);cm.state.selectingText=up;on(document,"mousemove",move);on(document,"mouseup",up);}
function gutterEvent(cm,e,type,prevent){try{var mX=e.clientX,mY=e.clientY;}catch(e){return false;}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right))return false;if(prevent)e_preventDefault(e);var display=cm.display;var lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=_lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signal(cm,type,cm,line,gutter,e);return e_defaultPrevented(e);}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",true);}
var lastDrop=0;function onDrop(e){var cm=this;clearDragCursor(cm);if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);if(ie)lastDrop=+new Date();var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||cm.isReadOnly())return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function loadFile(file,i){if(cm.options.allowDropFileTypes&&indexOf(cm.options.allowDropFileTypes,file.type)==-1)return;var reader=new FileReader();reader.onload=operation(cm,function(){var content=reader.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(content))content="";text[i]=content;if(++read==n){pos=_clipPos(cm.doc,pos);var change={from:pos,to:pos,text:cm.doc.splitLines(text.join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change);setSelectionReplaceHistory(cm.doc,simpleSelection(pos,changeEnd(change)));}});reader.readAsText(file);};for(var i=0;i<n;++i){loadFile(files[i],i);}}else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1){cm.state.draggingText(e);setTimeout(function(){cm.display.input.focus();},20);return;}try{var text=e.dataTransfer.getData("Text");if(text){if(cm.state.draggingText&&!(mac?e.altKey:e.ctrlKey))var selected=cm.listSelections();setSelectionNoUndo(cm.doc,simpleSelection(pos,pos));if(selected)for(var i=0;i<selected.length;++i){_replaceRange(cm.doc,"",selected[i].anchor,selected[i].head,"drag");}cm.replaceSelection(text,"around","paste");cm.display.input.focus();}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date()-lastDrop<100)){e_stop(e);return;}if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e))return;e.dataTransfer.setData("Text",cm.getSelection());if(e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(presto){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop;}e.dataTransfer.setDragImage(img,0,0);if(presto)img.parentNode.removeChild(img);}}function onDragOver(cm,e){var pos=posFromMouse(cm,e);if(!pos)return;var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag);if(!cm.display.dragCursor){cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors");cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv);}removeChildrenAndAdd(cm.display.dragCursor,frag);}function clearDragCursor(cm){if(cm.display.dragCursor){cm.display.lineSpace.removeChild(cm.display.dragCursor);cm.display.dragCursor=null;}}
function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplaySimple(cm,{top:val});if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;cm.display.scrollbars.setScrollTop(val);if(gecko)updateDisplaySimple(cm);startWorker(cm,100);}
function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;cm.display.scrollbars.setScrollLeft(val);}
var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;var wheelEventDelta=function wheelEventDelta(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;return{x:dx,y:dy};};CodeMirror.wheelEventPixels=function(e){var delta=wheelEventDelta(e);delta.x*=wheelPixelsPerUnit;delta.y*=wheelPixelsPerUnit;return delta;};function onScrollWheel(cm,e){var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y;var display=cm.display,scroll=display.scroller;var canScrollX=scroll.scrollWidth>scroll.clientWidth;var canScrollY=scroll.scrollHeight>scroll.clientHeight;if(!(dx&&canScrollX||dy&&canScrollY))return;if(dy&&mac&&webkit){outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode){for(var i=0;i<view.length;i++){if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer;}}}}
if(dx&&!gecko&&!presto&&wheelPixelsPerUnit!=null){if(dy&&canScrollY)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));if(!dy||dy&&canScrollY)e_preventDefault(e);display.wheelStartX=null;return;}
if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplaySimple(cm,{top:top,bottom:bot});}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples;},200);}else{display.wheelDX+=dx;display.wheelDY+=dy;}}}
function doHandleBinding(cm,bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound)return false;}
cm.display.input.ensurePolled();var prevShift=cm.display.shift,done=false;try{if(cm.isReadOnly())cm.state.suppressEdits=true;if(dropShift)cm.display.shift=false;done=bound(cm)!=Pass;}finally{cm.display.shift=prevShift;cm.state.suppressEdits=false;}return done;}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result)return result;}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm);}var stopSeq=new Delayed();function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name))return"handled";stopSeq.set(50,function(){if(cm.state.keySeq==seq){cm.state.keySeq=null;cm.display.input.reset();}});name=seq+" "+name;}var result=lookupKeyForEditor(cm,name,handle);if(result=="multi")cm.state.keySeq=name;if(result=="handled")signalLater(cm,"keyHandled",cm,name,e);if(result=="handled"||result=="multi"){e_preventDefault(e);restartBlink(cm);}if(seq&&!result&&/\'$/.test(name)){e_preventDefault(e);return true;}return!!result;}
function handleKeyBinding(cm,e){var name=keyName(e,true);if(!name)return false;if(e.shiftKey&&!cm.state.keySeq){return dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,true);})||dispatchKey(cm,name,e,function(b){if(typeof b=="string"?/^go[A-Z]/.test(b):b.motion)return doHandleBinding(cm,b);});}else{return dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b);});}}
function handleCharBinding(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,function(b){return doHandleBinding(cm,b,true);});}var lastStoppedKey=null;function onKeyDown(e){var cm=this;cm.curOp.focus=activeElt();if(signalDOMEvent(cm,e))return;if(ie&&ie_version<11&&e.keyCode==27)e.returnValue=false;var code=e.keyCode;cm.display.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(presto){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection("",null,"cut");}
if(code==18&&!/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className))showCrossHair(cm);}function showCrossHair(cm){var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair");function up(e){if(e.keyCode==18||!e.altKey){rmClass(lineDiv,"CodeMirror-crosshair");off(document,"keyup",up);off(document,"mouseover",up);}}on(document,"keyup",up);on(document,"mouseover",up);}function onKeyUp(e){if(e.keyCode==16)this.doc.sel.shift=false;signalDOMEvent(this,e);}function onKeyPress(e){var cm=this;if(eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey)return;var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return;}if(presto&&(!e.which||e.which<10)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(handleCharBinding(cm,e,ch))return;cm.display.input.onKeyPress(e);}
function delayBlurEvent(cm){cm.state.delayingBlurEvent=true;setTimeout(function(){if(cm.state.delayingBlurEvent){cm.state.delayingBlurEvent=false;onBlur(cm);}},100);}function onFocus(cm){if(cm.state.delayingBlurEvent)cm.state.delayingBlurEvent=false;if(cm.options.readOnly=="nocursor")return;if(!cm.state.focused){signal(cm,"focus",cm);cm.state.focused=true;addClass(cm.display.wrapper,"CodeMirror-focused");if(!cm.curOp&&cm.display.selForContextMenu!=cm.doc.sel){cm.display.input.reset();if(webkit)setTimeout(function(){cm.display.input.reset(true);},20);}cm.display.input.receivedFocus();}restartBlink(cm);}function onBlur(cm){if(cm.state.delayingBlurEvent)return;if(cm.state.focused){signal(cm,"blur",cm);cm.state.focused=false;rmClass(cm.display.wrapper,"CodeMirror-focused");}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.display.shift=false;},150);}
function onContextMenu(cm,e){if(eventInWidget(cm.display,e)||contextMenuInGutter(cm,e))return;if(signalDOMEvent(cm,e,"contextmenu"))return;cm.display.input.onContextMenu(e);}function contextMenuInGutter(cm,e){if(!hasHandler(cm,"gutterContextMenu"))return false;return gutterEvent(cm,e,"gutterContextMenu",false);}
var changeEnd=CodeMirror.changeEnd=function(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0));};function adjustForChange(pos,change){if(cmp(pos,change.from)<0)return pos;if(cmp(pos,change.to)<=0)return changeEnd(change);var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=changeEnd(change).ch-change.to.ch;return Pos(line,ch);}function computeSelAfterChange(doc,change){var out=[];for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)));}return normalizeSelection(out,doc.sel.primIndex);}function offsetPos(pos,old,nw){if(pos.line==old.line)return Pos(nw.line,pos.ch-old.ch+nw.ch);else return Pos(nw.line+(pos.line-old.line),pos.ch);}
function computeReplacedSel(doc,changes,hint){var out=[];var oldPrev=Pos(doc.first,0),newPrev=oldPrev;for(var i=0;i<changes.length;i++){var change=changes[i];var from=offsetPos(change.from,oldPrev,newPrev);var to=offsetPos(changeEnd(change),oldPrev,newPrev);oldPrev=change.to;newPrev=to;if(hint=="around"){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to);}else{out[i]=new Range(from,from);}}return new Selection(out,doc.sel.primIndex);}
function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function cancel(){this.canceled=true;}};if(update)obj.update=function(from,to,text,origin){if(from)this.from=_clipPos(doc,from);if(to)this.to=_clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin;};signal(doc,"beforeChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeChange",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin};}
function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);if(doc.cm.state.suppressEdits)return;}if(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange")){change=filterChange(doc,change,true);if(!change)return;}
var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=0;--i){makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text});}}else{makeChangeInner(doc,change);}}function makeChangeInner(doc,change){if(change.text.length==1&&change.text[0]==""&&cmp(change.from,change.to)==0)return;var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history);}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change));});}
function makeChangeFromHistory(doc,type,allowSelectionOnly){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history,event,selAfter=doc.sel;var source=type=="undo"?hist.done:hist.undone,dest=type=="undo"?hist.undone:hist.done;for(var i=0;i<source.length;i++){event=source[i];if(allowSelectionOnly?event.ranges&&!event.equals(doc.sel):!event.ranges)break;}if(i==source.length)return;hist.lastOrigin=hist.lastSelOrigin=null;for(;;){event=source.pop();if(event.ranges){pushSelectionToHistory(event,dest);if(allowSelectionOnly&&!event.equals(doc.sel)){setSelection(doc,event,{clearRedo:false});return;}selAfter=event;}else break;}
var antiChanges=[];pushSelectionToHistory(selAfter,dest);dest.push({changes:antiChanges,generation:hist.generation});hist.generation=event.generation||++hist.maxGeneration;var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange");for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){source.length=0;return;}antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));if(!i&&doc.cm)doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history);}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change));});}}
function shiftDoc(doc,distance){if(distance==0)return;doc.first+=distance;doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch));}),doc.sel.primIndex);if(doc.cm){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++){regLineChange(doc.cm,l,"gutter");}}}
function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return;}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin};}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin};}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans);else updateDoc(doc,change,spans);setSelectionNoUndo(doc,selAfter,sel_dontScroll);}
function makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true;}});}if(doc.sel.contains(change.from,change.to)>-1)signalCursorActivity(cm);updateDoc(doc,change,spans,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false;}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true;}
doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;if(change.full)regChange(cm);else if(from.line==to.line&&change.text.length==1&&!isWholeLineUpdate(cm.doc,change))regLineChange(cm,from.line,"text");else regChange(cm,from.line,to.line+1,lendiff);var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(changeHandler)signalLater(cm,"change",cm,obj);if(changesHandler)(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj);}cm.display.selForContextMenu=null;}function _replaceRange(doc,code,from,to,origin){if(!to)to=from;if(cmp(to,from)<0){var tmp=to;to=from;from=tmp;}if(typeof code=="string")code=doc.splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin});}
function maybeScrollWindow(cm,coords){if(signalDOMEvent(cm,"scrollCursorIntoView"))return;var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(coords.top+box.top<0)doScroll=true;else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var scrollNode=elt("div","\u200B",null,"position: absolute; top: "+(coords.top-display.viewOffset-paddingTop(cm.display))+"px; height: "+(coords.bottom-coords.top+scrollGap(cm)+display.barHeight)+"px; left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode);scrollNode.scrollIntoView(doScroll);cm.display.lineSpace.removeChild(scrollNode);}}
function scrollPosIntoView(cm,pos,end,margin){if(margin==null)margin=0;for(var limit=0;limit<5;limit++){var changed=false,coords=_cursorCoords(cm,pos);var endCoords=!end||end==pos?coords:_cursorCoords(cm,end);var scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true;}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true;}if(!changed)break;}return coords;}
function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft);}
function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0)y1=0;var screentop=cm.curOp&&cm.curOp.scrollTop!=null?cm.curOp.scrollTop:display.scroller.scrollTop;var screen=displayHeight(cm),result={};if(y2-y1>screen)y2=y1+screen;var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1;}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop;}var screenleft=cm.curOp&&cm.curOp.scrollLeft!=null?cm.curOp.scrollLeft:display.scroller.scrollLeft;var screenw=displayWidth(cm)-(cm.options.fixedGutter?display.gutters.offsetWidth:0);var tooWide=x2-x1>screenw;if(tooWide)x2=x1+screenw;if(x1<10)result.scrollLeft=0;else if(x1<screenleft)result.scrollLeft=Math.max(0,x1-(tooWide?0:10));else if(x2>screenw+screenleft-3)result.scrollLeft=x2+(tooWide?0:10)-screenw;return result;}
function addToScrollPos(cm,left,top){if(left!=null||top!=null)resolveScrollToPos(cm);if(left!=null)cm.curOp.scrollLeft=(cm.curOp.scrollLeft==null?cm.doc.scrollLeft:cm.curOp.scrollLeft)+left;if(top!=null)cm.curOp.scrollTop=(cm.curOp.scrollTop==null?cm.doc.scrollTop:cm.curOp.scrollTop)+top;}
function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor(),from=cur,to=cur;if(!cm.options.lineWrapping){from=cur.ch?Pos(cur.line,cur.ch-1):cur;to=Pos(cur.line,cur.ch+1);}cm.curOp.scrollToPos={from:from,to:to,margin:cm.options.cursorScrollMargin,isCursor:true};}
function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to);var sPos=calculateScrollPos(cm,Math.min(from.left,to.left),Math.min(from.top,to.top)-range.margin,Math.max(from.right,to.right),Math.max(from.bottom,to.bottom)+range.margin);cm.scrollTo(sPos.scrollLeft,sPos.scrollTop);}}
function indentLine(cm,n,how,aggressive){var doc=cm.doc,state;if(how==null)how="add";if(how=="smart"){if(!doc.mode.indent)how="prev";else state=getStateBefore(cm,n);}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);if(line.stateAfter)line.stateAfter=null;var curSpaceString=line.text.match(/^\s*/)[0],indentation;if(!aggressive&&!/\S/.test(line.text)){indentation=0;how="not";}else if(how=="smart"){indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass||indentation>150){if(!aggressive)return;how="prev";}}if(how=="prev"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0;}else if(how=="add"){indentation=curSpace+cm.options.indentUnit;}else if(how=="subtract"){indentation=curSpace-cm.options.indentUnit;}else if(typeof how=="number"){indentation=curSpace+how;}indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+="\t";}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString){_replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input");line.stateAfter=null;return true;}else{for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos=Pos(n,curSpaceString.length);replaceOneSelection(doc,i,new Range(pos,pos));break;}}}}
function changeLine(doc,handle,changeType,op){var no=handle,line=handle;if(typeof handle=="number")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no)&&doc.cm)regLineChange(doc.cm,no,changeType);return line;}
function deleteNearSelection(cm,compute){var ranges=cm.doc.sel.ranges,kill=[];for(var i=0;i<ranges.length;i++){var toKill=compute(ranges[i]);while(kill.length&&cmp(toKill.from,lst(kill).to)<=0){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break;}}kill.push(toKill);}
runInOp(cm,function(){for(var i=kill.length-1;i>=0;i--){_replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");}ensureCursorVisible(cm);});}
function _findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return false;line=l;return lineObj=getLine(doc,l);}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0;}else return false;}else ch=next;return true;}if(unit=="char"){moveOnce();}else if(unit=="column"){moveOnce(true);}else if(unit=="word"||unit=="group"){var sawType=null,group=unit=="group";var helper=doc.cm&&doc.cm.getHelper(pos,"wordChars");for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||"\n";var type=isWordChar(cur,helper)?"w":group&&cur=="\n"?"n":!group||/\s/.test(cur)?null:"p";if(group&&!first&&!type)type="s";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce();}break;}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break;}}var result=skipAtomic(doc,Pos(line,ch),pos,origDir,true);if(!cmp(pos,result))result.hitSide=true;return result;}
function _findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit=="page"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display));}else if(unit=="line"){y=dir>0?pos.bottom+3:pos.top-3;}for(;;){var target=_coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break;}y+=dir*5;}return target;}
CodeMirror.prototype={constructor:CodeMirror,focus:function focus(){window.focus();this.display.input.focus();},setOption:function setOption(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!="mode")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old);},getOption:function getOption(option){return this.options[option];},getDoc:function getDoc(){return this.doc;},addKeyMap:function addKeyMap(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map));},removeKeyMap:function removeKeyMap(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i){if(maps[i]==map||maps[i].name==map){maps.splice(i,1);return true;}}},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this);}),removeOverlay:methodOp(function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec=="string"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return;}}}),indentLine:methodOp(function(n,dir,aggressive){if(typeof dir!="string"&&typeof dir!="number"){if(dir==null)dir=this.options.smartIndent?"smart":"prev";else dir=dir?"add":"subtract";}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive);}),indentSelection:methodOp(function(how){var ranges=this.doc.sel.ranges,end=-1;for(var i=0;i<ranges.length;i++){var range=ranges[i];if(!range.empty()){var from=range.from(),to=range.to();var start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;j<end;++j){indentLine(this,j,how);}var newRanges=this.doc.sel.ranges;if(from.ch==0&&ranges.length==newRanges.length&&newRanges[i].from().ch>0)replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll);}else if(range.head.line>end){indentLine(this,range.head.line,how,true);end=range.head.line;if(i==this.doc.sel.primIndex)ensureCursorVisible(this);}}}),getTokenAt:function getTokenAt(pos,precise){return takeToken(this,pos,precise);},getLineTokens:function getLineTokens(line,precise){return takeToken(this,Pos(line),precise,true);},getTokenTypeAt:function getTokenTypeAt(pos){pos=_clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line));var before=0,after=(styles.length-1)/2,ch=pos.ch;var type;if(ch==0)type=styles[2];else for(;;){var mid=before+after>>1;if((mid?styles[mid*2-1]:0)>=ch)after=mid;else if(styles[mid*2+1]<ch)before=mid+1;else{type=styles[mid*2+2];break;}}var cut=type?type.indexOf("cm-overlay "):-1;return cut<0?type:cut==0?null:type.slice(0,cut-1);},getModeAt:function getModeAt(pos){var mode=this.doc.mode;if(!mode.innerMode)return mode;return CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode;},getHelper:function getHelper(pos,type){return this.getHelpers(pos,type)[0];},getHelpers:function getHelpers(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return found;var help=helpers[type],mode=this.getModeAt(pos);if(typeof mode[type]=="string"){if(help[mode[type]])found.push(help[mode[type]]);}else if(mode[type]){for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];if(val)found.push(val);}}else if(mode.helperType&&help[mode.helperType]){found.push(help[mode.helperType]);}else if(help[mode.name]){found.push(help[mode.name]);}for(var i=0;i<help._global.length;i++){var cur=help._global[i];if(cur.pred(mode,this)&&indexOf(found,cur.val)==-1)found.push(cur.val);}return found;},getStateAfter:function getStateAfter(line,precise){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1,precise);},cursorCoords:function cursorCoords(start,mode){var pos,range=this.doc.sel.primary();if(start==null)pos=range.head;else if((typeof start==="undefined"?"undefined":_typeof(start))=="object")pos=_clipPos(this.doc,start);else pos=start?range.from():range.to();return _cursorCoords(this,pos,mode||"page");},charCoords:function charCoords(pos,mode){return _charCoords(this,_clipPos(this.doc,pos),mode||"page");},coordsChar:function coordsChar(coords,mode){coords=fromCoordSystem(this,coords,mode||"page");return _coordsChar(this,coords.left,coords.top);},lineAtHeight:function lineAtHeight(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||"page").top;return _lineAtHeight(this.doc,height+this.display.viewOffset);},heightAtLine:function heightAtLine(line,mode){var end=false,lineObj;if(typeof line=="number"){var last=this.doc.first+this.doc.size-1;if(line<this.doc.first)line=this.doc.first;else if(line>last){line=last;end=true;}lineObj=getLine(this.doc,line);}else{lineObj=line;}return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page").top+(end?this.doc.height-_heightAtLine(lineObj):0);},defaultTextHeight:function defaultTextHeight(){return textHeight(this.display);},defaultCharWidth:function defaultCharWidth(){return charWidth(this.display);},setGutterMarker:methodOp(function(line,gutterID,value){return changeLine(this.doc,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true;});}),clearGutter:methodOp(function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regLineChange(cm,i,"gutter");if(isEmpty(line.gutterMarkers))line.gutterMarkers=null;}++i;});}),lineInfo:function lineInfo(line){if(typeof line=="number"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null;}else{var n=lineNo(line);if(n==null)return null;}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets};},getViewport:function getViewport(){return{from:this.display.viewFrom,to:this.display.viewTo};},addWidget:function addWidget(pos,node,scroll,vert,horiz){var display=this.display;pos=_cursorCoords(this,_clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position="absolute";node.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(node);display.sizer.appendChild(node);if(vert=="over"){top=pos.top;}else if(vert=="above"||vert=="near"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert=='above'||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth;}node.style.top=top+"px";node.style.left=node.style.right="";if(horiz=="right"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right="0px";}else{if(horiz=="left")left=0;else if(horiz=="middle")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+"px";}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight);},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,execCommand:function execCommand(cmd){if(commands.hasOwnProperty(cmd))return commands[cmd].call(null,this);},triggerElectric:methodOp(function(text){triggerElectric(this,text);}),findPosH:function findPosH(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount;}for(var i=0,cur=_clipPos(this.doc,from);i<amount;++i){cur=_findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break;}return cur;},moveH:methodOp(function(dir,unit){var cm=this;cm.extendSelectionsBy(function(range){if(cm.display.shift||cm.doc.extend||range.empty())return _findPosH(cm.doc,range.head,dir,unit,cm.options.rtlMoveVisually);else return dir<0?range.from():range.to();},sel_move);}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;if(sel.somethingSelected())doc.replaceSelection("",null,"+delete");else deleteNearSelection(this,function(range){var other=_findPosH(doc,range.head,dir,unit,false);return dir<0?{from:other,to:range.head}:{from:range.head,to:other};});}),findPosV:function findPosV(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount;}for(var i=0,cur=_clipPos(this.doc,from);i<amount;++i){var coords=_cursorCoords(this,cur,"div");if(x==null)x=coords.left;else coords.left=x;cur=_findPosV(this,coords,dir,unit);if(cur.hitSide)break;}return cur;},moveV:methodOp(function(dir,unit){var cm=this,doc=this.doc,goals=[];var collapse=!cm.display.shift&&!doc.extend&&doc.sel.somethingSelected();doc.extendSelectionsBy(function(range){if(collapse)return dir<0?range.from():range.to();var headPos=_cursorCoords(cm,range.head,"div");if(range.goalColumn!=null)headPos.left=range.goalColumn;goals.push(headPos.left);var pos=_findPosV(cm,headPos,dir,unit);if(unit=="page"&&range==doc.sel.primary())addToScrollPos(cm,null,_charCoords(cm,pos,"div").top-headPos.top);return pos;},sel_move);if(goals.length)for(var i=0;i<doc.sel.ranges.length;i++){doc.sel.ranges[i].goalColumn=goals[i];}}),findWordAt:function findWordAt(pos){var doc=this.doc,line=getLine(doc,pos.line).text;var start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");if((pos.xRel<0||end==line.length)&&start)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper);}:/\s/.test(startChar)?function(ch){return/\s/.test(ch);}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch);};while(start>0&&check(line.charAt(start-1))){--start;}while(end<line.length&&check(line.charAt(end))){++end;}}return new Range(Pos(pos.line,start),Pos(pos.line,end));},toggleOverwrite:function toggleOverwrite(value){if(value!=null&&value==this.state.overwrite)return;if(this.state.overwrite=!this.state.overwrite)addClass(this.display.cursorDiv,"CodeMirror-overwrite");else rmClass(this.display.cursorDiv,"CodeMirror-overwrite");signal(this,"overwriteToggle",this,this.state.overwrite);},hasFocus:function hasFocus(){return this.display.input.getField()==activeElt();},isReadOnly:function isReadOnly(){return!!(this.options.readOnly||this.doc.cantEdit);},scrollTo:methodOp(function(x,y){if(x!=null||y!=null)resolveScrollToPos(this);if(x!=null)this.curOp.scrollLeft=x;if(y!=null)this.curOp.scrollTop=y;}),getScrollInfo:function getScrollInfo(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)};},scrollIntoView:methodOp(function(range,margin){if(range==null){range={from:this.doc.sel.primary().head,to:null};if(margin==null)margin=this.options.cursorScrollMargin;}else if(typeof range=="number"){range={from:Pos(range,0),to:null};}else if(range.from==null){range={from:range,to:null};}if(!range.to)range.to=range.from;range.margin=margin||0;if(range.from.line!=null){resolveScrollToPos(this);this.curOp.scrollToPos=range;}else{var sPos=calculateScrollPos(this,Math.min(range.from.left,range.to.left),Math.min(range.from.top,range.to.top)-range.margin,Math.max(range.from.right,range.to.right),Math.max(range.from.bottom,range.to.bottom)+range.margin);this.scrollTo(sPos.scrollLeft,sPos.scrollTop);}}),setSize:methodOp(function(width,height){var cm=this;function interpret(val){return typeof val=="number"||/^\d+$/.test(String(val))?val+"px":val;}if(width!=null)cm.display.wrapper.style.width=interpret(width);if(height!=null)cm.display.wrapper.style.height=interpret(height);if(cm.options.lineWrapping)clearLineMeasurementCache(this);var lineNo=cm.display.viewFrom;cm.doc.iter(lineNo,cm.display.viewTo,function(line){if(line.widgets)for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].noHScroll){regLineChange(cm,lineNo,"widget");break;}}++lineNo;});cm.curOp.forceUpdate=true;signal(cm,"refresh",this);}),operation:function operation(f){return runInOp(this,f);},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this);this.curOp.forceUpdate=true;clearCaches(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);updateGutterSpace(this);if(oldHeight==null||Math.abs(oldHeight-textHeight(this.display))>.5)estimateLineHeights(this);signal(this,"refresh",this);}),swapDoc:methodOp(function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);this.display.input.reset();this.scrollTo(doc.scrollLeft,doc.scrollTop);this.curOp.forceScroll=true;signalLater(this,"swapDoc",this,old);return old;}),getInputField:function getInputField(){return this.display.input.getField();},getWrapperElement:function getWrapperElement(){return this.display.wrapper;},getScrollerElement:function getScrollerElement(){return this.display.scroller;},getGutterElement:function getGutterElement(){return this.display.gutters;}};eventMixin(CodeMirror);var defaults=CodeMirror.defaults={};var optionHandlers=CodeMirror.optionHandlers={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old);}:handle;}
var Init=CodeMirror.Init={toString:function toString(){return"CodeMirror.Init";}};option("value","",function(cm,val){cm.setValue(val);},true);option("mode",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm);},true);option("indentUnit",2,loadMode,true);option("indentWithTabs",false);option("smartIndent",true);option("tabSize",4,function(cm){resetModeState(cm);clearCaches(cm);regChange(cm);},true);option("lineSeparator",null,function(cm,val){cm.doc.lineSep=val;if(!val)return;var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter(function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(found==-1)break;pos=found+val.length;newBreaks.push(Pos(lineNo,found));}lineNo++;});for(var i=newBreaks.length-1;i>=0;i--){_replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length));}});option("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("\t")?"":"|\t"),"g");if(old!=CodeMirror.Init)cm.refresh();});option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){cm.refresh();},true);option("electricChars",true);option("inputStyle",mobile?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor");},true);option("rtlMoveVisually",!windows);option("wholeLineUpdateBefore",true);option("theme","default",function(cm){themeChanged(cm);guttersChanged(cm);},true);option("keyMap","default",function(cm,val,old){var next=getKeyMap(val);var prev=old!=CodeMirror.Init&&getKeyMap(old);if(prev&&prev.detach)prev.detach(cm,next);if(next.attach)next.attach(cm,prev||null);});option("extraKeys",null);option("lineWrapping",false,wrappingChanged,true);option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm);},true);option("fixedGutter",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0";cm.refresh();},true);option("coverGutterNextToScrollbar",false,function(cm){updateScrollbars(cm);},true);option("scrollbarStyle","native",function(cm){initScrollbars(cm);updateScrollbars(cm);cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);},true);option("lineNumbers",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm);},true);option("firstLineNumber",1,guttersChanged,true);option("lineNumberFormatter",function(integer){return integer;},guttersChanged,true);option("showCursorWhenSelecting",false,updateSelection,true);option("resetSelectionOnContextMenu",true);option("lineWiseCopyCut",true);option("readOnly",false,function(cm,val){if(val=="nocursor"){onBlur(cm);cm.display.input.blur();cm.display.disabled=true;}else{cm.display.disabled=false;}cm.display.input.readOnlyChanged(val);});option("disableInput",false,function(cm,val){if(!val)cm.display.input.reset();},true);option("dragDrop",true,dragDropChanged);option("allowDropFileTypes",null);option("cursorBlinkRate",530);option("cursorScrollMargin",0);option("cursorHeight",1,updateSelection,true);option("singleCursorHeightPerLine",true,updateSelection,true);option("workTime",100);option("workDelay",100);option("flattenSpans",true,resetModeState,true);option("addModeClass",false,resetModeState,true);option("pollInterval",100);option("undoDepth",200,function(cm,val){cm.doc.history.undoDepth=val;});option("historyEventDelay",1250);option("viewportMargin",10,function(cm){cm.refresh();},true);option("maxHighlightLength",10000,resetModeState,true);option("moveInputWithCursor",true,function(cm,val){if(!val)cm.display.input.resetPosition();});option("tabindex",null,function(cm,val){cm.display.input.getField().tabIndex=val||"";});option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!="null")CodeMirror.defaults.mode=name;if(arguments.length>2)mode.dependencies=Array.prototype.slice.call(arguments,2);modes[name]=mode;};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec;};CodeMirror.resolveMode=function(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec];}else if(spec&&typeof spec.name=="string"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];if(typeof found=="string")found={name:found};spec=createObj(found,spec);spec.name=found.name;}else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec)){return CodeMirror.resolveMode("application/xml");}if(typeof spec=="string")return{name:spec};else return spec||{name:"null"};};CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj["_"+prop]=modeObj[prop];modeObj[prop]=exts[prop];}}modeObj.name=spec.name;if(spec.helperType)modeObj.helperType=spec.helperType;if(spec.modeProps)for(var prop in spec.modeProps){modeObj[prop]=spec.modeProps[prop];}return modeObj;};CodeMirror.defineMode("null",function(){return{token:function token(stream){stream.skipToEnd();}};});CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts);};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func;};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func;};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f);};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){if(!helpers.hasOwnProperty(type))helpers[type]=CodeMirror[type]={_global:[]};helpers[type][name]=value;};CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value);helpers[type]._global.push({pred:predicate,val:value});};var copyState=CodeMirror.copyState=function(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val;}return nstate;};var startState=CodeMirror.startState=function(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true;};CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state;mode=info.mode;}return info||{mode:mode,state:state};};var commands=CodeMirror.commands={selectAll:function selectAll(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll);},singleSelection:function singleSelection(cm){cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll);},killLine:function killLine(cm){deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;if(range.head.ch==len&&range.head.line<cm.lastLine())return{from:range.head,to:Pos(range.head.line+1,0)};else return{from:range.head,to:Pos(range.head.line,len)};}else{return{from:range.from(),to:range.to()};}});},deleteLine:function deleteLine(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:_clipPos(cm.doc,Pos(range.to().line+1,0))};});},delLineLeft:function delLineLeft(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()};});},delWrappedLineLeft:function delWrappedLineLeft(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()};});},delWrappedLineRight:function delWrappedLineRight(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos};});},undo:function undo(cm){cm.undo();},redo:function redo(cm){cm.redo();},undoSelection:function undoSelection(cm){cm.undoSelection();},redoSelection:function redoSelection(cm){cm.redoSelection();},goDocStart:function goDocStart(cm){cm.extendSelection(Pos(cm.firstLine(),0));},goDocEnd:function goDocEnd(cm){cm.extendSelection(Pos(cm.lastLine()));},goLineStart:function goLineStart(cm){cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line);},{origin:"+move",bias:1});},goLineStartSmart:function goLineStartSmart(cm){cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head);},{origin:"+move",bias:1});},goLineEnd:function goLineEnd(cm){cm.extendSelectionsBy(function(range){return lineEnd(cm,range.head.line);},{origin:"+move",bias:-1});},goLineRight:function goLineRight(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");},sel_move);},goLineLeft:function goLineLeft(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div");},sel_move);},goLineLeftSmart:function goLineLeftSmart(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;var pos=cm.coordsChar({left:0,top:top},"div");if(pos.ch<cm.getLine(pos.line).search(/\S/))return lineStartSmart(cm,range.head);return pos;},sel_move);},goLineUp:function goLineUp(cm){cm.moveV(-1,"line");},goLineDown:function goLineDown(cm){cm.moveV(1,"line");},goPageUp:function goPageUp(cm){cm.moveV(-1,"page");},goPageDown:function goPageDown(cm){cm.moveV(1,"page");},goCharLeft:function goCharLeft(cm){cm.moveH(-1,"char");},goCharRight:function goCharRight(cm){cm.moveH(1,"char");},goColumnLeft:function goColumnLeft(cm){cm.moveH(-1,"column");},goColumnRight:function goColumnRight(cm){cm.moveH(1,"column");},goWordLeft:function goWordLeft(cm){cm.moveH(-1,"word");},goGroupRight:function goGroupRight(cm){cm.moveH(1,"group");},goGroupLeft:function goGroupLeft(cm){cm.moveH(-1,"group");},goWordRight:function goWordRight(cm){cm.moveH(1,"word");},delCharBefore:function delCharBefore(cm){cm.deleteH(-1,"char");},delCharAfter:function delCharAfter(cm){cm.deleteH(1,"char");},delWordBefore:function delWordBefore(cm){cm.deleteH(-1,"word");},delWordAfter:function delWordAfter(cm){cm.deleteH(1,"word");},delGroupBefore:function delGroupBefore(cm){cm.deleteH(-1,"group");},delGroupAfter:function delGroupAfter(cm){cm.deleteH(1,"group");},indentAuto:function indentAuto(cm){cm.indentSelection("smart");},indentMore:function indentMore(cm){cm.indentSelection("add");},indentLess:function indentLess(cm){cm.indentSelection("subtract");},insertTab:function insertTab(cm){cm.replaceSelection("\t");},insertSoftTab:function insertSoftTab(cm){var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize;for(var i=0;i<ranges.length;i++){var pos=ranges[i].from();var col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(new Array(tabSize-col%tabSize+1).join(" "));}cm.replaceSelections(spaces);},defaultTab:function defaultTab(cm){if(cm.somethingSelected())cm.indentSelection("add");else cm.execCommand("insertTab");},transposeChars:function transposeChars(cm){runInOp(cm,function(){var ranges=cm.listSelections(),newSel=[];for(var i=0;i<ranges.length;i++){var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line){if(cur.ch==line.length)cur=new Pos(cur.line,cur.ch-1);if(cur.ch>0){cur=new Pos(cur.line,cur.ch+1);cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose");}else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;if(prev)cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),Pos(cur.line,1),"+transpose");}}newSel.push(new Range(cur,cur));}cm.setSelections(newSel);});},newlineAndIndent:function newlineAndIndent(cm){runInOp(cm,function(){var len=cm.listSelections().length;for(var i=0;i<len;i++){var range=cm.listSelections()[i];cm.replaceRange(cm.doc.lineSeparator(),range.anchor,range.head,"+input");cm.indentLine(range.from().line+1,null,true);}ensureCursorVisible(cm);});},toggleOverwrite:function toggleOverwrite(cm){cm.toggleOverwrite();}};var keyMap=CodeMirror.keyMap={};keyMap.basic={"Left":"goCharLeft","Right":"goCharRight","Up":"goLineUp","Down":"goLineDown","End":"goLineEnd","Home":"goLineStartSmart","PageUp":"goPageUp","PageDown":"goPageDown","Delete":"delCharAfter","Backspace":"delCharBefore","Shift-Backspace":"delCharBefore","Tab":"defaultTab","Shift-Tab":"indentAuto","Enter":"newlineAndIndent","Insert":"toggleOverwrite","Esc":"singleSelection"};keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;function normalizeKeyName(name){var parts=name.split(/-(?!$)/),name=parts[parts.length-1];var alt,ctrl,shift,cmd;for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))cmd=true;else if(/^a(lt)?$/i.test(mod))alt=true;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=true;else if(/^s(hift)$/i.test(mod))shift=true;else throw new Error("Unrecognized modifier name: "+mod);}if(alt)name="Alt-"+name;if(ctrl)name="Ctrl-"+name;if(cmd)name="Cmd-"+name;if(shift)name="Shift-"+name;return name;}
CodeMirror.normalizeKeyMap=function(keymap){var copy={};for(var keyname in keymap){if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname))continue;if(value=="..."){delete keymap[keyname];continue;}var keys=map(keyname.split(" "),normalizeKeyName);for(var i=0;i<keys.length;i++){var val,name;if(i==keys.length-1){name=keys.join(" ");val=value;}else{name=keys.slice(0,i+1).join(" ");val="...";}var prev=copy[name];if(!prev)copy[name]=val;else if(prev!=val)throw new Error("Inconsistent bindings for "+name);}delete keymap[keyname];}}for(var prop in copy){keymap[prop]=copy[prop];}return keymap;};var lookupKey=CodeMirror.lookupKey=function(key,map,handle,context){map=getKeyMap(map);var found=map.call?map.call(key,context):map[key];if(found===false)return"nothing";if(found==="...")return"multi";if(found!=null&&handle(found))return"handled";if(map.fallthrough){if(Object.prototype.toString.call(map.fallthrough)!="[object Array]")return lookupKey(key,map.fallthrough,handle,context);for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result)return result;}}};var isModifierKey=CodeMirror.isModifierKey=function(value){var name=typeof value=="string"?value:keyNames[value.keyCode];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod";};var keyName=CodeMirror.keyName=function(event,noShift){if(presto&&event.keyCode==34&&event["char"])return false;var base=keyNames[event.keyCode],name=base;if(name==null||event.altGraphKey)return false;if(event.altKey&&base!="Alt")name="Alt-"+name;if((flipCtrlCmd?event.metaKey:event.ctrlKey)&&base!="Ctrl")name="Ctrl-"+name;if((flipCtrlCmd?event.ctrlKey:event.metaKey)&&base!="Cmd")name="Cmd-"+name;if(!noShift&&event.shiftKey&&base!="Shift")name="Shift-"+name;return name;};function getKeyMap(val){return typeof val=="string"?keyMap[val]:val;}
CodeMirror.fromTextArea=function(textarea,options){options=options?copyObj(options):{};options.value=textarea.value;if(!options.tabindex&&textarea.tabIndex)options.tabindex=textarea.tabIndex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||textarea.getAttribute("autofocus")!=null&&hasFocus==document.body;}function save(){textarea.value=cm.getValue();}if(textarea.form){on(textarea.form,"submit",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit;};}catch(e){}}}options.finishInit=function(cm){cm.save=save;cm.getTextArea=function(){return textarea;};cm.toTextArea=function(){cm.toTextArea=isNaN;save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display="";if(textarea.form){off(textarea.form,"submit",save);if(typeof textarea.form.submit=="function")textarea.form.submit=realSubmit;}};};textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling);},options);return cm;};var StringStream=CodeMirror.StringStream=function(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;};StringStream.prototype={eol:function eol(){return this.pos>=this.string.length;},sol:function sol(){return this.pos==this.lineStart;},peek:function peek(){return this.string.charAt(this.pos)||undefined;},next:function next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++);},eat:function eat(match){var ch=this.string.charAt(this.pos);if(typeof match=="string")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch;}},eatWhile:function eatWhile(match){var start=this.pos;while(this.eat(match)){}return this.pos>start;},eatSpace:function eatSpace(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos;}return this.pos>start;},skipToEnd:function skipToEnd(){this.pos=this.string.length;},skipTo:function skipTo(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true;}},backUp:function backUp(n){this.pos-=n;},column:function column(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start;}return this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0);},indentation:function indentation(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0);},match:function match(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function cased(str){return caseInsensitive?str.toLowerCase():str;};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true;}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match;}},current:function current(){return this.string.slice(this.start,this.pos);},hideFirstChars:function hideFirstChars(n,inner){this.lineStart+=n;try{return inner();}finally{this.lineStart-=n;}}};var nextMarkerId=0;var TextMarker=CodeMirror.TextMarker=function(doc,type){this.lines=[];this.type=type;this.doc=doc;this.id=++nextMarkerId;};eventMixin(TextMarker);TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);if(hasHandler(this,"clear")){var found=this.find();if(found)signalLater(this,"clear",found.from,found.to);}var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(cm&&!this.collapsed)regLineChange(cm,lineNo(line),"text");else if(cm){if(span.to!=null)max=lineNo(line);if(span.from!=null)min=lineNo(line);}line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from==null&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display));}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(this.lines[i]),len=lineLength(visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true;}}if(min!=null&&cm&&this.collapsed)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(cm)reCheckSelection(cm.doc);}if(cm)signalLater(cm,"markerCleared",cm,this);if(withOp)endOperation(cm);if(this.parent)this.parent.clear();};TextMarker.prototype.find=function(side,lineObj){if(side==null&&this.type=="bookmark")side=1;var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null){from=Pos(lineObj?line:lineNo(line),span.from);if(side==-1)return from;}if(span.to!=null){to=Pos(lineObj?line:lineNo(line),span.to);if(side==1)return to;}}return from&&{from:from,to:to};};TextMarker.prototype.changed=function(){var pos=this.find(-1,true),widget=this,cm=this.doc.cm;if(!pos||!cm)return;runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line);var view=findViewForLine(cm,lineN);if(view){clearLineMeasurementCacheFor(view);cm.curOp.selectionChanged=cm.curOp.forceUpdate=true;}cm.curOp.updateMaxLine=true;if(!lineIsHidden(widget.doc,line)&&widget.height!=null){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;if(dHeight)updateLineHeight(line,line.height+dHeight);}});};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this);}this.lines.push(line);};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this);}};var nextMarkerId=0;function _markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,_markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options)copyObj(options,marker,false);if(diff>0||diff==0&&marker.clearWhenEmpty!==false)return marker;if(marker.replacedWith){marker.collapsed=true;marker.widgetNode=elt("span",[marker.replacedWith],"CodeMirror-widget");if(!options.handleMouseEvents)marker.widgetNode.setAttribute("cm-ignore-events","true");if(options.insertLeft)marker.widgetNode.insertLeft=true;}if(marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=true;}if(marker.addToHistory)addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,NaN);var curLine=from.line,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine)updateMaxLine=true;if(marker.collapsed&&curLine!=from.line)updateLineHeight(line,0);addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null));++curLine;});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0);});if(marker.clearOnEnter)on(marker,"beforeCursorEnter",function(){marker.clear();});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory();}if(marker.collapsed){marker.id=++nextMarkerId;marker.atomic=true;}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.collapsed)regChange(cm,from.line,to.line+1);else if(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.css)for(var i=from.line;i<=to.line;i++){regLineChange(cm,i,"text");}if(marker.atomic)reCheckSelection(cm.doc);signalLater(cm,"markerAdded",cm,marker);}return marker;}
var SharedTextMarker=CodeMirror.SharedTextMarker=function(markers,primary){this.markers=markers;this.primary=primary;for(var i=0;i<markers.length;++i){markers[i].parent=this;}};eventMixin(SharedTextMarker);SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i){this.markers[i].clear();}signalLater(this,"clear");};SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj);};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[_markText(doc,from,to,options,type)],primary=markers[0];var widget=options.widgetNode;linkedDocs(doc,function(doc){if(widget)options.widgetNode=widget.cloneNode(true);markers.push(_markText(doc,_clipPos(doc,from),_clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i){if(doc.linked[i].isParent)return;}primary=lst(markers);});return new SharedTextMarker(markers,primary);}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent;});}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find();var mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=_markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark);subMark.parent=marker;}}}function detachSharedMarkers(markers){for(var i=0;i<markers.length;i++){var marker=markers[i],linked=[marker.primary.doc];;linkedDocs(marker.primary.doc,function(d){linked.push(d);});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];if(indexOf(linked,subMarker.doc)==-1){subMarker.parent=null;marker.markers.splice(j--,1);}}}}
function MarkedSpan(marker,from,to){this.marker=marker;this.from=from;this.to=to;}
function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span;}}
function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i){if(spans[i]!=span)(r||(r=[])).push(spans[i]);}return r;}
function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line);}
function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&marker.type=="bookmark"&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to));}}return nw;}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&marker.type=="bookmark"&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,span.to==null?null:span.to-endCh));}}return nw;}
function stretchSpansOverChange(doc,change){if(change.full)return null;var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=cmp(change.from,change.to)==0;var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset;}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span);}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span);}}}
if(first)first=clearEmptySpans(first);if(last&&last!=first)last=clearEmptySpans(last);var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i){if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i].marker,null,null));}for(var i=0;i<gap;++i){newMarkers.push(gapMarkers);}newMarkers.push(last);}return newMarkers;}
function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.from!=null&&span.from==span.to&&span.marker.clearWhenEmpty!==false)spans.splice(i--,1);}if(!spans.length)return null;return spans;}
function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k){if(oldCur[k].marker==span.marker)continue spans;}oldCur.push(span);}}else if(stretchCur){old[i]=stretchCur;}}return old;}
function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark);}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find(0);for(var j=0;j<parts.length;++j){var p=parts[j];if(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0)continue;var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);if(dfrom<0||!mk.inclusiveLeft&&!dfrom)newParts.push({from:p.from,to:m.from});if(dto>0||!mk.inclusiveRight&&!dto)newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1;}}return parts;}
function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i){spans[i].marker.detachLine(line);}line.markedSpans=null;}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i){spans[i].marker.attachLine(line);}line.markedSpans=spans;}
function extraLeft(marker){return marker.inclusiveLeft?-1:0;}function extraRight(marker){return marker.inclusiveRight?1:0;}
function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(lenDiff!=0)return lenDiff;var aPos=a.find(),bPos=b.find();var fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);if(toCmp)return toCmp;return b.id-a.id;}
function collapsedSpanAtSide(line,start){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(sp.marker.collapsed&&(start?sp.from:sp.to)==null&&(!found||compareCollapsedMarkers(found,sp.marker)<0))found=sp.marker;}return found;}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,true);}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,false);}
function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo);var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(!sp.marker.collapsed)continue;var found=sp.marker.find(0);var fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker);var toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(fromCmp>=0&&toCmp<=0||fromCmp<=0&&toCmp>=0)continue;if(fromCmp<=0&&(cmp(found.to,from)>0||sp.marker.inclusiveRight&&marker.inclusiveLeft)||fromCmp>=0&&(cmp(found.from,to)<0||sp.marker.inclusiveLeft&&marker.inclusiveRight))return true;}}
function visualLine(line){var merged;while(merged=collapsedSpanAtStart(line)){line=merged.find(-1,true).line;}return line;}
function visualLineContinued(line){var merged,lines;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;(lines||(lines=[])).push(line);}return lines;}
function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);if(line==vis)return lineN;return lineNo(vis);}
function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine())return lineN;var line=getLine(doc,lineN),merged;if(!lineIsHidden(doc,line))return lineN;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;}return lineNo(line)+1;}
function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.marker.widgetNode)continue;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true;}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find(1,true);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker));}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(sp.to==null||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true;}}
var LineWidget=CodeMirror.LineWidget=function(doc,node,options){if(options)for(var opt in options){if(options.hasOwnProperty(opt))this[opt]=options[opt];}this.doc=doc;this.node=node;};eventMixin(LineWidget);function adjustScrollWhenAboveVisible(cm,line,diff){if(_heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop))addToScrollPos(cm,null,diff);}LineWidget.prototype.clear=function(){var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i){if(ws[i]==this)ws.splice(i--,1);}if(!ws.length)line.widgets=null;var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height));if(cm)runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height);regLineChange(cm,no,"widget");});};LineWidget.prototype.changed=function(){var oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;updateLineHeight(line,line.height+diff);if(cm)runInOp(cm,function(){cm.curOp.forceUpdate=true;adjustScrollWhenAboveVisible(cm,line,diff);});};function widgetHeight(widget){if(widget.height!=null)return widget.height;var cm=widget.doc.cm;if(!cm)return 0;if(!contains(document.body,widget.node)){var parentStyle="position: relative;";if(widget.coverGutter)parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;";if(widget.noHScroll)parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;";removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle));}return widget.height=widget.node.parentNode.offsetHeight;}function addLineWidget(doc,handle,node,options){var widget=new LineWidget(doc,node,options);var cm=doc.cm;if(cm&&widget.noHScroll)cm.display.alignWidgets=true;changeLine(doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(widget.insertAt==null)widgets.push(widget);else widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget);widget.line=line;if(cm&&!lineIsHidden(doc,line)){var aboveVisible=_heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,null,widget.height);cm.curOp.forceUpdate=true;}return true;});return widget;}
var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text;attachMarkedSpans(this,markedSpans);this.height=estimateHeight?estimateHeight(this):1;};eventMixin(Line);Line.prototype.lineNo=function(){return lineNo(this);};function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight);}
function cleanUpLine(line){line.parent=null;detachMarkedSpans(line);}function extractLineClasses(type,output){if(type)for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";if(output[prop]==null)output[prop]=lineClass[2];else if(!new RegExp("(?:^|\s)"+lineClass[2]+"(?:$|\s)").test(output[prop]))output[prop]+=" "+lineClass[2];}return type;}function callBlankLine(mode,state){if(mode.blankLine)return mode.blankLine(state);if(!mode.innerMode)return;var inner=CodeMirror.innerMode(mode,state);if(inner.mode.blankLine)return inner.mode.blankLine(inner.state);}function readToken(mode,stream,state,inner){for(var i=0;i<10;i++){if(inner)inner[0]=CodeMirror.innerMode(mode,state).mode;var style=mode.token(stream,state);if(stream.pos>stream.start)return style;}throw new Error("Mode "+mode.name+" failed to advance stream.");}
function takeToken(cm,pos,precise,asArray){function getObj(copy){return{start:stream.start,end:stream.pos,string:stream.current(),type:style||null,state:copy?copyState(doc.mode,state):state};}var doc=cm.doc,mode=doc.mode,style;pos=_clipPos(doc,pos);var line=getLine(doc,pos.line),state=getStateBefore(cm,pos.line,precise);var stream=new StringStream(line.text,cm.options.tabSize),tokens;if(asArray)tokens=[];while((asArray||stream.pos<pos.ch)&&!stream.eol()){stream.start=stream.pos;style=readToken(mode,stream,state);if(asArray)tokens.push(getObj(true));}return asArray?tokens:getObj();}
function runMode(cm,text,mode,state,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curStart=0,curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;var inner=cm.options.addModeClass&&[null];if(text=="")extractLineClasses(callBlankLine(mode,state),lineClasses);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;if(forceToEnd)processLine(cm,text,state,stream.pos);stream.pos=text.length;style=null;}else{style=extractLineClasses(readToken(mode,stream,state,inner),lineClasses);}if(inner){var mName=inner[0].name;if(mName)style="m-"+(style?mName+" "+style:mName);}if(!flattenSpans||curStyle!=style){while(curStart<stream.start){curStart=Math.min(stream.start,curStart+50000);f(curStart,curStyle);}curStyle=style;}stream.start=stream.pos;}while(curStart<stream.pos){var pos=Math.min(stream.pos,curStart+50000);f(pos,curStyle);curStart=pos;}}
function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style);},lineClasses,forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,true,function(end,style){var start=i;while(at<end){var i_end=st[i];if(i_end>end)st.splice(i,1,end,st[i+1],i_end);i+=2;at=Math.min(end,i_end);}if(!style)return;if(overlay.opaque){st.splice(start,i-start,end,"cm-overlay "+style);i=start+2;}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"cm-overlay "+style;}}},lineClasses);}return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null};}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var state=getStateBefore(cm,lineNo(line));var result=highlightLine(cm,line,line.text.length>cm.options.maxHighlightLength?copyState(cm.doc.mode,state):state);line.stateAfter=state;line.styles=result.styles;if(result.classes)line.styleClasses=result.classes;else if(line.styleClasses)line.styleClasses=null;if(updateFrontier===cm.doc.frontier)cm.doc.frontier++;}return line.styles;}
function processLine(cm,text,state,startAt){var mode=cm.doc.mode;var stream=new StringStream(text,cm.options.tabSize);stream.start=stream.pos=startAt||0;if(text=="")callBlankLine(mode,state);while(!stream.eol()){readToken(mode,stream,state);stream.start=stream.pos;}}
var styleToClassCache={},styleToClassCacheWithMode={};function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style))return null;var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"));}
function buildLineContent(cm,lineView){var content=elt("span",null,null,webkit?"padding-right: .1px":null);var builder={pre:elt("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,splitSpaces:(ie||webkit)&&cm.getOption("lineWrapping")};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var line=i?lineView.rest[i-1]:lineView.line,order;builder.pos=0;builder.addToken=buildToken;if(hasBadBidiRects(cm.display.measure)&&(order=getOrder(line)))builder.addToken=buildTokenBadBidi(builder.addToken,order);builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate));if(line.styleClasses){if(line.styleClasses.bgClass)builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"");if(line.styleClasses.textClass)builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||"");}
if(builder.map.length==0)builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure)));if(i==0){lineView.measure.map=builder.map;lineView.measure.cache={};}else{(lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map);(lineView.measure.caches||(lineView.measure.caches=[])).push({});}}
if(webkit&&/\bcm-tab\b/.test(builder.content.lastChild.className))builder.content.className="cm-tab-wrap-hack";signal(cm,"renderLine",cm,lineView.line,builder.pre);if(builder.pre.className)builder.textClass=joinClasses(builder.pre.className,builder.textClass||"");return builder;}function defaultSpecialCharPlaceholder(ch){var token=elt("span","\u2022","cm-invalidchar");token.title="\\u"+ch.charCodeAt(0).toString(16);token.setAttribute("aria-label",token.title);return token;}
function buildToken(builder,text,style,startStyle,endStyle,title,css){if(!text)return;var displayText=builder.splitSpaces?text.replace(/ {3,}/g,splitSpaces):text;var special=builder.cm.state.specialChars,mustWrap=false;if(!special.test(text)){builder.col+=text.length;var content=document.createTextNode(displayText);builder.map.push(builder.pos,builder.pos+text.length,content);if(ie&&ie_version<9)mustWrap=true;builder.pos+=text.length;}else{var content=document.createDocumentFragment(),pos=0;while(true){special.lastIndex=pos;var m=special.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));if(ie&&ie_version<9)content.appendChild(elt("span",[txt]));else content.appendChild(txt);builder.map.push(builder.pos,builder.pos+skipped,txt);builder.col+=skipped;builder.pos+=skipped;}if(!m)break;pos+=skipped+1;if(m[0]=="\t"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;var txt=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));txt.setAttribute("role","presentation");txt.setAttribute("cm-text","\t");builder.col+=tabWidth;}else if(m[0]=="\r"||m[0]=="\n"){var txt=content.appendChild(elt("span",m[0]=="\r"?"\u240D":"\u2424","cm-invalidchar"));txt.setAttribute("cm-text",m[0]);builder.col+=1;}else{var txt=builder.cm.options.specialCharPlaceholder(m[0]);txt.setAttribute("cm-text",m[0]);if(ie&&ie_version<9)content.appendChild(elt("span",[txt]));else content.appendChild(txt);builder.col+=1;}builder.map.push(builder.pos,builder.pos+1,txt);builder.pos++;}}if(style||startStyle||endStyle||mustWrap||css){var fullStyle=style||"";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;var token=elt("span",[content],fullStyle,css);if(title)token.title=title;return builder.content.appendChild(token);}builder.content.appendChild(content);}function splitSpaces(old){var out=" ";for(var i=0;i<old.length-2;++i){out+=i%2?" ":"\xA0";}out+=" ";return out;}
function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,title,css){style=style?style+" cm-force-border":"cm-force-border";var start=builder.pos,end=start+text.length;for(;;){for(var i=0;i<order.length;i++){var part=order[i];if(part.to>start&&part.from<=start)break;}if(part.to>=end)return inner(builder,text,style,startStyle,endStyle,title,css);inner(builder,text.slice(0,part.to-start),style,startStyle,null,title,css);startStyle=null;text=text.slice(part.to-start);start=part.to;}};}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;if(widget)builder.map.push(builder.pos,builder.pos+size,widget);if(!ignoreWidget&&builder.cm.display.input.needsContentAttribute){if(!widget)widget=builder.content.appendChild(document.createElement("span"));widget.setAttribute("cm-marker",marker.id);}if(widget){builder.cm.display.input.setUneditable(widget);builder.content.appendChild(widget);}builder.pos+=size;}
function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(!spans){for(var i=1;i<styles.length;i+=2){builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder.cm.options));}return;}var len=allText.length,pos=0,i=1,text="",style,css;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,title,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title=css="";collapsed=null;nextChange=Infinity;var foundBookmarks=[],endStyles;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(m.type=="bookmark"&&sp.from==pos&&m.widgetNode){foundBookmarks.push(m);}else if(sp.from<=pos&&(sp.to==null||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)){if(sp.to!=null&&sp.to!=pos&&nextChange>sp.to){nextChange=sp.to;spanEndStyle="";}if(m.className)spanStyle+=" "+m.className;if(m.css)css=(css?css+";":"")+m.css;if(m.startStyle&&sp.from==pos)spanStartStyle+=" "+m.startStyle;if(m.endStyle&&sp.to==nextChange)(endStyles||(endStyles=[])).push(m.endStyle,sp.to);if(m.title&&!title)title=m.title;if(m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0))collapsed=sp;}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from;}}if(endStyles)for(var j=0;j<endStyles.length;j+=2){if(endStyles[j+1]==nextChange)spanEndStyle+=" "+endStyles[j];}if(!collapsed||collapsed.from==pos)for(var j=0;j<foundBookmarks.length;++j){buildCollapsedSpan(builder,0,foundBookmarks[j]);}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len+1:collapsed.to)-pos,collapsed.marker,collapsed.from==null);if(collapsed.to==null)return;if(collapsed.to==pos)collapsed=false;}}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title,css);}if(end>=upto){text=text.slice(upto-pos);pos=upto;break;}pos=end;spanStartStyle="";}text=allText.slice(at,at=styles[i++]);style=interpretTokenStyle(styles[i++],builder.cm.options);}}}
function isWholeLineUpdate(doc,change){return change.from.ch==0&&change.to.ch==0&&lst(change.text)==""&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore);}
function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null;}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,"change",line,change);}function linesFor(start,end){for(var i=start,result=[];i<end;++i){result.push(new Line(text[i],spansFor(i),estimateHeight));}return result;}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(change.full){doc.insert(0,linesFor(0,text.length));doc.remove(text.length,doc.size-text.length);}else if(isWholeLineUpdate(doc,change)){var added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added);}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);}else{var added=linesFor(1,text.length-1);added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added);}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines);}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added=linesFor(1,text.length-1);if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added);}signalLater(doc,"change",doc,change);}
function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,height=0;i<lines.length;++i){lines[i].parent=this;height+=lines[i].height;}this.height=height;}LeafChunk.prototype={chunkSize:function chunkSize(){return this.lines.length;},removeInner:function removeInner(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,"delete");}this.lines.splice(at,n);},collapse:function collapse(lines){lines.push.apply(lines,this.lines);},insertInner:function insertInner(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i){lines[i].parent=this;}},iterN:function iterN(at,n,op){for(var e=at+n;at<e;++at){if(op(this.lines[at]))return true;}}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this;}this.size=size;this.height=height;this.parent=null;}BranchChunk.prototype={chunkSize:function chunkSize(){return this.size;},removeInner:function removeInner(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null;}if((n-=rm)==0)break;at=0;}else at-=sz;}
if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this;}},collapse:function collapse(lines){for(var i=0;i<this.children.length;++i){this.children[i].collapse(lines);}},insertInner:function insertInner(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this;}this.maybeSpill();}break;}at-=sz;}},maybeSpill:function maybeSpill(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy;}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling);}sibling.parent=me.parent;}while(me.children.length>10);me.parent.maybeSpill();},iterN:function iterN(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0;}else at-=sz;}}};var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine,lineSep){if(!(this instanceof Doc))return new Doc(text,mode,firstLine,lineSep);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([new Line("",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start);this.history=new History(null);this.id=++nextDocId;this.modeOption=mode;this.lineSep=lineSep;this.extend=false;if(typeof text=="string")text=this.splitLines(text);updateDoc(this,{from:start,to:start,text:text});setSelection(this,simpleSelection(start),sel_dontScroll);};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function iter(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from);},insert:function insert(at,lines){var height=0;for(var i=0;i<lines.length;++i){height+=lines[i].height;}this.insertInner(at-this.first,lines,height);},remove:function remove(at,n){this.removeInner(at-this.first,n);},getValue:function getValue(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||this.lineSeparator());},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:true},true);setSelection(this,simpleSelection(top));}),replaceRange:function replaceRange(code,from,to,origin){from=_clipPos(this,from);to=to?_clipPos(this,to):from;_replaceRange(this,code,from,to,origin);},getRange:function getRange(from,to,lineSep){var lines=getBetween(this,_clipPos(this,from),_clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||this.lineSeparator());},getLine:function getLine(line){var l=this.getLineHandle(line);return l&&l.text;},getLineHandle:function getLineHandle(line){if(isLine(this,line))return getLine(this,line);},getLineNumber:function getLineNumber(line){return lineNo(line);},getLineHandleVisualStart:function getLineHandleVisualStart(line){if(typeof line=="number")line=getLine(this,line);return visualLine(line);},lineCount:function lineCount(){return this.size;},firstLine:function firstLine(){return this.first;},lastLine:function lastLine(){return this.first+this.size-1;},clipPos:function clipPos(pos){return _clipPos(this,pos);},getCursor:function getCursor(start){var range=this.sel.primary(),pos;if(start==null||start=="head")pos=range.head;else if(start=="anchor")pos=range.anchor;else if(start=="end"||start=="to"||start===false)pos=range.to();else pos=range.from();return pos;},listSelections:function listSelections(){return this.sel.ranges;},somethingSelected:function somethingSelected(){return this.sel.somethingSelected();},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,_clipPos(this,typeof line=="number"?Pos(line,ch||0):line),null,options);}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,_clipPos(this,anchor),_clipPos(this,head||anchor),options);}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,_clipPos(this,head),other&&_clipPos(this,other),options);}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads),options);}),extendSelectionsBy:docMethodOp(function(f,options){var heads=map(this.sel.ranges,f);extendSelections(this,clipPosArray(this,heads),options);}),setSelections:docMethodOp(function(ranges,primary,options){if(!ranges.length)return;for(var i=0,out=[];i<ranges.length;i++){out[i]=new Range(_clipPos(this,ranges[i].anchor),_clipPos(this,ranges[i].head));}if(primary==null)primary=Math.min(ranges.length-1,this.sel.primIndex);setSelection(this,normalizeSelection(out,primary),options);}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(_clipPos(this,anchor),_clipPos(this,head||anchor)));setSelection(this,normalizeSelection(ranges,ranges.length-1),options);}),getSelection:function getSelection(lineSep){var ranges=this.sel.ranges,lines;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel;}if(lineSep===false)return lines;else return lines.join(lineSep||this.lineSeparator());},getSelections:function getSelections(lineSep){var parts=[],ranges=this.sel.ranges;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());if(lineSep!==false)sel=sel.join(lineSep||this.lineSeparator());parts[i]=sel;}return parts;},replaceSelection:function replaceSelection(code,collapse,origin){var dup=[];for(var i=0;i<this.sel.ranges.length;i++){dup[i]=code;}this.replaceSelections(dup,collapse,origin||"+input");},replaceSelections:docMethodOp(function(code,collapse,origin){var changes=[],sel=this.sel;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this.splitLines(code[i]),origin:origin};}var newSel=collapse&&collapse!="end"&&computeReplacedSel(this,changes,collapse);for(var i=changes.length-1;i>=0;i--){makeChange(this,changes[i]);}if(newSel)setSelectionReplaceHistory(this,newSel);else if(this.cm)ensureCursorVisible(this.cm);}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo");}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo");}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",true);}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",true);}),setExtending:function setExtending(val){this.extend=val;},getExtending:function getExtending(){return this.extend;},historySize:function historySize(){var hist=this.history,done=0,undone=0;for(var i=0;i<hist.done.length;i++){if(!hist.done[i].ranges)++done;}for(var i=0;i<hist.undone.length;i++){if(!hist.undone[i].ranges)++undone;}return{undo:done,redo:undone};},clearHistory:function clearHistory(){this.history=new History(this.history.maxGeneration);},markClean:function markClean(){this.cleanGeneration=this.changeGeneration(true);},changeGeneration:function changeGeneration(forceSplit){if(forceSplit)this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null;return this.history.generation;},isClean:function isClean(gen){return this.history.generation==(gen||this.cleanGeneration);},getHistory:function getHistory(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)};},setHistory:function setHistory(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,true);hist.undone=copyHistoryArray(histData.undone.slice(0),null,true);},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";if(!line[prop])line[prop]=cls;else if(classTest(cls).test(line[prop]))return false;else line[prop]+=" "+cls;return true;});}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var found=cur.match(classTest(cls));if(!found)return false;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(!found.index||end==cur.length?"":" ")+cur.slice(end)||null;}return true;});}),addLineWidget:docMethodOp(function(handle,node,options){return addLineWidget(this,handle,node,options);}),removeLineWidget:function removeLineWidget(widget){widget.clear();},markText:function markText(from,to,options){return _markText(this,_clipPos(this,from),_clipPos(this,to),options,options&&options.type||"range");},setBookmark:function setBookmark(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:false,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};pos=_clipPos(this,pos);return _markText(this,pos,pos,realOpts,"bookmark");},findMarksAt:function findMarksAt(pos){pos=_clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker);}return markers;},findMarks:function findMarks(from,to,filter){from=_clipPos(this,from);to=_clipPos(this,to);var found=[],lineNo=from.line;this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];if(!(lineNo==from.line&&from.ch>span.to||span.from==null&&lineNo!=from.line||lineNo==to.line&&span.from>to.ch)&&(!filter||filter(span.marker)))found.push(span.marker.parent||span.marker);}++lineNo;});return found;},getAllMarks:function getAllMarks(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){if(sps[i].from!=null)markers.push(sps[i].marker);}});return markers;},posFromIndex:function posFromIndex(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true;}off-=sz;++lineNo;});return _clipPos(this,Pos(lineNo,ch));},indexFromPos:function indexFromPos(coords){coords=_clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1;});return index;},copy:function copy(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel=this.sel;doc.extend=false;if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory());}return doc;},linkedDoc:function linkedDoc(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];copySharedMarkers(copy,findSharedMarkers(this));return copy;},unlinkDoc:function unlinkDoc(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);detachSharedMarkers(findSharedMarkers(this));break;}
if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id);},true);other.history=new History(null);other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds);}},iterLinkedDocs:function iterLinkedDocs(f){linkedDocs(this,f);},getMode:function getMode(){return this.mode;},getEditor:function getEditor(){return this.cm;},splitLines:function splitLines(str){if(this.lineSep)return str.split(this.lineSep);return splitLinesAuto(str);},lineSeparator:function lineSeparator(){return this.lineSep||"\n";}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype){if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments);};}(Doc.prototype[prop]);}eventMixin(Doc);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared);}}propagate(doc,null,true);}
function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)findMaxLine(cm);cm.options.mode=doc.modeOption;regChange(cm);}
function getLine(doc,n){n-=doc.first;if(n<0||n>=doc.size)throw new Error("There is no line "+(n+doc.first)+" in the document.");for(var chunk=doc;!chunk.lines;){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break;}n-=sz;}}return chunk.lines[n];}
function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n;});return out;}
function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text);});return out;}
function updateLineHeight(line,height){var diff=height-line.height;if(diff)for(var n=line;n;n=n.parent){n.height+=diff;}}
function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize();}}return no+cur.first;}
function _lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0;i<chunk.children.length;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer;}h-=ch;n+=child.chunkSize();}return n;}while(!chunk.lines);for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh;}return n+i;}
function _heightAtLine(lineObj){lineObj=visualLine(lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height;}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height;}}return h;}
function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order;}
function History(startGen){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=startGen||1;}
function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);},true);return histChange;}
function clearSelectionEvents(array){while(array.length){var last=lst(array);if(last.ranges)array.pop();else break;}}
function lastChangeEvent(hist,force){if(force){clearSelectionEvents(hist.done);return lst(hist.done);}else if(hist.done.length&&!lst(hist.done).ranges){return lst(hist.done);}else if(hist.done.length>1&&!hist.done[hist.done.length-2].ranges){hist.done.pop();return lst(hist.done);}}
function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date(),cur;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)=="+"&&doc.cm&&hist.lastModTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)=="*"))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){var last=lst(cur.changes);if(cmp(change.from,change.to)==0&&cmp(change.from,last.to)==0){last.to=changeEnd(change);}else{cur.changes.push(historyChangeFromChange(doc,change));}}else{var before=lst(hist.done);if(!before||!before.ranges)pushSelectionToHistory(doc.sel,hist.done);cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation};hist.done.push(cur);while(hist.done.length>hist.undoDepth){hist.done.shift();if(!hist.done[0].ranges)hist.done.shift();}}hist.done.push(selAfter);hist.generation=++hist.maxGeneration;hist.lastModTime=hist.lastSelTime=time;hist.lastOp=hist.lastSelOp=opId;hist.lastOrigin=hist.lastSelOrigin=change.origin;if(!last)signal(doc,"historyAdded");}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return ch=="*"||ch=="+"&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date()-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500);}
function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;if(opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel)))hist.done[hist.done.length-1]=sel;else pushSelectionToHistory(sel,hist.done);hist.lastSelTime=+new Date();hist.lastSelOrigin=origin;hist.lastSelOp=opId;if(options&&options.clearRedo!==false)clearSelectionEvents(hist.undone);}function pushSelectionToHistory(sel,dest){var top=lst(dest);if(!(top&&top.ranges&&top.equals(sel)))dest.push(sel);}
function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans;++n;});}
function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i);}else if(out)out.push(spans[i]);}return!out?spans:out.length?out:null;}
function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i){nw.push(removeClearedSpans(found[i]));}return nw;}
function copyHistoryArray(events,newGroup,instantiateSel){for(var i=0,copy=[];i<events.length;++i){var event=events[i];if(event.ranges){copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);continue;}var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change){if(m=prop.match(/^spans_(\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop];}}}}}return copy;}
function rebaseHistSelSingle(pos,from,to,diff){if(to<pos.line){pos.line+=diff;}else if(from<pos.line){pos.line=from;pos.ch=0;}}
function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;if(sub.ranges){if(!sub.copied){sub=array[i]=sub.deepCopy();sub.copied=true;}for(var j=0;j<sub.ranges.length;j++){rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff);rebaseHistSelSingle(sub.ranges[j].head,from,to,diff);}continue;}for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(to<cur.from.line){cur.from=Pos(cur.from.line+diff,cur.from.ch);cur.to=Pos(cur.to.line+diff,cur.to.ch);}else if(from<=cur.to.line){ok=false;break;}}if(!ok){array.splice(0,i+1);i=0;}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff);}
var e_preventDefault=CodeMirror.e_preventDefault=function(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false;};var e_stopPropagation=CodeMirror.e_stopPropagation=function(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;};function e_defaultPrevented(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==false;}var e_stop=CodeMirror.e_stop=function(e){e_preventDefault(e);e_stopPropagation(e);};function e_target(e){return e.target||e.srcElement;}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2;}if(mac&&e.ctrlKey&&b==1)b=3;return b;}
var on=CodeMirror.on=function(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f);}};var noHandlers=[];function getHandlers(emitter,type,copy){var arr=emitter._handlers&&emitter._handlers[type];if(copy)return arr&&arr.length>0?arr.slice():noHandlers;else return arr||noHandlers;}var off=CodeMirror.off=function(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var handlers=getHandlers(emitter,type,false);for(var i=0;i<handlers.length;++i){if(handlers[i]==f){handlers.splice(i,1);break;}}}};var signal=CodeMirror.signal=function(emitter,type){var handlers=getHandlers(emitter,type,true);if(!handlers.length)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<handlers.length;++i){handlers[i].apply(null,args);}};var orphanDelayedCallbacks=null;function signalLater(emitter,type){var arr=getHandlers(emitter,type,false);if(!arr.length)return;var args=Array.prototype.slice.call(arguments,2),list;if(operationGroup){list=operationGroup.delayedCallbacks;}else if(orphanDelayedCallbacks){list=orphanDelayedCallbacks;}else{list=orphanDelayedCallbacks=[];setTimeout(fireOrphanDelayed,0);}function bnd(f){return function(){f.apply(null,args);};};for(var i=0;i<arr.length;++i){list.push(bnd(arr[i]));}}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i){delayed[i]();}}
function signalDOMEvent(cm,e,override){if(typeof e=="string")e={type:e,preventDefault:function preventDefault(){this.defaultPrevented=true;}};signal(cm,override||e.type,cm,e);return e_defaultPrevented(e)||e.codemirrorIgnore;}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(!arr)return;var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]);for(var i=0;i<arr.length;++i){if(indexOf(set,arr[i])==-1)set.push(arr[i]);}}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0;}
function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f);};ctor.prototype.off=function(type,f){off(this,type,f);};}
var scrollerGap=30;var Pass=CodeMirror.Pass={toString:function toString(){return"CodeMirror.Pass";}};var sel_dontScroll={scroll:false},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};function Delayed(){this.id=null;}Delayed.prototype.set=function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms);};var countColumn=CodeMirror.countColumn=function(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\s\u00a0]/);if(end==-1)end=string.length;}for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("\t",i);if(nextTab<0||nextTab>=end)return n+(end-i);n+=nextTab-i;n+=tabSize-n%tabSize;i=nextTab+1;}};var findColumn=CodeMirror.findColumn=function(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("\t",pos);if(nextTab==-1)nextTab=string.length;var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal)return pos+Math.min(skipped,goal-col);col+=nextTab-pos;col+=tabSize-col%tabSize;pos=nextTab+1;if(col>=goal)return pos;}};var spaceStrs=[""];function spaceStr(n){while(spaceStrs.length<=n){spaceStrs.push(lst(spaceStrs)+" ");}return spaceStrs[n];}function lst(arr){return arr[arr.length-1];}var selectInput=function selectInput(node){node.select();};if(ios)
selectInput=function selectInput(node){node.selectionStart=0;node.selectionEnd=node.value.length;};else if(ie)
selectInput=function selectInput(node){try{node.select();}catch(_e){}};function indexOf(array,elt){for(var i=0;i<array.length;++i){if(array[i]==elt)return i;}return-1;}function map(array,f){var out=[];for(var i=0;i<array.length;i++){out[i]=f(array[i],i);}return out;}function nothing(){}function createObj(base,props){var inst;if(Object.create){inst=Object.create(base);}else{nothing.prototype=base;inst=new nothing();}if(props)copyObj(props,inst);return inst;};function copyObj(obj,target,overwrite){if(!target)target={};for(var prop in obj){if(obj.hasOwnProperty(prop)&&(overwrite!==false||!target.hasOwnProperty(prop)))target[prop]=obj[prop];}return target;}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args);};}var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var isWordCharBasic=CodeMirror.isWordChar=function(ch){return/\w/.test(ch)||ch>"\x80"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch));};function isWordChar(ch,helper){if(!helper)return isWordCharBasic(ch);if(helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch))return true;return helper.test(ch);}function isEmpty(obj){for(var n in obj){if(obj.hasOwnProperty(n)&&obj[n])return false;}return true;}
var extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch);}
function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content=="string")e.appendChild(document.createTextNode(content));else if(content)for(var i=0;i<content.length;++i){e.appendChild(content[i]);}return e;}var range;if(document.createRange)range=function range(node,start,end,endNode){var r=document.createRange();r.setEnd(endNode||node,end);r.setStart(node,start);return r;};else range=function range(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode);}catch(e){return r;}r.collapse(true);r.moveEnd("character",end);r.moveStart("character",start);return r;};function removeChildren(e){for(var count=e.childNodes.length;count>0;--count){e.removeChild(e.firstChild);}return e;}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e);}var contains=CodeMirror.contains=function(parent,child){if(child.nodeType==3)
child=child.parentNode;if(parent.contains)return parent.contains(child);do{if(child.nodeType==11)child=child.host;if(child==parent)return true;}while(child=child.parentNode);};function activeElt(){var activeElement=document.activeElement;while(activeElement&&activeElement.root&&activeElement.root.activeElement){activeElement=activeElement.root.activeElement;}return activeElement;}
if(ie&&ie_version<11)activeElt=function activeElt(){try{return document.activeElement;}catch(e){return document.body;}};function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*");}var rmClass=CodeMirror.rmClass=function(node,cls){var current=node.className;var match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"");}};var addClass=CodeMirror.addClass=function(node,cls){var current=node.className;if(!classTest(cls).test(current))node.className+=(current?" ":"")+cls;};function joinClasses(a,b){var as=a.split(" ");for(var i=0;i<as.length;i++){if(as[i]&&!classTest(as[i]).test(b))b+=" "+as[i];}return b;}
function forEachCodeMirror(f){if(!document.body.getElementsByClassName)return;var byClass=document.body.getElementsByClassName("CodeMirror");for(var i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;if(cm)f(cm);}}var globalsRegistered=false;function ensureGlobalHandlers(){if(globalsRegistered)return;registerGlobalHandlers();globalsRegistered=true;}function registerGlobalHandlers(){var resizeTimer;on(window,"resize",function(){if(resizeTimer==null)resizeTimer=setTimeout(function(){resizeTimer=null;forEachCodeMirror(onResize);},100);});on(window,"blur",function(){forEachCodeMirror(onBlur);});}
var dragAndDrop=function(){if(ie&&ie_version<9)return false;var div=elt('div');return"draggable"in div||"dragDrop"in div;}();var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt("span","\u200B");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&ie_version<8);}var node=zwspSupported?elt("span","\u200B"):elt("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");node.setAttribute("cm-text","");return node;}
var badBidiRects;function hasBadBidiRects(measure){if(badBidiRects!=null)return badBidiRects;var txt=removeChildrenAndAdd(measure,document.createTextNode("A\u062EA"));var r0=range(txt,0,1).getBoundingClientRect();if(!r0||r0.left==r0.right)return false;var r1=range(txt,1,2).getBoundingClientRect();return badBidiRects=r1.right-r0.right<3;}
var splitLinesAuto=CodeMirror.splitLines="\n\nb".split(/\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\n",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)=="\r"?nl-1:nl);var rt=line.indexOf("\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1;}else{result.push(line);pos=nl+1;}}return result;}:function(string){return string.split(/\r\n?|\n/);};var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd;}catch(e){return false;}}:function(te){try{var range=te.ownerDocument.selection.createRange();}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints("StartToEnd",range)!=0;};var hasCopyEvent=function(){var e=elt("div");if("oncopy"in e)return true;e.setAttribute("oncopy","return;");return typeof e.oncopy=="function";}();var badZoomedRects=null;function hasBadZoomedRects(measure){if(badZoomedRects!=null)return badZoomedRects;var node=removeChildrenAndAdd(measure,elt("span","x"));var normal=node.getBoundingClientRect();var fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1;}
var keyNames=CodeMirror.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var i=0;i<10;i++){keyNames[i+48]=keyNames[i+96]=String(i);}
for(var i=65;i<=90;i++){keyNames[i]=String.fromCharCode(i);}
for(var i=1;i<=12;i++){keyNames[i+111]=keyNames[i+63235]="F"+i;}})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");var found=false;for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from){f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?"rtl":"ltr");found=true;}}if(!found)f(from,to,"ltr");}function bidiLeft(part){return part.level%2?part.to:part.from;}function bidiRight(part){return part.level%2?part.from:part.to;}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0;}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order));}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch);}function lineEnd(cm,lineN){var merged,line=getLine(cm.doc,lineN);while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;lineN=null;}var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN==null?lineNo(line):lineN,ch);}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line);var line=getLine(cm.doc,start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\S/));var inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS);}return start;}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir)return true;if(b==linedir)return false;return a<b;}var bidiOther;function getBidiPartAt(order,pos){bidiOther=null;for(var i=0,found;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos)return i;if(cur.from==pos||cur.to==pos){if(found==null){found=i;}else if(compareBidiLevel(order,cur.level,order[found].level)){if(cur.from!=cur.to)bidiOther=found;return i;}else{if(cur.from!=cur.to)bidiOther=i;return found;}}}return found;}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do{pos+=dir;}while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos;}
function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos)return target;part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from;}else{part=bidi[pos+=dir];if(!part)return null;if(dir>0==part.level%2)target=moveInLine(line,part.to,-1,byUnit);else target=moveInLine(line,part.from,1,byUnit);}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar(line.text.charAt(target))){target+=dir;}return target<0||target>line.text.length?null:target;}
var bidiOrdering=function(){var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function charType(code){if(code<=0xf7)return lowTypes.charAt(code);else if(0x590<=code&&code<=0x5f4)return"R";else if(0x600<=code&&code<=0x6ed)return arabicTypes.charAt(code-0x600);else if(0x6ee<=code&&code<=0x8ac)return"r";else if(0x2000<=code&&code<=0x200b)return"w";else if(code==0x200c)return"b";else return"L";}var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType="L";function BidiSpan(level,from,to){this.level=level;this.from=from;this.to=to;}return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i){types.push(type=charType(str.charCodeAt(i)));}
for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type=="m")types[i]=prev;else prev=type;}
for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type=="1"&&cur=="r")types[i]="n";else if(isStrong.test(type)){cur=type;if(type=="r")types[i]="R";}}
for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type=="+"&&prev=="1"&&types[i+1]=="1")types[i]="1";else if(type==","&&prev==types[i+1]&&(prev=="1"||prev=="n"))types[i]=prev;prev=type;}
for(var i=0;i<len;++i){var type=types[i];if(type==",")types[i]="N";else if(type=="%"){for(var end=i+1;end<len&&types[end]=="%";++end){}var replace=i&&types[i-1]=="!"||end<len&&types[end]=="1"?"1":"N";for(var j=i;j<end;++j){types[j]=replace;}i=end-1;}}
for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur=="L"&&type=="1")types[i]="L";else if(isStrong.test(type))cur=type;}
for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)=="L";var after=(end<len?types[end]:outerType)=="L";var replace=before||after?"L":"R";for(var j=i;j<end;++j){types[j]=replace;}i=end-1;}}
var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push(new BidiSpan(0,start,i));}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!="L";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,new BidiSpan(1,pos,j));var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,new BidiSpan(2,nstart,j));pos=j;}else++j;}if(pos<i)order.splice(at,0,new BidiSpan(1,pos,i));}}if(order[0].level==1&&(m=str.match(/^\s+/))){order[0].from=m[0].length;order.unshift(new BidiSpan(0,0,m[0].length));}if(lst(order).level==1&&(m=str.match(/\s+$/))){lst(order).to-=m[0].length;order.push(new BidiSpan(0,len-m[0].length,len));}if(order[0].level==2)order.unshift(new BidiSpan(1,order[0].to,order[0].to));if(order[0].level!=lst(order).level)order.push(new BidiSpan(order[0].level,len,len));return order;};}();CodeMirror.version="5.11.0";return CodeMirror;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','classNames','CodeMirror'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('classNames'),require('CodeMirror'));}else{factory(root,root.React,root.classNames,root.CodeMirror);}})(window,function(exports,React,classNames,CodeMirror){var h=React.h;function normalizeLineEndings(str){if(!str)return str;return str.replace(/\r\n|\r/g,'\n');}
var ReactCodeMirror=function(_React$Component){_inherits(ReactCodeMirror,_React$Component);function ReactCodeMirror(props){_classCallCheck(this,ReactCodeMirror);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props));_this.state={isFocused:false,preserveScrollPosition:false};return _this;}
ReactCodeMirror.prototype.getCodeMirrorInstance=function getCodeMirrorInstance(){return this.props.codeMirrorInstance||CodeMirror;};ReactCodeMirror.prototype.refDefine=function refDefine(name){var refs=this.refs=this.refs||{};return function(dom){refs[name]=dom;};};ReactCodeMirror.prototype.componentDidMount=function componentDidMount(){var textareaNode=this.refs.textarea;var codeMirrorInstance=this.getCodeMirrorInstance();this.codeMirror=codeMirrorInstance.fromTextArea(textareaNode,this.props.options);this.codeMirror.on('change',this.codemirrorValueChanged.bind(this));this.codeMirror.on('focus',this.focusChanged.bind(this,true));this.codeMirror.on('blur',this.focusChanged.bind(this,false));this.codeMirror.on('scroll',this.scrollChanged.bind(this));this.codeMirror.setValue(this.props.value||'');};ReactCodeMirror.prototype.componentWillUnmount=function componentWillUnmount(){if(this.codeMirror){this.codeMirror.toTextArea();}};ReactCodeMirror.prototype.componentWillReceiveProps=function componentWillReceiveProps(nextProps){if(this.codeMirror&&nextProps.value!==undefined&&normalizeLineEndings(this.codeMirror.getValue())!==normalizeLineEndings(nextProps.value)){if(this.props.preserveScrollPosition){var prevScrollPosition=this.codeMirror.getScrollInfo();this.codeMirror.setValue(nextProps.value);this.codeMirror.scrollTo(prevScrollPosition.left,prevScrollPosition.top);}else{this.codeMirror.setValue(nextProps.value);}}
if(nextProps.options!==this.props.options&&_typeof(nextProps.options)==='object'){for(var optionName in nextProps.options){if(nextProps.options.hasOwnProperty(optionName)){this.codeMirror.setOption(optionName,nextProps.options[optionName]);}}}};ReactCodeMirror.prototype.getCodeMirror=function getCodeMirror(){return this.codeMirror;};ReactCodeMirror.prototype.focus=function focus(){if(this.codeMirror){this.codeMirror.focus();}};ReactCodeMirror.prototype.focusChanged=function focusChanged(focused){this.setState({isFocused:focused});this.props.onFocusChange&&this.props.onFocusChange(focused);};ReactCodeMirror.prototype.scrollChanged=function scrollChanged(cm){this.props.onScroll&&this.props.onScroll(cm.getScrollInfo());};ReactCodeMirror.prototype.codemirrorValueChanged=function codemirrorValueChanged(doc,change){if(this.props.onChange&&change.origin!=='setValue'){this.props.onChange(doc.getValue(),change);}};ReactCodeMirror.prototype.render=function render(){return h('div',{className:classNames('React-codemirror',{'React-codemirror-focused':this.state.isFocused},this.props.className),style:this.props.style},[h('textarea',{ref:this.refDefine('textarea'),value:this.props.value,autoComplete:'off'})]);};return ReactCodeMirror;}(React.Component);exports.ReactCodeMirror=ReactCodeMirror;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var Validator=function($,undefined){var push=[].push;var rulesMap={};function RuleWrap(ele,name,rule){this.$ele=$(ele);this.name=name;this.rule=rule;this.defer=$.Deferred();this.value=this.$ele.val();};RuleWrap.prototype.valid=function(){var handler=this.rule.valid;var _this=this;var type=$.type(handler);if(type!=='function'&&type!=='string'){console.warn('rule is illigal!');return;}
else if(type==='string'&&rulesMap[handler]===undefined){console.warn('rule is not exists!');return;}
else if(type==='string'){handler=rulesMap[handler];}
return handler;};RuleWrap.prototype.success=function(){this.defer.resolveWith(this);};RuleWrap.prototype.fail=function(){this.defer.rejectWith(this);};function Validator(ele,options){if(arguments.length===0)return this;if(arguments.length===1){options=ele;ele='body';}
this.$ele=$.type(ele)==='object'?ele:$(ele);this.options=$.extend({},Validator.DEFAULTS,options);this.__merge(this,this.options.elements||[]);this.__init();return this;}
Validator.prototype.__init=function(){var $selectors;var html='<span class="glyphicon'+(this.options.icon?' glyphicon-pencil':'')+' form-control-feedback"></span>';for(var i=0,row,len=this.length;i<len;i++){row=this[i];$selectors=$.type(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);$selectors.each(function(i,ele){var $ele=$(ele),$formGroup;$formGroup=$ele.closest('.form-group');$formGroup.addClass('has-feedback');if($formGroup.children('form-control-feedback').length===0){$(html).insertAfter($ele);}});}};Validator.prototype.valid=function(callback){var self=this;var row,results=[];var $selectors;var deferGroups=[];this.resetStatus();for(var i=0,len=this.length;i<len;i++){row=this[i];$selectors=$.type(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);if($selectors.length===0)continue;$selectors.each(function(i,ele){var $ele=$(ele);var val=$ele.val();var defers=[];var obj;for(var t=0,len2=row.rules.length;t<len2;t++){obj=new RuleWrap(ele,row.name,row.rules[t]);defers.push(obj);}
defers[0].valid().call(defers[0],defers[0].value);defers=defers.map(function(row,i,arr){if(i+1<len2){row.defer.done(function(){arr[i+1].valid().call(arr[i+1],defers[0].value);});}
return row.defer;});deferGroups.push(defers);});}
deferGroups=deferGroups.map(function(deferGrp,i){var newDefer=$.Deferred();$.when.apply($,deferGrp).done(function(){var $ele,$formGroup;var _this,obj={};if(this.length)_this=this[0];else _this=this;$ele=_this.$ele;self.setStatus($ele,'success');obj[_this.name]=_this.value;newDefer.resolve(obj);}).fail(function(){var $ele=this.$ele,ele=$ele[0];self.setStatus($ele,'error');if(ele.timer!==null){window.clearTimeout(ele.timer);ele.timer=null;}
$ele.tooltip({placement:'top',trigger:'manual'}).attr('data-original-title',this.rule['msg']).tooltip('show');ele.timer=window.setTimeout(function($ele){return function(){$ele.tooltip('hide');$ele[0].timer=null;};}($ele),2000);newDefer.reject();});return newDefer;});return $.when.apply($,deferGroups).then(function(rs){return $.extend.apply($,[].slice.call(arguments));});};Validator.prototype.setStatus=function($ele,type){if(!this.options.icon)return;if(type==='error'){$ele.closest('.form-group').addClass('has-error').children('.form-control-feedback').removeClass(['glyphicon-ok','glyphicon-pencil'].join(' ')).addClass('glyphicon-remove');}else if(type==='success'){$ele.closest('.form-group').addClass('has-success').children('.form-control-feedback').removeClass(['glyphicon-pencil','glyphicon-remove'].join(' ')).addClass('glyphicon-ok');}};Validator.prototype.resetStatus=function(){var $selectors,row,$ele,ele,data;for(var i=0,len=this.length;i<len;i++){row=this[i];$selectors=_typeof(row['selector'])==='object'?row['selector']:$(row['selector'],this.$ele);for(var t=0,len2=$selectors.length;t<len2;t++){$ele=$selectors.eq(t);ele=$selectors[t];$ele.parents('.form-group').removeClass('has-error has-success');if(ele.timer){window.clearTimeout(ele.timer);ele.timer=null;}
if(data=$ele.data('bs.tooltip')){data.$tip.detach();}}}};Validator.prototype.filter=function(selector){return this.__seek(selector,true);};Validator.prototype.not=function(selector){return this.__seek(selector,false);};Validator.prototype.__seek=function(selector,isNeed){var results=[],ret;var eles=this.options.elements;var regx=$.type(selector)==='string'?new RegExp('^'+selector+'$'):regx;if($.type(regx)!=='regexp'){throw'selector is not a RegExp object or a string!';}
isNeed=isNeed||false;for(var i=0,len=eles.length;i<len;i++){if(!!regx.test(eles[i]['name'])===isNeed)results.push(eles[i]);}
ret=this.__merge(new this.constructor(),results);ret.prevObj=this;ret.$ele=this.$ele;ret.options=this.options;return ret;};Validator.prototype.__merge=function(newObj,arr){for(var i=0,len=arr.length;i<len;i++){push.call(newObj,arr[i]);}
return newObj;};Validator.prototype.length=0;Validator.prototype.splice=[].splice;Validator.extendRules=function(name,handler){var rules={},fn;if($.type(name)==='string')rules[name]=handler;else if($.type(name)==='object')rules=name;else return;for(var i in rules){if(!rules.hasOwnProperty(i))continue;fn=rules[i];if($.type(fn)!=='function')continue;rulesMap[i]=fn;}};Validator.extendRules({'require':function require(val){if(val.trim()==='')this.fail();else this.success();},'word':function word(val){if(/^\w+$/.test(val))this.success();else this.fail();},'wordWithSpace':function wordWithSpace(val){if(val.trim()!==val){this.fail();}else{if(/^[\w\s]+$/.test(val))this.success();else this.fail();}}});Validator.DEFAULTS={tooltipDelay:2000,icon:true};return Validator;}(jQuery);var Internationalization=function(){function Internationalization(lang,resource){this.type=lang||localStorage["language"];this.resource=resource||{};}
Internationalization.prototype={getResource:function getResource(){return this.resource;},fillPage:function fillPage(){this.fill2($('[i18n]'));},fillArea:function fillArea(element){this.fill2(element.find('[i18n]'));try{Permission.check(element);}catch(e){console.log('check permission failed:'+e);}},fillAreaAttribute:function fillAreaAttribute(element,attributeName){this.fill(element.find('[i18n]['+attributeName+']'),attributeName);},fill:function fill(arrElement,attributeName){for(var i=0,arrPath,text,len=arrElement.length;i<len;i++){arrPath=arrElement[i].attributes["i18n"].value.split('.');text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
if(!attributeName){arrElement[i].innerHTML=text;}else{arrElement[i].setAttribute(attributeName,text);}}},getI18nValue:function getI18nValue(i18nKey){if(!i18nKey){return'';}
var arrPath=i18nKey.split('.');var text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
return text;},fill2:function fill2(arrElement){for(var i=0,len=arrElement.length;i<len;i++){var i18nValue=arrElement[i].attributes["i18n"];var items=i18nValue.value.split(';'),item,attrMap;for(var j=0;j<items.length;j++){item=items[j];if(!item){continue;}
if(item.indexOf('=')===-1){i18nValue=this.getI18nValue(item);arrElement[i].innerHTML=i18nValue;}else{attrMap=item.split('=');if(!attrMap[0]){continue;}
arrElement[i].setAttribute(attrMap[0],this.getI18nValue(attrMap[1]));}}}},findContent:function findContent(strPath){var arrPath=strPath.split('.');var text=this.resource;for(var i=0,len=arrPath.length;i<len;i++){text=text&&text[arrPath[i]];}
return text;}};return Internationalization;}();function InitI18nResource(strLanguage,isForce,filePath){if(!strLanguage){strLanguage=localStorage["isUserSelectedLanguage"]||navigator.language.split('-')[0];}
if(isForce){localStorage["isUserSelectedLanguage"]=strLanguage;}else if(localStorage["isUserSelectedLanguage"]){strLanguage=localStorage["isUserSelectedLanguage"];}
filePath=filePath||'/static/views/js/i18n/';return $.ajax({async:false,url:filePath+strLanguage+".js",dataType:"script"}).then(function(){localStorage["language"]=strLanguage;return i18n_resource;},function(){return $.ajax({async:false,url:filePath+"en.js",dataType:'script'}).then(function(){localStorage["language"]="en";return i18n_resource;},function(){console.warn('i18n files loading failed!');return{};});});}
var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var infoBox=infoBox||{};(function($){var infoBoxBase={$el:null,options:{position:'center'},_init:function _init(){this._removeAll();this._createBox();if(this.options.movable){this._makeMovable();}},_createBox:function _createBox(){var me=this,$box;$('.infoBox-unique.'+me.options.boxType).remove();$box=$('<div class="infoBox infoBox-unique '+me.options.boxType+'"></div>');this.$el=$box;if(me.options.position){$box.addClass(me.options.position);}
if(me.options.hasHeader){var $header=$('<div class="infoBox-header"></div>');if(me.options.movable){$header.addClass('movable');}
if(me.options.title){$header.append('<div class="ellipsis infoBox-title">'+me.options.title+'</div>');}
if(me.options.hasClose){var $close=$('<div class="infoBox-close"></div>');$header.append($close);$close.click(function(){me._destroy();});}
if(me.options.hasResize){var $zoomIn=$('<div class="infoBox-resize"><span class="glyphicon glyphicon-resize-full" aria-hidden="true"></span></div>');$header.append($zoomIn);$zoomIn.off('click.resizeFull').on('click.resizeFull','.glyphicon-resize-full',function(){me._resizeFull();});$zoomIn.off('click.resizeSmall').on('click.resizeSmall','.glyphicon-resize-small',function(){me._resizeSmall();});}
$box.append($header);}
var $body=$('<div class="infoBox-body scrollbar"></div>');if(me.options.icon){$body.append('<div class="infoBox-icon"><img src="/static/scripts/lib/beopNotification/image/'+me.options.icon+'"></div>');}
if(_typeof(me.options.msg)===_typeof(1)){me.options.msg=String(me.options.msg);}
if(!me.options.msg){me.options.msg='';}
me.options.msg=me.options.msg.replace(/\n/g,'<br/>');var infoBoxMsgBox=$('<div class="infoBox-msg">').appendTo($body);infoBoxMsgBox.append('<div style="margin-top: 10px;">'+me.options.msg+'</div>');if(me.options.input){infoBoxMsgBox.append('<input class="form-control" style="width:250px;margin-top:10px;display:inline-block" />');}
$box.append($body);if(me.options.buttons){var $footer=$('<div class="infoBox-footer"></div>');$box.append($footer);for(var btnKey in me.options.buttons){if(me.options.buttons.hasOwnProperty(btnKey)){$footer.append(me._createBtn(me.options.buttons[btnKey]));}}}
if(me.options.delay){var $progress=$('<div class="progress progress-bar-success"><div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><span class="sr-only"</span></div></div>');$progress.insertBefore($body);$progress.animate({width:"100%"},+me.options.delay?+me.options.delay:20000,function(){me._destroy();});}
if(me.options.modal&&$('#infoBoxModal').length==0){var modalHtml='<div id="infoBoxModal"></div>';$('body').append(modalHtml);}
$box.appendTo(document.body);return $box;},_processInput:function _processInput(options){options.boxType=this.constructor.name?this.constructor.name:'';return options;},_show:function _show(){this.$el.fadeIn('fast');I18n.fillArea(this.$el);var $btn=this.$el.find('[i18n]');$btn.each(function(i,item){var arr=['OK','Cancel'];var $item=$(item);if(I18n.getI18nValue($item.attr('i18n'))===undefined){$item.html(arr[i]);}});},_hide:function _hide(){this.$el.hide();},_click:function _click(){var _this=this;this.$el.click(function(){_this._destroy();});},_destroy:function _destroy(){var me=this;me.$el.fadeOut('fast',function(){me.$el.remove();});if(me.options.modal){$('#infoBoxModal').remove();}},_resizeFull:function _resizeFull(){this.$el.addClass('full-size');this.$el.find('.infoBox-resize>.glyphicon').removeClass('glyphicon-resize-full').addClass('glyphicon-resize-small');},_resizeSmall:function _resizeSmall(){this.$el.removeClass('full-size');this.$el.find('.infoBox-resize>.glyphicon').removeClass('glyphicon-resize-small').addClass('glyphicon-resize-full');},_makeMovable:function _makeMovable(){var me=this;me.$el.mousedown(function(){me.$el.mousemove(function(e){var thisX=event.pageX-$(this).width()/2,thisY=event.pageY-$(this).height()/2;me.$el.offset({left:thisX,top:thisY});});}).mouseup(function(){me.$el.off('mousemove');});},_removeAll:function _removeAll(){if(this.options.boxType){if(this.options.boxType=='remind'){$(document.body).children('.remind').remove();}else{}}else{$(document.body).children('.infoBox-unique').remove();}},_createBtn:function _createBtn(option){var me=this;var $button=$('<button class="btn btn-info alert-button"></button>');$button.attr('i18n',option.i18n);$button.text(option.text);$button.click(function(){me._destroy();option.callback&&option.callback();});$button.addClass(option.css);this.$el.find('.infoBox-footer').append($button);},close:function close(){this._destroy();}};function infoBoxTip(msg,options){var _this=this;this.type=options&&options.type||infoBox.tip.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
this.options=this._processInput(options);this._init();this._show();this._click();if(!options.delay){options.delay=2000;}
setTimeout(function(){_this._destroy();},options.delay);}
infoBoxTip.prototype=$.extend({},infoBoxBase,{constructor:infoBoxTip,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.tip.base,infoBox.tip.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.tip=function(msg,options){return new infoBoxTip(msg,options);};infoBox.tip.base={position:'center',type:'info',modal:true,movable:false};infoBox.tip.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxPrompt(msg,_callback,cancelCallback,options){var _this=this;this.type=options&&options.type||infoBox.prompt.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
options=$.extend(true,options,{buttons:{ok:{callback:function callback(){_callback(_this.$el.find('input').val());}},cancel:{callback:cancelCallback}}});this.options=this._processInput(options);this._init();this._show();if(options.delay&&!isNaN(options.delay)){var timeout=setTimeout(function(){_this._destroy();timeout=null;},option.delay);}}
infoBoxPrompt.prototype=$.extend({},infoBoxBase,{constructor:infoBoxPrompt,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.prompt.base,infoBox.prompt.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.prompt=function(msg,callback,cancelCallback,options){return new infoBoxPrompt(msg,callback,cancelCallback,options);};infoBox.prompt.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:function callback(){return true;}},cancel:{text:'Cancel',i18n:'common.CANCEL',class:'alert-button',callback:function callback(){return false;}}},input:{},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.prompt.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxAlert(msg,options){var _this=this;this.type=options&&options.type||infoBox.alert.base.type;if(!options){options={msg:msg};}else{options=$.extend(options,{msg:msg});}
this.options=this._processInput(options);this._init();this._show();if(options.delay&&!isNaN(options.delay)){var timeout=setTimeout(function(){_this._destroy();timeout=null;},options.delay);}}
infoBoxAlert.prototype=$.extend({},infoBoxBase,{constructor:infoBoxAlert,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.alert.base,infoBox.alert.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.alert=function(msg,options){if(!options){options={};}
options['type']='info';return new infoBoxAlert(msg,options);};infoBox.alert.warning=function(msg,options){if(!options){options={};}
options['type']='warning';return new infoBoxAlert(msg,options);};infoBox.alert.success=function(msg,options){if(!options){options={};}
options['type']='success';return new infoBoxAlert(msg,options);};infoBox.alert.danger=function(msg,options){if(!options){options={};}
options['type']='danger';return new infoBoxAlert(msg,options);};infoBox.alert.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:''}},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.alert.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxConfirm(msg,okCallback,cancelCallback,options){this.type=options&&options.type||infoBox.confirm.base.type;if(!okCallback&&!cancelCallback){okCallback=function okCallback(){};cancelCallback=function cancelCallback(){};this.type='danger';msg='warning:you not pass the callback to confirm function';}
options=$.extend(options,{msg:msg,buttons:{ok:{callback:okCallback},cancel:{callback:cancelCallback}}});this.options=this._processInput(options);this._init();this._show();}
infoBoxConfirm.prototype=$.extend({},infoBoxBase,{constructor:infoBoxConfirm,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.confirm.base,infoBox.confirm.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.confirm=function(msg,okCallback,cancelCallback,options){return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.danger=function(msg,okCallback,cancelCallback,options){if(!options){options={};}
options['type']='danger';return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.warn=function(msg,okCallback,cancelCallback,options){if(!options){options={};}
options['type']='warn';return new infoBoxConfirm(msg,okCallback,cancelCallback,options);};infoBox.confirm.base={type:'info',buttons:{ok:{text:'OK',i18n:'common.CONFIRM',class:'alert-button',callback:function callback(){return true;}},cancel:{text:'Cancel',i18n:'common.CANCEL',class:'alert-button',callback:function callback(){return false;}}},modal:true,hasHeader:true,hasClose:true,movable:false};infoBox.confirm.options={success:{icon:'alert-success.png'},warning:{icon:'alert-warning.png'},danger:{icon:'alert-danger.png'},info:{icon:'alert-info.png'}};function infoBoxRemind(typeOrMsg,options){if(!options){this.type=infoBox.remind.base.type;options={msg:typeOrMsg};}
if(!typeOrMsg){this.type=infoBox.remind.base.type;}else if(infoBox.remind.options[typeOrMsg]){this.type=typeOrMsg;}else{options=$.extend(options,{msg:typeOrMsg});}
this.options=this._processInput(options);this._init();this.$el.slideDown(1000);}
infoBoxRemind.prototype=$.extend({},infoBoxBase,{constructor:infoBoxRemind,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.remind.base,infoBox.remind.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.remind=function(type,options){return new infoBoxRemind(type,options);};infoBox.remind.base={type:'info',modal:false,hasHeader:true,hasClose:true};infoBox.remind.options={};function infoBoxVersion(title,content){this.options=this._processInput({'msg':content});this._init();var $versionTitle='<div class="ellipsis infoBoxVersion-title" title="'+title+'">'+'<span class="dib mr5">版本号：</span><span>'+title+'</span></div>';this.$el.find('.infoBox-header').append($versionTitle);this.$el.slideDown(1000);}
infoBoxVersion.prototype=$.extend({},infoBoxBase,{constructor:infoBoxVersion,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.version.base,infoBox.version.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.version=function(title,content){return new infoBoxVersion(title,content);};infoBox.version.base={modal:false,hasHeader:true,hasClose:true,delay:10000};infoBox.version.options={};function infoBoxMessage(content,options){this.options=this._processInput({'msg':content});this._init();var $messageTitle='<div style="position: relative; top: -10px;"><span class="fl">'+i18n_resource.workflow.message.MESSAGE+'</span>'+'<span class="fr header-right" style="cursor: pointer;"><span class="mr5 markAsAllRead">'+i18n_resource.workflow.message.ALL_READ+'</span><span class="glyphicon glyphicon-envelope"></span></span></div>';this.$el.find('.infoBox-header').append($messageTitle);options.initCb&&options.initCb.call(this);this.$el.slideDown(300);}
infoBoxMessage.prototype=$.extend({},infoBoxBase,{constructor:infoBoxMessage,_processInput:function _processInput(options){var mergedOptions=infoBoxBase._processInput.call(this,options);options=$.extend(true,{},infoBox.message.base,infoBox.message.options[this.type],mergedOptions);return options;},_init:function _init(){infoBoxBase._init.call(this);}});infoBox.message=function(content,options){return new infoBoxMessage(content,options);};infoBox.message.base={modal:false,hasHeader:true};infoBox.message.options={};})(jQuery);try{if(infoBox){alert=infoBox.alert;tip=infoBox.tip;confirm=infoBox.confirm;remindInfoBox=infoBox.remind;versionInfoBox=infoBox.version;messageInfoBox=infoBox.message;}}catch(e){console.warn('弹框初始化失败'+e);}
var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var beop=beop||{};beop.constant={project_img_path:'/static/images/project_img/',project_default_img:'default.jpg',BEOP_IMG_HOST:'http://images.rnbtech.com.hk',OSS_PROJECT_IMG_PATH:'/custom/project_img/'};var ObjectId=function ObjectId(){var timestamp=new Date().valueOf();var userId=('000'+(window.AppConfig&&window.AppConfig.userId||'000')).slice(-3);var hex8=('00000000'+Math.floor(Math.random()*0xFFFFFFFF).toString(16)).slice(-8);return timestamp+userId+hex8;};(function(exports){exports.namespace=function(path){var obj=window;path=path.split('.');path.forEach(function(p,i){p=p.trim();if(i===0&&p==='window')return;obj=obj[p]=obj[p]||{};});return obj;};})(window);(function(exports){exports.Mixin=function(){var prototype={};var methods;for(var i=0,len=arguments.length;i<len;i++){methods=arguments[i];for(var m in methods){prototype[m]=methods[m];}}
return prototype;};})(window);(function(){var ENUM_LEVEL={LOG:1,INFO:2,DEBUG:3,WARN:4,ERROR:5,EXCEPTION:6};window.Log={level:ENUM_LEVEL.WARN,log:function log(){if(this.level>ENUM_LEVEL.LOG)return;Log._out('log',arguments);},info:function info(){if(this.level>ENUM_LEVEL.INFO)return;Log._out('info',arguments);},debug:function debug(){if(this.level>ENUM_LEVEL.DEBUG)return;Log._out('debug',arguments);},warn:function warn(){if(this.level>ENUM_LEVEL.WARN)return;Log._out('warn',arguments);},error:function error(){if(this.level>ENUM_LEVEL.ERROR)return;Log._out('error',arguments);},exception:function exception(message,_exception){if(this.level>ENUM_LEVEL.EXCEPTION)return;if(_exception){Log.error('Exception: ',message,_exception.stack||_exception);}else{Log.error('Exception: ',message);}},_out:function _out(type,args){console[type].apply(console,args);}};})();if(!Array.toMap){Array.toMap=function(arr,key){var map={};arr.forEach(function(row,i){map[row[key]]=row;});return map;};}
var FullScreenManager=function(){var manager=Object.create({init:function init(){var _this=this;$(document).off('webkitfullscreenchange');$(document).on('webkitfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('mozfullscreenchange');$(document).on('mozfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('msfullscreenchange');$(document).on('msfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});if(typeof onError==='function'){$(document).off('webkitfullscreenerror');$(document).on('webkitfullscreenerror',this.onFullScreenError);$(document).off('mozfullscreenerror');$(document).on('mozfullscreenerror',this.onFullScreenError);$(document).off('msfullscreenerror');$(document).on('msfullscreenerror',this.onFullScreenError);}},onFullScreenEnter:function onFullScreenEnter(){},onFullScreenOut:function onFullScreenOut(){},onFullScreenError:function onFullScreenError(){},toggle:function toggle(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen();}else if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen();}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen();}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}}else{if(document.exitFullscreen){document.exitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}}}});manager.init();return manager;}();function StringBuilder(){this.data=Array("");}
StringBuilder.prototype.append=function(){this.data.push(arguments[0]);return this;};StringBuilder.prototype.toString=function(){return this.data.join("");};StringBuilder.prototype.getLength=function(){return this.data.length;};if(!String.prototype.format){String.prototype.format=function(){if(arguments[0]===undefined){return'';}
if(arguments[0].constructor===Array){var args=arguments[0];}else{var args=arguments;}
return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};}
if(!String.prototype.formatEL){String.prototype.formatEL=function(o,defaultVal){var str=this.toString();if(!str||!o)return'';for(var p in o){if(o.hasOwnProperty(p)){str=str.replace(new RegExp('{'+p+'}','g'),o[p]);}}
if(typeof defaultVal!=='undefined'){str=str.replace(/{[^{}]*?}/g,defaultVal);}
return str;};}
String.prototype.toDate=function(){var str=this;if(str.indexOf('-')>-1)
str=str.replace('-','/').replace('-','/');return new Date(str);};if(!String.prototype.startsWith){String.prototype.startsWith=function(word){return new RegExp('^'+word).test(this);};}
Number.prototype.toDate=function(){return new Date(this);};function Alert(targetElement,type,msg){this.element=targetElement;this.str=new StringBuilder();this.str.append('<div style="display:none;" class="alert beop-alert alert-').append(type).append(' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>').append('<div class="alert-msg">'+msg+'</div>').append('</div>');this.$alert=$(this.str.toString());}
Alert.danger=function(targetElement,msg){return new Alert(targetElement,Alert.type.danger,msg);};Alert.warning=function(targetElement,msg){return new Alert(targetElement,Alert.type.warning,msg);};Alert.success=function(targetElement,msg){return new Alert(targetElement,Alert.type.success,msg);};Alert.info=function(targetElement,msg){return new Alert(targetElement,Alert.type.info,msg);};Alert.closeAll=function(){$('.beop-alert').remove();};Alert.type={danger:'danger',warning:'warning',success:'success',info:'info'};Alert.prototype.show=function(duration){Alert.closeAll();if(duration){var _this=this;setTimeout(function(){_this.close();},duration);}
$(this.element).append(this.$alert);this.$alert.slideDown(500);return this;};Alert.prototype.close=function(){var _this=this;this.$alert.slideUp(500,function(){_this.$alert.remove();_this=null;});};Alert.prototype.setMessage=function(msg){if(!msg){return false;}
this.$alert.find('.alert-msg').text(msg);};Alert.prototype.setStyle=function(style){if(style&&typeof style!=='string'){this.$alert.css(style);}
return this;};Alert.prototype.showAtTop=function(duration){this.setStyle({position:'absolute',top:0,left:0,right:0,margin:'auto',width:'30%',textAlign:'center',zIndex:10000});if(!duration){duration=2000;}
this.show(duration);};function showDialog(url){return WebAPI.get(url).done(function(resultHtml){$("#dialogContent").html(resultHtml);$('#dialogModal').modal({});});}
function clone(obj){if(obj==null||(typeof obj==='undefined'?'undefined':_typeof(obj))!='object')return obj;var temp=obj.constructor();for(var key in obj){if(obj.hasOwnProperty(key)){temp[key]=clone(obj[key]);}}
return temp;}
Date.prototype.format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};var week={"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}
if(/(E+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+week[this.getDay()+""]);}
for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));}}
return fmt;};Date.prototype.timeFormat=function(format,type,language,option){var date=this;if(format&&(typeof format=='string'||(typeof format==='undefined'?'undefined':_typeof(format))=='object')){if((typeof format==='undefined'?'undefined':_typeof(format))=='object'&&(!format.separators||!format.parts)){format='yyyy-mm-dd hh:ii:ss';}}else{format='yyyy-mm-dd hh:ii:ss';}
if(arguments.length>=2){var paramArr=function(arrayish){return[].slice.call(arrayish);}(arguments);paramArr.shift();type=language=option=null;paramArr.forEach(function(it,i){if(typeof it=='string'){language=it;}else if(typeof it=='number'){type=it;}else if((typeof it==='undefined'?'undefined':_typeof(it))=='object'){option=it;}});}
var isReturnNull=false;if(option){for(var k in option){if(k=='isReturnNull'){isReturnNull=option[k];}}}
if(date=='Invalid Date'){console.warn("Invalid date.");if(isReturnNull){return'';}else{return date.toString();}}
var DATES={en:{"days":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],"daysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],"daysMin":["Su","Mo","Tu","We","Th","Fr","Sa","Su"],"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"meridiem":["am","pm"]}};language=language?DATES[language]?language:'en':'en';var formatObj=function(formatStr){if((typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return formatStr;}
if(type){formatStr=timeFormatChange(formatStr,type);}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(format);var val={yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear(),m:date.getMonth()+1,M:DATES[language].monthsShort[date.getMonth()],MM:DATES[language].months[date.getMonth()],d:date.getDate(),D:DATES[language].daysShort[date.getDay()],DD:DATES[language].days[date.getDay()],p:DATES[language].meridiem.length==2?DATES[language].meridiem[date.getHours()<12?0:1]:'',h:date.getHours(),i:date.getMinutes(),s:date.getSeconds()};if(DATES[language].meridiem.length==2){val.H=val.h%12==0?12:val.h%12;}else{val.H=val.h;}
val.HH=(val.H<10?'0':'')+val.H;val.P=val.p.toUpperCase();val.hh=(val.h<10?'0':'')+val.h;val.ii=(val.i<10?'0':'')+val.i;val.ss=(val.s<10?'0':'')+val.s;val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;var finTime='';for(var i=0,len=formatObj.separators.length;i<len;i++){finTime+=formatObj.separators[i]+(formatObj.parts[i]?val[formatObj.parts[i]]:'');}
return finTime;};var DateUtil=function(){var dateLocale={month:{en:{month_names:['January','February','March','April','May','June','July','August','September','October','November','December'],month_names_short:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']},zh:{month_names:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],month_names_short:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月']}}};function getWeekNumber(d){d=new Date(+d);d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1);var weekNo=Math.ceil(((d-yearStart)/86400000+1)/7);return[d.getFullYear(),weekNo];}
function getLastWeekNumberOf(y,w){w-=1;if(w===0){y=y-1;w=52;}
return[y,w];}
function getNextWeekNumberOf(y,w){w+=1;if(w===53){y+=1;w=1;}
return[y,w];}
function isLeapYear(y){if(Object.prototype.toString.call(y)==='[object Date]'){y=y.getFullYear();}
return y%4===0&&y%100!==0||y%400===0;}
function daysInMonth(dt){var m=dt.getMonth();if(m===1){return isLeapYear(dt)?29:28;}
return[31,28,31,30,31,30,31,31,30,31,30,31][m];}
function getFirstDayOfWeek(year,week){var d=new Date(year,0,1),offset=d.getTimezoneOffset();d.setDate(d.getDate()+4-(d.getDay()||7));d.setTime(d.getTime()+7*24*60*60*1000*(week+(year==d.getFullYear()?-1:0)));d.setTime(d.getTime()+(d.getTimezoneOffset()-offset)*60*1000);d.setDate(d.getDate()-3);return d;}
function getDateRangeOnWeekNumber(year,week){if(!year||!week){return;}
var firstDay=getFirstDayOfWeek(year,week),lastDay=new Date(firstDay);lastDay.setDate(firstDay.getDate()+6);return[firstDay,lastDay];}
function getMonthName(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names:dateLocale.month['en'].month_names;return monthList[index];}
function getMonthNameShort(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names_short:dateLocale.month['en'].month_names_short;return monthList[index];}
function getLastMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===1){return 12;}else{return currentMonth-1;}}
function getNextMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===12){return 1;}else{return currentMonth+1;}}
function getRelativeDateInfo(date1,date2){var now=new Date();var lang=I18n.type;var value1,value2,ts,info;if(!date1&&!date2)return'';value1=(date1||now).valueOf();value2=(date2||now).valueOf();ts=Math.floor(Math.abs(value1-value2)/1000);switch(true){case ts<60:info=ts+(ts===1?' second':' seconds');break;case ts<3600:ts=Math.floor(ts/60);info=ts+(ts===1?' minute':' minutes');break;case ts<86400:ts=Math.floor(ts/3600);info=ts+(ts===1?' hour':' hours');break;case ts<31536000:ts=Math.floor(ts/86400);info=ts+(ts===1?' day':' days');break;default:ts=Math.floor(ts/31536000);info=ts+(ts===1?' year':' years');break;}
info+=value1>value2?' ago':' later';if(lang==='zh'){info=info.replace(/\s(seconds?|minutes?|hours?|days?|years?)\s(ago|later)$/,function($0,$1,$2){var rs='';if($1.indexOf('second')>-1)rs+='秒';if($1.indexOf('minute')>-1)rs+='分钟';if($1.indexOf('hour')>-1)rs+='小时';if($1.indexOf('day')>-1)rs+='天';if($1.indexOf('year')>-1)rs+='年';if($2==='ago')rs+='前';if($2==='later')rs+='后';return rs;});}
return info;}
return{getWeekNumber:getWeekNumber,isLeapYear:isLeapYear,daysInMonth:daysInMonth,getLastWeekNumberOf:getLastWeekNumberOf,getNextWeekNumberOf:getNextWeekNumberOf,getDateRangeOnWeekNumber:getDateRangeOnWeekNumber,getFirstDayOfWeek:getFirstDayOfWeek,getMonthName:getMonthName,getMonthNameShort:getMonthNameShort,getLastMonth:getLastMonth,getNextMonth:getNextMonth,getRelativeDateInfo:getRelativeDateInfo,DATA_FORMAT:{FULL_DATETIME:'yyyy-mm-dd hh:ii:ss',FULL_DATETIME_CHANGE:'yyyy-MM-dd HH:mm:ss',FULL_DATETIME_ALL_SEC_CHANGE:'yyyy-MM-dd 00:00:00',FULL_DATETIME_ZERO_SEC_CHANGE:'yyyy-MM-dd HH:mm:00',FULL_DATETIME_NO_SEC_CHANGE:'yyyy-MM-dd HH:mm',FULL_DATETIME_ZERO_SEC:'yyyy-mm-dd hh:ii:00',FULL_DATETIME_HH_00_00:'yyyy-mm-dd hh:00:00',FULL_DATETIME_00_00_00:'yyyy-mm-dd 00:00:00',FULL_DATETIME_NO_SEC:'yyyy-mm-dd hh:ii',FULL_DATETIME_HH_00:'yyyy-mm-dd hh:00',FULL_DATETIME_00_00:'yyyy-mm-dd 00:00',FULL_DATE:'yyyy-mm-dd',TIME:'hh:ii:ss',TIME_HOUR_MINUTE:'hh:ii',TIME_ZERO_SEC:'hh:ii:00'}};}();var StringUtil=function(){var HTML_ENTITIES={'&':'&amp;','>':'&gt;','<':'&lt;','"':'&quot;',"'":'&#39;','`':'&#x60;'},HTML_ENTITIES_INVERT=invert(HTML_ENTITIES);function invert(obj){var result={},keys=Object.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;}
function padLeft(oldStr,padNum,padStr){if(!padStr){return oldStr;}
return new Array(padNum-String(oldStr).length+1).join(padStr)+oldStr;}
function htmlEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES[character];});}
function htmlUnEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES_INVERT).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES_INVERT[character];});}
var getI18nProjectName=function getI18nProjectName(project){if(!I18n||!project){return'';}
var result='';switch(I18n.type){case'en':{result=project.name_english;break;}
case'zh':{result=project.name_cn;break;}
default:{result=project.name_english;}}
return result||'';};return{padLeft:padLeft,htmlEscape:htmlEscape,htmlUnEscape:htmlUnEscape,getI18nProjectName:getI18nProjectName};}();var BEOPUtil=function(){var jsType={function:_typeof($.noop),number:_typeof(0),string:_typeof(''),undefined:typeof undefined==='undefined'?'undefined':_typeof(undefined)};var projectImgPath=beop.constant.project_img_path;var setRelativePosition=function setRelativePosition($obj,$target,topOffset,leftOffset){$target.css({"left":$obj.offset().left+$obj.width()+(leftOffset||5),"top":$obj.offset().top+(topOffset||10)});};var projectDefaultImgPath=projectImgPath+beop.constant.project_default_img;var getProjectImgPath=function getProjectImgPath(project){if(project){return project.pic?projectImgPath+project.pic:projectDefaultImgPath;}};var getProjectFromAppConfig=function getProjectFromAppConfig(projectId){for(var m=0,len=AppConfig.projectList.length;m<len;m++){if(AppConfig.projectList[m].id==projectId){return AppConfig.projectList[m];}}};function getFunctionName(func){if(!func||(typeof func==='undefined'?'undefined':_typeof(func))!=jsType.function){return'';}
var ret=func.toString();ret=ret.substr('function '.length);ret=ret.substr(0,ret.indexOf('('));return ret;}
function isUndefined(obj){return(typeof obj==='undefined'?'undefined':_typeof(obj))===jsType.undefined;}
function getCookie(name){var value="; "+document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)return parts.pop().split(";").shift();}
function logicContentHandle(content){if(content){content=content.replace(/\t/g,'    ');}
return content;}
function copyToClipboard(text,valueContainer){var valueContainer=valueContainer?valueContainer:document.body;if(window.clipboardData&&window.clipboardData.setData){return clipboardData.setData("Text",text);}else if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=text;textarea.style.position="fixed";valueContainer.appendChild(textarea);textarea.select();try{return document.execCommand("copy");}catch(ex){console.warn("Copy to clipboard failed.",ex);return false;}finally{valueContainer.removeChild(textarea);}}}
var projectImgType={logo:'logo.png',pdfCover:'pdf_cover.jpg'};function getProjectImgByType(projectId,name,extension){var img='';if(projectId){img+=projectId+'_';}
img+=name;if(extension){img+='.'+extension;}
return beop.constant.BEOP_IMG_HOST+beop.constant.OSS_PROJECT_IMG_PATH+img;}
function getProjectById(id){if(!id||!AppConfig.projectList){return null;}
for(var i=0;i<AppConfig.projectList.length;i++){var project=AppConfig.projectList[i];if(project.id==id){return project;}}
return null;}
return{setRelativePosition:setRelativePosition,getProjectImgPath:getProjectImgPath,getFunctionName:getFunctionName,isUndefined:isUndefined,getCookie:getCookie,getProjectFromAppConfig:getProjectFromAppConfig,logicContentHandle:logicContentHandle,copyToClipboard:copyToClipboard,getProjectImgByType:getProjectImgByType,getProjectById:getProjectById,projectImgType:projectImgType};}();(function(){var beop_tmpl_cache={};this.beopTmpl=function tmpl(str,data,htmlStr){var fn=!/\W/.test(str)?beop_tmpl_cache[str]=beop_tmpl_cache[str]||tmpl(htmlStr?htmlStr:document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split(/<!/).join("\t").replace(/((^|!>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)!>/g,"',$1,'").split("\t").join("');").split(/!>/).join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn;};})();var SidebarMenuEffect=function(){function SidebarMenuEffect(){}
SidebarMenuEffect.prototype.init=function(center,left,right){var _this=this;this.$paneCt=$(center);this.$leftBtn=$(center).find('#leftCt');this.$rightBtn=$(center).find('#rightCt');var container=document.getElementById('st-container'),buttons=Array.prototype.slice.call(document.querySelectorAll('.sideTrans')),refresh=function refresh(){var leftCol=0,rightCol=0,centerCol=0;var leftArrow='<span class="glyphicon glyphicon-chevron-left"></span>';var rightArrow='<span class="glyphicon glyphicon-chevron-right"></span>';if(_this.$leftBtn.length>0){if(container.className.indexOf('st-effect-7')>0){var prev=_this.$paneCt.prev('div')[0];if(prev&&prev.className.indexOf('col-')>-1){leftCol=parseInt(prev.classList[0].split('-')[2]);}else{leftCol=0;}
_this.$leftBtn.removeClass('leftCtClose').addClass('leftCtOpen').html(leftArrow);}else{leftCol=0;_this.$leftBtn.removeClass('leftCtOpen').addClass('leftCtClose').html(rightArrow);}}
if(_this.$rightBtn.length>0){if(container.className.indexOf('st-effect-1')>0){var next=_this.$paneCt.next('div')[0];if(next&&next.className.indexOf('col-')>-1){rightCol=parseInt(next.classList[0].split('-')[2]);}else{rightCol=0;}
_this.$rightBtn.removeClass('rightCtClose').addClass('rightCtOpen').html(rightArrow);}else{rightCol=0;_this.$rightBtn.removeClass('rightCtOpen').addClass('rightCtClose').html(leftArrow);}}
centerCol=12-leftCol-rightCol;_this.$paneCt.removeClass().addClass('col-sm-'+centerCol+' st-content');};buttons.forEach(function(el,i){var effect=el.getAttribute('data-effect');el.addEventListener('click',function(ev){var target=ev.target.getAttribute('data-effect')!=null?ev.target.getAttribute('data-effect'):ev.target.parentNode.getAttribute('data-effect');var stCtClass=document.getElementById('st-container').className;if(stCtClass.indexOf(target)<0){ev.stopPropagation();ev.preventDefault();container.classList.add(effect);setTimeout(function(){if($(container.children[0]).children('div').length==3){container.classList.add('st-menu-open');}
refresh();},250);}else{container.classList.remove(target);refresh();}});});};return SidebarMenuEffect;}();(function(window){{var unknown='-';var screenSize='';if(screen.width){var width=screen.width?screen.width:'';var height=screen.height?screen.height:'';screenSize+=''+width+" x "+height;}
var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browser=navigator.appName;var version=''+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=nAgt.indexOf('Opera'))!=-1){browser='Opera';version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('MSIE'))!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(verOffset+5);}
else if((verOffset=nAgt.indexOf('Chrome'))!=-1){browser='Chrome';version=nAgt.substring(verOffset+7);}
else if((verOffset=nAgt.indexOf('Safari'))!=-1){browser='Safari';version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('Firefox'))!=-1){browser='Firefox';version=nAgt.substring(verOffset+8);}
else if(nAgt.indexOf('Trident/')!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(nAgt.indexOf('rv:')+3);}
else if((nameOffset=nAgt.lastIndexOf(' ')+1)<(verOffset=nAgt.lastIndexOf('/'))){browser=nAgt.substring(nameOffset,verOffset);version=nAgt.substring(verOffset+1);if(browser.toLowerCase()==browser.toUpperCase()){browser=navigator.appName;}}
if((ix=version.indexOf(';'))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(' '))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(')'))!=-1)version=version.substring(0,ix);majorVersion=parseInt(''+version,10);if(isNaN(majorVersion)){version=''+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10);}
var mobile=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=='undefined'&&!cookieEnabled){document.cookie='testcookie';cookieEnabled=document.cookie.indexOf('testcookie')!=-1?true:false;}
var os=unknown;var clientStrings=[{s:'Windows 3.11',r:/Win16/},{s:'Windows 95',r:/(Windows 95|Win95|Windows_95)/},{s:'Windows ME',r:/(Win 9x 4.90|Windows ME)/},{s:'Windows 98',r:/(Windows 98|Win98)/},{s:'Windows CE',r:/Windows CE/},{s:'Windows 2000',r:/(Windows NT 5.0|Windows 2000)/},{s:'Windows XP',r:/(Windows NT 5.1|Windows XP)/},{s:'Windows Server 2003',r:/Windows NT 5.2/},{s:'Windows Vista',r:/Windows NT 6.0/},{s:'Windows 7',r:/(Windows 7|Windows NT 6.1)/},{s:'Windows 8.1',r:/(Windows 8.1|Windows NT 6.3)/},{s:'Windows 8',r:/(Windows 8|Windows NT 6.2)/},{s:'Windows NT 4.0',r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:'Windows ME',r:/Windows ME/},{s:'Android',r:/Android/},{s:'Open BSD',r:/OpenBSD/},{s:'Sun OS',r:/SunOS/},{s:'Linux',r:/(Linux|X11)/},{s:'iOS',r:/(iPhone|iPad|iPod)/},{s:'Mac OS X',r:/Mac OS X/},{s:'Mac OS',r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:'QNX',r:/QNX/},{s:'UNIX',r:/UNIX/},{s:'BeOS',r:/BeOS/},{s:'OS/2',r:/OS\/2/},{s:'Search Bot',r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var id in clientStrings){var cs=clientStrings[id];if(cs.r.test(nAgt)){os=cs.s;break;}}
var osVersion=unknown;if(/Windows/.test(os)){osVersion=/Windows (.*)/.exec(os)[1];os='Windows';}
switch(os){case'Mac OS X':osVersion=/Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];break;case'Android':osVersion=/Android ([\.\_\d]+)/.exec(nAgt)[1];break;case'iOS':osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);osVersion=osVersion[1]+'.'+osVersion[2]+'.'+(osVersion[3]|0);break;}}
window.jscd={screen:screenSize,browser:browser,browserVersion:version,mobile:mobile,os:os,osVersion:osVersion,cookies:cookieEnabled};})(this);var getUrlParams=function getUrlParams(){var search=window.location.search.substring(1);var kvArr=search.split('&');var rs={};kvArr.forEach(function(kv){var arr=kv.split('=');if(typeof arr[1]!=='undefined'){rs[arr[0]]=arr[1];}});return rs;};$.fn.serializeObject=function(){var obj={};this.serializeArray().map(function(item){if(/\[\]$/.test(item.name)){if(obj[item.name]){obj[item.name].push(item.value);}else{obj[item.name]=[item.value];}}else{obj[item.name]=item.value;}});return obj;};function kIntSeparate(num,n){var number=num.toFixed(n?n:0);var source=String(number).split(".");source[0]=source[0].replace(new RegExp('(\\d)(?=(\\d{3})+$)','ig'),"$1,");return source.join(".");}
function timeFormatChange(format,type){var lastStr='';var formatObj=function(formatStr){if(!formatStr||(typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return;}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){return;}
return{separators:separators,parts:parts};}(format);if(formatObj){format='';for(var i=0,len=formatObj.separators.length-1;i<len;i++){format+=formatObj.separators[i]+formatObj.parts[i];}
lastStr=formatObj.separators[len];}
var formatArr=['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'];var formatChangeArr=[['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'],['M d, yyyy hh:ii:ss','M d, yyyy hh:ii','M d, yyyy hh','M d, yyyy','M, yyyy','M d hh:ii:ss','M d hh:ii','M d hh','M d'],['dd/mm/yyyy hh:ii:ss','dd/mm/yyyy hh:ii','dd/mm/yyyy hh','dd/mm/yyyy','mm/yyyy','dd/mm hh:ii:ss','dd/mm hh:ii','dd/mm hh','dd/mm']];if(formatArr.findIndex){var index=formatArr.findIndex(function(v){return v===format;});}else{for(var i=0;i<formatArr.length;i++){if(formatArr[i]===format){var index=i;break;}}}
type=Number(type);type&&type>=formatChangeArr.length&&(type=formatChangeArr.length-1);if(index==-1){console.log('format is not defined');return format+lastStr;}else{if(type===0){return formatChangeArr[0][index]+lastStr;}
return formatChangeArr[type||AppConfig.projectTimeFormat||0][index]+lastStr;}}
function timeFormat(time,format,language,option){var date,arr,arr2;var sort=function sort(year,month,day,time){year=year==undefined?'2001':year;month=month==undefined?'01':month;day=day==undefined?'01':day;time=time==undefined?'':' '+time;return new Date(year+'/'+month+'/'+day+time);};if(time instanceof Date){date=time;}else if(typeof time=='string'){if(/^\d{1,2}-\d{1,2}/.test(time)){arr=time.split(' ');arr2=arr[0].split('-');time=arr2[1]+'-'+arr2[0]+(arr2[2]==undefined?'':'-'+arr2[2])+(arr[1]==undefined?'':' '+arr[1]);}
time=time.replace(/-/g,"/");arr=time.split(' ');arr2=arr[0].split('/');if(/^\d{4}/.test(time)){date=sort(arr2[0],arr2[1],arr2[2],arr[1]);}else if(/^\d{1,2}\/\d{4}/.test(time)){date=sort(arr2[1],arr2[0],'01',arr[1]);}else if(/^\d{1,2}\/\d{1,2}/.test(time)){date=sort(arr2[2],arr2[1],arr2[0],arr[1]);}else{date=new Date(time);}}else{date=new Date(time);}
return date.timeFormat(format,language,option);}
(function(exports){var MINITE_1=60000;var MINITE_5=300000;var HOUR_1=3600000;var DAY_1=86400000;var DAY_365=31536000000;function _formatTimeStr(str,format){var arr=str.split(' ');var date=arr[0].split('-');var time=arr[1].split(':');return format.replace('yyyy',date[0]).replace('MM',date[1]).replace('dd',date[2]).replace('HH',time[0]).replace('mm',time[1]).replace('ss',time[2]);}
function _explainPattern(timeShaft){var startTime=new Date(timeShaft[0]);var endTime=new Date(timeShaft[timeShaft.length-1]);var timeRange=endTime.valueOf()-startTime.valueOf();var timeInterval=timeRange/(timeShaft.length-1);var pattern='MM-dd HH:mm';if(timeInterval<=MINITE_5){if(timeRange<=HOUR_1){pattern='HH:mm';}else if(timeRange<=DAY_1){pattern='HH:mm';}}
else if(timeInterval<=HOUR_1){if(timeRange<=DAY_1){pattern='HH:mm';}else{pattern='MM-dd HH:mm';}}
else if(timeInterval<=DAY_1){if(timeRange<=DAY_365){pattern='MM-dd';}else{pattern='yyyy-MM-dd';}}
else{pattern='yyyy-MM';}
return pattern;}
function _explain(timeShaft){pattern=getPattern(timeShaft);if(pattern){timeShaft=timeShaft.map(function(row){return _formatTimeStr(row,pattern);});}
return timeShaft;}
function _valid(params){var flag=Object.prototype.toString.call(params)==='[object Array]';return flag&&/^[\d-]{10} [\d:]{8}$/.test(params[0]);}
var _getTimePattern=function _getTimePattern(timeShaft){if(!_valid(timeShaft)){return;}
if(timeShaft.length<=1){return;}
return _explainPattern(timeShaft);};var formatTimeShaft=exports.formatTimeShaft=function(timeShaft){if(!_valid(timeShaft)){console.warn('function arguments is not a valid time shaft array!');return timeShaft;}
if(timeShaft.length<=1){return timeShaft;}
return _explain(timeShaft);};function _formatTimeStrByAppConfig(data){var formatArr,formatStr,regularArr,language,formatObj;switch(AppConfig.projectTimeFormat||0){case 0:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';break;case 1:formatArr=['M d, yyyy','M d hh:ii','M, yyyy','M, yyyy','M d'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;case 2:formatArr=['dd/mm/yyyy','dd/mm hh:ii','mm/yyyy','mm/yyyy','dd/mm'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;default:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';}
for(var i=0,len=regularArr.length;i<len;i++){if(regularArr[i].test(data)){formatStr=formatArr[i];break;}}
if(formatStr){formatObj=function _parseFormat(formatStr){var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(formatStr);return{formatStr:formatStr,language:language,formatObj:formatObj};}else{return;}}
if(window.echarts){echarts.registerPreprocessor(function(option){var pattern;var formatInfo,firstValue;if(option.formatTime===false){pattern=_getTimePattern(option.xAxis[0].data);echarts.formatTimePattern=pattern;return;}
if(option.xAxis&&option.xAxis.length){option.xAxis.forEach(function(row){if(row.data&&row.data.length){pattern=_getTimePattern(row.data);formatInfo=_formatTimeStrByAppConfig(row.data[0]);if(pattern){row.data=row.data.map(function(row){return row.substr(0,16);});firstValue=_formatTimeStr(row.data[0],pattern);formatInfo=_formatTimeStrByAppConfig(firstValue);if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}else{row.data=row.data.map(function(it,i){return _formatTimeStr(it,pattern);});}}else if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}}});}});}})(window);var generateTimeOption=function generateTimeOption(option){var timeConfig=clone(option);!timeConfig.timeStart&&(timeConfig.timeStart=timeConfig.startTime);!timeConfig.timeEnd&&(timeConfig.timeEnd=timeConfig.endTime);!timeConfig.timeFormat&&(timeConfig.timeFormat=timeConfig.format);var recentTime={};var now=new Date();if(typeof option=='string'){recentTime=generateRecentTime(option);}else if(option&&option.timeRecent){if(typeof option.timeRecent=='string'){recentTime=generateRecentTime(option.timeRecent);}else if(option.timeRecent.hasOwnProperty('unit')&&option.timeRecent.hasOwnProperty('val')){recentTime=generateRecentTimeCustom(option.timeRecent);}}
if(recentTime&&Object.keys(recentTime).length>0){timeConfig.timeStart=recentTime.timeStart;timeConfig.timeEnd=recentTime.timeEnd;if(recentTime.format){timeConfig.timeFormat=recentTime.format;}
switch(timeConfig.timeFormat){case'h1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd HH:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd HH:00:00');break;case'd1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd 00:00:00');break;case'M1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-01 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-01 00:00:00');break;}}
timeConfig.startTime=timeConfig.timeStart;timeConfig.endTime=timeConfig.timeEnd;timeConfig.format=timeConfig.timeFormat;return timeConfig;function generateRecentTime(time){var startTime,endTime,format;switch(time){case'today':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-86400000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'threeDay':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-259200000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'yesterday':endTime=new Date(new Date().setDate(now.getDate()-1)).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(new Date().setDate(now.getDate()-2)).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'thisWeek':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now-604800000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'lastWeek':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'thisYear':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='M1';break;}
return{timeStart:startTime,timeEnd:endTime,format:format};}
function generateRecentTimeCustom(time){var startTime,endTime,format;switch(time.unit){case'hour':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-3600000*time.val).format('yyyy-MM-dd HH:mm:ss');break;case'day':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-86400000*time.val).format('yyyy-MM-dd HH:00:00');break;case'month':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-2592000000*time.val).format('yyyy-MM-dd HH:00:00');break;}
return{timeStart:startTime,timeEnd:endTime};}};var WebAPI=function(){var siteId;switch(window.location.hostname){case'beop.rnbtech.com.hk':siteId='b79c068f77198848e22fe79758836e53';break;case'beop6.rnbtech.com.hk':siteId='f1f6b2b9e6b64592c0b4cb5e9b8bd79e';break;case'beopdemo.rnbtech.com.hk':siteId='ac0df98f274d9a5980a571297248d80b';break;default:break;}
(function(){if(siteId){var hm=document.createElement("script");hm.src="//hm.baidu.com/hm.js?"+siteId;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);}})();var mockList={'/static/mock/analysis_workspace_saveLayout.json':/\/analysis\/workspace\/saveLayout\/\d+\/[01]/i,'/static/mock/analysis_template_get.json':/\/analysis\/template\/get\/\d+/i};function mock(url){var match=null;for(var i in mockList){match=url.match(mockList[i]);if(match!==null)return i;}
return url;}
function requestFailHandle(result){if(result&&result.status==401){alert(i18n_resource.error.noPermission);}}
function WebAPI(){}
WebAPI.isMock=false;$.ajaxSetup({converters:{"text json":true},dataFilter:function dataFilter(result,type){var data=result;if(type==='script'){return data;}else if(typeof data==='string'){if(/^\s*</.test(data)){return data;}
try{data=JSON.parse(result);}catch(e){console.log('request error: '+e+', the data is :'+data);return data;}}
if(data){if(data.error){switch(data.error){case'token_invalid':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');if(typeof LoginValidate!='undefined'){var validate=new LoginValidate();validate.show();return;}
confirm(i18n_resource.error.token[data.msg]+'. '+i18n_resource.error.relogin+'.',function(){if(AppConfig.isMobile){location.reload();}else{location.href='/';}});break;}
case'historyData':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');alert(data.msg);return{};}
default:break;}}
if(data.code==403){console.log(this.url+' ('+data.msg+'")');alert(I18n.resource.error.noPermission);return{};}}
return data;}});WebAPI.post=function(url,data,isMock){var mockUrl;isMock=isMock===undefined?WebAPI.isMock:isMock;if(isMock){mockUrl=mock(url);if(url!==mockUrl)return this.get(mockUrl,false);}
if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'POST',data:JSON.stringify(data),contentType:'application/json'}).fail(requestFailHandle);};WebAPI.get=function(url,isMock){isMock=isMock===undefined?WebAPI.isMock:isMock;url=isMock?mock(url):url;if(window._hmt&&url.indexOf('.html')>0)window._hmt.push(['_trackPageview',url]);if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'Get',contentType:'application/json'}).fail(requestFailHandle);};WebAPI.getHistoryDS=function(callback){};WebAPI.getHistory=function(callback){};return WebAPI;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var EventAdapter=function(){var eventData,eventStatus;function EventAdapter($){}
EventAdapter.on=function(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<3||arguments.length>5){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(arguments[0])!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}}
if(typeof arguments[1]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[1];}
if(typeof arguments[2]=='function'){eventFunction=arguments[2];eventSelector=null;eventHmt=arguments[3];}else if(typeof arguments[2]=='string'){if(arguments[3]&&typeof arguments[3]=='function'){eventSelector=arguments[2];eventFunction=arguments[3];eventHmt=arguments[4];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':eventTarget.on('touchstart',eventSelector,function(e){mobileDragStart.call(this,e,eventTarget,finalFunction);});break;case'dragover':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragOver.call(this,e,eventTarget,finalFunction);});break;case'dragleave':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragLeave.call(this,e,eventTarget,finalFunction);});break;case'drop':$(document).on('touchend.drop',eventSelector,function(e){mobileDrop.call(this,e,eventTarget,finalFunction);});break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;};EventAdapter.off=function(){if(arguments.length>3||arguments.length<1||arguments[0]&&typeof arguments[1]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}
if(arguments.length==1){eventTarget.off();return eventTarget;}
if(typeof arguments[1]=='string'){eventType=arguments[1];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[2]=='string'){eventSelector=arguments[2];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;};$.fn.extend({'eventOn':function eventOn(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<2||arguments.length>4){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(this)!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(this instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=this;}}
if(typeof arguments[0]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[0];}
if(typeof arguments[1]=='function'){eventFunction=arguments[1];eventSelector=null;eventHmt=arguments[2];}else if(typeof arguments[1]=='string'){if(arguments[2]&&typeof arguments[2]=='function'){eventSelector=arguments[1];eventFunction=arguments[2];eventHmt=arguments[3];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':mobileDragStart(eventTarget,eventSelector,finalFunction);break;case'dragover':mobileDragOver(eventTarget,eventSelector,finalFunction);break;case'dragleave':mobileDragLeave(eventTarget,eventSelector,finalFunction);break;case'drop':mobileDrop(eventTarget,eventSelector,finalFunction);break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;},'eventOff':function eventOff(){if(arguments.length>2||arguments[0]&&typeof arguments[0]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(this instanceof jQuery)){eventTarget=jQuery(this);}else{eventTarget=this;}
if(arguments.length==0){eventTarget.off();return eventTarget;}
if(typeof arguments[0]=='string'){eventType=arguments[0];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[1]=='string'){eventSelector=arguments[1];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector,mobileDragStart);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;}});EventAdapter.setData=function(date){if(date==undefined)return;eventData=date;};EventAdapter.getData=function(){return eventData;};document.addEventListener('drop',function(){eventData=null;},false);document.addEventListener('touchend',function(){eventData=null;},false);EventAdapter.clearEvent=function(){$(document).off('touchmove.copy');$(document).off('touchmove.drag');$(document).off('touchend.drop');};EventAdapter.analyse=function(e,eventType,hmtInfo){var mainInfo='',initArrTag,finalArrTag,tag,unitTag;var target=$(e.currentTarget);if(hmtInfo instanceof Array&&hmtInfo[0]){mainInfo=judgeWay(hmtInfo[0]);initArrTag=hmtInfo.filter(function(ele,index){return index>0&&ele!='';});finalArrTag=[];for(var i=0;i<initArrTag.length;i++){unitTag=judgeWay(initArrTag[i]);if(unitTag=='')continue;finalArrTag.push(unitTag);}
tag=finalArrTag.join('-');}else{if(hmtInfo!=undefined){mainInfo=judgeWay(hmtInfo);}else{mainInfo=getInfo(target);}
mainInfo=mainInfo?mainInfo:'';tag=mainInfo;}
_hmt.push(['_trackEvent',mainInfo.substr(0,30),eventType,'user-'+(AppConfig.userId?AppConfig.userId:0)+'/project-'+(AppConfig.projectId?AppConfig.projectId:0)]);function getInfo(tar){if(tar.length==0)return;var tarInfo;if(tar.attr('id')){tarInfo=tar.attr('id');}else if(tar.attr('i18n')){tarInfo=tar.attr('i18n');}else if(tar.attr('title')){tarInfo=tar.attr('title');}else{tarInfo=tar[0].innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}
return tarInfo;}
function judgeWay(arg){if(typeof arg=='undefined'){return'';}
if(arg instanceof Function){return arg.call(this,e);}else if(typeof arg=='string'){if(arg=='text'){return e.currentTarget.innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}else{return $(e.currentTarget).attr(arg)?$(e.currentTarget).attr(arg):arg;}}else if(typeof arg=='number'){return arg;}}};var mobileDragStart=function mobileDragStart(e,target,eventFunction){var originalTarget=$(e.target).closest('[draggable="true"]')[0];var ev=e.type=='touchstart'?e.originalEvent.touches[0]:e,startPos={left:$(originalTarget).css('left'),top:$(originalTarget).css('top'),zIndex:$(originalTarget).css('z-index')},disX=originalTarget.offsetWidth/2,disY=originalTarget.offsetHeight/2;var $copyTarget=$(originalTarget).clone();$copyTarget.data('startPos',startPos);$copyTarget.css('z-index',10000);$copyTarget.css('position','absolute');$copyTarget.css('opacity','0.5');$copyTarget.css('pointer-events','none');var $container=$('body');$container.append($copyTarget);var sPos=$(originalTarget)[0].getBoundingClientRect();$copyTarget.css('left',sPos.left-$container[0].offsetLeft+'px');$copyTarget.css('top',sPos.top-$container[0].offsetTop+'px');$copyTarget[0].cssText=originalTarget.cssText;$copyTarget.css('width',originalTarget.offsetWidth);$copyTarget.css('height',originalTarget.offsetHeight);eventStatus='dragStart';eventFunction.call(this,ev);$(document).off('touchend.copy').on('touchend.copy',function(e){$copyTarget.remove();eventStatus='dragEnd';});$(document).on('touchmove.copy',function(e){eventStatus='dragMove';var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var $parent=$copyTarget.offsetParent();$parent=$parent.is(':root')?$(window):$parent;var targetLeft=ev.pageX-disX;var targetTop=ev.pageY-disY;$copyTarget.css({left:targetLeft+'px',top:targetTop+'px','z-index':10000});});};var mobileDragOver=function mobileDragOver(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn'&&eventStatus!='dragMoveOut')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveIn';eventFunction.call(this,e);break;}}};var mobileDragLeave=function mobileDragLeave(e,target,eventFunction){if(eventStatus!='dragMoveIn')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(!(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY)){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveOut';eventFunction.call(this,e);}}};var mobileDragEnd=function mobileDragEnd(e,target,eventFunction){eventFunction.call(this,e);};var mobileDrop=function mobileDrop(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn')return;var ev=e.type=='touchend'?e.originalEvent.changedTouches[0]:e;var eventTarget=target;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventFunction.call(this,e);break;}}};return EventAdapter;}(jQuery);(function(){var class2type={};['Boolean','Number','String','Array','Function','Object','Date','RegExp','Error'].forEach(function(type){class2type['[object '+type+']']=type.toLowerCase();});function Diff(kind,path){this.kind=kind;this.path=path||[];};function DiffNew(path,value){Diff.call(this,'N',path);this.rhs=value;};function DiffDelete(path,value){Diff.call(this,'D',path);this.lhs=value;};function DiffEdit(path,origin,value){Diff.call(this,'E',path);this.lhs=origin;this.rhs=value;};function DiffArray(path,index,item){Diff.call(this,'A',path);this.index=index;this.item=item;};function realTypeOf(subject){if(subject==null){return subject+'';}
var type=Object.prototype.toString.call(subject);return class2type[type]||'object';}
function deepDiff(lhs,rhs,changes,process,path,key){var currentPath;var ltype,rtype;var lkeys,rkeys;var rs;path=path||[];currentPath=path.slice(0);if(typeof key!=='undefined'){currentPath.push(key);}
if(typeof process==='function'){rs=process(lhs,rhs,currentPath);if(rs===true){changes(new DiffEdit(currentPath,lhs,rhs));return;}else if(rs===false){return;}}
ltype=realTypeOf(lhs);rtype=realTypeOf(rhs);if(ltype==='undefined'){if(rtype!=='undefined'){changes(new DiffNew(currentPath,rhs));}}else if(rtype==='undefined'){changes(new DiffDelete(currentPath,lhs));}else if(ltype!==rtype){changes(new DiffEdit(currentPath,lhs,rhs));}else if(ltype==='object'){lkeys=Object.keys(lhs);rkeys=Object.keys(rhs);lkeys.forEach(function(k){var other=rkeys.indexOf(k);if(other>=0){deepDiff(lhs[k],rhs[k],changes,process,currentPath,k);rkeys.splice(rkeys.indexOf(k),1);}else{deepDiff(lhs[k],undefined,changes,process,currentPath,k);}});rkeys.forEach(function(k){deepDiff(undefined,rhs[k],changes,process,currentPath,k);});}else if(ltype==='array'){for(var i=0,len=lhs.length;i<len;i++){if(i>=rhs.length){changes(new DiffArray(currentPath,i,new DiffDelete(undefined,lhs[i])));}else{deepDiff(lhs[i],rhs[i],changes,process,currentPath,i);}}
while(i<rhs.length){changes(new DiffArray(currentPath,i,new DiffNew(undefined,rhs[i++])));}}else if(lhs!==rhs){changes(new DiffEdit(currentPath,lhs,rhs));}};function diff(lhs,rhs,process,format,accum){var accum=accum||[];deepDiff(lhs,rhs,function(d){if(d){typeof format==='function'&&format(d);accum.push(d);}},process);return accum.length?accum:null;};window.diff=diff;}).call(this);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.util'),function(exports){exports.MergeDiff=function(){function mergeGroup(id,group){var rs={_id:id,v:{},k:'E'};var newDiff=null;group.forEach(function(d){var len=d.path.length;var kv={};if(d.length===1){Log.warn('root object \"'+d.path[0]+'" has an unexpected operation that has not been considered, we will ignore it.');return;}
if(d.kind==='N'){if(len===2){rs.v[d.path[1]]=d.rhs;}else{Log.warn('property "'+d.path.join('.')+'" is a object, expect not a object, will ignore it and do not upload to the server.');}}
else if(d.kind==='E'){if(len===2){rs._id=d.path[0];kv[d.path[1]]=d.rhs;rs.v=$.extend(false,rs.v,kv);}else{Log.warn('property "'+d.path.join('.')+'" is a object, expect not a object, will ignore it and do not upload to the server.');}}
else if(d.kind==='D'){if(len===2){if(rs.v.hasOwnProperty(d.path[1])){delete rs.v[d.path[1]];}}else{Log.warn('property "'+d.path.join('.')+'" is a object, expect not a object, will ignore it and do not upload to the server.');}}else{Log.warn('there shouldn\'t have any type except \'N\', \'E\' or \'D\' in the group diffs, unusual type: '+d.kind);}});return rs;}
return function(diffs){var map={};var rs=[];diffs.forEach(function(d){var id=d.path[0];map[id]=map[id]||[];if(map[id].length===1&&map[id][0].path.length===1)return;if(d.path.length===1){map[id]=[d];return;}
map[id].push(d);},this);for(var id in map){if(!map.hasOwnProperty(id))continue;if(map[id].length===1&&map[id][0].path.length===1){if(map[id][0].kind==='D'){rs.push({k:'D',_id:map[id][0].lhs['_id']});}else if(map[id][0].kind==='N'){rs.push({k:'N',v:map[id][0].rhs});}
continue;}
rs.push(mergeGroup(id,map[id]));}
return rs;};}();});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.core'),function(exports){var nop=function nop(){return undefined;};var deepCopy=$.extend.bind($,true,{});exports.createModel=function(container,state,initialStore,nap,enhancer){var listeners,store,currentState,currentContainer,currentNap;if(typeof enhancer!=='undefined'){return enhancer(createModel)(container,state,nap,initialStore);}
nap=nap||nop;listeners=[];store=initialStore;currentState=state(store);currentContainer=container;currentNap=nap;function updateState(){currentState=state(store);Log.info('New state:',currentState);listeners.forEach(function(listener){listener(currentState);});currentNap(currentState)(present);}
function getState(){return currentState;}
function subscribe(listener){listeners.push(listener);return function unsubscribe(){var index=listeners.indexOf(listener);listeners.splice(index,1);};}
function present(){var dataset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Log.info('Present:',dataset);store=currentContainer(deepCopy(store),dataset);Log.info('Store after BLC: ',store);updateState();}
function replaceStore(nextStore){Log.info('replaceStore',nextStore);store=deepCopy(nextStore);updateState();}
function replaceContainer(nextContainer){Log.info('replaceContainer');currentContainer=nextContainer;updateState();}
function replaceNap(nextNap){Log.log('replaceNap');currentNap=nextNap;updateState();}
return{present:present,subscribe:subscribe,getState:getState,replaceStore:replaceStore,replaceContainer:replaceContainer,replaceNap:replaceNap};};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.core'),function(exports){exports.Event={addEventListener:function addEventListener(events,fn,context){var _this=this;var e=this.__info||(this.__info={});events=events.split(' ');events.forEach(function(event){var evt;event='event:'+event;evt=e[event]||(e[event]=[]);evt.push(fn,context);});},on:function on(events,fn,context){return this.addEventListener(events,fn,context);},once:function once(event,fn,context){var _this=this;this.addEventListener(event,function ofn(){_this.removeEventListener(event,ofn);fn.apply(context,arguments);},context);},removeEventListener:function removeEventListener(events,fn){var e=this.__info;var rs=null;if(e){events=events.split(' ');events.forEach(function(event){var i;event=e['event:'+event];if(event){i=event.indexOf(fn);if(i>-1){rs=event.splice(i,2)[0]||null;}}});}
return rs;},removeAllListeners:function removeAllListeners(events){var _this=this;var e=this.__info;if(e){events=events.split(' ');events.forEach(function(event){if(event.indexOf('.')===0){_this.removeListenersByNs(event);}else{delete e['event:'+event];}});}},removeListenersByNs:function removeListenersByNs(ns){var e=this.__info;if(e){Object.keys(e).forEach(function(name){if(name.indexOf(ns)>-1){delete e['event:'+name];}});}},off:function off(events,fn){if(typeof fn!=='undefined'){return this.removeEventListener(events,fn);}else{return this.removeAllListeners(events);}},listeners:function listeners(event){var e=this.__info;if(e){return e['event:'+event]||[];}
return[];},emit:function emit(event){var e=this.__info;var h=[];if(e){event='event:'+event;Object.keys(e).forEach(function(name){if(name===event||name.indexOf(event+'.')===0){if(e[name]&&e[name].length){h=h.concat(e[name]);}}});if(h&&h.length){for(var i=0,len=h.length;i<len;i+=2){try{h[i].apply(h[i+1],arguments);}catch(_){Log.exception('emit',_);}}
return true;}}
return false;}};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.core'),function(exports){var deepClone=function deepClone(obj){var type=$.type(obj);if(type==='object'){return $.extend(true,{},obj);}else if(type==='array'){return $.extend(true,[],obj);}else{return obj;}};var getFlatItems=function getFlatItems(nestedItems){var shadow=nestedItems.slice();var rs=[];var item;while(item=shadow.shift()){rs.push(item);if(item.children){shadow=shadow.concat(item.children);}}
return rs;};var removeItems=function removeItems(items,removedIds){return items.filter(function(row){if(row.children){row.children=removeItems(row.children,removedIds);}
return removedIds.indexOf(row._id)===-1;});};var container=function container(store,dataset){store=store||{};dataset=dataset||{};if(dataset.toggleShowAllStrategiesBtn){store.equipTree.bShowChildStrategies=!store.equipTree.bShowChildStrategies;}
if(dataset.selectEquipTreeNode){store.equipTree.selectedNode=dataset.selectEquipTreeNode;}
if(dataset.addStrategyItems){var node=null,stack=store.equipTree.items.slice();while(node=stack.shift()){if(node._id===dataset.addStrategyItems.nodeId){break;}
if(node.children&&node.children.length){stack=stack.concat(node.children);}}
if(node){if(dataset.addStrategyItems.items instanceof Array){node.children=dataset.addStrategyItems.items;}else{node.children.push(dataset.addStrategyItems.items);}}}
if(dataset.removedStrategiesIds){store.equipTree.items=removeItems(store.equipTree.items,dataset.removedStrategiesIds);}
if('strategySearchKey'in dataset){store.strategyTable.searchKey=dataset.strategySearchKey;}
if(dataset.enableStrategies){getFlatItems(store.equipTree.items).forEach(function(row){if(dataset.enableStrategies.indexOf(row._id)>-1){row.status=1;}});}
if(dataset.disableStrategies){getFlatItems(store.equipTree.items).forEach(function(row){if(dataset.disableStrategies.indexOf(row._id)>-1){row.status=0;}});}
if(dataset.selectStrategyTableRows){store.strategyTable.selectedIds=dataset.selectStrategyTableRows;}
if('openStrategy'in dataset){store.painter.openStrategy=dataset.openStrategy;store.painter.tempStrategy=deepClone(store.painter.openStrategy);}
if(dataset.propItemsToItems){getFlatItems(store.equipTree.items).forEach(function(item){if(dataset.propItemsToItems.selectedIds.indexOf(item['_id'])>-1){for(var k in dataset.propItemsToItems.value){item[k]=dataset.propItemsToItems.value[k];}}});}
if(dataset.toConfig){store.painter.configIds=dataset.toConfig;}
if(dataset.toPainter){store.painter.configIds=[];}
if(dataset.configSave){store.painter.configIds=[];}
if(dataset.modal){store.modal=dataset.modal;}
if(dataset.addModule){store.painter.tempStrategy.modules.push(dataset.addModule);}
return store;};exports.container=container;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.core.constants'),function(exports){exports.equipTree={'TOGGLE_SHOW_ALL_STRATEGIES_BTN':'TOGGLE_SHOW_ALL_STRATEGIES_BTN','SELECT_TREE_NODE':'SELECT_TREE_NODE','ADD_SYNC_DATA':'ADD_SYNC_DATA'};exports.strategyTable={'ADD_ITEM':'ADD_ITEM','REMOVE_SELECTED_ITEMS':'REMOVE_SELECTED_ITEMS','CHANGE_SEARCH_FIELD':'CHANGE_SEARCH_FIELD','ENABLE_STRATEGIES':'ENABLE_STRATEGIES','DISABLE_STRATEGIES':'DISABLE_STRATEGIES','SELECT_ROWS':'SELECT_ROWS','OPEN_STRATEGY':'OPEN_STRATEGY'};exports.propPanel={'CHANGE_PROP':'CHANGE_PROP','SAVE_PROP':'SAVE_PROP','RECOVER_PROP':'RECOVER_PROP'};exports.toolbar={'EXIT_STRATEGY':'EXIT_STRATEGY'};exports.painter={'CONFIG_SAVE':'CONFIG_SAVE','ADD_MODULE':'ADD_MODULE','SELECTED_PROPS':'SELECTED_PROPS','UPDATE_LOC':'UPDATE_LOC','SHOW_CONFIG_PANEL':'SHOW_CONFIG_PANEL','CLOSR_CONFIG_PANEL':'CLOSR_CONFIG_PANEL','CONFIG_PANEL_SAVE_AND_CLOSE':'CONFIG_PANEL_SAVE_AND_CLOSE','REMOVE_MODEULE':'REMOVE_MODEULE','CHANGE_INPUT_DS':'CHANGE_INPUT_DS','CHANGE_ACTIVE_SIDER_INDEX':'CHANGE_ACTIVE_SIDER_INDEX'};exports.modal={'SHOW_MODAL':'SHOW_MODAL','HIDE_MODAL':'HIDE_MODAL','CHANGE_STRATEGY_VALUE':'CHANGE_STRATEGY_VALUE'};exports.modulePropPanel={'CHANGE_SELECTEDMODULES_PROPS':'CHANGE_SELECTEDMODULES_PROPS'};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root,namespace('beop.strategy.core.constants'));}})(namespace('beop.strategy.core'),function(exports,constants){exports.createDispatch=function(present,reducer){return reducer(present);};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','classNames'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('classNames'));}else{factory(root,namespace('React'),namespace('classNames'));}})(namespace('beop.strategy.components.Layout'),function(exports,React,cx){var h=React.h;var Component=React.Component;var shadowClone=$.extend.bind($,false);function mergeProps(props,_private){var _mergeKeys=Object.keys(_private);if(typeof props==='undefined'){return _private;}
Object.keys(props).forEach(function(p){var type;if(_mergeKeys.indexOf(p)>-1){switch(p){case'class':case'className: ':_private[p]=_private[p]+' '+props[p].trim();return;default:break;}}
_private[p]=props[p];});return _private;}
function Container(props){var attrs=mergeProps(props,{className:function(){var flag=false;React.Children.toArray(props.children||[]).some(function(child){if(child&&child.props&&(child.type===Sider||child.type===SiderGroup)){flag=true;return true;}});return flag?'layout-container layout-has-sider':'layout-container';}()});return h('div',attrs);}
var SiderGroup=function(_Component){_inherits(SiderGroup,_Component);function SiderGroup(props){_classCallCheck(this,SiderGroup);var _this2=_possibleConstructorReturn(this,_Component.call(this,props));_this2.state={active:props.active||0};_this2.handlerSiderGroupBtnClick=_this2.handlerSiderGroupBtnClick.bind(_this2);return _this2;}
SiderGroup.prototype.handlerSiderGroupBtnClick=function handlerSiderGroupBtnClick(data){if(this.state.active!==data.idx){this.setState({active:data.idx});typeof this.props.onSiderChange==='function'&&this.props.onSiderChange(data.idx);}};SiderGroup.prototype.componentWillReceiveProps=function componentWillReceiveProps(nextProps){if(nextProps.active!==this.props.active){this.setState({active:nextProps.active||0});}};SiderGroup.prototype.render=function render(){var _this=this;var attrs=mergeProps(this.props,{className:'layout-sider-group'});var activeChild;React.Children.forEach(attrs.children,function(child,idx){if(idx===_this.state.active){activeChild=child;return false;}});return h('div',{id:attrs.id,className:attrs.className},[h('div',{className:'layout-sider-group-content'},[activeChild]),h('div.layout-sider-group-btn-wrap',React.Children.map(attrs.children,function(child,i){return h('label',{className:cx('layout-sider-group-btn',{'active':_this.state.active===i}),onClick:React.linkEvent({ins:_this,idx:i},_this.handlerSiderGroupBtnClick)},[h('span',child.props.title)]);}))]);};return SiderGroup;}(Component);function Sider(props){var attrs=mergeProps(props,{className:'layout-sider'});return h('div',attrs);}
function Content(props){var attrs=mergeProps(props,{className:'layout-content'});return h('.layout-content',attrs);}
exports.Container=Container;exports.SiderGroup=SiderGroup;exports.Sider=Sider;exports.Content=Content;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(window,function(exports){exports.AppConfig={userId:262,isStratefy:1,projectId:293,projectList:[{"address":"175 Liverpool St, Sydney NSW 2000","datadb":"qantas","id":293,"isAdvance":1,"isFavorite":null,"is_diag":null,"lastReceivedTime":"2017-01-18 00:35:07","latlng":"-33.8767149,151.211525","logo":"/custom/beop_sales/preciseairlogo.png","name_cn":"175Liverpoolst","name_en":"liverpoolst","name_english":"175LiverpoolStreet","online":"Offline","pic":"liverpoolst.jpg","time_format":1,"updateMarker":false}]};exports.Spinner=new LoadingSpinner({color:'#00FFFF'});exports.I18n=undefined;exports.I18N_PATH='/static/app/WebFactory/views/js/i18n/';exports.initI18n=function(lang,isForce,promise){InitI18nResource(lang,isForce,I18N_PATH).always(function(rs){I18n=new Internationalization(null,rs);promise.resolve();});};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components.Painter'),function(exports,constants,React){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null,saveConfig:function saveConfig(id){var data={'value':[]};var tables=$('#batchConfigModal').find('.modal-body').find('table');tables.each(function(){var trs=$(this).find('tbody tr');var obj={};trs.each(function(){var key=$(this).find('.name').text();var val=$(this).find('.value').val();obj[key]=val;});data.value.push(obj);});actions.dispatch({type:constants.modal.CHANGE_STRATEGY_VALUE,modalType:'BatchConfigModal',props:data.value});},closeModal:function closeModal(){actions.dispatch({type:constants.modal.HIDE_MODAL,modalType:null,props:{}});}};var theme={render:function render(data){var _this=this;if(data){return h('div',{className:"gray-scrollbar",style:{'max-height':'300px',overflow:'auto'}},data.map(function(item){if(!$.isEmptyObject(item)){return theme.createTable.call(_this,item);}}));}},createTable:function createTable(data){var _this=this;return h('table.configTable',{},[h('thead',{},[h('tr',{},[h('th',{style:{width:"25%"}},['参数名']),h('th',{},['参数值']),h('th.addMinusBtn',{},[h('span.tableAddMinusBtn.add',{className:"glyphicon glyphicon-plus"}),h('span',{},['/']),h('span.tableAddMinusBtn.minus',{className:"glyphicon glyphicon-minus"})])])]),h('tbody',{},Object.keys(data).map(function(key){return theme.createTr.call(_this,key,data[key]);}))]);},createTr:function createTr(name,val){return h('tr',{},[h('td',{},[h('label',{className:"name"},[name])]),h('td',{},[h('input',{className:"form-control value",value:val,onChange:linkEvent(name,this.onChangeHandler)})])]);}};var BatchConfigModal=function(_React$Component){_inherits(BatchConfigModal,_React$Component);function BatchConfigModal(props,context){_classCallCheck(this,BatchConfigModal);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));actions.dispatch=_this2.context.dispatch;_this2.state={values:_this2.props.children};_this2.onChangeHandler=_this2.onChangeHandler.bind(_this2);return _this2;}
BatchConfigModal.prototype.onChangeHandler=function onChangeHandler(key,e){var items=this.state.values;var value=e.currentTarget.value;items.forEach(function(row){if(key in row){row[key]=value;}});this.setState({items:items});};BatchConfigModal.prototype.componentDidMount=function componentDidMount(){var content=$('#batchConfigModal').find('.modal-body');content.on('click','table .tableAddMinusBtn',this.tableAddMinusBtn);};BatchConfigModal.prototype.tableAddMinusBtn=function tableAddMinusBtn(e){var curDom=$(e.target);var curTable=curDom.closest('table');if(curDom.hasClass('add')){var cloneTable=curTable.clone();cloneTable.find('tbody tr input').each(function(){$(this).val('');});curTable.after(cloneTable);}else{curTable.remove();}};BatchConfigModal.prototype.componentWillUpdate=function componentWillUpdate(){return false;};BatchConfigModal.prototype.render=function render(){return h('div',{className:"modal",id:"batchConfigModal"},[h('div.modal-dialog',{},[h('div.modal-content',{},[h('div.modal-header',{},[h('button',{className:"close",onClick:actions.closeModal},[h('span',["×"])]),h('h4.modal-title',["批量配置参数"])]),h('div.modal-body',{},[theme.render.call(this,this.state.values)]),h('div.modal-footer',{},[h('button',{className:"btn btn-default defHover",onClick:actions.closeModal},["关闭"]),h('button',{className:"btn btn-primary defHover",onClick:React.linkEvent(this.state._id,actions.saveConfig)},["保存"])])])])]);};return BatchConfigModal;}(React.Component);exports.BatchConfigModal=BatchConfigModal;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components.Painter'),function(exports,constants,React){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null,debug:function debug(id){},closeModal:function closeModal(){actions.dispatch({type:constants.modal.HIDE_MODAL,modalType:null,props:{}});}};var theme={height:undefined,left:function left(data){var _this=this;return h('div',{style:{width:'50%',float:'left',paddingRight:'10px'}},theme.createItem(data));},right:function right(data){var _this=this;return h('div',{style:{float:'left',width:'50%',paddingLeft:'10px'}},[h('textarea',{style:{height:theme.height+'px',width:'100%',margin:"5px auto"}})]);},createItem:function createItem(data){var result=[];if(data&&data.length){data.forEach(function(v){for(k in v){result.push(h('div',{style:{height:'50px',width:'100%',padding:'5px'}},[h('label',{style:{height:'30px',lineHeight:'30px',width:'40%',overFlow:'hidden',float:'left'}},[k]),h('input',{style:{width:'60%',lineHeight:'30px',float:'left'},value:v[k],readOnly:true})]));}});}
theme.height=(result.length+1)*40;return result;}};var DebugModal=function(_React$Component){_inherits(DebugModal,_React$Component);function DebugModal(props,context){_classCallCheck(this,DebugModal);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));actions.dispatch=_this2.context.dispatch;return _this2;}
DebugModal.prototype.render=function render(){return h('div',{className:"modal",style:{width:'60%',marginTop:'60px',marginLeft:'20%'},id:"debugModal"},[h('div.modal-content',{},[h('div.modal-header',{},[h('button',{className:"close",onClick:actions.closeModal},[h('span',["×"])]),h('h4.modal-title',["调试"])]),h('div.modal-body',{className:"gray-scrollbar",style:{'max-height':'350px',overflow:"auto"}},[theme.left(this.props.strategy.value),theme.right(),h('div',{style:{clear:'both'}})]),h('div.modal-footer',{},[h('button',{className:"btn btn-default defHover",onClick:actions.closeModal},["关闭"]),h('button',{className:"btn btn-primary defHover",onClick:actions.debug},["调试"])])])]);};return DebugModal;}(React.Component);exports.DebugModal=DebugModal;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components'),function(exports,constants,React){var h=React.h;var linkEvent=React.linkEvent;var deepClone=$.extend.bind(true);var actions={dispatch:null};var theme={tabTitle:function tabTitle(isInput){var inputActive,outputActive;if(isInput){inputActive="active";outputActive="";}else{inputActive="";outputActive="active";}
return h('ul.tabTitle',[h('li',{className:inputActive,'data-index':"0",onClick:linkEvent(0,this.switchTab)},['输入']),h('li',{className:outputActive,'data-index':"1",onClick:linkEvent(1,this.switchTab)},['输出'])]);},toolBar:function toolBar(){return h('.topBtn',[h('span.glyphicon.glyphicon-plus',{onClick:this.handleAdd})]);},variablesRender:function variablesRender(model){var _this=this;if(model.isInput){var variables=model.input;}else{var variables=model.output;}
var variableName,variableType,variableDefaultVal,variableDebug;var arr=[];return h('div',variables.map(function(row,i){return theme.singleVariable.call(_this,row,i,model);}));},singleVariable:function singleVariable(_singleVariable,index,model){variableName=_singleVariable.name;variableDebug=_singleVariable.debug;var isShow='none',errorInformation;if(model.errorInfo.length!==0){for(var i=0,length=model.errorInfo.length;i<length;i++){if(model.errorInfo[i].index===index){errorInformation=model.errorInfo[i].type;isShow='block';}}}
var names,dataSourceLayout;var names=h('input',{name:'name',type:'text',value:variableName,onChange:linkEvent({field:'name',idx:index},this.handleChange)});dataSourceLayout=h('input',{name:'default',type:'text',value:_singleVariable.default,onChange:linkEvent({field:'default',idx:index},this.handleChange)});var variableType;var dataSource='',message='',mail='',num='';var str='';var time='';var json='';var otherModal='';switch(Number(_singleVariable.type)){case 0:dataSourceLayout=h('div.dataSource',{ondragover:function ondragover(e){e.preventDefault();},ondragEnter:function ondragEnter(e){e.preventDefault();},ondrop:function ondrop(e){var dsItemId=EventAdapter.getData().dsItemId;if(AppConfig.datasource.currentObj==='cloud'){var dragName=$('#tableDsCloud').find('tr[ptid="'+dsItemId+'"]').find('.tabColName').attr('data-value');var currentId=$('#selectPrjName').find('option:selected').val();if(currentId){dragName='@'+currentId+'|'+dragName;}else{dragName=dsItemId;}
_this.handleChange({field:'default',idx:index},{currentTarget:{value:dragName}});}else{_this.handleChange({field:'default',idx:index},{currentTarget:{value:dsItemId}});}}},_singleVariable.default||[h('span.glyphicon.glyphicon-plus')]);break;case 100:names=h('select',{name:'name',value:_singleVariable.refId+'|'+_singleVariable.name,onChange:linkEvent({field:'refId',idx:index},this.handleChange)},[h('option',{value:'',selected:!_singleVariable.refId},'请选择')].concat(model.moduleOutputs.map(function(m){return h('optgroup',{label:m.name},m.output.map(function(o){return h('option',{value:m._id+'|'+o.name,selected:_singleVariable.refId===m._id&&_singleVariable.name===o.name},o.name);}));})));break;}
return h('div',{className:'singleVariable','data-name':variableName,'data-index':index},[h('span.warn',{style:{display:isShow}},[errorInformation]),h('span.remove.glyphicon.glyphicon-remove-circle',{onClick:linkEvent(index,this.handleRemove)}),h('div',[h('label',['类型']),h('select',{name:'type',value:Number(_singleVariable.type),onChange:linkEvent({field:'type',idx:index,valueType:'number'},this.handleChange)},[h('option',{value:0},['数据源']),h('option',{value:1},['短信']),h('option',{value:2},['邮件']),h('option',{value:10},['数值']),h('option',{value:11},['字符串']),h('option',{value:12},['时间']),h('option',{value:13},['JSON']),h('option',{value:100},['引用其他模块'])])]),h('div',[h('label',['变量名']),names])].concat(_singleVariable.type===100?[]:[h('div',[h('label',['默认值']),dataSourceLayout])]));}};var VariablePanel=function(_React$Component){_inherits(VariablePanel,_React$Component);function VariablePanel(props,context){_classCallCheck(this,VariablePanel);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));_this2.state={input:deepClone([],_this2.props.input),output:deepClone([],_this2.props.output),moduleOutputs:_this2.props.moduleOutputs,isInput:true,errorInfo:[]};actions.dispatch=actions.dispatch||context.dispatch;_this2.switchTab=_this2.switchTab.bind(_this2);_this2.handleChange=_this2.handleChange.bind(_this2);_this2.handleAdd=_this2.handleAdd.bind(_this2);_this2.handleRemove=_this2.handleRemove.bind(_this2);return _this2;}
VariablePanel.prototype.switchTab=function switchTab(tabIndex){this.setState({isInput:tabIndex===0});};VariablePanel.prototype.handleAdd=function handleAdd(){var arr=this.state.isInput?this.state.input:this.state.output;arr.push({name:'Untitled',type:0,default:0,refId:''});this.setState(this.state.isInput?{input:arr}:{output:arr});this.handleUpdate();};VariablePanel.prototype.handleUpdate=function handleUpdate(){this.props.handleUpdate({input:this.state.input,output:this.state.output});};VariablePanel.prototype.handleRemove=function handleRemove(idx){var arr=this.state.isInput?this.state.input:this.state.output;arr.splice(idx,1);this.setState(this.state.isInput?{input:arr}:{output:arr});this.handleUpdate();};VariablePanel.prototype.handleChange=function handleChange(data,e){var field=data.field;var value=e.currentTarget.value;var idx=data.idx;var arr=this.state.isInput?this.state.input:this.state.output;var tmp;if(field==='refId'){tmp=value.split('|');arr[idx][field]=tmp[0];arr[idx]['name']=tmp[1];}else{arr[idx][field]=data.valueType==='number'?parseInt(value):value;}
this.setState(this.state.isInput?{input:arr}:{output:arr});this.handleUpdate();};VariablePanel.prototype.render=function render(){return h('div',[theme.tabTitle.call(this,this.state.isInput),h('div.variablesType',[theme.toolBar.call(this),h('div.variables.gray-scrollbar.scrollable-y',[theme.variablesRender.call(this,this.state)])])]);};return VariablePanel;}(React.Component);exports.VariablePanel=VariablePanel;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('React'),namespace('beop.strategy.core.constants'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,React,constants){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null,onToggleShowAllStrategiesBtnHandler:function onToggleShowAllStrategiesBtnHandler(){actions.dispatch({type:constants.equipTree.TOGGLE_SHOW_ALL_STRATEGIES_BTN});},onSelectTreeNode:function onSelectTreeNode(_id,parentNodeId){actions.dispatch({type:constants.equipTree.SELECT_TREE_NODE,_id:_id,pid:parentNodeId});},addAsyncData:function addAsyncData(items,nodeId){actions.dispatch({type:constants.equipTree.ADD_SYNC_DATA,items:items,nodeId:nodeId});}};var Tree=function(_React$Component){_inherits(Tree,_React$Component);function Tree(){_classCallCheck(this,Tree);return _possibleConstructorReturn(this,_React$Component.apply(this,arguments));}
Tree.prototype.refDefine=function refDefine(name){var refs=this.refs=this.refs||{};return function(dom){refs[name]=dom;};};Tree.prototype.isLoaded=function isLoaded(node){var flag=true,nodes;if(node.isLoaded){return true;}
if(node.zAsync){nodes=this.treeObj.getNodesByParam('isParent',true,node);nodes.some(function(row){if(!row.zAsync){flag=false;return true;}});}else{flag=false;}
node.isLoaded=flag;return flag;};Tree.prototype.zTreeOnClick=function zTreeOnClick(){var node=this.treeObj.getSelectedNodes()[0];var parentNode;if(!node.isParent){parentNode=node.getParentNode();}else{parentNode=node;}
if(parentNode){if(!this.props.bShowChild){if(!parentNode.zAsync){this.treeObj.reAsyncChildNodes(parentNode,'refresh',true);}}else{if(!this.isLoaded(parentNode)){parentNode.isLoaded='pending';this.treeObj.reAsyncChildNodes(parentNode,'refresh',true);}}}
actions.onSelectTreeNode(node._id,parentNode._id);};Tree.prototype.zTreeOnNodeCreated=function zTreeOnNodeCreated(event,treeId,treeNode){var $span_switch=$('#'+treeNode.tId+'_switch');$span_switch.prependTo($('#'+treeNode.tId+'_a'));$span_switch.closest('a').addClass('cursorDefault');};Tree.prototype.zTreeOnAsyncSuccess=function zTreeOnAsyncSuccess(event,treeId,treeNode,rs){if(rs.status==='OK'){actions.addAsyncData(rs.data,treeNode._id);treeNode.isLoaded==='pending'&&(treeNode.isLoaded=true);}};Tree.prototype.zTreeBeforeAsync=function zTreeBeforeAsync(treeId,treeNode){if(treeNode.isLoaded===true){treeNode.zAsync=true;return false;}
return true;};Tree.prototype.componentDidMount=function componentDidMount(){var _this=this;var dom=this.refs.domWrap;var expendArr=[1];var zSetting={view:{showIcon:false,showLine:false,fontCss:{color:"#cadee5"}},async:{enable:true,type:'get',url:function url(treeId,treeNode){var node=treeNode.getPath()[0];if(_this.props.bShowChild){return'/strategy/item/getAllList/'+node.projId+(!treeNode.projId?'/'+treeNode._id:'');}
return'/strategy/item/getList/'+node.projId+(!treeNode.projId?'/'+treeNode._id:'');},dataFilter:function dataFilter(treeId,parentNode,rs){if(rs.status==='OK'){return rs.data;}
return[];}},edit:{enable:false,editNameSelectAll:true,showRenameBtn:false,showRemoveBtn:false},data:{keep:{leaf:true,parent:true},simpleData:{enable:true,idKey:"_id",pIdKey:"nodeId"}},callback:{onClick:this.zTreeOnClick.bind(this),onNodeCreated:this.zTreeOnNodeCreated.bind(this),onAsyncSuccess:this.zTreeOnAsyncSuccess.bind(this),beforeAsync:this.zTreeBeforeAsync.bind(this)}};this.treeObj=$.fn.zTree.init($(dom),zSetting,this.props.items);expendArr.forEach(function(row){_this.treeObj.expandNode(_this.treeObj.getNodesByParam("tId","equipTreeCtn_"+row)[0],true,false,true,true);});};Tree.prototype.shouldComponentUpdate=function shouldComponentUpdate(){return false;};Tree.prototype.componentWillUnmount=function componentWillUnmount(){if(this.treeObj){this.treeObj.destroy();this.treeObj=null;}};Tree.prototype.render=function render(){return h('#equipTreeCtn.ztree',{ref:this.refDefine('domWrap')});};return Tree;}(React.Component);var theme={topBox:function topBox(){return h('.input-group.divSearch',[h('input',{className:'form-control iptSearch',type:'text'}),h('span.spanSearch',[h('span',{className:'glyphicon glyphicon-search','aria-hidden':'true'})])]);},bottomBox:function bottomBox(bShowChildStrategies){var showAllStrategy=bShowChildStrategies?'active':'';return h('.bottomBox',[h('div',{className:'showAllStrategy '+showAllStrategy,onClick:actions.onToggleShowAllStrategiesBtnHandler},'显示所有子策略')]);}};function EquipTree(props,context){actions.dispatch=context.dispatch;return h('#equipTree',{style:{width:'100%',height:'100%'}},[h('div.equipTreeBox',[theme.topBox(),h('.equipTreeContent.gray-scrollbar',[h(Tree,{items:props.items,bShowChild:props.bShowChildStrategies}),theme.bottomBox(props.bShowChildStrategies)])])]);}
exports.EquipTree=EquipTree;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,constants,React){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null,addStrategyItem:function addStrategyItem(nodeId){actions.dispatch({type:constants.strategyTable.ADD_ITEM,nodeId:nodeId});},removeSelectedItems:function removeSelectedItems(selectedIds){actions.dispatch({type:constants.strategyTable.REMOVE_SELECTED_ITEMS,selectedIds:selectedIds});},changeSearchField:function changeSearchField(e){actions.dispatch({type:constants.strategyTable.CHANGE_SEARCH_FIELD,value:e.currentTarget.value});},enableStrategies:function enableStrategies(ids){actions.dispatch({type:constants.strategyTable.ENABLE_STRATEGIES,ids:ids});},disableStrategies:function disableStrategies(ids){actions.dispatch({type:constants.strategyTable.DISABLE_STRATEGIES,ids:ids});},selectRows:function selectRows(data,e){var _id=data._id;var selectedIds=data.selectedIds;var idx=selectedIds.indexOf(_id);if(e.ctrlKey){if(idx>-1){selectedIds.splice(idx,1);}else{selectedIds.push(_id);}}else{selectedIds=[_id];}
actions.dispatch({type:constants.strategyTable.SELECT_ROWS,selectedIds:selectedIds});},openStrategy:function openStrategy(_id,e){actions.dispatch({type:constants.strategyTable.OPEN_STRATEGY,strategyId:_id});}};var theme={leftBtnGroup:function leftBtnGroup(selectedIds,nodeId){return h('.navLeftBtn',[h('button.btn.btn-default.addBtn',{disabled:nodeId?'':'disabled',onClick:linkEvent(nodeId,actions.addStrategyItem)},'新增'),h('button.btn.btn-default.removeBtn',{disabled:selectedIds.length?'':'disabled',onClick:linkEvent(selectedIds,actions.removeSelectedItems)},'删除')]);},searchField:function searchField(searchKey){return h('.input-group.navSearch',[h('input',{className:'form-control iptSearch',type:'text',value:searchKey||'',onInput:actions.changeSearchField}),h('span.spanSearch',[h('span',{className:'glyphicon glyphicon-search'})])]);},rightBtnGroup:function rightBtnGroup(items,selectedIds){var startBtnState;var stopBtnState;if(selectedIds.length===0){startBtnState='disabled';stopBtnState='disabled';}else{var enableArr=[];items.forEach(function(row){if(selectedIds.indexOf(row._id)!==-1){if(Number(row.status)===1){enableArr.push(row);}}});if(enableArr.length===0){startBtnState='';stopBtnState='disabled';}else if(enableArr.length===selectedIds.length){startBtnState='disabled';stopBtnState='';}else{startBtnState='';stopBtnState='';}}
return h('.navRightBtn',[h('button',{className:'btn btn-default startBtn',disabled:startBtnState,onClick:linkEvent(selectedIds,actions.enableStrategies)},'启用'),h('button',{className:'btn btn-default stopBtn',disabled:stopBtnState,onClick:linkEvent(selectedIds,actions.disableStrategies)},'禁用')]);},table:function table(items,selectedIds,searchKey,loading){var _this=this;var renderTrDatas=[];var tbodyStr;var dom;if(searchKey!==''){items.forEach(function(row){if(row.name.trim().toLowerCase().indexOf(searchKey)!==-1){renderTrDatas.push(_this.layoutTr(row,false,selectedIds));}});if(renderTrDatas.length===0){renderTrDatas.push(h('tr',[h('td',{colspan:9},'未找到记录')]));}}else{if(items.length===0&&loading==='Loading'){renderTrDatas.push(h('tr',[h('td',{colspan:9},loading)]));}else{if(items.length===0){renderTrDatas.push(h('tr',[h('td',{colSpan:9},'未找到记录')]));}else{if(selectedIds.length===0){items.forEach(function(row){renderTrDatas.push(_this.layoutTr(row,false,selectedIds));});}else{items.forEach(function(row){if(selectedIds.indexOf(row._id)!==-1){renderTrDatas.push(_this.layoutTr(row,true,selectedIds));}else{renderTrDatas.push(_this.layoutTr(row,false,selectedIds));}});}}}}
return h('table.strategyTable',[h('thead',[h('tr',[h('th',{style:{width:'12%'}},'名称'),h('th',{style:{width:'12%'}},'从属'),h('th',{style:{width:'5%'}},'状态'),h('th',{style:{width:'12%'}},'上次执行'),h('th',{style:{width:'5%'}},'运行间隔'),h('th',{style:{width:'5%'}},'类型'),h('th',{style:{width:'5%'}},'修改人'),h('th',{style:{width:'12%'}},'修改时间'),h('th',{style:{width:'20%'}},'描述')])]),h('tbody',renderTrDatas)]);},layoutTr:function layoutTr(detail,flag,selectedIds){var type=Number(detail.type)===0?'诊断':Number(detail.type)===1?'KPI':'计算点';var status=Number(detail.status)===0?'未启用':'启用';var className=flag?'selected':'';return h('tr',{className:className,'data-id':detail._id,'parent-id':detail.nodeId,onDoubleClick:linkEvent(detail._id,actions.openStrategy),onClick:linkEvent({_id:detail._id,selectedIds:selectedIds},actions.selectRows)},[h('td',{title:detail.name},detail.name),h('td',{title:'VAV'},'VAV'),h('td',status),h('td',detail.lastRuntime),h('td',detail.interval),h('td',type),h('td',detail.userId),h('td',detail.lastTime),h('td',{title:detail.desc},detail.desc)]);}};function StrategyTable(props,context){var state=props.strategyTable;actions.dispatch=actions.dispatch||context.dispatch;return h('div',{id:'strategyTable',style:{width:'100%',height:'100%'}},[h('.toolBar.clearfix',[theme.leftBtnGroup(state.selectedIds,props.equipTree.selectedGroupId),theme.rightBtnGroup(state.items,state.selectedIds),theme.searchField(state.searchKey)]),h('.detailTable.gray-scrollbar',{style:{height:'calc(100% - 74px)',overflow:'auto'}},[theme.table(state.items,state.selectedIds,state.searchKey)])]);}
exports.StrategyTable=StrategyTable;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,constants,React){var h=React.h;var linkEvent=React.linkEvent;var deepClone=$.extend.bind($,true);var actions={dispatch:null,save:function save(selectedIds,e){actions.dispatch({type:constants.propPanel.SAVE_PROP,value:{target:e.currentTarget,selectedIds:selectedIds}});}};var theme={topBtns:function topBtns(selectedIrems,selectedIds){if(selectedIrems.length>0){return h('div',{style:{padding:'15px 15px 0 0'}},[h('button.btn.btn-default.fr',{onClick:linkEvent(selectedIds,actions.save)},'保存'),h('button.btn.btn-default.fr',{style:{marginRight:'10px'},onClick:this.onRecover},'恢复'),h('div',{style:{clear:'both'}})]);}},propView:function propView(selectedIrems,selectedIds){var LABEL_WIDTH='30%',INPUT_WIDTH='69%';var createRow=function createRow(text,input){return h('.form-group',{style:{width:'100%'}},[h('label',{style:{fontSize:'14px',width:LABEL_WIDTH,padding:'6px'}},text),input]);};if(selectedIrems.length==1){var item=selectedIrems[0];var statusArr=[],typeArr=[];statusArr[Number(item.status)]='selected';typeArr[Number(item.type)]='selected';return h('form.form-inline',{style:{padding:'15px'}},[createRow('名字',h('input',{type:'text',name:'name',value:item.name,style:{width:INPUT_WIDTH},onChange:linkEvent('name',this.onChangeHandler)})),createRow('状态',h('select',{name:'status',value:item.status,onChange:linkEvent('status',this.onChangeHandler)},[h('option',{value:'0',selected:statusArr[0]},'不启用'),h('option',{value:'1',selected:statusArr[1]},'启用')])),createRow('运行间隔',h('input',{type:'text',name:'interval',defaultValue:item.interval,style:{width:INPUT_WIDTH},onChange:linkEvent('interval',this.onChangeHandler)})),createRow('类型',h('select',{name:'type',value:item.type,onChange:linkEvent('type',this.onChangeHandler)},[h('option',{value:'0',selected:typeArr[0]},'诊断'),h('option',{value:'1',selected:typeArr[1]},'KPI'),h('option',{value:'2',selected:typeArr[2]},'计算点')])),createRow('描述',h('input',{type:'text',name:'desc',value:item.desc,title:item.desc,style:{width:INPUT_WIDTH},onChange:linkEvent('desc',this.onChangeHandler)})),createRow('从属',h('label',{style:{fontSize:'14px',width:INPUT_WIDTH,padding:'6px 7px','font-weight':'normal'}},['VAV'])),createRow('最后运行时间',h('label',{style:{fontSize:'14px',width:INPUT_WIDTH,padding:'6px 7px','font-weight':'normal'}},[item.lastRuntime])),createRow('修改人',h('label',{style:{fontSize:'14px',width:INPUT_WIDTH,padding:'6px 7px','font-weight':'normal'}},[item.userId])),createRow('最后修改时间',h('label',{style:{fontSize:'14px',width:INPUT_WIDTH,padding:'6px 7px','font-weight':'normal'}},[item.lastTime]))]);}
if(selectedIrems.length>1){var items=selectedIrems;var keys=Object.keys(items[0]);var obj={};keys.forEach(function(key){obj[key]=new Set(items.map(function(item){return item[key];})).size>1?'':items[0][key];});var item=selectedIrems[0];var statusArr=[],typeArr=[];statusArr[Number(obj.status)]='selected';typeArr[Number(obj.type)]='selected';return h('form.form-inline',{style:{padding:'15px'}},[createRow('名字',h('input',{type:'text',name:'name',value:obj.name,style:{width:INPUT_WIDTH},onChange:linkEvent('name',this.onChangeHandler)})),createRow('状态',h('select',{name:'status',value:item.status,style:{width:INPUT_WIDTH},onChange:linkEvent('status',this.onChangeHandler)},[h('option',{value:'0',selected:statusArr[0]},'不启用'),h('option',{value:'1',selected:statusArr[1]},'启用')])),createRow('运行间隔',h('input',{type:'text',name:'interval',value:obj.interval,style:{width:INPUT_WIDTH},onChange:linkEvent('interval',this.onChangeHandler)})),createRow('类型',h('select',{name:'type',value:item.type,style:{width:INPUT_WIDTH},onChange:linkEvent('type',this.onChangeHandler)},[h('option',{value:'0',selected:typeArr[0]},'诊断'),h('option',{value:'1',selected:typeArr[1]},'KPI'),h('option',{value:'2',selected:typeArr[2]},'计算点')])),createRow('描述',h('input',{type:'text',name:'desc',value:obj.desc,title:obj.desc,style:{width:INPUT_WIDTH},onChange:linkEvent('desc',this.onChangeHandler)}))]);}}};var PropPanel=function(_React$Component){_inherits(PropPanel,_React$Component);function PropPanel(props,context){_classCallCheck(this,PropPanel);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props,context));_this.state={items:deepClone([],_this.props.items)};window.propsa=_this.props;_this.onChangeHandler=_this.onChangeHandler.bind(_this);_this.onRecover=_this.onRecover.bind(_this);return _this;}
PropPanel.prototype.onChangeHandler=function onChangeHandler(key,e){var items=this.state.items;var value=e.currentTarget.value;items.forEach(function(row){if(key in row){row[key]=value;}});this.setState({items:items});};PropPanel.prototype.onRecover=function onRecover(){this.setState({items:deepClone([],this.props.items)});};PropPanel.prototype.componentWillReceiveProps=function componentWillReceiveProps(nextProps){var newKeys=nextProps.selectedIds;var oldKeys=this.props.selectedIds;var flag=false;if(newKeys.length===oldKeys.length&&oldKeys.length!==0){oldKeys.some(function(row){if(newKeys.indexOf(row)===-1){flag=true;return true;}});}else if(oldKeys.length!==newKeys.length){flag=true;}
flag&&this.setState({items:deepClone([],nextProps.items)});};PropPanel.prototype.render=function render(){actions.dispatch=actions.dispatch||this.context.dispatch;return h('div',{id:'propPanel',style:{width:'100%',height:'100%'}},[theme.topBtns.call(this,this.state.items,this.props.selectedIds),theme.propView.call(this,this.state.items,this.props.selectedIds)]);};return PropPanel;}(React.Component);exports.PropPanel=PropPanel;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,constants,React){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null};var RuleTree=function(_React$Component){_inherits(RuleTree,_React$Component);function RuleTree(props,context){_classCallCheck(this,RuleTree);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props,context));_this.refs={};return _this;}
RuleTree.prototype.refDefine=function refDefine(name){var refs=this.refs={};return function(dom){refs[name]=dom;};};RuleTree.prototype.zTreeOnNodeCreated=function zTreeOnNodeCreated(e,treeId,treeNode){var domA;var $container=$(this.refs.domWrap);var $span_switch=$container.find('#'+treeNode.tId+'_switch');var $span_a=$container.find('#'+treeNode.tId+'_a');$span_switch.prependTo($span_a);$span_a.addClass('cursorDefault');if(!treeNode.isParent){domA=$container[0].querySelector('#'+treeNode.tId+'_a');domA.setAttribute('draggable','true');domA.dataset.id=treeNode.id;domA.ondragstart=function(e){var $this=$(this);var dataTransfer=e.dataTransfer;var offset=$this.offset();var info={x:e.clientX-offset.left,y:e.clientY-offset.top,w:$this.width(),h:$this.height(),dataId:$this.data('id')};dataTransfer.setData('info',JSON.stringify(info));};}else{if(treeNode.tId==='strategyTplTreeCtn_1'){this.tree.expandNode(treeNode,true,false,true,true);}}};RuleTree.prototype.zTreeOnExpand=function zTreeOnExpand(e,treeId,treeNode){if(treeNode.tId==='strategyTplTreeCtn_1'){this.tree.expandNode(treeNode.children[0],true,false,true,true);}};RuleTree.prototype.componentDidMount=function componentDidMount(){this.tree=$.fn.zTree.getZTreeObj('strategyTplTreeCtn');var domCtn;if(!this.tree){domCtn=this.refs.domWrap;this.tree=$.fn.zTree.init($(domCtn),{async:{enable:true,type:'get',url:function url(treeId,treeNode){var url="/strategy/template/group";if(!treeNode){return url;}else{return url+"/"+treeNode.id;}},dataFilter:function dataFilter(treeId,parentNode,rs){if(rs.status!=='OK'){return[];}
return rs.data.data.map(function(row){var params={id:row._id,pId:row.group,name:row.name,isParent:row.isGroup===1,desc:row.desc,userId:row.userId,lastTime:row.lastTime};if(row.isFolder!==1){params.keywords=row.keywords;params.type=row.type;params.option=row.option;}
return params;});}},view:{showLine:false,showIcon:false,selectedMulti:false,fontCss:{color:"#cadee5"}},callback:{onNodeCreated:this.zTreeOnNodeCreated.bind(this),onExpand:this.zTreeOnExpand.bind(this)}});}};RuleTree.prototype.shouldComponentUpdate=function shouldComponentUpdate(){return false;};RuleTree.prototype.componentWillUnmount=function componentWillUnmount(){if(this.tree){this.tree.destroy();this.tree=null;}};RuleTree.prototype.render=function render(){return h('div',{id:"strategyTplTreeCtn",className:"ztree",ref:this.refDefine('domWrap')});};return RuleTree;}(React.Component);var theme={};function RulePanel(props,context){actions.dispatch=context.dispatch;return h('div',{id:'RulePanel',style:{width:'100%',height:'100%'}},[h('div',{className:"strategyTplTreeContent gray-scrollbar"},[h(RuleTree)])]);}
exports.RulePanel=RulePanel;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('beop.strategy.core.constants'),namespace('React'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,constants,React){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null};var theme={createRow:function createRow(text,input){return h('.form-group',{style:{width:'100%'}},[h('label',{style:{fontSize:'14px',width:'30%',padding:'6px'}},text),input]);},propView:function propView(selectedModules){var INPUT_WIDTH='69%';var item=selectedModules[0];var type;if(!item){return null;}
switch(item.type){case 0:type='诊断';break;case 1:type='KPI';break;case 2:type='计算点';break;}
return h('form.form-inline',{style:{padding:'15px'}},[theme.createRow('名字',h('input',{type:'text',value:item.name,style:{width:INPUT_WIDTH},onChange:linkEvent('name',this.onChangeHandler)})),theme.createRow('类型',h('label',{style:{fontSize:'14px',width:INPUT_WIDTH,padding:'6px 7px','font-weight':'normal'}},[type])),theme.createRow('描述',h('input',{type:'text',name:'desc',value:item.desc,title:item.desc,style:{width:INPUT_WIDTH},onChange:linkEvent('desc',this.onChangeHandler)}))]);}};var ModulePropPanel=function(_React$Component){_inherits(ModulePropPanel,_React$Component);function ModulePropPanel(props,context){_classCallCheck(this,ModulePropPanel);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props,context));actions.dispatch=_this.context.dispatch;_this.state=_this.props.modulePropPanel;_this.onChangeHandler=_this.onChangeHandler.bind(_this);return _this;}
ModulePropPanel.prototype.onChangeHandler=function onChangeHandler(key,e){var items=this.props.modulePropPanel.selectedModules;var value=e.currentTarget.value;items.forEach(function(row){if(key in row){row[key]=value;}});this.setState({items:items});actions.dispatch({type:constants.modulePropPanel.CHANGE_SELECTEDMODULES_PROPS,props:items});};ModulePropPanel.prototype.render=function render(){return h('div',{id:'ModulePropPanel',style:{width:'100%',height:'100%'}},[theme.propView.call(this,this.props.modulePropPanel.selectedModules)]);};return ModulePropPanel;}(React.Component);exports.ModulePropPanel=ModulePropPanel;});var DataSource=function(){var _this;function DataSource(parent,opt){_this=this;this.m_parent=parent;this.m_newPointList=[];this.m_allPointList=[];this.m_allGroupList=[];this.m_arrProjIdColorMap={};this.m_dataSourceId;this.m_lang=I18n.resource.dataSource;this.m_selectItemId=0;this.m_selectGroupId=0;this.m_groupIconOpen='/static/images/dataSource/group_head_sel.png';this.m_groupIconClose='/static/images/dataSource/group_head_normal.png';this.m_cfgPanel;this.m_unassigned='unassigned';this.m_langFlag='zh'==localStorage['language']?0:1;this.$dsNavContain=undefined;this.m_curPageNum=1;this.m_arrCloudTableInfo=[];this.disableIot=opt&&opt.disableIot?true:false;this.treeObj=undefined;this.iotFilter=undefined;this.iotOpt={};}DataSource.prototype={show:function show(){var _this=this;Spinner.spin(ElScreenContainer);I18n.fillArea($('#divAnlsDatasourcePane'));I18n.fillArea($('#divEnergyAnlsPane'));_this.loadDataSourceRecord();_this.initContain();_this.initElement();Spinner.stop();},close:function close(){this.m_newPointList=null;this.m_allPointList=null;},initContain:function initContain(){this.initTreeNavStyle();},initTreeNavStyle:function initTreeNavStyle(){WebAPI.get('/static/views/observer/dataSource.html').done(function(resultHtml){_this.$dsNavContain=$(resultHtml);I18n.fillArea(_this.$dsNavContain);var $pageMine=_this.$dsNavContain.find('#pageMine');var $pageCloud=_this.$dsNavContain.find('#pageCloud');var $pageIot=_this.$dsNavContain.find('#pageIot');AppConfig.isFactory&&_this.$dsNavContain.find('#liMine').css('display','none').attr('class','');_this.$dsNavContain.find('#liMine').click(function(e){$('#liMine').attr('class','active');$('#liCloud').attr('class','');$('#liIot').attr('class','');$pageMine.show();$pageCloud.hide();$pageIot.hide();_this.currentObj='mine';});_this.$dsNavContain.find('#liCloud').click(function(e){if(_this.m_arrCloudTableInfo.length<=0){_this.initDsCloud();}$('#liMine').attr('class','');$('#liCloud').attr('class','active');$('#liIot').attr('class','');$pageMine.hide();$pageIot.hide();$pageCloud.show();_this.currentObj='cloud';});if(_this.disableIot){_this.$dsNavContain.find('#liIot').remove();}else{_this.$dsNavContain.find('#liIot').click(function(e){$('#liMine').attr('class','');$('#liCloud').attr('class','');$('#liIot').attr('class','active');$pageMine.hide();$pageIot.html('').show();$pageCloud.hide();_this.initIotFilter();_this.currentObj='iot';});_this.initIotFilter();}_this.initDsMine();$('#dataSrcContain').empty();$('#dataSrcContain').append(_this.$dsNavContain);AppConfig.isFactory&&$('#liCloud').click();var addGroup=$('<div id="dataSrcAddGroup"><input type="text" id="inputAddGroup" placeholder="+ Add group" ></div>');$pageMine.append(addGroup);$('#inputAddGroup').attr('placeholder',I18n.resource.dataSource.ADD_GROUP);$pageMine.keyup(function(e){if(13==e.keyCode){_this.addNewGroup();}});var inputAdd=addGroup.find('#inputAddGroup');inputAdd.attr('placeholder',_this.m_lang.ADD_GROUP);inputAdd.blur(function(e){_this.addNewGroup();});}).always(function(e){});},initIotFilter:function initIotFilter(){var $ctn=_this.$dsNavContain.find('#pageIot');_this.iotFilter=new HierFilter($ctn);_this.iotFilter.init();_this.iotOpt=$.extend(true,{},{base:{divideByProject:true},tree:{show:true,event:{click:[{act:onNodeClick,tar:['groups','projects']},{act:ontThingClick,tar:'things'},{act:function act(){console.log('click things');},tar:'things'}]},drag:{dragstart:[{act:onAttrDragStart,tar:'attrs'},{act:onThingsDragStart,tar:'things'}],dragend:[{act:onAttrDragEnd,tar:'attrs'}]}}},_this.iotOpt);_this.iotFilter.setOption(_this.iotOpt);function onNodeClick(event,treeId,treeNode){if(_this.iotFilter.setDefault===true){if(!treeNode.children||treeNode.children.length==0)return;var node=treeNode.children[0];_this.iotFilter.tree.selectNode(node);_this.iotFilter.tree.setting.callback.onClick({target:document.getElementById(node.tId)},node['_id'],node);_this.iotFilter.setDefault=false;}}function ontThingClick(event,treeId,treeNode){var attrs=_this.iotFilter.dictClass['things'][treeNode.type].attrs;var arrNode=[];var node;for(var pt in treeNode.arrP){if(!attrs[pt])continue;node={'_id':treeNode.arrP[pt],'name':attrs[pt].name,'attrType':pt,'baseType':'attrs'};arrNode.push(node);}if(!treeNode.children||treeNode.children.length==0){_this.iotFilter.tree.addNodes(treeNode,arrNode,true);}}function onThingsDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragEnd(){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');}function onNodeDblClick(event,treeId,treeNode,widget){}},initDsMine:function initDsMine(){var $inputSearch=_this.$dsNavContain.find('#inputDsMineSearch');$inputSearch.keyup(function(e){var searchVal=$(this).val().trim();if(13==e.keyCode&&searchVal){WebAPI.get('/analysis/datasource/searchDsItemInfo/'+AppConfig.userId+'/'+searchVal).done(function(result){var treeMine=_this.$dsNavContain.find('#treeMine');var zSetting={async:{enable:false},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false,nameIsHTML:true},edit:{enable:true,drag:{isCopy:false,isMove:false}},data:{simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove}};function addDiyDom(treeId,treeNode){var $itemLeaf=$('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}function addHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.setHoverColor(treeNode);}}function removeHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.removeHoverColor(treeNode);}}function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){_this.zTreeBeforeRemoveFunc(treeNode);}var zNodes=_this.generateSearchTree(result,searchVal);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,zNodes);$('#dataSrcAddGroup').hide();});}if(!searchVal){_this.initDsMineTree();$('#dataSrcAddGroup').show();}});_this.$dsNavContain.find('#spanDsMineSearch').click(function(e){$inputSearch.val('');_this.initDsMineTree();$('#dataSrcAddGroup').show();});_this.initDsMineTree();$('#dataSrcAddGroup').show();},initDsMineTree:function initDsMineTree(){var zSetting={async:{enable:true,type:'get',url:function url(treeId,treeNode){return'/analysis/datasource/getDsItemInfo/'+AppConfig.userId+'/'+(typeof treeNode==='undefined'?'null':treeNode.id);},dataFilter:dsItemfilter},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false},edit:{enable:true,renameTitle:I18n.resource.dataSource.RENAME,removeTitle:I18n.resource.dataSource.REMOVE,drag:{isCopy:false,isMove:false}},data:{keep:{leaf:true,parent:true},simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove,onAsyncSuccess:zTreeOnAsyncSuccess,onAsyncError:zTreeOnAsyncError,beforeEditName:zTreeBeforEditName}};function zTreeBeforEditName(treeId,treeNode){if(treeNode.note&&treeNode.note!==''&&treeNode.name.indexOf(treeNode.note)>=0){treeNode.name=treeNode.name.split('(')[1].split(')')[0];}}function dsItemfilter(treeId,parentNode,responseData){Spinner.spin(_this.$dsNavContain[8]);return _this.generateTreeEx(responseData);}function addDiyDom(treeId,treeNode){if(treeNode.num){var aObj=_this.$dsNavContain.find("#"+treeNode.tId+"_switch");var $badge=$('<span class="badge treeBadge">'+treeNode.num+'</span>');aObj.next('a').after($badge);}var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});_this.stopBubble(e);});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});EventAdapter.on($itemLeaf,'drop',function(e){var tar=$(e.target);var dstTLi=tar.closest('li');var dstId=dstTLi.eq(0).attr('id');var dstNode=_this.treeObj.getNodeByTId(dstId);var srcId=EventAdapter.getData().dsItemId;var srcJq=$('li[ptid$='+srcId+']');var srcTId=srcJq.eq(0).attr('id');var srcNode=_this.treeObj.getNodeByTId(srcTId);var dstParentId=dstNode.pId;var dstParentJq=$('li[ptid$='+dstParentId+']');var dstParentTId=dstParentJq.eq(0).attr('id');var dstParentNode=_this.treeObj.getNodeByTId(dstParentTId);var srcParentId=srcNode.pId;var srcParentJq=$('li[ptid$='+srcParentId+']');var srcParentTId=srcParentJq.eq(0).attr('id');var srcParentNode=_this.treeObj.getNodeByTId(srcParentTId);var postData={};var arrSrc=[];var arrDst=[];var srcParId=srcNode.pId;var dstParId=dstNode.pId;var saveType=0;if(srcNode.isParent&&!dstNode.isParent){return;}else if(!srcNode.isParent&&!dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){if(srcParId==dstParId){$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});postData[dstParentId]=arrDst;}else{$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstParentNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstParId]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstParId]=arrDst;}}}}else if(!srcNode.isParent&&dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'inner',true)){if(srcParentNode.children){$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});}$.each(dstNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstNode.id]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstNode.id]=arrDst;}}}else if(srcNode.isParent&&dstNode.isParent){saveType=1;var nSrcIdx=srcNode.getIndex();var nDstIdx=dstNode.getIndex();if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){var liGroup=$('#treeMine').children('li');if(liGroup&&liGroup.length>0){postData.groupIdList=[];$.each(liGroup,function(i,n){postData.groupIdList.push($(n).attr('ptid'));});}}}if(0==saveType){WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).always(function(){});}else if(1==saveType){WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).always(function(){});}_this.stopBubble(e);});if(treeNode.id==sessionStorage.getItem('dsOpenGroupId')){sessionStorage.removeItem('dsOpenGroupId');if(treeNode.isParent&&_this.treeObj){_this.treeObj.expandNode(treeNode,true,false,true);}}if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}
function addHoverDom(treeId,treeNode){if(treeNode.isParent){var sObj=$("#"+treeNode.tId+"_span");if(treeNode.editNameFlag||$("#addBtn_"+treeNode.tId).length>0){return;}
if(0==$("#addBtnFormula_"+treeNode.tId).length){var addStr="<span class='iconfont' id='addBtnFormula_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:4px'>&#xe63e;</span>";sObj.after(addStr);var btnGroup=$("#addBtnFormula_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_FORMULA);if(btnGroup)btnGroup.bind("click",function(){if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnPage_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-plus-sign button' id='addBtnPage_"+treeNode.tId+"' title='add point' onfocus='this.blur();' style='margin-left:4px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnPage_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT);if(btnGroup)btnGroup.bind("click",function(){var parentNodes=_this.treeObj.getNodesByParam('id',treeNode.id,null);if(parentNodes.length>0){if(!parentNodes[0].zAsync){_this.treeObj.expandNode(parentNodes[0],true,false,true);}}if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnGroup_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-object-align-bottom button' aria-hidden='true' id='addBtnGroup_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:20px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnGroup_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT_GROUP);if(btnGroup)btnGroup.bind("click",function(){var newName='new group';var postData={'groupId':'','name':newName,'parent':treeNode.id.toString(),'userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return;}var groupId=result.groupId;if(groupId){if(_this.treeObj){if(treeNode.zAsync){_this.treeObj.addNodes(treeNode,{id:result.groupId,pId:result.parentId,name:result.groupName,isParent:true});}else{_this.treeObj.expandNode(treeNode,true,false,true);}}}}).always(function(e){});return false;});}}else{_this.setHoverColor(treeNode);}};function removeHoverDom(treeId,treeNode){$("#addBtnGroup_"+treeNode.tId).unbind().remove();$("#addBtnPage_"+treeNode.tId).unbind().remove();$("#addBtnFormula_"+treeNode.tId).unbind().remove();if(!treeNode.isParent){_this.removeHoverColor(treeNode);}};function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){confirm(I18n.resource.dataSource.DELETE_GROUP_INFO,function(){_this.zTreeBeforeRemoveFunc(treeNode);_this.treeObj.removeNode(treeNode);});return false;}function zTreeOnAsyncSuccess(event,treeId,treeNode,msg){Spinner.stop();};function zTreeOnAsyncError(event,treeId,treeNode,XMLHttpRequest,textStatus,errorThrown){Spinner.stop();};$(document).ready(function(){var treeMine=_this.$dsNavContain.find('#treeMine');var arrInit=_this.generateTreeEx(_this.m_parent.store.group);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,arrInit);});},zTreeBeforeRenameFunc:function zTreeBeforeRenameFunc(treeNode,newName){if(treeNode.isParent){var postData={'groupId':treeNode.id,'name':newName,'parent':Boolean(treeNode.pId)?treeNode.pId.toString():'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var treeNodeNote=treeNode.note?treeNode.note:'';newName=treeNodeNote!==''?treeNodeNote+'('+newName+')':newName;var postData={itemList:[{id:treeNode.id,type:0,projId:treeNode.projId,alias:newName,note:treeNode.note,value:treeNode.value,groupId:treeNode.pId}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){return true;}return false;}).error(function(e){return false;}).always(function(e){treeNode.name=newName;$('#treeMine').find('li[ptid='+treeNode.id+']').find('a span').eq(1).text(newName);});}},zTreeBeforeRemoveFunc:function zTreeBeforeRemoveFunc(treeNode){if(treeNode.isParent){WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+treeNode.id).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);if($itemLeaf&&$itemLeaf.length>0){$itemLeaf.tooltip('destroy');}WebAPI.get('/analysis/datasource/removeSingle/'+treeNode.id).done(function(data){if(!data.success){return false;}else{var parentId=treeNode.pId;var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num-=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}return true;}}).always(function(){});}},generateTreeEx:function generateTreeEx(arr){var result=[];if(!arr){return result;}var params;var unassigned;for(var i=0,len=arr.length;i<len;i++){var item=arr[i];if(item){var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}params={id:item.id,pId:item.parentId,isParent:item.isParent,name:itemName,value:item.value,note:item.note,projId:item.projId,num:item.num,type:item.type};if(!item.isParent){var leafIcon=1==item.type?'ptFormula':'ptNormal';params['iconSkin']=leafIcon;}if('unassigned'==item.alias){unassigned=params;}else{result.push(params);}}}if(unassigned){result.push(unassigned);}return result;},generateSearchTree:function generateSearchTree(arr,searchText){var result=[];var params;for(var id in arr){params={id:id,pId:null,isParent:true,name:arr[id].groupName,value:id,note:'',projId:'',type:0,open:true};result.push(params);if(arr[id].dsList){for(var i=0,len=arr[id].dsList.length;i<len;i++){var item=arr[id].dsList[i];var keyWordName=item.alias;searchText.replace(/[^\w\d\s\u4e00-\u9fa5]/g,' ').split(/\s/g).forEach(function(search_item){if(search_item){keyWordName=keyWordName.replace(new RegExp("("+search_item+")(?![^<]*>|[^<>]*</)","gi"),'<span class="keyword">$1</span>');}});params={id:item.id,pId:id,isParent:false,name:keyWordName,value:item.value,note:item.note,projId:item.projId,type:item.type,iconSkin:1==item.type?'ptFormula':'ptNormal'};result.push(params);}}}return result;},setHoverColor:function setHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','#FFE6B0');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','#000');}$row.find('.edit').css('color','#000');$row.find('.remove').css('color','#000');}},removeHoverColor:function removeHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','');}$row.find('.edit').css('color','');$row.find('.remove').css('color','');}},initDsCloud:function initDsCloud(){var $selPrjName=_this.$dsNavContain.find('#selectPrjName');$selPrjName.empty();var opt;var prjId=AppConfig.project&&AppConfig.project.bindId?AppConfig.project.bindId:AppConfig.projectId;var nSize=AppConfig.projectList.length;var data=AppConfig.projectList.map(function(v,i){if(0==_this.m_langFlag){return{id:v.id,text:v.name_cn};}else{return{id:v.id,text:v.name_english};}});$selPrjName.select2({data:data}).off('change.myChange').on('change.myChange',function(e){var prjId=$('#selectPrjName').find('option:selected').val();_this.initDsCloudTable(prjId,1,50);}).val(prjId).trigger('change');var $inputSearch=_this.$dsNavContain.find('#inputDsCloudSearch');$inputSearch.keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}var size=50;WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:1,pageSize:size,searchText:searchVal}).done(function(result){if(result.success&&result.data){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();_this.setCloudTable(result.data.pointTable);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(1);}}).always(function(e){});}if(''==searchVal){_this.initDsCloudFunc();}});_this.$dsNavContain.find('#spanDsCloudSearch').click(function(e){$inputSearch.val('');_this.initDsCloudFunc();});},initCurPageNum:function initCurPageNum(page){this.m_curPageNum=page;},initDsCloudTable:function initDsCloudTable(prjId,page,size){if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:page,pageSize:size}).done(function(result){if(result.success&&result.data){_this.m_arrCloudTableInfo=result.data.pointTable;_this.setCloudTable(_this.m_arrCloudTableInfo);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(page);}}).always(function(e){Spinner.stop();});},initDsCloudFunc:function initDsCloudFunc(){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();var prjId=_this.$dsNavContain.find('#selectPrjName').val();_this.initDsCloudTable(prjId,1,50);},setCurrentPage:function setCurrentPage(curPageNum,size){curPageNum=parseInt(curPageNum,10);var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:curPageNum,pageSize:size,searchText:_this.$dsNavContain.find('#inputDsCloudSearch').val()}).done(function(result){if(result.success&&result.data){var ptTotal=result.data.pointTotal?result.data.pointTotal:0;var allPageNum=Math.ceil(ptTotal/size);_this.initCurPageNum(curPageNum);var liPageNum=$('#navPageNum').find('.pageNum');if(curPageNum<=3){liPageNum.eq(0).attr('value','1');liPageNum.eq(1).attr('value','2');liPageNum.eq(2).attr('value','3');liPageNum.eq(3).attr('value','4');liPageNum.eq(4).attr('value','5');liPageNum.eq(0).text('1');liPageNum.eq(1).text('2');liPageNum.eq(2).text('3');liPageNum.eq(3).text('4');liPageNum.eq(4).text('5');}else if(curPageNum>=allPageNum-2){liPageNum.eq(0).attr('value',allPageNum-4);liPageNum.eq(1).attr('value',allPageNum-3);liPageNum.eq(2).attr('value',allPageNum-2);liPageNum.eq(3).attr('value',allPageNum-1);liPageNum.eq(4).attr('value',allPageNum);liPageNum.eq(0).text(allPageNum-4);liPageNum.eq(1).text(allPageNum-3);liPageNum.eq(2).text(allPageNum-2);liPageNum.eq(3).text(allPageNum-1);liPageNum.eq(4).text(allPageNum);}else{liPageNum.eq(0).attr('value',curPageNum-2);liPageNum.eq(1).attr('value',curPageNum-1);liPageNum.eq(2).attr('value',curPageNum);liPageNum.eq(3).attr('value',curPageNum+1);liPageNum.eq(4).attr('value',curPageNum+2);liPageNum.eq(0).text(curPageNum-2);liPageNum.eq(1).text(curPageNum-1);liPageNum.eq(2).text(curPageNum);liPageNum.eq(3).text(curPageNum+1);liPageNum.eq(4).text(curPageNum+2);}
for(var i=0,len=liPageNum.length;i<len;i++){var item=liPageNum.eq(i);if(item.attr('value')==curPageNum){item.closest('li').attr('class','active');}else{item.closest('li').removeAttr('class');}}_this.setCloudTable(result.data.pointTable);}}).always(function(e){Spinner.stop();});},setCloudTable:function setCloudTable(ptTable,searchText){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');if($tableBody){$tableBody.empty();for(var i=0,len=ptTable.length;i<len;i++){var $itemTr=$('<tr ptId="'+ptTable[i]._id+'" draggable="true" title="'+ptTable[i].value+' : '+ptTable[i].alias+' "></tr>');var $itemTd=$('<td>');var $itemTdName=$('<span class="tabColName" data-value="'+ptTable[i].value+'">'+ptTable[i].value+'</span>');var $itemTdDesc=$('<span class="tabColDesc"> -- '+ptTable[i].alias+'</span>');var $itemTdIcon=$('<span class="btnFav glyphicon glyphicon-plus-sign" aria-hidden="true"></span>');$itemTdIcon.off().click(function(e){var $row=$(e.currentTarget).closest('tr');var ptId=$row.attr('ptId');for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){if(ptId==_this.m_arrCloudTableInfo[i]._id){_this.insertIntoMineTable(_this.m_arrCloudTableInfo[i]);break;}}});$itemTd.append($itemTdName);$itemTdDesc.append($itemTdIcon);$itemTd.append($itemTdDesc);$itemTr.append($itemTd);var start=null;EventAdapter.on($itemTr,'click',function(e){e=e||event;var $this=$(this);var $tableDsCloud=$('#tableDsCloud');var trArr=$tableDsCloud.find('tr');if(e.ctrlKey){if(!e.shiftKey){if($this.hasClass('activeTr')){$this.removeClass('activeTr');}else{$this.addClass('activeTr');}start=this;}else{var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);if($(start).hasClass('activeTr')){selTr.addClass('activeTr');}else{selTr.removeClass('activeTr');}}}else if(e.shiftKey){if($('.activeTr').length!==0){var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);selTr.addClass('activeTr');trArr.not(selTr).removeClass('activeTr');}else{$this.addClass('activeTr');}}else{trArr.removeClass('activeTr');$this.addClass('activeTr');start=this;}});EventAdapter.on($itemTr,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$('.activeTr').length>1?$('.activeTr'):$(e.target);var targetId=$(e.target).attr('ptid');var dragSrcId=undefined,isDragMore=false,dragId=[];if($('.activeTr').length>1){tar.each(function(i,item){var itemId=$(item).attr('ptid');if(itemId===targetId){isDragMore=true;}dragId.push(itemId);});if(isDragMore){dragSrcId=dragId;}else{dragSrcId=targetId;}}else{dragSrcId=tar.attr('ptid');}
EventAdapter.setData({'dsItemId':dragSrcId});e.originalEvent.dataTransfer.setData('dsItemId',dragSrcId);});EventAdapter.on($itemTr,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemTr,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});$tableBody.append($itemTr);}}},setCloudNav:function setCloudNav(allPageNum){var ul=$('<ul class="pagination">\
                <li><a class="pageFlag" value="First"><span aria-hidden="true">&laquo;</span></a></li>\
                <li><a class="pageFlag" value="Previous"><span aria-hidden="true">&lsaquo;</span></a></li>\
            </ul>');if(allPageNum>5){ul.append('<li class="active"><a class="pageFlag pageNum" value="1">1</a></li>\
                    <li><a class="pageFlag pageNum" value="2">2</a></li>\
                    <li><a class="pageFlag pageNum" value="3">3</a></li>\
                    <li><a class="pageFlag pageNum" value="4">4</a></li>\
                    <li><a class="pageFlag pageNum" value="5">5</a></li>');}else{for(var i=0;i<allPageNum;i++){var numTmp=i+1;if(0==i){ul.append('<li class="active"><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}else{ul.append('<li><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}}}ul.append('<li><a class="pageFlag" value="Next"><span aria-hidden="true">&rsaquo;</span></a></li>\
                        <li><a class="pageFlag" value="Last"><span aria-hidden="true">&raquo;</span></a></li>');var pageFlag=ul.find('.pageFlag');pageFlag.click(function(e){var value=$(e.currentTarget).attr('value');if('First'==value){if(_this.m_curPageNum!=1){_this.setCurrentPage(1,50);}}else if('Previous'==value){if(_this.m_curPageNum>1){_this.setCurrentPage(_this.m_curPageNum-1,50);}}else if('Next'==value){if(_this.m_curPageNum<allPageNum){_this.setCurrentPage(_this.m_curPageNum+1,50);}}else if('Last'==value){if(_this.m_curPageNum!=allPageNum){_this.setCurrentPage(allPageNum,50);}}else{if(_this.m_curPageNum!=value){_this.setCurrentPage(value,50);}}});var $navPage=_this.$dsNavContain.find('#navPageNum');$navPage.empty();$navPage.append(ul);},insertIntoMineTable:function insertIntoMineTable(newNode){var nodeParent=_this.treeObj.getNodesByParam('name','unassigned',null);if(nodeParent.length>0){var postData={itemList:[{type:0,projId:newNode.projId,alias:newNode.value,value:newNode.value,groupId:nodeParent[0].id}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){var item=data.itemIdList[0];var obj={id:item.id,pId:item.groupId,name:item.alias,isParent:false,value:item.value,note:item.note};_this.treeObj.addNodes(nodeParent[0],-1,obj);}}).always(function(e){});}},initElement:function initElement(){var _this=this;var len=AppConfig.projectList.length;var item;if(!(_this.m_parent.arrColor instanceof Array))return;var nColorSize=_this.m_parent.arrColor.length;for(var i=0;i<len;i++){item=AppConfig.projectList[i];_this.m_arrProjIdColorMap[item.id]=_this.m_parent.arrColor[i-parseInt(i/nColorSize)*nColorSize];}EventAdapter.on($('#data_source_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#data_source_formula_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#divAnlsDatasourcePane'),'click',function(e){_this.clearSelect();},false);$('#inputDsSearch').keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){$('#dataSrcPanel').empty();searchVal=searchVal.toLowerCase();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,searchVal);$('#dataSrcAddGroup').hide();}if(''==searchVal){$('#dataSrcPanel').empty();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,'');_this.colapseGroupsDefault();$('#dataSrcAddGroup').show();}});},insertIntoDataList:function insertIntoDataList(customName,ptName,ptDesc,prjName,iconColor,itemId,baseNode,bIsAppend,bIsSelected){var _this=this;var div;if(bIsSelected){div=$('<div draggable="true" class="dsItem grow dsSelected" style="height:34px"></div>');}else{div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');}div.attr('id',itemId);div.click(function(e){_this.clearSelect();var target=$(e.currentTarget);if('dsItem grow'==target.attr('class')){target.attr('class','dsItem grow dsSelected');}else{target.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var custName=$('<div class="dsValue" style="height:36px;">'+customName+'</div>');div.append(custName);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}_this.m_selectItemId=$(e.currentTarget).closest('.dsItem').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM_TIPS,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=data.deleteModal;var len=arr.length;if(len>0){var delMod;var arrDelTitle=[];for(var i=0;i<len;i++){delMod=$('#'+arr[i]);arrDelTitle.push(delMod.find('.newDivPageTitle').val());delMod.remove();}var delTitle=_this.m_lang.WORKSPACE+':';for(var i=0,len=arrDelTitle.length;i<len;i++){delTitle+=arrDelTitle[i]+' ';}delTitle+=_this.m_lang.REMOVE_RESULT;alert(delTitle);}}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var ctlPrjName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.PROJECT_NAME+': '+prjName+'</label></div>');ctlPrjName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPrjName);var ctlPtName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.POINT_NAME+': '+ptName+'</label></div>');ctlPtName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPtName);var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',ptDesc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:0,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);if(bIsAppend){baseNode.append(div);}else{baseNode.after(div);}},initToolTips:function initToolTips(parent,customName,projectName,pointName,pointDesc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:300px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="projectName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.PROJECT_NAME).append('</span>: ').append(projectName).append('</p> ');show.append('        <p class="pointName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_NAME).append('</span>: ').append(pointName).append('</p> ');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(pointDesc).append('</p> ');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var options={placement:'left',title:_this.m_lang.PARAM,template:show.toString(),trigger:'hover'};parent.tooltip(options);},setToolTipsAll:function setToolTipsAll(row,userName,customName,projectName,pointName,pointDesc){var tip=row.data('bs.tooltip').$tip;userName=': '+userName;customName=': '+customName;projectName=': '+projectName;pointName=': '+pointName;pointDesc=': '+pointDesc;tip.find('.userName').text(this.m_lang.USER_NAME+userName);tip.find('.customName').text(this.m_lang.CUSTOM_NAME+customName);tip.find('.projectName').text(this.m_lang.PROJECT_NAME+projectName);tip.find('.pointName').text(this.m_lang.POINT_NAME+pointName);tip.find('.pointDesc').text(this.m_lang.POINT_DESC+pointDesc);},setToolTipsCustomName:function setToolTipsCustomName(row,customName){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').text(this.m_lang.CUSTOM_NAME+': '+customName);},setToolTipsDesc:function setToolTipsDesc(row,ptDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.pointDesc').text(this.m_lang.POINT_DESC+': '+ptDesc);},renderTabel:function renderTabel(){var _this=this;var len=_this.m_newPointList.length;if(len<=0){return;}var div=$('#dataSrcPanel');var rowBaseNum=div.find('.dsItem').length;var rowCount;var item;var eachItem;var postData;len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};var arrOld=[];var bIsExist=false;var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){arrOld=parentNodes[0].children;}for(var i=0;i<len;i++){item=_this.m_newPointList[i];eachItem={type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};var bFlag=false;for(var j=0;j<arrOld.length;j++){if(item.prjId==arrOld[j].projId&&item.ptName==arrOld[j].value){bIsExist=true;bFlag=true;break;}}if(!bFlag){postData.itemList.push(eachItem);}}if(bIsExist){alert(I18n.resource.dataSource.ALREADY_EXIST);}var projName=_this.m_newPointList[0].prjName;var iconColor=_this.m_newPointList[0].iconColor;if(postData.itemList.length>0){WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}var list=data.itemIdList;var nAddlen=postData.itemList.length;for(var i=0;i<nAddlen;i++){if(postData.itemList[i].alias==list[i].alias){postData.itemList[i].itemId=list[i].id;}}
if(_this.treeObj){var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<postData.itemList.length;i++){var item=postData.itemList[i];var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}arrNodes.push({id:item.itemId,pId:item.groupId,isParent:false,name:itemName,value:item.value,projId:item.projId,note:item.note,type:0,iconSkin:'ptNormal'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=nAddlen;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}
_this.m_allPointList=_this.m_allPointList.concat(_this.m_newPointList);_this.calUpdateDataSources();}).error(function(){}).always(function(){});}}},modifyTable:function modifyTable(){var _this=this;var item;var eachItem;var postData;var len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};item=_this.m_newPointList[0];eachItem={id:item.itemId,type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(item.itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].prjId=item.prjId;_this.m_allPointList[i].prjName=_this.m_newPointList[0].prjName;_this.m_allPointList[i].customName=item.customName;_this.m_allPointList[i].ptName=item.ptName;_this.m_allPointList[i].ptDesc=item.ptDesc;break;}}
var divItem=$('#'+item.itemId);divItem.find('.showName').text(item.customName);_this.setToolTipsAll(divItem,item.userName,item.customName,item.prjName,item.ptName,item.ptDesc);_this.calUpdateDataSources();Beop.cache.ds.remove(item.itemId);}).error(function(){}).always(function(){});}},initDrag:function initDrag(){var _this=this;_this.dragOperateSrc($('#dataSrcPanel').get(0));_this.dragOperateCfg($('.springConfigMask').parent().get(0));},dragOperateSrc:function dragOperateSrc(tableList){if(undefined==tableList){return;}var _this=this;EventAdapter.on($(tableList),'dragstart',function(e){var tar=$(e.target);var className=tar.attr('class');if(!className){e.preventDefault();return;}if(tar.children('input').length>0){e.preventDefault();}if(-1!=className.indexOf('nav nav-list tree-group')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsGroupId':dragSrcId});}else if(-1!=className.indexOf('treeRow ui-draggable')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});}else{return;}$('.templatePara').css('display','block');});EventAdapter.on($(tableList),'dragover',function(e){e.preventDefault();});EventAdapter.on($(tableList),'drop',function(e){var tarItem=$(e.target);var tarId=0;var dstGroupId=0;var srcGroupId=0;var rowClass=tarItem.attr('class');if(!rowClass){return;}var dragType=-1;var draggedID=0;if(-1!=rowClass.indexOf('nav nav-list tree-group')||-1!=rowClass.indexOf('dsTreeHeader')){tarId=tarItem.closest('.nav').attr('id');draggedID=EventAdapter.getData().dsGroupId;if(Boolean(draggedID)){dragType=0;}else{draggedID=EventAdapter.getData().dsItemId;if(Boolean(draggedID)){dragType=2;tarId=tarItem.closest('.nav').attr('id');dstGroupId=tarId;srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}}}else if(-1!=rowClass.indexOf('showName')||-1!=rowClass.indexOf('treeRow ui-draggable')){dragType=1;draggedID=EventAdapter.getData().dsItemId;tarId=tarItem.closest('.treeRow').attr('id');dstGroupId=tarItem.closest('.nav').attr('id');srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}else{return;}if(draggedID==tarId||!draggedID){return;}if(0===dragType){var item,groupName;for(var i=0,len=_this.m_allGroupList.length;i<len;i++){item=_this.m_allGroupList[i];if(draggedID==item.id){groupName=item.name;break;}}$('#'+draggedID).remove();_this.insertTreeGroup(draggedID,groupName,1,$('#'+tarId));for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(draggedID==item.groupId){if(item.itemType==0){_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',true);}else{_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',false);}var prjName=_this.getProjectNameFromId(item.prjId,_this.m_langFlag);_this.initToolTips($('#'+item.itemId),item.customName,prjName,item.ptName,item.ptDesc);}}var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+tarId).find('.rows').find('.treeRow');srcGroup=$('#'+draggedID).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var postData={};postData[tarId]=arrDst;postData[draggedID]=arrSrc;WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).error(function(){}).always(function(){});}else if(1===dragType||2===dragType){var itemType=0;var iconColor='';var custName='';var projId=0;var pointName='';var pointDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(draggedID==_this.m_allPointList[i].itemId){_this.m_allPointList[i].groupId=dstGroupId;itemType=_this.m_allPointList[i].itemType;iconColor=_this.m_allPointList[i].iconColor;custName=_this.m_allPointList[i].customName;projId=_this.m_allPointList[i].prjId;pointName=_this.m_allPointList[i].ptName;pointDesc=_this.m_allPointList[i].ptDesc;break;}}var selItem=$('#'+draggedID);selItem.tooltip('destroy');selItem.remove();if(itemType==0){_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),true);}else{_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),false);}if(0==itemType){var prjName=_this.getProjectNameFromId(projId,_this.m_langFlag);_this.initToolTips($('#'+draggedID),custName,prjName,showName,pointDesc);}else if(1==itemType){var showName=_this.getShowNameFromFormula(pointName);_this.initFormulaToolTips($('#'+draggedID),custName,showName,pointDesc);}else{return;}var postData={};if(dstGroupId==srcGroupId){var srcGroup,arrSrc=[];srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(srcGroup,function(i,n){arrSrc.push(n.id);});postData[srcGroupId]=arrSrc;}else{var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+dstGroupId).find('.rows').find('.treeRow');srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var dstGroupCnt=0,srcGroupCnt=0;var groups=$('#dataSrcPanel .nav');$.each(groups,function(i,n){if(n.id==dstGroupId){dstGroupCnt=i;}if(n.id==srcGroupId){srcGroupCnt=i;}});if(dstGroupCnt<srcGroupCnt){postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}else{postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}}WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).error(function(){}).always(function(){});}});},dragOperateCfg:function dragOperateCfg(divItem){if(undefined==divItem){return;}var _this=this;EventAdapter.on($(divItem),'dragstart',function(e){var target=$(e.target);var className=target.attr('class');if('dsItem grow'!=className&&'dsItem grow dsSelected'!=className){return;}var dragSrcId=target.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($(divItem),'dragover',function(e){e.preventDefault();});EventAdapter.on($(divItem),'drop',function(e){var target=$(e.target);});},saveCurrentRecords:function saveCurrentRecords(){var _this=this;Spinner.spin(ElScreenContainer);WebAPI.post('/delete_data_source_records_by_userid',{userId:AppConfig.userId}).done(function(result){if(result!=0){Spinner.stop();return;}
var newPtList=[];var id;var len=_this.m_allPointList.length;var newRow;var item;$('#dataSrcPanel .dsItem').each(function(){id=$(this).attr('id');for(var i=0;i<len;i++){item=_this.m_allPointList[i];if(id==item.itemId){var _newRow;newRow=(_newRow={'itemId':id,'userId':item.userId,'userName':item.userName,'customName':item.customName,'prjId':item.prjId,'prjName':item.prjName,'ptName':item.ptName,'ptDesc':item.ptDesc,'iconColor':item.iconColor},_newRow['itemId']=item.itemId,_newRow);newPtList.push(newRow);break;}}});_this.m_allPointList=newPtList;var row;var data=[];var len=_this.m_allPointList.length;for(var i=0;i<len;i++){item=_this.m_allPointList[i];row={'userId':item.userId,'customName':item.customName,'projectId':item.prjId,'pointName':item.ptName,'pointDesc':item.ptDesc,'iconColor':item.iconColor};data.push(row);}WebAPI.post('/save_data_source_record',{sourceList:data}).done(function(result){if(0==result){}}).error(function(result){alert(I18n.resource.observer.widgets.DATABASE_OPERATION_FAILED+'！');return;});}).error(function(result){alert(I18n.resource.observer.widgets.FAIL_BEFORE_EXECUTING+'！');return;}).always(function(){Spinner.stop();});},loadDataSourceRecord:function loadDataSourceRecord(){var _this=this;var groupInfo=_this.m_parent.store.group;if(!groupInfo){return;}_this.m_allGroupList=[];_this.m_allPointList=[];var itemDefault=null;for(var m=0,n=groupInfo.length;m<n;m++){var groupId=groupInfo[m].groupId;var groupName=groupInfo[m].groupName;var groupIsDefault=Boolean(groupInfo[m].isDefault)?true:false;var data=groupInfo[m].datasourceList;var groupItem={'id':groupId,'name':groupName,'isDefault':groupIsDefault};if(groupIsDefault){itemDefault=groupItem;}else{_this.m_allGroupList.push(groupItem);}if(data){var len=data.length;var item;for(var i=0;i<len;i++){item={userId:AppConfig.userId,userName:AppConfig.account,customName:data[i].alias,prjId:data[i].projId,prjName:_this.getProjectNameFromId(data[i].projId),ptName:data[i].value,ptDesc:data[i].note,iconColor:_this.m_arrProjIdColorMap[data[i].projId],itemId:data[i].id,itemType:data[i].type,itemValue:data[i].value,groupId:groupId,groupName:groupName};if(item.itemType==1){item.iconColor='#000000';}_this.m_allPointList.push(item);}}}if(itemDefault){_this.m_allGroupList.push(itemDefault);}},colapseGroupsDefault:function colapseGroupsDefault(){var treeAllHead=$('.dsTreeHeader .dsGroupName');var item,row;for(var i=0,len=treeAllHead.length;i<len;i++){item=treeAllHead.eq(i);row=item.closest('.tree-group').find('.rows');if(!row||row.length<=0){continue;}if(item.text()==this.m_unassigned){row.css('display','block');}else{row.css('display','none');}}},colapseGroups:function colapseGroups(openGroupId){if(!openGroupId){return;}var treeAllRow=$('#dataSrcPanel .tree-group');var item,row;for(var i=0,len=treeAllRow.length;i<len;i++){item=treeAllRow.eq(i);row=item.find('.rows');if(!row||row.length<=0){continue;}if(item.attr('id')==openGroupId){row.css('display','block');}else{row.css('display','none');}}sessionStorage.removeItem('dsOpenGroupId');},getProjectNameFromId:function getProjectNameFromId(id,langFlag){var name;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(id==item.id){if(0==langFlag){name=item.name_cn;}else{name=item.name_en;}break;}}return name;},getProjectIdFromName:function getProjectIdFromName(projectName){var id;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(projectName==item.name_cn){id=item.id;break;}}return id;},calUpdateDataSources:function calUpdateDataSources(){return;var _this=this;var updateData=[];for(var i=0,len=_this.m_allGroupList.length;i<len;i++){var groupItem={'groupId':_this.m_allGroupList[i].id,'groupName':_this.m_allGroupList[i].name,'parentId':'','datasourceList':''};var dsList=[];for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){var curItem=_this.m_allPointList[j];if(groupItem.groupId==curItem.groupId){var pushItem={'id':curItem.itemId,'type':curItem.itemType,'projId':curItem.prjId,'alias':curItem.customName,'note':curItem.ptDesc,'value':curItem.ptName,'groupId':curItem.groupId};dsList.push(pushItem);}}groupItem.datasourceList=dsList;updateData.push(groupItem);}this.m_parent.updateDataSources(updateData);},renderFormula:function renderFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var prjId=0;var eachItem={type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var item;var arrNewFormula=[];for(var i=0,len=list.length;i<len;i++){item={'itemId':list[i].id,'itemType':1,'customName':list[i].alias,'itemValue':list[i].value,'ptName':list[i].value,'prjId':prjId,'iconColor':'#000000','ptDesc':_formulaDesc,'groupId':list[i].groupId};arrNewFormula.push(item);}
if(_this.treeObj){var parentId=arrNewFormula[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<len;i++){arrNodes.push({id:arrNewFormula[i].itemId,pId:arrNewFormula[i].groupId,isParent:false,name:arrNewFormula[i].customName,value:arrNewFormula[i].itemValue,projId:arrNewFormula[i].prjId,note:arrNewFormula[i].ptDesc,type:1,iconSkin:'ptFormula'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}_this.calUpdateDataSources();});},modifyFormula:function modifyFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var itemId=_this.m_selectItemId;var prjId=Number(AppConfig.projectId);var eachItem={id:itemId,type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;if(list.length>0){var showName=list[0].value;var arr=showName.split('<%');var arrId=[];var arrItem=[];for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''!=id){arrId.push(id);}}arrItem=_this.getDSItemById(arrId);for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''==id){continue;}for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var retVal=arrItem[m];if(null==retVal){continue;}showName=showName.replace(id,retVal.value);break;}}}showName=showName.replace(/<%/g,'');showName=showName.replace(/%>/g,'');for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=list[0].alias;_this.m_allPointList[i].ptName=list[0].value;_this.m_allPointList[i].ptDesc=list[0].note;break;}}var divFormula=$('#'+itemId);divFormula.find('.showName').text(list[0].alias);_this.setFormulaToolTipsAll(divFormula,list[0].alias,showName,list[0].note);_this.calUpdateDataSources();Beop.cache.ds.remove(itemId);}});},insertFormula:function insertFormula(itemId,customName,iconColor,formula,desc){var _this=this;var div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');div.attr('id',itemId);div.click(function(e){_this.clearSelect();var tar=$(e.currentTarget);if('dsItem grow'==tar.attr('class')){tar.attr('class','dsItem grow dsSelected');}else{tar.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var name=$('<div class="dsValue" style="height:36px"></div>');name.text(customName);div.append(name);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){var show=$(e.currentTarget).prevAll('.dsValue');show.css('display','none');var target=$(e.currentTarget).nextAll('.dsDivChange');target.attr('class','dsDivChange show');div.css('height','240px');div.css('width','100%');var item;var strName='';var strFormula='';var strDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){strName=item.customName;strFormula=item.ptName;strDesc=item.ptDesc;break;}}var temp=target.find('input');if(temp.length==2){$(temp[0]).val(strName);$(temp[1]).val(strDesc);}_this.stopBubble(e);}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var ctlFormula=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.FORMULA_NAME+': </label></div>');var showFormula=$('<span>'+formula+'</span>');showFormula.appendTo(ctlFormula.find('label')).mathquill();ctlFormula.click(function(e){_this.stopBubble(e);});divChange.append(ctlFormula);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',desc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:1,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(0==data.itemIdList.length){return;}var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);$('#dataSrcPanel').append(div);},initFormulaToolTips:function initFormulaToolTips(parent,customName,formula,desc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:400px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="formula tipStyle" style="word-break:normal;"><span class="tipTitleStyle">').append(_this.m_lang.FORMULA_NAME).append('</span>: ').append('</p>');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(desc).append('</p>');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var showFormula=$('<span>'+formula+'</span>');var showObj=$(show.toString());showFormula.appendTo(showObj.find('.formula')).mathquill();var options={placement:'left',title:_this.m_lang.PARAM,template:showObj};parent.tooltip(options);},setFormulaToolTipsAll:function setFormulaToolTipsAll(row,customName,formulaVal,formulaDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').html('<span style="font-weight:bold">'+this.m_lang.CUSTOM_NAME+'</span>: '+customName);tip.find('.pointDesc').html('<span style="font-weight:bold">'+this.m_lang.POINT_DESC+'</span>: '+formulaDesc);var showFormula=$('<span>'+formulaVal+'</span>');var dst=tip.find('.formula').html('<span style="font-weight:bold">'+this.m_lang.FORMULA_NAME+'</span>: ');showFormula.appendTo(dst).mathquill();},checkRepeatWithCustomName:function checkRepeatWithCustomName(_name){var _this=this;var bRet=false;var grids=$('#dataSrcPanel .dsItem .dsValue');$.each(grids,function(i,n){if(_name==$(n).text()){bRet=true;return false;}});return bRet;},stopBubble:function stopBubble(e){if(e&&e.stopPropagation){e.stopPropagation();}else{window.event.cancelBubble=true;}},clearSelect:function clearSelect(e){var itemList=$('#dataSrcPanel .dsItem');itemList.attr('class','dsItem grow');itemList.css('height','34px');itemList.css('width','33%');var panel=$('#dataSrcPanel');panel.find('.dsDivChange').attr('class','dsDivChange');panel.find('.dsValue').css('display','inline');},insertTreeGroup:function insertTreeGroup(groupId,groupName,type,baseGroup){var _this=this;var divContain=$('#dataSrcPanel');var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true">');var $liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});}).error(function(e){});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add"></span>');EventAdapter.on(btnAddDs,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add" /></span>');EventAdapter.on(btnAddFormula,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true"></span>');EventAdapter.on(spanEdit,'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on(inputEdit,'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-default btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on(btnEdit,'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}spanName.text(data.groupName);}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($liHd,'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');var imgPath=icon.attr('src');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').css('font-weight','400');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').css('font-weight','700');curTarHead.find('.dsTreeBtnFormula').css('display','inline');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');$ul.append(divLiRow);if(0===type){divContain.append($ul);}else if(1===type){if(''!=baseGroup){baseGroup.after($ul);}}else if(2===type){if(''!=baseGroup){baseGroup.before($ul);}}},insertTreeItem:function insertTreeItem(divParentGroup,itemId,iconColor,itemName,insertType,baseItem,bIsPoint){var _this=this;var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on(divShowName,'click',function(e){var oldCustName=$(e.currentTarget).text();var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px">');input.blur(function(e){var newCustName=$(e.currentTarget).val();if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:itemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divShowName.text(dstCustomName);_this.setToolTipsCustomName(divShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divShowName.after(input);divShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}
promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){});});}).error(function(e){});div.append(btnRemove);if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on(div,'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});if(0===insertType){divParentGroup.find('.rows').append(div);}else if(1===insertType){if(''!=baseItem){baseItem.after(div);}}else if(2===insertType){var lyRow=divParentGroup.find('.rows').find('.treeRow');if(0==lyRow.length){divParentGroup.find('.rows').append(div);}else{lyRow.eq(0).before(div);}}},insertTreeAllGroupItem:function insertTreeAllGroupItem(groupList,pointList,searchPointName){var _this=this;var divContain=$('#dataSrcPanel');var groupId,groupName,bIsDefault;for(var i=0,len=groupList.length;i<len;i++){groupId=groupList[i].id;groupName=groupList[i].name;bIsDefault=groupList[i].isDefault;var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true" dropable="true" isDefault="'+bIsDefault+'">');var $liHd;if(groupName==this.m_unassigned){$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');}else{$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon"></span></li>');}var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(btnRemove),'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add" style="display:none"></span>');if(groupName==this.m_unassigned){btnAddDs.css('display','inline');}EventAdapter.on($(btnAddDs),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add"  style="display:none"/></span>');if(groupName==this.m_unassigned){btnAddFormula.children('img').css('display','inline');}EventAdapter.on($(btnAddFormula),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(spanEdit),'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on($(inputEdit),'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-primary btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on($(btnEdit),'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var ulNav=tar.closest('.nav');var groupId=ulNav.attr('id');var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}var spanName=ulNav.find('.dsGroupName');if(Boolean(spanName)){spanName.text(data.groupName);}}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($($liHd),'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').removeClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').addClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','inline-block');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');if(groupName==_this.m_unassigned){divLiRow.css('display','block');}else{divLiRow.css('display','none');}$ul.append(divLiRow);var itemId,iconColor,itemName,itemPtName;var bHasSearched=false;for(var j=0,len2=pointList.length;j<len2;j++){if(groupId==pointList[j].groupId){itemId=pointList[j].itemId;iconColor=pointList[j].iconColor;itemName=pointList[j].customName;itemPtName=pointList[j].ptName;if(''!=searchPointName){var custNameLower=itemName.toLowerCase();var ptNameLower=itemPtName.toLowerCase();if(-1==custNameLower.indexOf(searchPointName)&&-1==ptNameLower.indexOf(searchPointName)){continue;}else{bHasSearched=true;}}var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true" dropable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on($(divShowName),'click',function(e){var divCurShowName=$(e.currentTarget);var oldCustName=divCurShowName.text();var selItemId=divCurShowName.closest('.treeRow').attr('id');var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px;background-color:#465b85">');input.blur(function(e){var $tar=$(e.currentTarget);var newCustName=$tar.val();if(''==newCustName){$tar.select();alert(I18n.resource.dataSource.CUSTOM_NOT_NULL);return;}if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(selItemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:selItemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divCurShowName.text(dstCustomName);_this.setToolTipsCustomName(divCurShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divCurShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divCurShowName.after(input);divCurShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on($(btnRemove),'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}Spinner.spin(div[0]);promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){}).always(function(e){Spinner.stop();});});});div.append(btnRemove);var bIsPoint=0==pointList[j].itemType?true:false;if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on($(div),'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});$ul.find('.rows').append(div);if(bIsPoint){var prjName=_this.getProjectNameFromId(pointList[j].prjId,_this.m_langFlag);_this.initToolTips(div,pointList[j].customName,prjName,pointList[j].ptName,pointList[j].ptDesc);}else{var showName=_this.getShowNameFromFormula(pointList[j].ptName);_this.initFormulaToolTips(div,pointList[j].customName,showName,pointList[j].ptDesc);}}}if(''==searchPointName){divContain.append($ul);}else{if(bHasSearched){divContain.append($ul);}}}},getDSItemById:function getDSItemById(datasourceItemId){var _this=this;var ret=[];var postData=[];var bIsArray=Object.prototype.toString.call(datasourceItemId)==='[object Array]';if(!bIsArray){if(this.m_parent.store.dsInfoList){var itemInfo;for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId==itemInfo.id){return itemInfo;}}}for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId==item._id){return{id:item._id,groupId:'',alias:item.alias,projId:item.projId,type:0,value:item.value};}}}else{var copyArr=datasourceItemId.slice();if(this.m_parent.store.dsInfoList){var itemInfo;for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId[j]==itemInfo.id){ret.push(itemInfo);break;}}}if(ret.length>0){return ret;}}for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId[j]==item._id){var index=copyArr.indexOf(item._id);if(index>-1){copyArr.splice(index,1);}ret.push({id:item._id,groupId:'',alias:!!item.alias?item.alias:item.value,projId:item.projId,type:0,value:item.value});}}}if(ret.length==datasourceItemId.length){return ret;}else{datasourceItemId=copyArr;}}if(!bIsArray){postData.push(datasourceItemId);}else{postData=datasourceItemId;}var dsRet=$.ajax({type:'POST',url:'/analysis/datasource/getDsItemsById',data:JSON.stringify(postData),contentType:'application/json',async:false}).responseText;if(dsRet){var temp=JSON.parse(dsRet);if(!bIsArray){ret=temp[0];if(!ret){ret={alias:undefined,groupId:undefined,id:undefined,note:undefined,projId:undefined,type:undefined,value:undefined};}}else{if(temp instanceof Array){temp.map(function(i){if(!i.alias){i.alias=i.value;}});}ret=ret.concat(temp);}return ret;}return{};},getDSItemData:function getDSItemData(target,arrDSItemIds){var _this=this.m_parent;var timeConfig;if(_this.curModal.timeRecent){timeConfig=generateTimeOption(_this.curModal);}else{timeConfig=_this.curModal;}var tmStart=timeConfig.startTime.toDate();var tmEnd=timeConfig.endTime.toDate();var tmFmt=timeConfig.format;var key;var preloadIds=[];var row=null,arrId;var ids=arrDSItemIds.concat();var postData={dsItemIds:ids,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt};var promise=$.Deferred();Beop.cache.ds.getBatch(ids,tmFmt,tmStart,tmEnd).done(function(rs){promise.resolve(rs);}).fail(function(e){console.warn(e);promise.reject();});promise.always(function(rs){var idsNotFound,cacheData;if(rs){idsNotFound=rs.idsNotFound;cacheData=rs.data;if(idsNotFound.length>0){postData.dsItemIds=idsNotFound;}else{target.spinnerStop();target.renderModal(cacheData);return;}}WebAPI.post('/analysis/startWorkspaceDataGenHistogram',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}Beop.cache.ds.set(data,tmFmt,tmStart,tmEnd).done(function(){if(cacheData&&cacheData!==null){data={list:data.list.concat(cacheData.list),timeShaft:data.timeShaft.length>0?data.timeShaft:cacheData.timeShaft};}}).fail(function(e){console.warn(e);}).always(function(){target.renderModal(data);});}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});});},getDSItemDataMulti:function getDSItemDataMulti(target,arrDSItemIds){var _this=this.m_parent;_this.curModal.arrComparePeriodLabel=[];var tmStart=_this.curModal.startTime;tmStart=tmStart.length<=10?tmStart+' 00:00:00':tmStart;var tmEnd=_this.curModal.endTime;tmEnd=tmEnd.length<=10?tmEnd+' 00:00:00':tmEnd;var tmFmt=_this.curModal.format;var comparePeriod=_this.curModal.comparePeriod;var period1,period2,time;var startDate=new Date(tmStart);var endDate=new Date(tmEnd);var compareDateI18n=I18n.resource.analysis.historyCompare;if(comparePeriod=='hour'){time=3600000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate()+' '+startDate.getHours()+':00');_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate()+' '+endDate.getHours()+':00');}if(comparePeriod=='day'){time=86400000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate());_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate());}if(comparePeriod=='week'){time=604800000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',startDate.getFullYear()).replace('<%week%>',getWeekNumber(tmStart)));_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',endDate.getFullYear()).replace('<%week%>',getWeekNumber(tmEnd)));}if(comparePeriod=='month'){var getCurrentMonthLastDay=function getCurrentMonthLastDay(date){var current=date.toDate();var currentMonth=current.getMonth();var nextMonth=++currentMonth;var nextMonthDayOne=new Date(current.getFullYear(),nextMonth,1);return new Date(nextMonthDayOne.getTime());};period1=getCurrentMonthLastDay(tmStart);period2=getCurrentMonthLastDay(tmEnd);_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1));_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1));}var postData=[{dsItemIds:arrDSItemIds,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period1.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt},{dsItemIds:arrDSItemIds,timeStart:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period2.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt}];WebAPI.post('/analysis/startWorkspaceDataGenHistogramMulti',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}
target.renderModal(data);}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});function isLeapYear(year){return year%400==0||year%4==0&&year%100!=0;}function getMonthDays(year,month){return[31,null,31,30,31,30,31,31,30,31,30,31][month]||(isLeapYear(year)?29:28);}function getWeekNumber(date){var now=date.toDate(),year=now.getFullYear(),month=now.getMonth(),days=now.getDate();for(var i=0;i<month;i++){days+=getMonthDays(year,i);}
var yearFirstDay=new Date(year,0,1).getDay()||7;var week=null;if(yearFirstDay==1){week=Math.ceil(days/yearFirstDay);}else{days-=7-yearFirstDay+1;week=Math.ceil(days/7)+1;}return week;}},getShowNameFromFormula:function getShowNameFromFormula(formula){var _this=this;var inputStr=formula;var nStart=inputStr.indexOf('<%');var nEnd=inputStr.indexOf('%>');if(-1==nStart||-1==nEnd){return inputStr;}var id=inputStr.substring(nStart+2,nEnd);if(''==id){return _this.getShowNameFromFormula(inputStr);}var retVal=_this.getDSItemById(id);if(null==retVal){return _this.getShowNameFromFormula(inputStr);}inputStr=inputStr.replace('<%'+id+'%>',retVal.value);return _this.getShowNameFromFormula(inputStr);},addNewGroup:function addNewGroup(){var groupName=$('#inputAddGroup').val();if(''==groupName){return;}var _this=this;var postData={'groupId':'','name':groupName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if('successful'!=data.error){return;}var groupId=data.groupId;if(groupId){if(_this.treeObj){var nodeUnassigned=_this.treeObj.getNodesByParam('name','unassigned',null);var index=-1;if(nodeUnassigned.length>0){index=_this.treeObj.getNodeIndex(nodeUnassigned[0]);}_this.treeObj.addNodes(null,index,{id:data.groupId,pId:data.parentId,name:data.groupName,isParent:true});}}$('#inputAddGroup').val('');$('#inputAddGroup').blur();}).fail(function(result){}).always(function(e){});}};return DataSource;}();var HierFilter=function(){function HierFilter($ctn,projectId,parent,theme){this.$ctn=$ctn;this.projectId=projectId;this.theme=theme;this.opt=undefined;this.parent=parent;this.defaultOpt={title:{show:false},base:{divideByProject:true},search:{show:true},class:{show:true,projects:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true},groups:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true},things:{show:true,class:'all',showAll:true,showNone:true,add:true,delete:true}},tree:{show:true,event:{},drag:{enable:true},base:{expandReload:true},tool:{add:{},beforeAdd:{},edit:{},del:{}},check:{enable:false}}};this.dictClass={};this.store=undefined;this.initDeferred=$.Deferred();this.$paneClass=undefined;this.$paneSearch=undefined;this.$paneTree=undefined;this.$paneAdd=undefined;this.tree=undefined;this.setDefault=false;this.prevProjId=undefined;this.isSearch=false;this.showStatus={'projects':'all','groups':'all','things':'all'};}
HierFilter.prototype={init:function init(ctn,theme){var _this=this;_this.$ctn=ctn?ctn:_this.$ctn;_this.theme=theme?theme:_this.theme;if(!_this.projectId){if(AppConfig&&AppConfig.projectId){_this.projectId=AppConfig.projectId;}else{if(window.parent&&window.parent.AppConfig.projectId){_this.projectId=window.parent.AppConfig.projectId;}}}
if(!_this.projectId)_this.projectId=-1;WebAPI.get('/static/scripts/iot/hierFilter.html').done(function(resultHTML){_this.$ctn.append(resultHTML);I18n.fillArea($('#filterWrapper'));_this.initAddPane();_this.initSearch();_this.initDeferred.resolve();});},setOption:function setOption(opt){var _this=this;_this.initDeferred.done(function(){_this.opt=$.extend(true,{},_this.defaultOpt,opt);var postData={parent:[],projId:[_this.projectId]};if(!_this.opt.base.divideByProject)delete postData.projId;$.when(WebAPI.get('/iot/getClassFamily/group/cn'),WebAPI.get('/iot/getClassFamily/thing/cn'),WebAPI.get('/iot/getClassFamily/project/cn')).done(function(groups,things,projects){_this.dictClass['groups']=groups[0];_this.dictClass['things']=things[0];_this.dictClass['projects']=projects[0];WebAPI.post('/iot/search',postData).done(function(resultDate){_this.store={groups:resultDate.groups,projects:resultDate.projects,things:resultDate.things};_this.isSearch=false;var $Deffer=$.Deferred();if(resultDate.projects.length==0&&_this.setIotProject()){_this.setIotProject().done(function(result){if(result&&result.status=='success'){_this.store.projects[0]._id=result._id;$Deffer.resolve();}else{$Deffer.reject();}}).fail(function(){$Deffer.reject();});}else{$Deffer.resolve();}
$Deffer.done(function(){for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
for(var type in _this.store){if(_this.opt.class&&_this.opt.class[type]&&_this.opt.class[type].class){if(_this.dictClass[type][_this.opt.class[type].class]&&_this.dictClass[type][_this.opt.class[type].class].parent=='BaseIOT'){_this.showStatus[type]='all';}else{_this.showStatus[type]=_this.opt.class[type].class;}}}
_this.initClassPane();_this.initTreePane(_this.store);_this.opt.tree.event.afterInit&&_this.opt.tree.event.afterInit();var node=_this.tree.getNodes();if(node.length==0)return;node=node[0];_this.tree.selectNode(node);_this.setDefault=true;_this.tree.setting.callback.onClick({target:document.getElementById(node.tId)},node['_id'],node);});});});});},setIotProject:function setIotProject(){if(!(AppConfig&&AppConfig.projectList instanceof Array))return;if(!this.projectId)return;var info;for(var i=0;i<AppConfig.projectList.length;i++){if(AppConfig.projectList[i].id==this.projectId){info=AppConfig.projectList[i];break;}}
if(!info)return;var postData={'_idMgt':'bbbbbbbbbbbbf32fbc300001',codeName:info.name_en,dictName:{cn:info.name_cn,en:info.name_en},latLng:info.latlng,arrP:{},type:'Project',projId:this.projectId};this.store.projects=[{codeName:info.name_en,name:info.name_cn,latLng:info.latlng,arrP:{},type:'Project',projId:this.projectId}];return WebAPI.post('/iot/setIotProject',postData);},refresh:function refresh(){},dispose:function dispose(){},close:function close(){},initClassPane:function initClassPane(){var _this=this;if(!(_this.opt.class&&_this.opt.class.show))return;_this.$paneClass=$('#paneIotType');_this.$paneClass.html('');setClassSel('projects');setClassSel('groups');setClassSel('things');function setClassSel(type){if(_this.opt.class&&_this.opt.class[type]&&_this.opt.class[type].show){var strType=type.slice(0,type.length-1);strType=strType[0].toLocaleUpperCase()+strType.slice(1);var $divSelect=$('\
                    <div class="divSelect" value="all">\
                        <span class="spSelRs">'+I18n.resource.iot.TREE_ALL+'</span>\
                        <span class="glyphicon glyphicon-triangle-bottom"></span>\
                    </div>');var selOpt=[];if(_this.opt.class[type].showAll){selOpt.push({value:'all',name:I18n.resource.iot.TREE_ALL});}
if(_this.opt.class[type].showNone){selOpt.push({value:'none',name:I18n.resource.iot.TREE_HIDE});}
for(var cls in _this.dictClass[type]){if(_this.dictClass[type][cls].parent=='BaseIOT')continue;selOpt.push({value:cls,name:_this.dictClass[type][cls].name,parent:_this.dictClass[type][cls].parent});}
var $selector=_this.setSel(selOpt).addClass('selClass');if($selector.find('li').length==0)return;$selector.off('click').on('click','li',function(e){e.stopPropagation();var value=$(e.currentTarget).attr('value');$selector.prevAll('.spSelRs').text($(e.currentTarget).children('span').text());$selector.attr('value');var opt={'type':type,'val':value};_this.showStatus[opt.type]=opt.val;_this.initTreeData(opt);_this.initAttrPane(opt);});$selector.attr('value',_this.showStatus[type]);if(_this.showStatus[type]=='all'){$divSelect.children('.spSelRs').text(I18n.resource.iot.TREE_ALL);}else if(_this.showStatus[type]=='none'){$divSelect.children('.spSelRs').text(I18n.resource.iot.TREE_HIDE);}else{var arrKey=Object.keys(_this.dictClass[type]);for(var i=0;i<arrKey.length;i++){if(arrKey[i]==_this.showStatus[type]){$divSelect.children('.spSelRs').text(_this.dictClass[type][arrKey[i]].name);break;}}}
$divSelect.append($selector);_this.$paneClass.append($divSelect);}}},setSel:function setSel(selOpt){var _this=this;var $selector=$('<ul>');var tempArr=[].concat(selOpt);var dictTree={};var level=0;var length=tempArr.length;var numLeft=length;var isRoot;for(var i=0;i<length;i++){isRoot=true;for(var j=0;j<length;j++){if(i==j)continue;if(selOpt[j].value==tempArr[i].parent){isRoot=false;break;}}
if(isRoot){tempArr[i].level=level;if(!dictTree[level])dictTree[level]=[];dictTree[level].push(tempArr[i]);tempArr[i]=null;}}
while(numLeft>0){numLeft=0;level++;for(var i=0;i<length;i++){if(!tempArr[i])continue;for(var j=0;j<dictTree[level-1].length;j++){if(tempArr[i].parent==dictTree[level-1][j].value){if(!dictTree[level])dictTree[level]=[];dictTree[level].push(tempArr[i]);tempArr[i]=null;break;}}}
for(var i=0;i<length;i++){if(tempArr[i])numLeft++;}}
var $option,$parent=[],$parentTemp=[];var $spName;for(var i=0;i<dictTree['0'].length;i++){$option=$('<li>');$option.addClass('level_0 '+dictTree['0'][i].value).attr('value',dictTree['0'][i].value);$spName=$('<span>').text(dictTree['0'][i].name);$option.append($spName);$option.append('<ul>');$selector.append($option);$parent.push($option);}
for(var ele in dictTree){if(ele=='0')continue;for(var i=0;i<dictTree[ele].length;i++){$option=$('<li>');$option.addClass('level_'+ele+' '+dictTree[ele][i].value).attr('value',dictTree[ele][i].value);$spName=$('<span>').text(dictTree[ele][i].name);$option.append($spName);$option.append('<ul>');for(var j=0;j<$parent.length;j++){if($parent[j].attr('value')==dictTree[ele][i].parent){$parent[j].children('ul').append($option);break;}}
$parentTemp.push($option);}
$parent=$parentTemp;$parentTemp=[];}
return $selector;},initAttrPane:function initAttrPane(opt){var _this=this;var $paneClass,cls,type,clsStore,$divAttr,attrStore,$selAttr,parentStore;cls=opt.val;type=opt.type;clsStore=_this.searchClass(cls);$paneClass=$('#paneIot-'+type).html('').removeClass('on');if(!clsStore)return;$paneClass.append('<div class="className">'+clsStore.name+'</div>');parentStore=_this.searchClass(clsStore.parent);if(parentStore&&parentStore.name){$paneClass.append('<div class="classParentName">'+parentStore.name+'</div>');}
$divAttr=$('<div class="divAttr">');for(var attr in clsStore.attrs){attrStore=clsStore.attrs[attr];setAttr(attrStore,$divAttr);$paneClass.find('.className').after($divAttr);}
if($paneClass.find('select').length>0){$paneClass.addClass('on');}
function setAttr(attrStore,$divAttr){if(attrStore.filter){$divAttr.append('<span class="label">'+attrStore.name+'</span>');$selAttr=$('<select class="filterAttr">').addClass('attr').attr('filterMode',attrStore.filter.t);if(attrStore.filter.t='enum'){for(var attrOpt in attrStore.filter.opt){$selAttr.append('<option value="'+attrOpt+'">'+attrStore.filter.opt[attrOpt]+'</option>');}}else if(attrStore.filter.t='range'){for(var j=0;j<attrStore.filter.opt.length;j++){$selAttr.append('<option value="'+attrStore.filter.opt[j]+'">'+attrStore.filter.opt[j]+'</option>');}}
$divAttr.append($selAttr);}}},initSearch:function initSearch(){var _this=this;var $iptSearch=$('#paneIotSearch').find('input');$iptSearch.next().off('click').on('click',function(){if($iptSearch.val()=='')return;$iptSearch.val('');clearSearch();});$iptSearch.on('propertychange input',function(e){if($iptSearch.val()==''){clearSearch();}});$iptSearch.keyup(function(e){if(13==e.keyCode){$iptSearch.blur();var projId;var selectNode=_this.tree.getSelectedNodes()[0];if(!selectNode||!selectNode['projId']){projId=_this.prevProjId?_this.prevProjId:_this.projectId;}else{var parentNode=selectNode.getParentNode();while(parentNode){selectNode=parentNode;parentNode=selectNode.getParentNode();}
_this.prevProjId=selectNode['projId'];}
var postData;if($iptSearch.val()==''){clearSearch();}else{postData={searchName:$iptSearch.val(),projId:projId?projId:_this.projectId};if(!_this.opt.base.divideByProject)delete postData.projId;WebAPI.post('/iot/fuzzysearch',postData).done(function(result){if(!result||!result.data)return;_this.isSearch=true;$.fn.zTree.destroy('paneIotData');_this.store={projects:[],groups:[],things:[]};_this.tree=null;for(var i=0;i<result.data.length;i++){result.data[i].pId=result.data[i]['_idPrt'];_this.store[result.data[i].baseType].push(result.data[i]);}
for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
_this.initTreePane(_this.store);});}}});function clearSearch(){var postData={parent:[],projId:[_this.projectId]};if(!_this.opt.base.divideByProject)delete postData.projId;WebAPI.post('/iot/search',postData).done(function(result){if(!result)return;_this.isSearch=false;$.fn.zTree.destroy('paneIotData');_this.store={projects:[],groups:[],things:[]};_this.tree=null;_this.store={groups:result.groups,projects:result.projects,things:result.things};for(var i=0;i<_this.store.groups.length;i++){_this.store.groups[i].isParent=true;_this.store.groups[i].baseType='groups';}
for(var i=0;i<_this.store.projects.length;i++){_this.store.projects[i].isParent=true;_this.store.projects[i].baseType='projects';}
for(var i=0;i<_this.store.things.length;i++){_this.store.things[i].baseType='things';}
_this.initClassPane();_this.initTreePane(_this.store);});}},searchName:function searchName(name){var _this=this;for(var type in _this.store.class){for(var keyName in _this.store.class[type]){if(keyName==name)return _this.store.class[type][keyName];}}},searchDeviceById:function searchDeviceById(id,type){var _this=this;if(!id)return[];var arrDevice=[];var arrId=[];if(type){if(id instanceof Array){for(var i=0;i<id.length;i++){arrId[i]={id:id[i],index:i};}
for(var i=0;i<_this.store[type].length;i++){for(var j=0;j<arrId.length;j++){if(_this.store[type][i]['_id']==arrId[j].id){arrDevice[arrId[j].index]=_this.store[type][i];arrId.splice(j,1);break;}}}}else{for(var i=0;i<_this.store[type].length;i++){if(_this.store[type][i]['_id']==id){return[_this.store[type][i]];}}}}else{if(id instanceof Array){for(var i=0;i<id.length;i++){arrId[i]={id:id[i],index:i};}
for(var ele in _this.store){for(var i=0;i<_this.store[ele].length;i++){for(var j=0;j<arrId.length;j++){if(_this.store[ele][i]['_id']==arrId[j].id){arrDevice[arrId[j].index]=_this.store[ele][i];arrId.splice(j,1);break;}}}}}else{for(var ele in _this.store){for(var i=0;i<_this.store[ele].length;i++){if(_this.store[ele][i]['_id']==id){return[_this.store[ele][i]];}}}}}
return arrDevice;},searchClass:function searchClass(cls){var _this=this;for(var type in _this.dictClass){for(var keyCls in _this.dictClass[type]){if(keyCls==cls)return _this.dictClass[type][keyCls];}}},initTreePane:function initTreePane(opt,parentNode){var _this2=this;var _this=this;if(_this.tree)return;_this.$paneTree=$('#paneIotData');_this.$paneTree.off('click');if(_this.opt.tree&&_this.opt.tree.show){var setting;var zNodes;(function(){var diyParam=function diyParam(treeNode){return{parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};};var dataFilter=function dataFilter(treeId,parentNode,resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
_this.initClassPane();};var addDiyDom=function addDiyDom(treeId,treeNode){var $target=$('#'+treeNode.tId);$target.attr('ptId',treeNode['_id']);$target.addClass(treeNode.baseType);if(treeNode.baseType=='groups'||treeNode.baseType=='things'){$target.children('a').append('\
                    <span class="btnDelete btnTreeNode glyphicon glyphicon-remove-sign"></span>\
                    <span class="btnEdit btnTreeNode glyphicon glyphicon-edit"></span>\
                    ');}
if(_this.opt.tree.drag&&_this.opt.tree.drag.enable){$target.attr('draggable',true);if(_this.opt.tree.drag.dragstart){attachDragEvent('dragstart',$target,treeNode);}
if(_this.opt.tree.drag.dragend){attachDragEvent('dragend',$target.children('a'),treeNode);}
if(_this.opt.tree.drag.drop){attachDragEvent('dragover',$target.children('a'),treeNode);attachDragEvent('dragleave',$target.children('a'),treeNode);attachDragEvent('drop',$target.children('a'),treeNode);}}
if(typeof _this.opt.tree.event.addDom=='function'){_this.opt.tree.event.addDom.call(_this,treeNode,$target);}};var addHoverDom=function addHoverDom(treeId,treeNode){if(treeNode.isParent)return;var $target=$('#'+treeNode.tId);$target.css({'background-color':'rgb(76, 100, 148)'});$target.children('a').css('color','black');};var removeHoverDom=function removeHoverDom(treeId,treeNode){if(treeNode.isParent)return;var $target=$('#'+treeNode.tId);$target.css({'background-color':'transparent'});$target.children('a').css('color','inherit');};var attachDragEvent=function attachDragEvent(type,target,treeNode){if(type=='dragover'||type=='dragleave'){target.on(type,function(e){e.preventDefault();_this.opt.tree.drag[type]&&_this.opt.tree.drag[type].call(_this,e,treeNode);});return;}
if(_this.opt.tree.drag[type]){if(_this.opt.tree.drag[type]instanceof Function){target.on(type,function(e){e.preventDefault();_this.opt.tree.drag[type].call(_this,e,treeNode);});}else if(_this.opt.tree.drag[type].act instanceof Function&&_this.opt.tree.drag[type].tar==treeNode.baseType){target.on(type,function(e){_this.opt.tree.drag[type].act.call(_this,e,treeNode);});}else if(_this.opt.tree.drag[type]instanceof Array){_this.opt.tree.drag[type].forEach(function(event,i){if(event.act instanceof Function&&event.tar==treeNode.baseType){target.on(type,function(e){e.stopPropagation();event.act.call(_this,e,treeNode);});}});}}};setting={data:{simpleData:{enable:true,idKey:'_id'}},keep:{leaf:true,parent:true},check:{enable:_this.opt.tree.check.enable},edit:{enable:true,drag:{isCopy:false,isMove:false},showRemoveBtn:false,showRenameBtn:false},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,dblClickExpand:false,showIcon:true,showLine:true},callback:{beforeRename:function beforeRename(){return false;},beforeRemove:function beforeRemove(){},beforeDrag:function beforeDrag(){return false;},beforeAsync:function beforeAsync(){},onAsyncSuccess:function onAsyncSuccess(){},onDblClick:function onDblClick(event,treeId,treeNode){if(!_this.opt.tree.event.dblClick)return;_this.opt.tree.event.dblClick.call(_this,event,treeId,treeNode);},onClick:function onClick(event,treeId,treeNode){if(!_this.opt.tree.event.click)return;var that=this;var dblFlag=false;var clkInterval;if(typeof treeNode.clickTime=='undefined'){clkInterval=Infinity;}else{clkInterval=new Date()-treeNode.clickTime;}
treeNode.clickTime=new Date();$(event.target).on('click.judgeDbl',function(){dblFlag=true;});var dblJudge=window.setInterval(function(){$(event.target).off('click.judgeDbl');window.clearInterval(dblJudge);if(!dblFlag&&clkInterval>200){if(_this.opt.tree.event.click.isDefault===false){_this.opt.tree.event.click.act.call(that,event,treeId,treeNode);return;}
_this.childAppend(treeNode,function(){if(_this.opt.tree.event.click){if(!_this.opt.tree.event.click instanceof Array){_this.opt.tree.event.click.call(that,event,treeId,treeNode);}else{for(var i=0;i<_this.opt.tree.event.click.length;i++){if(_this.opt.tree.event.click[i].tar.toString().indexOf(treeNode.baseType)>-1||_this.opt.tree.event.click[i].tar=='all'){_this.opt.tree.event.click[i].act.call(that,event,treeId,treeNode);}}}}});}},200);}}};if(_this.opt.tree.extend){$.extend(true,setting,setting,_this.opt.tree.extend);}
zNodes=_this.initTreeData(opt);_this.tree=$.fn.zTree.init(_this2.$paneTree,setting,zNodes);_this.$paneTree.on('click','.btnEdit',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.parentNode.id);var parentNode=treeNode.getParentNode();new CreateDeviceModal({mode:'edit',baseType:treeNode.baseType,filter:_this,parentNode:parentNode,treeNode:treeNode});});_this.$paneTree.on('click','.btnDelete',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.parentNode.id);infoBox.confirm('确认删除节点 '+treeNode.name+' ? 注意子文件及文件夹也将被删除并不可恢复。',okCallback);function okCallback(){var postData=[{'id':[treeNode['_id']],'type':treeNode['baseType']}];WebAPI.post('/iot/delIotInfo',{itemList:postData,projId:AppConfig.projectId}).done(function(){var nodes=_this.tree.getNodesByParam('_id',$(e.target.parentNode.parentNode).attr('ptid'));for(var i=0;i<nodes.length;i++){_this.tree.removeNode(nodes[i]);}
if(typeof _this.opt.tree.tool.delete=='function'){_this.opt.tree.tool.delete.call(_this,treeNode);}});}});_this.$paneTree.on('click','.btnTemplate',function(e){e.stopPropagation();var treeNode=_this.tree.getNodeByTId(e.target.parentNode.id);var strModalContent=new StringBuilder();strModalContent.append('               <iframe style="width:100%;height:100%;" name="ifram_factory" sandbox="allow-forms allow-popups allow-scripts allow-same-origin allow-modals" frameborder="0"></iframe>');var $modalContent=$(strModalContent.toString());var $modal=$('#templateModal');$modal.find('.modal-content').append($modalContent);$modal.modal('show');$modal.off().on('shown.bs.modal',function(){var form,ipt;form=document.createElement('form');form.action='/factory/preview/8f54051d0011456903054765';form.method='post';form.target='ifram_factory';ipt=document.createElement('input');ipt.type='hidden';ipt.name='params';ipt.value=JSON.stringify(treeNode.arrP);form.appendChild(ipt);document.body.appendChild(form);form.submit();document.body.removeChild(form);});$modal.on('hidden.bs.modal',function(){$modalContent.remove();});});_this.$paneTree.on('click','.projects>.button.switch',function(e){var $target=$(e.currentTarget);var node=_this.tree.getNodeByTId($target.parent().attr('id'));_this.childAppend(node,function(){});return false;});_this.$paneTree.on('click','.groups>.button.switch',function(e){var $target=$(e.currentTarget);var node=_this.tree.getNodeByTId($target.parent().attr('id'));_this.childAppend(node,function(){});return false;});})();}},initTreeData:function initTreeData(option){var _this=this;if(!_this.tree){var data=[];data=data.concat(this.store.projects);data=data.concat(this.store.groups);data=data.concat(this.store.things);}else{var root=_this.tree.getNodes();var data=_this.tree.transformToArray(root);for(var i=0;i<data.length;i++){if(data[i].baseType==option.type){_this.tree.showNode(data[i]);if(option.val=='all'){continue;}else if(option.val=='none'){_this.tree.hideNode(data[i]);}else if(data[i].type!=option.val){_this.tree.hideNode(data[i]);}}}}
if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,data);}
return data;},getChildren:function getChildren(treeNode,func,opt){var _this=this;var postData={parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};return WebAPI.post('/iot/search',postData).done(function(resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
var tempArr=[];for(var ele in resultData){if(ele=='class')continue;if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,resultData[ele],ele);}
var flag;for(var i=0;i<resultData[ele].length;i++){for(var j=0;j<_this.store[ele].length;j++){if(_this.store[ele][j]['_id']==resultData[ele][i]['_id']){if(ele=='groups'&&!resultData[ele][i].pId){resultData[ele][i].pId=resultData[ele][i]['_idProj'];}
if(_this.store[ele][j]['pId']==resultData[ele][i]['pId']){flag=true;}else{if(treeNode.children){for(var k=0;k<treeNode.children.length;k++){if(resultData[ele][i]['_id']==treeNode.children[k]['_id']){flag=true;break;}}}}
break;}}
if(resultData[ele][i].icon){resultData[ele][i].iconSkin='iconfont '+resultData[ele][i].icon;delete resultData[ele][i].icon;}
if(_this.opt.tree.base.expandReload||!flag){if(ele=='groups'||ele=='projects'){resultData[ele][i].isParent=true;}
resultData[ele][i].baseType=ele;if(!flag){_this.store[ele].push(resultData[ele][i]);}
tempArr.push(resultData[ele][i]);}}}
if(_this.opt.tree.base.expandReload){_this.tree.removeChildNodes(treeNode);}
if(tempArr.length==0){func(resultData);return;}
if(!opt||opt.add!==false){_this.tree.addNodes(treeNode,tempArr,true);}
if(!opt||opt.expand!==false){_this.tree.expandNode(treeNode,null,false,true,true);}
_this.initClassPane();func(resultData);});},childAppend:function childAppend(treeNode,func){var _this=this;if(treeNode.open){_this.tree.expandNode(treeNode,null,false,true,true);return;}else{if(treeNode.baseType=='things'){func();_this.tree.expandNode(treeNode,null,false,true,true);return;}else{var postData={parent:[{id:treeNode['_id'],type:treeNode['baseType']}]};WebAPI.post('/iot/search',postData).done(function(resultData){for(var type in resultData.class){for(var cls in resultData.class[type]){_this.dictClass[type][cls]=resultData.class[type][cls];}}
var tempArr=[];for(var ele in resultData){if(ele=='class')continue;if(typeof _this.opt.tree.data=='function'){_this.opt.tree.data.call(_this,resultData[ele],ele);}
var flag;for(var i=0;i<resultData[ele].length;i++){for(var j=0;j<_this.store[ele].length;j++){if(_this.store[ele][j]['_id']==resultData[ele][i]['_id']){if(ele=='groups'&&!resultData[ele][i].pId){resultData[ele][i].pId=resultData[ele][i]['_idProj'];}
if(_this.store[ele][j]['pId']==resultData[ele][i]['pId']){flag=true;}else{if(treeNode.children){for(var k=0;k<treeNode.children.length;k++){if(resultData[ele][i]['_id']==treeNode.children[k]['_id']){flag=true;break;}}}}
_this.store[ele][j]=resultData[ele][i];break;}}
if(_this.opt.tree.base.expandReload||!flag){if(ele=='groups'||ele=='projects'){resultData[ele][i].isParent=true;}
resultData[ele][i].baseType=ele;if(!flag){_this.store[ele].push(resultData[ele][i]);}
tempArr.push(resultData[ele][i]);}}}
if(_this.opt.tree.base.expandReload){_this.tree.removeChildNodes(treeNode);}
if(tempArr.length==0){func();_this.tree.expandNode(treeNode,null,false,true,true);return;}
_this.tree.addNodes(treeNode,tempArr,true);for(var base in _this.showStatus){_this.initTreeData({'type':base,'val':_this.showStatus[base]});}
_this.tree.expandNode(treeNode,null,false,true,true);_this.initClassPane();func();});}}},initAddPane:function initAddPane(){var _this=this;_this.$paneAdd=$('#paneIotAdd');var $btnAdd=$('.btnAddEle');$btnAdd.click(function(e){var parentNode=_this.tree.getSelectedNodes()[0];var callBack;if(typeof _this.opt.tree.tool.beforeAdd=='function'){callBack=_this.opt.tree.tool.beforeAdd.call(_this,parentNode);}
if(typeof _this.opt.tree.tool.beforeAdd.act=='function'){callBack=_this.opt.tree.tool.beforeAdd.act.call(_this,parentNode);}
if(callBack&&callBack.parentNode){parentNode=callBack.parentNode;}
if(parentNode.length==0){alert('请选择父节点');return;}
if(callBack&&callBack.isForbid){alert(callBack.msg);return;}
new CreateDeviceModal({mode:'add',baseType:$(e.currentTarget).attr('typeAdd'),filter:_this,parentNode:parentNode});});}};return HierFilter;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','../core/model.js','../core/Event.js','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('../core/model.js'),require('../core/Event.js'),require('React'));}else{factory(root,namespace('beop.strategy.core.Model'),namespace('beop.strategy.core.Event'),namespace('React'),namespace('beop.strategy.core.constants'));}})(namespace('beop.strategy.components'),function(exports,Model,Event,React,constants){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null};var Datasource=function(_React$Component){_inherits(Datasource,_React$Component);function Datasource(){_classCallCheck(this,Datasource);return _possibleConstructorReturn(this,_React$Component.apply(this,arguments));}
Datasource.prototype.refDefine=function refDefine(name){var refs=this.refs=this.refs||{};return function(dom){refs[name]=dom;};};Datasource.prototype.componentDidMount=function componentDidMount(){var _this=this;this.store={};window.ElScreenContainer=this.refs.domWrap;this.arrColor=["#ff7f50","#87cefa","#da70d6","#32cd32","#6495ed","#ff69b4","#ba55d3","#cd5c5c","#ffa500","#40e0d0","#1e90ff","#ff6347","#7b68ee","#00fa9a","#ffd700","#6699FF","#ff6666","#3cb371","#b8860b","#30e0e0"];var promise=$.Deferred();if(!AppConfig.datasource){Spinner.spin(this.refs.domWrap);WebAPI.get('/analysis/datasource/getDsItemInfo/'+AppConfig.userId+'/null').done(function(result){AppConfig.datasource=new DataSource({store:{group:result}});promise.resolve();});}else{promise.resolve();}
promise.done(function(){_this.store.group=AppConfig.datasource.m_parent.store.group;_this.paneDatasource=AppConfig.datasource=new DataSource(_this);_this.paneDatasource.show();});};Datasource.prototype.shouldComponentUpdate=function shouldComponentUpdate(){return false;};Datasource.prototype.render=function render(){return h('#dataSrcContain',{className:"gray-scrollbar white-skin",style:{height:'100%'},ref:this.refDefine('domWrap')});};return Datasource;}(React.Component);var theme={};function DataSourcePanel(props,context){actions.dispatch=context.dispatch;return h('#dataSourcePanel',{style:{width:'100%',height:'100%'}},[h(Datasource)]);}
exports.DataSourcePanel=DataSourcePanel;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(mod){if((typeof exports==="undefined"?"undefined":_typeof(exports))=="object"&&(typeof module==="undefined"?"undefined":_typeof(module))=="object")
mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)
define(["../../lib/codemirror"],mod);else
mod(CodeMirror);})(function(CodeMirror){"use strict";function wordRegexp(words){return new RegExp("^(("+words.join(")|(")+"))\\b");}
var wordOperators=wordRegexp(["and","or","not","is"]);var commonKeywords=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"];var commonBuiltins=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];var py2={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]};var py3={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None","async","await"]};CodeMirror.registerHelper("hintWords","python",commonKeywords.concat(commonBuiltins));function top(state){return state.scopes[state.scopes.length-1];}
CodeMirror.defineMode("python",function(conf,parserConf){var ERRORCLASS="error";var singleDelimiters=parserConf.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.]/;var doubleOperators=parserConf.doubleOperators||/^([!<>]==|<>|<<|>>|\/\/|\*\*)/;var doubleDelimiters=parserConf.doubleDelimiters||/^(\+=|\-=|\*=|%=|\/=|&=|\|=|\^=)/;var tripleDelimiters=parserConf.tripleDelimiters||/^(\/\/=|>>=|<<=|\*\*=)/;if(parserConf.version&&parseInt(parserConf.version,10)==3){var singleOperators=parserConf.singleOperators||/^[\+\-\*\/%&|\^~<>!@]/;var identifiers=parserConf.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;}else{var singleOperators=parserConf.singleOperators||/^[\+\-\*\/%&|\^~<>!]/;var identifiers=parserConf.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;}
var hangingIndent=parserConf.hangingIndent||conf.indentUnit;var myKeywords=commonKeywords,myBuiltins=commonBuiltins;if(parserConf.extra_keywords!=undefined)myKeywords=myKeywords.concat(parserConf.extra_keywords);if(parserConf.extra_builtins!=undefined)myBuiltins=myBuiltins.concat(parserConf.extra_builtins);if(parserConf.version&&parseInt(parserConf.version,10)==3){myKeywords=myKeywords.concat(py3.keywords);myBuiltins=myBuiltins.concat(py3.builtins);var stringPrefixes=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i");}else{myKeywords=myKeywords.concat(py2.keywords);myBuiltins=myBuiltins.concat(py2.builtins);var stringPrefixes=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i");}
var keywords=wordRegexp(myKeywords);var builtins=wordRegexp(myBuiltins);function tokenBase(stream,state){if(stream.sol())state.indent=stream.indentation();if(stream.sol()&&top(state).type=="py"){var scopeOffset=top(state).offset;if(stream.eatSpace()){var lineOffset=stream.indentation();if(lineOffset>scopeOffset)pushPyScope(state);else if(lineOffset<scopeOffset&&dedent(stream,state))state.errorToken=true;return null;}else{var style=tokenBaseInner(stream,state);if(scopeOffset>0&&dedent(stream,state))style+=" "+ERRORCLASS;return style;}}
return tokenBaseInner(stream,state);}
function tokenBaseInner(stream,state){if(stream.eatSpace())return null;var ch=stream.peek();if(ch=="#"){stream.skipToEnd();return"comment";}
if(stream.match(/^[0-9\.]/,false)){var floatLiteral=false;if(stream.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)){floatLiteral=true;}
if(stream.match(/^\d+\.\d*/)){floatLiteral=true;}
if(stream.match(/^\.\d+/)){floatLiteral=true;}
if(floatLiteral){stream.eat(/J/i);return"number";}
var intLiteral=false;if(stream.match(/^0x[0-9a-f]+/i))intLiteral=true;if(stream.match(/^0b[01]+/i))intLiteral=true;if(stream.match(/^0o[0-7]+/i))intLiteral=true;if(stream.match(/^[1-9]\d*(e[\+\-]?\d+)?/)){stream.eat(/J/i);intLiteral=true;}
if(stream.match(/^0(?![\dx])/i))intLiteral=true;if(intLiteral){stream.eat(/L/i);return"number";}}
if(stream.match(stringPrefixes)){state.tokenize=tokenStringFactory(stream.current());return state.tokenize(stream,state);}
if(stream.match(tripleDelimiters)||stream.match(doubleDelimiters))return"punctuation";if(stream.match(doubleOperators)||stream.match(singleOperators))return"operator";if(stream.match(singleDelimiters))return"punctuation";if(state.lastToken=="."&&stream.match(identifiers))return"property";if(stream.match(keywords)||stream.match(wordOperators))return"keyword";if(stream.match(builtins))return"builtin";if(stream.match(/^(self|cls)\b/))return"variable-2";if(stream.match(identifiers)){if(state.lastToken=="def"||state.lastToken=="class")return"def";return"variable";}
stream.next();return ERRORCLASS;}
function tokenStringFactory(delimiter){while("rub".indexOf(delimiter.charAt(0).toLowerCase())>=0){delimiter=delimiter.substr(1);}var singleline=delimiter.length==1;var OUTCLASS="string";function tokenString(stream,state){while(!stream.eol()){stream.eatWhile(/[^'"\\]/);if(stream.eat("\\")){stream.next();if(singleline&&stream.eol())return OUTCLASS;}else if(stream.match(delimiter)){state.tokenize=tokenBase;return OUTCLASS;}else{stream.eat(/['"]/);}}
if(singleline){if(parserConf.singleLineStringErrors)return ERRORCLASS;else state.tokenize=tokenBase;}
return OUTCLASS;}
tokenString.isString=true;return tokenString;}
function pushPyScope(state){while(top(state).type!="py"){state.scopes.pop();}state.scopes.push({offset:top(state).offset+conf.indentUnit,type:"py",align:null});}
function pushBracketScope(stream,state,type){var align=stream.match(/^([\s\[\{\(]|#.*)*$/,false)?null:stream.column()+1;state.scopes.push({offset:state.indent+hangingIndent,type:type,align:align});}
function dedent(stream,state){var indented=stream.indentation();while(top(state).offset>indented){if(top(state).type!="py")return true;state.scopes.pop();}
return top(state).offset!=indented;}
function tokenLexer(stream,state){var style=state.tokenize(stream,state);var current=stream.current();if(current=="@"){if(parserConf.version&&parseInt(parserConf.version,10)==3)return stream.match(identifiers,false)?"meta":"operator";else return stream.match(identifiers,false)?"meta":ERRORCLASS;}
if((style=="variable"||style=="builtin")&&state.lastToken=="meta")style="meta";if(current=="pass"||current=="return")state.dedent+=1;if(current=="lambda")state.lambda=true;if(current==":"&&!state.lambda&&top(state).type=="py")pushPyScope(state);var delimiter_index=current.length==1?"[({".indexOf(current):-1;if(delimiter_index!=-1)pushBracketScope(stream,state,"])}".slice(delimiter_index,delimiter_index+1));delimiter_index="])}".indexOf(current);if(delimiter_index!=-1){if(top(state).type==current)state.indent=state.scopes.pop().offset-hangingIndent;else return ERRORCLASS;}
if(state.dedent>0&&stream.eol()&&top(state).type=="py"){if(state.scopes.length>1)state.scopes.pop();state.dedent-=1;}
return style;}
var external={startState:function startState(basecolumn){return{tokenize:tokenBase,scopes:[{offset:basecolumn||0,type:"py",align:null}],indent:basecolumn||0,lastToken:null,lambda:false,dedent:0};},token:function token(stream,state){var addErr=state.errorToken;if(addErr)state.errorToken=false;var style=tokenLexer(stream,state);if(style&&style!="comment")state.lastToken=style=="keyword"||style=="punctuation"?stream.current():style;if(style=="punctuation")style=null;if(stream.eol()&&state.lambda)state.lambda=false;return addErr?style+" "+ERRORCLASS:style;},indent:function indent(state,textAfter){if(state.tokenize!=tokenBase)return state.tokenize.isString?CodeMirror.Pass:0;var scope=top(state),closing=scope.type==textAfter.charAt(0);if(scope.align!=null)return scope.align-(closing?1:0);else return scope.offset-(closing?hangingIndent:0);},electricInput:/^\s*[\}\]\)]$/,closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"};return external;});CodeMirror.defineMIME("text/x-python","python");var words=function words(str){return str.split(" ");};CodeMirror.defineMIME("text/x-cython",{name:"python",extra_keywords:words("by cdef cimport cpdef ctypedef enum except"+"extern gil include nogil property public"+"readonly struct union DEF IF ELIF ELSE")});});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('beop.strategy.components.VariablePanel'),namespace('React'),namespace('ReactCodeMirror'));}})(namespace('beop.strategy.components.ModuleConfigPanel'),function(exports,constants,VariablePanel,React,ReactCodeMirror){var h=React.h;var actions={dispatch:null};var codeMirrorOptions={lineNumbers:true,theme:'monokai',extraKeys:{Tab:function Tab(cm){if(cm.getSelection().length){CodeMirror.commands.indentMore(cm);}else{cm.replaceSelection("  ");}}},mode:'python'};var theme={codeMirror:function codeMirror(code){return h('div#codeMirrorBox',{style:{minHeight:'100%',background:'#2b3034',overflow:'auto',position:'absolute',left:0,top:0,right:'300px'}},[h(ReactCodeMirror,{onChange:this.handleCodeChange,value:code,options:codeMirrorOptions,style:{height:'100%'},className:'gray-scrollbar'})]);},variablePanel:function variablePanel(module,moduleOutputs){return h(VariablePanel,{input:module.option.input,output:module.option.output,moduleId:module._id,moduleOutputs:moduleOutputs,handleUpdate:this.props.handleUpdate});}};var Python=function(_React$Component){_inherits(Python,_React$Component);function Python(props,context){_classCallCheck(this,Python);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props,context));actions.dispatch=actions.dispatch||context.dispatch;_this.state={code:props.module.option.content&&props.module.option.content.code||''};_this.handleCodeChange=_this.handleCodeChange.bind(_this);return _this;}
Python.prototype.handleCodeChange=function handleCodeChange(code){this.setState({code:code});this.props.handleUpdate({code:code});};Python.prototype.render=function render(){return h('div',{style:{'margin-top':'2px'}},[theme.codeMirror.call(this,this.state.code),h('#variablePanel',[theme.variablePanel.call(this,this.props.module,this.props.moduleOutputs)])]);};return Python;}(React.Component);exports.Python=Python;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('beop.strategy.components.ModuleConfigPanel.Python'),namespace('React'));}})(namespace('beop.strategy.components.ModuleConfigPanel'),function(exports,constants,Python,React){var h=React.h;var linkEvent=React.linkEvent;var deepClone=$.extend.bind($,true);var actions={dispatch:null,clickQuit:function clickQuit(){actions.dispatch({type:constants.painter.CLOSR_CONFIG_PANEL,value:null});},clickSaveQuit:function clickSaveQuit(module){actions.dispatch({type:constants.painter.CONFIG_PANEL_SAVE_AND_CLOSE,module:module});actions.clickQuit();}};var theme={toolbar:function toolbar(title){return h('.toolBar',{style:{height:'50px',position:'relative',lineHeight:'50px',background:'#34393c',color:'#cadee5'}},[h('.title',{style:{width:'300px',float:'left',fontSize:'20px',marginLeft:'15px'}},title),h('.btns',{style:{position:'absolute',right:'15px'}},[h('button.btn.btn-default',{style:{marginLeft:'15px',color:'#cadee5',outline:'none',borderRadius:'17px',borderColor:'#4b5252'},onClick:linkEvent(this.state.module,actions.clickSaveQuit)},'确定'),h('button.btn.btn-default',{style:{marginLeft:'15px',color:'#cadee5',outline:'none',borderRadius:'17px',borderColor:'#4b5252'},onClick:actions.clickQuit},'取消')])]);},createChild:function createChild(module,moduleOutputs){switch(module.type){case 0:default:return h(Python,{module:module,moduleOutputs:moduleOutputs,handleUpdate:this.handleUpdate});}}};var ModuleConfigPanel=function(_React$Component){_inherits(ModuleConfigPanel,_React$Component);function ModuleConfigPanel(props,context){_classCallCheck(this,ModuleConfigPanel);var _this=_possibleConstructorReturn(this,_React$Component.call(this,props,context));actions.dispatch=actions.dispatch||context.dispatch;_this.state={module:deepClone({},_this.props.configModule),moduleOutputs:deepClone([],_this.props.moduleOutputs)};_this.handleUpdate=_this.handleUpdate.bind(_this);return _this;}
ModuleConfigPanel.prototype.handleUpdate=function handleUpdate(data){var module=deepClone({},this.state.module);if(data.code){module.option.content={code:data.code};}
if(data.input){module.option.input=data.input;}
if(data.output){module.option.output=data.output;}
this.setState({module:module});};ModuleConfigPanel.prototype.componentWillUpdate=function componentWillUpdate(){return false;};ModuleConfigPanel.prototype.render=function render(){var title=function(type){switch(type){case 0:return'Python ';default:return'';}}(this.state.module.type)+'模块编辑';return h('div',{'className':'pyVariable',style:{height:'100%',background:'#2b3034'}},[theme.toolbar.call(this,title),h('#configPanelContent',[theme.createChild.call(this,this.state.module,this.state.moduleOutputs)])]);};return ModuleConfigPanel;}(React.Component);exports.Index=ModuleConfigPanel;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('React'),namespace('beop.strategy.components.Painter.BatchConfigModal'));}})(namespace('beop.strategy.components.Painter'),function(exports,constants,React,BatchConfigModal){var h=React.h;var linkEvent=React.linkEvent;var actions={dispatch:null,dragstart:function dragstart(e){var $this=$(e.target);var offset=$this.offset();var type=$this.data('type');var info={x:e.clientX-offset.left,y:e.clientY-offset.top,w:$this.width(),h:$this.height(),type:type};e.dataTransfer.setData("info",JSON.stringify(info));}};var theme={createBtn:function createBtn(type,icon,name){return h('button.btn.btn-default',{'data-type':type,draggable:'true',onDragStart:actions.dragstart},[h('span',{className:'iconfont '+icon}),h('span.btnText',{style:{display:'block'}},[name])]);},createLi:function createLi(type,icon,name){return h('li',{role:"presentation"},[h('a',{role:"menuitem",tabindex:"-1",'data-type':type,draggable:'true',onDragStart:actions.dragstart},[h('span',{className:'iconfont '+icon}),name])]);},Select:function Select(type,children){return h('div.dropdown',[h('button#dLabel',{className:"btn btn-default fl",type:"button",'data-toggle':"dropdown",'aria-haspopup':'true','aria-expanded':"false"},[type,h('span.caret')]),h('ul',{className:'dropdown-menu',role:"menu",'aria-labelledby':"dLabel"},children)]);}};function Toolbar(props,context){actions.dispatch=context.dispatch;return h('#toolBarWrap',{style:{width:'100%',height:'74px',zIndex:11}},[h('div.btnGroup',{},[h('div.basicBtnGroup.fl',{},[theme.createBtn('py','icon-daima','Python'),theme.createBtn('API','icon-API offset','远程API'),theme.createBtn('KPI','icon-KPI offset','KPI'),theme.createBtn('rule','icon-guize offset','规则'),theme.Select('基本',[theme.createLi('py','icon-daima','Python'),theme.createLi('API','icon-API offset','远程API'),theme.createLi('KPI','icon-KPI offset','KPI'),theme.createLi('rule','icon-guize offset','规则')])]),h('div.algorithmBtnGroup.fl',{},[theme.createBtn('diagnose','icon-zhenduan1 offset','诊断'),theme.createBtn('Fa','icon-fuliyefenxi offset','傅里叶分析'),theme.createBtn('Wa','icon-xiaobofenxi','小波分析'),theme.createBtn('Fc','icon-nihequxian ','拟合曲线'),theme.createBtn('return','icon-huigui offset','回归'),theme.createBtn('forecast','icon-yuce offset','预测'),theme.createBtn('fr','icon-mohuguize','模糊规则'),theme.Select('计算',[theme.createLi('diagnose','icon-zhenduan1 offset','诊断'),theme.createLi('Fa','icon-fuliyefenxi offset','傅里叶分析'),theme.createLi('Wa','icon-xiaobofenxi','小波分析'),theme.createLi('Fc','icon-nihequxian ','拟合曲线'),theme.createLi('return','icon-huigui offset','回归'),theme.createLi('forecast','icon-yuce offset','预测'),theme.createLi('fr','icon-mohuguize','模糊规则')])]),h('div.showBtnGroup.fl',{},[theme.createBtn('Hc','icon-lishiquxian','历史曲线'),theme.Select('展示',[theme.createLi('Hc','icon-lishiquxian','历史曲线')])])])]);}
exports.Toolbar=Toolbar;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','Konva'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('Konva'));}else{factory(root,namespace('Konva'));}})(namespace('beop.strategy.components.Painter.Sketchpad.Graphics'),function(exports,Konva){function GShape(config){this.___init(config);};Konva.Util.addMethods(GShape,{___init:function ___init(config){Konva.Group.prototype.___init.call(this,config);this.__createShapes();},__createShapes:function __createShapes(){this.__wrapEvents();},__wrapEvents:function __wrapEvents(){}});Konva.Util.extend(GShape,Konva.Group);exports.GShape=GShape;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','Konva','./gShape.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('Konva'),require('./gShape.js'));}else{factory(root,namespace('Konva'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GShape'));}})(namespace('beop.strategy.components.Painter.Sketchpad.Graphics'),function(exports,Konva,GShape){function GArrow(config){this.___init(config);};Konva.Util.addMethods(GArrow,{___init:function ___init(config){Konva.Group.prototype.___init.call(this,config);this.__createShapes();},__createShapes:function __createShapes(){var _this2=this;var attrs=this.attrs;attrs.store.lines.forEach(function(line){var l=new Konva.Line({id:line.id,name:'line '+line.id.split('_')[0],points:line.points,stroke:'#6f7777',strokeWidth:1,lineCap:'round',lineJoin:'round'});_this2.add(l);});this.__wrapEvents();},__wrapEvents:function __wrapEvents(){var _this=this;var attrs=this.attrs;this.on('update',function(e){e.date.lines.forEach(function(line){var target=_this.find('#'+line.id)[0];if(target){target.points(line.points);}else{_this.add(new Konva.Line({id:line.id,name:'line '+line.id.split('_')[0],points:line.points,stroke:'#6f7777',strokeWidth:1,lineCap:'round',lineJoin:'round'}));}});var lines=this.find('.line');if(lines.length>e.date.lines.length){var a=new Set(lines.map(function(line){return line.attrs.id;})),b=new Set(e.date.lines.map(function(line){return line.id;}));var deleteIds=[].concat(a).filter(function(x){return!b.has(x);});deleteIds.forEach(function(id){_this.find('#'+id).destroy();});}});}});Konva.Util.extend(GArrow,GShape);exports.GArrow=GArrow;});;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('React'),namespace('ReactKonva'));}})(namespace('beop.strategy.components.Painter'),function(exports,React,ReactKonva){var h=React.h;var theme={createLines:function createLines(attrs){var result=[];attrs.store.lines.forEach(function(line){result.push(h(ReactKonva.Line,{id:line.id,name:'line '+line.id.split('_')[0],points:line.points,stroke:attrs.isSelected?'#f6a405':'#6f7777',strokeWidth:1,lineCap:'round',lineJoin:'round'}));});return result;}};var GArrowGroup=function(_React$Component){_inherits(GArrowGroup,_React$Component);function GArrowGroup(props){_classCallCheck(this,GArrowGroup);var _this3=_possibleConstructorReturn(this,_React$Component.call(this,props));_this3.createEvents();return _this3;}
GArrowGroup.prototype.createEvents=function createEvents(){var _this=this;this.props.onUpdate=function(e){var _this4=this;e.date.lines.forEach(function(line){var target=_this4.find('#'+line.id)[0];if(target){target.points(line.points);}else{_this4.add(new Konva.Line({id:line.id,name:'line '+line.id.split('_')[0],points:line.points,stroke:'#6f7777',strokeWidth:1,lineCap:'round',lineJoin:'round'}));}});var lines=this.find('.line');if(lines.length>e.date.lines.length){var a=new Set(lines.map(function(line){return line.attrs.id;})),b=new Set(e.date.lines.map(function(line){return line.id;}));var deleteIds=[].concat(a).filter(function(x){return!b.has(x);});deleteIds.forEach(function(id){_this4.find('#'+id).destroy();});}
this.parent.draw();};};GArrowGroup.prototype.render=function render(){var attrs=this.props;return h(ReactKonva.Group,this.props,theme.createLines(attrs));};return GArrowGroup;}(React.Component);exports.GArrowGroup=GArrowGroup;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','Konva','./gShape.js','./gArrow.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('Konva'),require('./gShape.js'),require('./gArrow.js'));}else{factory(root,namespace('Konva'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GShape'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GArrow'));}})(namespace('beop.strategy.components.Painter.Sketchpad.Graphics'),function(exports,Konva,GShape,GArrow){function GStrategyShape(config){this.___init(config);};var PADDING=5,STROKE_WIDTH=1,OPTION_BTN_SIZE=15,OPTION_BTN_MARGGING=5,SIZE_BTN_SIZE=20,FONTSIZE=16,SMALLFONTSIZE=12;Konva.Util.addMethods(GStrategyShape,{___init:function ___init(config){Konva.Group.prototype.___init.call(this,config);this.__createShapes();},__createShapes:function __createShapes(){var attrs=this.attrs;var background,nameText,typeText,btnClose,btnConfig,resizer;var image=document.querySelector('#imgIcon'),image2=document.querySelector('#imgIcon2');var type=undefined;switch(Number(attrs.store.type)){case 0:type='Python';break;case 1:type='引用自模板';break;case 2:type="REST服务";break;case 3:type="LaTex";break;case 4:type="固有控件";break;case 101:type='API';break;case 102:type="KPI";break;case 103:type="诊断";break;case 104:type="模糊规则";break;case 5:type="回归";break;case 6:type="预测";break;case 7:type="傅里叶分析";break;case 8:type="小波分析";break;case 9:type="拟合曲线";break;case 10:type="历史曲线";break;case 11:type="规则";break;}
this.add(background=new Konva.Rect({x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:attrs.width/20,fill:'#697174',strokeHitEnabled:false,transformsEnabled:'position',shadowColor:'#f6a405',shadowBlur:10,shadowEnabled:false}));this.add(nameText=new Konva.Text({x:0,y:(attrs.height-FONTSIZE)/2,name:'nameText',text:function(attrs){var txt=attrs.store.name;var maxNum=attrs.width/FONTSIZE;if(txt.length>maxNum){return txt.slice(0,maxNum)+'...';}
return txt;}(attrs),fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:'#cee2ec',width:attrs.width,height:FONTSIZE,align:'center'}));this.add(type=new Konva.Text({x:0,y:0,name:'typeText',text:type,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height}));this.add(btnClose=new Konva.Image({x:attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2,y:PADDING,name:'close',width:OPTION_BTN_SIZE,height:OPTION_BTN_SIZE,image:image,crop:{x:16.5,y:0,width:16,height:16},strokeHitEnabled:false,transformsEnabled:'position'}));this.add(btnConfig=new Konva.Image({x:btnClose.x()-PADDING-OPTION_BTN_SIZE,y:PADDING,name:'config',width:OPTION_BTN_SIZE,height:OPTION_BTN_SIZE,image:image,crop:{x:0,y:0,width:16.5,height:16},strokeHitEnabled:false,transformsEnabled:'position'}));this.add(resizer=new Konva.Image({x:attrs.width-STROKE_WIDTH/2-SIZE_BTN_SIZE/2,y:attrs.height-STROKE_WIDTH/2-SIZE_BTN_SIZE/2,name:'size',width:SIZE_BTN_SIZE,height:SIZE_BTN_SIZE,image:image,crop:{x:32.5,y:0,width:16,height:16},draggable:true,strokeHitEnabled:false,transformsEnabled:'position'}));this.customMember={background:background,nameText:nameText,typeText:typeText,btnClose:btnClose,btnConfig:btnConfig,resizer:resizer,image:image,image2:image2};this.__wrapEvents();},__wrapEvents:function __wrapEvents(){var _this=this;var attrs=this.attrs,MINWIDTH=155,MINHEIGHT=72;var children=this.getChildren(),parent=undefined;var btnClose=this.find('.close')[0],btnConfig=this.find('.config')[0],btnSizes=this.find('.size')[0],dragLayer=this.find('.dragLayer')[0],nameText=this.find('.nameText')[0],typeText=this.find('.typeText')[0];var rexizeX=btnSizes.x(),rexizeY=btnSizes.y();var mouseDownTime,oldIndex;var clearLines=function clearLines(){parent.find('.GArrow').visible(false);parent.draw();},createLines=function createLines(){if(attrs.block==undefined||parent==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){parent.find('#line_'+lines.id)[0].fire('update',{date:lines});});parent.find('.GArrow').visible(true);parent.draw();};dragLayer.on('mousedown',function(e){mouseDownTime=+new Date();});dragLayer.on('mouseup',function(e){if(+new Date()-mouseDownTime>200){return;}
_this._fire('select',{evt:e.evt});});nameText.on('mousedown',function(e){mouseDownTime=+new Date();});nameText.on('mouseup',function(e){if(+new Date()-mouseDownTime>200){return;}
_this._fire('select');});btnClose.on('mousedown',function(e){mouseDownTime=+new Date();});btnClose.on('mouseup',function(e){if(+new Date()-mouseDownTime>200){return;}
parent.find('#line_'+attrs.id).destroy();parent.find('.input_'+attrs.id).destroy();parent.find('.output_'+attrs.id).destroy();attrs.block.remove();_this.destroy();_this._fire('close');createLines();});btnConfig.on('mousedown',function(e){mouseDownTime=+new Date();});btnConfig.on('mouseup',function(e){if(+new Date()-mouseDownTime>200){return;}
_this._fire('config');});btnSizes.on('mousedown',function(e){e.evt.stopPropagation();});btnSizes.on('dragstart',function(e){children.forEach(function(v){if(!(v.name()=='dragLayer'||v.name()=='size')){v.visible(false);}});clearLines();});btnSizes.on('dragmove',function(e){var dx=Math.max(this.x()-rexizeX,MINWIDTH-attrs.width),dy=Math.max(this.y()-rexizeY,MINHEIGHT-attrs.height);this.x(rexizeX+dx);this.y(rexizeY+dy);dragLayer.width(attrs.width+dx);dragLayer.height(attrs.height+dy);parent.draw();});btnSizes.on('dragend',function(e){var dx=this.x()-rexizeX,dy=this.y()-rexizeY;attrs.width=dragLayer.width();attrs.height=dragLayer.height();rexizeX=attrs.width+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;rexizeY=attrs.height+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;btnClose.x(attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2);btnConfig.x(btnClose.x()-PADDING-OPTION_BTN_SIZE);nameText.width(attrs.width);nameText.y((attrs.height-FONTSIZE)/2);nameText.text(function(attrs){var txt=attrs.store.name;var maxNum=attrs.width/FONTSIZE;if(txt.length>maxNum){return txt.slice(0,maxNum)+'...';}
return txt;}(attrs));typeText.width(attrs.width);typeText.offsetY(-attrs.height);children.forEach(function(v){v.visible(true);});attrs.store.loc.x=attrs.x;attrs.store.loc.y=attrs.y;attrs.store.loc.w=attrs.width;attrs.store.loc.h=attrs.height;parent.draw();});var startLoc,startPos;this.on('dragstart',function(e){clearLines();startLoc={x:this.attrs.x,y:this.attrs.y,w:this.attrs.width,h:this.attrs.height};startPos=this.getAbsolutePosition();if(e.target.nodeType=='Group'){this.off('dragmove').on('dragmove',function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}});}});this.on('dragend',function(e){var sketchpad=this.attrs.block.sketchpad,PADDING=sketchpad.PADDING+1;var obstacle=sketchpad.tools.intersectionByRect(sketchpad.tools.rectToPoints(this.attrs.x-PADDING,this.attrs.y-PADDING,this.attrs.width+2*PADDING,this.attrs.height+2*PADDING),sketchpad.obstacle);if(obstacle.length==0||obstacle.length==1&&obstacle[0].id==attrs.id){this.attrs.store.loc.x=this.attrs.x;this.attrs.store.loc.y=this.attrs.y;}else{this.x(startLoc.x);this.y(startLoc.y);this.width(startLoc.w);this.height(startLoc.h);rexizeX=attrs.width+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;rexizeY=attrs.height+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;btnSizes.x(attrs.width-STROKE_WIDTH/2-SIZE_BTN_SIZE/2);btnSizes.y(attrs.height-STROKE_WIDTH/2-SIZE_BTN_SIZE/2);dragLayer.width(attrs.width);dragLayer.height(attrs.height);btnClose.x(attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2);btnConfig.x(btnClose.x()-PADDING-OPTION_BTN_SIZE);nameText.width(attrs.width);nameText.y((attrs.height-FONTSIZE)/2);nameText.text(function(attrs){var txt=attrs.store.name;var maxNum=attrs.width/FONTSIZE;if(txt.length>maxNum){return txt.slice(0,maxNum)+'...';}
return txt;}(attrs));typeText.width(attrs.width);typeText.offsetY(-attrs.height);attrs.store.loc.x=attrs.x;attrs.store.loc.y=attrs.y;attrs.store.loc.w=attrs.width;attrs.store.loc.h=attrs.height;}
this.dragBoundFunc(undefined);this.parent&&this.parent.draw();createLines();});this.on('mouseover',function(e){if(e.target.attrs.name=='typeText'){document.getElementById('sketchpadWrapWrap').style.cursor='default';}else if(e.target.attrs.name=='size'){document.getElementById('sketchpadWrapWrap').style.cursor='se-resize';}else{document.getElementById('sketchpadWrapWrap').style.cursor='pointer';}});this.on('mouseout',function(){document.getElementById('sketchpadWrapWrap').style.cursor='default';});this.on('mouseenter',function(){parent=_this.parent;this.customMember.background.shadowEnabled(true);oldIndex=this.getZIndex();this.moveToTop();parent.draw();});this.on('mouseleave',function(){this.customMember.background.shadowEnabled(false);this.setZIndex(oldIndex);parent.draw();});}});Konva.Util.extend(GStrategyShape,GShape);exports.GStrategyShape=GStrategyShape;});;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('React'),namespace('ReactKonva'));}})(namespace('beop.strategy.components.Painter'),function(exports,React,ReactKonva){var h=React.h;var PADDING=5,STROKE_WIDTH=1,OPTION_BTN_SIZE=15,OPTION_BTN_MARGGING=5,SIZE_BTN_SIZE=20,FONTSIZE=16,SMALLFONTSIZE=12;var image=document.querySelector('#imgIcon'),image2=document.querySelector('#imgIcon2');var GShapeGroup=function(_React$Component){_inherits(GShapeGroup,_React$Component);function GShapeGroup(props){_classCallCheck(this,GShapeGroup);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props));_this2.rexizeX=undefined;_this2.rexizeY=undefined;return _this2;}
GShapeGroup.prototype.createEvents=function createEvents(){var _this=this;var oldIndex,mouseDownTime,mouseDownPos;var MINWIDTH=155,MINHEIGHT=72;var startLoc,startPos;var customMember={};var getCustomMember=function getCustomMember(name,layer){var rs;if(customMember[name]!=undefined){rs=customMember[name];}else{rs=customMember[name]=layer.find('.'+name)[0];}
return rs;};var clearLines=function clearLines(layer){layer.find('.GArrow').visible(false);layer.draw();},createLines=function createLines(attrs,layer){if(attrs.block==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){var line=layer.find('#line_'+lines.id)[0];line&&line.fire('update',{date:lines});});layer.find('.GArrow').visible(true);layer.draw();};this.props.onDragStart=function(e){var attrs=this.attrs;clearLines(this.parent);startLoc={x:attrs.x,y:attrs.y,w:attrs.width,h:attrs.height};startPos=this.getAbsolutePosition();if(e.target.nodeType=='Group'){this.off('dragmove').on('dragmove',function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}});}};this.props.onDragEnd=function(e){var attrs=this.attrs;var x,y,w,h;var sketchpad=attrs.block.sketchpad,PADDING=sketchpad.PADDING+1;var obstacle=sketchpad.tools.intersectionByRect(sketchpad.tools.rectToPoints(attrs.x-PADDING,attrs.y-PADDING,attrs.width+2*PADDING,attrs.height+2*PADDING),sketchpad.obstacle);if(obstacle.length==0||obstacle.length==1&&obstacle[0].id==attrs.id){x=attrs.x;y=attrs.y;w=attrs.width;h=attrs.height;}else{x=startLoc.x;y=startLoc.y;w=startLoc.w;h=startLoc.h;_this.rexizeX=startLoc.w+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;_this.rexizeY=startLoc.h+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;}
this.dragBoundFunc(undefined);this.parent&&this.parent.draw();_this.props.customEvent.dragend(attrs.id,{x:x,y:y,w:w,h:h});createLines(attrs,this.parent);};this.props.onMouseOver=function(e){if(e.target.attrs.name=='typeText'){document.getElementById('sketchpadWrap').style.cursor='default';}else if(e.target.attrs.name=='size'){document.getElementById('sketchpadWrap').style.cursor='se-resize';}else{document.getElementById('sketchpadWrap').style.cursor='pointer';}};this.props.onMouseOut=function(e){document.getElementById('sketchpadWrap').style.cursor='default';};this.props.onMouseEnter=function(e){getCustomMember('dragLayer',this).shadowEnabled(true);oldIndex=this.getZIndex();this.moveToTop();this.parent.draw();};this.props.onMouseLeave=function(e){getCustomMember('dragLayer',this).shadowEnabled(false);this.setZIndex(oldIndex);this.parent.draw();};return{resizeDragStart:function resizeDragStart(){this.parent.children.forEach(function(v){if(!(v.name()=='dragLayer'||v.name()=='size')){v.visible(false);}});clearLines(this.parent.parent);},resizeDragMove:function resizeDragMove(){var attrs=this.parent.attrs;var dragLayer=getCustomMember('dragLayer',this.parent);var dx=Math.max(this.x()-_this.rexizeX,MINWIDTH-attrs.width),dy=Math.max(this.y()-_this.rexizeY,MINHEIGHT-attrs.height);this.x(_this.rexizeX+dx);this.y(_this.rexizeY+dy);dragLayer.width(attrs.width+dx);dragLayer.height(attrs.height+dy);this.parent.parent.draw();},resizeDragEnd:function resizeDragEnd(){var attrs=this.parent.attrs;var dx=this.x()-_this.rexizeX,dy=this.y()-_this.rexizeY;var dragLayer=getCustomMember('dragLayer',this.parent);attrs.width=dragLayer.width();attrs.height=dragLayer.height();_this.rexizeX=attrs.width+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;_this.rexizeY=attrs.height+STROKE_WIDTH/2-SIZE_BTN_SIZE/2;var btnCloseX=attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2;var nameText=getCustomMember('nameText',this.parent),typeText=getCustomMember('typeText',this.parent);getCustomMember('close',this.parent).x(btnCloseX);getCustomMember('config',this.parent).x(btnCloseX-PADDING-OPTION_BTN_SIZE);nameText.width(attrs.width);nameText.y((attrs.height-FONTSIZE)/2);nameText.text(function(attrs){var txt=attrs.store.name;var maxNum=attrs.width/FONTSIZE;if(txt.length>maxNum){return txt.slice(0,maxNum)+'...';}
return txt;}(attrs));typeText.width(attrs.width);typeText.offsetY(-attrs.height);this.parent.children.forEach(function(v){v.visible(true);});var x=attrs.store.loc.x=attrs.x;var y=attrs.store.loc.y=attrs.y;var w=attrs.store.loc.w=attrs.width;var h=attrs.store.loc.h=attrs.height;this.parent.parent.draw();},likeClick:function likeClick(e){mouseDownTime=+new Date();mouseDownPos={x:e.evt.clientX,y:e.evt.clientY};},dragLayerClick:function dragLayerClick(e){if(+new Date()-(mouseDownTime||0)>200||Math.abs(e.evt.clientX-mouseDownPos.x)>30||Math.abs(e.evt.clientY-mouseDownPos.y)>30){return;}
_this.props.customEvent.select(this.parent.attrs.id,this.parent.parent,image,image2);},closeClick:function closeClick(e){if(+new Date()-(mouseDownTime||0)>200||Math.abs(e.evt.clientX-mouseDownPos.x)>30||Math.abs(e.evt.clientY-mouseDownPos.y)>30){return;}
var attrs=this.parent.attrs,layer=this.parent.parent;attrs.block.remove();_this.props.customEvent.close(attrs.id);createLines(attrs,layer);},configClick:function configClick(e){if(+new Date()-(mouseDownTime||0)>200||Math.abs(e.evt.clientX-mouseDownPos.x)>30||Math.abs(e.evt.clientY-mouseDownPos.y)>30){return;}
_this.props.customEvent.config();}};};GShapeGroup.prototype.render=function render(){var attrs=this.props;this.rexizeX=attrs.width-STROKE_WIDTH/2-SIZE_BTN_SIZE/2;this.rexizeY=attrs.height-STROKE_WIDTH/2-SIZE_BTN_SIZE/2;var actions=this.createEvents();var type=undefined;switch(Number(attrs.store.type)){case 0:type='Python';break;case 1:type='引用自模板';break;case 2:type="REST服务";break;case 3:type="LaTex";break;case 4:type="固有控件";break;case 101:type='API';break;case 102:type="KPI";break;case 103:type="诊断";break;case 104:type="模糊规则";break;case 5:type="回归";break;case 6:type="预测";break;case 7:type="傅里叶分析";break;case 8:type="小波分析";break;case 9:type="拟合曲线";break;case 10:type="历史曲线";break;case 11:type="规则";break;}
var isSelected=this.props.isSelected;return h(ReactKonva.Group,this.props,[h(ReactKonva.Rect,{x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:8,fill:isSelected?'#f6a405':'#697174',strokeHitEnabled:false,transformsEnabled:'position',shadowColor:'#f6a405',shadowBlur:10,shadowEnabled:false,onMouseDown:actions.likeClick,onMouseUp:actions.dragLayerClick}),h(ReactKonva.Text,{x:0,y:(attrs.height-FONTSIZE)/2,name:'nameText',text:function(attrs){var txt=attrs.store.name;var maxNum=attrs.width/FONTSIZE;if(txt.length>maxNum){return txt.slice(0,maxNum)+'...';}
return txt;}(attrs),fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:isSelected?'#fff':'#cee2ec',width:attrs.width,height:FONTSIZE,align:'center',onMouseDown:actions.likeClick,onMouseUp:actions.dragLayerClick}),h(ReactKonva.Text,{x:0,y:0,name:'typeText',text:type,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height}),h(ReactKonva.Image,{x:attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2,y:PADDING,name:'close',width:OPTION_BTN_SIZE,height:OPTION_BTN_SIZE,image:isSelected?image2:image,crop:{x:16.5,y:0,width:16,height:16},strokeHitEnabled:false,transformsEnabled:'position',onMouseDown:actions.likeClick,onMouseUp:actions.closeClick}),h(ReactKonva.Image,{x:attrs.width-OPTION_BTN_SIZE-PADDING-STROKE_WIDTH/2-PADDING-OPTION_BTN_SIZE,y:PADDING,name:'config',width:OPTION_BTN_SIZE,height:OPTION_BTN_SIZE,image:isSelected?image2:image,crop:{x:0,y:0,width:16.5,height:16},strokeHitEnabled:false,transformsEnabled:'position',onMouseDown:actions.likeClick,onMouseUp:actions.configClick}),h(ReactKonva.Image,{x:attrs.width-STROKE_WIDTH/2-SIZE_BTN_SIZE/2,y:attrs.height-STROKE_WIDTH/2-SIZE_BTN_SIZE/2,name:'size',width:SIZE_BTN_SIZE,height:SIZE_BTN_SIZE,image:isSelected?image2:image,crop:{x:32.5,y:0,width:16,height:16},draggable:true,strokeHitEnabled:false,transformsEnabled:'position',onDragStart:actions.resizeDragStart,onDragMove:actions.resizeDragMove,onDragEnd:actions.resizeDragEnd})]);};return GShapeGroup;}(React.Component);exports.GShapeGroup=GShapeGroup;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','Konva','./gShape.js','./gArrow.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('Konva'),require('./gShape.js'),require('./gArrow.js'));}else{factory(root,namespace('Konva'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GShape'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GArrow'));}})(namespace('beop.strategy.components.Painter.Sketchpad.Graphics'),function(exports,Konva,GShape,GArrow){function GInputShape(config){this.___init(config);};var PADDING=5,STROKE_WIDTH=1,SIZE_BTN_SIZE=10,CORNERRADIUS=50,FONTSIZE=14,SMALLFONTSIZE=12;Konva.Util.addMethods(GInputShape,{___init:function ___init(config){Konva.Group.prototype.___init.call(this,config);this.__createShapes();},__createShapes:function __createShapes(){var attrs=this.attrs;var showType=undefined;switch(Number(attrs.store.type)){case 0:showType='数据源';break;case 1:showType='短信';break;case 2:showType='邮件';break;case 10:showType='数值';break;case 11:showType='字符串';break;case 12:showType='时间';break;case 13:showType='JSON';break;case 100:showType='引用';break;};this.add(new Konva.Rect({x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:attrs.width/5,fill:'#697174'}));this.add(new Konva.Text({x:0,y:(attrs.height-FONTSIZE)/2,name:'nameText',text:attrs.store.name,fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:'#9fb0b8',width:attrs.width,height:FONTSIZE,align:'center'}));this.add(new Konva.Text({x:0,y:0,name:'typeText',text:showType,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height}));this.__wrapEvents();},__wrapEvents:function __wrapEvents(){var attrs=this.attrs,MINWIDTH=132,MINHEIGHT=50;var _this=this;var children=this.getChildren();var dragLayer=this.find('.dragLayer')[0],nameText=this.find('.nameText')[0];var oldIndex,startPos;var clearLines=function clearLines(){_this.parent.find('.GArrow').visible(false);_this.parent.draw();},createLines=function createLines(){if(attrs.block==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){_this.parent.find('#line_'+lines.id)[0].fire('update',{date:lines});});_this.parent.find('.GArrow').visible(true);_this.parent.draw();};this.on('dragstart',function(e){clearLines();startPos=this.getAbsolutePosition();});this.on('dragmove',function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}});this.on('dragend',function(e){this.attrs.store.loc.x=this.attrs.x;this.attrs.store.loc.y=this.attrs.y;this.dragBoundFunc(undefined);createLines();});this.on('changeToOutput',function(e){attrs.block.remove();this.destroy();_this._fire('toOutput',{data:e.data});});this.on('mouseenter',function(){oldIndex=this.getZIndex();this.moveToTop();this.parent.draw();});this.on('mouseleave',function(){this.setZIndex(oldIndex);this.parent.draw();});this.on('updateText',function(e){var showName;if(e.data!=undefined){showName=e.data;attrs.nameMap[attrs.store.name]=showName;}else{showName=attrs.store.name;}
nameText.text(function(showName){showName+='';var maxNum=nameText.width()/10;if(showName.length>maxNum){return showName.slice(0,maxNum)+'...';}
return showName;}(showName));this.parent&&_this.parent.draw();});}});Konva.Util.extend(GInputShape,GShape);exports.GInputShape=GInputShape;});;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('React'),namespace('ReactKonva'));}})(namespace('beop.strategy.components.Painter'),function(exports,React,ReactKonva){var h=React.h;var PADDING=5,STROKE_WIDTH=1,SIZE_BTN_SIZE=10,CORNERRADIUS=50,FONTSIZE=14,SMALLFONTSIZE=12;var GInputGroup=function(_React$Component){_inherits(GInputGroup,_React$Component);function GInputGroup(props){_classCallCheck(this,GInputGroup);return _possibleConstructorReturn(this,_React$Component.call(this,props));}
GInputGroup.prototype.createEvents=function createEvents(){var _this=this;var oldIndex,startPos;var clearLines=function clearLines(layer){layer.find('.GArrow').visible(false);layer.draw();},createLines=function createLines(attrs,layer){if(attrs.block==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){var line=layer.find('#line_'+lines.id)[0];line&&line.fire('update',{date:lines});});layer.find('.GArrow').visible(true);layer.draw();};this.props.onDragStart=function(){clearLines(this.parent);startPos=this.getAbsolutePosition();};this.props.onDragMove=function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}};this.props.onDragEnd=function(){this.attrs.customEvent.dragend(this.attrs.id.split('_')[1],{x:this.attrs.x,y:this.attrs.y,w:this.attrs.width,h:this.attrs.height},this.attrs.store.name,'input');this.dragBoundFunc(undefined);createLines(this.attrs,this.parent);};this.props.onMouseEnter=function(){oldIndex=this.getZIndex();this.moveToTop();this.parent.draw();};this.props.onMouseLeave=function(){this.setZIndex(oldIndex);this.parent.draw();};this.props.onChangeToOutput=function(e){attrs.block.remove();this.destroy();this.parent.draw();this.props.toOutput({data:e.data});};};GInputGroup.prototype.render=function render(){var attrs=this.props;this.createEvents();var showType=undefined;switch(Number(attrs.store.type)){case 0:showType='数据源';break;case 1:showType='短信';break;case 2:showType='邮件';break;case 10:showType='数值';break;case 11:showType='字符串';break;case 12:showType='时间';break;case 13:showType='JSON';break;case 100:showType='引用';break;};var showName=attrs.showName&&attrs.showName.split('|')[1]||attrs.store.name;showName+='';var fontNum=(attrs.width-20)/10;var vNum=Math.ceil(showName.length/fontNum);var textHeight=Math.min(FONTSIZE*vNum,attrs.height);return h(ReactKonva.Group,this.props,[h(ReactKonva.Rect,{x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:attrs.width/5,fill:'#697174'}),h(ReactKonva.Text,{x:10,y:(attrs.height-textHeight)/2,name:'nameText',text:showName,fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:'#9fb0b8',width:attrs.width-20,height:textHeight,align:'center'}),h(ReactKonva.Text,{x:0,y:0,name:'typeText',text:showType,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height})]);};return GInputGroup;}(React.Component);exports.GInputGroup=GInputGroup;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','Konva','./gShape.js','./gArrow.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('Konva'),require('./gShape.js'),require('./gArrow.js'));}else{factory(root,namespace('Konva'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GShape'),namespace('beop.strategy.components.Painter.Sketchpad.Graphics.GArrow'));}})(namespace('beop.strategy.components.Painter.Sketchpad.Graphics'),function(exports,Konva,GShape,GArrow){function GOutputShape(config){this.___init(config);};var PADDING=5,STROKE_WIDTH=1,SIZE_BTN_SIZE=10,CORNERRADIUS=50,FONTSIZE=14,SMALLFONTSIZE=12;Konva.Util.addMethods(GOutputShape,{___init:function ___init(config){Konva.Group.prototype.___init.call(this,config);this.__createShapes();},__createShapes:function __createShapes(){var attrs=this.attrs;var showType=undefined;switch(Number(attrs.store.type)){case 0:showType='数据源';break;case 1:showType='短信';break;case 2:showType='邮件';break;case 10:showType='数值';break;case 11:showType='字符串';break;case 12:showType='时间';break;case 13:showType='JSON';break;};this.add(new Konva.Rect({x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:attrs.width/5,fill:'#697174'}));this.add(new Konva.Text({x:0,y:(attrs.height-FONTSIZE)/2,name:'nameText',text:function(showName){var maxNum=attrs.width/10;if(showName.length>maxNum){return showName.slice(0,maxNum)+'...';}
return showName;}(attrs.store.name),fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:'#9fb0b8',width:attrs.width,height:FONTSIZE,align:'center'}));this.add(new Konva.Text({x:0,y:0,name:'typeText',text:showType,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height}));this.__wrapEvents();},__wrapEvents:function __wrapEvents(){var attrs=this.attrs,MINWIDTH=132,MINHEIGHT=50;var _this=this;var children=this.getChildren();var dragLayer=this.find('.dragLayer')[0];var oldIndex,startPos;var clearLines=function clearLines(){_this.parent.find('.GArrow').visible(false);_this.parent.draw();},createLines=function createLines(){if(attrs.block==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){_this.parent.find('#line_'+lines.id)[0].fire('update',{date:lines});});_this.parent.find('.GArrow').visible(true);_this.parent.draw();};this.on('dragstart',function(e){clearLines();startPos=this.getAbsolutePosition();});this.on('dragmove',function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}});this.on('dragend',function(e){var _this2=this;var bd=attrs.block.sketchpad;var opt=attrs.block.opt;if(!attrs.block.parent){bd.inputs.forEach(function(input){if(!input.child&&bd.tools.intersectionByPoint({x:e.evt.layerX,y:e.evt.layerY},input)&&input.parent.id!=attrs.block.child.id){var target=_this2.parent.find('#'+input.id)[0];_this2.x(input.opt.loc.x);_this2.y(input.opt.loc.y);attrs.block.toBeInput(input.id.split('_')[1]);target.fire('changeToOutput',{data:{id:input.id.split('_')[1],type:100,oldName:input.opt.name,name:opt.name,refId:attrs.id.split('_')[1]}});}});}
this.attrs.store.loc.x=attrs.x;this.attrs.store.loc.y=attrs.y;this.dragBoundFunc(undefined);createLines();});this.on('mouseenter',function(){oldIndex=this.getZIndex();this.moveToTop();this.parent.draw();});this.on('mouseleave',function(){this.setZIndex(oldIndex);this.parent.draw();});}});Konva.Util.extend(GOutputShape,GShape);exports.GOutputShape=GOutputShape;});;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('React'),namespace('ReactKonva'));}})(namespace('beop.strategy.components.Painter'),function(exports,React,ReactKonva){var h=React.h;var PADDING=5,STROKE_WIDTH=1,SIZE_BTN_SIZE=10,CORNERRADIUS=50,FONTSIZE=14,SMALLFONTSIZE=12;var GOutputGroup=function(_React$Component){_inherits(GOutputGroup,_React$Component);function GOutputGroup(props){_classCallCheck(this,GOutputGroup);return _possibleConstructorReturn(this,_React$Component.call(this,props));}
GOutputGroup.prototype.createEvents=function createEvents(){var _this=this;var oldIndex,startPos;var MINWIDTH=132,MINHEIGHT=50;var clearLines=function clearLines(layer){layer.find('.GArrow').visible(false);layer.draw();},createLines=function createLines(attrs,layer){if(attrs.block==undefined)return;attrs.block.updateInfo();attrs.block.getAllLines().forEach(function(lines){var line=layer.find('#line_'+lines.id)[0];line&&line.fire('update',{date:lines});});layer.find('.GArrow').visible(true);layer.draw();};this.props.onDragStart=function(){clearLines(this.parent);startPos=this.getAbsolutePosition();};this.props.onDragMove=function(e){var evt=e.evt;if(evt.ctrlKey&&this.dragBoundFunc()==undefined){var pos=this.getAbsolutePosition();var dx=Math.abs(pos.x-startPos.x),dy=Math.abs(pos.y-startPos.y);if(dx>=dy+10){this.y(startPos.y);this.dragBoundFunc(function(pos){return{x:pos.x,y:this.getAbsolutePosition().y};});}else if(dy>=dx+10){this.x(startPos.x);this.dragBoundFunc(function(pos){return{x:this.getAbsolutePosition().x,y:pos.y};});}
this.parent.draw();}};this.props.onDragEnd=function(e){var _this4=this;var attrs=this.attrs;var bd=attrs.block.sketchpad;var opt=attrs.block.opt;var x,y;if(!attrs.block.parent){bd.inputs.forEach(function(input){if(!input.child&&bd.tools.intersectionByPoint({x:e.evt.layerX,y:e.evt.layerY},input)&&input.parent.id!=attrs.block.child.id){var target=_this4.parent.find('#'+input.id)[0];x=input.opt.loc.x;y=input.opt.loc.y;attrs.customEvent.merge(input.id.split('_')[1],input.opt.name,attrs.id.split('_')[1],opt.name);}});}
this.attrs.customEvent.dragend(this.attrs.id.split('_')[1],{x:x||this.attrs.x,y:y||this.attrs.y,w:this.attrs.width,h:this.attrs.height},this.attrs.store.name,'output');this.dragBoundFunc(undefined);createLines(this.attrs,this.parent);};this.props.onMouseEnter=function(){oldIndex=this.getZIndex();this.moveToTop();this.parent.draw();};this.props.onMouseLeave=function(){this.setZIndex(oldIndex);this.parent.draw();};};GOutputGroup.prototype.render=function render(){this.createEvents();var attrs=this.props;var showType=undefined;switch(Number(attrs.store.type)){case 0:showType='数据源';break;case 1:showType='短信';break;case 2:showType='邮件';break;case 10:showType='数值';break;case 11:showType='字符串';break;case 12:showType='时间';break;case 13:showType='JSON';break;case 100:showType='引用';break;};return h(ReactKonva.Group,this.props,[h(ReactKonva.Rect,{x:0,y:0,name:'dragLayer',width:attrs.width,height:attrs.height,cornerRadius:attrs.width/5,fill:'#697174'}),h(ReactKonva.Text,{x:0,y:(attrs.height-FONTSIZE)/2,name:'nameText',text:function(showName){var maxNum=attrs.width/10;if(showName.length>maxNum){return showName.slice(0,maxNum)+'...';}
return showName;}(attrs.store.name),fontSize:FONTSIZE,fontFamily:'微软雅黑',fill:'#9fb0b8',width:attrs.width,height:FONTSIZE,align:'center'}),h(ReactKonva.Text,{x:0,y:0,name:'typeText',text:showType,fontSize:SMALLFONTSIZE,fontFamily:'微软雅黑',fill:'#849299',width:attrs.width,height:SMALLFONTSIZE,align:'center',padding:PADDING,offsetY:-attrs.height})]);};return GOutputGroup;}(React.Component);exports.GOutputGroup=GOutputGroup;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.components.Painter.Calculation'),function(exports){var SketchpadChild=function(){function SketchpadChild(opt){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'modular';var parentId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';_classCallCheck(this,SketchpadChild);this.opt=opt;this.id=opt['_id']||parentId;this.type=type;this.parents=[];this.parent=undefined;this.children=[];this.child=undefined;this.sketchpad=undefined;this.line=[];this.inLine=[];this.lineSegment=[];this.PADDING=10;this.inPoint=undefined;this.outPoint=undefined;this.points=[];this.pointsWithoutPadding=[];this.minX=undefined;this.maxX=undefined;this.minY=undefined;this.maxY=undefined;this.maxW=undefined;this.maxH=undefined;this.init();}
SketchpadChild.prototype.init=function init(){this._createInfo();};SketchpadChild.prototype.add=function add(cognateBlock){switch(this.type){case'output':this.setChild(cognateBlock);cognateBlock.addParents(this);break;case'input':this.setParent(cognateBlock);cognateBlock.addChildren(this);break;}};SketchpadChild.prototype.repaint=function repaint(){this.sketchpad.repaint();};SketchpadChild.prototype.setSketchpad=function setSketchpad(sketchpad){this.sketchpad=sketchpad;};SketchpadChild.prototype.addParents=function addParents(parents){var ids=new Set(this.parents.map(function(parent){return parent.id;}));if(!ids.has(parents.id)){this.parents.push(parents);}};SketchpadChild.prototype.setParent=function setParent(parent){this.parent=parent;};SketchpadChild.prototype.addChildren=function addChildren(children){var ids=new Set(this.children.map(function(child){return child.id;}));if(!ids.has(children.id)){this.children.push(children);}};SketchpadChild.prototype.findById=function findById(id){var result;this.children.forEach(function(child){if(child.id==id){result=child;}});this.parents.forEach(function(parent){if(parent.id==id){result=parent;}});return result;};SketchpadChild.prototype.setChild=function setChild(child){this.child=child;};SketchpadChild.prototype.getAllLines=function getAllLines(){return this.sketchpad.getAllLines();};SketchpadChild.prototype.remove=function remove(){this.sketchpad.remove(this.id,this.type);};SketchpadChild.prototype.destroy=function destroy(){var _this2=this;var block=this;switch(block.type){case'input':break;case'output':break;case'modular':block.children.forEach(function(child){child.setParent();});var outputNames=block.parents.map(function(output){return output.opt.name;});outputNames.forEach(function(outputName){var inputs=_this2.sketchpad.find('opt.name',outputName);inputs.forEach(function(input){if(input.child&&input.child.id==block.id){var i=input.parent.children.findIndex(function(child){return child.id==input.id;});input.parent.children.splice(i,1);}});});break;}};SketchpadChild.prototype.toBeInput=function toBeInput(parentId){var parent=this.sketchpad.findBlockById(parentId);this.setParent(parent);parent.addChildren(this);};SketchpadChild.prototype.updateInfo=function updateInfo(){this._createInfo();this.repaint();};SketchpadChild.prototype._createInfo=function _createInfo(){var opt=this.opt,minX=opt.loc.x-this.PADDING,maxX=opt.loc.x+opt.loc.w+this.PADDING,minY=opt.loc.y-this.PADDING,maxY=opt.loc.y+opt.loc.h+this.PADDING;this.minX=minX;this.maxX=maxX;this.minY=minY;this.maxY=maxY;this.maxW=maxX-minX;this.maxH=maxY-minY;this.points=[{x:minX,y:minY},{x:maxX,y:minY},{x:maxX,y:maxY},{x:minX,y:maxY}];this.pointsWithoutPadding=[{x:opt.loc.x,y:opt.loc.y},{x:opt.loc.x+opt.loc.w,y:opt.loc.y},{x:opt.loc.x+opt.loc.w,y:opt.loc.y+opt.loc.h},{x:opt.loc.x,y:opt.loc.y+opt.loc.h}];this.inPoint={x:minX-1,y:opt.loc.y+opt.loc.h/2};this.outPoint={x:maxX+1,y:opt.loc.y+opt.loc.h/2};};return SketchpadChild;}();var Sketchpad=function(){function Sketchpad(props){_classCallCheck(this,Sketchpad);this.WIDTH=props.width;this.HEIGHT=props.height;this.blocks=[];this.inputs=[];this.outputs=[];this.blockIds=new Set();this.lines=[];this.obstacle=[];this.PADDING=10;this.INPUTWIDTH=132;this.INPUTHEIGHT=50;this.maxStep=1000;this.tools={intersectionByLine:Sketchpad.intersectionByLine,intersectionByRect:Sketchpad.intersectionByRect,intersectionByPoint:Sketchpad.intersectionByPoint,rectToPoints:Sketchpad.rectToPoints};this.init();}
Sketchpad.intersectionByLine=function intersectionByLine(a,b,c,d){var denominator=(b.y-a.y)*(d.x-c.x)-(a.x-b.x)*(c.y-d.y);if(denominator==0){return false;}
var x=((b.x-a.x)*(d.x-c.x)*(c.y-a.y)+(b.y-a.y)*(d.x-c.x)*a.x-(d.y-c.y)*(b.x-a.x)*c.x)/denominator;var y=-((b.y-a.y)*(d.y-c.y)*(c.x-a.x)+(b.x-a.x)*(d.y-c.y)*a.y-(d.x-c.x)*(b.y-a.y)*c.y)/denominator;if((x-a.x)*(x-b.x)<=0&&(y-a.y)*(y-b.y)<=0&&(x-c.x)*(x-d.x)<=0&&(y-c.y)*(y-d.y)<=0){return{x:x,y:y};}
return false;};Sketchpad.blockAndBlock=function blockAndBlock(block){var blocks=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var isDeep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(isDeep){var intersectionInfo=[];blocks.forEach(function(block2){var points1=block.points,points2=block2.points;block.points.forEach(function(points1,i,arr1){block2.points.forEach(function(points2,l,arr2){var intersection=Sketchpad.intersectionByLine(points1,arr1[(i+1)%4],points2,arr2[(l+1)%4]);if(intersection){intersectionInfo.push({intersection:intersection,obstacle:obstacle});}});});});return intersectionInfo;}else{var intersectionInfo=[];blocks.forEach(function(block2){if(intersectionInfo.length>0){return;}
var points1=block.points,points2=block2.points;block.points.forEach(function(points1,i,arr1){if(intersectionInfo.length>0){return;}
block2.points.forEach(function(points2,l,arr2){if(intersectionInfo.length>0){return;}
var intersection=Sketchpad.intersectionByLine(points1,arr1[(i+1)%4],points2,arr2[(l+1)%4]);if(intersection){intersectionInfo.push({intersection:intersection,obstacle:obstacle});}});});});return intersectionInfo;}};Sketchpad.intersectionByRect=function intersectionByRect(){var points=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var blocks=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var finArr=[];blocks.forEach(function(block){var tag=false;points.forEach(function(point){if(tag){return;}
var hasIntersection=Sketchpad.intersectionByPoint(point,block);if(hasIntersection){tag=true;}});if(tag){finArr.push(block);return;}
block.points.forEach(function(point){if(tag){return;}
var hasIntersection=Sketchpad.intersectionByPoint(point,{points:points});if(hasIntersection){tag=true;}});if(tag){finArr.push(block);return;}
block.points.forEach(function(point2,l,arr2){if(tag){return;}
points.forEach(function(point1,i,arr1){if(tag){return;}
var hasIntersection=Sketchpad.intersectionByLine(arr1[i],arr1[(i+1)%4],arr2[l],arr2[(l+1)%4]);if(hasIntersection){tag=true;}});});if(tag){finArr.push(block);return;}});return finArr;};Sketchpad.intersectionByPoint=function intersectionByPoint(point,block){var xArr=block.points.map(function(point){return point.x;}),yArr=block.points.map(function(point){return point.y;});var maxX=Math.max.apply(Math,xArr),minX=Math.min.apply(Math,xArr),maxY=Math.max.apply(Math,yArr),minY=Math.min.apply(Math,yArr);if(point.x<=maxX&&point.x>=minX&&point.y>=minY&&point.y<=maxY){return true;}else{return false;}};Sketchpad.rectToPoints=function rectToPoints(x,y,w,h){var points=[{x:x,y:y},{x:x+w,y:y},{x:x+w,y:y+h},{x:x,y:y+h}];return points;};Sketchpad.prototype.intersectionByPoint=function intersectionByPoint(point,block){return Sketchpad.intersectionByPoint(point,block);};Sketchpad.prototype.init=function init(){};Sketchpad.prototype.clear=function clear(){this.blocks=[];this.inputs=[];this.outputs=[];this.blockIds=new Set();this.lines=[];this.obstacle=[];this.maxStep=1000;this.init();};Sketchpad.prototype.resize=function resize(props){this.WIDTH=parseFloat(props.width);this.HEIGHT=parseFloat(props.height);this.maxStep=(this.WIDTH+this.HEIGHT)/this.PADDING*2;};Sketchpad.prototype.add=function add(){var _this3=this;var blocks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(!(blocks instanceof Array)){blocks=[blocks];}
blocks.forEach(function(block){var cognateId=block['id'].split('_')[1];var cognateBlock=void 0;if(cognateId!=undefined){cognateBlock=_this3.findBlockById(cognateId);block.add(cognateBlock);}else{block.setParent(_this3);_this3._addBlock(block);}
block.setSketchpad(_this3);});this.repaint();return this.lines;};Sketchpad.prototype.repaint=function repaint(){this._createObstacle();this.lines=this._paintLine();};Sketchpad.prototype.findBlockById=function findBlockById(id,blocks){var result=undefined;blocks=blocks||this.blocks;blocks.forEach(function(block){if(block.id==id){result=block;}});return result;};Sketchpad.prototype.findBlockIndexById=function findBlockIndexById(id,blocks){var index=undefined;blocks=blocks||this.blocks;blocks.forEach(function(block,i){if(block.id==id){index=i;}});return index;};Sketchpad.prototype.find=function find(){var _selects;var selects=void 0;switch(arguments.length){case 1:selects=arguments.length<=0?undefined:arguments[0];break;case 2:selects=(_selects={},_selects[arguments.length<=0?undefined:arguments[0]]=arguments.length<=1?undefined:arguments[1],_selects);break;default:return;}
var result=[];var space=function space(obj,path){path=path.split('.');for(var i=0,len=path.length;i<len;i++){var p=path[i].trim();obj=obj[p];if(!obj){return;}}
return obj;};var verification=function verification(block){for(var k in selects){if(space(block,k)!==selects[k]){return;}}
result.push(block);};this.blocks.forEach(function(block){verification(block);block.children.forEach(function(input){verification(input);});block.parents.forEach(function(output){verification(output);});});return result;};Sketchpad.prototype.getAllLines=function getAllLines(){return this.lines;};Sketchpad.prototype.remove=function remove(id){var _this4=this;var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'modular';var index=void 0,block=void 0;switch(type){case'input':this.blocks.forEach(function(b){var target=b.findById(id);if(target){index=_this4.findBlockIndexById(id,b.children);block=b.children.splice(index,1)[0];}});break;case'output':break;case'modular':index=this.findBlockIndexById(id);block=this.blocks.splice(index,1)[0];break;};if(block){block.destroy();this.repaint();}};Sketchpad.prototype.createSortInfo=function createSortInfo(block){var num=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'input';if(num==0){return[];}
var _this=this;var intersection=void 0;var W=_this.INPUTWIDTH+2*_this.PADDING,H=_this.INPUTHEIGHT+2*_this.PADDING,MINSPAN=_this.PADDING,MAXSPAN=(num-1)*MINSPAN,maxW=W+MINSPAN,maxH=H+MINSPAN;var w=void 0,h=void 0,x=void 0,y=void 0,points=void 0;var funArr=void 0;switch(type){case'input':funArr=[left,top,botton,right];break;case'output':funArr=[right,botton,left,top];break;}
for(var i=0;i<4;i++){var infoArr=funArr[i](1);if(infoArr){return infoArr;}}
return[];function left(span){if(block.minX>maxW+span){w=maxW;h=num*H+MAXSPAN;x=block.minX-span;y=block.minY-(h-block.maxH)/2;y=Math.min(Math.max(0,y),_this.HEIGHT-h);points=Sketchpad.rectToPoints(x,y,w,h);intersection=Sketchpad.intersectionByRect(points,_this.obstacle);y=y+_this.PADDING;if(intersection.length<1){var finArr=[];for(var _i=0;_i<num;_i++){finArr.push({x:x,y:y+_i*maxH,w:_this.INPUTWIDTH,h:_this.INPUTHEIGHT});}
return finArr;}else{return left(span+1);}}else{return false;}}
function top(span){if(block.minY>maxH+span){w=num*W+MAXSPAN;h=maxH;x=block.minX-(w-block.maxW)/2;y=block.minY-span;x=Math.min(Math.max(0,x),_this.WIDTH-w);points=Sketchpad.rectToPoints(x,y,w,h);intersection=Sketchpad.intersectionByRect(points,_this.obstacle);x=x+_this.PADDING;if(intersection.length<1){var finArr=[];for(var _i2=0;_i2<num;_i2++){finArr.push({x:x+_i2*maxW,y:y,w:_this.INPUTWIDTH,h:_this.INPUTHEIGHT});}
return finArr;}else{return top(span+1);}}else{return false;}}
function botton(span){if(_this.HEIGHT>block.maxY+maxH+span){w=num*W+MAXSPAN;h=maxH;x=block.minX-(w-block.maxW)/2;y=block.maxY+span;x=Math.min(Math.max(0,x),_this.WIDTH-w);points=Sketchpad.rectToPoints(x,y,w,h);intersection=Sketchpad.intersectionByRect(points,_this.obstacle);x=x+_this.PADDING;y=y+_this.PADDING*3;if(intersection.length<1){for(var _i3=0;_i3<num;_i3++){var finArr=[];for(var _i4=0;_i4<num;_i4++){finArr.push({x:x+_i4*maxW,y:y,w:_this.INPUTWIDTH,h:_this.INPUTHEIGHT});}
return finArr;}
return true;}else{return botton(span+1);}}else{return false;}}
function right(span){if(_this.WIDTH>block.maxX+maxW+span){w=maxW;h=num*H+MAXSPAN;x=block.maxX+span;y=block.minY-(h-block.maxH)/2;y=Math.min(Math.max(0,y),_this.HEIGHT-h);points=Sketchpad.rectToPoints(x,y,w,h);intersection=Sketchpad.intersectionByRect(points,_this.obstacle);x=x+_this.PADDING*3;y=y+_this.PADDING;if(intersection.length<1){var finArr=[];for(var _i5=0;_i5<num;_i5++){finArr.push({x:x,y:y+_i5*maxH,w:_this.INPUTWIDTH,h:_this.INPUTHEIGHT});}
return finArr;}else{return right(span+1);}}else{return false;}}};Sketchpad.prototype._addBlock=function _addBlock(block){if(!this.blockIds.has(block.id)){this.blocks.push(block);this.blockIds.add(block.id);}};Sketchpad.prototype._createObstacle=function _createObstacle(){var obstacle=[];var inputs=[];var outputs=[];var create=function create(blocks){blocks.forEach(function(block){obstacle.push(block);if(block.children){inputs=inputs.concat(block.children);create(block.children);}
if(block.parents){outputs=outputs.concat(block.parents);create(block.parents);}});};create(this.blocks);this.obstacle=obstacle;this.outputs=outputs;this.inputs=inputs;};Sketchpad.prototype._paintLine=function _paintLine(){var _this5=this;this.count=0;var colors=this._getColors();var arr1=[];this.blocks.forEach(function(block,i){var arr2=[];var color="rgb("+colors[i].toString()+")";block.children.forEach(function(child,index){child.line=[{point:child.outPoint,targetPoint:block.inPoint}];for(var _i6=0;_i6<child.line.length;_i6++){var data=_this5._step(child.line[_i6],block,block.inPoint);if(data&&(data.point.x!==block.inPoint.x||data.point.y!=block.inPoint.y)){child.line.push(data);}else{child.line.push({point:block.inPoint,targetPoint:undefined});break;}
if(_i6>_this5.maxStep){console.log('遮挡');child.line=[];}}
child.line.length>0&&child.line.unshift({point:{x:child.opt.loc.x+child.opt.loc.w,y:child.opt.loc.y+child.opt.loc.h/2},targetPoint:child.outPoint});var points=[];child.line.forEach(function(v){points.push(v.point.x,v.point.y);});points.length>0&&points.push(block.opt.loc.x-1,block.opt.loc.y+block.opt.loc.h/2);arr2.push({id:'inline_'+child.id,points:points});});var lineLength=arr2.length;if(arr2.length>0){var p=arr2[arr2.length-1].points;arr2.push({id:'line_'+block.id+'_end',points:[block.inPoint.x+_this5.PADDING/2,block.inPoint.y-_this5.PADDING/2,block.inPoint.x+_this5.PADDING-1,block.inPoint.y,block.inPoint.x+_this5.PADDING/2,block.inPoint.y+_this5.PADDING/2]});}
block.parents.forEach(function(parent,index){parent.inLine=[{point:parent.inPoint,targetPoint:block.outPoint}];for(var _i7=0;_i7<parent.inLine.length;_i7++){var data=_this5._step(parent.inLine[_i7],block,block.outPoint);if(data&&(data.point.x!==block.outPoint.x||data.point.y!=block.outPoint.y)){parent.inLine.push(data);}else{parent.inLine.push({point:block.outPoint,targetPoint:undefined});break;}
if(_i7>_this5.maxStep){console.log('遮挡');parent.inLine=[];}}
parent.inLine.length>0&&parent.inLine.unshift({point:{x:parent.opt.loc.x-1,y:parent.opt.loc.y+parent.opt.loc.h/2},targetPoint:parent.inPoint});var points=[];parent.inLine.forEach(function(v){points.push(v.point.x,v.point.y);});if(points.length>0){points.push(block.opt.loc.x+block.opt.loc.w+1,block.opt.loc.y+block.opt.loc.h/2);points.unshift(parent.inPoint.x+_this5.PADDING/2,parent.inPoint.y-_this5.PADDING/2,parent.inPoint.x+_this5.PADDING-1,parent.inPoint.y,parent.inPoint.x+_this5.PADDING/2,parent.inPoint.y+_this5.PADDING/2);}
arr2.push({id:'outline_'+parent.id,points:points});});arr1.push({id:block.id,color:color,lines:arr2});});return arr1;};Sketchpad.prototype._getDirectionArr=function _getDirectionArr(directionArr,lastDirection,dX,dY){if(lastDirection&&lastDirection>2){if(dY>0){directionArr.push(1);if(dX>0){directionArr.push(3);}
if(dX==0){directionArr.push(3);}
if(dX<0){directionArr.push(4);}}
if(dY==0){if(dX>0){directionArr.push(3);}
if(dX==0){console.log('success');return false;}
if(dX<0){directionArr.push(4);}}
if(dY<0){directionArr.push(2);if(dX>0){directionArr.push(3);}
if(dX==0){directionArr.push(3);}
if(dX<0){directionArr.push(4);}}}else{if(dX>0){directionArr.push(3);if(dY>0){directionArr.push(1);directionArr.push(2);}
if(dY==0){directionArr.push(2);directionArr.push(1);}
if(dY<0){directionArr.push(2);directionArr.push(1);}}
if(dX==0){if(dY>0){directionArr.push(1);directionArr.push(3);directionArr.push(2);}
if(dY==0){console.log('success');return false;}
if(dY<0){directionArr.push(2);directionArr.push(3);directionArr.push(1);}
directionArr.push(4);}
if(dX<0){directionArr.push(4);if(dY>0){directionArr.push(1);directionArr.push(2);}
if(dY==0){directionArr.push(1);directionArr.push(2);}
if(dY<0){directionArr.push(2);directionArr.push(1);}}}
return true;};Sketchpad.prototype._step=function _step(data,block,finTarget){var _this6=this;var x=undefined,y=undefined;var firstPoint=data.point,lastPoint=undefined,targetPoint=data.targetPoint;var dX=firstPoint.x-targetPoint.x,dY=firstPoint.y-targetPoint.y;var intersectionInfo=undefined,directionArr=[],tempDirection=[],firstDirection=undefined,lastDirection=data.lastDirection;if(this._getDirectionArr(directionArr,lastDirection,dX,dY)==false){return false;}
var newTarget=function newTarget(intersectionInfo,targetPoint,d){var obstacle=intersectionInfo.obstacle,intersection=intersectionInfo.intersection;var target=null;switch(d){case 1:case 2:var centerX=obstacle.minX+obstacle.maxW/2;var a=intersection.x-centerX,b=targetPoint.x-centerX;var y=d==1?obstacle.maxY-1:obstacle.minY+1;if(a*b>=0){if(a>=0){target={x:obstacle.minX-1,y:y};}else{target={x:obstacle.maxX+1,y:y};}}else{var c=intersection.x-obstacle.minX,d=targetPoint.x-obstacle.minX;if(c+d>=obstacle.maxW){target={x:obstacle.minX-1,y:y};}else{target={x:obstacle.maxX+1,y:y};}}
break;case 3:case 4:if(targetPoint.y<=obstacle.maxY&&targetPoint.y>=obstacle.minY){var centerY=obstacle.outPoint.y;var a=intersection.y-centerY,b=targetPoint.y-centerY;var x=d==3?obstacle.maxX-1:obstacle.minX+1;if(a*b>=0){if(a>=0){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}else{var c=intersection.y-obstacle.maxY,d=targetPoint.y-obstacle.maxY;if(c+d<=obstacle.maxH){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}}else{var a=intersection.y-targetPoint.y;var x=d==3?obstacle.maxX-1:obstacle.minX+1;if(a<=0){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}
break;}
return target;};var newTarget2=function newTarget2(intersectionInfo,targetPoint,d){var obstacle=intersectionInfo.obstacle,intersection=intersectionInfo.intersection;var target=null;switch(d){case 1:case 2:var centerX=obstacle.minX+obstacle.maxW/2;var a=intersection.x-centerX,b=targetPoint.x-centerX;var y=d==1?obstacle.maxY-1:obstacle.minY+1;if(a*b>=0){if(a<=0){target={x:obstacle.minX-1,y:y};}else{target={x:obstacle.maxX+1,y:y};}}else{var c=intersection.x-obstacle.minX,d=targetPoint.x-obstacle.minX;if(c+d<=obstacle.maxW){target={x:obstacle.minX-1,y:y};}else{target={x:obstacle.maxX+1,y:y};}}
break;case 3:case 4:if(targetPoint.y<=obstacle.maxY&&targetPoint.y>=obstacle.minY){var centerY=obstacle.outPoint.y;var a=intersection.y-centerY,b=targetPoint.y-centerY;var x=d==3?obstacle.maxX-1:obstacle.minX+1;if(a*b>=0){if(a<=0){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}else{var c=intersection.y-obstacle.maxY,d=targetPoint.y-obstacle.maxY;if(c+d>=obstacle.maxH){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}}else{var a=intersection.y-targetPoint.y;var x=d==3?obstacle.maxX-1:obstacle.minX+1;if(a>=0){target={x:x,y:obstacle.minY-1};}else{target={x:x,y:obstacle.maxY+1};}}
break;}
return target;};var to=function to(index){firstDirection=directionArr[index];switch(firstDirection){case 1:x=firstPoint.x;y=firstPoint.y-Math.min(_this6.PADDING,dY);break;case 2:x=firstPoint.x;y=firstPoint.y+Math.min(_this6.PADDING,-dY);break;case 3:y=firstPoint.y;x=firstPoint.x-Math.min(_this6.PADDING,dX);break;case 4:y=firstPoint.y;x=firstPoint.x+Math.min(_this6.PADDING,-dX);break;}
lastPoint={x:x,y:y};intersectionInfo=_this6._getIntersection(firstPoint,lastPoint,firstDirection);if(intersectionInfo){if(!(Math.abs(intersectionInfo.intersection.x-firstPoint.x)==1||Math.abs(intersectionInfo.intersection.y-firstPoint.y)==1)){lastPoint=intersectionInfo.intersection;switch(firstDirection){case 1:lastPoint.y+=1;break;case 2:lastPoint.y-=1;break;case 3:lastPoint.x+=1;break;case 4:lastPoint.x-=1;break;}
_this6.count=0;return{point:lastPoint,targetPoint:targetPoint};}
var aa=newTarget2(intersectionInfo,targetPoint,firstDirection);if(aa){_this6.count++;return{point:firstPoint,targetPoint:aa,lastDirection:firstDirection};}else{return to((index+1)%3);}}else if(lastPoint.x==targetPoint.x&&lastPoint.y==targetPoint.y){_this6.count=0;return{point:lastPoint,targetPoint:finTarget};}else{_this6.count=0;return{point:lastPoint,targetPoint:targetPoint};}};return to(0);};Sketchpad.prototype._getIntersection=function _getIntersection(a,b,direction){var minX,maxX,minY,maxY;var newObstacle=[],intersectionArr=[],intersection=undefined;var fin=undefined,fn=undefined;switch(direction){case 1:minY=b.y;maxY=a.y;fn=function fn(data){if(data.intersection.y<fin.y){fin=data;}};break;case 2:minY=a.y;maxY=b.y;fn=function fn(data){if(data.intersection.y>fin.y){fin=data;}};break;case 3:minX=b.x;maxX=a.x;fn=function fn(data){if(data.intersection.x>fin.x){fin=data;}};break;case 4:minX=a.x;maxX=b.x;fn=function fn(data){if(data.intersection.x<fin.x){fin=data;}};break;}
if(minX!==undefined){newObstacle=this.obstacle.filter(function(obstacle){return!(obstacle.maxX<minX||obstacle.minX>maxX);});}else{newObstacle=this.obstacle.filter(function(obstacle){return!(obstacle.maxY<minY||obstacle.minY>maxY);});}
newObstacle.forEach(function(obstacle){obstacle.points.forEach(function(point,i,arr){intersection=Sketchpad.intersectionByLine(a,b,point,arr[(i+1)%4]);intersection&&intersectionArr.push({intersection:intersection,obstacle:obstacle});});});if(intersectionArr.length>0){fin=intersectionArr[0];intersectionArr.forEach(fn);return fin;}else{return false;}};Sketchpad.prototype._getColors=function _getColors(){var COLORS={black:[0,0,0],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};var arr=[];for(var key in COLORS){arr.push(COLORS[key]);}
return arr;};Sketchpad.prototype._mergeObstacle=function _mergeObstacle(){var _this7=this;var ids=[];var obstacleArr=[];var select=function select(obstacle1){var arr=[];_this7.obstacle.forEach(function(obstacle2){if(ids.indexOf(obstacle2.id)>-1){return;}
var arr1=obstacle1.points,arr2=obstacle2.points;for(var i=0,len=arr1.length;i<len;i++){var intersection=void 0;for(var l=0,_len=arr2.length;l<_len;l++){intersection=Sketchpad.intersectionByLine(arr1[i],arr1[(i+1)%4],arr2[l],arr2[(l+1)%4]);if(intersection){arr.push(obstacle2);ids.push(obstacle2.id);arr=arr.concat(select(obstacle2));break;}}
if(intersection){break;}}});return arr;};this.obstacle.forEach(function(obstacle1){if(ids.indexOf(obstacle1.id)>-1){return;}
ids.push(obstacle1.id);var obstacleArr=select(obstacle1);console.log(obstacleArr.length);obstacleArr.push(obstacle1);if(obstacleArr.length>1){var x=Math.min.apply(_this7,obstacleArr.map(function(v){return Number(v.opt.x);}));var maxX=Math.max.apply(_this7,obstacleArr.map(function(v){return Number(v.maxX-v.PADDING);}));var minX=Math.min.apply(_this7,obstacleArr.map(function(v){return Number(v.minX+v.PADDING);}));var y=Math.min.apply(_this7,obstacleArr.map(function(v){return Number(v.opt.y);}));var maxY=Math.max.apply(_this7,obstacleArr.map(function(v){return Number(v.maxY-v.PADDING);}));var minY=Math.min.apply(_this7,obstacleArr.map(function(v){return Number(v.minY+v.PADDING);}));console.log(maxX-minX,maxY-minY);}});};return Sketchpad;}();exports.Main=Sketchpad;exports.Child=SketchpadChild;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'));}else{factory(root,namespace('beop.strategy.core.constants'),namespace('React'),namespace('ReactKonva'),namespace('beop.strategy.components.Painter.GInputGroup'),namespace('beop.strategy.components.Painter.GOutputGroup'),namespace('beop.strategy.components.Painter.GShapeGroup'),namespace('beop.strategy.components.Painter.GArrowGroup'),namespace('beop.strategy.components.Painter.Calculation'));}})(namespace('beop.strategy.components.Painter'),function(exports,constants,React,ReactKonva,GInputGroup,GOutputGroup,GShapeGroup,GArrowGroup,Calculation){var h=React.h;var linkEvent=React.linkEvent;var SketchpadChild=Calculation.Child;var actions={dispatch:null,model:undefined,selectedModulesIds:undefined,valueArr:[],moduleConfig:function moduleConfig(moduleId){console.dir(arguments);actions.dispatch({type:constants.painter.SHOW_CONFIG_PANEL,moduleId:moduleId});},moduleClose:function moduleClose(destroyId){actions.dispatch({type:constants.painter.REMOVE_MODEULE,value:destroyId});},moduleSelect:function moduleSelect(selectId,layer,image,image2){var selectIds=actions.selectedModulesIds;var index=selectIds.indexOf(selectId);if(index>-1){selectIds.splice(index,1);}else{selectIds=[selectId];}
actions.dispatch({type:constants.painter.SELECTED_PROPS,value:selectIds});},dragend:function dragend(id,loc,name,type){actions.dispatch({type:constants.painter.UPDATE_LOC,value:{id:id,loc:loc,name:name,type:type}});},noSelect:function noSelect(layer,image){actions.model.modules.forEach(function(module){var target=layer.find('#'+module['_id'])[0];target.find('.dragLayer')[0].fill('#697174');target.find('.close')[0].image(image);target.find('.config')[0].image(image);target.find('.size')[0].image(image);target.find('.nameText')[0].fill('#cee2ec');layer.find('#line_'+module['_id'])[0].find('.line').stroke('#6f7777');});layer.draw();},toOutput:function toOutput(){},merge:function merge(id,name,refId,newName){actions.dispatch({type:constants.painter.MERGE_INPUT_OUTPUT,value:{id:id,name:name,refId:refId,newName:newName}});},drop:function drop(id){return function(e){var dsItemId=e.dataTransfer.getData('dsItemId');if(dsItemId){var ds;if(AppConfig.datasource.currentObj==='cloud'){var dragName=$('#tableDsCloud').find('tr[ptid="'+dsItemId+'"]').find('.tabColName').attr('data-value');var currentId=$('#selectPrjName').find('option:selected').val();if(currentId){dragName='@'+currentId+'|'+dragName;}else{dragName=dsItemId;}
ds=dragName;}else{ds=dsItemId;}
var skip=false;bd.blocks.forEach(function(block){if(skip)return;block.children.forEach(function(child){if(skip||child.child!=undefined){return;}
var offset=$('#sketchpadWrap').offset();var isOK=bd.tools.intersectionByPoint({x:e.clientX-offset.left,y:e.clientY-offset.top},child);if(isOK){skip=true;actions.dispatch({type:constants.painter.CHANGE_INPUT_DS,value:{id:child.parent.opt._id,name:child.opt.name,type:0,default:ds}});}});});}else{var $this=$(e.target);var offset=$this.offset(),info=JSON.parse(e.dataTransfer.getData('info'));var x=e.clientX-offset.left-info.x,y=e.clientY-offset.top-info.y;var type,name;switch(info.type){case'py':type=0;name="Python";break;case'API':type=1;name="远程API";break;case'KPI':type=2;name="KPI";break;case'diagnose':type=3;name="诊断";break;case'fr':type=4;name="模糊规则";break;case'return':type=5;name="回归";break;case'forecast':type=6;name="预测";break;case'Fa':type=7;name="傅里叶分析";break;case'Wa':type=8;name="小波分析";break;case'Fc':type=9;name="拟合曲线";break;case'Hc':type=10;name="历史曲线";break;case'rule':type=11;name="规则";break;}
var opt;if(info.dataId){WebAPI.get('/strategy/template/'+info.dataId).done(function(rs){if(rs.status==='OK'){var inputs=[],outputs=[];actions.getInputAndOutput(rs.data.data.modules).forEach(function(put){inputs=inputs.concat(put.input);outputs=outputs.concat(put.output);});;type=1;name=rs.data.data.strategy.name;desc=rs.data.data.strategy.desc;opt={'_id':ObjectId(),'strategyId':id,'type':type,'name':name,'desc':desc,'option':{'input':inputs,'output':outputs,'content':{}},'loc':{'x':x,'y':y,'w':155,'h':72}};actions.dispatch({type:constants.painter.ADD_MODULE,value:opt});}}).fail(function(){alert('获取模板数据失败');});}else{opt={'_id':ObjectId(),'strategyId':id,'type':type,'name':name,'desc':'高大上的玩意儿，你猜是干嘛的','option':{'input':[],'output':[],'content':{}},'loc':{'x':x,'y':y,'w':155,'h':72}};}
actions.dispatch({type:constants.painter.ADD_MODULE,value:opt});}};},getInputAndOutput:function getInputAndOutput(data){var repeat={};var a=[];data.forEach(function(module){module.option.input.forEach(function(input){if(input.type==100){repeat[input.refId]?repeat[input.refId].push(input.name):repeat[input.refId]=[input.name];}});});data.forEach(function(module){var inputs=[],outputs=[];var isNeedCheck=repeat[module['_id']];module.option.input.forEach(function(input){if(input.type!=100){inputs.push(input);}});module.option.output.forEach(function(output){if(!(isNeedCheck&&isNeedCheck.indexOf(output.name)>-1)){outputs.push(output);}});a.push({id:module['_id'],input:inputs,output:outputs});});return a;},batchConfig:function batchConfig(data){actions.dispatch({type:constants.modal.SHOW_MODAL,modalType:'BatchConfigModal',props:data});},debugClick:function debugClick(){actions.dispatch({type:constants.modal.SHOW_MODAL,modalType:'DebugModal',props:undefined});},saveClick:function saveClick(){},backClick:function backClick(){actions.dispatch({type:constants.toolbar.EXIT_STRATEGY});}};var bd=new Calculation.Main({width:1000,height:800});var outputIdsSet=new Set(),moduleIdsSet=new Set();var outputArr=[];var theme={paint:function paint(model){return this.createModul(model).concat(this.createInAndOut(model)).concat(this.createLines(model));},createModul:function createModul(model){var result=[];model.modules.forEach(function(module,i){actions.valueArr[i]=actions.valueArr[i]||{};moduleIdsSet.add(module['_id']);var block=new SketchpadChild(module);result.push(h(GShapeGroup,{id:module['_id'],x:module.loc.x,y:module.loc.y,width:module.loc.w,height:module.loc.h,draggable:true,store:module,block:block,isSelected:actions.selectedModulesIds.indexOf(module['_id'])>-1,customEvent:{close:actions.moduleClose,config:linkEvent(module['_id'],actions.moduleConfig),select:actions.moduleSelect,dragend:actions.dragend}}));bd.add(block);});return result;},createInAndOut:function createInAndOut(model){var _this=this;var result=[];var inputNameSet=new Set();model.modules.forEach(function(module,i){var block=bd.findBlockById(module['_id']);var outputsWithoutLoc=[];module.option.output.forEach(function(output){if(output.loc==undefined){outputsWithoutLoc.push(output);return;}
createOutput.bind(_this)(output);});var newOutputsLoc=bd.createSortInfo(block,outputsWithoutLoc.length,'output');newOutputsLoc.forEach(function(loc,i){outputsWithoutLoc[i].loc=loc;createOutput.bind(_this)(outputsWithoutLoc[i]);});function createOutput(output){outputIdsSet.add(output.name);var id=ObjectId()+'_'+module['_id'];var block=new SketchpadChild(output,'output',id);outputArr.push(block);result.push(h(GOutputGroup,{id:id,name:'output_'+module['_id'],x:output.loc.x,y:output.loc.y,width:output.loc.w,height:output.loc.h,draggable:true,store:output,block:block,customEvent:{dragend:actions.dragend,merge:actions.merge}}));bd.add(block);}});model.modules.forEach(function(module,index){var block=bd.findBlockById(module['_id']);var inputsWithoutLoc=[];module.option.input.forEach(function(input,i){if(input.loc==undefined){inputsWithoutLoc.push(input);return;}
createInput.bind(_this)(input);});var newInputsLoc=bd.createSortInfo(block,inputsWithoutLoc.length,'input');newInputsLoc.forEach(function(loc,i){inputsWithoutLoc[i].loc=loc;createInput.bind(_this)(inputsWithoutLoc[i]);});function createInput(input){var block;if(input.type==100&&input.refId&&moduleIdsSet.has(input.refId)&&outputIdsSet.has(input.name)){block=bd.find({'opt.name':input.name,'child.id':input.refId})[0];block.toBeInput(module['_id']);}else{var rename=function rename(name,num){if(inputNameSet.has(name)){var arr=name.split('_'),last=parseInt(arr[arr.length-1]);;if(isNaN(last)){arr.push(++num);}else{num=++last;arr[arr.length-1]=num;}
name=arr.join('_');return rename(name,num);}else{inputNameSet.add(name);return name;}};input.name=rename(input.name,0);var id=ObjectId()+'_'+module['_id'];block=new SketchpadChild(input,'input',id);result.push(h(GInputGroup,{id:id,name:'input_'+module['_id'],x:input.loc.x,y:input.loc.y,width:input.loc.w,height:input.loc.h,draggable:true,store:input,block:block,showName:actions.valueArr[index][input.name],customEvent:{toOutput:actions.toOutput,dragend:actions.dragend}}));}
bd.add(block);}});return result;},createLines:function createLines(model){var result=[];var allLines=bd.getAllLines();allLines.forEach(function(lines){result.push(h(GArrowGroup,{id:'line_'+lines.id,name:'GArrow',x:0,y:0,store:lines,isSelected:actions.selectedModulesIds.indexOf(lines.id)>-1}));});return result;},rightBtnGroup:function rightBtnGroup(data){return h('div',{className:'btn-group fr',style:{border:'none',padding:'0',position:'absolute',top:'12px',right:'12px'}},[theme.batchConfigBtn(data),theme.exportBtn(),theme.debugBtn(),theme.saveBtn.call(this),theme.animateBtn(),theme.backBtn()]);},batchConfigBtn:function batchConfigBtn(data){return h('button',{className:'btn btn-primary',onClick:linkEvent(data,actions.batchConfig)},['批量配置参数']);},exportBtn:function exportBtn(){return h('button',{className:'btn btn-primary',onClick:actions.debugClick},['导出']);},debugBtn:function debugBtn(){return h('button',{className:'btn btn-primary',onClick:actions.debugClick},['调试']);},saveBtn:function saveBtn(){return h('button',{id:'saveBtn',className:'btn btn-primary',onClick:linkEvent({},this.props.handleSync)},['保存']);},animateBtn:function animateBtn(){return h('button',{id:'saveAnimate',className:'btn btn-primary'},[this.saveAnimate()]);},backBtn:function backBtn(){return h('button',{className:'btn btn-primary fl',onClick:actions.backClick},['返回']);},saveAnimate:function saveAnimate(){return h('div',{className:'spCss '},[h('div',{className:'rect1'}),h('div',{className:'rect2'}),h('div',{className:'rect3'}),h('div',{className:'rect4'}),h('div',{className:'rect5'})]);}};var preventFn=function preventFn(e){e.preventDefault();};var Sketchpad=function(_React$Component){_inherits(Sketchpad,_React$Component);function Sketchpad(props,context){_classCallCheck(this,Sketchpad);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));_this2.state={};_this2.HEIGHT=800;_this2.WIDTH=1000;_this2.refs={};return _this2;}
Sketchpad.prototype.refDefine=function refDefine(name){var refs=this.refs=this.refs||{};return function(dom){refs[name]=dom;};};Sketchpad.prototype.componentDidMount=function componentDidMount(){var stage=this.refs.stage.getStage();var style={width:'1260px',height:'886px'};stage.setWidth(parseFloat(style.width));stage.setHeight(parseFloat(style.height));this.WIDTH=parseFloat(style.width);this.HEIGHT=parseFloat(style.height);bd.resize({width:style.width,height:style.height});};Sketchpad.prototype.componentWillUnmount=function componentWillUnmount(){};Sketchpad.prototype.render=function render(){var model=this.props.tempStrategy,selectedModulesIds=this.props.selectedModulesIds;actions.dispatch=actions.dispatch||this.context.dispatch;actions.model=model;actions.selectedModulesIds=selectedModulesIds;actions.valueArr=model.strategy.value||[];bd=new Calculation.Main({width:this.WIDTH,height:this.HEIGHT});return h('#sketchpadWrap.gray-scrollbar',{ref:this.refDefine('domWrap'),style:{width:'100%',height:'calc(100% - 74px)',position:'relative',zIndex:10,overflow:'auto'},onDragStart:preventFn,onDragOver:preventFn,onDrop:actions.drop(this.props.tempStrategy.strategy._id)},[theme.rightBtnGroup.call(this,this.props.tempStrategy.strategy.value),h(ReactKonva.Stage,{ref:this.refDefine('stage')},[h(ReactKonva.Layer,theme.paint(model))])]);};return Sketchpad;}(React.Component);exports.Sketchpad=Sketchpad;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.containers'),function(exports){var deepClone=$.extend.bind(true);var container=function container(store,dataset){store=store||{};dataset=dataset||{};if(dataset.addModule){store.painter.openStrategy=deepClone({},store.painter.openStrategy);store.painter.openStrategy.modules.push(dataset.addModule);}
if(dataset.changeConfigVal){store.painter.openStrategy.strategy.value=dataset.changeConfigVal.props;}
if(dataset.selectedModuleIds){store.painter.selectedModulesIds=dataset.selectedModuleIds;}
if(dataset.modal){store.modal=dataset.modal;}
if(dataset.updateLoc){store.painter.openStrategy=deepClone({},store.painter.openStrategy);var target;store.painter.openStrategy.modules.forEach(function(module){if(module._id==dataset.updateLoc.id){if(dataset.updateLoc.type=='input'){module.option.input.forEach(function(input){if(input.name==dataset.updateLoc.name){target=input;}});}else if(dataset.updateLoc.type=='output'){module.option.output.forEach(function(output){if(output.name==dataset.updateLoc.name){target=output;}});}else{target=module;}}});if(target){target.loc.x=dataset.updateLoc.loc.x;target.loc.y=dataset.updateLoc.loc.y;target.loc.w=dataset.updateLoc.loc.w;target.loc.h=dataset.updateLoc.loc.h;}}
if(dataset.removeModuleId){store.painter.openStrategy=deepClone({},store.painter.openStrategy);var index=store.painter.openStrategy.modules.findIndex(function(module){return module._id==dataset.removeModuleId;});store.painter.openStrategy.strategy.value.splice(index,1);var target=store.painter.openStrategy.modules.splice(index,1)[0];store.painter.openStrategy.modules.forEach(function(module){var index=module.option.input.findIndex(function(input){return input.type==100&&input.refId==target._id;});if(index>-1){module.option.input.splice(index,1);}});}
if(dataset.mergeInputOutput){store.painter.openStrategy=deepClone({},store.painter.openStrategy);store.painter.openStrategy.modules.forEach(function(module){if(module._id==dataset.mergeInputOutput.id){module.option.input.forEach(function(input){if(input.name==dataset.mergeInputOutput.name){input.type=100;input.name=dataset.mergeInputOutput.newName;input.refId=dataset.mergeInputOutput.refId;}});}});}
if(dataset.modalConfigPanel){store.modalConfigPanel=deepClone({},store.modalConfigPanel,dataset.modalConfigPanel);}
if(dataset.configPanelSave){var idx=-1;store.painter.openStrategy.modules.some(function(row,i){if(row._id===dataset.configPanelSave._id){idx=i;return true;}});if(idx>-1){store.painter.openStrategy.modules.splice(idx,1,dataset.configPanelSave);}}
if(dataset.selectedModuleItems){store.painter.openStrategy.modules.forEach(function(row){if(dataset.selectedModuleItems[0]._id===row._id){dataset.selectedModuleItems[0]=row;}});}
if(dataset.changeInputDs){var index;store.painter.openStrategy=deepClone({},store.painter.openStrategy);store.painter.openStrategy.modules.forEach(function(module,i){if(module._id==dataset.changeInputDs.id){module.option.input.forEach(function(input){if(input.name==dataset.changeInputDs.name){index=i;input.type=dataset.changeInputDs.type;input.default=dataset.changeInputDs.default;}});}});if(index&&store.painter.openStrategy.strategy.value){store.painter.openStrategy.strategy.value[index]=store.painter.openStrategy.strategy.value[index]||{};store.painter.openStrategy.strategy.value[index][dataset.changeInputDs.name]=dataset.changeInputDs.default;}}
if('newActiveSiderIndex'in dataset){store.painter.activeSiderIndex=dataset.newActiveSiderIndex;}
return store;};exports.painterContainer=container;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root,namespace('beop.strategy.core.constants'));}})(namespace('beop.strategy.reducers'),function(exports,constants){exports.painterReducer={create:function create(present){return function(action){switch(action.type){case constants.toolbar.EXIT_STRATEGY:present({openStrategy:null});break;case constants.painter.CLOSR_CONFIG_PANEL:present({modalConfigPanel:{configModuleId:null}});break;case constants.painter.CONFIG_PANEL_SAVE_AND_CLOSE:present({configPanelSave:action.module});break;case constants.modal.SHOW_MODAL:present({modal:{type:action.modalType,props:action.props}});break;case constants.modal.HIDE_MODAL:present({modal:{type:null,props:{}}});break;case constants.modal.CHANGE_STRATEGY_VALUE:present({changeConfigVal:{type:action.modalType,props:action.props}});break;case constants.painter.ADD_MODULE:present({addModule:action.value});break;case constants.painter.SHOW_CONFIG_PANEL:present({modalConfigPanel:{configModuleId:action.moduleId}});break;case constants.painter.SELECTED_PROPS:present({selectedModuleIds:action.value,newActiveSiderIndex:2});break;case constants.painter.UPDATE_LOC:present({updateLoc:action.value});break;case constants.painter.MERGE_INPUT_OUTPUT:present({mergeInputOutput:action.value});break;case constants.modulePropPanel.CHANGE_SELECTEDMODULES_PROPS:present({modal:{type:action.modalType,props:action.props},selectedModuleItems:action.props});break;case constants.painter.REMOVE_MODEULE:present({removeModuleId:action.value});break;case constants.painter.CHANGE_INPUT_DS:present({changeInputDs:action.value});break;case constants.painter.CHANGE_ACTIVE_SIDER_INDEX:present({newActiveSiderIndex:action.idx});break;default:break;}};}};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','../Painter/Toolbar/toolbar.js','../Painter/Sketchpad/sketchpad.js','../Painter/Toolbar/batchConfigModal.js','../Painter/Toolbar/debugModal.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('../Painter/Toolbar/toolbar.js'),require('../Painter/Sketchpad/sketchpad.js'),require('../Painter/Toolbar/batchConfigModal.js'),require('../Painter/Toolbar/debugModal.js'));}else{factory(root,namespace('React'),namespace('beop.strategy.components.Layout'),namespace('beop.strategy.components.DataSourcePanel'),namespace('beop.strategy.components.RulePanel'),namespace('beop.strategy.components.ModulePropPanel'),namespace('beop.strategy.components.ModuleConfigPanel.Index'),namespace('beop.strategy.components.Painter.BatchConfigModal'),namespace('beop.strategy.components.Painter.DebugModal'),namespace('beop.strategy.components.Painter.Toolbar'),namespace('beop.strategy.components.Painter.Sketchpad'),namespace('beop.strategy.core.createModel'),namespace('beop.strategy.reducers.painterReducer'),namespace('beop.strategy.containers.painterContainer'),namespace('beop.strategy.core.constants'),namespace('diff'),namespace('beop.util.MergeDiff'));}})(namespace('beop.strategy.components.Painter'),function(exports,React,Layout,DataSourcePanel,RulePanel,ModulePropPanel,ModuleConfigPanel,BatchConfigModal,DebugModal,Toolbar,Sketchpad,createModel,painterReducer,painterContainer,constants,_diff,MergeDiff){var _painter;var h=React.h;var Sider=Layout.Sider;var SiderGroup=Layout.SiderGroup;var Container=Layout.Container;var Content=Layout.Content;var deepClone=$.extend.bind($,true);var initialStore={painter:(_painter={openStrategy:null,activeSiderIndex:2},_painter['activeSiderIndex']=null,_painter.selectedModulesIds=[],_painter),sketchpad:{},dataSourcePanel:{group:null},modal:{type:"",props:{}},modalConfigPanel:{configModuleId:null}};var state=function state(store){var selectedModulesItems=function(){if(!store.painter.openStrategy){return[];}
return store.painter.openStrategy.modules.filter(function(row){return store.painter.selectedModulesIds.indexOf(row._id)>-1;});}();var configModule=function(){var rs=null;if(!store.painter.openStrategy){return null;}
store.painter.openStrategy.modules.some(function(row){if(row._id===store.modalConfigPanel.configModuleId){rs=row;return true;}});return rs;}();return{painter:{openStrategy:store.painter.openStrategy,selectedModulesIds:store.painter.selectedModulesIds,activeSiderIndex:store.painter.activeSiderIndex},modulePropPanel:{selectedModules:selectedModulesItems},toolbar:{},sketchpad:{},dataSourcePanel:{group:store.dataSourcePanel.group},modal:{type:store.modal.type,props:store.modal.props},modalConfigPanel:{configModule:configModule,moduleOutputs:function(){var list=[];if(!store.painter.openStrategy||!configModule){return[];}
store.painter.openStrategy.modules.forEach(function(row){if(row._id===configModule._id){return;}
list.push({_id:row._id,name:row.name,output:row.option.output});});return list;}()}};};var nap=function nap(present){return function(state){};};var model=createModel(painterContainer,state,initialStore,nap);var snapshot={snapshot:null,set:function set(data){this.snapshot=deepClone({},Array.toMap(data,'_id'));},get:function get(){return this.snapshot;}};var Painter=function(_React$Component){_inherits(Painter,_React$Component);function Painter(props,context){_classCallCheck(this,Painter);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));initialStore.painter.openStrategy=_this2.props.openStrategy;_this2.state=deepClone({},model.getState(),{painter:{openStrategy:_this2.props.openStrategy}});snapshot.set(_this2.state.painter.openStrategy.modules);_this2.sync=_this2.sync.bind(_this2);return _this2;}
Painter.prototype.componentDidMount=function componentDidMount(){var _this=this;this.unsubscribe=model.subscribe(function(state){Log.info('Received new painter state',state);_this.setState(state);});};Painter.prototype.componentWillUnmount=function componentWillUnmount(){this.unsubscribe();};Painter.prototype.shouldComponentUpdate=function shouldComponentUpdate(nextProps,nextState){return true;};Painter.prototype.diff=function diff(data){var lastData=snapshot.get();return _diff(lastData,data,function(lhs,rhs,path){var cmp;if(path.length!==2||['option','loc'].indexOf(path[1])===-1)return;cmp=window.diff(lhs,rhs);return cmp!==null;});};Painter.prototype.sync=function sync(){var _this=this;var data=this.state.painter.openStrategy.modules;var item=this.state.painter.openStrategy.strategy;var diffData=this.diff(Array.toMap(data,'_id'));if(diffData){diffData=MergeDiff(diffData);var info={userId:AppConfig.userId,ids:[item['_id']],data:{'value':item.value}};var saveApi=WebAPI.post('/strategy/item/save',info);var syncApi=WebAPI.post('/strategy/modules/sync',{modules:diffData}).done(function(rs){if(rs.status==='OK'){snapshot.set(data);}else{}}).fail(function(){});}else{}};Painter.prototype.render=function render(){var state=this.state;var bConfigModule=!!state.modalConfigPanel.configModule;return!bConfigModule?h(Container,{children:[h(Content,{id:'content',style:{overflow:'hidden'},children:[h('#painter',{style:{width:'100%',height:'100%'}},[h(Toolbar),h(Sketchpad,{tempStrategy:this.state.painter.openStrategy,selectedModulesIds:this.state.painter.selectedModulesIds,handleSync:this.sync})]),function(){switch(state.modal.type){case'BatchConfigModal':return h(BatchConfigModal,state.modal.props);break;case'DebugModal':return h(DebugModal,state.painter.openStrategy);break;default:return null;}}()]}),h(SiderGroup,{id:'rightSider',style:{width:"360px"},children:[h(Sider,{title:'规则',children:[h(RulePanel,state.rulePanel)]}),h(Sider,{title:'数据源',children:[h(DataSourcePanel,state.dataSourcePanel)]}),h(Sider,{title:'模块属性',children:[h(ModulePropPanel,state)]})]})]}):h(Container,[h(Content,{id:'content'},[h(ModuleConfigPanel,state.modalConfigPanel)]),h(SiderGroup,{id:'rightSider',style:{width:"360px"}},[h(Sider,{title:'数据源',children:[h(DataSourcePanel,state.dataSourcePanel)]})])]);};return Painter;}(React.Component);exports.Index=Painter;exports.dispatch=painterReducer.create(model.present.bind(model));});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root);}})(namespace('beop.strategy.containers'),function(exports){var deepClone=function deepClone(obj){var type=$.type(obj);if(type==='object'){return $.extend(true,{},obj);}else if(type==='array'){return $.extend(true,[],obj);}else{return obj;}};var getFlatItems=function getFlatItems(nestedItems){var shadow=nestedItems.slice();var rs=[];var item;while(item=shadow.shift()){rs.push(item);if(item.children){shadow=shadow.concat(item.children);}}
return rs;};var removeItems=function removeItems(items,removedIds){return items.filter(function(row){if(row.children){row.children=removeItems(row.children,removedIds);}
return removedIds.indexOf(row._id)===-1;});};var container=function container(store,dataset){store=store||{};dataset=dataset||{};if(dataset.toggleShowAllStrategiesBtn){store.equipTree.bShowChildStrategies=!store.equipTree.bShowChildStrategies;}
if(dataset.selectEquipTreeNode){store.equipTree.selectedNode=dataset.selectEquipTreeNode;}
if(dataset.addStrategyItems){var node=null,stack=store.equipTree.items.slice();while(node=stack.shift()){if(node._id===dataset.addStrategyItems.nodeId){break;}
if(node.children&&node.children.length){stack=stack.concat(node.children);}}
if(node){if(dataset.addStrategyItems.items instanceof Array){node.children=dataset.addStrategyItems.items;}else{node.children.push(dataset.addStrategyItems.items);}}}
if(dataset.removedStrategiesIds){store.equipTree.items=removeItems(store.equipTree.items,dataset.removedStrategiesIds);}
if('strategySearchKey'in dataset){store.strategyTable.searchKey=dataset.strategySearchKey;}
if(dataset.enableStrategies){getFlatItems(store.equipTree.items).forEach(function(row){if(dataset.enableStrategies.indexOf(row._id)>-1){row.status=1;}});}
if(dataset.disableStrategies){getFlatItems(store.equipTree.items).forEach(function(row){if(dataset.disableStrategies.indexOf(row._id)>-1){row.status=0;}});}
if(dataset.selectStrategyTableRows){store.strategyTable.selectedIds=dataset.selectStrategyTableRows;}
if('openStrategy'in dataset){store.painter.openStrategy=dataset.openStrategy;store.painter.tempStrategy=deepClone(store.painter.openStrategy);}
if(dataset.propItemsToItems){getFlatItems(store.equipTree.items).forEach(function(item){if(dataset.propItemsToItems.selectedIds.indexOf(item['_id'])>-1){for(var k in dataset.propItemsToItems.value){item[k]=dataset.propItemsToItems.value[k];}}});}
return store;};exports.appContainer=container;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports);}else{factory(root,namespace('beop.strategy.core.constants'));}})(namespace('beop.strategy.reducers'),function(exports,constants){exports.appReducer={create:function create(present){return function(action){switch(action.type){case constants.equipTree.TOGGLE_SHOW_ALL_STRATEGIES_BTN:present({toggleShowAllStrategiesBtn:true});break;case constants.equipTree.SELECT_TREE_NODE:present({selectEquipTreeNode:{_id:action._id,pid:action.pid}});break;case constants.equipTree.ADD_SYNC_DATA:present({addStrategyItems:{items:action.items,nodeId:action.nodeId}});break;case constants.strategyTable.ADD_ITEM:var newData={'_id':ObjectId(),'nodeId':action.nodeId,'name':'Untitled','desc':'暂无描述信息','userId':AppConfig.userId,'lastTime':new Date().format('yyyy-MM-dd hh:mm:ss'),'keywords':[],'type':0,'interval':60,'lastRuntime':new Date().format('yyyy-MM-dd hh:mm:ss'),'status':0,'value':[]};WebAPI.post('/strategy/item/save',{userId:AppConfig.userId,data:newData}).done(function(result){if(result.status==='OK'){alert('新增成功！');present({addStrategyItems:{items:newData,nodeId:action.nodeId}});}else{alert('新增失败！');}});break;case constants.strategyTable.REMOVE_SELECTED_ITEMS:WebAPI.post('/strategy/item/remove',{userId:AppConfig.userId,ids:action.selectedIds}).done(function(result){if(result.status==='OK'){alert('删除成功！');present({removedStrategiesIds:action.selectedIds});}else{alert('删除失败！');}});break;case constants.strategyTable.CHANGE_SEARCH_FIELD:present({strategySearchKey:action.value});break;case constants.strategyTable.ENABLE_STRATEGIES:WebAPI.post('/strategy/item/save',{userId:AppConfig.userId,ids:action.ids,data:{'status':1}}).done(function(result){if(result.status==='OK'){alert('启用成功');present({enableStrategies:action.ids});}else{alert('启用失败');}});break;case constants.strategyTable.DISABLE_STRATEGIES:WebAPI.post('/strategy/item/save',{userId:AppConfig.userId,ids:action.ids,data:{'status':0}}).done(function(result){if(result.status==='OK'){alert('禁用成功');present({disableStrategies:action.ids});}else{alert('禁用失败');}});break;case constants.strategyTable.SELECT_ROWS:present({selectStrategyTableRows:action.selectedIds});break;case constants.strategyTable.OPEN_STRATEGY:WebAPI.get('/strategy/item/get/'+action.strategyId).done(function(rs){if(rs.status==='OK'){present({openStrategy:rs.data});}}).fail(function(){});break;case constants.propPanel.SAVE_PROP:var target=action.value.target;var params=$(target).parent().next('form').serialize();params=decodeURIComponent(params,true);var dataArr=params.split('&');var obj={};for(var i=0,length=dataArr.length;i<length;i++){var key=dataArr[i].split('=')[0];var val=dataArr[i].split('=')[1];if(val!==''){if(['status','type','interval'].indexOf(key)>-1){val=Number(val);}
obj[key]=val;}}
obj['lastTime']=new Date().format('yyyy-MM-dd hh:mm:ss');var info={userId:AppConfig.userId,ids:action.value.selectedIds,data:obj};WebAPI.post('/strategy/item/save',info).done(function(result){if(result.status==='OK'){present({propItemsToItems:{selectedIds:action.value.selectedIds,value:obj}});alert('保存成功');}else{alert('保存失败');}});break;case constants.propPanel.RECOVER_PROP:present({propItemsRecover:{selectedIds:action.value.selectedIds}});break;case constants.toolbar.EXIT_STRATEGY:present({openStrategy:null});break;case constants.painter.TO_CONFIG:present({toConfig:action.value});break;case constants.painter.TO_PAINTER:present({toPainter:true});break;case constants.painter.CONFIG_SAVE:present({configSave:true});break;case constants.painter.ADD_MODULE:present({addModule:action.value});break;default:break;}};}};});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;};(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','../Layout/layout','../StrategyTable/strategyTable','../EquipTree/equipTree','../DataSourcePanel/dataSourcePanel','../PropPanel/propPanel','../Painter/painter','../Painter/Toolbar/batchConfigModal.js'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('../Layout/layout'),require('../StrategyTable/strategyTable'),require('../EquipTree/equipTree'),require('../DataSourcePanel/dataSourcePanel'),require('../PropPanel/propPanel'),require('../Painter/painter'),require('../Painter/Toolbar/batchConfigModal.js'));}else{factory(root,namespace('React'),namespace('beop.strategy.components.Layout'),namespace('beop.strategy.components.StrategyTable'),namespace('beop.strategy.components.EquipTree'),namespace('beop.strategy.components.PropPanel'),namespace('beop.strategy.components.Painter.Index'),namespace('beop.strategy.core.createModel'),namespace('beop.strategy.reducers.appReducer'),namespace('beop.strategy.containers.appContainer'));}})(namespace('beop.strategy.components'),function(exports,React,Layout,StrategyTable,EquipTree,PropPanel,Painter,createModel,appReducer,appContainer){var h=React.h;var Sider=Layout.Sider;var SiderGroup=Layout.SiderGroup;var Container=Layout.Container;var Content=Layout.Content;var initialStore={equipTree:{selectedNode:null,items:AppConfig.projectList.map(function(item,i){return{_id:item.id.toString(),name:item.name_cn,nodeId:'',isParent:true,projId:item.id,children:[]};}),bShowChildStrategies:false},strategyTable:{searchKey:'',selectedIds:[]},painter:{openStrategy:null}};var state=function state(store){var selectedGroupId=store.equipTree.selectedNode?store.equipTree.selectedNode.pid:null;var selectedNodeId=store.equipTree.selectedNode?store.equipTree.selectedNode._id:null;var tableItems=selectedGroupId===null?[]:function(){var stack=store.equipTree.items.slice();var item,nodes,rs=[];while(item=stack.shift()){if(item._id===selectedGroupId){nodes=item.children;break;}
if(item.children&&item.children.length){stack=stack.concat(item.children);}}
if(!nodes){return[];}
stack=nodes.slice();while(item=stack.shift()){if(!item.isParent){rs.push(item);continue;}
if(!store.equipTree.bShowChildStrategies){continue;}
if(item.children&&item.children.length){stack=stack.concat(item.children);}}
return rs;}();return{equipTree:{selectedGroupId:selectedGroupId,selectedNodeId:selectedNodeId,items:store.equipTree.items,bShowChildStrategies:store.equipTree.bShowChildStrategies},strategyTable:{searchKey:store.strategyTable.searchKey,selectedIds:store.strategyTable.selectedIds,items:tableItems},painter:{openStrategy:store.painter.openStrategy},propPanel:{items:function(){return tableItems.filter(function(row){return store.strategyTable.selectedIds.indexOf(row['_id'])>-1;});}()}};};var nap=function nap(){return function(){};};var model=createModel(appContainer,state,initialStore,nap);var App=function(_React$Component){_inherits(App,_React$Component);function App(props,context){_classCallCheck(this,App);var _this2=_possibleConstructorReturn(this,_React$Component.call(this,props,context));context.dispatch=props.dispatch;_this2.state=model.getState();return _this2;}
App.prototype.componentDidMount=function componentDidMount(){var _this=this;model.subscribe(function(state){Log.info('Received new app state',state);_this.setState(state);});};App.prototype.render=function render(){var bOpenStrategy=!!this.state.painter.openStrategy;var state=this.state;return h(Container,{id:'container',children:[h(Sider,{id:'leftSider',children:[h(EquipTree,state.equipTree)]}),bOpenStrategy?h(Painter,{openStrategy:state.painter.openStrategy}):h(Container,{children:[h(Content,{id:'content',children:[h(StrategyTable,state)]}),h(SiderGroup,{id:'rightSider',style:{width:"360px"},children:[h(Sider,{title:'属性'},[h(PropPanel,{items:state.propPanel.items,selectedIds:state.strategyTable.selectedIds.slice()})])]})]})]});};return App;}(React.Component);exports.App=App;exports.App.dispatch=appReducer.create(model.present.bind(model));});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(root,factory){if(typeof define==='function'&&define.amd){define(['exports','React','ReactDOM','./components/App/App.js','./core/createModel','./core/createDispatch'],factory);}else if((typeof module==='undefined'?'undefined':_typeof(module))==='object'&&module.exports){factory(exports,require('React'),require('ReactDOM'),require('./components/App/App.js'),require('./core/createModel'),require('./core/createDispatch'));}else{factory(root,namespace('React'),namespace('ReactDOM'),namespace('beop.strategy.components.App'),namespace('beop.strategy.components.Painter'));}})(namespace('beop.strategy'),function(exports,React,ReactDOM,App,Painter){var h=React.h;var dispatch=function dispatch(action){App.dispatch(action);Painter.dispatch(action);};var render=function render(){ReactDOM.render(h(App,{dispatch:dispatch}),document.querySelector('#mainframe'));};var promise=$.Deferred();promise.done(function(){render();});window.initI18n(navigator.language.split('-')[0],false,promise);});