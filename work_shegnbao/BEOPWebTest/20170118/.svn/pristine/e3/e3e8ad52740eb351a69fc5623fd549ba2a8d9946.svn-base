var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(global,factory){if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}return factory(w);};}else{factory(global);}})(typeof window!=="undefined"?window:this,function(window,noGlobal){var arr=[];var _slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var
document=window.document,version="2.1.4",jQuery=function jQuery(selector,context){return new jQuery.fn.init(selector,context);},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function fcamelCase(all,letter){return letter.toUpperCase();};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function toArray(){return _slice.call(this);},get:function get(num){return num!=null?num<0?this[num+this.length]:this[num]:_slice.call(this);},pushStack:function pushStack(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret;},each:function each(callback,args){return jQuery.each(this,callback,args);},map:function map(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function slice(){return this.pushStack(_slice.apply(this,arguments));},first:function first(){return this.eq(0);},last:function last(){return this.eq(-1);},eq:function eq(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function end(){return this.prevObject||this.constructor(null);},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++;}
if((typeof target==="undefined"?"undefined":_typeof(target))!=="object"&&!jQuery.isFunction(target)){target={};}
if(i===length){target=this;i--;}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[];}else{clone=src&&jQuery.isPlainObject(src)?src:{};}
target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function error(msg){throw new Error(msg);},noop:function noop(){},isFunction:function isFunction(obj){return jQuery.type(obj)==="function";},isArray:Array.isArray,isWindow:function isWindow(obj){return obj!=null&&obj===obj.window;},isNumeric:function isNumeric(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0;},isPlainObject:function isPlainObject(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false;}if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false;}
return true;},isEmptyObject:function isEmptyObject(obj){var name;for(name in obj){return false;}return true;},type:function type(obj){if(obj==null){return obj+"";}
return(typeof obj==="undefined"?"undefined":_typeof(obj))==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj==="undefined"?"undefined":_typeof(obj);},globalEval:function globalEval(code){var script,indirect=eval;code=jQuery.trim(code);if(code){if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script);}else{indirect(code);}}},camelCase:function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);},nodeName:function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();},each:function each(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break;}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break;}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}}return obj;},trim:function trim(text){return text==null?"":(text+"").replace(rtrim,"");},makeArray:function makeArray(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{push.call(ret,arr);}}return ret;},inArray:function inArray(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i);},merge:function merge(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j];}first.length=i;return first;},grep:function grep(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i]);}}return matches;},map:function map(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}
return concat.apply([],ret);},guid:1,proxy:function proxy(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}
if(!jQuery.isFunction(fn)){return undefined;}
args=_slice.call(arguments,2);proxy=function proxy(){return fn.apply(context||this,args.concat(_slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;},now:Date.now,support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false;}if(obj.nodeType===1&&length){return true;}return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj;}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function sortOrder(a,b){if(a===b){hasDuplicate=true;}return 0;},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function indexOf(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i;}}return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function funescape(_,escaped,escapedWhitespace){var high="0x"+escaped-0x10000;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);},unloadHandler=function unloadHandler(){setDocument();};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1;}};}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context);}context=context||document;results=results||[];nodeType=context.nodeType;if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results;}if(!seed&&documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType!==1&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&");}else{context.setAttribute("id",nid);}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",");}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}return cache[key+" "]=value;}return cache;}function markFunction(fn){fn[expando]=true;return fn;}function assert(fn){var div=document.createElement("div");try{return!!fn(div);}catch(e){return false;}finally{if(div.parentNode){div.parentNode.removeChild(div);}
div=null;}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}
if(cur){while(cur=cur.nextSibling){if(cur===b){return-1;}}}return a?1:-1;}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j]);}}});});}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context;}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=doc.documentElement;parent=doc.defaultView;if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",unloadHandler,false);}else if(parent.attachEvent){parent.attachEvent("onunload",unloadHandler);}}documentIsHTML=!isXML(doc);support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className");});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length;});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId;};};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag);}else if(support.qsa){return context.querySelectorAll(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem);}}return tmp;}return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\f]' msallowcapture=''>"+"<option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!div.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=");}
if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}
if(!div.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}
if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled");}
div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true;}}}return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}
compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1;}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1;}
return sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;}return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while(cur=cur.parentNode){ap.unshift(cur);}cur=b;while(cur=cur.parentNode){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context);}return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem);}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i);}}while(j--){results.splice(duplicates[j],1);}}
sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function ATTR(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}return match.slice(0,4);},"CHILD":function CHILD(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}return match;},"PSEUDO":function PSEUDO(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]){match[2]=match[4]||match[5]||"";}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function TAG(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function CLASS(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"");});},"ATTR":function ATTR(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}if(!operator){return true;}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function CHILD(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}return true;}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}if(node===elem){break;}}}}
diff-=last;return diff===first||diff%first===0&&diff/first>=0;}};},"PSEUDO":function PSEUDO(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function target(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function root(elem){return elem===docElem;},"focus":function focus(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":function enabled(elem){return elem.disabled===false;},"disabled":function disabled(elem){return elem.disabled===true;},"checked":function checked(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected;},"selected":function selected(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}return elem.selected===true;},"empty":function empty(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}return true;},"parent":function parent(elem){return!Expr.pseudos["empty"](elem);},"header":function header(elem){return rheader.test(elem.nodeName);},"input":function input(elem){return rinputs.test(elem.nodeName);},"button":function button(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function text(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}groups.push(tokens=[]);}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}return selector;}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2];}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true;}}}}}};}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}return true;}:matchers[0];}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}return results;}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}return newUnmatched;}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem);}}postFinder(null,matcherOut=[],temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret;}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens));}matchers.push(matcher);}}return elementMatcher(matchers);}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function superMatcher(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||0.1,len=elems.length;if(outermost){outermostContext=context!==document&&context;}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break;}}if(outermost){dirruns=dirrunsUnique;}}
if(bySet){if(elem=!matcher&&elem){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml);}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break;}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}break;}}}}
(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1;});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(div){return div.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}return Sizzle;}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;});}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not;});}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not);}qualifier=jQuery.filter(qualifier,elements);}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not;});}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));};jQuery.fn.extend({find:function find(selector){var i,len=this.length,ret=[],self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret;},filter:function filter(selector){return this.pushStack(winnow(this,selector||[],false));},not:function not(selector){return this.pushStack(winnow(this,selector||[],true));},is:function is(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this;}
if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}return this;}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem;}this.context=document;this.selector=selector;return this;}}else if(!context||context.jquery){return(context||rootjQuery).find(selector);}else{return this.constructor(context).find(selector);}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this;}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery);}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context;}return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function dir(elem,_dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[_dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break;}matched.push(elem);}}return matched;},sibling:function sibling(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n);}}return matched;}});jQuery.fn.extend({has:function has(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true;}}});},closest:function closest(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched);},index:function index(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1;}
if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0]);}
return indexOf.call(this,elem.jquery?elem[0]:elem);},add:function add(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function addBack(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur;}jQuery.each({parent:function parent(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function parents(elem){return jQuery.dir(elem,"parentNode");},parentsUntil:function parentsUntil(elem,i,until){return jQuery.dir(elem,"parentNode",until);},next:function next(elem){return sibling(elem,"nextSibling");},prev:function prev(elem){return sibling(elem,"previousSibling");},nextAll:function nextAll(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function prevAll(elem){return jQuery.dir(elem,"previousSibling");},nextUntil:function nextUntil(elem,i,until){return jQuery.dir(elem,"nextSibling",until);},prevUntil:function prevUntil(elem,i,until){return jQuery.dir(elem,"previousSibling",until);},siblings:function siblings(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem);},children:function children(elem){return jQuery.sibling(elem.firstChild);},contents:function contents(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched);}if(this.length>1){if(!guaranteedUnique[name]){jQuery.unique(matched);}
if(rparentsprev.test(name)){matched.reverse();}}return this.pushStack(matched);};});var rnotwhite=/\S+/g;var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true;});return object;}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var
memory,_fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function fire(data){memory=options.memory&&data;_fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break;}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift());}}else if(memory){list=[];}else{self.disable();}}},self={add:function add(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg);}}else if(arg&&arg.length&&type!=="string"){add(arg);}});})(arguments);if(firing){firingLength=list.length;}else if(memory){firingStart=start;fire(memory);}}return this;},remove:function remove(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--;}if(index<=firingIndex){firingIndex--;}}}});}return this;},has:function has(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);},empty:function empty(){list=[];firingLength=0;return this;},disable:function disable(){list=stack=memory=undefined;return this;},disabled:function disabled(){return!list;},lock:function lock(){stack=undefined;if(!memory){self.disable();}return this;},locked:function locked(){return!stack;},fireWith:function fireWith(context,args){if(list&&(!_fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args);}else{fire(args);}}return this;},fire:function fire(){self.fireWith(this,arguments);return this;},fired:function fired(){return!!_fired;}};return self;};jQuery.extend({Deferred:function Deferred(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],_state="pending",_promise={state:function state(){return _state;},always:function always(){deferred.done(arguments).fail(arguments);return this;},then:function then(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);}else{newDefer[tuple[0]+"With"](this===_promise?newDefer.promise():this,fn?[returned]:arguments);}});});fns=null;}).promise();},promise:function promise(obj){return obj!=null?jQuery.extend(obj,_promise):_promise;}},deferred={};_promise.pipe=_promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];_promise[tuple[1]]=list.add;if(stateString){list.add(function(){_state=stateString;},tuples[i^1][2].disable,tuples[2][2].lock);}
deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?_promise:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});_promise.promise(deferred);if(func){func.call(deferred,deferred);}
return deferred;},when:function when(subordinate){var i=0,resolveValues=_slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function updateFunc(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values);}else if(!--remaining){deferred.resolveWith(contexts,values);}};},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues));}else{--remaining;}}}
if(!remaining){deferred.resolveWith(resolveContexts,resolveValues);}return deferred.promise();}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this;};jQuery.extend({isReady:false,readyWait:1,holdReady:function holdReady(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}},ready:function ready(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready");}}});function completed(){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);jQuery.ready();}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready);}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false);}}return readyList.promise(obj);};jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true;}if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function fn(elem,key,value){return bulk.call(jQuery(elem),value);};}}if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet;};jQuery.acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType;};function Data(){Object.defineProperty(this.cache={},0,{get:function get(){return{};}});this.expando=jQuery.expando+Data.uid++;}Data.uid=1;Data.accepts=jQuery.acceptData;Data.prototype={key:function key(owner){if(!Data.accepts(owner)){return 0;}var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock};Object.defineProperties(owner,descriptor);}catch(e){descriptor[this.expando]=unlock;jQuery.extend(owner,descriptor);}}
if(!this.cache[unlock]){this.cache[unlock]={};}return unlock;},set:function set(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if(typeof data==="string"){cache[data]=value;}else{if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock],data);}else{for(prop in data){cache[prop]=data[prop];}}}return cache;},get:function get(owner,key){var cache=this.cache[this.key(owner)];return key===undefined?cache:cache[key];},access:function access(owner,key,value){var stored;if(key===undefined||key&&typeof key==="string"&&value===undefined){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key));}
this.set(owner,key,value);return value!==undefined?value:key;},remove:function remove(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(key===undefined){this.cache[unlock]={};}else{if(jQuery.isArray(key)){name=key.concat(key.map(jQuery.camelCase));}else{camel=jQuery.camelCase(key);if(key in cache){name=[key,camel];}else{name=camel;name=name in cache?[name]:name.match(rnotwhite)||[];}}i=name.length;while(i--){delete cache[name[i]];}}},hasData:function hasData(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{});},discard:function discard(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]];}}};var data_priv=new Data();var data_user=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e){}
data_user.set(elem,key,data);}else{data=undefined;}}return data;}jQuery.extend({hasData:function hasData(elem){return data_user.hasData(elem)||data_priv.hasData(elem);},data:function data(elem,name,_data){return data_user.access(elem,name,_data);},removeData:function removeData(elem,name){data_user.remove(elem,name);},_data:function _data(elem,name,data){return data_priv.access(elem,name,data);},_removeData:function _removeData(elem,name){data_priv.remove(elem,name);}});jQuery.fn.extend({data:function data(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=data_user.get(elem);if(elem.nodeType===1&&!data_priv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}}data_priv.set(elem,"hasDataAttrs",true);}}return data;}
if((typeof key==="undefined"?"undefined":_typeof(key))==="object"){return this.each(function(){data_user.set(this,key);});}return access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&value===undefined){data=data_user.get(elem,key);if(data!==undefined){return data;}
data=data_user.get(elem,camelKey);if(data!==undefined){return data;}
data=dataAttr(elem,camelKey,undefined);if(data!==undefined){return data;}
return;}
this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value);if(key.indexOf("-")!==-1&&data!==undefined){data_user.set(this,key,value);}});},null,value,arguments.length>1,null,true);},removeData:function removeData(key){return this.each(function(){data_user.remove(this,key);});}});jQuery.extend({queue:function queue(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=data_priv.get(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=data_priv.access(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}return queue||[];}},dequeue:function dequeue(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function next(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}if(fn){if(type==="fx"){queue.unshift("inprogress");}
delete hooks.stop;fn.call(elem,next,hooks);}if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function _queueHooks(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key]);})});}});jQuery.fn.extend({queue:function queue(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}if(arguments.length<setter){return jQuery.queue(this[0],type);}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function dequeue(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function clearQueue(type){return this.queue(type||"fx",[]);},promise:function promise(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function resolve(){if(!--count){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}type=type||"fx";while(i--){tmp=data_priv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}resolve();return defer.promise(obj);}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);};var rcheckableType=/^(?:checkbox|radio)$/i;(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;})();var strundefined=typeof undefined==="undefined"?"undefined":_typeof(undefined);support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true;}function returnFalse(){return false;}function safeActiveElement(){try{return document.activeElement;}catch(err){}}jQuery.event={global:{},add:function add(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(!elemData){return;}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}
if(!handler.guid){handler.guid=jQuery.guid++;}
if(!(events=elemData.events)){events=elemData.events={};}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return(typeof jQuery==="undefined"?"undefined":_typeof(jQuery))!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined;};}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false);}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}
jQuery.event.global[type]=true;}},remove:function remove(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(!elemData||!(events=elemData.events)){return;}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}continue;}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}if(special.remove){special.remove.call(elem,handleObj);}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}delete events[type];}}
if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem,"events");}},trigger:function trigger(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}
if(rfocusMorph.test(type+jQuery.event.triggered)){return;}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,(typeof event==="undefined"?"undefined":_typeof(event))==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle");if(handle){handle.apply(cur,data);}
handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault();}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}
jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}return event.result;},dispatch:function dispatch(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=_slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}
if(special.postDispatch){special.postDispatch.call(this,event);}return event.result;},handlers:function handlers(event,_handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=_handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!==this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){matches=[];for(i=0;i<delegateCount;i++){handleObj=_handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length;}if(matches[sel]){matches.push(handleObj);}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches});}}}}
if(delegateCount<_handlers.length){handlerQueue.push({elem:this,handlers:_handlers.slice(delegateCount)});}return handlerQueue;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function filter(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode;}return event;}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function filter(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}
if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0;}return event;}},fix:function fix(event){if(event[jQuery.expando]){return event;}
var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop];}
if(!event.target){event.target=document;}
if(event.target.nodeType===3){event.target=event.target.parentNode;}return fixHook.filter?fixHook.filter(event,originalEvent):event;},special:{load:{noBubble:true},focus:{trigger:function trigger(){if(this!==safeActiveElement()&&this.focus){this.focus();return false;}},delegateType:"focusin"},blur:{trigger:function trigger(){if(this===safeActiveElement()&&this.blur){this.blur();return false;}},delegateType:"focusout"},click:{trigger:function trigger(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();return false;}},_default:function _default(event){return jQuery.nodeName(event.target,"a");}},beforeunload:{postDispatch:function postDispatch(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;}}}},simulate:function simulate(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem);}else{jQuery.event.dispatch.call(elem,e);}if(e.isDefaultPrevented()){event.preventDefault();}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true;};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function preventDefault(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&e.preventDefault){e.preventDefault();}},stopPropagation:function stopPropagation(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&e.stopPropagation){e.stopPropagation();}},stopImmediatePropagation:function stopImmediatePropagation(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation();}this.stopPropagation();}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function handle(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}return ret;}};});if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function handler(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);};jQuery.event.special[fix]={setup:function setup(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true);}data_priv.access(doc,fix,(attaches||0)+1);},teardown:function teardown(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);data_priv.remove(doc,fix);}else{data_priv.access(doc,fix,attaches);}}};});}jQuery.fn.extend({on:function on(types,selector,data,fn,one){var origFn,type;if((typeof types==="undefined"?"undefined":_typeof(types))==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}for(type in types){this.on(type,selector,data,types[type],one);}return this;}if(data==null&&fn==null){fn=selector;data=selector=undefined;}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}if(fn===false){fn=returnFalse;}else if(!fn){return this;}if(one===1){origFn=fn;fn=function fn(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}return this.each(function(){jQuery.event.add(this,types,fn,data,selector);});},one:function one(types,selector,data,fn){return this.on(types,selector,data,fn,1);},off:function off(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}if((typeof types==="undefined"?"undefined":_typeof(types))==="object"){for(type in types){this.off(type,selector,types[type]);}return this;}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}if(fn===false){fn=returnFalse;}return this.each(function(){jQuery.event.remove(this,types,fn,selector);});},trigger:function trigger(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function triggerHandler(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem;}
function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem;}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1];}else{elem.removeAttribute("type");}return elem;}
function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"));}}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return;}
if(data_priv.hasData(src)){pdataOld=data_priv.access(src);pdataCur=data_priv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}}
if(data_user.hasData(src)){udataOld=data_user.access(src);udataCur=jQuery.extend({},udataOld);data_user.set(dest,udataCur);}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret;}
function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}jQuery.extend({clone:function clone(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i]);}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i]);}}else{cloneCopyEvent(elem,clone);}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}
return clone;},buildFragment:function buildFragment(elems,context,scripts,selection){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}
jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent="";}}}
fragment.textContent="";i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)!==-1){continue;}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp);}
if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}return fragment;},cleanData:function cleanData(elems){var data,elem,type,key,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(jQuery.acceptData(elem)){key=elem[data_priv.expando];if(key&&(data=data_priv.cache[key])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}if(data_priv.cache[key]){delete data_priv.cache[key];}}}
delete data_user.cache[elem[data_user.expando]];}}});jQuery.fn.extend({text:function text(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value;}});},null,value,arguments.length);},append:function append(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function prepend(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function before(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function after(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},remove:function remove(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem));}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"));}elem.parentNode.removeChild(elem);}}return this;},empty:function empty(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent="";}}return this;},clone:function clone(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function html(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML;}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}elem=0;}catch(e){}}if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function replaceWith(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this);}});return arg&&(arg.length||arg.nodeType)?this:this.remove();},detach:function detach(selector){return this.remove(selector,true);},domManip:function domManip(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value)){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html());}self.domManip(args,callback);});}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}callback.call(this[i],node,i);}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src);}}else{jQuery.globalEval(node.textContent.replace(rcleanScript,""));}}}}}}return this;}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get());}return this.pushStack(ret);};});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display;}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach();}
elemdisplay[nodeName]=display;}return display;}var rmargin=/^margin/;var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function getStyles(elem){if(elem.ownerDocument.defaultView.opener){return elem.ownerDocument.defaultView.getComputedStyle(elem,null);}return window.getComputedStyle(elem,null);};function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name];}if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name);}
if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}return ret!==undefined?ret+"":ret;}function addGetHookIf(conditionFn,hookFn){return{get:function get(){if(conditionFn()){delete this.get;return;}
return(this.get=hookFn).apply(this,arguments);}};}(function(){var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return;}
div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;"+"position:absolute";container.appendChild(div);function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";div.innerHTML="";docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal=divStyle.top!=="1%";boxSizingReliableVal=divStyle.width==="4px";docElem.removeChild(container);}
if(window.getComputedStyle){jQuery.extend(support,{pixelPosition:function pixelPosition(){computePixelPositionAndBoxSizingReliable();return pixelPositionVal;},boxSizingReliable:function boxSizingReliable(){if(boxSizingReliableVal==null){computePixelPositionAndBoxSizingReliable();}return boxSizingReliableVal;},reliableMarginRight:function reliableMarginRight(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";docElem.appendChild(container);ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight);docElem.removeChild(container);div.removeChild(marginDiv);return ret;}});}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name];}return ret;};var
rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name;}
var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name;}}return origName;}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value;}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles);}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}
if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}return val;}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name];}
if(rnumnonpx.test(val)){return val;}
valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0;}
return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px";}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}values[index]=data_priv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display="";}
if(elem.style.display===""&&isHidden(elem)){values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName));}}else{hidden=isHidden(elem);if(display!=="none"||!hidden){data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));}}}
for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue;}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none";}}return elements;}jQuery.extend({cssHooks:{opacity:{get:function get(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":"cssFloat"},style:function style(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value==="undefined"?"undefined":_typeof(value);if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number";}
if(value==null||value!==value){return;}
if(type==="number"&&!jQuery.cssNumber[origName]){value+="px";}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){style[name]=value;}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function css(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra);}
if(val===undefined){val=curCSS(elem,name,styles);}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}
if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val;}return val;}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function get(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra);}):getWidthOrHeight(elem,name,extra);}},set:function set(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0);}};});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"]);}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function expand(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}return expanded;}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});jQuery.fn.extend({css:function css(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}return map;}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);},show:function show(){return showHide(this,true);},hide:function hide(){return showHide(this);},toggle:function toggle(state){if(typeof state==="boolean"){return state?this.show():this.hide();}return this.each(function(){if(isHidden(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function init(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function cur(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function run(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function get(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop];}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result;},set:function set(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function set(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.easing={linear:function linear(p){return p;},swing:function swing(p){return 0.5-Math.cos(p*Math.PI)/2;}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit);}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations);}
if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2];}return tween;}]};function createFxNow(){setTimeout(function(){fxNow=undefined;});return fxNow=jQuery.now();}
function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}if(includeWidth){attrs.opacity=attrs.width=type;}return attrs;}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween;}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}
if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){style.display="inline-block";}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}
for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true;}else{continue;}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}else{display=undefined;}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden;}}else{dataShow=data_priv.access(elem,"fxshow",{});}
if(toggle){dataShow.hidden=!hidden;}if(hidden){jQuery(elem).show();}else{anim.done(function(){jQuery(elem).hide();});}anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0;}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display;}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0];}if(index!==name){props[name]=value;delete props[index];}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function tick(){if(stopped){return false;}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}else{deferred.resolveWith(elem,[animation]);return false;}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function createTween(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function stop(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}
if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result;}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);}jQuery.Animation=jQuery.extend(Animation,{tweener:function tweener(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"];}else{props=props.split(" ");}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback);}},prefilter:function prefilter(callback,prepend){if(prepend){animationPrefilters.unshift(callback);}else{animationPrefilters.push(callback);}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&(typeof speed==="undefined"?"undefined":_typeof(speed))==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx";}
opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this);}if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function fadeTo(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function animate(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function doAnimation(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||data_priv.get(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function stop(type,clearQueue,gotoEnd){var stopQueue=function stopQueue(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}if(clearQueue&&type!==false){this.queue(type||"fx",[]);}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function finish(type){if(type!==false){type=type||"fx";}return this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}
delete data.finish;});}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}if(!timers.length){jQuery.fx.stop();}fxNow=undefined;};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start();}else{jQuery.timers.pop();}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout);};});};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t";})();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function attr(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function removeAttr(name){return this.each(function(){jQuery.removeAttr(this,name);});}});jQuery.extend({attr:function attr(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}
if(_typeof(elem.getAttribute)===strundefined){return jQuery.prop(elem,name,value);}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook);}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{elem.setAttribute(name,value+"");return value;}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;}},removeAttr:function removeAttr(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){elem[propName]=false;}elem.removeAttribute(name);}}},attrHooks:{type:{set:function set(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}return value;}}}}});boolHook={set:function set(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else{elem.setAttribute(name,name);}return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle;}return ret;};});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function prop(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function removeProp(name){return this.each(function(){delete this[jQuery.propFix[name]||name];});}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function prop(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value;}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name];}},propHooks:{tabIndex:{get:function get(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1;}}}});if(!support.optSelected){jQuery.propHooks.selected={get:function get(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex;}return null;}};}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function addClass(value){var classes,elem,cur,clazz,j,finalValue,proceed=typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className));});}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" ";}}
finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue;}}}}return this;},removeClass:function removeClass(value){var classes,elem,cur,clazz,j,finalValue,proceed=arguments.length===0||typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className));});}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ");}}
finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue;}}}}return this;},toggleClass:function toggleClass(value,stateVal){var type=typeof value==="undefined"?"undefined":_typeof(value);if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value);}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);});}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else if(type===strundefined||type==="boolean"){if(this.className){data_priv.set(this,"__className__",this.className);}
this.className=this.className||value===false?"":data_priv.get(this,"__className__")||"";}});},hasClass:function hasClass(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true;}}return false;}});var rreturn=/\r/g;jQuery.fn.extend({val:function val(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret;}return;}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}if(isFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function get(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem));}},select:{get:function get(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}return values;},set:function set(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(option.value,values)>=0){optionSet=true;}}
if(!optionSet){elem.selectedIndex=-1;}return values;}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function set(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0;}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});jQuery.fn.extend({hover:function hover(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);},bind:function bind(types,data,fn){return this.on(types,null,data,fn);},unbind:function unbind(types,fn){return this.off(types,null,fn);},delegate:function delegate(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function undelegate(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);}});var nonce=jQuery.now();var rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"");};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null;}
try{tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml");}catch(e){xml=undefined;}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}return xml;};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while(dataType=dataTypes[i++]){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return!(selected=dataTypeOrTransport);}});return selected;}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}
function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key];}}if(deep){jQuery.extend(true,target,deep);}return target;}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}return responses[finalDataType];}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}break;}}}}
if(conv!==true){if(conv&&s["throws"]){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}return{state:"success",data:response};}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function ajaxSetup(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function ajax(url,options){if((typeof url==="undefined"?"undefined":_typeof(url))==="object"){options=url;url=undefined;}
options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),_statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function getResponseHeader(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2];}}match=responseHeaders[key.toLowerCase()];}return match==null?null:match;},getAllResponseHeaders:function getAllResponseHeaders(){return state===2?responseHeadersString:null;},setRequestHeader:function setRequestHeader(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value;}return this;},overrideMimeType:function overrideMimeType(type){if(!state){s.mimeType=type;}return this;},statusCode:function statusCode(map){var code;if(map){if(state<2){for(code in map){_statusCode[code]=[_statusCode[code],map[code]];}}else{jqXHR.always(map[jqXHR.status]);}}return this;},abort:function abort(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}done(0,finalText);return this;}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))));}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR;}
fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data;}
if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++;}}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort();}
strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i]);}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}try{state=1;transport.send(requestHeaders,done);}catch(e){if(state<2){done(-1,e);}else{throw e;}}}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return;}
state=2;if(timeoutTimer){clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}
if(status===204||s.type==="HEAD"){statusText="nocontent";}else if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(_statusCode);_statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop");}}}return jqXHR;},getJSON:function getJSON(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function getScript(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined;}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback});};});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true});};jQuery.fn.extend({wrapAll:function wrapAll(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i));});}if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild;}return elem;}).append(this);}return this;},wrapInner:function wrapInner(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function wrap(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html);});},unwrap:function unwrap(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes);}}).end();}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0;};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem);};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+((typeof v==="undefined"?"undefined":_typeof(v))==="object"?i:"")+"]",v,traditional,add);}});}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.param=function(a,traditional){var prefix,s=[],add=function add(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;}
if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&").replace(r20,"+");};jQuery.fn.extend({serialize:function serialize(){return jQuery.param(this.serializeArray());},serializeArray:function serializeArray(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}):{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest();}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var key in xhrCallbacks){xhrCallbacks[key]();}});}support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var _callback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function send(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i];}}
if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}
if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
for(i in headers){xhr.setRequestHeader(i,headers[i]);}
_callback=function callback(type){return function(){if(_callback){delete xhrCallbacks[id];_callback=xhr.onload=xhr.onerror=null;if(type==="abort"){xhr.abort();}else if(type==="error"){complete(xhr.status,xhr.statusText);}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,typeof xhr.responseText==="string"?{text:xhr.responseText}:undefined,xhr.getAllResponseHeaders());}}};};xhr.onload=_callback();xhr.onerror=_callback("error");_callback=xhrCallbacks[id]=_callback("abort");try{xhr.send(options.hasContent&&options.data||null);}catch(e){if(_callback){throw e;}}},abort:function abort(){if(_callback){_callback();}}};}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function textScript(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}if(s.crossDomain){s.type="GET";}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,_callback2;return{send:function send(_,complete){script=jQuery("<script>").prop({async:true,charset:s.scriptCharset,src:s.url}).on("load error",_callback2=function callback(evt){script.remove();_callback2=null;if(evt){complete(evt.type==="error"?404:200,evt.type);}});document.head.appendChild(script[0]);},abort:function abort(){if(_callback2){_callback2();}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function jsonpCallback(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}
if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0]);}responseContainer=overwritten=undefined;});return"script";}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null;}if(typeof context==="boolean"){keepScripts=context;context=false;}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove();}return jQuery.merge([],parsed.childNodes);};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments);}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off));url=url.slice(0,off);}
if(jQuery.isFunction(params)){callback=params;params=undefined;}else if(params&&(typeof params==="undefined"?"undefined":_typeof(params))==="object"){type="POST";}
if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR]);});}return this;};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView;}jQuery.offset={setOffset:function setOffset(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative";}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset);}if(options.top!=null){props.top=options.top-curOffset.top+curTop;}if(options.left!=null){props.left=options.left-curOffset.left+curLeft;}if("using"in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({offset:function offset(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return;}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box;}
if(_typeof(elem.getBoundingClientRect)!==strundefined){box=elem.getBoundingClientRect();}win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft};},position:function position(){if(!this[0]){return;}var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset();}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function offsetParent(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent;}return offsetParent||docElem;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?win[prop]:elem[method];}if(win){win.scrollTo(!top?val:window.pageXOffset,top?val:window.pageYOffset);}else{elem[method]=val;}},method,val,arguments.length,null);};});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}});});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name];}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable,null);};});});jQuery.fn.size=function(){return this.length;};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}var
_jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$;}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}return jQuery;};if((typeof noGlobal==="undefined"?"undefined":_typeof(noGlobal))===strundefined){window.jQuery=window.$=jQuery;}return jQuery;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher");}(jQuery);+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in n){if(i.style[t]!==undefined)return{end:n[t]};}return!1;}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one("bsTransitionEnd",function(){i=!0;});return r=function r(){i||n(u).trigger(n.support.transition.end);},setTimeout(r,t),this;};n(function(){(n.support.transition=t(),n.support.transition)&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function handle(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments);}});});}(jQuery);+function(n){"use strict";function u(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this));typeof i=="string"&&u[i].call(r);});}var i='[data-dismiss="alert"]',t=function t(_t){n(_t).on("click",i,this.close);},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.close=function(i){function e(){r.detach().trigger("closed.bs.alert").remove();}var f=n(this),u=f.attr("data-target"),r;(u||(u=f.attr("href"),u=u&&u.replace(/.*(?=#[^\s]*$)/,"")),r=n(u),i&&i.preventDefault(),r.length||(r=f.closest(".alert")),r.trigger(i=n.Event("close.bs.alert")),i.isDefaultPrevented())||(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e());};r=n.fn.alert;n.fn.alert=u;n.fn.alert.Constructor=t;n.fn.alert.noConflict=function(){return n.fn.alert=r,this;};n(document).on("click.bs.alert.data-api",i,t.prototype.close);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.button",r=new t(this,f));i=="toggle"?r.toggle():i&&r.setState(i);});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.isLoading=!1;},r;t.VERSION="3.3.5";t.DEFAULTS={loadingText:"loading..."};t.prototype.setState=function(t){var r="disabled",i=this.$element,f=i.is("input")?"val":"html",u=i.data();t+="Text";u.resetText==null&&i.data("resetText",i[f]());setTimeout(n.proxy(function(){i[f](u[t]==null?this.options[t]:u[t]);t=="loadingText"?(this.isLoading=!0,i.addClass(r).attr(r,r)):this.isLoading&&(this.isLoading=!1,i.removeClass(r).removeAttr(r));},this),0);};t.prototype.toggle=function(){var t=!0,i=this.$element.closest('[data-toggle="buttons"]'),n;i.length?(n=this.$element.find("input"),n.prop("type")=="radio"?(n.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):n.prop("type")=="checkbox"&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"));};r=n.fn.button;n.fn.button=i;n.fn.button.Constructor=t;n.fn.button.noConflict=function(){return n.fn.button=r,this;};n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn"));i.call(r,"toggle");n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault();}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type));});}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i),e=typeof i=="string"?i:f.slide;r||u.data("bs.carousel",r=new t(this,f));typeof i=="number"?r.to(i):e?r[e]():f.interval&&r.pause().cycle();});}var t=function t(_t2,i){this.$element=n(_t2);this.$indicators=this.$element.find(".carousel-indicators");this.options=i;this.paused=null;this.sliding=null;this.interval=null;this.$active=null;this.$items=null;this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this));this.options.pause!="hover"||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this));},u,r;t.VERSION="3.3.5";t.TRANSITION_DURATION=600;t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0};t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return;}n.preventDefault();}};t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this;};t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active);};t.prototype.getItemForDirection=function(n,t){var i=this.getItemIndex(t),f=n=="prev"&&i===0||n=="next"&&i==this.$items.length-1,r,u;return f&&!this.options.wrap?t:(r=n=="prev"?-1:1,u=(i+r)%this.$items.length,this.$items.eq(u));};t.prototype.to=function(n){var i=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(n>this.$items.length-1)&&!(n<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(n);}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n));};t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this;};t.prototype.next=function(){if(!this.sliding)return this.slide("next");};t.prototype.prev=function(){if(!this.sliding)return this.slide("prev");};t.prototype.slide=function(i,r){var e=this.$element.find(".item.active"),u=r||this.getItemForDirection(i,e),l=this.interval,f=i=="next"?"left":"right",a=this,o,s,h,c;return u.hasClass("active")?this.sliding=!1:(o=u[0],s=n.Event("slide.bs.carousel",{relatedTarget:o,direction:f}),this.$element.trigger(s),s.isDefaultPrevented())?void 0:(this.sliding=!0,l&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),h=n(this.$indicators.children()[this.getItemIndex(u)]),h&&h.addClass("active")),c=n.Event("slid.bs.carousel",{relatedTarget:o,direction:f}),n.support.transition&&this.$element.hasClass("slide")?(u.addClass(i),u[0].offsetWidth,e.addClass(f),u.addClass(f),e.one("bsTransitionEnd",function(){u.removeClass([i,f].join(" ")).addClass("active");e.removeClass(["active",f].join(" "));a.sliding=!1;setTimeout(function(){a.$element.trigger(c);},0);}).emulateTransitionEnd(t.TRANSITION_DURATION)):(e.removeClass("active"),u.addClass("active"),this.sliding=!1,this.$element.trigger(c)),l&&this.cycle(),this);};u=n.fn.carousel;n.fn.carousel=i;n.fn.carousel.Constructor=t;n.fn.carousel.noConflict=function(){return n.fn.carousel=u,this;};r=function r(t){var o,r=n(this),u=n(r.attr("data-target")||(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")),e,f;u.hasClass("carousel")&&(e=n.extend({},u.data(),r.data()),f=r.attr("data-slide-to"),f&&(e.interval=!1),i.call(u,e),f&&u.data("bs.carousel").to(f),t.preventDefault());};n(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r);n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(t){var i,r=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return n(r);}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.collapse"),f=n.extend({},t.DEFAULTS,u.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);!r&&f.toggle&&/show|hide/.test(i)&&(f.toggle=!1);r||u.data("bs.collapse",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.$trigger=n('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]');this.transitioning=null;this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger);this.options.toggle&&this.toggle();},u;t.VERSION="3.3.5";t.TRANSITION_DURATION=350;t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height";};t.prototype.show=function(){var f,r,e,u,o,s;if(!this.transitioning&&!this.$element.hasClass("in")&&(r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),!r||!r.length||(f=r.data("bs.collapse"),!f||!f.transitioning))&&(e=n.Event("show.bs.collapse"),this.$element.trigger(e),!e.isDefaultPrevented())){if(r&&r.length&&(i.call(r,"hide"),f||r.data("bs.collapse",null)),u=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[u](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,o=function o(){this.$element.removeClass("collapsing").addClass("collapse in")[u]("");this.transitioning=0;this.$element.trigger("shown.bs.collapse");},!n.support.transition)return o.call(this);s=n.camelCase(["scroll",u].join("-"));this.$element.one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[u](this.$element[0][s]);}};t.prototype.hide=function(){var r,i,u;if(!this.transitioning&&this.$element.hasClass("in")&&(r=n.Event("hide.bs.collapse"),this.$element.trigger(r),!r.isDefaultPrevented())){if(i=this.dimension(),this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,u=function u(){this.transitioning=0;this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse");},!n.support.transition)return u.call(this);this.$element[i](0).one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION);}};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]();};t.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,i){var u=n(i);this.addAriaAndCollapsedClass(r(u),u);},this)).end();};t.prototype.addAriaAndCollapsedClass=function(n,t){var i=n.hasClass("in");n.attr("aria-expanded",i);t.toggleClass("collapsed",!i).attr("aria-expanded",i);};u=n.fn.collapse;n.fn.collapse=i;n.fn.collapse.Constructor=t;n.fn.collapse.noConflict=function(){return n.fn.collapse=u,this;};n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var u=n(this);u.attr("data-target")||t.preventDefault();var f=r(u),e=f.data("bs.collapse"),o=e?"toggle":u.data();i.call(f,o);});}(jQuery);+function(n){"use strict";function r(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent();}function u(t){t&&t.which===3||(n(e).remove(),n(i).each(function(){var u=n(this),i=r(u),f={relatedTarget:this};i.hasClass("open")&&(t&&t.type=="click"&&/input|textarea/i.test(t.target.tagName)&&n.contains(i[0],t.target)||(i.trigger(t=n.Event("hide.bs.dropdown",f)),t.isDefaultPrevented())||(u.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",f)));}));}function o(i){return this.each(function(){var r=n(this),u=r.data("bs.dropdown");u||r.data("bs.dropdown",u=new t(this));typeof i=="string"&&u[i].call(r);});}var e=".dropdown-backdrop",i='[data-toggle="dropdown"]',t=function t(_t3){n(_t3).on("click.bs.dropdown",this.toggle);},f;t.VERSION="3.3.5";t.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=r(f),o=i.hasClass("open"),u(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",u);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true");i.toggleClass("open").trigger("shown.bs.dropdown",e);}return!1;}};t.prototype.keydown=function(t){var e,o,s,h,f,u;if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=r(e),s=o.hasClass("open"),!s&&t.which!=27||s&&t.which==27)return t.which==27&&o.find(i).trigger("focus"),e.trigger("click");(h=" li:not(.disabled):visible a",f=o.find(".dropdown-menu"+h),f.length)&&(u=f.index(t.target),t.which==38&&u>0&&u--,t.which==40&&u<f.length-1&&u++,~u||(u=0),f.eq(u).trigger("focus"));}};f=n.fn.dropdown;n.fn.dropdown=o;n.fn.dropdown.Constructor=t;n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this;};n(document).on("click.bs.dropdown.data-api",u).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation();}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown);}(jQuery);+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i);u||f.data("bs.modal",u=new t(this,e));typeof i=="string"?u[i](r):e.show&&u.show(r);});}var t=function t(_t4,i){this.options=i;this.$body=n(document.body);this.$element=n(_t4);this.$dialog=this.$element.find(".modal-dialog");this.$backdrop=null;this.isShown=null;this.originalBodyPad=null;this.scrollbarWidth=0;this.ignoreBackdropClick=!1;this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal");},this));},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=300;t.BACKDROP_TRANSITION_DURATION=150;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n);};t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});if(this.$element.trigger(u),!this.isShown&&!u.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.setScrollbar();this.$body.addClass("modal-open");this.escape();this.resize();this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0);});});this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body);r.$element.show().scrollTop(0);r.adjustDialog();f&&r.$element[0].offsetWidth;r.$element.addClass("in");r.enforceFocus();u=n.Event("shown.bs.modal",{relatedTarget:i});f?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u);}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u);});}};t.prototype.hide=function(i){(i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal());};t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus");},this));};t.prototype.escape=function(){if(this.isShown&&this.options.keyboard)this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){n.which==27&&this.hide();},this));else this.isShown||this.$element.off("keydown.dismiss.bs.modal");};t.prototype.resize=function(){if(this.isShown)n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this));else n(window).off("resize.bs.modal");};t.prototype.hideModal=function(){var n=this;this.$element.hide();this.backdrop(function(){n.$body.removeClass("modal-open");n.resetAdjustments();n.resetScrollbar();n.$element.trigger("hidden.bs.modal");});};t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null;};t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){r=n.support.transition&&f;this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+f).prependTo(this.$element);this.$backdrop.on("click.dismiss.bs.modal",n.proxy(function(n){if(this.ignoreBackdropClick){this.ignoreBackdropClick=!1;return;}n.target===n.currentTarget&&(this.options.backdrop=="static"?this.$element[0].focus():this.hide());},this));if(r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i();}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function u(){e.removeBackdrop();i&&i();},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i();};t.prototype.handleUpdate=function(){this.adjustDialog();};t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""});};t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""});};t.prototype.checkScrollbar=function(){var n=window.innerWidth,t;n||(t=document.documentElement.getBoundingClientRect(),n=t.right-Math.abs(t.left));this.bodyIsOverflowing=document.body.clientWidth<n;this.scrollbarWidth=this.measureScrollbar();};t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth);};t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad);};t.prototype.measureScrollbar=function(){var n=document.createElement("div"),t;return n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t;};r=n.fn.modal;n.fn.modal=i;n.fn.modal.Constructor=t;n.fn.modal.noConflict=function(){return n.fn.modal=r,this;};n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault();u.one("show.bs.modal",function(n){if(!n.isDefaultPrevented())u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus");});});i.call(u,e,this);});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.tooltip",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t5){this.type=null;this.options=null;this.enabled=null;this.timeout=null;this.hoverState=null;this.$element=null;this.inState=null;this.init("tooltip",n,_t5);},i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}};t.prototype.init=function(t,i,r){var f,e,u,o,s;if(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(f=this.options.trigger.split(" "),e=f.length;e--;){if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this));}}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle();};t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t;};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r);}),t;};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusin"?"focus":"hover"]=!0),i.tip().hasClass("in")||i.hoverState=="in"){i.hoverState="in";return;}if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show();},i.options.delay.show);};t.prototype.isInStateTrue=function(){for(var n in this.inState){if(this.inState[n])return!0;}return!1;};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusout"?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide();},i.options.delay.hide);}};t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,e,w,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var u=this,r=this.tip(),a=this.getUID(this.type);this.setContent();r.attr("id",a);this.$element.attr("aria-describedby",a);this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top");r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this);this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);this.$element.trigger("inserted.bs."+this.type);var f=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;y&&(p=i,e=this.getPosition(this.$viewport),i=i=="bottom"&&f.bottom+s>e.bottom?"top":i=="top"&&f.top-s<e.top?"bottom":i=="right"&&f.right+o>e.width?"left":i=="left"&&f.left-o<e.left?"right":i,r.removeClass(p).addClass(i));w=this.getCalculatedOffset(i,f,o,s);this.applyPlacement(w,i);h=function h(){var n=u.hoverState;u.$element.trigger("shown.bs."+u.type);u.hoverState=null;n=="out"&&u.leave(u);};n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h();}};t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top+=o;t.left+=s;n.offset.setOffset(r[0],n.extend({using:function using(n){r.css({top:Math.round(n.top),left:Math.round(n.left)});}},t),0);r.addClass("in");h=r[0].offsetWidth;f=r[0].offsetHeight;i=="top"&&f!=e&&(t.top=t.top+e-f);u=this.getViewportAdjustedDelta(i,t,h,f);u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?u.left*2-l+h:u.top*2-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t);this.replaceArrow(a,r[0][v],c);};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","");};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right");};t.prototype.hide=function(i){function e(){u.hoverState!="in"&&r.detach();u.$element.removeAttr("aria-describedby").trigger("hidden.bs."+u.type);i&&i();}var u=this,r=n(this.$tip),f=n.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),this.hoverState=null,this;};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","");};t.prototype.hasContent=function(){return this.getTitle();};t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r=u.tagName=="BODY",i=u.getBoundingClientRect();i.width==null&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var f=r?{top:0,left:0}:t.offset(),e={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},i,e,o,f);};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width};};t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.right&&(f.left=u.left+u.width-c)),f):f;};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title);};t.prototype.getUID=function(n){do{n+=~~(Math.random()*1e6);}while(document.getElementById(n));return n;};t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),this.$tip.length!=1))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip;};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow");};t.prototype.enable=function(){this.enabled=!0;};t.prototype.disable=function(){this.enabled=!1;};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled;};t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)));t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i);};t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout);this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type);n.$tip&&n.$tip.detach();n.$tip=null;n.$arrow=null;n.$viewport=null;});};i=n.fn.tooltip;n.fn.tooltip=r;n.fn.tooltip.Constructor=t;n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this;};}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.popover",r=new t(this,f)),typeof i=="string"&&r[i]());});}var t=function t(n,_t6){this.init("popover",n,_t6);},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.5";t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'});t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype);t.prototype.constructor=t;t.prototype.getDefaults=function(){return t.DEFAULTS;};t.prototype.setContent=function(){var n=this.tip(),i=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](i);n.find(".popover-content").children().detach().end()[this.options.html?typeof t=="string"?"html":"append":"text"](t);n.removeClass("fade top bottom left right in");n.find(".popover-title").html()||n.find(".popover-title").hide();};t.prototype.hasContent=function(){return this.getTitle()||this.getContent();};t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content);};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow");};i=n.fn.popover;n.fn.popover=r;n.fn.popover.Constructor=t;n.fn.popover.noConflict=function(){return n.fn.popover=i,this;};}(jQuery);+function(n){"use strict";function t(i,r){this.$body=n(document.body);this.$scrollElement=n(i).is(document.body)?n(window):n(i);this.options=n.extend({},t.DEFAULTS,r);this.selector=(this.options.target||"")+" .nav li > a";this.offsets=[];this.targets=[];this.activeTarget=null;this.scrollHeight=0;this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this));this.refresh();this.process();}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.scrollspy",r=new t(this,f));typeof i=="string"&&r[i]();});}t.VERSION="3.3.5";t.DEFAULTS={offset:10};t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight);};t.prototype.refresh=function(){var t=this,i="offset",r=0;this.offsets=[];this.targets=[];this.scrollHeight=this.getScrollHeight();n.isWindow(this.$scrollElement[0])||(i="position",r=this.$scrollElement.scrollTop());this.$body.find(this.selector).map(function(){var f=n(this),u=f.data("target")||f.attr("href"),t=/^#./.test(u)&&n(u);return t&&t.length&&t.is(":visible")&&[[t[i]().top+r,u]]||null;}).sort(function(n,t){return n[0]-t[0];}).each(function(){t.offsets.push(this[0]);t.targets.push(this[1]);});};t.prototype.process=function(){var i=this.$scrollElement.scrollTop()+this.options.offset,f=this.getScrollHeight(),e=this.options.offset+f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget,n;if(this.scrollHeight!=f&&this.refresh(),i>=e)return u!=(n=r[r.length-1])&&this.activate(n);if(u&&i<t[0])return this.activeTarget=null,this.clear();for(n=t.length;n--;){u!=r[n]&&i>=t[n]&&(t[n+1]===undefined||i<t[n+1])&&this.activate(r[n]);}};t.prototype.activate=function(t){this.activeTarget=t;this.clear();var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active"));i.trigger("activate.bs.scrollspy");};t.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active");};var r=n.fn.scrollspy;n.fn.scrollspy=i;n.fn.scrollspy.Constructor=t;n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=r,this;};n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);i.call(t,t.data());});});}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this));typeof i=="string"&&r[i]();});}var t=function t(_t7){this.element=n(_t7);},u,i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.show=function(){var t=this.element,f=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),u;if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=f.find(".active:last a"),e=n.Event("hide.bs.tab",{relatedTarget:t[0]}),o=n.Event("show.bs.tab",{relatedTarget:r[0]});(r.trigger(e),t.trigger(o),o.isDefaultPrevented()||e.isDefaultPrevented())||(u=n(i),this.activate(t.closest("li"),f),this.activate(u,u.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]});t.trigger({type:"shown.bs.tab",relatedTarget:r[0]});}));}};t.prototype.activate=function(i,r,u){function o(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1);i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0);e?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade");i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0);u&&u();}var f=r.find("> .active"),e=u&&n.support.transition&&(f.length&&f.hasClass("fade")||!!r.find("> .fade").length);f.length&&e?f.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o();f.removeClass("in");};u=n.fn.tab;n.fn.tab=r;n.fn.tab.Constructor=t;n.fn.tab.noConflict=function(){return n.fn.tab=u,this;};i=function i(t){t.preventDefault();r.call(n(this),"show");};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i);}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=(typeof i==="undefined"?"undefined":_typeof(i))=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]();});}var t=function t(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition();},r;t.VERSION="3.3.5";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1;};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n;};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1);};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if((typeof r==="undefined"?"undefined":_typeof(r))!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix");}i=="bottom"&&this.$element.offset({top:h-s-u});}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this;};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t);});});}(jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function($){function UTCDate(){return new Date(Date.UTC.apply(Date,arguments));}
function UTCToday(){var today=new Date();return UTCDate(today.getUTCFullYear(),today.getUTCMonth(),today.getUTCDate(),today.getUTCHours(),today.getUTCMinutes(),today.getUTCSeconds(),0);}
var extend={monthAbbreviation:false};var Datetimepicker=function Datetimepicker(element,options){var that=this;this.element=$(element);this.container=options.container||'body';this.language=options.language||this.element.data('date-language')||"en";this.language=this.language in dates?this.language:"en";this.isRTL=dates[this.language].rtl||false;if(options.monthAbbreviation){extend.monthAbbreviation=true;}
this.formatType=options.formatType||this.element.data('format-type')||'standard';this.format=DPGlobal.parseFormat(options.format||this.element.data('date-format')||dates[this.language].format||DPGlobal.getDefaultFormat(this.formatType,'input'),this.formatType);this.isInline=false;this.isVisible=false;this.isInput=this.element.is('input');this.bootcssVer=this.isInput?this.element.is('.form-control')?3:2:this.bootcssVer=this.element.is('.input-group')?3:2;this.component=this.element.is('.date')?this.bootcssVer==3?this.element.find('.input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar').parent():this.element.find('.add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar').parent():false;this.componentReset=this.element.is('.date')?this.bootcssVer==3?this.element.find('.input-group-addon .glyphicon-remove').parent():this.element.find('.add-on .icon-remove').parent():false;this.hasInput=this.component&&this.element.find('input').length;if(this.component&&this.component.length===0){this.component=false;}
this.linkField=options.linkField||this.element.data('link-field')||false;this.linkFormat=DPGlobal.parseFormat(options.linkFormat||this.element.data('link-format')||DPGlobal.getDefaultFormat(this.formatType,'link'),this.formatType);this.minuteStep=options.minuteStep||this.element.data('minute-step')||5;this.pickerPosition=options.pickerPosition||this.element.data('picker-position')||'bottom-right';this.showMeridian=options.showMeridian||this.element.data('show-meridian')||false;this.initialDate=options.initialDate||new Date();this._attachEvents();this.formatViewType="datetime";if('formatViewType'in options){this.formatViewType=options.formatViewType;}else if('formatViewType'in this.element.data()){this.formatViewType=this.element.data('formatViewType');}
this.minView=0;if('minView'in options){this.minView=options.minView;}else if('minView'in this.element.data()){this.minView=this.element.data('min-view');}
this.minView=DPGlobal.convertViewMode(this.minView);this.showWeek=options.showWeek,this.weeklyString=null,this.dataNOW=null,this.currentTR=null||false;if(this.showWeek){var oldVal=this.element.val();var oldDate=new Date(oldVal);var nowWeek=this.iso8601Week(oldDate);this.element.val(oldDate.getFullYear()+'-'+nowWeek+'-week');}
this.maxView=DPGlobal.modes.length-1;if('maxView'in options){this.maxView=options.maxView;}else if('maxView'in this.element.data()){this.maxView=this.element.data('max-view');}
this.maxView=DPGlobal.convertViewMode(this.maxView);this.wheelViewModeNavigation=false;if('wheelViewModeNavigation'in options){this.wheelViewModeNavigation=options.wheelViewModeNavigation;}else if('wheelViewModeNavigation'in this.element.data()){this.wheelViewModeNavigation=this.element.data('view-mode-wheel-navigation');}
this.wheelViewModeNavigationInverseDirection=false;if('wheelViewModeNavigationInverseDirection'in options){this.wheelViewModeNavigationInverseDirection=options.wheelViewModeNavigationInverseDirection;}else if('wheelViewModeNavigationInverseDirection'in this.element.data()){this.wheelViewModeNavigationInverseDirection=this.element.data('view-mode-wheel-navigation-inverse-dir');}
this.wheelViewModeNavigationDelay=100;if('wheelViewModeNavigationDelay'in options){this.wheelViewModeNavigationDelay=options.wheelViewModeNavigationDelay;}else if('wheelViewModeNavigationDelay'in this.element.data()){this.wheelViewModeNavigationDelay=this.element.data('view-mode-wheel-navigation-delay');}
this.startViewMode=2;if('startView'in options){this.startViewMode=options.startView;}else if('startView'in this.element.data()){this.startViewMode=this.element.data('start-view');}
this.startViewMode=DPGlobal.convertViewMode(this.startViewMode);this.viewMode=this.startViewMode;this.viewSelect=this.minView;if('viewSelect'in options){this.viewSelect=options.viewSelect;}else if('viewSelect'in this.element.data()){this.viewSelect=this.element.data('view-select');}
this.viewSelect=DPGlobal.convertViewMode(this.viewSelect);this.forceParse=true;if('forceParse'in options){this.forceParse=options.forceParse;}else if('dateForceParse'in this.element.data()){this.forceParse=this.element.data('date-force-parse');}
this.picker=$(this.bootcssVer==3?DPGlobal.templateV3:DPGlobal.template).appendTo(this.isInline?this.element:this.container).on({click:$.proxy(this.click,this),mousedown:$.proxy(this.mousedown,this)});if(this.wheelViewModeNavigation){if($.fn.mousewheel){this.picker.on({mousewheel:$.proxy(this.mousewheel,this)});}else{console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option");}}
if(this.isInline){this.picker.addClass('datetimepicker-inline');}else{this.picker.addClass('datetimepicker-dropdown-'+this.pickerPosition+' dropdown-menu');}
if(this.isRTL){this.picker.addClass('datetimepicker-rtl');if(this.bootcssVer==3){this.picker.find('.prev span, .next span').toggleClass('glyphicon-arrow-left glyphicon-arrow-right');}else{this.picker.find('.prev i, .next i').toggleClass('icon-arrow-left icon-arrow-right');};}
$(document).on('mousedown',function(e){if($(e.target).closest('.datetimepicker').length===0){that.hide();}});this.autoclose=false;if('autoclose'in options){this.autoclose=options.autoclose;}else if('dateAutoclose'in this.element.data()){this.autoclose=this.element.data('date-autoclose');}
this.keyboardNavigation=true;if('keyboardNavigation'in options){this.keyboardNavigation=options.keyboardNavigation;}else if('dateKeyboardNavigation'in this.element.data()){this.keyboardNavigation=this.element.data('date-keyboard-navigation');}
this.todayBtn=options.todayBtn||this.element.data('date-today-btn')||false;this.todayHighlight=options.todayHighlight||this.element.data('date-today-highlight')||false;this.weekStart=(options.weekStart||this.element.data('date-weekstart')||dates[this.language].weekStart||0)%7;this.weekEnd=(this.weekStart+6)%7;this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(options.startDate||this.element.data('date-startdate'));this.setEndDate(options.endDate||this.element.data('date-enddate'));this.setDaysOfWeekDisabled(options.daysOfWeekDisabled||this.element.data('date-days-of-week-disabled'));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show();}};Datetimepicker.prototype={constructor:Datetimepicker,_events:[],_attachEvents:function _attachEvents(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}]];}else if(this.component&&this.hasInput){this._events=[[this.element.find('input'),{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}],[this.component,{click:$.proxy(this.show,this)}]];if(this.componentReset){this._events.push([this.componentReset,{click:$.proxy(this.reset,this)}]);}}else if(this.element.is('div')){this.isInline=true;}else{this._events=[[this.element,{click:$.proxy(this.show,this)}]];}
for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.on(ev);}},_detachEvents:function _detachEvents(){for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.off(ev);}
this._events=[];},show:function show(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();if(this.forceParse){this.update();}
this.place();$(window).on('resize',$.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault();}
this.isVisible=true;this.element.trigger({type:'show',date:this.date});},hide:function hide(e){if(!this.isVisible)return;if(this.isInline)return;this.picker.hide();$(window).off('resize',this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){$(document).off('mousedown',this.hide);}
if(this.forceParse&&(this.isInput&&this.showWeek?this.dataNOW:this.element.val()||this.hasInput&&this.showWeek?this.dataNOW:this.element.find('input').val()))this.setValue();this.isVisible=false;this.element.trigger({type:'hide',date:this.date});},remove:function remove(){this._detachEvents();this.picker.remove();delete this.picker;delete this.element.data().datetimepicker;},getDate:function getDate(){var d=this.getUTCDate();return new Date(d.getTime()+d.getTimezoneOffset()*60000);},getUTCDate:function getUTCDate(){return this.date;},setDate:function setDate(d){this.setUTCDate(new Date(d.getTime()-d.getTimezoneOffset()*60000));},setUTCDate:function setUTCDate(d){if(d>=this.startDate&&d<=this.endDate){this.date=d;this.setValue();this.viewDate=this.date;this.fill();}else{this.element.trigger({type:'outOfRange',date:d,startDate:this.startDate,endDate:this.endDate});}},setFormat:function setFormat(format){this.format=DPGlobal.parseFormat(format,this.formatType);var element;if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element&&element.val()){this.setValue();}},setValue:function setValue(){var formatted=this.getFormattedDate();if(this.showWeek){this.dataNOW=formatted;}
if(!this.isInput){if(this.component){if(this.showWeek){if(this.weeklyString){this.element.find('input').val(this.weeklyString);}}else{this.element.find('input').val(formatted);}}
this.element.data('date',formatted);}else{if(this.showWeek){this.element.val(this.weeklyString);}else{this.element.val(formatted);}}
if(this.linkField){$('#'+this.linkField).val(this.getFormattedDate(this.linkFormat));}},getFormattedDate:function getFormattedDate(format){if(format==undefined)format=this.format;return DPGlobal.formatDate(this.date,format,this.language,this.formatType);},setStartDate:function setStartDate(startDate){this.startDate=startDate||-Infinity;if(this.startDate!==-Infinity){this.startDate=DPGlobal.parseDate(this.startDate,this.format,this.language,this.formatType);}
this.update();this.updateNavArrows();},setEndDate:function setEndDate(endDate){this.endDate=endDate||Infinity;if(this.endDate!==Infinity){this.endDate=DPGlobal.parseDate(this.endDate,this.format,this.language,this.formatType);}
this.update();this.updateNavArrows();},setDaysOfWeekDisabled:function setDaysOfWeekDisabled(daysOfWeekDisabled){this.daysOfWeekDisabled=daysOfWeekDisabled||[];if(!$.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/);}
this.daysOfWeekDisabled=$.map(this.daysOfWeekDisabled,function(d){return parseInt(d,10);});this.update();this.updateNavArrows();},place:function place(){if(this.isInline)return;var index_highest=0;$('div').each(function(){var index_current=parseInt($(this).css("zIndex"),10);if(index_current>index_highest){index_highest=index_current;}});var zIndex=index_highest+10;var offset,top,left,containerOffset;if(this.container instanceof $){containerOffset=this.container.offset();}else{containerOffset=$(this.container).offset();}
if(this.component){offset=this.component.offset();left=offset.left;if(this.pickerPosition=='bottom-left'||this.pickerPosition=='top-left'){left+=this.component.outerWidth()-this.picker.outerWidth();}}else{offset=this.element.offset();left=offset.left;}
if(left+220>document.body.clientWidth){left=document.body.clientWidth-220;}
if(this.pickerPosition=='top-left'||this.pickerPosition=='top-right'){top=offset.top-this.picker.outerHeight();}else{top=offset.top+this.height;}
top=top-containerOffset.top;left=left-containerOffset.left;this.picker.css({top:top,left:left,zIndex:zIndex});},update:function update(){var date,fromArgs=false;if(arguments&&arguments.length&&(typeof arguments[0]==='string'||arguments[0]instanceof Date)){date=arguments[0];fromArgs=true;}else{date=(this.isInput?this.showWeek?this.dataNOW:this.element.val():this.showWeek?this.dataNOW:this.element.find('input').val())||this.element.data('date')||this.initialDate;if(typeof date=='string'||date instanceof String){date=date.replace(/^\s+|\s+$/g,'');}}
if(!date){date=new Date();fromArgs=false;}
this.date=DPGlobal.parseDate(new Date(date),this.format,this.language,this.formatType);if(fromArgs)this.setValue();if(this.date<this.startDate){this.viewDate=new Date(this.startDate);}else if(this.date>this.endDate){this.viewDate=new Date(this.endDate);}else{this.viewDate=new Date(this.date);}
this.fill();},fillDow:function fillDow(){var dowCnt=this.weekStart,html=this.showWeek?'<tr><th class="ui-week">WK</th>':html='<tr>';while(dowCnt<this.weekStart+7){html+='<th class="dow">'+dates[this.language].daysMin[dowCnt++%7]+'</th>';}
html+='</tr>';this.picker.find('.datetimepicker-days thead').append(html);},iso8601Week:function iso8601Week(date){var addOneDayDate=new Date(new Date(date).getTime()+24*60*60*1000);var time,checkDate=new Date(addOneDayDate.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1;},fillMonths:function fillMonths(){var html='',i=0;while(i<12){html+='<span class="month">'+dates[this.language].monthsShort[i++]+'</span>';}
this.picker.find('.datetimepicker-months td').html(html);},fill:function fill(){if(this.date==null||this.viewDate==null){return;}
var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth(),dayMonth=d.getUTCDate(),hours=d.getUTCHours(),minutes=d.getUTCMinutes(),startYear=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,startMonth=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,endYear=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,endMonth=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,currentDate=new UTCDate(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),today=new Date();this.picker.find('.datetimepicker-days thead th:eq(1)').text(dates[this.language].months[month]+' '+year);if(this.formatViewType=="time"){var hourConverted=hours%12?hours%12:12;var hoursDisplay=(hourConverted<10?'0':'')+hourConverted;var minutesDisplay=(minutes<10?'0':'')+minutes;var meridianDisplay=dates[this.language].meridiem[hours<12?0:1];this.picker.find('.datetimepicker-hours thead th:eq(1)').text(hoursDisplay+':'+minutesDisplay+' '+(meridianDisplay?meridianDisplay.toUpperCase():''));this.picker.find('.datetimepicker-minutes thead th:eq(1)').text(hoursDisplay+':'+minutesDisplay+' '+(meridianDisplay?meridianDisplay.toUpperCase():''));}else{this.picker.find('.datetimepicker-hours thead th:eq(1)').text(dayMonth+' '+dates[this.language].months[month]+' '+year);this.picker.find('.datetimepicker-minutes thead th:eq(1)').text(dayMonth+' '+dates[this.language].months[month]+' '+year);}
if(this.showWeek){this.picker.find('tfoot th.today').text(dates[this.language].week).toggle(this.todayBtn!==false);}else{this.picker.find('tfoot th.today').text(dates[this.language].today).toggle(this.todayBtn!==false);}
this.updateNavArrows();this.fillMonths();var prevMonth=UTCDate(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(),prevMonth.getUTCMonth());prevMonth.setUTCDate(day);prevMonth.setUTCDate(day-(prevMonth.getUTCDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setUTCDate(nextMonth.getUTCDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getUTCDay()==this.weekStart){this.showWeek?html.push('<tr class="ui-week-tr"><td class="ui-week-col">'+this.iso8601Week(new Date(prevMonth.valueOf()))+'</td>'):html.push('<tr>');}
clsName='';if(prevMonth.getUTCFullYear()<year||prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()<month){clsName+=' old';}else if(prevMonth.getUTCFullYear()>year||prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()>month){clsName+=' new';}
if(this.todayHighlight&&prevMonth.getUTCFullYear()==today.getFullYear()&&prevMonth.getUTCMonth()==today.getMonth()&&prevMonth.getUTCDate()==today.getDate()){clsName+=' today';}
if(prevMonth.valueOf()==currentDate){if(!this.showWeek){clsName+=' active';}}
if(prevMonth.valueOf()+86400000<=this.startDate||prevMonth.valueOf()>this.endDate||$.inArray(prevMonth.getUTCDay(),this.daysOfWeekDisabled)!==-1){clsName+=' disabled';}
html.push('<td class="day'+clsName+'">'+prevMonth.getUTCDate()+'</td>');if(prevMonth.getUTCDay()==this.weekEnd){html.push('</tr>');}
prevMonth.setUTCDate(prevMonth.getUTCDate()+1);}
this.picker.find('.datetimepicker-days tbody').empty().append(html.join(''));html=[];var txt='',meridian='',meridianOld='';for(var i=0;i<24;i++){var actual=UTCDate(year,month,dayMonth,i);clsName='';if(actual.valueOf()+3600000<=this.startDate||actual.valueOf()>this.endDate){clsName+=' disabled';}else if(hours==i){clsName+=' active';}
if(this.showMeridian&&dates[this.language].meridiem.length==2){meridian=i<12?dates[this.language].meridiem[0]:dates[this.language].meridiem[1];if(meridian!=meridianOld){if(meridianOld!=''){html.push('</fieldset>');}
html.push('<fieldset class="hour"><legend>'+meridian.toUpperCase()+'</legend>');}
meridianOld=meridian;txt=i%12?i%12:12;html.push('<span class="hour'+clsName+' hour_'+(i<12?'am':'pm')+'">'+txt+'</span>');if(i==23){html.push('</fieldset>');}}else{txt=i+':00';html.push('<span class="hour'+clsName+'">'+txt+'</span>');}}
this.picker.find('.datetimepicker-hours td').html(html.join(''));html=[];txt='',meridian='',meridianOld='';for(var i=0;i<60;i+=this.minuteStep){var actual=UTCDate(year,month,dayMonth,hours,i,0);clsName='';if(actual.valueOf()<this.startDate||actual.valueOf()>this.endDate){clsName+=' disabled';}else if(Math.floor(minutes/this.minuteStep)==Math.floor(i/this.minuteStep)){clsName+=' active';}
if(this.showMeridian&&dates[this.language].meridiem.length==2){meridian=hours<12?dates[this.language].meridiem[0]:dates[this.language].meridiem[1];if(meridian!=meridianOld){if(meridianOld!=''){html.push('</fieldset>');}
html.push('<fieldset class="minute"><legend>'+meridian.toUpperCase()+'</legend>');}
meridianOld=meridian;txt=hours%12?hours%12:12;html.push('<span class="minute'+clsName+'">'+txt+':'+(i<10?'0'+i:i)+'</span>');if(i==59){html.push('</fieldset>');}}else{txt=i+':00';html.push('<span class="minute'+clsName+'">'+hours+':'+(i<10?'0'+i:i)+'</span>');}}
this.picker.find('.datetimepicker-minutes td').html(html.join(''));var currentYear=this.date.getUTCFullYear();var months=this.picker.find('.datetimepicker-months').find('th:eq(1)').text(year).end().find('span.month').removeClass('active');if(currentYear==year){months.eq(this.date.getMonth()).addClass('active');}
if(year<startYear||year>endYear){months.addClass('disabled');}
if(year==startYear){months.slice(0,startMonth).addClass('disabled');}
if(year==endYear){months.slice(endMonth+1).addClass('disabled');}
html='';year=parseInt(year/10,10)*10;var yearCont=this.picker.find('.datetimepicker-years').find('th:eq(1)').text(year+'-'+(year+9)).end().find('td');year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i==-1||i==10?' old':'')+(currentYear==year?' active':'')+(year<startYear||year>endYear?' disabled':'')+'">'+year+'</span>';year+=1;}
yearCont.html(html);this.place();},updateNavArrows:function updateNavArrows(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth(),day=d.getUTCDate(),hour=d.getUTCHours();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()&&month<=this.startDate.getUTCMonth()&&day<=this.startDate.getUTCDate()&&hour<=this.startDate.getUTCHours()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()&&month>=this.endDate.getUTCMonth()&&day>=this.endDate.getUTCDate()&&hour>=this.endDate.getUTCHours()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;case 1:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()&&month<=this.startDate.getUTCMonth()&&day<=this.startDate.getUTCDate()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()&&month>=this.endDate.getUTCMonth()&&day>=this.endDate.getUTCDate()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;case 2:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()&&month<=this.startDate.getUTCMonth()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()&&month>=this.endDate.getUTCMonth()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;case 3:case 4:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()){this.picker.find('.prev').css({visibility:'hidden'});}else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()){this.picker.find('.next').css({visibility:'hidden'});}else{this.picker.find('.next').css({visibility:'visible'});}
break;}},mousewheel:function mousewheel(e){e.preventDefault();e.stopPropagation();if(this.wheelPause){return;}
this.wheelPause=true;var originalEvent=e.originalEvent;var delta=originalEvent.wheelDelta;var mode=delta>0?1:delta===0?0:-1;if(this.wheelViewModeNavigationInverseDirection){mode=-mode;}
this.showMode(mode);setTimeout($.proxy(function(){this.wheelPause=false;},this),this.wheelViewModeNavigationDelay);},click:function click(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest('span, td, th, legend');if(target.is('.glyphicon')){target=$(target).parent().closest('span, td, th, legend');}
if(target.length==1){if(target.is('.disabled')){this.element.trigger({type:'outOfRange',date:this.viewDate,startDate:this.startDate,endDate:this.endDate});return;}
switch(target[0].nodeName.toLowerCase()){case'th':switch(target[0].className){case'switch':this.showMode(1);break;case'prev':case'next':var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className=='prev'?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,dir);break;case 1:this.viewDate=this.moveDate(this.viewDate,dir);break;case 2:this.viewDate=this.moveMonth(this.viewDate,dir);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,dir);break;}
this.fill();this.element.trigger({type:target[0].className+':'+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case'today':var date=new Date();if(this.showWeek){var week=this.iso8601Week(date);this.weeklyString=date.getFullYear()+'-'+week+'-'+'week';}
date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),0);if(date<this.startDate)date=this.startDate;else if(date>this.endDate)date=this.endDate;this.viewMode=this.startViewMode;this.showMode(0);this._setDate(date);this.fill();if(this.autoclose){this.hide();}
if(this.showWeek){this.element.trigger({type:'goToToday',date:this.viewDate,week:week});this.picker.find('.datetimepicker-days').find('tr').removeClass('active');this.picker.find('.datetimepicker-days').find('td').each(function(){if($(this).text()==week){$(this).parent().addClass('active');}});}
break;}
break;case'span':if(!target.is('.disabled')){var year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth(),day=this.viewDate.getUTCDate(),hours=this.viewDate.getUTCHours(),minutes=this.viewDate.getUTCMinutes(),seconds=this.viewDate.getUTCSeconds();if(target.is('.month')){this.viewDate.setUTCDate(1);month=target.parent().find('span').index(target);day=this.viewDate.getUTCDate();this.viewDate.setUTCMonth(month);this.element.trigger({type:'changeMonth',date:this.viewDate});if(this.viewSelect>=3){this._setDate(UTCDate(year,month,day,hours,minutes,seconds,0));}}else if(target.is('.year')){this.viewDate.setUTCDate(1);year=parseInt(target.text(),10)||0;this.viewDate.setUTCFullYear(year);this.element.trigger({type:'changeYear',date:this.viewDate});if(this.viewSelect>=4){this._setDate(UTCDate(year,month,day,hours,minutes,seconds,0));}}else if(target.is('.hour')){hours=parseInt(target.text(),10)||0;if(target.hasClass('hour_am')||target.hasClass('hour_pm')){if(hours==12&&target.hasClass('hour_am')){hours=0;}else if(hours!=12&&target.hasClass('hour_pm')){hours+=12;}}
this.viewDate.setUTCHours(hours);this.element.trigger({type:'changeHour',date:this.viewDate});if(this.viewSelect>=1){this._setDate(UTCDate(year,month,day,hours,minutes,seconds,0));}}else if(target.is('.minute')){minutes=parseInt(target.text().substr(target.text().indexOf(':')+1),10)||0;this.viewDate.setUTCMinutes(minutes);this.element.trigger({type:'changeMinute',date:this.viewDate});if(this.viewSelect>=0){this._setDate(UTCDate(year,month,day,hours,minutes,seconds,0));}}
if(this.viewMode!=0){var oldViewMode=this.viewMode;this.showMode(-1);this.fill();if(oldViewMode==this.viewMode&&this.autoclose){this.hide();}}else{this.fill();if(this.autoclose){this.hide();}}}
break;case'td':if(target.is('.day')&&!target.is('.disabled')){var day=parseInt(target.text(),10)||1;var year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth(),hours=this.viewDate.getUTCHours(),minutes=this.viewDate.getUTCMinutes(),seconds=this.viewDate.getUTCSeconds();if(target.is('.old')){if(month===0){month=11;year-=1;}else{month-=1;}}else if(target.is('.new')){if(month==11){month=0;year+=1;}else{month+=1;}}
this.viewDate.setUTCFullYear(year);this.viewDate.setUTCMonth(month,day);this.currentTR=$(e.target).parent().index();if(this.showWeek){this.weeklyString=new Date(this.viewDate).getFullYear()+'-'+$(e.target).parent().find('td:first').text()+'-week';this.element.trigger({type:'changeDay',date:this.viewDate,week:$(e.target).parent().find('td:first').text(),target:e.target,weeklyString:this.weeklyString,currentTr:this.currentTR});}else{this.element.trigger({type:'changeDay',date:this.viewDate});}
if(this.viewSelect>=2){this._setDate(UTCDate(year,month,day,hours,minutes,seconds,0));}}
var oldViewMode=this.viewMode;this.showMode(-1);this.fill();if(oldViewMode==this.viewMode&&this.autoclose){this.hide();}
break;}}},_setDate:function _setDate(date,which){if(!which||which=='date')this.date=date;if(!which||which=='view')this.viewDate=date;this.fill();this.setValue();var element;if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element){element.change();if(this.autoclose&&(!which||which=='date')){}}
this.element.trigger({type:'changeDate',date:this.date});},moveMinute:function moveMinute(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf());new_date.setUTCMinutes(new_date.getUTCMinutes()+dir*this.minuteStep);return new_date;},moveHour:function moveHour(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf());new_date.setUTCHours(new_date.getUTCHours()+dir);return new_date;},moveDate:function moveDate(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf());new_date.setUTCDate(new_date.getUTCDate()+dir);return new_date;},moveMonth:function moveMonth(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf()),day=new_date.getUTCDate(),month=new_date.getUTCMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag==1){test=dir==-1?function(){return new_date.getUTCMonth()==month;}:function(){return new_date.getUTCMonth()!=new_month;};new_month=month+dir;new_date.setUTCMonth(new_month);if(new_month<0||new_month>11)new_month=(new_month+12)%12;}else{for(var i=0;i<mag;i++){new_date=this.moveMonth(new_date,dir);}
new_month=new_date.getUTCMonth();new_date.setUTCDate(day);test=function test(){return new_month!=new_date.getUTCMonth();};}
while(test()){new_date.setUTCDate(--day);new_date.setUTCMonth(new_month);}
return new_date;},moveYear:function moveYear(date,dir){return this.moveMonth(date,dir*12);},dateWithinRange:function dateWithinRange(date){return date>=this.startDate&&date<=this.endDate;},keydown:function keydown(e){if(this.picker.is(':not(:visible)')){if(e.keyCode==27)
this.show();return;}
var dateChanged=false,dir,day,month,newDate,newViewDate;switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;dir=e.keyCode==37?-1:1;viewMode=this.viewMode;if(e.ctrlKey){viewMode+=2;}else if(e.shiftKey){viewMode+=1;}
if(viewMode==4){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);}else if(viewMode==3){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);}else if(viewMode==2){newDate=this.moveDate(this.date,dir);newViewDate=this.moveDate(this.viewDate,dir);}else if(viewMode==1){newDate=this.moveHour(this.date,dir);newViewDate=this.moveHour(this.viewDate,dir);}else if(viewMode==0){newDate=this.moveMinute(this.date,dir);newViewDate=this.moveMinute(this.viewDate,dir);}
if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}
break;case 38:case 40:if(!this.keyboardNavigation)break;dir=e.keyCode==38?-1:1;viewMode=this.viewMode;if(e.ctrlKey){viewMode+=2;}else if(e.shiftKey){viewMode+=1;}
if(viewMode==4){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);}else if(viewMode==3){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);}else if(viewMode==2){newDate=this.moveDate(this.date,dir*7);newViewDate=this.moveDate(this.viewDate,dir*7);}else if(viewMode==1){if(this.showMeridian){newDate=this.moveHour(this.date,dir*6);newViewDate=this.moveHour(this.viewDate,dir*6);}else{newDate=this.moveHour(this.date,dir*4);newViewDate=this.moveHour(this.viewDate,dir*4);}}else if(viewMode==0){newDate=this.moveMinute(this.date,dir*4);newViewDate=this.moveMinute(this.viewDate,dir*4);}
if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}
break;case 13:if(this.viewMode!=0){var oldViewMode=this.viewMode;this.showMode(-1);this.fill();if(oldViewMode==this.viewMode&&this.autoclose){this.hide();}}else{this.fill();if(this.autoclose){this.hide();}}
e.preventDefault();break;case 9:this.hide();break;}
if(dateChanged){var element;if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element){element.change();}
this.element.trigger({type:'changeDate',date:this.date});}},showMode:function showMode(dir){if(dir){var newViewMode=Math.max(0,Math.min(DPGlobal.modes.length-1,this.viewMode+dir));if(newViewMode>=this.minView&&newViewMode<=this.maxView){this.element.trigger({type:'changeMode',date:this.viewDate,oldViewMode:this.viewMode,newViewMode:newViewMode});this.viewMode=newViewMode;}}
this.picker.find('>div').hide().filter('.datetimepicker-'+DPGlobal.modes[this.viewMode].clsName).css('display','block');this.updateNavArrows();},reset:function reset(e){this._setDate(null,'date');},convertViewModeText:function convertViewModeText(viewMode){switch(viewMode){case 4:return'decade';case 3:return'year';case 2:return'month';case 1:return'day';case 0:return'hour';}}};$.fn.datetimepicker=function(option){var args=Array.apply(null,arguments);args.shift();var internal_return;this.each(function(){var $this=$(this),data=$this.data('datetimepicker'),options=(typeof option==='undefined'?'undefined':_typeof(option))=='object'&&option;if(!data){$this.data('datetimepicker',data=new Datetimepicker(this,$.extend({},$.fn.datetimepicker.defaults,options)));}
if(typeof option=='string'&&typeof data[option]=='function'){internal_return=data[option].apply(data,args);if(internal_return!==undefined){return false;}}});if(internal_return!==undefined)return internal_return;else return this;};$.fn.datetimepicker.defaults={};$.fn.datetimepicker.Constructor=Datetimepicker;var dates=$.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today",week:"This Week"}};var DPGlobal={modes:[{clsName:'minutes',navFnc:'Hours',navStep:1},{clsName:'hours',navFnc:'Date',navStep:1},{clsName:'days',navFnc:'Month',navStep:1},{clsName:'months',navFnc:'FullYear',navStep:1},{clsName:'years',navFnc:'FullYear',navStep:10}],isLeapYear:function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0;},getDaysInMonth:function getDaysInMonth(year,month){return[31,DPGlobal.isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month];},getDefaultFormat:function getDefaultFormat(type,field){if(type=="standard"){if(field=='input')return'yyyy-mm-dd hh:ii';else return'yyyy-mm-dd hh:ii:ss';}else if(type=="php"){if(field=='input')return'Y-m-d H:i';else return'Y-m-d H:i:s';}else{throw new Error("Invalid format type.");}},validParts:function validParts(type){if(type=="standard"){return(/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g);}else if(type=="php"){return(/[dDjlNwzFmMnStyYaABgGhHis]/g);}else{throw new Error("Invalid format type.");}},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function parseFormat(format,type){var separators=format.replace(this.validParts(type),'\0').split('\0');parts=format.match(this.validParts(type));if(extend.monthAbbreviation){parts[0]=='MM'?parts[0]='M':'';}
if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};},parseDate:function parseDate(date,format,language,type){if(date instanceof Date){var dateUTC=new Date(date.valueOf()-date.getTimezoneOffset()*60000);dateUTC.setMilliseconds(0);return dateUTC;}
if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(date)){format=this.parseFormat('yyyy-mm-dd',type);}
if(/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(date)){format=this.parseFormat('yyyy-mm-dd hh:ii',type);}
if(/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(date)){format=this.parseFormat('yyyy-mm-dd hh:ii:ss',type);}
if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(date)){var part_re=/([-+]\d+)([dmwy])/,parts=date.match(/([-+]\d+)([dmwy])/g),part,dir;date=new Date();for(var i=0;i<parts.length;i++){part=part_re.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case'd':date.setUTCDate(date.getUTCDate()+dir);break;case'm':date=Datetimepicker.prototype.moveMonth.call(Datetimepicker.prototype,date,dir);break;case'w':date.setUTCDate(date.getUTCDate()+dir*7);break;case'y':date=Datetimepicker.prototype.moveYear.call(Datetimepicker.prototype,date,dir);break;}}
return UTCDate(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds(),0);}
var parts=date&&date.match(this.nonpunctuation)||[],date=new Date(0,0,0,0,0,0,0),parsed={},setters_order=['hh','h','ii','i','ss','s','yyyy','yy','M','MM','m','mm','D','DD','d','dd','H','HH','p','P'],setters_map={hh:function hh(d,v){return d.setUTCHours(v);},h:function h(d,v){return d.setUTCHours(v);},HH:function HH(d,v){return d.setUTCHours(v==12?0:v);},H:function H(d,v){return d.setUTCHours(v==12?0:v);},ii:function ii(d,v){return d.setUTCMinutes(v);},i:function i(d,v){return d.setUTCMinutes(v);},ss:function ss(d,v){return d.setUTCSeconds(v);},s:function s(d,v){return d.setUTCSeconds(v);},yyyy:function yyyy(d,v){return d.setUTCFullYear(v);},yy:function yy(d,v){return d.setUTCFullYear(2000+v);},m:function m(d,v){v-=1;while(v<0){v+=12;}v%=12;d.setUTCMonth(v);while(d.getUTCMonth()!=v){if(isNaN(d.getUTCMonth()))return d;else d.setUTCDate(d.getUTCDate()-1);}return d;},d:function d(_d,v){return _d.setUTCDate(v);},p:function p(d,v){return d.setUTCHours(v==1?d.getUTCHours()+12:d.getUTCHours());}},val,filtered,part;setters_map['M']=setters_map['MM']=setters_map['mm']=setters_map['m'];setters_map['dd']=setters_map['d'];setters_map['P']=setters_map['p'];date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds());if(parts.length==format.parts.length){for(var i=0,cnt=format.parts.length;i<cnt;i++){val=parseInt(parts[i],10);part=format.parts[i];if(isNaN(val)){switch(part){case'MM':filtered=$(dates[language].months).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p;});val=$.inArray(filtered[0],dates[language].months)+1;break;case'M':filtered=$(dates[language].monthsShort).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m.toLowerCase()==p.toLowerCase();});val=$.inArray(filtered[0],dates[language].monthsShort)+1;break;case'p':case'P':val=$.inArray(parts[i].toLowerCase(),dates[language].meridiem);break;}}
parsed[part]=val;}
for(var i=0,s;i<setters_order.length;i++){s=setters_order[i];if(s in parsed&&!isNaN(parsed[s]))setters_map[s](date,parsed[s]);}}
return date;},formatDate:function formatDate(date,format,language,type){if(date==null){return'';}
var val;if(type=='standard'){val={yy:date.getUTCFullYear().toString().substring(2),yyyy:date.getUTCFullYear(),m:date.getUTCMonth()+1,M:dates[language].monthsShort[date.getUTCMonth()],MM:dates[language].months[date.getUTCMonth()],d:date.getUTCDate(),D:dates[language].daysShort[date.getUTCDay()],DD:dates[language].days[date.getUTCDay()],p:dates[language].meridiem.length==2?dates[language].meridiem[date.getUTCHours()<12?0:1]:'',h:date.getUTCHours(),i:date.getUTCMinutes(),s:date.getUTCSeconds()};if(dates[language].meridiem.length==2){val.H=val.h%12==0?12:val.h%12;}else{val.H=val.h;}
val.HH=(val.H<10?'0':'')+val.H;val.P=val.p.toUpperCase();val.hh=(val.h<10?'0':'')+val.h;val.ii=(val.i<10?'0':'')+val.i;val.ss=(val.s<10?'0':'')+val.s;val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;}else if(type=='php'){val={y:date.getUTCFullYear().toString().substring(2),Y:date.getUTCFullYear(),F:dates[language].months[date.getUTCMonth()],M:dates[language].monthsShort[date.getUTCMonth()],n:date.getUTCMonth()+1,t:DPGlobal.getDaysInMonth(date.getUTCFullYear(),date.getUTCMonth()),j:date.getUTCDate(),l:dates[language].days[date.getUTCDay()],D:dates[language].daysShort[date.getUTCDay()],w:date.getUTCDay(),N:date.getUTCDay()==0?7:date.getUTCDay(),S:date.getUTCDate()%10<=dates[language].suffix.length?dates[language].suffix[date.getUTCDate()%10-1]:'',a:dates[language].meridiem.length==2?dates[language].meridiem[date.getUTCHours()<12?0:1]:'',g:date.getUTCHours()%12==0?12:date.getUTCHours()%12,G:date.getUTCHours(),i:date.getUTCMinutes(),s:date.getUTCSeconds()};val.m=(val.n<10?'0':'')+val.n;val.d=(val.j<10?'0':'')+val.j;val.A=val.a.toString().toUpperCase();val.h=(val.g<10?'0':'')+val.g;val.H=(val.G<10?'0':'')+val.G;val.i=(val.i<10?'0':'')+val.i;val.s=(val.s<10?'0':'')+val.s;}else{throw new Error("Invalid format type.");}
var date=[],seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<cnt;i++){if(seps.length){date.push(seps.shift());}
date.push(val[format.parts[i]]);}
if(seps.length){date.push(seps.shift());}
return date.join('');},convertViewMode:function convertViewMode(viewMode){switch(viewMode){case 4:case'decade':viewMode=4;break;case 3:case'year':viewMode=3;break;case 2:case'month':viewMode=2;break;case 1:case'day':viewMode=1;break;case 0:case'hour':viewMode=0;break;}
return viewMode;},headTemplate:'<thead>'+'<tr>'+'<th class="prev"><i class="icon-arrow-left"/></th>'+'<th colspan="5" class="switch"></th>'+'<th class="next"><i class="icon-arrow-right"/></th>'+'</tr>'+'</thead>',headTemplateV3:'<thead>'+'<tr>'+'<th class="prev"><span class="glyphicon glyphicon-arrow-left"></span> </th>'+'<th colspan="5" class="switch"></th>'+'<th class="next"><span class="glyphicon glyphicon-arrow-right"></span> </th>'+'</tr>'+'</thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};DPGlobal.template='<div class="datetimepicker">'+'<div class="datetimepicker-minutes">'+'<table class=" table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-hours">'+'<table class=" table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-days">'+'<table class=" table-condensed">'+DPGlobal.headTemplate+'<tbody></tbody>'+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-months">'+'<table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-years">'+'<table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'</div>';DPGlobal.templateV3='<div class="datetimepicker">'+'<div class="datetimepicker-minutes">'+'<table class=" table-condensed">'+DPGlobal.headTemplateV3+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-hours">'+'<table class=" table-condensed">'+DPGlobal.headTemplateV3+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-days">'+'<table class=" table-condensed">'+DPGlobal.headTemplateV3+'<tbody></tbody>'+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-months">'+'<table class="table-condensed">'+DPGlobal.headTemplateV3+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datetimepicker-years">'+'<table class="table-condensed">'+DPGlobal.headTemplateV3+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table>'+'</div>'+'</div>';$.fn.datetimepicker.DPGlobal=DPGlobal;$.fn.datetimepicker.noConflict=function(){$.fn.datetimepicker=old;return this;};$(document).on('focus.datetimepicker.data-api click.datetimepicker.data-api','[data-provide="datetimepicker"]',function(e){var $this=$(this);if($this.data('datetimepicker'))return;e.preventDefault();$this.datetimepicker('show');});$(function(){$('[data-provide="datetimepicker-inline"]').datetimepicker();});}(window.jQuery);var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(root,factory){if((typeof exports==='undefined'?'undefined':_typeof(exports))=='object')module.exports=factory();else if(typeof define=='function'&&define.amd)define(factory);else root.LoadingSpinner=factory();})(this,function(){"use strict";var prefixes=['webkit','Moz','ms','O'],animations={},useCssAnimations;function createEl(tag,prop){var el=document.createElement(tag||'div'),n;for(n in prop){el[n]=prop[n];}return el;}
function ins(parent){for(var i=1,n=arguments.length;i<n;i++){parent.appendChild(arguments[i]);}return parent;}
var sheet=function(){var el=createEl('style',{type:'text/css'});ins(document.getElementsByTagName('head')[0],el);return el.sheet||el.styleSheet;}();function addAnimation(alpha,trail,i,lines){var name=['opacity',trail,~~(alpha*100),i,lines].join('-'),start=0.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf('Animation')).toLowerCase(),pre=prefix&&'-'+prefix+'-'||'';if(!animations[name]){sheet.insertRule('@'+pre+'keyframes '+name+'{'+'0%{opacity:'+z+'}'+start+'%{opacity:'+alpha+'}'+(start+0.01)+'%{opacity:1}'+(start+trail)%100+'%{opacity:'+alpha+'}'+'100%{opacity:'+z+'}'+'}',sheet.cssRules.length);animations[name]=1;}
return name;}
function vendor(el,prop){var s=el.style,pp,i;prop=prop.charAt(0).toUpperCase()+prop.slice(1);for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop;if(s[pp]!==undefined)return pp;}
if(s[prop]!==undefined)return prop;}
function css(el,prop){for(var n in prop){el.style[vendor(el,n)||n]=prop[n];}return el;}
function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def){if(obj[n]===undefined)obj[n]=def[n];}}
return obj;}
function pos(el){var o={x:el.offsetLeft,y:el.offsetTop};while(el=el.offsetParent){o.x+=el.offsetLeft,o.y+=el.offsetTop;}return o;}
function getColor(color,idx){return typeof color=='string'?color:color[idx%color.length];}
var defaults={lines:12,length:10,width:5,radius:15,rotate:0,corners:1,color:'#000',direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:1001,className:'spinner',top:'50%',left:'50%',position:'absolute'};function LoadingSpinner(o){this.opts=merge(o||{},LoadingSpinner.defaults,defaults);}
LoadingSpinner.defaults={};merge(LoadingSpinner.prototype,{spin:function spin(target){this.stop();this.opts.target=target;var divMask=document.createElement("div");divMask.className="spinnerMask";divMask.style.width=target.width;divMask.style.height=target.height;target.appendChild(divMask);this.divMask=divMask;var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width;css(el,{left:o.left,top:o.top});if(target){target.insertBefore(el,target.firstChild||null);}
el.setAttribute('role','progressbar');self.lines(el,self.opts);if(!useCssAnimations){var i=0,start=(o.lines-1)*(1-o.direction)/2,alpha,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var j=0;j<o.lines;j++){alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity);self.opacity(el,j*o.direction+start,alpha,o);}
self.timeout=self.el&&setTimeout(anim,~~(1000/fps));})();}
return self;},stop:function stop(){var el=this.el;if(el){clearTimeout(this.timeout);if(el.parentNode)el.parentNode.removeChild(el);this.el=undefined;if(this.divMask){if(this.divMask.parentNode)this.divMask.parentNode.removeChild(this.divMask);this.el=undefined;}}
return this;},lines:function lines(el,o){var i=0,start=(o.lines-1)*(1-o.direction)/2,seg;function fill(color,shadow){return css(createEl(),{position:'absolute',width:o.length+o.width+'px',height:o.width+'px',background:color,boxShadow:shadow,transformOrigin:'left',transform:'rotate('+~~(360/o.lines*i+o.rotate)+'deg) translate('+o.radius+'px'+',0)',borderRadius:(o.corners*o.width>>1)+'px'});}
for(;i<o.lines;i++){seg=css(createEl(),{position:'absolute',top:1+~(o.width/2)+'px',transform:o.hwaccel?'translate3d(0,0,0)':'',opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+' '+1/o.speed+'s linear infinite'});if(o.shadow)ins(seg,css(fill('#000','0 0 4px '+'#000'),{top:2+'px'}));ins(el,ins(seg,fill(getColor(o.color,i),'0 0 1px rgba(0,0,0,.1)')));}
return el;},opacity:function opacity(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val;}});function initVML(){function vml(tag,attr){return createEl('<'+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr);}
sheet.addRule('.spin-vml','behavior:url(#default#VML)');LoadingSpinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r;function grp(){return css(vml('group',{coordsize:s+' '+s,coordorigin:-r+' '+-r}),{width:s,height:s});}
var margin=-(o.width+o.length)*2+'px',g=css(grp(),{position:'absolute',top:margin,left:margin}),i;function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+'deg',left:~~dx}),ins(css(vml('roundrect',{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml('fill',{color:getColor(o.color,i),opacity:o.opacity}),vml('stroke',{opacity:0}))));}
if(o.shadow)for(i=1;i<=o.lines;i++){seg(i,-2,'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)');}for(i=1;i<=o.lines;i++){seg(i);}return ins(el,g);};LoadingSpinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0;if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild;if(c)c.opacity=val;}};}
var probe=css(createEl('group'),{behavior:'url(#default#VML)'});if(!vendor(probe,'transform')&&probe.adj)initVML();else useCssAnimations=vendor(probe,'animation');return LoadingSpinner;});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};!function(t,e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))?exports.echarts=e():t.echarts=e();}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports;}var i={};return e.m=t,e.c=i,e.p="",e(0);}([function(t,e,i){t.exports=i(1),i(99),i(134),i(139),i(148),i(152),i(162),i(183),i(195),i(216),i(220),i(224),i(239),i(245),i(252),i(258),i(262),i(270),i(112),i(274),i(280),i(284),i(295),i(225),i(298),i(304),i(316),i(317),i(331),i(346),i(352),i(355),i(358),i(367),i(380);},function(t,e,i){function n(t){return function(e,i,n){e=e&&e.toLowerCase(),z.prototype[t].call(this,e,i,n);};}function r(){z.call(this);}function o(t,e,i){function n(t,e){return t.prio-e.prio;}i=i||{},"string"==typeof e&&(e=et[e]),this.id,this.group,this._dom=t,this._zr=D.init(t,{renderer:i.renderer||"canvas",devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height}),this._theme=P.clone(e),this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._api=new b(this),this._coordSysMgr=new w(),z.call(this),this._messageCenter=new r(),this._initEvents(),this.resize=P.bind(this.resize,this),this._pendingActions=[],O(tt,n),O(K,n),this._zr.animation.on("frame",this._onframe,this),window._echartDomZoom=function o(t){var e=$(t).parent();return e.length<1?1:$(t).css("zoom")*o(e);}(t);}function a(t,e,i){var n,r=this._model,o=this._coordSysMgr.getCoordinateSystems();e=C.parseFinder(r,e);for(var a=0;a<o.length;a++){var s=o[a];if(s[t]&&null!=(n=s[t](r,e,i)))return n;}console.warn("No coordinate system that supports "+t+" found by the given finder.");}function s(t,e){var i=this._model;i&&i.eachComponent({mainType:"series",query:e},function(n,r){var o=this._chartsMap[n.__viewId];o&&o.__alive&&o[t](n,i,this._api,e);},this);}function l(t,e,i){var n=this._api;E(this._componentsViews,function(r){var o=r.__model;r[t](o,e,n,i),v(o,r);},this),e.eachSeries(function(r,o){var a=this._chartsMap[r.__viewId];a[t](r,e,n,i),v(r,a),m(r,a);},this),g(this._zr,e);}function u(t,e){for(var i="component"===t,n=i?this._componentsViews:this._chartsViews,r=i?this._componentsMap:this._chartsMap,o=this._zr,a=0;a<n.length;a++){n[a].__alive=!1;}e[i?"eachComponent":"eachSeries"](function(t,a){if(i){if("series"===t)return;}else a=t;var s=a.id+"_"+a.type,l=r[s];if(!l){var u=M.parseClassType(a.type),h=i?T.getClass(u.main,u.sub):A.getClass(u.sub);if(!h)return;l=new h(),l.init(e,this._api),r[s]=l,n.push(l),o.add(l.group);}a.__viewId=s,l.__alive=!0,l.__id=s,l.__model=a;},this);for(var a=0;a<n.length;){var s=n[a];s.__alive?a++:(o.remove(s.group),s.dispose(e,this._api),n.splice(a,1),delete r[s.__id]);}}function h(t,e){E(K,function(i){i.func(t,e);});}function c(t){var e={};t.eachSeries(function(t){var i=t.get("stack"),n=t.getData();if(i&&"list"===n.type){var r=e[i];r&&(n.stackedOn=r),e[i]=n;}});}function d(t,e){var i=this._api;E(tt,function(n){n.isLayout&&n.func(t,i,e);});}function f(t,e){var i=this._api;t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette();}),E(tt,function(n){n.func(t,i,e);});}function p(t,e){var i=this._api;E(this._componentsViews,function(n){var r=n.__model;n.render(r,t,i,e),v(r,n);},this),E(this._chartsViews,function(t){t.__alive=!1;},this),t.eachSeries(function(n,r){var o=this._chartsMap[n.__viewId];o.__alive=!0,o.render(n,t,i,e),o.group.silent=!!n.get("silent"),v(n,o),m(n,o);},this),g(this._zr,t),E(this._chartsViews,function(e){e.__alive||e.remove(t,i);},this);}function g(t,e){var i=t.storage,n=0;i.traverse(function(t){t.isGroup||n++;}),n>e.get("hoverLayerThreshold")&&!x.node&&i.traverse(function(t){t.isGroup||(t.useHoverLayer=!0);});}function m(t,e){var i=0;e.group.traverse(function(t){"group"===t.type||t.ignore||i++;});var n=+t.get("progressive"),r=i>t.get("progressiveThreshold")&&n&&!x.node;r&&e.group.traverse(function(t){t.isGroup||(t.progressive=r?Math.floor(i++/n):-1,r&&t.stopAnimation(!0));});var o=t.get("blendMode")||null;!x.canvasSupported&&o&&"source-over"!==o&&console.warn("Only canvas support blendMode"),e.group.traverse(function(t){t.isGroup||t.setStyle("blend",o);});}function v(t,e){var i=t.get("z"),n=t.get("zlevel");e.group.traverse(function(t){"group"!==t.type&&(null!=i&&(t.z=i),null!=n&&(t.zlevel=n));});}function y(t){function e(t,e){for(var i=0;i<t.length;i++){var n=t[i];n[o]=e;}}var i=0,n=1,r=2,o="__connectUpdateStatus";P.each(Q,function(a,s){t._messageCenter.on(s,function(a){if(rt[t.group]&&t[o]!==i){var s=t.makeActionFromEvent(a),l=[];P.each(nt,function(e){e!==t&&e.group===t.group&&l.push(e);}),e(l,i),E(l,function(t){t[o]!==n&&t.dispatchAction(s);}),e(l,r);}});});}var x=i(2),_=i(3),b=i(25),w=i(26),S=i(27),M=i(19),I=i(28),T=i(29),A=i(42),L=i(43),C=i(5),D=i(81),P=i(4),k=i(39),z=i(33),O=i(85),E=P.each,R=1e3,N=5e3,V=1e3,B=2e3,G=3e3,F=4e3,H=5e3,W="__flag_in_main_process",Z="_hasGradientOrPatternBg",q="_optionUpdated";r.prototype.on=n("on"),r.prototype.off=n("off"),r.prototype.one=n("one"),P.mixin(r,z);var U=o.prototype;U._onframe=function(){this[q]&&(this[W]=!0,j.prepareAndUpdate.call(this),this[W]=!1,this[q]=!1);},U.getDom=function(){return this._dom;},U.getZr=function(){return this._zr;},U.setOption=function(t,e,i){if(P.assert(!this[W],"`setOption` should not be called during main process."),this[W]=!0,!this._model||e){var n=new S(this._api),r=this._theme,o=this._model=new _(null,null,r,n);o.init(null,null,r,n);}this._model.setOption(t,J),i?this[q]=!0:(j.prepareAndUpdate.call(this),this._zr.refreshImmediately(),this[q]=!1),this[W]=!1,this._flushPendingActions();},U.setTheme=function(){console.log("ECharts#setTheme() is DEPRECATED in ECharts 3.0");},U.getModel=function(){return this._model;},U.getOption=function(){return this._model&&this._model.getOption();},U.getWidth=function(){return this._zr.getWidth();},U.getHeight=function(){return this._zr.getHeight();},U.getRenderedCanvas=function(t){if(x.canvasSupported){t=t||{},t.pixelRatio=t.pixelRatio||1,t.backgroundColor=t.backgroundColor||this._model.get("backgroundColor");var e=this._zr,i=e.storage.getDisplayList();return P.each(i,function(t){t.stopAnimation(!0);}),e.painter.getRenderedCanvas(t);}},U.getDataURL=function(t){t=t||{};var e=t.excludeComponents,i=this._model,n=[],r=this;E(e,function(t){i.eachComponent({mainType:t},function(t){var e=r._componentsMap[t.__viewId];e.group.ignore||(n.push(e),e.group.ignore=!0);});});var o=this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return E(n,function(t){t.group.ignore=!1;}),o;},U.getConnectedDataURL=function(t){if(x.canvasSupported){var e=this.group,i=Math.min,n=Math.max,r=1/0;if(rt[e]){var o=r,a=r,s=-r,l=-r,u=[],h=t&&t.pixelRatio||1;P.each(nt,function(r,h){if(r.group===e){var c=r.getRenderedCanvas(P.clone(t)),d=r.getDom().getBoundingClientRect();o=i(d.left,o),a=i(d.top,a),s=n(d.right,s),l=n(d.bottom,l),u.push({dom:c,left:d.left,top:d.top});}}),o*=h,a*=h,s*=h,l*=h;var c=s-o,d=l-a,f=P.createCanvas();f.width=c,f.height=d;var p=D.init(f);return E(u,function(t){var e=new L.Image({style:{x:t.left*h-o,y:t.top*h-a,image:t.dom}});p.add(e);}),p.refreshImmediately(),f.toDataURL("image/"+(t&&t.type||"png"));}return this.getDataURL(t);}},U.convertToPixel=P.curry(a,"convertToPixel"),U.convertFromPixel=P.curry(a,"convertFromPixel"),U.containPixel=function(t,e){var i,n=this._model;return t=C.parseFinder(n,t),P.each(t,function(t,n){n.indexOf("Models")>=0&&P.each(t,function(t){var r=t.coordinateSystem;if(r&&r.containPoint)i|=!!r.containPoint(e);else if("seriesModels"===n){var o=this._chartsMap[t.__viewId];o&&o.containPoint?i|=o.containPoint(e,t):console.warn(n+": "+(o?"The found component do not support containPoint.":"No view mapping to the found component."));}else console.warn(n+": containPoint is not supported");},this);},this),!!i;},U.getVisual=function(t,e){var i=this._model;t=C.parseFinder(i,t,{defaultMainType:"series"});var n=t.seriesModel;n||console.warn("There is no specified seires model");var r=n.getData(),o=t.hasOwnProperty("dataIndexInside")?t.dataIndexInside:t.hasOwnProperty("dataIndex")?r.indexOfRawIndex(t.dataIndex):null;return null!=o?r.getItemVisual(o,e):r.getVisual(e);};var j={update:function update(t){var e=this._model,i=this._api,n=this._coordSysMgr,r=this._zr;if(e){e.restoreData(),n.create(this._model,this._api),h.call(this,e,i),c.call(this,e),n.update(e,i),f.call(this,e,t),p.call(this,e,t);var o=e.get("backgroundColor")||"transparent",a=r.painter;if(a.isSingleCanvas&&a.isSingleCanvas())r.configLayer(0,{clearColor:o});else{if(!x.canvasSupported){var s=k.parse(o);o=k.stringify(s,"rgb"),0===s[3]&&(o="transparent");}o.colorStops||o.image?(r.configLayer(0,{clearColor:o}),this[Z]=!0,this._dom.style.background="transparent"):(this[Z]&&r.configLayer(0,{clearColor:null}),this[Z]=!1,this._dom.style.background=o);}}},updateView:function updateView(t){var e=this._model;e&&(e.eachSeries(function(t){t.getData().clearAllVisual();}),f.call(this,e,t),l.call(this,"updateView",e,t));},updateVisual:function updateVisual(t){var e=this._model;e&&(e.eachSeries(function(t){t.getData().clearAllVisual();}),f.call(this,e,t),l.call(this,"updateVisual",e,t));},updateLayout:function updateLayout(t){var e=this._model;e&&(d.call(this,e,t),l.call(this,"updateLayout",e,t));},highlight:function highlight(t){s.call(this,"highlight",t);},downplay:function downplay(t){s.call(this,"downplay",t);},prepareAndUpdate:function prepareAndUpdate(t){var e=this._model;u.call(this,"component",e),u.call(this,"chart",e),j.update.call(this,t);}};U.resize=function(t){P.assert(!this[W],"`resize` should not be called during main process."),this[W]=!0,this._zr.resize(t);var e=this._model&&this._model.resetOption("media");j[e?"prepareAndUpdate":"update"].call(this),this._loadingFX&&this._loadingFX.resize(),this[W]=!1,this._flushPendingActions();},U.showLoading=function(t,e){if(P.isObject(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),!it[t])return void console.warn("Loading effects "+t+" not exists.");var i=it[t](this._api,e),n=this._zr;this._loadingFX=i,n.add(i);},U.hideLoading=function(){this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null;},U.makeActionFromEvent=function(t){var e=P.extend({},t);return e.type=Q[t.type],e;},U.dispatchAction=function(t,e){var i=Y[t.type];if(i){var n=i.actionInfo,r=n.update||"update";if(this[W])return void this._pendingActions.push(t);this[W]=!0;var o=[t],a=!1;t.batch&&(a=!0,o=P.map(t.batch,function(e){return e=P.defaults(P.extend({},e),t),e.batch=null,e;}));for(var s,l=[],u="highlight"===t.type||"downplay"===t.type,h=0;h<o.length;h++){var c=o[h];s=i.action(c,this._model),s=s||P.extend({},c),s.type=n.event||s.type,l.push(s),u&&j[r].call(this,c);}"none"===r||u||(this[q]?(j.prepareAndUpdate.call(this,t),this[q]=!1):j[r].call(this,t)),s=a?{type:n.event||t.type,batch:l}:l[0],this[W]=!1,!e&&this._messageCenter.trigger(s.type,s),this._flushPendingActions();}},U._flushPendingActions=function(){for(var t=this._pendingActions;t.length;){var e=t.shift();this.dispatchAction(e);}},U.on=n("on"),U.off=n("off"),U.one=n("one");var X=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];U._initEvents=function(){E(X,function(t){this._zr.on(t,function(e){var i,n=this.getModel(),r=e.target;if("globalout"===t)i={};else if(r&&null!=r.dataIndex){var o=r.dataModel||n.getSeriesByIndex(r.seriesIndex);i=o&&o.getDataParams(r.dataIndex,r.dataType)||{};}else r&&r.eventData&&(i=P.extend({},r.eventData));i&&(i.event=e,i.type=t,this.trigger(t,i));},this);},this),E(Q,function(t,e){this._messageCenter.on(e,function(t){this.trigger(e,t);},this);},this);},U.isDisposed=function(){return this._disposed;},U.clear=function(){this.setOption({series:[]},!0);},U.dispose=function(){if(this._disposed)return void console.warn("Instance "+this.id+" has been disposed");this._disposed=!0;var t=this._api,e=this._model;E(this._componentsViews,function(i){i.dispose(e,t);}),E(this._chartsViews,function(i){i.dispose(e,t);}),this._zr.dispose(),delete nt[this.id];},P.mixin(o,z);var Y=[],Q={},K=[],J=[],tt=[],et={},it={},nt={},rt={},ot=new Date()-0,at=new Date()-0,st="_echarts_instance_",lt={version:"3.3.1",dependencies:{zrender:"3.2.1"}};lt.init=function(t,e,i){if(D.version.replace(".","")-0<lt.dependencies.zrender.replace(".","")-0)throw new Error("ZRender "+D.version+" is too old for ECharts "+lt.version+". Current version need ZRender "+lt.dependencies.zrender+"+");if(!t)throw new Error("Initialize failed: invalid dom.");!P.isDom(t)||"CANVAS"===t.nodeName.toUpperCase()||t.clientWidth&&t.clientHeight||console.warn("Can't get dom width or height");var n=new o(t,e,i);return n.id="ec_"+ot++,nt[n.id]=n,t.setAttribute&&t.setAttribute(st,n.id),y(n),n;},lt.connect=function(t){if(P.isArray(t)){var e=t;t=null,P.each(e,function(e){null!=e.group&&(t=e.group);}),t=t||"g_"+at++,P.each(e,function(e){e.group=t;});}return rt[t]=!0,t;},lt.disConnect=function(t){rt[t]=!1;},lt.dispose=function(t){P.isDom(t)?t=lt.getInstanceByDom(t):"string"==typeof t&&(t=nt[t]),t instanceof o&&!t.isDisposed()&&t.dispose();},lt.getInstanceByDom=function(t){var e=t.getAttribute(st);return nt[e];},lt.getInstanceById=function(t){return nt[t];},lt.registerTheme=function(t,e){et[t]=e;},lt.registerPreprocessor=function(t){J.push(t);},lt.registerProcessor=function(t,e){if("function"==typeof t&&(e=t,t=R),isNaN(t))throw new Error("Unkown processor priority");K.push({prio:t,func:e});},lt.registerAction=function(t,e,i){"function"==typeof e&&(i=e,e="");var n=P.isObject(t)?t.type:[t,t={event:e}][0];t.event=(t.event||n).toLowerCase(),e=t.event,Y[n]||(Y[n]={action:i,actionInfo:t}),Q[e]=n;},lt.registerCoordinateSystem=function(t,e){w.register(t,e);},lt.registerLayout=function(t,e){if("function"==typeof t&&(e=t,t=V),isNaN(t))throw new Error("Unkown layout priority");tt.push({prio:t,func:e,isLayout:!0});},lt.registerVisual=function(t,e){if("function"==typeof t&&(e=t,t=G),isNaN(t))throw new Error("Unkown visual priority");tt.push({prio:t,func:e});},lt.registerLoading=function(t,e){it[t]=e;};var ut=M.parseClassType;lt.extendComponentModel=function(t,e){var i=M;if(e){var n=ut(e);i=M.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendComponentView=function(t,e){var i=T;if(e){var n=ut(e);i=T.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendSeriesModel=function(t,e){var i=I;if(e){e="series."+e.replace("series.","");var n=ut(e);i=I.getClass(n.main,n.sub,!0);}return i.extend(t);},lt.extendChartView=function(t,e){var i=A;if(e){e.replace("series.","");var n=ut(e);i=A.getClass(n.main,!0);}return i.extend(t);},lt.setCanvasCreator=function(t){P.createCanvas=t;},lt.registerVisual(B,i(93)),lt.registerPreprocessor(i(94)),lt.registerLoading("default",i(96)),lt.registerAction({type:"highlight",event:"highlight",update:"highlight"},P.noop),lt.registerAction({type:"downplay",event:"downplay",update:"downplay"},P.noop),lt.List=i(97),lt.Model=i(12),lt.graphic=i(43),lt.number=i(7),lt.format=i(6),lt.matrix=i(11),lt.vector=i(10),lt.color=i(39),lt.util={},E(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults"],function(t){lt.util[t]=P[t];}),lt.PRIORITY={PROCESSOR:{FILTER:R,STATISTIC:N},VISUAL:{LAYOUT:V,GLOBAL:B,CHART:G,COMPONENT:F,BRUSH:H}},t.exports=lt;},function(t,e){function i(t){var e={},i={},n=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge\/([\d.]+)/);return n&&(i.firefox=!0,i.version=n[1]),r&&(i.ie=!0,i.version=r[1]),o&&(i.edge=!0,i.version=o[1]),{browser:i,os:e,node:!1,canvasSupported:document.createElement("canvas").getContext?!0:!1,touchEventsSupported:"ontouchstart"in window&&!i.ie&&!i.edge,pointerEventsSupported:"onpointerdown"in window&&(i.edge||i.ie&&i.version>=10)};}var n={};n="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0}:i(navigator.userAgent),t.exports=n;},function(t,e,i){function n(t,e){c.each(e,function(e,i){_.hasClass(i)||("object"==(typeof e==="undefined"?"undefined":_typeof(e))?t[i]=t[i]?c.merge(t[i],e,!1):c.clone(e):null==t[i]&&(t[i]=e));});}function r(t){t=t,this.option={},this.option[w]=1,this._componentsMap={},this._seriesIndices=null,n(t,this._theme.option),c.merge(t,b,!1),this.mergeOption(t);}function o(t,e){c.isArray(e)||(e=e?[e]:[]);var i={};return p(e,function(e){i[e]=(t[e]||[]).slice();}),i;}function a(t,e){var i={};p(e,function(t,e){var n=t.exist;n&&(i[n.id]=t);}),p(e,function(e,n){var r=e.option;if(c.assert(!r||null==r.id||!i[r.id]||i[r.id]===e,"id duplicates: "+(r&&r.id)),r&&null!=r.id&&(i[r.id]=e),x(r)){var o=s(t,r,e.exist);e.keyInfo={mainType:t,subType:o};}}),p(e,function(t,e){var n=t.exist,r=t.option,o=t.keyInfo;if(x(r)){if(o.name=null!=r.name?r.name+"":n?n.name:"\x00-",n)o.id=n.id;else if(null!=r.id)o.id=r.id+"";else{var a=0;do{o.id="\x00"+o.name+"\x00"+a++;}while(i[o.id]);}i[o.id]=t;}});}function s(t,e,i){var n=e.type?e.type:i?i.subType:_.determineSubType(t,e);return n;}function l(t){return m(t,function(t){return t.componentIndex;})||[];}function u(t,e){return e.hasOwnProperty("subType")?g(t,function(t){return t.subType===e.subType;}):t;}function h(t){if(!t._seriesIndices)throw new Error("Series has not been initialized yet.");}var c=i(4),d=i(5),f=i(12),p=c.each,g=c.filter,m=c.map,v=c.isArray,y=c.indexOf,x=c.isObject,_=i(19),b=i(23),w="\x00_ec_inner",S=f.extend({constructor:S,init:function init(t,e,i,n){i=i||{},this.option=null,this._theme=new f(i),this._optionManager=n;},setOption:function setOption(t,e){c.assert(!(w in t),"please use chart.getOption()"),this._optionManager.setOption(t,e),this.resetOption();},resetOption:function resetOption(t){var e=!1,i=this._optionManager;if(!t||"recreate"===t){var n=i.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this.mergeOption(n)):r.call(this,n),e=!0;}if(("timeline"===t||"media"===t)&&this.restoreData(),!t||"recreate"===t||"timeline"===t){var o=i.getTimelineOption(this);o&&(this.mergeOption(o),e=!0);}if(!t||"recreate"===t||"media"===t){var a=i.getMediaOption(this,this._api);a.length&&p(a,function(t){this.mergeOption(t,e=!0);},this);}return e;},mergeOption:function mergeOption(t){function e(e,r){var s=d.normalizeToArray(t[e]),u=d.mappingToExists(n[e],s);a(e,u);var h=o(n,r);i[e]=[],n[e]=[],p(u,function(t,r){var o=t.exist,a=t.option;if(c.assert(x(a)||o,"Empty component definition"),a){var s=_.getClass(e,t.keyInfo.subType,!0);if(o&&o instanceof s)o.name=t.keyInfo.name,o.mergeOption(a,this),o.optionUpdated(a,!1);else{var l=c.extend({dependentModels:h,componentIndex:r},t.keyInfo);o=new s(a,this,this,l),c.extend(o,l),o.init(a,this,this,l),o.optionUpdated(null,!0);}}else o.mergeOption({},this),o.optionUpdated({},!1);n[e][r]=o,i[e][r]=o.option;},this),"series"===e&&(this._seriesIndices=l(n.series));}var i=this.option,n=this._componentsMap,r=[];p(t,function(t,e){null!=t&&(_.hasClass(e)?r.push(e):i[e]=null==i[e]?c.clone(t):c.merge(i[e],t,!0));}),_.topologicalTravel(r,_.getAllClassMainTypes(),e,this),this._seriesIndices=this._seriesIndices||[];},getOption:function getOption(){var t=c.clone(this.option);return p(t,function(e,i){if(_.hasClass(i)){for(var e=d.normalizeToArray(e),n=e.length-1;n>=0;n--){d.isIdInner(e[n])&&e.splice(n,1);}t[i]=e;}}),delete t[w],t;},getTheme:function getTheme(){return this._theme;},getComponent:function getComponent(t,e){var i=this._componentsMap[t];return i?i[e||0]:void 0;},queryComponents:function queryComponents(t){var e=t.mainType;if(!e)return[];var i=t.index,n=t.id,r=t.name,o=this._componentsMap[e];if(!o||!o.length)return[];var a;if(null!=i)v(i)||(i=[i]),a=g(m(i,function(t){return o[t];}),function(t){return!!t;});else if(null!=n){var s=v(n);a=g(o,function(t){return s&&y(n,t.id)>=0||!s&&t.id===n;});}else if(null!=r){var l=v(r);a=g(o,function(t){return l&&y(r,t.name)>=0||!l&&t.name===r;});}else a=o;return u(a,t);},findComponents:function findComponents(t){function e(t){var e=r+"Index",i=r+"Id",n=r+"Name";return t&&(t.hasOwnProperty(e)||t.hasOwnProperty(i)||t.hasOwnProperty(n))?{mainType:r,index:t[e],id:t[i],name:t[n]}:null;}function i(e){return t.filter?g(e,t.filter):e;}var n=t.query,r=t.mainType,o=e(n),a=o?this.queryComponents(o):this._componentsMap[r];return i(u(a,t));},eachComponent:function eachComponent(t,e,i){var n=this._componentsMap;if("function"==typeof t)i=e,e=t,p(n,function(t,n){p(t,function(t,r){e.call(i,n,t,r);});});else if(c.isString(t))p(n[t],e,i);else if(x(t)){var r=this.findComponents(t);p(r,e,i);}},getSeriesByName:function getSeriesByName(t){var e=this._componentsMap.series;return g(e,function(e){return e.name===t;});},getSeriesByIndex:function getSeriesByIndex(t){return this._componentsMap.series[t];},getSeriesByType:function getSeriesByType(t){var e=this._componentsMap.series;return g(e,function(e){return e.subType===t;});},getSeries:function getSeries(){return this._componentsMap.series.slice();},eachSeries:function eachSeries(t,e){h(this),p(this._seriesIndices,function(i){var n=this._componentsMap.series[i];t.call(e,n,i);},this);},eachRawSeries:function eachRawSeries(t,e){p(this._componentsMap.series,t,e);},eachSeriesByType:function eachSeriesByType(t,e,i){h(this),p(this._seriesIndices,function(n){var r=this._componentsMap.series[n];r.subType===t&&e.call(i,r,n);},this);},eachRawSeriesByType:function eachRawSeriesByType(t,e,i){return p(this.getSeriesByType(t),e,i);},isSeriesFiltered:function isSeriesFiltered(t){return h(this),c.indexOf(this._seriesIndices,t.componentIndex)<0;},filterSeries:function filterSeries(t,e){h(this);var i=g(this._componentsMap.series,t,e);this._seriesIndices=l(i);},restoreData:function restoreData(){var t=this._componentsMap;this._seriesIndices=l(t.series);var e=[];p(t,function(t,i){e.push(i);}),_.topologicalTravel(e,_.getAllClassMainTypes(),function(e,i){p(t[e],function(t){t.restoreData();});});}});c.mixin(S,i(24)),t.exports=S;},function(t,e){function i(t){if("object"==(typeof t==="undefined"?"undefined":_typeof(t))&&null!==t){var e=t;if(t instanceof Array){e=[];for(var n=0,r=t.length;r>n;n++){e[n]=i(t[n]);}}else if(!M(t)&&!I(t)){e={};for(var o in t){t.hasOwnProperty(o)&&(e[o]=i(t[o]));}}return e;}return t;}function n(t,e,r){if(!S(e)||!S(t))return r?i(e):t;for(var o in e){if(e.hasOwnProperty(o)){var a=t[o],s=e[o];!S(s)||!S(a)||_(s)||_(a)||I(s)||I(a)||M(s)||M(a)?!r&&o in t||(t[o]=i(e[o],!0)):n(a,s,r);}}return t;}function r(t,e){for(var i=t[0],r=1,o=t.length;o>r;r++){i=n(i,t[r],e);}return i;}function o(t,e){for(var i in e){e.hasOwnProperty(i)&&(t[i]=e[i]);}return t;}function a(t,e,i){for(var n in e){e.hasOwnProperty(n)&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n]);}return t;}function s(){return document.createElement("canvas");}function l(){return C||(C=V.createCanvas().getContext("2d")),C;}function u(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;i++){if(t[i]===e)return i;}}return-1;}function h(t,e){function i(){}var n=t.prototype;i.prototype=e.prototype,t.prototype=new i();for(var r in n){t.prototype[r]=n[r];}t.prototype.constructor=t,t.superClass=e;}function c(t,e,i){t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,a(t,e,i);}function d(t){return t?"string"==typeof t?!1:"number"==typeof t.length:void 0;}function f(t,e,i){if(t&&e)if(t.forEach&&t.forEach===z)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,r=t.length;r>n;n++){e.call(i,t[n],n,t);}else for(var o in t){t.hasOwnProperty(o)&&e.call(i,t[o],o,t);}}function p(t,e,i){if(t&&e){if(t.map&&t.map===R)return t.map(e,i);for(var n=[],r=0,o=t.length;o>r;r++){n.push(e.call(i,t[r],r,t));}return n;}}function g(t,e,i,n){if(t&&e){if(t.reduce&&t.reduce===N)return t.reduce(e,i,n);for(var r=0,o=t.length;o>r;r++){i=e.call(n,i,t[r],r,t);}return i;}}function m(t,e,i){if(t&&e){if(t.filter&&t.filter===O)return t.filter(e,i);for(var n=[],r=0,o=t.length;o>r;r++){e.call(i,t[r],r,t)&&n.push(t[r]);}return n;}}function v(t,e,i){if(t&&e)for(var n=0,r=t.length;r>n;n++){if(e.call(i,t[n],n,t))return t[n];}}function y(t,e){var i=E.call(arguments,2);return function(){return t.apply(e,i.concat(E.call(arguments)));};}function x(t){var e=E.call(arguments,1);return function(){return t.apply(this,e.concat(E.call(arguments)));};}function _(t){return"[object Array]"===P.call(t);}function b(t){return"function"==typeof t;}function w(t){return"[object String]"===P.call(t);}function S(t){var e=typeof t==="undefined"?"undefined":_typeof(t);return"function"===e||!!t&&"object"==e;}function M(t){return!!D[P.call(t)];}function I(t){return t&&1===t.nodeType&&"string"==typeof t.nodeName;}function T(t){for(var e=0,i=arguments.length;i>e;e++){if(null!=arguments[e])return arguments[e];}}function A(){return Function.call.apply(E,arguments);}function L(t,e){if(!t)throw new Error(e);}var C,D={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1},P=Object.prototype.toString,k=Array.prototype,z=k.forEach,O=k.filter,E=k.slice,R=k.map,N=k.reduce,V={inherits:h,mixin:c,clone:i,merge:n,mergeAll:r,extend:o,defaults:a,getContext:l,createCanvas:s,indexOf:u,slice:A,find:v,isArrayLike:d,each:f,map:p,reduce:g,filter:m,bind:y,curry:x,isArray:_,isString:w,isObject:S,isFunction:b,isBuildInObject:M,isDom:I,retrieve:T,assert:L,noop:function noop(){}};t.exports=V;},function(t,e,i){function n(t,e){return t&&t.hasOwnProperty(e);}var r=i(6),o=i(7),a=i(12),s=i(4),l={};l.normalizeToArray=function(t){return t instanceof Array?t:null==t?[]:[t];},l.defaultEmphasis=function(t,e){if(t){var i=t.emphasis=t.emphasis||{},n=t.normal=t.normal||{};s.each(e,function(t){var e=s.retrieve(i[t],n[t]);null!=e&&(i[t]=e);});}},l.LABEL_OPTIONS=["position","show","textStyle","distance","formatter"],l.getDataItemValue=function(t){return t&&(null==t.value?t:t.value);},l.isDataItemOption=function(t){return s.isObject(t)&&!(t instanceof Array);},l.converDataValue=function(t,e){var i=e&&e.type;return"ordinal"===i?t:("time"!==i||isFinite(t)||null==t||"-"===t||(t=+o.parseDate(t)),null==t||""===t?NaN:+t);},l.createDataFormatModel=function(t,e){var i=new a();return s.mixin(i,l.dataFormatMixin),i.seriesIndex=e.seriesIndex,i.name=e.name||"",i.mainType=e.mainType,i.subType=e.subType,i.getData=function(){return t;},i;},l.dataFormatMixin={getDataParams:function getDataParams(t,e){var i=this.getData(e),n=this.seriesIndex,r=this.name,o=this.getRawValue(t,e),a=i.getRawIndex(t),s=i.getName(t,!0),l=i.getRawDataItem(t);return{componentType:this.mainType,componentSubType:this.subType,seriesType:"series"===this.mainType?this.subType:null,seriesIndex:n,seriesName:r,name:s,dataIndex:a,data:l,dataType:e,value:o,color:i.getItemVisual(t,"color"),$vars:["seriesName","name","value"]};},getFormattedLabel:function getFormattedLabel(t,e,i,n){e=e||"normal";var o=this.getData(i),a=o.getItemModel(t),s=this.getDataParams(t,i);null!=n&&s.value instanceof Array&&(s.value=s.value[n]);var l=a.get(["label",e,"formatter"]);return"function"==typeof l?(s.status=e,l(s)):"string"==typeof l?r.formatTpl(l,s):void 0;},getRawValue:function getRawValue(t,e){var i=this.getData(e),n=i.getRawDataItem(t);return null!=n?!s.isObject(n)||n instanceof Array?n:n.value:void 0;},formatTooltip:s.noop},l.mappingToExists=function(t,e){e=(e||[]).slice();var i=s.map(t||[],function(t,e){return{exist:t};});return s.each(e,function(t,n){if(s.isObject(t)){for(var r=0;r<i.length;r++){if(!i[r].option&&null!=t.id&&i[r].exist.id===t.id+"")return i[r].option=t,void(e[n]=null);}for(var r=0;r<i.length;r++){var o=i[r].exist;if(!(i[r].option||null!=o.id&&null!=t.id||null==t.name||l.isIdInner(t)||l.isIdInner(o)||o.name!==t.name+""))return i[r].option=t,void(e[n]=null);}}}),s.each(e,function(t,e){if(s.isObject(t)){for(var n=0;n<i.length;n++){var r=i[n].exist;if(!i[n].option&&!l.isIdInner(r)&&null==t.id){i[n].option=t;break;}}n>=i.length&&i.push({option:t});}}),i;},l.isIdInner=function(t){return s.isObject(t)&&t.id&&0===(t.id+"").indexOf("\x00_ec_\x00");},l.compressBatches=function(t,e){function i(t,e,i){for(var n=0,r=t.length;r>n;n++){for(var o=t[n].seriesId,a=l.normalizeToArray(t[n].dataIndex),s=i&&i[o],u=0,h=a.length;h>u;u++){var c=a[u];s&&s[c]?s[c]=null:(e[o]||(e[o]={}))[c]=1;}}}function n(t,e){var i=[];for(var r in t){if(t.hasOwnProperty(r)&&null!=t[r])if(e)i.push(+r);else{var o=n(t[r],!0);o.length&&i.push({seriesId:r,dataIndex:o});}}return i;}var r={},o={};return i(t||[],r),i(e||[],o,r),[n(r),n(o)];},l.queryDataIndex=function(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?s.isArray(e.dataIndex)?s.map(e.dataIndex,function(e){return t.indexOfRawIndex(e);}):t.indexOfRawIndex(e.dataIndex):null!=e.name?s.isArray(e.name)?s.map(e.name,function(e){return t.indexOfName(e);}):t.indexOfName(e.name):void 0;},l.parseFinder=function(t,e,i){if(s.isString(e)){var r={};r[e+"Index"]=0,e=r;}var o=i&&i.defaultMainType;!o||n(e,o+"Index")||n(e,o+"Id")||n(e,o+"Name")||(e[o+"Index"]=0);var a={};return s.each(e,function(i,n){var i=e[n];if("dataIndex"===n||"dataIndexInside"===n)return void(a[n]=i);var r=n.match(/^(\w+)(Index|Id|Name)$/)||[],o=r[1],s=r[2];if(o&&s){var l={mainType:o};l[s.toLowerCase()]=i;var u=t.queryComponents(l);a[o+"Models"]=u,a[o+"Model"]=u[0];}}),a;},t.exports=l;},function(t,e,i){var n=i(4),r=i(7),o=i(8),a={};a.addCommas=function(t){return isNaN(t)?"-":(t=(t+"").split("."),t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:""));},a.toCamelCase=function(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase();});},a.normalizeCssArray=function(t){var e=t.length;return"number"==typeof t?[t,t,t,t]:2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t;},a.encodeHTML=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");};var s=["a","b","c","d","e","f","g"],l=function l(t,e){return"{"+t+(null==e?"":e)+"}";};a.formatTpl=function(t,e){n.isArray(e)||(e=[e]);var i=e.length;if(!i)return"";for(var r=e[0].$vars||[],o=0;o<r.length;o++){var a=s[o];t=t.replace(l(a),l(a,0));}for(var u=0;i>u;u++){for(var h=0;h<r.length;h++){t=t.replace(l(s[h],u),e[u][r[h]]);}}return t;};var u=function u(t){return 10>t?"0"+t:t;};a.formatTime=function(t,e){("week"===t||"month"===t||"quarter"===t||"half-year"===t||"year"===t)&&(t="MM-dd\nyyyy");var i=r.parseDate(e),n=i.getFullYear(),o=i.getMonth()+1,a=i.getDate(),s=i.getHours(),l=i.getMinutes(),h=i.getSeconds();return t=t.replace("MM",u(o)).toLowerCase().replace("yyyy",n).replace("yy",n%100).replace("dd",u(a)).replace("d",a).replace("hh",u(s)).replace("h",s).replace("mm",u(l)).replace("m",l).replace("ss",u(h)).replace("s",h);},a.capitalFirst=function(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t;},a.truncateText=o.truncateText,t.exports=a;},function(t,e){function i(t){return t.replace(/^\s+/,"").replace(/\s+$/,"");}var n={},r=1e-4;n.linearMap=function(t,e,i,n){var r=e[1]-e[0],o=i[1]-i[0];if(0===r)return 0===o?i[0]:(i[0]+i[1])/2;if(n){if(r>0){if(t<=e[0])return i[0];if(t>=e[1])return i[1];}else{if(t>=e[0])return i[0];if(t<=e[1])return i[1];}}else{if(t===e[0])return i[0];if(t===e[1])return i[1];}return(t-e[0])/r*o+i[0];},n.parsePercent=function(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%";}return"string"==typeof t?i(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t;},n.round=function(t,e){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),+(+t).toFixed(e);},n.asc=function(t){return t.sort(function(t,e){return t-e;}),t;},n.getPrecision=function(t){if(t=+t,isNaN(t))return 0;for(var e=1,i=0;Math.round(t*e)/e!==t;){e*=10,i++;}return i;},n.getPrecisionSafe=function(t){var e=t.toString(),i=e.indexOf(".");return 0>i?0:e.length-1-i;},n.getPixelPrecision=function(t,e){var i=Math.log,n=Math.LN10,r=Math.floor(i(t[1]-t[0])/n),o=Math.round(i(Math.abs(e[1]-e[0]))/n);return Math.max(-r+o,0);},n.MAX_SAFE_INTEGER=9007199254740991,n.remRadian=function(t){var e=2*Math.PI;return(t%e+e)%e;},n.isRadianAroundZero=function(t){return t>-r&&r>t;},n.parseDate=function(t){if(t instanceof Date)return t;if("string"==typeof t){var e=new Date(t);return isNaN(+e)&&(e=new Date(new Date(t.replace(/-/g,"/"))-new Date("1970/01/01"))),e;}return new Date(Math.round(t));},n.quantity=function(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10));},n.nice=function(t,e){var i,r=n.quantity(t),o=t/r;return i=e?1.5>o?1:2.5>o?2:4>o?3:7>o?5:10:1>o?1:2>o?2:3>o?3:5>o?5:10,i*r;},t.exports=n;},function(t,e,i){function n(t,e){var i=t+":"+e;if(l[i])return l[i];for(var n=(t+"").split("\n"),r=0,o=0,a=n.length;a>o;o++){r=Math.max(p.measureText(n[o],e).width,r);}return u>h&&(u=0,l={}),u++,l[i]=r,r;}function r(t,e,i,r){var o=((t||"")+"").split("\n").length,a=n(t,e),s=n("",e),l=o*s,u=new d(0,0,a,l);switch(u.lineHeight=s,r){case"bottom":case"alphabetic":u.y-=s;break;case"middle":u.y-=s/2;}switch(i){case"end":case"right":u.x-=u.width;break;case"center":u.x-=u.width/2;}return u;}function o(t,e,i,n){var r=e.x,o=e.y,a=e.height,s=e.width,l=i.height,u=a/2-l/2,h="left";switch(t){case"left":r-=n,o+=u,h="right";break;case"right":r+=n+s,o+=u,h="left";break;case"top":r+=s/2,o-=n+l,h="center";break;case"bottom":r+=s/2,o+=a+n,h="center";break;case"inside":r+=s/2,o+=u,h="center";break;case"insideLeft":r+=n,o+=u,h="left";break;case"insideRight":r+=s-n,o+=u,h="right";break;case"insideTop":r+=s/2,o+=n,h="center";break;case"insideBottom":r+=s/2,o+=a-l-n,h="center";break;case"insideTopLeft":r+=n,o+=n,h="left";break;case"insideTopRight":r+=s-n,o+=n,h="right";break;case"insideBottomLeft":r+=n,o+=a-l-n;break;case"insideBottomRight":r+=s-n,o+=a-l-n,h="right";}return{x:r,y:o,textAlign:h,textBaseline:"top"};}function a(t,e,i,r,o){if(!e)return"";o=o||{},r=f(r,"...");for(var a=f(o.maxIterations,2),l=f(o.minChar,0),u=n("",i),h=n("a",i),c=f(o.placeholder,""),d=e=Math.max(0,e-1),p=0;l>p&&d>=h;p++){d-=h;}var g=n(r);g>d&&(r="",g=0),d=e-g;for(var m=(t+"").split("\n"),p=0,v=m.length;v>p;p++){var y=m[p],x=n(y,i);if(!(e>=x)){for(var _=0;;_++){if(d>=x||_>=a){y+=r;break;}var b=0===_?s(y,d,h,u):x>0?Math.floor(y.length*d/x):0;y=y.substr(0,b),x=n(y,i);}""===y&&(y=c),m[p]=y;}}return m.join("\n");}function s(t,e,i,n){for(var r=0,o=0,a=t.length;a>o&&e>r;o++){var s=t.charCodeAt(o);r+=s>=0&&127>=s?i:n;}return o;}var l={},u=0,h=5e3,c=i(4),d=i(9),f=c.retrieve,p={getWidth:n,getBoundingRect:r,adjustTextPositionOnRect:o,truncateText:a,measureText:function measureText(t,e){var i=c.getContext();return i.font=e||"12px sans-serif",i.measureText(t);}};t.exports=p;},function(t,e,i){"use strict";function n(t,e,i,n){0>i&&(t+=i,i=-i),0>n&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n;}var r=i(10),o=i(11),a=r.applyTransform,s=Math.min,l=Math.abs,u=Math.max;n.prototype={constructor:n,union:function union(t){var e=s(t.x,this.x),i=s(t.y,this.y);this.width=u(t.x+t.width,this.x+this.width)-e,this.height=u(t.y+t.height,this.y+this.height)-i,this.x=e,this.y=i;},applyTransform:function(){var t=[],e=[];return function(i){i&&(t[0]=this.x,t[1]=this.y,e[0]=this.x+this.width,e[1]=this.y+this.height,a(t,t,i),a(e,e,i),this.x=s(t[0],e[0]),this.y=s(t[1],e[1]),this.width=l(e[0]-t[0]),this.height=l(e[1]-t[1]));};}(),calculateTransform:function calculateTransform(t){var e=this,i=t.width/e.width,n=t.height/e.height,r=o.create();return o.translate(r,r,[-e.x,-e.y]),o.scale(r,r,[i,n]),o.translate(r,r,[t.x,t.y]),r;},intersect:function intersect(t){t instanceof n||(t=n.create(t));var e=this,i=e.x,r=e.x+e.width,o=e.y,a=e.y+e.height,s=t.x,l=t.x+t.width,u=t.y,h=t.y+t.height;return!(s>r||i>l||u>a||o>h);},contain:function contain(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height;},clone:function clone(){return new n(this.x,this.y,this.width,this.height);},copy:function copy(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height;},plain:function plain(){return{x:this.x,y:this.y,width:this.width,height:this.height};}},n.create=function(t){return new n(t.x,t.y,t.width,t.height);},t.exports=n;},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array,n={create:function create(t,e){var n=new i(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n;},copy:function copy(t,e){return t[0]=e[0],t[1]=e[1],t;},clone:function clone(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e;},set:function set(t,e,i){return t[0]=e,t[1]=i,t;},add:function add(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t;},scaleAndAdd:function scaleAndAdd(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t;},sub:function sub(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t;},len:function len(t){return Math.sqrt(this.lenSquare(t));},lenSquare:function lenSquare(t){return t[0]*t[0]+t[1]*t[1];},mul:function mul(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t;},div:function div(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t;},dot:function dot(t,e){return t[0]*e[0]+t[1]*e[1];},scale:function scale(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t;},normalize:function normalize(t,e){var i=n.len(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t;},distance:function distance(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]));},distanceSquare:function distanceSquare(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]);},negate:function negate(t,e){return t[0]=-e[0],t[1]=-e[1],t;},lerp:function lerp(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t;},applyTransform:function applyTransform(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t;},min:function min(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t;},max:function max(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t;}};n.length=n.len,n.lengthSquare=n.lenSquare,n.dist=n.distance,n.distSquare=n.distanceSquare,t.exports=n;},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array,n={create:function create(){var t=new i(6);return n.identity(t),t;},identity:function identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t;},copy:function copy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t;},mul:function mul(t,e,i){var n=e[0]*i[0]+e[2]*i[1],r=e[1]*i[0]+e[3]*i[1],o=e[0]*i[2]+e[2]*i[3],a=e[1]*i[2]+e[3]*i[3],s=e[0]*i[4]+e[2]*i[5]+e[4],l=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t;},translate:function translate(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t;},rotate:function rotate(t,e,i){var n=e[0],r=e[2],o=e[4],a=e[1],s=e[3],l=e[5],u=Math.sin(i),h=Math.cos(i);return t[0]=n*h+a*u,t[1]=-n*u+a*h,t[2]=r*h+s*u,t[3]=-r*u+h*s,t[4]=h*o+u*l,t[5]=h*l-u*o,t;},scale:function scale(t,e,i){var n=i[0],r=i[1];return t[0]=e[0]*n,t[1]=e[1]*r,t[2]=e[2]*n,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*r,t;},invert:function invert(t,e){var i=e[0],n=e[2],r=e[4],o=e[1],a=e[3],s=e[5],l=i*a-o*n;return l?(l=1/l,t[0]=a*l,t[1]=-o*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*s-a*r)*l,t[5]=(o*r-i*s)*l,t):null;}};t.exports=n;},function(t,e,i){function n(t,e,i){this.parentModel=e,this.ecModel=i,this.option=t;}var r=i(4),o=i(13);n.prototype={constructor:n,init:null,mergeOption:function mergeOption(t){r.merge(this.option,t,!0);},get:function get(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var i=this.option,n=this.parentModel,r=0;r<t.length&&(!t[r]||(i=i&&"object"==(typeof i==="undefined"?"undefined":_typeof(i))?i[t[r]]:null,null!=i));r++){}return null==i&&n&&!e&&(i=n.get(t)),i;},getShallow:function getShallow(t,e){var i=this.option,n=null==i?i:i[t],r=this.parentModel;return null==n&&r&&!e&&(n=r.getShallow(t)),n;},getModel:function getModel(t,e){var i=this.get(t,!0),r=this.parentModel,o=new n(i,e||r&&r.getModel(t),this.ecModel);return o;},isEmpty:function isEmpty(){return null==this.option;},restoreData:function restoreData(){},clone:function clone(){var t=this.constructor;return new t(r.clone(this.option));},setReadOnly:function setReadOnly(t){o.setReadOnly(this,t);}},o.enableClassExtend(n);var a=r.mixin;a(n,i(14)),a(n,i(16)),a(n,i(17)),a(n,i(18)),t.exports=n;},function(t,e,i){function n(t,e){var i=o.slice(arguments,2);return this.superClass.prototype[e].apply(t,i);}function r(t,e,i){return this.superClass.prototype[e].apply(t,i);}var o=i(4),a={},s=".",l="___EC__COMPONENT__CONTAINER___",u=a.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split(s),e.main=t[0]||"",e.sub=t[1]||""),e;};a.enableClassExtend=function(t,e){t.$constructor=t,t.extend=function(t){o.each(e,function(e){t[e]||console.warn("Method `"+e+"` should be implemented"+(t.type?" in "+t.type:"")+".");});var i=this,a=function a(){t.$constructor?t.$constructor.apply(this,arguments):i.apply(this,arguments);};return o.extend(a.prototype,t),a.extend=this.extend,a.superCall=n,a.superApply=r,o.inherits(a,this),a.superClass=i,a;};},a.enableClassManagement=function(t,e){function i(t){var e=n[t.main];return e&&e[l]||(e=n[t.main]={},e[l]=!0),e;}e=e||{};var n={};if(t.registerClass=function(t,e){if(e)if(e=u(e),e.sub){if(e.sub!==l){var r=i(e);r[e.sub]=t;}}else n[e.main]&&console.warn(e.main+" exists."),n[e.main]=t;return t;},t.getClass=function(t,e,i){var r=n[t];if(r&&r[l]&&(r=e?r[e]:null),i&&!r)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return r;},t.getClassesByMainType=function(t){t=u(t);var e=[],i=n[t.main];return i&&i[l]?o.each(i,function(t,i){i!==l&&e.push(t);}):e.push(i),e;},t.hasClass=function(t){return t=u(t),!!n[t.main];},t.getAllClassMainTypes=function(){var t=[];return o.each(n,function(e,i){t.push(i);}),t;},t.hasSubTypes=function(t){t=u(t);var e=n[t.main];return e&&e[l];},t.parseClassType=u,e.registerWhenExtend){var r=t.extend;r&&(t.extend=function(e){var i=r.call(this,e);return t.registerClass(i,e.type);});}return t;},a.setReadOnly=function(t,e){},t.exports=a;},function(t,e,i){var n=i(15)([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);t.exports={getLineStyle:function getLineStyle(t){var e=n.call(this,t),i=this.getLineDash(e.lineWidth);return i&&(e.lineDash=i),e;},getLineDash:function getLineDash(t){null==t&&(t=1);var e=this.get("type"),i=Math.max(t,2),n=4*t;return"solid"===e||null==e?null:"dashed"===e?[n,n]:[i,i];}};},function(t,e,i){var n=i(4);t.exports=function(t){for(var e=0;e<t.length;e++){t[e][1]||(t[e][1]=t[e][0]);}return function(e){for(var i={},r=0;r<t.length;r++){var o=t[r][1];if(!(e&&n.indexOf(e,o)>=0)){var a=this.getShallow(o);null!=a&&(i[t[r][0]]=a);}}return i;};};},function(t,e,i){t.exports={getAreaStyle:i(15)([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]])};},function(t,e,i){function n(t,e){return t&&t.getShallow(e);}var r=i(8);t.exports={getTextColor:function getTextColor(){var t=this.ecModel;return this.getShallow("color")||t&&t.get("textStyle.color");},getFont:function getFont(){var t=this.ecModel,e=t&&t.getModel("textStyle");return[this.getShallow("fontStyle")||n(e,"fontStyle"),this.getShallow("fontWeight")||n(e,"fontWeight"),(this.getShallow("fontSize")||n(e,"fontSize")||12)+"px",this.getShallow("fontFamily")||n(e,"fontFamily")||"sans-serif"].join(" ");},getTextRect:function getTextRect(t){var e=this.get("textStyle")||{};return r.getBoundingRect(t,this.getFont(),e.align,e.baseline);},truncateText:function truncateText(t,e,i,n){return r.truncateText(t,e,this.getFont(),i,n);}};},function(t,e,i){var n=i(15)([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]);t.exports={getItemStyle:function getItemStyle(t){var e=n.call(this,t),i=this.getBorderLineDash();return i&&(e.lineDash=i),e;},getBorderLineDash:function getBorderLineDash(){var t=this.get("borderType");return"solid"===t||null==t?null:"dashed"===t?[5,5]:[1,1];}};},function(t,e,i){function n(t){var e=[];return o.each(h.getClassesByMainType(t),function(t){a.apply(e,t.prototype.dependencies||[]);}),o.map(e,function(t){return l.parseClassType(t).main;});}var r=i(12),o=i(4),a=Array.prototype.push,s=i(20),l=i(13),u=i(21),h=r.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function $constructor(t,e,i,n){r.call(this,t,e,i,n),this.uid=s.getUID("componentModel");},init:function init(t,e,i,n){this.mergeDefaultAndTheme(t,i);},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){var i=this.layoutMode,n=i?u.getLayoutParams(t):{},r=e.getTheme();o.merge(t,r.get(this.mainType)),o.merge(t,this.getDefaultOption()),i&&u.mergeLayoutParam(t,n,i);},mergeOption:function mergeOption(t,e){o.merge(this.option,t,!0);var i=this.layoutMode;i&&u.mergeLayoutParam(this.option,t,i);},optionUpdated:function optionUpdated(t,e){},getDefaultOption:function getDefaultOption(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var i=e.prototype.defaultOption;i&&t.push(i),e=e.superClass;}for(var n={},r=t.length-1;r>=0;r--){n=o.merge(n,t[r],!0);}this.__defaultOption=n;}return this.__defaultOption;},getReferringComponents:function getReferringComponents(t){return this.ecModel.queryComponents({mainType:t,index:this.get(t+"Index",!0),id:this.get(t+"Id",!0)});}});l.enableClassManagement(h,{registerWhenExtend:!0}),s.enableSubTypeDefaulter(h),s.enableTopologicalTravel(h,n),o.mixin(h,i(22)),t.exports=h;},function(t,e,i){var n=i(4),r=i(13),o=r.parseClassType,a=0,s={},l="_";s.getUID=function(t){return[t||"",a++,Math.random()].join(l);},s.enableSubTypeDefaulter=function(t){var e={};return t.registerSubTypeDefaulter=function(t,i){t=o(t),e[t.main]=i;},t.determineSubType=function(i,n){var r=n.type;if(!r){var a=o(i).main;t.hasSubTypes(i)&&e[a]&&(r=e[a](n));}return r;},t;},s.enableTopologicalTravel=function(t,e){function i(t){var i={},a=[];return n.each(t,function(s){var l=r(i,s),u=l.originalDeps=e(s),h=o(u,t);l.entryCount=h.length,0===l.entryCount&&a.push(s),n.each(h,function(t){n.indexOf(l.predecessor,t)<0&&l.predecessor.push(t);var e=r(i,t);n.indexOf(e.successor,t)<0&&e.successor.push(s);});}),{graph:i,noEntryList:a};}function r(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e];}function o(t,e){var i=[];return n.each(t,function(t){n.indexOf(e,t)>=0&&i.push(t);}),i;}t.topologicalTravel=function(t,e,r,o){function a(t){u[t].entryCount--,0===u[t].entryCount&&h.push(t);}function s(t){c[t]=!0,a(t);}if(t.length){var l=i(e),u=l.graph,h=l.noEntryList,c={};for(n.each(t,function(t){c[t]=!0;});h.length;){var d=h.pop(),f=u[d],p=!!c[d];p&&(r.call(o,d,f.originalDeps.slice()),delete c[d]),n.each(f.successor,p?s:a);}n.each(c,function(){throw new Error("Circle dependency may exists");});}};},t.exports=s;},function(t,e,i){"use strict";function n(t,e,i,n,r){var o=0,a=0;null==n&&(n=1/0),null==r&&(r=1/0);var s=0;e.eachChild(function(l,u){var h,c,d=l.position,f=l.getBoundingRect(),p=e.childAt(u+1),g=p&&p.getBoundingRect();if("horizontal"===t){var m=f.width+(g?-g.x+f.x:0);h=o+m,h>n||l.newline?(o=0,h=m,a+=s+i,s=f.height):s=Math.max(s,f.height);}else{var v=f.height+(g?-g.y+f.y:0);c=a+v,c>r||l.newline?(o+=s+i,a=0,c=v,s=f.width):s=Math.max(s,f.width);}l.newline||(d[0]=o,d[1]=a,"horizontal"===t?o=h+i:a=c+i);});}var r=i(4),o=i(9),a=i(7),s=i(6),l=a.parsePercent,u=r.each,h={},c=["left","right","top","bottom","width","height"];h.box=n,h.vbox=r.curry(n,"vertical"),h.hbox=r.curry(n,"horizontal"),h.getAvailableSize=function(t,e,i){var n=e.width,r=e.height,o=l(t.x,n),a=l(t.y,r),u=l(t.x2,n),h=l(t.y2,r);return(isNaN(o)||isNaN(parseFloat(t.x)))&&(o=0),(isNaN(u)||isNaN(parseFloat(t.x2)))&&(u=n),(isNaN(a)||isNaN(parseFloat(t.y)))&&(a=0),(isNaN(h)||isNaN(parseFloat(t.y2)))&&(h=r),i=s.normalizeCssArray(i||0),{width:Math.max(u-o-i[1]-i[3],0),height:Math.max(h-a-i[0]-i[2],0)};},h.getLayoutRect=function(t,e,i){i=s.normalizeCssArray(i||0);var n=e.width,r=e.height,a=l(t.left,n),u=l(t.top,r),h=l(t.right,n),c=l(t.bottom,r),d=l(t.width,n),f=l(t.height,r),p=i[2]+i[0],g=i[1]+i[3],m=t.aspect;switch(isNaN(d)&&(d=n-h-g-a),isNaN(f)&&(f=r-c-p-u),isNaN(d)&&isNaN(f)&&(m>n/r?d=.8*n:f=.8*r),null!=m&&(isNaN(d)&&(d=m*f),isNaN(f)&&(f=d/m)),isNaN(a)&&(a=n-h-d-g),isNaN(u)&&(u=r-c-f-p),t.left||t.right){case"center":a=n/2-d/2-i[3];break;case"right":a=n-d-g;}switch(t.top||t.bottom){case"middle":case"center":u=r/2-f/2-i[0];break;case"bottom":u=r-f-p;}a=a||0,u=u||0,isNaN(d)&&(d=n-a-(h||0)),isNaN(f)&&(f=r-u-(c||0));var v=new o(a+i[3],u+i[0],d,f);return v.margin=i,v;},h.positionGroup=function(t,e,i,n){var o=t.getBoundingRect();e=r.extend(r.clone(e),{width:o.width,height:o.height}),e=h.getLayoutRect(e,i,n),t.attr("position",[e.x-o.x,e.y-o.y]);},h.mergeLayoutParam=function(t,e,i){function n(n){var r={},s=0,l={},h=0,c=i.ignoreSize?1:2;if(u(n,function(e){l[e]=t[e];}),u(n,function(t){o(e,t)&&(r[t]=l[t]=e[t]),a(r,t)&&s++,a(l,t)&&h++;}),h!==c&&s){if(s>=c)return r;for(var d=0;d<n.length;d++){var f=n[d];if(!o(r,f)&&o(t,f)){r[f]=t[f];break;}}return r;}return l;}function o(t,e){return t.hasOwnProperty(e);}function a(t,e){return null!=t[e]&&"auto"!==t[e];}function s(t,e,i){u(t,function(t){e[t]=i[t];});}!r.isObject(i)&&(i={});var l=["width","left","right"],h=["height","top","bottom"],c=n(l),d=n(h);s(l,t,c),s(h,t,d);},h.getLayoutParams=function(t){return h.copyLayoutParams({},t);},h.copyLayoutParams=function(t,e){return e&&t&&u(c,function(i){e.hasOwnProperty(i)&&(t[i]=e[i]);}),t;},t.exports=h;},function(t,e){t.exports={getBoxLayoutParams:function getBoxLayoutParams(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")};}};},function(t,e){var i="";"undefined"!=typeof navigator&&(i=navigator.platform||""),t.exports={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],textStyle:{fontFamily:i.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:!0,animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3};},function(t,e){t.exports={clearColorPalette:function clearColorPalette(){this._colorIdx=0,this._colorNameMap={};},getColorFromPalette:function getColorFromPalette(t,e){e=e||this;var i=e._colorIdx||0,n=e._colorNameMap||(e._colorNameMap={});if(n[t])return n[t];var r=this.get("color",!0)||[];if(r.length){var o=r[i];return t&&(n[t]=o),e._colorIdx=(i+1)%r.length,o;}}};},function(t,e,i){"use strict";function n(t){r.each(o,function(e){this[e]=r.bind(t[e],t);},this);}var r=i(4),o=["getDom","getZr","getWidth","getHeight","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption"];t.exports=n;},function(t,e,i){"use strict";function n(){this._coordinateSystems=[];}var r=i(4),o={};n.prototype={constructor:n,create:function create(t,e){var i=[];r.each(o,function(n,r){var o=n.create(t,e);i=i.concat(o||[]);}),this._coordinateSystems=i;},update:function update(t,e){r.each(this._coordinateSystems,function(i){i.update&&i.update(t,e);});},getCoordinateSystems:function getCoordinateSystems(){return this._coordinateSystems.slice();}},n.register=function(t,e){o[t]=e;},n.get=function(t){return o[t];},t.exports=n;},function(t,e,i){function n(t){this._api=t,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption;}function r(t,e,i){var n,r,o=[],a=[],s=t.timeline;if(t.baseOption&&(r=t.baseOption),(s||t.options)&&(r=r||{},o=(t.options||[]).slice()),t.media){r=r||{};var l=t.media;d(l,function(t){t&&t.option&&(t.query?a.push(t):n||(n=t));});}return r||(r=t),r.timeline||(r.timeline=s),d([r].concat(o).concat(u.map(a,function(t){return t.option;})),function(t){d(e,function(e){e(t,i);});}),{baseOption:r,timelineOptions:o,mediaDefault:n,mediaList:a};}function o(t,e,i){var n={width:e,height:i,aspectratio:e/i},r=!0;return u.each(t,function(t,e){var i=e.match(m);if(i&&i[1]&&i[2]){var o=i[1],s=i[2].toLowerCase();a(n[s],t,o)||(r=!1);}}),r;}function a(t,e,i){return"min"===i?t>=e:"max"===i?e>=t:t===e;}function s(t,e){return t.join(",")===e.join(",");}function l(t,e){e=e||{},d(e,function(e,i){if(null!=e){var n=t[i];if(c.hasClass(i)){e=h.normalizeToArray(e),n=h.normalizeToArray(n);var r=h.mappingToExists(n,e);t[i]=p(r,function(t){return t.option&&t.exist?g(t.exist,t.option,!0):t.exist||t.option;});}else t[i]=g(n,e,!0);}});}var u=i(4),h=i(5),c=i(19),d=u.each,f=u.clone,p=u.map,g=u.merge,m=/^(min|max)?(.+)$/;n.prototype={constructor:n,setOption:function setOption(t,e){t=f(t,!0);var i=this._optionBackup,n=r.call(this,t,e,!i);this._newBaseOption=n.baseOption,i?(l(i.baseOption,n.baseOption),n.timelineOptions.length&&(i.timelineOptions=n.timelineOptions),n.mediaList.length&&(i.mediaList=n.mediaList),n.mediaDefault&&(i.mediaDefault=n.mediaDefault)):this._optionBackup=n;},mountOption:function mountOption(t){var e=this._optionBackup;return this._timelineOptions=p(e.timelineOptions,f),this._mediaList=p(e.mediaList,f),this._mediaDefault=f(e.mediaDefault),this._currentMediaIndices=[],f(t?e.baseOption:this._newBaseOption);},getTimelineOption:function getTimelineOption(t){var e,i=this._timelineOptions;if(i.length){var n=t.getComponent("timeline");n&&(e=f(i[n.getCurrentIndex()],!0));}return e;},getMediaOption:function getMediaOption(t){var e=this._api.getWidth(),i=this._api.getHeight(),n=this._mediaList,r=this._mediaDefault,a=[],l=[];if(!n.length&&!r)return l;for(var u=0,h=n.length;h>u;u++){o(n[u].query,e,i)&&a.push(u);}return!a.length&&r&&(a=[-1]),a.length&&!s(a,this._currentMediaIndices)&&(l=p(a,function(t){return f(-1===t?r.option:n[t].option);})),this._currentMediaIndices=a,l;}},t.exports=n;},function(t,e,i){"use strict";var n=i(4),r=i(6),o=i(5),a=i(19),s=i(24),l=i(2),u=r.encodeHTML,h=r.addCommas,c=a.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendDataProvider:null,visualColorAccessPath:"itemStyle.normal.color",init:function init(t,e,i,n){this.seriesIndex=this.componentIndex,this.mergeDefaultAndTheme(t,i),this._dataBeforeProcessed=this.getInitialData(t,i),this._data=this._dataBeforeProcessed.cloneShallow();},mergeDefaultAndTheme:function mergeDefaultAndTheme(t,e){n.merge(t,e.getTheme().get(this.subType)),n.merge(t,this.getDefaultOption()),o.defaultEmphasis(t.label,o.LABEL_OPTIONS),this.fillDataTextStyle(t.data);},mergeOption:function mergeOption(t,e){t=n.merge(this.option,t,!0),this.fillDataTextStyle(t.data);var i=this.getInitialData(t,e);i&&(this._data=i,this._dataBeforeProcessed=i.cloneShallow());},fillDataTextStyle:function fillDataTextStyle(t){if(t)for(var e=0;e<t.length;e++){t[e]&&t[e].label&&o.defaultEmphasis(t[e].label,o.LABEL_OPTIONS);}},getInitialData:function getInitialData(){},getData:function getData(t){return null==t?this._data:this._data.getLinkedData(t);},setData:function setData(t){this._data=t;},getRawData:function getRawData(){return this._dataBeforeProcessed;},coordDimToDataDim:function coordDimToDataDim(t){return[t];},dataDimToCoordDim:function dataDimToCoordDim(t){return t;},getBaseAxis:function getBaseAxis(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis();},formatTooltip:function formatTooltip(t,e,i){function o(t){var i=[];return n.each(t,function(t,n){var o,s=a.getDimensionInfo(n),l=s&&s.type;o="ordinal"===l?t+"":"time"===l?e?"":r.formatTime("yyyy/mm/dd hh:mm:ss",t):h(t),o&&i.push(o);}),i.join(", ");}var a=this._data,s=this.getRawValue(t),l=n.isArray(s)?o(s):h(s),c=a.getName(t),d=a.getItemVisual(t,"color"),f='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+d+'"></span>',p=this.name;return"\x00-"===p&&(p=""),e?f+u(this.name)+" : "+l:(p&&u(p)+"<br />")+f+(c?u(c)+" : "+l:l);},ifEnableAnimation:function ifEnableAnimation(){if(l.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),t;},restoreData:function restoreData(){this._data=this._dataBeforeProcessed.cloneShallow();},getColorFromPalette:function getColorFromPalette(t,e){var i=this.ecModel,n=s.getColorFromPalette.call(this,t,e);return n||(n=i.getColorFromPalette(t,e)),n;},getAxisTooltipDataIndex:null,getTooltipPosition:null});n.mixin(c,o.dataFormatMixin),n.mixin(c,s),t.exports=c;},function(t,e,i){var n=i(30),r=i(20),o=i(13),a=function a(){this.group=new n(),this.uid=r.getUID("viewComponent");};a.prototype={constructor:a,init:function init(t,e){},render:function render(t,e,i,n){},dispose:function dispose(){}};var s=a.prototype;s.updateView=s.updateLayout=s.updateVisual=function(t,e,i,n){},o.enableClassExtend(a),o.enableClassManagement(a,{registerWhenExtend:!0}),t.exports=a;},function(t,e,i){var n=i(4),r=i(31),o=i(9),a=function a(t){t=t||{},r.call(this,t);for(var e in t){t.hasOwnProperty(e)&&(this[e]=t[e]);}this._children=[],this.__storage=null,this.__dirty=!0;};a.prototype={constructor:a,isGroup:!0,type:"group",silent:!1,children:function children(){return this._children.slice();},childAt:function childAt(t){return this._children[t];},childOfName:function childOfName(t){for(var e=this._children,i=0;i<e.length;i++){if(e[i].name===t)return e[i];}},childCount:function childCount(){return this._children.length;},add:function add(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this;},addBefore:function addBefore(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);n>=0&&(i.splice(n,0,t),this._doAdd(t));}return this;},_doAdd:function _doAdd(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__storage,i=this.__zr;e&&e!==t.__storage&&(e.addToMap(t),t instanceof a&&t.addChildrenToStorage(e)),i&&i.refresh();},remove:function remove(t){var e=this.__zr,i=this.__storage,r=this._children,o=n.indexOf(r,t);return 0>o?this:(r.splice(o,1),t.parent=null,i&&(i.delFromMap(t.id),t instanceof a&&t.delChildrenFromStorage(i)),e&&e.refresh(),this);},removeAll:function removeAll(){var t,e,i=this._children,n=this.__storage;for(e=0;e<i.length;e++){t=i[e],n&&(n.delFromMap(t.id),t instanceof a&&t.delChildrenFromStorage(n)),t.parent=null;}return i.length=0,this;},eachChild:function eachChild(t,e){for(var i=this._children,n=0;n<i.length;n++){var r=i[n];t.call(e,r,n);}return this;},traverse:function traverse(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i];t.call(e,n),"group"===n.type&&n.traverse(t,e);}return this;},addChildrenToStorage:function addChildrenToStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.addToMap(i),i instanceof a&&i.addChildrenToStorage(t);}},delChildrenFromStorage:function delChildrenFromStorage(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.delFromMap(i.id),i instanceof a&&i.delChildrenFromStorage(t);}},dirty:function dirty(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this;},getBoundingRect:function getBoundingRect(t){for(var e=null,i=new o(0,0,0,0),n=t||this._children,r=[],a=0;a<n.length;a++){var s=n[a];if(!s.ignore&&!s.invisible){var l=s.getBoundingRect(),u=s.getLocalTransform(r);u?(i.copy(l),i.applyTransform(u),e=e||i.clone(),e.union(i)):(e=e||l.clone(),e.union(l));}}return e||i;}},n.inherits(a,r),t.exports=a;},function(t,e,i){"use strict";var n=i(32),r=i(33),o=i(34),a=i(35),s=i(4),l=function l(t){o.call(this,t),r.call(this,t),a.call(this,t),this.id=t.id||n();};l.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function drift(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0;}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=e,this.decomposeTransform(),this.dirty(!1);},beforeUpdate:function beforeUpdate(){},afterUpdate:function afterUpdate(){},update:function update(){this.updateTransform();},traverse:function traverse(t,e){},attrKV:function attrKV(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var i=this[t];i||(i=this[t]=[]),i[0]=e[0],i[1]=e[1];}}else this[t]=e;},hide:function hide(){this.ignore=!0,this.__zr&&this.__zr.refresh();},show:function show(){this.ignore=!1,this.__zr&&this.__zr.refresh();},attr:function attr(t,e){if("string"==typeof t)this.attrKV(t,e);else if(s.isObject(t))for(var i in t){t.hasOwnProperty(i)&&this.attrKV(i,t[i]);}return this.dirty(!1),this;},setClipPath:function setClipPath(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),this.clipPath=t,t.__zr=e,t.__clipTarget=this,this.dirty(!1);},removeClipPath:function removeClipPath(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1));},addSelfToZr:function addSelfToZr(t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.addAnimator(e[i]);}this.clipPath&&this.clipPath.addSelfToZr(t);},removeSelfFromZr:function removeSelfFromZr(t){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++){t.animation.removeAnimator(e[i]);}this.clipPath&&this.clipPath.removeSelfFromZr(t);}},s.mixin(l,a),s.mixin(l,o),s.mixin(l,r),t.exports=l;},function(t,e){var i=2311;t.exports=function(){return i++;};},function(t,e){var i=Array.prototype.slice,n=function n(){this._$handlers={};};n.prototype={constructor:n,one:function one(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var r=0;r<n[t].length;r++){if(n[t][r].h===e)return this;}return n[t].push({h:e,one:!0,ctx:i||this}),this;},on:function on(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var r=0;r<n[t].length;r++){if(n[t][r].h===e)return this;}return n[t].push({h:e,one:!1,ctx:i||this}),this;},isSilent:function isSilent(t){var e=this._$handlers;return e[t]&&e[t].length;},off:function off(t,e){var i=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],r=0,o=i[t].length;o>r;r++){i[t][r].h!=e&&n.push(i[t][r]);}i[t]=n;}i[t]&&0===i[t].length&&delete i[t];}else delete i[t];return this;},trigger:function trigger(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>3&&(e=i.call(e,1));for(var r=this._$handlers[t],o=r.length,a=0;o>a;){switch(n){case 1:r[a].h.call(r[a].ctx);break;case 2:r[a].h.call(r[a].ctx,e[1]);break;case 3:r[a].h.call(r[a].ctx,e[1],e[2]);break;default:r[a].h.apply(r[a].ctx,e);}r[a].one?(r.splice(a,1),o--):a++;}}return this;},triggerWithContext:function triggerWithContext(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>4&&(e=i.call(e,1,e.length-1));for(var r=e[e.length-1],o=this._$handlers[t],a=o.length,s=0;a>s;){switch(n){case 1:o[s].h.call(r);break;case 2:o[s].h.call(r,e[1]);break;case 3:o[s].h.call(r,e[1],e[2]);break;default:o[s].h.apply(r,e);}o[s].one?(o.splice(s,1),a--):s++;}}return this;}},t.exports=n;},function(t,e,i){"use strict";function n(t){return t>s||-s>t;}var r=i(11),o=i(10),a=r.identity,s=5e-5,l=function l(t){t=t||{},t.position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null;},u=l.prototype;u.transform=null,u.needLocalTransform=function(){return n(this.rotation)||n(this.position[0])||n(this.position[1])||n(this.scale[0]-1)||n(this.scale[1]-1);},u.updateTransform=function(){var t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;return i||e?(n=n||r.create(),i?this.getLocalTransform(n):a(n),e&&(i?r.mul(n,t.transform,n):r.copy(n,t.transform)),this.transform=n,this.invTransform=this.invTransform||r.create(),void r.invert(this.invTransform,n)):void(n&&a(n));},u.getLocalTransform=function(t){t=t||[],a(t);var e=this.origin,i=this.scale,n=this.rotation,o=this.position;return e&&(t[4]-=e[0],t[5]-=e[1]),r.scale(t,t,i),n&&r.rotate(t,t,n),e&&(t[4]+=e[0],t[5]+=e[1]),t[4]+=o[0],t[5]+=o[1],t;},u.setTransform=function(t){var e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0);},u.restoreTransform=function(t){var e=(this.transform,t.dpr||1);t.setTransform(e,0,0,e,0,0);};var h=[];u.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(r.mul(h,t.invTransform,e),e=h);var i=e[0]*e[0]+e[1]*e[1],o=e[2]*e[2]+e[3]*e[3],a=this.position,s=this.scale;n(i-1)&&(i=Math.sqrt(i)),n(o-1)&&(o=Math.sqrt(o)),e[0]<0&&(i=-i),e[3]<0&&(o=-o),a[0]=e[4],a[1]=e[5],s[0]=i,s[1]=o,this.rotation=Math.atan2(-e[1]/o,e[0]/i);}},u.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(i=-i),[e,i];},u.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&o.applyTransform(i,i,n),i;},u.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&o.applyTransform(i,i,n),i;},t.exports=l;},function(t,e,i){"use strict";var n=i(36),r=i(4),o=r.isString,a=r.isFunction,s=r.isObject,l=i(40),u=function u(){this.animators=[];};u.prototype={constructor:u,animate:function animate(t,e){var i,o=!1,a=this,s=this.__zr;if(t){var u=t.split("."),h=a;o="shape"===u[0];for(var c=0,d=u.length;d>c;c++){h&&(h=h[u[c]]);}h&&(i=h);}else i=a;if(!i)return void l('Property "'+t+'" is not existed in element '+a.id);var f=a.animators,p=new n(i,e);return p.during(function(t){a.dirty(o);}).done(function(){f.splice(r.indexOf(f,p),1);}),f.push(p),s&&s.animation.addAnimator(p),p;},stopAnimation:function stopAnimation(t){for(var e=this.animators,i=e.length,n=0;i>n;n++){e[n].stop(t);}return e.length=0,this;},animateTo:function animateTo(t,e,i,n,r){function s(){u--,u||r&&r();}o(i)?(r=n,n=i,i=0):a(n)?(r=n,n="linear",i=0):a(i)?(r=i,i=0):a(e)?(r=e,e=500):e||(e=500),this.stopAnimation(),this._animateToShallow("",this,t,e,i,n,r);var l=this.animators.slice(),u=l.length;u||r&&r();for(var h=0;h<l.length;h++){l[h].done(s).start(n);}},_animateToShallow:function _animateToShallow(t,e,i,n,o){var a={},l=0;for(var u in i){if(i.hasOwnProperty(u))if(null!=e[u])s(i[u])&&!r.isArrayLike(i[u])?this._animateToShallow(t?t+"."+u:u,e[u],i[u],n,o):(a[u]=i[u],l++);else if(null!=i[u])if(t){var h={};h[t]={},h[t][u]=i[u],this.attr(h);}else this.attr(u,i[u]);}return l>0&&this.animate(t,!1).when(null==n?500:n,a).delay(o||0),this;}},t.exports=u;},function(t,e,i){function n(t,e){return t[e];}function r(t,e,i){t[e]=i;}function o(t,e,i){return(e-t)*i+t;}function a(t,e,i){return i>.5?e:t;}function s(t,e,i,n,r){var a=t.length;if(1==r)for(var s=0;a>s;s++){n[s]=o(t[s],e[s],i);}else for(var l=t[0].length,s=0;a>s;s++){for(var u=0;l>u;u++){n[s][u]=o(t[s][u],e[s][u],i);}}}function l(t,e,i){var n=t.length,r=e.length;if(n!==r){var o=n>r;if(o)t.length=r;else for(var a=n;r>a;a++){t.push(1===i?e[a]:x.call(e[a]));}}for(var s=t[0]&&t[0].length,a=0;a<t.length;a++){if(1===i)isNaN(t[a])&&(t[a]=e[a]);else for(var l=0;s>l;l++){isNaN(t[a][l])&&(t[a][l]=e[a][l]);}}}function u(t,e,i){if(t===e)return!0;var n=t.length;if(n!==e.length)return!1;if(1===i){for(var r=0;n>r;r++){if(t[r]!==e[r])return!1;}}else for(var o=t[0].length,r=0;n>r;r++){for(var a=0;o>a;a++){if(t[r][a]!==e[r][a])return!1;}}return!0;}function h(t,e,i,n,r,o,a,s,l){var u=t.length;if(1==l)for(var h=0;u>h;h++){s[h]=c(t[h],e[h],i[h],n[h],r,o,a);}else for(var d=t[0].length,h=0;u>h;h++){for(var f=0;d>f;f++){s[h][f]=c(t[h][f],e[h][f],i[h][f],n[h][f],r,o,a);}}}function c(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e;}function d(t){if(y(t)){var e=t.length;if(y(t[0])){for(var i=[],n=0;e>n;n++){i.push(x.call(t[n]));}return i;}return x.call(t);}return t;}function f(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")";}function p(t,e,i,n,r){var d=t._getter,p=t._setter,v="spline"===e,x=n.length;if(x){var _,b=n[0].value,w=y(b),S=!1,M=!1,I=w&&y(b[0])?2:1;n.sort(function(t,e){return t.time-e.time;}),_=n[x-1].time;for(var T=[],A=[],L=n[0].value,C=!0,D=0;x>D;D++){T.push(n[D].time/_);var P=n[D].value;if(w&&u(P,L,I)||!w&&P===L||(C=!1),L=P,"string"==typeof P){var k=m.parse(P);k?(P=k,S=!0):M=!0;}A.push(P);}if(!C){for(var z=A[x-1],D=0;x-1>D;D++){w?l(A[D],z,I):!isNaN(A[D])||isNaN(z)||M||S||(A[D]=z);}w&&l(d(t._target,r),z,I);var O,E,R,N,V,B,G=0,F=0;if(S)var H=[0,0,0,0];var W=function W(t,e){var i;if(0>e)i=0;else if(F>e){for(O=Math.min(G+1,x-1),i=O;i>=0&&!(T[i]<=e);i--){}i=Math.min(i,x-2);}else{for(i=G;x>i&&!(T[i]>e);i++){}i=Math.min(i-1,x-2);}G=i,F=e;var n=T[i+1]-T[i];if(0!==n)if(E=(e-T[i])/n,v){if(N=A[i],R=A[0===i?i:i-1],V=A[i>x-2?x-1:i+1],B=A[i>x-3?x-1:i+2],w)h(R,N,V,B,E,E*E,E*E*E,d(t,r),I);else{var l;if(S)l=h(R,N,V,B,E,E*E,E*E*E,H,1),l=f(H);else{if(M)return a(N,V,E);l=c(R,N,V,B,E,E*E,E*E*E);}p(t,r,l);}}else if(w)s(A[i],A[i+1],E,d(t,r),I);else{var l;if(S)s(A[i],A[i+1],E,H,1),l=f(H);else{if(M)return a(A[i],A[i+1],E);l=o(A[i],A[i+1],E);}p(t,r,l);}},Z=new g({target:t._target,life:_,loop:t._loop,delay:t._delay,onframe:W,ondestroy:i});return e&&"spline"!==e&&(Z.easing=e),Z;}}}var g=i(37),m=i(39),v=i(4),y=v.isArrayLike,x=Array.prototype.slice,_=function _(t,e,i,o){this._tracks={},this._target=t,this._loop=e||!1,this._getter=i||n,this._setter=o||r,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[];};_.prototype={when:function when(t,e){var i=this._tracks;for(var n in e){if(e.hasOwnProperty(n)){if(!i[n]){i[n]=[];var r=this._getter(this._target,n);if(null==r)continue;0!==t&&i[n].push({time:0,value:d(r)});}i[n].push({time:t,value:e[n]});}}return this;},during:function during(t){return this._onframeList.push(t),this;},_doneCallback:function _doneCallback(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,i=0;e>i;i++){t[i].call(this);}},start:function start(t){var e,i=this,n=0,r=function r(){n--,n||i._doneCallback();};for(var o in this._tracks){if(this._tracks.hasOwnProperty(o)){var a=p(this,t,r,this._tracks[o],o);a&&(this._clipList.push(a),n++,this.animation&&this.animation.addClip(a),e=a);}}if(e){var s=e.onframe;e.onframe=function(t,e){s(t,e);for(var n=0;n<i._onframeList.length;n++){i._onframeList[n](t,e);}};}return n||this._doneCallback(),this;},stop:function stop(t){for(var e=this._clipList,i=this.animation,n=0;n<e.length;n++){var r=e[n];t&&r.onframe(this._target,1),i&&i.removeClip(r);}e.length=0;},delay:function delay(t){return this._delay=t,this;},done:function done(t){return t&&this._doneList.push(t),this;},getClips:function getClips(){return this._clipList;}},t.exports=_;},function(t,e,i){function n(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null==t.loop?!1:t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart;}var r=i(38);n.prototype={constructor:n,step:function step(t){this._initialized||(this._startTime=t+this._delay,this._initialized=!0);var e=(t-this._startTime)/this._life;if(!(0>e)){e=Math.min(e,1);var i=this.easing,n="string"==typeof i?r[i]:i,o="function"==typeof n?n(e):e;return this.fire("frame",o),1==e?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null;}},restart:function restart(t){var e=(t-this._startTime)%this._life;this._startTime=t-e+this.gap,this._needsRemove=!1;},fire:function fire(t,e){t="on"+t,this[t]&&this[t](this._target,e);}},t.exports=n;},function(t,e){var i={linear:function linear(t){return t;},quadraticIn:function quadraticIn(t){return t*t;},quadraticOut:function quadraticOut(t){return t*(2-t);},quadraticInOut:function quadraticInOut(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1);},cubicIn:function cubicIn(t){return t*t*t;},cubicOut:function cubicOut(t){return--t*t*t+1;},cubicInOut:function cubicInOut(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2);},quarticIn:function quarticIn(t){return t*t*t*t;},quarticOut:function quarticOut(t){return 1- --t*t*t*t;},quarticInOut:function quarticInOut(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2);},quinticIn:function quinticIn(t){return t*t*t*t*t;},quinticOut:function quinticOut(t){return--t*t*t*t*t+1;},quinticInOut:function quinticInOut(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2);},sinusoidalIn:function sinusoidalIn(t){return 1-Math.cos(t*Math.PI/2);},sinusoidalOut:function sinusoidalOut(t){return Math.sin(t*Math.PI/2);},sinusoidalInOut:function sinusoidalInOut(t){return.5*(1-Math.cos(Math.PI*t));},exponentialIn:function exponentialIn(t){return 0===t?0:Math.pow(1024,t-1);},exponentialOut:function exponentialOut(t){return 1===t?1:1-Math.pow(2,-10*t);},exponentialInOut:function exponentialInOut(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2);},circularIn:function circularIn(t){return 1-Math.sqrt(1-t*t);},circularOut:function circularOut(t){return Math.sqrt(1- --t*t);},circularInOut:function circularInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1);},elasticIn:function elasticIn(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)));},elasticOut:function elasticOut(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1);},elasticInOut:function elasticInOut(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1);},backIn:function backIn(t){var e=1.70158;return t*t*((e+1)*t-e);},backOut:function backOut(t){var e=1.70158;return--t*t*((e+1)*t+e)+1;},backInOut:function backInOut(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2);},bounceIn:function bounceIn(t){return 1-i.bounceOut(1-t);},bounceOut:function bounceOut(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375;},bounceInOut:function bounceInOut(t){return.5>t?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5;}};t.exports=i;},function(t,e){function i(t){return t=Math.round(t),0>t?0:t>255?255:t;}function n(t){return t=Math.round(t),0>t?0:t>360?360:t;}function r(t){return 0>t?0:t>1?1:t;}function o(t){return i(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100*255:parseInt(t,10));}function a(t){return r(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100:parseFloat(t));}function s(t,e,i){return 0>i?i+=1:i>1&&(i-=1),1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t;}function l(t,e,i){return t+(e-t)*i;}function u(t){if(t){t+="";var e=t.replace(/ /g,"").toLowerCase();if(e in x)return x[e].slice();if("#"!==e.charAt(0)){var i=e.indexOf("("),n=e.indexOf(")");if(-1!==i&&n+1===e.length){var r=e.substr(0,i),s=e.substr(i+1,n-(i+1)).split(","),l=1;switch(r){case"rgba":if(4!==s.length)return;l=a(s.pop());case"rgb":if(3!==s.length)return;return[o(s[0]),o(s[1]),o(s[2]),l];case"hsla":if(4!==s.length)return;return s[3]=a(s[3]),h(s);case"hsl":if(3!==s.length)return;return h(s);default:return;}}}else{if(4===e.length){var u=parseInt(e.substr(1),16);if(!(u>=0&&4095>=u))return;return[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1];}if(7===e.length){var u=parseInt(e.substr(1),16);if(!(u>=0&&16777215>=u))return;return[(16711680&u)>>16,(65280&u)>>8,255&u,1];}}}}function h(t){var e=(parseFloat(t[0])%360+360)%360/360,n=a(t[1]),r=a(t[2]),o=.5>=r?r*(n+1):r+n-r*n,l=2*r-o,u=[i(255*s(l,o,e+1/3)),i(255*s(l,o,e)),i(255*s(l,o,e-1/3))];return 4===t.length&&(u[3]=t[3]),u;}function c(t){if(t){var e,i,n=t[0]/255,r=t[1]/255,o=t[2]/255,a=Math.min(n,r,o),s=Math.max(n,r,o),l=s-a,u=(s+a)/2;if(0===l)e=0,i=0;else{i=.5>u?l/(s+a):l/(2-s-a);var h=((s-n)/6+l/2)/l,c=((s-r)/6+l/2)/l,d=((s-o)/6+l/2)/l;n===s?e=d-c:r===s?e=1/3+h-d:o===s&&(e=2/3+c-h),0>e&&(e+=1),e>1&&(e-=1);}var f=[360*e,i,u];return null!=t[3]&&f.push(t[3]),f;}}function d(t,e){var i=u(t);if(i){for(var n=0;3>n;n++){0>e?i[n]=i[n]*(1-e)|0:i[n]=(255-i[n])*e+i[n]|0;}return y(i,4===i.length?"rgba":"rgb");}}function f(t,e){var i=u(t);return i?((1<<24)+(i[0]<<16)+(i[1]<<8)+ +i[2]).toString(16).slice(1):void 0;}function p(t,e,n){if(e&&e.length&&t>=0&&1>=t){n=n||[0,0,0,0];var r=t*(e.length-1),o=Math.floor(r),a=Math.ceil(r),s=e[o],u=e[a],h=r-o;return n[0]=i(l(s[0],u[0],h)),n[1]=i(l(s[1],u[1],h)),n[2]=i(l(s[2],u[2],h)),n[3]=i(l(s[3],u[3],h)),n;}}function g(t,e,n){if(e&&e.length&&t>=0&&1>=t){var o=t*(e.length-1),a=Math.floor(o),s=Math.ceil(o),h=u(e[a]),c=u(e[s]),d=o-a,f=y([i(l(h[0],c[0],d)),i(l(h[1],c[1],d)),i(l(h[2],c[2],d)),r(l(h[3],c[3],d))],"rgba");return n?{color:f,leftIndex:a,rightIndex:s,value:o}:f;}}function m(t,e,i,r){return t=u(t),t?(t=c(t),null!=e&&(t[0]=n(e)),null!=i&&(t[1]=a(i)),null!=r&&(t[2]=a(r)),y(h(t),"rgba")):void 0;}function v(t,e){return t=u(t),t&&null!=e?(t[3]=r(e),y(t,"rgba")):void 0;}function y(t,e){var i=t[0]+","+t[1]+","+t[2];return("rgba"===e||"hsva"===e||"hsla"===e)&&(i+=","+t[3]),e+"("+i+")";}var x={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};t.exports={parse:u,lift:d,toHex:f,fastMapToColor:p,mapToColor:g,modifyHSL:m,modifyAlpha:v,stringify:y};},function(t,e,i){var n=i(41);t.exports=function(){if(0!==n.debugMode)if(1==n.debugMode)for(var t in arguments){throw new Error(arguments[t]);}else if(n.debugMode>1)for(var t in arguments){console.log(arguments[t]);}};},function(t,e){var i=1;"undefined"!=typeof window&&(i=Math.max(window.devicePixelRatio||1,1));var n={debugMode:0,devicePixelRatio:i};t.exports=n;},function(t,e,i){function n(){this.group=new a(),this.uid=s.getUID("viewChart");}function r(t,e){if(t&&(t.trigger(e),"group"===t.type))for(var i=0;i<t.childCount();i++){r(t.childAt(i),e);}}function o(t,e,i){var n=u.queryDataIndex(t,e);null!=n?h.each(u.normalizeToArray(n),function(e){r(t.getItemGraphicEl(e),i);}):t.eachItemGraphicEl(function(t){r(t,i);});}var a=i(30),s=i(20),l=i(13),u=i(5),h=i(4);n.prototype={type:"chart",init:function init(t,e){},render:function render(t,e,i,n){},highlight:function highlight(t,e,i,n){o(t.getData(),n,"emphasis");},downplay:function downplay(t,e,i,n){o(t.getData(),n,"normal");},remove:function remove(t,e){this.group.removeAll();},dispose:function dispose(){}};var c=n.prototype;c.updateView=c.updateLayout=c.updateVisual=function(t,e,i,n){this.render(t,e,i,n);},l.enableClassExtend(n,["dispose"]),l.enableClassManagement(n,{registerWhenExtend:!0}),t.exports=n;},function(t,e,i){"use strict";function n(t){return null!=t&&"none"!=t;}function r(t){return"string"==typeof t?_.lift(t,-.1):t;}function o(t){if(t.__hoverStlDirty){var e=t.style.stroke,i=t.style.fill,o=t.__hoverStl;o.fill=o.fill||(n(i)?r(i):null),o.stroke=o.stroke||(n(e)?r(e):null);var a={};for(var s in o){o.hasOwnProperty(s)&&(a[s]=t.style[s]);}t.__normalStl=a,t.__hoverStlDirty=!1;}}function a(t){t.__isHover||(o(t),t.useHoverLayer?t.__zr&&t.__zr.addHover(t,t.__hoverStl):(t.setStyle(t.__hoverStl),t.z2+=1),t.__isHover=!0);}function s(t){if(t.__isHover){var e=t.__normalStl;t.useHoverLayer?t.__zr&&t.__zr.removeHover(t):(e&&t.setStyle(e),t.z2-=1),t.__isHover=!1;}}function l(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&a(t);}):a(t);}function u(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&s(t);}):s(t);}function h(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0,t.__isHover&&o(t);}function c(){!this.__isEmphasis&&l(this);}function d(){!this.__isEmphasis&&u(this);}function f(){this.__isEmphasis=!0,l(this);}function p(){this.__isEmphasis=!1,u(this);}function g(t,e,i,n,r,o){"function"==typeof r&&(o=r,r=null);var a=n&&(n.ifEnableAnimation?n.ifEnableAnimation():n.getShallow("animation"));if(a){var s=t?"Update":"",l=n&&n.getShallow("animationDuration"+s),u=n&&n.getShallow("animationEasing"+s),h=n&&n.getShallow("animationDelay"+s);"function"==typeof h&&(h=h(r)),l>0?e.animateTo(i,l,h||0,u,o):(e.attr(i),o&&o());}else e.attr(i),o&&o();}var m=i(4),v=i(44),y=Math.round,x=i(45),_=i(39),b=i(11),w=i(10),S=(i(61),{});S.Group=i(30),S.Image=i(62),S.Text=i(64),S.Circle=i(65),S.Sector=i(66),S.Ring=i(67),S.Polygon=i(68),S.Polyline=i(72),S.Rect=i(73),S.Line=i(75),S.BezierCurve=i(76),S.Arc=i(77),S.CompoundPath=i(78),S.LinearGradient=i(79),S.RadialGradient=i(80),S.BoundingRect=i(9),S.extendShape=function(t){return x.extend(t);},S.extendPath=function(t,e){return v.extendFromString(t,e);},S.makePath=function(t,e,i,n){var r=v.createFromString(t,e),o=r.getBoundingRect();if(i){var a=o.width/o.height;if("center"===n){var s,l=i.height*a;l<=i.width?s=i.height:(l=i.width,s=l/a);var u=i.x+i.width/2,h=i.y+i.height/2;i.x=u-l/2,i.y=h-s/2,i.width=l,i.height=s;}this.resizePath(r,i);}return r;},S.mergePath=v.mergePath,S.resizePath=function(t,e){if(t.applyTransform){var i=t.getBoundingRect(),n=i.calculateTransform(e);t.applyTransform(n);}},S.subPixelOptimizeLine=function(t){var e=S.subPixelOptimize,i=t.shape,n=t.style.lineWidth;return y(2*i.x1)===y(2*i.x2)&&(i.x1=i.x2=e(i.x1,n,!0)),y(2*i.y1)===y(2*i.y2)&&(i.y1=i.y2=e(i.y1,n,!0)),t;},S.subPixelOptimizeRect=function(t){var e=S.subPixelOptimize,i=t.shape,n=t.style.lineWidth,r=i.x,o=i.y,a=i.width,s=i.height;return i.x=e(i.x,n,!0),i.y=e(i.y,n,!0),i.width=Math.max(e(r+a,n,!1)-i.x,0===a?0:1),i.height=Math.max(e(o+s,n,!1)-i.y,0===s?0:1),t;},S.subPixelOptimize=function(t,e,i){var n=y(2*t);return(n+y(e))%2===0?n/2:(n+(i?1:-1))/2;},S.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&h(t,e);}):h(t,e),t.on("mouseover",c).on("mouseout",d),t.on("emphasis",f).on("normal",p);},S.setText=function(t,e,i){var n=e.getShallow("position")||"inside",r=n.indexOf("inside")>=0?"white":i,o=e.getModel("textStyle");m.extend(t,{textDistance:e.getShallow("distance")||5,textFont:o.getFont(),textPosition:n,textFill:o.getTextColor()||r});},S.updateProps=function(t,e,i,n,r){g(!0,t,e,i,n,r);},S.initProps=function(t,e,i,n,r){g(!1,t,e,i,n,r);},S.getTransform=function(t,e){for(var i=b.identity([]);t&&t!==e;){b.mul(i,t.getLocalTransform(),i),t=t.parent;}return i;},S.applyTransform=function(t,e,i){return i&&(e=b.invert([],e)),w.applyTransform([],t,e);},S.transformDirection=function(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-n:"right"===t?n:0,"top"===t?-r:"bottom"===t?r:0];return o=S.applyTransform(o,e,i),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top";},S.groupTransition=function(t,e,i,n){function r(t){var e={};return t.traverse(function(t){!t.isGroup&&t.anid&&(e[t.anid]=t);}),e;}function o(t){var e={position:w.clone(t.position),rotation:t.rotation};return t.shape&&(e.shape=m.extend({},t.shape)),e;}if(t&&e){var a=r(t);e.traverse(function(t){if(!t.isGroup&&t.anid){var e=a[t.anid];if(e){var n=o(t);t.attr(o(e)),S.updateProps(t,n,i,t.dataIndex);}}});}},t.exports=S;},function(t,e,i){function n(t,e,i,n,r,o,a,s,l,u,h){var g=l*(p/180),y=f(g)*(t-i)/2+d(g)*(e-n)/2,x=-1*d(g)*(t-i)/2+f(g)*(e-n)/2,_=y*y/(a*a)+x*x/(s*s);_>1&&(a*=c(_),s*=c(_));var b=(r===o?-1:1)*c((a*a*(s*s)-a*a*(x*x)-s*s*(y*y))/(a*a*(x*x)+s*s*(y*y)))||0,w=b*a*x/s,S=b*-s*y/a,M=(t+i)/2+f(g)*w-d(g)*S,I=(e+n)/2+d(g)*w+f(g)*S,T=v([1,0],[(y-w)/a,(x-S)/s]),A=[(y-w)/a,(x-S)/s],L=[(-1*y-w)/a,(-1*x-S)/s],C=v(A,L);m(A,L)<=-1&&(C=p),m(A,L)>=1&&(C=0),0===o&&C>0&&(C-=2*p),1===o&&0>C&&(C+=2*p),h.addData(u,M,I,a,s,T,C,g,o);}function r(t){if(!t)return[];var e,i=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<h.length;e++){i=i.replace(new RegExp(h[e],"g"),"|"+h[e]);}var r,o=i.split("|"),a=0,l=0,u=new s(),c=s.CMD;for(e=1;e<o.length;e++){var d,f=o[e],p=f.charAt(0),g=0,m=f.slice(1).replace(/e,-/g,"e-").split(",");m.length>0&&""===m[0]&&m.shift();for(var v=0;v<m.length;v++){m[v]=parseFloat(m[v]);}for(;g<m.length&&!isNaN(m[g])&&!isNaN(m[0]);){var y,x,_,b,w,S,M,I=a,T=l;switch(p){case"l":a+=m[g++],l+=m[g++],d=c.L,u.addData(d,a,l);break;case"L":a=m[g++],l=m[g++],d=c.L,u.addData(d,a,l);break;case"m":a+=m[g++],l+=m[g++],d=c.M,u.addData(d,a,l),p="l";break;case"M":a=m[g++],l=m[g++],d=c.M,u.addData(d,a,l),p="L";break;case"h":a+=m[g++],d=c.L,u.addData(d,a,l);break;case"H":a=m[g++],d=c.L,u.addData(d,a,l);break;case"v":l+=m[g++],d=c.L,u.addData(d,a,l);break;case"V":l=m[g++],d=c.L,u.addData(d,a,l);break;case"C":d=c.C,u.addData(d,m[g++],m[g++],m[g++],m[g++],m[g++],m[g++]),a=m[g-2],l=m[g-1];break;case"c":d=c.C,u.addData(d,m[g++]+a,m[g++]+l,m[g++]+a,m[g++]+l,m[g++]+a,m[g++]+l),a+=m[g-2],l+=m[g-1];break;case"S":y=a,x=l;var A=u.len(),L=u.data;r===c.C&&(y+=a-L[A-4],x+=l-L[A-3]),d=c.C,I=m[g++],T=m[g++],a=m[g++],l=m[g++],u.addData(d,y,x,I,T,a,l);break;case"s":y=a,x=l;var A=u.len(),L=u.data;r===c.C&&(y+=a-L[A-4],x+=l-L[A-3]),d=c.C,I=a+m[g++],T=l+m[g++],a+=m[g++],l+=m[g++],u.addData(d,y,x,I,T,a,l);break;case"Q":I=m[g++],T=m[g++],a=m[g++],l=m[g++],d=c.Q,u.addData(d,I,T,a,l);break;case"q":I=m[g++]+a,T=m[g++]+l,a+=m[g++],l+=m[g++],d=c.Q,u.addData(d,I,T,a,l);break;case"T":y=a,x=l;var A=u.len(),L=u.data;r===c.Q&&(y+=a-L[A-4],x+=l-L[A-3]),a=m[g++],l=m[g++],d=c.Q,u.addData(d,y,x,a,l);break;case"t":y=a,x=l;var A=u.len(),L=u.data;r===c.Q&&(y+=a-L[A-4],x+=l-L[A-3]),a+=m[g++],l+=m[g++],d=c.Q,u.addData(d,y,x,a,l);break;case"A":_=m[g++],b=m[g++],w=m[g++],S=m[g++],M=m[g++],I=a,T=l,a=m[g++],l=m[g++],d=c.A,n(I,T,a,l,S,M,_,b,w,d,u);break;case"a":_=m[g++],b=m[g++],w=m[g++],S=m[g++],M=m[g++],I=a,T=l,a+=m[g++],l+=m[g++],d=c.A,n(I,T,a,l,S,M,_,b,w,d,u);}}("z"===p||"Z"===p)&&(d=c.Z,u.addData(d)),r=d;}return u.toStatic(),u;}function o(t,e){var i,n=r(t);return e=e||{},e.buildPath=function(t){t.setData(n.data),i&&l(t,i);var e=t.getContext();e&&t.rebuildPath(e);},e.applyTransform=function(t){i||(i=u.create()),u.mul(i,t,i),this.dirty(!0);},e;}var a=i(45),s=i(49),l=i(60),u=i(11),h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],c=Math.sqrt,d=Math.sin,f=Math.cos,p=Math.PI,g=function g(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);},m=function m(t,e){return(t[0]*e[0]+t[1]*e[1])/(g(t)*g(e));},v=function v(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(m(t,e));};t.exports={createFromString:function createFromString(t,e){return new a(o(t,e));},extendFromString:function extendFromString(t,e){return a.extend(o(t,e));},mergePath:function mergePath(t,e){for(var i=[],n=t.length,r=0;n>r;r++){var o=t[r];o.__dirty&&o.buildPath(o.path,o.shape,!0),i.push(o.path);}var s=new a(e);return s.buildPath=function(t){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e);},s;}};},function(t,e,i){function n(t){r.call(this,t),this.path=new a();}var r=i(46),o=i(4),a=i(49),s=i(52),l=i(59),u=l.prototype.getCanvasPattern,h=Math.abs;n.prototype={constructor:n,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function brush(t,e){var i=this.style,n=this.path,r=i.hasStroke(),o=i.hasFill(),a=i.fill,s=i.stroke,l=o&&!!a.colorStops,h=r&&!!s.colorStops,c=o&&!!a.image,d=r&&!!s.image;if(i.bind(t,this,e),this.setTransform(t),this.__dirty){var f=this.getBoundingRect();l&&(this._fillGradient=i.getGradient(t,a,f)),h&&(this._strokeGradient=i.getGradient(t,s,f));}l?t.fillStyle=this._fillGradient:c&&(t.fillStyle=u.call(a,t)),h?t.strokeStyle=this._strokeGradient:d&&(t.strokeStyle=u.call(s,t));var p=i.lineDash,g=i.lineDashOffset,m=!!t.setLineDash,v=this.getGlobalScale();n.setScale(v[0],v[1]),this.__dirtyPath||p&&!m&&r?(n=this.path.beginPath(t),p&&!m&&(n.setLineDash(p),n.setLineDashOffset(g)),this.buildPath(n,this.shape,!1),this.__dirtyPath=!1):(t.beginPath(),this.path.rebuildPath(t)),o&&n.fill(t),p&&m&&(t.setLineDash(p),t.lineDashOffset=g),r&&n.stroke(t),p&&m&&t.setLineDash([]),this.restoreTransform(t),(i.text||0===i.text)&&this.drawRectText(t,this.getBoundingRect());},buildPath:function buildPath(t,e,i){},getBoundingRect:function getBoundingRect(){var t=this._rect,e=this.style,i=!t;if(i){var n=this.path;this.__dirtyPath&&(n.beginPath(),this.buildPath(n,this.shape,!1)),t=n.getBoundingRect();}if(this._rect=t,e.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){r.copy(t);var o=e.lineWidth,a=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),a>1e-10&&(r.width+=o/a,r.height+=o/a,r.x-=o/a/2,r.y-=o/a/2);}return r;}return t;},contain:function contain(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),r=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var o=this.path.data;if(r.hasStroke()){var a=r.lineWidth,l=r.strokeNoScale?this.getLineScale():1;if(l>1e-10&&(r.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),s.containStroke(o,a/l,t,e)))return!0;}if(r.hasFill())return s.contain(o,t,e);}return!1;},dirty:function dirty(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty();},animateShape:function animateShape(t){return this.animate("shape",t);},attrKV:function attrKV(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):r.prototype.attrKV.call(this,t,e);},setShape:function setShape(t,e){var i=this.shape;if(i){if(o.isObject(t))for(var n in t){t.hasOwnProperty(n)&&(i[n]=t[n]);}else i[t]=e;this.dirty(!0);}return this;},getLineScale:function getLineScale(){var t=this.transform;return t&&h(t[0]-1)>1e-10&&h(t[3]-1)>1e-10?Math.sqrt(h(t[0]*t[3]-t[2]*t[1])):1;}},n.extend=function(t){var e=function e(_e){n.call(this,_e),t.style&&this.style.extendFrom(t.style,!1);var i=t.shape;if(i){this.shape=this.shape||{};var r=this.shape;for(var o in i){!r.hasOwnProperty(o)&&i.hasOwnProperty(o)&&(r[o]=i[o]);}}t.init&&t.init.call(this,_e);};o.inherits(e,n);for(var i in t){"style"!==i&&"shape"!==i&&(e.prototype[i]=t[i]);}return e;},o.inherits(n,r),t.exports=n;},function(t,e,i){function n(t){t=t||{},a.call(this,t);for(var e in t){t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);}this.style=new o(t.style),this._rect=null,this.__clipPaths=[];}var r=i(4),o=i(47),a=i(31),s=i(48);n.prototype={constructor:n,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function beforeBrush(t){},afterBrush:function afterBrush(t){},brush:function brush(t,e){},getBoundingRect:function getBoundingRect(){},contain:function contain(t,e){return this.rectContain(t,e);},traverse:function traverse(t,e){t.call(e,this);},rectContain:function rectContain(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect();return n.contain(i[0],i[1]);},dirty:function dirty(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh();},animateStyle:function animateStyle(t){return this.animate("style",t);},attrKV:function attrKV(t,e){"style"!==t?a.prototype.attrKV.call(this,t,e):this.style.set(e);},setStyle:function setStyle(t,e){return this.style.set(t,e),this.dirty(!1),this;},useStyle:function useStyle(t){return this.style=new o(t),this.dirty(!1),this;}},r.inherits(n,a),r.mixin(n,s),t.exports=n;},function(t,e){function i(t,e,i){var n=e.x,r=e.x2,o=e.y,a=e.y2;e.global||(n=n*i.width+i.x,r=r*i.width+i.x,o=o*i.height+i.y,a=a*i.height+i.y);var s=t.createLinearGradient(n,o,r,a);return s;}function n(t,e,i){var n=i.width,r=i.height,o=Math.min(n,r),a=e.x,s=e.y,l=e.r;e.global||(a=a*n+i.x,s=s*r+i.y,l*=o);var u=t.createRadialGradient(a,s,0,a,s,l);return u;}var r=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],o=function o(t){this.extendFrom(t);};o.prototype={constructor:o,fill:"#000000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,textFill:"#000",textStroke:null,textPosition:"inside",textBaseline:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textTransform:!1,textRotation:0,blend:null,bind:function bind(t,e,i){for(var n=this,o=i&&i.style,a=!o,s=0;s<r.length;s++){var l=r[s],u=l[0];(a||n[u]!==o[u])&&(t[u]=n[u]||l[1]);}if((a||n.fill!==o.fill)&&(t.fillStyle=n.fill),(a||n.stroke!==o.stroke)&&(t.strokeStyle=n.stroke),(a||n.opacity!==o.opacity)&&(t.globalAlpha=null==n.opacity?1:n.opacity),(a||n.blend!==o.blend)&&(t.globalCompositeOperation=n.blend||"source-over"),this.hasStroke()){var h=n.lineWidth;t.lineWidth=h/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1);}},hasFill:function hasFill(){var t=this.fill;return null!=t&&"none"!==t;},hasStroke:function hasStroke(){var t=this.stroke;return null!=t&&"none"!==t&&this.lineWidth>0;},extendFrom:function extendFrom(t,e){if(t){var i=this;for(var n in t){!t.hasOwnProperty(n)||!e&&i.hasOwnProperty(n)||(i[n]=t[n]);}}},set:function set(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0);},clone:function clone(){var t=new this.constructor();return t.extendFrom(this,!0),t;},getGradient:function getGradient(t,e,r){for(var o="radial"===e.type?n:i,a=o(t,e,r),s=e.colorStops,l=0;l<s.length;l++){a.addColorStop(s[l].offset,s[l].color);}return a;}};for(var a=o.prototype,s=0;s<r.length;s++){var l=r[s];l[0]in a||(a[l[0]]=l[1]);}o.getGradient=a.getGradient,t.exports=o;},function(t,e,i){function n(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t;}var r=i(8),o=i(9),a=new o(),s=function s(){};s.prototype={constructor:s,drawRectText:function drawRectText(t,e,i){var o=this.style,s=o.text;if(null!=s&&(s+=""),s){t.save();var l,u,h=o.textPosition,c=o.textDistance,d=o.textAlign,f=o.textFont||o.font,p=o.textBaseline,g=o.textVerticalAlign;i=i||r.getBoundingRect(s,f,d,p);var m=this.transform;if(o.textTransform?this.setTransform(t):m&&(a.copy(e),a.applyTransform(m),e=a),h instanceof Array){if(l=e.x+n(h[0],e.width),u=e.y+n(h[1],e.height),d=d||"left",p=p||"top",g){switch(g){case"middle":u-=i.height/2-i.lineHeight/2;break;case"bottom":u-=i.height-i.lineHeight/2;break;default:u+=i.lineHeight/2;}p="middle";}}else{var v=r.adjustTextPositionOnRect(h,e,i,c);l=v.x,u=v.y,d=d||v.textAlign,p=p||v.textBaseline;}t.textAlign=d||"left",t.textBaseline=p||"alphabetic";var y=o.textFill,x=o.textStroke;y&&(t.fillStyle=y),x&&(t.strokeStyle=x),t.font=f||"12px sans-serif",t.shadowBlur=o.textShadowBlur,t.shadowColor=o.textShadowColor||"transparent",t.shadowOffsetX=o.textShadowOffsetX,t.shadowOffsetY=o.textShadowOffsetY;var _=s.split("\n");o.textRotation&&(m&&t.translate(m[4],m[5]),t.rotate(o.textRotation),m&&t.translate(-m[4],-m[5]));for(var b=0;b<_.length;b++){y&&t.fillText(_[b],l,u),x&&t.strokeText(_[b],l,u),u+=i.lineHeight;}t.restore();}}},t.exports=s;},function(t,e,i){"use strict";var n=i(50),r=i(10),o=i(51),a=i(9),s=i(41).devicePixelRatio,l={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},u=[],h=[],c=[],d=[],f=Math.min,p=Math.max,g=Math.cos,m=Math.sin,v=Math.sqrt,y=Math.abs,x="undefined"!=typeof Float32Array,_=function _(){this.data=[],this._len=0,this._ctx=null,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._ux=0,this._uy=0;};_.prototype={constructor:_,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function setScale(t,e){this._ux=y(1/s/t)||0,this._uy=y(1/s/e)||0;},getContext:function getContext(){return this._ctx;},beginPath:function beginPath(t){return this._ctx=t,t&&t.beginPath(),t&&(this.dpr=t.dpr),this._len=0,this._lineDash&&(this._lineDash=null,this._dashOffset=0),this;},moveTo:function moveTo(t,e){return this.addData(l.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this;},lineTo:function lineTo(t,e){var i=y(t-this._xi)>this._ux||y(e-this._yi)>this._uy||this._len<5;return this.addData(l.L,t,e),this._ctx&&i&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),i&&(this._xi=t,this._yi=e),this;},bezierCurveTo:function bezierCurveTo(t,e,i,n,r,o){return this.addData(l.C,t,e,i,n,r,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,r,o):this._ctx.bezierCurveTo(t,e,i,n,r,o)),this._xi=r,this._yi=o,this;},quadraticCurveTo:function quadraticCurveTo(t,e,i,n){return this.addData(l.Q,t,e,i,n),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this;},arc:function arc(t,e,i,n,r,o){return this.addData(l.A,t,e,i,i,n,r-n,0,o?0:1),this._ctx&&this._ctx.arc(t,e,i,n,r,o),this._xi=g(r)*i+t,this._xi=m(r)*i+t,this;},arcTo:function arcTo(t,e,i,n,r){return this._ctx&&this._ctx.arcTo(t,e,i,n,r),this;},rect:function rect(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this.addData(l.R,t,e,i,n),this;},closePath:function closePath(){this.addData(l.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this;},fill:function fill(t){t&&t.fill(),this.toStatic();},stroke:function stroke(t){t&&t.stroke(),this.toStatic();},setLineDash:function setLineDash(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;for(var e=0,i=0;i<t.length;i++){e+=t[i];}this._dashSum=e;}return this;},setLineDashOffset:function setLineDashOffset(t){return this._dashOffset=t,this;},len:function len(){return this._len;},setData:function setData(t){var e=t.length;this.data&&this.data.length==e||!x||(this.data=new Float32Array(e));for(var i=0;e>i;i++){this.data[i]=t[i];}this._len=e;},appendPath:function appendPath(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,r=0;e>r;r++){i+=t[r].len();}x&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i));for(var r=0;e>r;r++){for(var o=t[r].data,a=0;a<o.length;a++){this.data[n++]=o[a];}}this._len=n;},addData:function addData(t){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++){e[this._len++]=arguments[i];}this._prevCmd=t;},_expandData:function _expandData(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++){t[e]=this.data[e];}this.data=t;}},_needsDash:function _needsDash(){return this._lineDash;},_dashedLineTo:function _dashedLineTo(t,e){var i,n,r=this._dashSum,o=this._dashOffset,a=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,h=t-l,c=e-u,d=v(h*h+c*c),g=l,m=u,y=a.length;for(h/=d,c/=d,0>o&&(o=r+o),o%=r,g-=o*h,m-=o*c;h>0&&t>=g||0>h&&g>=t||0==h&&(c>0&&e>=m||0>c&&m>=e);){n=this._dashIdx,i=a[n],g+=h*i,m+=c*i,this._dashIdx=(n+1)%y,h>0&&l>g||0>h&&g>l||c>0&&u>m||0>c&&m>u||s[n%2?"moveTo":"lineTo"](h>=0?f(g,t):p(g,t),c>=0?f(m,e):p(m,e));}h=g-t,c=m-e,this._dashOffset=-v(h*h+c*c);},_dashedBezierTo:function _dashedBezierTo(t,e,i,r,o,a){var s,l,u,h,c,d=this._dashSum,f=this._dashOffset,p=this._lineDash,g=this._ctx,m=this._xi,y=this._yi,x=n.cubicAt,_=0,b=this._dashIdx,w=p.length,S=0;for(0>f&&(f=d+f),f%=d,s=0;1>s;s+=.1){l=x(m,t,i,o,s+.1)-x(m,t,i,o,s),u=x(y,e,r,a,s+.1)-x(y,e,r,a,s),_+=v(l*l+u*u);}for(;w>b&&(S+=p[b],!(S>f));b++){}for(s=(S-f)/_;1>=s;){h=x(m,t,i,o,s),c=x(y,e,r,a,s),b%2?g.moveTo(h,c):g.lineTo(h,c),s+=p[b]/_,b=(b+1)%w;}b%2!==0&&g.lineTo(o,a),l=o-h,u=a-c,this._dashOffset=-v(l*l+u*u);},_dashedQuadraticTo:function _dashedQuadraticTo(t,e,i,n){var r=i,o=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,r,o);},toStatic:function toStatic(){var t=this.data;t instanceof Array&&(t.length=this._len,x&&(this.data=new Float32Array(t)));},getBoundingRect:function getBoundingRect(){u[0]=u[1]=c[0]=c[1]=Number.MAX_VALUE,h[0]=h[1]=d[0]=d[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,i=0,n=0,s=0,f=0;f<t.length;){var p=t[f++];switch(1==f&&(e=t[f],i=t[f+1],n=e,s=i),p){case l.M:n=t[f++],s=t[f++],e=n,i=s,c[0]=n,c[1]=s,d[0]=n,d[1]=s;break;case l.L:o.fromLine(e,i,t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.C:o.fromCubic(e,i,t[f++],t[f++],t[f++],t[f++],t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.Q:o.fromQuadratic(e,i,t[f++],t[f++],t[f],t[f+1],c,d),e=t[f++],i=t[f++];break;case l.A:var v=t[f++],y=t[f++],x=t[f++],_=t[f++],b=t[f++],w=t[f++]+b,S=(t[f++],1-t[f++]);1==f&&(n=g(b)*x+v,s=m(b)*_+y),o.fromArc(v,y,x,_,b,w,S,c,d),e=g(w)*x+v,i=m(w)*_+y;break;case l.R:n=e=t[f++],s=i=t[f++];var M=t[f++],I=t[f++];o.fromLine(n,s,n+M,s+I,c,d);break;case l.Z:e=n,i=s;}r.min(u,u,c),r.max(h,h,d);}return 0===f&&(u[0]=u[1]=h[0]=h[1]=0),new a(u[0],u[1],h[0]-u[0],h[1]-u[1]);},rebuildPath:function rebuildPath(t){for(var e,i,n,r,o,a,s=this.data,u=this._ux,h=this._uy,c=this._len,d=0;c>d;){var f=s[d++];switch(1==d&&(n=s[d],r=s[d+1],e=n,i=r),f){case l.M:e=n=s[d++],i=r=s[d++],t.moveTo(n,r);break;case l.L:o=s[d++],a=s[d++],(y(o-n)>u||y(a-r)>h||d===c-1)&&(t.lineTo(o,a),n=o,r=a);break;case l.C:t.bezierCurveTo(s[d++],s[d++],s[d++],s[d++],s[d++],s[d++]),n=s[d-2],r=s[d-1];break;case l.Q:t.quadraticCurveTo(s[d++],s[d++],s[d++],s[d++]),n=s[d-2],r=s[d-1];break;case l.A:var p=s[d++],v=s[d++],x=s[d++],_=s[d++],b=s[d++],w=s[d++],S=s[d++],M=s[d++],I=x>_?x:_,T=x>_?1:x/_,A=x>_?_/x:1,L=Math.abs(x-_)>.001,C=b+w;L?(t.translate(p,v),t.rotate(S),t.scale(T,A),t.arc(0,0,I,b,C,1-M),t.scale(1/T,1/A),t.rotate(-S),t.translate(-p,-v)):t.arc(p,v,I,b,C,1-M),1==d&&(e=g(b)*x+p,i=m(b)*_+v),n=g(C)*x+p,r=m(C)*_+v;break;case l.R:e=n=s[d],i=r=s[d+1],t.rect(s[d++],s[d++],s[d++],s[d++]);break;case l.Z:t.closePath(),n=e,r=i;}}}},_.CMD=l,t.exports=_;},function(t,e,i){"use strict";function n(t){return t>-w&&w>t;}function r(t){return t>w||-w>t;}function o(t,e,i,n,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*n+3*o*i);}function a(t,e,i,n,r){var o=1-r;return 3*(((e-t)*o+2*(i-e)*r)*o+(n-i)*r*r);}function s(t,e,i,r,o,a){var s=r+3*(e-i)-t,l=3*(i-2*e+t),u=3*(e-t),h=t-o,c=l*l-3*s*u,d=l*u-9*s*h,f=u*u-3*l*h,p=0;if(n(c)&&n(d)){if(n(l))a[0]=0;else{var g=-u/l;g>=0&&1>=g&&(a[p++]=g);}}else{var m=d*d-4*c*f;if(n(m)){var v=d/c,g=-l/s+v,y=-v/2;g>=0&&1>=g&&(a[p++]=g),y>=0&&1>=y&&(a[p++]=y);}else if(m>0){var x=b(m),w=c*l+1.5*s*(-d+x),S=c*l+1.5*s*(-d-x);w=0>w?-_(-w,I):_(w,I),S=0>S?-_(-S,I):_(S,I);var g=(-l-(w+S))/(3*s);g>=0&&1>=g&&(a[p++]=g);}else{var T=(2*c*l-3*s*d)/(2*b(c*c*c)),A=Math.acos(T)/3,L=b(c),C=Math.cos(A),g=(-l-2*L*C)/(3*s),y=(-l+L*(C+M*Math.sin(A)))/(3*s),D=(-l+L*(C-M*Math.sin(A)))/(3*s);g>=0&&1>=g&&(a[p++]=g),y>=0&&1>=y&&(a[p++]=y),D>=0&&1>=D&&(a[p++]=D);}}return p;}function l(t,e,i,o,a){var s=6*i-12*e+6*t,l=9*e+3*o-3*t-9*i,u=3*e-3*t,h=0;if(n(l)){if(r(s)){var c=-u/s;c>=0&&1>=c&&(a[h++]=c);}}else{var d=s*s-4*l*u;if(n(d))a[0]=-s/(2*l);else if(d>0){var f=b(d),c=(-s+f)/(2*l),p=(-s-f)/(2*l);c>=0&&1>=c&&(a[h++]=c),p>=0&&1>=p&&(a[h++]=p);}}return h;}function u(t,e,i,n,r,o){var a=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-a)*r+a,h=(l-s)*r+s,c=(h-u)*r+u;o[0]=t,o[1]=a,o[2]=u,o[3]=c,o[4]=c,o[5]=h,o[6]=l,o[7]=n;}function h(t,e,i,n,r,a,s,l,u,h,c){var d,f,p,g,m,v=.005,y=1/0;T[0]=u,T[1]=h;for(var _=0;1>_;_+=.05){A[0]=o(t,i,r,s,_),A[1]=o(e,n,a,l,_),g=x(T,A),y>g&&(d=_,y=g);}y=1/0;for(var w=0;32>w&&!(S>v);w++){f=d-v,p=d+v,A[0]=o(t,i,r,s,f),A[1]=o(e,n,a,l,f),g=x(A,T),f>=0&&y>g?(d=f,y=g):(L[0]=o(t,i,r,s,p),L[1]=o(e,n,a,l,p),m=x(L,T),1>=p&&y>m?(d=p,y=m):v*=.5);}return c&&(c[0]=o(t,i,r,s,d),c[1]=o(e,n,a,l,d)),b(y);}function c(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i;}function d(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e));}function f(t,e,i,o,a){var s=t-2*e+i,l=2*(e-t),u=t-o,h=0;if(n(s)){if(r(l)){var c=-u/l;c>=0&&1>=c&&(a[h++]=c);}}else{var d=l*l-4*s*u;if(n(d)){var c=-l/(2*s);c>=0&&1>=c&&(a[h++]=c);}else if(d>0){var f=b(d),c=(-l+f)/(2*s),p=(-l-f)/(2*s);c>=0&&1>=c&&(a[h++]=c),p>=0&&1>=p&&(a[h++]=p);}}return h;}function p(t,e,i){var n=t+i-2*e;return 0===n?.5:(t-e)/n;}function g(t,e,i,n,r){var o=(e-t)*n+t,a=(i-e)*n+e,s=(a-o)*n+o;r[0]=t,r[1]=o,r[2]=s,r[3]=s,r[4]=a,r[5]=i;}function m(t,e,i,n,r,o,a,s,l){var u,h=.005,d=1/0;T[0]=a,T[1]=s;for(var f=0;1>f;f+=.05){A[0]=c(t,i,r,f),A[1]=c(e,n,o,f);var p=x(T,A);d>p&&(u=f,d=p);}d=1/0;for(var g=0;32>g&&!(S>h);g++){var m=u-h,v=u+h;A[0]=c(t,i,r,m),A[1]=c(e,n,o,m);var p=x(A,T);if(m>=0&&d>p)u=m,d=p;else{L[0]=c(t,i,r,v),L[1]=c(e,n,o,v);var y=x(L,T);1>=v&&d>y?(u=v,d=y):h*=.5;}}return l&&(l[0]=c(t,i,r,u),l[1]=c(e,n,o,u)),b(d);}var v=i(10),y=v.create,x=v.distSquare,_=Math.pow,b=Math.sqrt,w=1e-8,S=1e-4,M=b(3),I=1/3,T=y(),A=y(),L=y();t.exports={cubicAt:o,cubicDerivativeAt:a,cubicRootAt:s,cubicExtrema:l,cubicSubdivide:u,cubicProjectPoint:h,quadraticAt:c,quadraticDerivativeAt:d,quadraticRootAt:f,quadraticExtremum:p,quadraticSubdivide:g,quadraticProjectPoint:m};},function(t,e,i){var n=i(10),r=i(50),o={},a=Math.min,s=Math.max,l=Math.sin,u=Math.cos,h=n.create(),c=n.create(),d=n.create(),f=2*Math.PI;o.fromPoints=function(t,e,i){if(0!==t.length){var n,r=t[0],o=r[0],l=r[0],u=r[1],h=r[1];for(n=1;n<t.length;n++){r=t[n],o=a(o,r[0]),l=s(l,r[0]),u=a(u,r[1]),h=s(h,r[1]);}e[0]=o,e[1]=u,i[0]=l,i[1]=h;}},o.fromLine=function(t,e,i,n,r,o){r[0]=a(t,i),r[1]=a(e,n),o[0]=s(t,i),o[1]=s(e,n);};var p=[],g=[];o.fromCubic=function(t,e,i,n,o,l,u,h,c,d){var f,m=r.cubicExtrema,v=r.cubicAt,y=m(t,i,o,u,p);for(c[0]=1/0,c[1]=1/0,d[0]=-(1/0),d[1]=-(1/0),f=0;y>f;f++){var x=v(t,i,o,u,p[f]);c[0]=a(x,c[0]),d[0]=s(x,d[0]);}for(y=m(e,n,l,h,g),f=0;y>f;f++){var _=v(e,n,l,h,g[f]);c[1]=a(_,c[1]),d[1]=s(_,d[1]);}c[0]=a(t,c[0]),d[0]=s(t,d[0]),c[0]=a(u,c[0]),d[0]=s(u,d[0]),c[1]=a(e,c[1]),d[1]=s(e,d[1]),c[1]=a(h,c[1]),d[1]=s(h,d[1]);},o.fromQuadratic=function(t,e,i,n,o,l,u,h){var c=r.quadraticExtremum,d=r.quadraticAt,f=s(a(c(t,i,o),1),0),p=s(a(c(e,n,l),1),0),g=d(t,i,o,f),m=d(e,n,l,p);u[0]=a(t,o,g),u[1]=a(e,l,m),h[0]=s(t,o,g),h[1]=s(e,l,m);},o.fromArc=function(t,e,i,r,o,a,s,p,g){var m=n.min,v=n.max,y=Math.abs(o-a);if(1e-4>y%f&&y>1e-4)return p[0]=t-i,p[1]=e-r,g[0]=t+i,void(g[1]=e+r);if(h[0]=u(o)*i+t,h[1]=l(o)*r+e,c[0]=u(a)*i+t,c[1]=l(a)*r+e,m(p,h,c),v(g,h,c),o%=f,0>o&&(o+=f),a%=f,0>a&&(a+=f),o>a&&!s?a+=f:a>o&&s&&(o+=f),s){var x=a;a=o,o=x;}for(var _=0;a>_;_+=Math.PI/2){_>o&&(d[0]=u(_)*i+t,d[1]=l(_)*r+e,m(p,d,p),v(g,d,g));}},t.exports=o;},function(t,e,i){"use strict";function n(t,e){return Math.abs(t-e)<x;}function r(){var t=b[0];b[0]=b[1],b[1]=t;}function o(t,e,i,n,o,a,s,l,u,h){if(h>e&&h>n&&h>a&&h>l||e>h&&n>h&&a>h&&l>h)return 0;var c=g.cubicRootAt(e,n,a,l,h,_);if(0===c)return 0;for(var d,f,p=0,m=-1,v=0;c>v;v++){var y=_[v],x=0===y||1===y?.5:1,w=g.cubicAt(t,i,o,s,y);u>w||(0>m&&(m=g.cubicExtrema(e,n,a,l,b),b[1]<b[0]&&m>1&&r(),d=g.cubicAt(e,n,a,l,b[0]),m>1&&(f=g.cubicAt(e,n,a,l,b[1]))),p+=2==m?y<b[0]?e>d?x:-x:y<b[1]?d>f?x:-x:f>l?x:-x:y<b[0]?e>d?x:-x:d>l?x:-x);}return p;}function a(t,e,i,n,r,o,a,s){if(s>e&&s>n&&s>o||e>s&&n>s&&o>s)return 0;var l=g.quadraticRootAt(e,n,o,s,_);if(0===l)return 0;var u=g.quadraticExtremum(e,n,o);if(u>=0&&1>=u){for(var h=0,c=g.quadraticAt(e,n,o,u),d=0;l>d;d++){var f=0===_[d]||1===_[d]?.5:1,p=g.quadraticAt(t,i,r,_[d]);a>p||(h+=_[d]<u?e>c?f:-f:c>o?f:-f);}return h;}var f=0===_[0]||1===_[0]?.5:1,p=g.quadraticAt(t,i,r,_[0]);return a>p?0:e>o?f:-f;}function s(t,e,i,n,r,o,a,s){if(s-=e,s>i||-i>s)return 0;var l=Math.sqrt(i*i-s*s);_[0]=-l,_[1]=l;var u=Math.abs(n-r);if(1e-4>u)return 0;if(1e-4>u%y){n=0,r=y;var h=o?1:-1;return a>=_[0]+t&&a<=_[1]+t?h:0;}if(o){var l=n;n=p(r),r=p(l);}else n=p(n),r=p(r);n>r&&(r+=y);for(var c=0,d=0;2>d;d++){var f=_[d];if(f+t>a){var g=Math.atan2(s,f),h=o?1:-1;0>g&&(g=y+g),(g>=n&&r>=g||g+y>=n&&r>=g+y)&&(g>Math.PI/2&&g<1.5*Math.PI&&(h=-h),c+=h);}}return c;}function l(t,e,i,r,l){for(var h=0,p=0,g=0,y=0,x=0,_=0;_<t.length;){var b=t[_++];switch(b===u.M&&_>1&&(i||(h+=m(p,g,y,x,r,l))),1==_&&(p=t[_],g=t[_+1],y=p,x=g),b){case u.M:y=t[_++],x=t[_++],p=y,g=x;break;case u.L:if(i){if(v(p,g,t[_],t[_+1],e,r,l))return!0;}else h+=m(p,g,t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.C:if(i){if(c.containStroke(p,g,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],e,r,l))return!0;}else h+=o(p,g,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.Q:if(i){if(d.containStroke(p,g,t[_++],t[_++],t[_],t[_+1],e,r,l))return!0;}else h+=a(p,g,t[_++],t[_++],t[_],t[_+1],r,l)||0;p=t[_++],g=t[_++];break;case u.A:var w=t[_++],S=t[_++],M=t[_++],I=t[_++],T=t[_++],A=t[_++],L=(t[_++],1-t[_++]),C=Math.cos(T)*M+w,D=Math.sin(T)*I+S;_>1?h+=m(p,g,C,D,r,l):(y=C,x=D);var P=(r-w)*I/M+w;if(i){if(f.containStroke(w,S,I,T,T+A,L,e,P,l))return!0;}else h+=s(w,S,I,T,T+A,L,P,l);p=Math.cos(T+A)*M+w,g=Math.sin(T+A)*I+S;break;case u.R:y=p=t[_++],x=g=t[_++];var k=t[_++],z=t[_++],C=y+k,D=x+z;if(i){if(v(y,x,C,x,e,r,l)||v(C,x,C,D,e,r,l)||v(C,D,y,D,e,r,l)||v(y,D,y,x,e,r,l))return!0;}else h+=m(C,x,C,D,r,l),h+=m(y,D,y,x,r,l);break;case u.Z:if(i){if(v(p,g,y,x,e,r,l))return!0;}else h+=m(p,g,y,x,r,l);p=y,g=x;}}return i||n(g,x)||(h+=m(p,g,y,x,r,l)||0),0!==h;}var u=i(49).CMD,h=i(53),c=i(54),d=i(55),f=i(56),p=i(57).normalizeRadian,g=i(50),m=i(58),v=h.containStroke,y=2*Math.PI,x=1e-4,_=[-1,-1,-1],b=[-1,-1];t.exports={contain:function contain(t,e,i){return l(t,0,!1,e,i);},containStroke:function containStroke(t,e,i,n){return l(t,e,!0,i,n);}};},function(t,e){t.exports={containStroke:function containStroke(t,e,i,n,r,o,a){if(0===r)return!1;var s=r,l=0,u=t;if(a>e+s&&a>n+s||e-s>a&&n-s>a||o>t+s&&o>i+s||t-s>o&&i-s>o)return!1;if(t===i)return Math.abs(o-t)<=s/2;l=(e-n)/(t-i),u=(t*n-i*e)/(t-i);var h=l*o-a+u,c=h*h/(l*l+1);return s/2*s/2>=c;}};},function(t,e,i){var n=i(50);t.exports={containStroke:function containStroke(t,e,i,r,o,a,s,l,u,h,c){if(0===u)return!1;var d=u;if(c>e+d&&c>r+d&&c>a+d&&c>l+d||e-d>c&&r-d>c&&a-d>c&&l-d>c||h>t+d&&h>i+d&&h>o+d&&h>s+d||t-d>h&&i-d>h&&o-d>h&&s-d>h)return!1;var f=n.cubicProjectPoint(t,e,i,r,o,a,s,l,h,c,null);return d/2>=f;}};},function(t,e,i){var n=i(50);t.exports={containStroke:function containStroke(t,e,i,r,o,a,s,l,u){if(0===s)return!1;var h=s;if(u>e+h&&u>r+h&&u>a+h||e-h>u&&r-h>u&&a-h>u||l>t+h&&l>i+h&&l>o+h||t-h>l&&i-h>l&&o-h>l)return!1;var c=n.quadraticProjectPoint(t,e,i,r,o,a,l,u,null);return h/2>=c;}};},function(t,e,i){var n=i(57).normalizeRadian,r=2*Math.PI;t.exports={containStroke:function containStroke(t,e,i,o,a,s,l,u,h){if(0===l)return!1;var c=l;u-=t,h-=e;var d=Math.sqrt(u*u+h*h);if(d-c>i||i>d+c)return!1;if(Math.abs(o-a)%r<1e-4)return!0;if(s){var f=o;o=n(a),a=n(f);}else o=n(o),a=n(a);o>a&&(a+=r);var p=Math.atan2(h,u);return 0>p&&(p+=r),p>=o&&a>=p||p+r>=o&&a>=p+r;}};},function(t,e){var i=2*Math.PI;t.exports={normalizeRadian:function normalizeRadian(t){return t%=i,0>t&&(t+=i),t;}};},function(t,e){t.exports=function(t,e,i,n,r,o){if(o>e&&o>n||e>o&&n>o)return 0;if(n===e)return 0;var a=e>n?1:-1,s=(o-e)/(n-e);(1===s||0===s)&&(a=e>n?.5:-.5);var l=s*(i-t)+t;return l>r?a:0;};},function(t,e){var i=function i(t,e){this.image=t,this.repeat=e,this.type="pattern";};i.prototype.getCanvasPattern=function(t){return this._canvasPattern||(this._canvasPattern=t.createPattern(this.image,this.repeat));},t.exports=i;},function(t,e,i){function n(t,e){var i,n,o,h,c,d,f=t.data,p=r.M,g=r.C,m=r.L,v=r.R,y=r.A,x=r.Q;for(o=0,h=0;o<f.length;){switch(i=f[o++],h=o,n=0,i){case p:n=1;break;case m:n=1;break;case g:n=3;break;case x:n=2;break;case y:var _=e[4],b=e[5],w=l(e[0]*e[0]+e[1]*e[1]),S=l(e[2]*e[2]+e[3]*e[3]),M=u(-e[1]/S,e[0]/w);f[o++]+=_,f[o++]+=b,f[o++]*=w,f[o++]*=S,f[o++]+=M,f[o++]+=M,o+=2,h=o;break;case v:d[0]=f[o++],d[1]=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1],d[0]+=f[o++],d[1]+=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1];}for(c=0;n>c;c++){var d=s[c];d[0]=f[o++],d[1]=f[o++],a(d,d,e),f[h++]=d[0],f[h++]=d[1];}}}var r=i(49).CMD,o=i(10),a=o.applyTransform,s=[[],[],[]],l=Math.sqrt,u=Math.atan2;t.exports=n;},function(t,e){var i=function i(t){this.colorStops=t||[];};i.prototype={constructor:i,addColorStop:function addColorStop(t,e){this.colorStops.push({offset:t,color:e});}},t.exports=i;},function(t,e,i){function n(t){r.call(this,t);}var r=i(46),o=i(9),a=i(4),s=i(63),l=new s(50);n.prototype={constructor:n,type:"image",brush:function brush(t,e){var i,n=this.style,r=n.image;if(n.bind(t,this,e),i="string"==typeof r?this._image:r,!i&&r){var o=l.get(r);if(!o)return i=new Image(),i.onload=function(){i.onload=null;for(var t=0;t<o.pending.length;t++){o.pending[t].dirty();}},o={image:i,pending:[this]},i.src=r,l.put(r,o),void(this._image=i);if(i=o.image,this._image=i,!i.width||!i.height)return void o.pending.push(this);}if(i){var a=n.width||i.width,s=n.height||i.height,u=n.x||0,h=n.y||0;if(!i.width||!i.height)return;if(this.setTransform(t),n.sWidth&&n.sHeight){var c=n.sx||0,d=n.sy||0;t.drawImage(i,c,d,n.sWidth,n.sHeight,u,h,a,s);}else if(n.sx&&n.sy){var c=n.sx,d=n.sy,f=a-c,p=s-d;t.drawImage(i,c,d,f,p,u,h,a,s);}else t.drawImage(i,u,h,a,s);null==n.width&&(n.width=a),null==n.height&&(n.height=s),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect());}},getBoundingRect:function getBoundingRect(){var t=this.style;return this._rect||(this._rect=new o(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect;}},a.inherits(n,r),t.exports=n;},function(t,e){var i=function i(){this.head=null,this.tail=null,this._len=0;},n=i.prototype;n.insert=function(t){var e=new r(t);return this.insertEntry(e),e;},n.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,this._len++;},n.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--;},n.len=function(){return this._len;};var r=function r(t){this.value=t,this.next,this.prev;},o=function o(t){this._list=new i(),this._map={},this._maxSize=t||10;},a=o.prototype;a.put=function(t,e){var i=this._list,n=this._map;if(null==n[t]){var r=i.len();if(r>=this._maxSize&&r>0){var o=i.head;i.remove(o),delete n[o.key];}var a=i.insert(e);a.key=t,n[t]=a;}},a.get=function(t){var e=this._map[t],i=this._list;return null!=e?(e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value):void 0;},a.clear=function(){this._list.clear(),this._map={};},t.exports=o;},function(t,e,i){var n=i(46),r=i(4),o=i(8),a=function a(t){n.call(this,t);};a.prototype={constructor:a,type:"text",brush:function brush(t,e){var i=this.style,n=i.x||0,r=i.y||0,a=i.text;if(null!=a&&(a+=""),i.bind(t,this,e),a){this.setTransform(t);var s,l=i.textAlign,u=i.textFont||i.font;if(i.textVerticalAlign){var h=o.getBoundingRect(a,u,i.textAlign,"top");switch(s="middle",i.textVerticalAlign){case"middle":r-=h.height/2-h.lineHeight/2;break;case"bottom":r-=h.height-h.lineHeight/2;break;default:r+=h.lineHeight/2;}}else s=i.textBaseline;t.font=u||"12px sans-serif",t.textAlign=l||"left",t.textAlign!==l&&(t.textAlign="left"),t.textBaseline=s||"alphabetic",t.textBaseline!==s&&(t.textBaseline="alphabetic");for(var c=o.measureText("",t.font).width,d=a.split("\n"),f=0;f<d.length;f++){i.hasFill()&&t.fillText(d[f],n,r),i.hasStroke()&&t.strokeText(d[f],n,r),r+=c;}this.restoreTransform(t);}},getBoundingRect:function getBoundingRect(){if(!this._rect){var t=this.style,e=t.textVerticalAlign,i=o.getBoundingRect(t.text+"",t.textFont||t.font,t.textAlign,e?"top":t.textBaseline);switch(e){case"middle":i.y-=i.height/2;break;case"bottom":i.y-=i.height;}i.x+=t.x||0,i.y+=t.y||0,this._rect=i;}return this._rect;}},r.inherits(a,n),t.exports=a;},function(t,e,i){"use strict";t.exports=i(45).extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function buildPath(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0);}});},function(t,e,i){t.exports=i(45).extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=e.startAngle,s=e.endAngle,l=e.clockwise,u=Math.cos(a),h=Math.sin(a);t.moveTo(u*r+i,h*r+n),t.lineTo(u*o+i,h*o+n),t.arc(i,n,o,a,s,!l),t.lineTo(Math.cos(s)*r+i,Math.sin(s)*r+n),0!==r&&t.arc(i,n,r,s,a,l),t.closePath();}});},function(t,e,i){t.exports=i(45).extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,r,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,r,!0);}});},function(t,e,i){var n=i(69);t.exports=i(45).extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function buildPath(t,e){n.buildPath(t,e,!0);}});},function(t,e,i){var n=i(70),r=i(71);t.exports={buildPath:function buildPath(t,e,i){var o=e.points,a=e.smooth;if(o&&o.length>=2){if(a&&"spline"!==a){var s=r(o,a,i,e.smoothConstraint);t.moveTo(o[0][0],o[0][1]);for(var l=o.length,u=0;(i?l:l-1)>u;u++){var h=s[2*u],c=s[2*u+1],d=o[(u+1)%l];t.bezierCurveTo(h[0],h[1],c[0],c[1],d[0],d[1]);}}else{"spline"===a&&(o=n(o,i)),t.moveTo(o[0][0],o[0][1]);for(var u=1,f=o.length;f>u;u++){t.lineTo(o[u][0],o[u][1]);}}i&&t.closePath();}}};},function(t,e,i){function n(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e;}var r=i(10);t.exports=function(t,e){for(var i=t.length,o=[],a=0,s=1;i>s;s++){a+=r.distance(t[s-1],t[s]);}var l=a/2;l=i>l?i:l;for(var s=0;l>s;s++){var u,h,c,d=s/(l-1)*(e?i:i-1),f=Math.floor(d),p=d-f,g=t[f%i];e?(u=t[(f-1+i)%i],h=t[(f+1)%i],c=t[(f+2)%i]):(u=t[0===f?f:f-1],h=t[f>i-2?i-1:f+1],c=t[f>i-3?i-1:f+2]);var m=p*p,v=p*m;o.push([n(u[0],g[0],h[0],c[0],p,m,v),n(u[1],g[1],h[1],c[1],p,m,v)]);}return o;};},function(t,e,i){var n=i(10),r=n.min,o=n.max,a=n.scale,s=n.distance,l=n.add;t.exports=function(t,e,i,u){var h,c,d,f,p=[],g=[],m=[],v=[];if(u){d=[1/0,1/0],f=[-(1/0),-(1/0)];for(var y=0,x=t.length;x>y;y++){r(d,d,t[y]),o(f,f,t[y]);}r(d,d,u[0]),o(f,f,u[1]);}for(var y=0,x=t.length;x>y;y++){var _=t[y];if(i)h=t[y?y-1:x-1],c=t[(y+1)%x];else{if(0===y||y===x-1){p.push(n.clone(t[y]));continue;}h=t[y-1],c=t[y+1];}n.sub(g,c,h),a(g,g,e);var b=s(_,h),w=s(_,c),S=b+w;0!==S&&(b/=S,w/=S),a(m,g,-b),a(v,g,w);var M=l([],_,m),I=l([],_,v);u&&(o(M,M,d),r(M,M,f),o(I,I,d),r(I,I,f)),p.push(M),p.push(I);}return i&&p.push(p.shift()),p;};},function(t,e,i){var n=i(69);t.exports=i(45).extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){n.buildPath(t,e,!1);}});},function(t,e,i){var n=i(74);t.exports=i(45).extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.x,r=e.y,o=e.width,a=e.height;e.r?n.buildPath(t,e):t.rect(i,r,o,a),t.closePath();}});},function(t,e){t.exports={buildPath:function buildPath(t,e){var i,n,r,o,a=e.x,s=e.y,l=e.width,u=e.height,h=e.r;0>l&&(a+=l,l=-l),0>u&&(s+=u,u=-u),"number"==typeof h?i=n=r=o=h:h instanceof Array?1===h.length?i=n=r=o=h[0]:2===h.length?(i=r=h[0],n=o=h[1]):3===h.length?(i=h[0],n=o=h[1],r=h[2]):(i=h[0],n=h[1],r=h[2],o=h[3]):i=n=r=o=0;var c;i+n>l&&(c=i+n,i*=l/c,n*=l/c),r+o>l&&(c=r+o,r*=l/c,o*=l/c),n+r>u&&(c=n+r,n*=u/c,r*=u/c),i+o>u&&(c=i+o,i*=u/c,o*=u/c),t.moveTo(a+i,s),t.lineTo(a+l-n,s),0!==n&&t.quadraticCurveTo(a+l,s,a+l,s+n),t.lineTo(a+l,s+u-r),0!==r&&t.quadraticCurveTo(a+l,s+u,a+l-r,s+u),t.lineTo(a+o,s+u),0!==o&&t.quadraticCurveTo(a,s+u,a,s+u-o),t.lineTo(a,s+i),0!==i&&t.quadraticCurveTo(a,s,a+i,s);}};},function(t,e,i){t.exports=i(45).extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,a=e.percent;0!==a&&(t.moveTo(i,n),1>a&&(r=i*(1-a)+r*a,o=n*(1-a)+o*a),t.lineTo(r,o));},pointAt:function pointAt(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t];}});},function(t,e,i){"use strict";function n(t,e,i){var n=t.cpx2,r=t.cpy2;return null===n||null===r?[(i?c:u)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?c:u)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?h:l)(t.x1,t.cpx1,t.x2,e),(i?h:l)(t.y1,t.cpy1,t.y2,e)];}var r=i(50),o=i(10),a=r.quadraticSubdivide,s=r.cubicSubdivide,l=r.quadraticAt,u=r.cubicAt,h=r.quadraticDerivativeAt,c=r.cubicDerivativeAt,d=[];t.exports=i(45).extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,l=e.cpx1,u=e.cpy1,h=e.cpx2,c=e.cpy2,f=e.percent;0!==f&&(t.moveTo(i,n),null==h||null==c?(1>f&&(a(i,l,r,f,d),l=d[1],r=d[2],a(n,u,o,f,d),u=d[1],o=d[2]),t.quadraticCurveTo(l,u,r,o)):(1>f&&(s(i,l,h,r,f,d),l=d[1],h=d[2],r=d[3],s(n,u,c,o,f,d),u=d[1],c=d[2],o=d[3]),t.bezierCurveTo(l,u,h,c,r,o)));},pointAt:function pointAt(t){return n(this.shape,t,!1);},tangentAt:function tangentAt(t){var e=n(this.shape,t,!0);return o.normalize(e,e);}});},function(t,e,i){t.exports=i(45).extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*r+i,u*r+n),t.arc(i,n,r,o,a,!s);}});},function(t,e,i){var n=i(45);t.exports=n.extend({type:"compound",shape:{paths:null},_updatePathDirty:function _updatePathDirty(){for(var t=this.__dirtyPath,e=this.shape.paths,i=0;i<e.length;i++){t=t||e[i].__dirtyPath;}this.__dirtyPath=t,this.__dirty=this.__dirty||t;},beforeBrush:function beforeBrush(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),i=0;i<t.length;i++){t[i].path.setScale(e[0],e[1]);}},buildPath:function buildPath(t,e){for(var i=e.paths||[],n=0;n<i.length;n++){i[n].buildPath(t,i[n].shape,!0);}},afterBrush:function afterBrush(){for(var t=this.shape.paths,e=0;e<t.length;e++){t[e].__dirtyPath=!1;}},getBoundingRect:function getBoundingRect(){return this._updatePathDirty(),n.prototype.getBoundingRect.call(this);}});},function(t,e,i){"use strict";var n=i(4),r=i(61),o=function o(t,e,i,n,_o,a){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==i?1:i,this.y2=null==n?0:n,this.type="linear",this.global=a||!1,r.call(this,_o);};o.prototype={constructor:o},n.inherits(o,r),t.exports=o;},function(t,e,i){"use strict";var n=i(4),r=i(61),o=function o(t,e,i,n,_o2){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==i?.5:i,this.type="radial",this.global=_o2||!1,r.call(this,n);};o.prototype={constructor:o},n.inherits(o,r),t.exports=o;},function(t,e,i){function n(t){delete d[t];}var r=i(32),o=i(2),a=i(82),s=i(84),l=i(86),u=i(89),h=!o.canvasSupported,c={canvas:i(91)},d={},f={};f.version="3.2.1",f.init=function(t,e){var i=new p(r(),t,e);return d[i.id]=i,i;},f.dispose=function(t){if(t)t.dispose();else{for(var e in d){d.hasOwnProperty(e)&&d[e].dispose();}d={};}return f;},f.getInstance=function(t){return d[t];},f.registerPainter=function(t,e){c[t]=e;};var p=function p(t,e,i){i=i||{},this.dom=e,this.id=t;var n=this,r=new s(),d=i.renderer;if(h){if(!c.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");d="vml";}else d&&c[d]||(d="canvas");var f=new c[d](e,r,i);this.storage=r,this.painter=f;var p=o.node?null:new u(f.getViewportRoot());this.handler=new a(r,f,p,f.root),this.animation=new l({stage:{update:function update(){n._needsRefresh&&n.refreshImmediately(),n._needsRefreshHover&&n.refreshHoverImmediately();}}}),this.animation.start(),this._needsRefresh;var g=r.delFromMap,m=r.addToMap;r.delFromMap=function(t){var e=r.get(t);g.call(r,t),e&&e.removeSelfFromZr(n);},r.addToMap=function(t){m.call(r,t),t.addSelfToZr(n);};};p.prototype={constructor:p,getId:function getId(){return this.id;},add:function add(t){this.storage.addRoot(t),this._needsRefresh=!0;},remove:function remove(t){this.storage.delRoot(t),this._needsRefresh=!0;},configLayer:function configLayer(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0;},refreshImmediately:function refreshImmediately(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1;},refresh:function refresh(){this._needsRefresh=!0;},addHover:function addHover(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover());},removeHover:function removeHover(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover());},clearHover:function clearHover(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover());},refreshHover:function refreshHover(){this._needsRefreshHover=!0;},refreshHoverImmediately:function refreshHoverImmediately(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover();},resize:function resize(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize();},clearAnimation:function clearAnimation(){this.animation.clear();},getWidth:function getWidth(){return this.painter.getWidth();},getHeight:function getHeight(){return this.painter.getHeight();},pathToImage:function pathToImage(t,e,i){var n=r();return this.painter.pathToImage(n,t,e,i);},setCursorStyle:function setCursorStyle(t){this.handler.setCursorStyle(t);},on:function on(t,e,i){this.handler.on(t,e,i);},off:function off(t,e){this.handler.off(t,e);},trigger:function trigger(t,e){this.handler.trigger(t,e);},clear:function clear(){this.storage.delRoot(),this.painter.clear();},dispose:function dispose(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,n(this.id);}},t.exports=f;},function(t,e,i){"use strict";function n(t,e,i){return{type:t,event:i,target:e,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta};}function r(){}function o(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n=t;n;){if(n.silent||n.clipPath&&!n.clipPath.contain(e,i))return!1;n=n.parent;}return!0;}return!1;}var a=i(4),s=i(83),l=i(33);r.prototype.dispose=function(){};var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],h=function h(t,e,i,n){l.call(this),this.storage=t,this.painter=e,this.painterRoot=n,i=i||new r(),this.proxy=i,i.handler=this,this._hovered,this._lastTouchMoment,this._lastX,this._lastY,s.call(this),a.each(u,function(t){i.on&&i.on(t,this[t],this);},this);};h.prototype={constructor:h,mousemove:function mousemove(t){var e=t.zrX,i=t.zrY,n=this.findHover(e,i,null),r=this._hovered,o=this.proxy;this._hovered=n,o.setCursor&&o.setCursor(n?n.cursor:"default"),r&&n!==r&&r.__zr&&this.dispatchToElement(r,"mouseout",t),this.dispatchToElement(n,"mousemove",t),n&&n!==r&&this.dispatchToElement(n,"mouseover",t);},mouseout:function mouseout(t){this.dispatchToElement(this._hovered,"mouseout",t);var e,i=t.toElement||t.relatedTarget;do{i=i&&i.parentNode;}while(i&&9!=i.nodeType&&!(e=i===this.painterRoot));!e&&this.trigger("globalout",{event:t});},resize:function resize(t){this._hovered=null;},dispatch:function dispatch(t,e){var i=this[t];i&&i.call(this,e);},dispose:function dispose(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null;},setCursorStyle:function setCursorStyle(t){var e=this.proxy;e.setCursor&&e.setCursor(t);},dispatchToElement:function dispatchToElement(t,e,i){for(var r="on"+e,o=n(e,t,i),a=t;a&&(a[r]&&(o.cancelBubble=a[r].call(a,o)),a.trigger(e,o),a=a.parent,!o.cancelBubble);){}o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,o),t.trigger&&t.trigger(e,o);}));},findHover:function findHover(t,e,i){for(var n=this.storage.getDisplayList(),r=n.length-1;r>=0;r--){if(!n[r].silent&&n[r]!==i&&!n[r].ignore&&o(n[r],t,e))return n[r];}}},a.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){h.prototype[t]=function(e){var i=this.findHover(e.zrX,e.zrY,null);if("mousedown"===t)this._downel=i,this._upel=i;else if("mosueup"===t)this._upel=i;else if("click"===t&&this._downel!==this._upel)return;this.dispatchToElement(i,t,e);};}),a.mixin(h,l),a.mixin(h,s),t.exports=h;},function(t,e){function i(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this);}i.prototype={constructor:i,_dragStart:function _dragStart(t){var e=t.target;e&&e.draggable&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(e,"dragstart",t.event));},_drag:function _drag(t){var e=this._draggingTarget;if(e){var i=t.offsetX,n=t.offsetY,r=i-this._x,o=n-this._y;this._x=i,this._y=n,e.drift(r,o,t),this.dispatchToElement(e,"drag",t.event);var a=this.findHover(i,n,e),s=this._dropTarget;this._dropTarget=a,e!==a&&(s&&a!==s&&this.dispatchToElement(s,"dragleave",t.event),a&&a!==s&&this.dispatchToElement(a,"dragenter",t.event));}},_dragEnd:function _dragEnd(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(e,"dragend",t.event),this._dropTarget&&this.dispatchToElement(this._dropTarget,"drop",t.event),this._draggingTarget=null,this._dropTarget=null;}},t.exports=i;},function(t,e,i){"use strict";function n(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel;}var r=i(4),o=i(2),a=i(30),s=i(85),l=function l(){this._elements={},this._roots=[],this._displayList=[],this._displayListLen=0;};l.prototype={constructor:l,traverse:function traverse(t,e){for(var i=0;i<this._roots.length;i++){this._roots[i].traverse(t,e);}},getDisplayList:function getDisplayList(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList;},updateDisplayList:function updateDisplayList(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,r=0,a=e.length;a>r;r++){this._updateAndAddDisplayable(e[r],null,t);}i.length=this._displayListLen,o.canvasSupported&&s(i,n);},_updateAndAddDisplayable:function _updateAndAddDisplayable(t,e,i){if(!t.ignore||i){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var n=t.clipPath;if(n&&(n.parent=t,n.updateTransform(),e?(e=e.slice(),e.push(n)):e=[n]),t.isGroup){for(var r=t._children,o=0;o<r.length;o++){var a=r[o];t.__dirty&&(a.__dirty=!0),this._updateAndAddDisplayable(a,e,i);}t.__dirty=!1;}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t;}},addRoot:function addRoot(t){this._elements[t.id]||(t instanceof a&&t.addChildrenToStorage(this),this.addToMap(t),this._roots.push(t));},delRoot:function delRoot(t){if(null==t){for(var e=0;e<this._roots.length;e++){var i=this._roots[e];i instanceof a&&i.delChildrenFromStorage(this);}return this._elements={},this._roots=[],this._displayList=[],void(this._displayListLen=0);}if(t instanceof Array)for(var e=0,n=t.length;n>e;e++){this.delRoot(t[e]);}else{var o;o="string"==typeof t?this._elements[t]:t;var s=r.indexOf(this._roots,o);s>=0&&(this.delFromMap(o.id),this._roots.splice(s,1),o instanceof a&&o.delChildrenFromStorage(this));}},addToMap:function addToMap(t){return t instanceof a&&(t.__storage=this),t.dirty(!1),this._elements[t.id]=t,this;},get:function get(t){return this._elements[t];},delFromMap:function delFromMap(t){var e=this._elements,i=e[t];return i&&(delete e[t],i instanceof a&&(i.__storage=null)),this;},dispose:function dispose(){this._elements=this._renderList=this._roots=null;},displayableSortFunc:n},t.exports=l;},function(t,e){function i(t){for(var e=0;t>=h;){e|=1&t,t>>=1;}return t+e;}function n(t,e,i,n){var o=e+1;if(o===i)return 1;if(n(t[o++],t[e])<0){for(;i>o&&n(t[o],t[o-1])<0;){o++;}r(t,e,o);}else for(;i>o&&n(t[o],t[o-1])>=0;){o++;}return o-e;}function r(t,e,i){for(i--;i>e;){var n=t[e];t[e++]=t[i],t[i--]=n;}}function o(t,e,i,n,r){for(n===e&&n++;i>n;n++){for(var o,a=t[n],s=e,l=n;l>s;){o=s+l>>>1,r(a,t[o])<0?l=o:s=o+1;}var u=n-s;switch(u){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;u>0;){t[s+u]=t[s+u-1],u--;}}t[s]=a;}}function a(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])>0){for(s=n-r;s>l&&o(t,e[i+r+l])>0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s),a+=r,l+=r;}else{for(s=r+1;s>l&&o(t,e[i+r-l])<=0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s);var u=a;a=r-l,l=r-u;}for(a++;l>a;){var h=a+(l-a>>>1);o(t,e[i+h])>0?a=h+1:l=h;}return l;}function s(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])<0){for(s=r+1;s>l&&o(t,e[i+r-l])<0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s);var u=a;a=r-l,l=r-u;}else{for(s=n-r;s>l&&o(t,e[i+r+l])>=0;){a=l,l=(l<<1)+1,0>=l&&(l=s);}l>s&&(l=s),a+=r,l+=r;}for(a++;l>a;){var h=a+(l-a>>>1);o(t,e[i+h])<0?l=h:a=h+1;}return l;}function l(t,e){function i(t,e){h[y]=t,f[y]=e,y+=1;}function n(){for(;y>1;){var t=y-2;if(t>=1&&f[t-1]<=f[t]+f[t+1]||t>=2&&f[t-2]<=f[t]+f[t-1])f[t-1]<f[t+1]&&t--;else if(f[t]>f[t+1])break;o(t);}}function r(){for(;y>1;){var t=y-2;t>0&&f[t-1]<f[t+1]&&t--,o(t);}}function o(i){var n=h[i],r=f[i],o=h[i+1],c=f[i+1];f[i]=r+c,i===y-3&&(h[i+1]=h[i+2],f[i+1]=f[i+2]),y--;var d=s(t[o],t,n,r,0,e);n+=d,r-=d,0!==r&&(c=a(t[n+r-1],t,o,c,c-1,e),0!==c&&(c>=r?l(n,r,o,c):u(n,r,o,c)));}function l(i,n,r,o){var l=0;for(l=0;n>l;l++){x[l]=t[i+l];}var u=0,h=r,d=i;if(t[d++]=t[h++],0!==--o){if(1===n){for(l=0;o>l;l++){t[d+l]=t[h+l];}return void(t[d+o]=x[u]);}for(var f,g,m,v=p;;){f=0,g=0,m=!1;do{if(e(t[h],x[u])<0){if(t[d++]=t[h++],g++,f=0,0===--o){m=!0;break;}}else if(t[d++]=x[u++],f++,g=0,1===--n){m=!0;break;}}while(v>(f|g));if(m)break;do{if(f=s(t[h],x,u,n,0,e),0!==f){for(l=0;f>l;l++){t[d+l]=x[u+l];}if(d+=f,u+=f,n-=f,1>=n){m=!0;break;}}if(t[d++]=t[h++],0===--o){m=!0;break;}if(g=a(x[u],t,h,o,0,e),0!==g){for(l=0;g>l;l++){t[d+l]=t[h+l];}if(d+=g,h+=g,o-=g,0===o){m=!0;break;}}if(t[d++]=x[u++],1===--n){m=!0;break;}v--;}while(f>=c||g>=c);if(m)break;0>v&&(v=0),v+=2;}if(p=v,1>p&&(p=1),1===n){for(l=0;o>l;l++){t[d+l]=t[h+l];}t[d+o]=x[u];}else{if(0===n)throw new Error();for(l=0;n>l;l++){t[d+l]=x[u+l];}}}else for(l=0;n>l;l++){t[d+l]=x[u+l];}}function u(i,n,r,o){var l=0;for(l=0;o>l;l++){x[l]=t[r+l];}var u=i+n-1,h=o-1,d=r+o-1,f=0,g=0;if(t[d--]=t[u--],0!==--n){if(1===o){for(d-=n,u-=n,g=d+1,f=u+1,l=n-1;l>=0;l--){t[g+l]=t[f+l];}return void(t[d]=x[h]);}for(var m=p;;){var v=0,y=0,_=!1;do{if(e(x[h],t[u])<0){if(t[d--]=t[u--],v++,y=0,0===--n){_=!0;break;}}else if(t[d--]=x[h--],y++,v=0,1===--o){_=!0;break;}}while(m>(v|y));if(_)break;do{if(v=n-s(x[h],t,i,n,n-1,e),0!==v){for(d-=v,u-=v,n-=v,g=d+1,f=u+1,l=v-1;l>=0;l--){t[g+l]=t[f+l];}if(0===n){_=!0;break;}}if(t[d--]=x[h--],1===--o){_=!0;break;}if(y=o-a(t[u],x,0,o,o-1,e),0!==y){for(d-=y,h-=y,o-=y,g=d+1,f=h+1,l=0;y>l;l++){t[g+l]=x[f+l];}if(1>=o){_=!0;break;}}if(t[d--]=t[u--],0===--n){_=!0;break;}m--;}while(v>=c||y>=c);if(_)break;0>m&&(m=0),m+=2;}if(p=m,1>p&&(p=1),1===o){for(d-=n,u-=n,g=d+1,f=u+1,l=n-1;l>=0;l--){t[g+l]=t[f+l];}t[d]=x[h];}else{if(0===o)throw new Error();for(f=d-(o-1),l=0;o>l;l++){t[f+l]=x[l];}}}else for(f=d-(o-1),l=0;o>l;l++){t[f+l]=x[l];}}var h,f,p=c,g=0,m=d,v=0,y=0;g=t.length,2*d>g&&(m=g>>>1);var x=[];v=120>g?5:1542>g?10:119151>g?19:40,h=[],f=[],this.mergeRuns=n,this.forceMergeRuns=r,this.pushRun=i;}function u(t,e,r,a){r||(r=0),a||(a=t.length);var s=a-r;if(!(2>s)){var u=0;if(h>s)return u=n(t,r,a,e),void o(t,r,a,r+u,e);var c=new l(t,e),d=i(s);do{if(u=n(t,r,a,e),d>u){var f=s;f>d&&(f=d),o(t,r,r+f,r+u,e),u=f;}c.pushRun(r,u),c.mergeRuns(),s-=u,r+=u;}while(0!==s);c.forceMergeRuns();}}var h=32,c=7,d=256;t.exports=u;},function(t,e,i){"use strict";var n=i(4),r=i(87).Dispatcher,o=i(88),a=i(36),s=function s(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,r.call(this);};s.prototype={constructor:s,addClip:function addClip(t){this._clips.push(t);},addAnimator:function addAnimator(t){t.animation=this;for(var e=t.getClips(),i=0;i<e.length;i++){this.addClip(e[i]);}},removeClip:function removeClip(t){var e=n.indexOf(this._clips,t);e>=0&&this._clips.splice(e,1);},removeAnimator:function removeAnimator(t){for(var e=t.getClips(),i=0;i<e.length;i++){this.removeClip(e[i]);}t.animation=null;},_update:function _update(){for(var t=new Date().getTime()-this._pausedTime,e=t-this._time,i=this._clips,n=i.length,r=[],o=[],a=0;n>a;a++){var s=i[a],l=s.step(t);l&&(r.push(l),o.push(s));}for(var a=0;n>a;){i[a]._needsRemove?(i[a]=i[n-1],i.pop(),n--):a++;}n=r.length;for(var a=0;n>a;a++){o[a].fire(r[a]);}this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update();},_startLoop:function _startLoop(){function t(){e._running&&(o(t),!e._paused&&e._update());}var e=this;this._running=!0,o(t);},start:function start(){this._time=new Date().getTime(),this._pausedTime=0,this._startLoop();},stop:function stop(){this._running=!1;},pause:function pause(){this._paused||(this._pauseStart=new Date().getTime(),this._paused=!0);},resume:function resume(){this._paused&&(this._pausedTime+=new Date().getTime()-this._pauseStart,this._paused=!1);},clear:function clear(){this._clips=[];},animate:function animate(t,e){e=e||{};var i=new a(t,e.loop,e.getter,e.setter);return i;}},n.mixin(s,r),t.exports=s;},function(t,e,i){"use strict";function n(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0};}function r(t,e,i,n){if(i=i||{},n)o(t,e,i);else if(h.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX)i.zrX=e.layerX,i.zrY=e.layerY;else if(null!=e.offsetX){var r=window._echartDomZoom;i.zrX=e.offsetX/r,i.zrY=e.offsetY/r;}else o(t,e,i);return i;}function o(t,e,i){var r=window._echartDomZoom,o=n(t);i.zrX=e.clientX/r-o.left,i.zrY=e.clientY/r-o.top;}function a(t,e,i){if(e=e||window.event,null!=e.zrX)return e;var n=e.type,o=n&&n.indexOf("touch")>=0;if(o){var a="touchend"!=n?e.targetTouches[0]:e.changedTouches[0];a&&r(t,a,e,i);}else r(t,e,e,i),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;return e;}function s(t,e,i){c?t.addEventListener(e,i):t.attachEvent("on"+e,i);}function l(t,e,i){c?t.removeEventListener(e,i):t.detachEvent("on"+e,i);}var u=i(33),h=i(2),c="undefined"!=typeof window&&!!window.addEventListener,d=c?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0;}:function(t){t.returnValue=!1,t.cancelBubble=!0;};t.exports={clientToLocal:r,normalizeEvent:a,addEventListener:s,removeEventListener:l,stop:d,Dispatcher:u};},function(t,e){t.exports="undefined"!=typeof window&&(window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16);};},function(t,e,i){function n(t){return"mousewheel"===t&&d.browser.firefox?"DOMMouseScroll":t;}function r(t,e,i){var n=t._gestureMgr;"start"===i&&n.clear();var r=n.recognize(e,t.handler.findHover(e.zrX,e.zrY,null),t.dom);if("end"===i&&n.clear(),r){var o=r.type;e.gestureEvent=o,t.handler.dispatchToElement(r.target,o,r.event);}}function o(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1;},700);}function a(){return d.touchEventsSupported;}function s(t){function e(t,e){return function(){return e._touching?void 0:t.apply(e,arguments);};}for(var i=0;i<x.length;i++){var n=x[i];t._handlers[n]=h.bind(_[n],t);}for(var i=0;i<y.length;i++){var n=y[i];t._handlers[n]=e(_[n],t);}}function l(t){function e(e,i){h.each(e,function(e){p(t,n(e),i._handlers[e]);},i);}c.call(this),this.dom=t,this._touching=!1,this._touchTimer,this._gestureMgr=new f(),this._handlers={},s(this),a()&&e(x,this),e(y,this);}var u=i(87),h=i(4),c=i(33),d=i(2),f=i(90),p=u.addEventListener,g=u.removeEventListener,m=u.normalizeEvent,v=300,y=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],x=["touchstart","touchend","touchmove"],_={mousemove:function mousemove(t){t=m(this.dom,t),this.trigger("mousemove",t);},mouseout:function mouseout(t){t=m(this.dom,t);var e=t.toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode;}this.trigger("mouseout",t);},touchstart:function touchstart(t){t=m(this.dom,t),this._lastTouchMoment=new Date(),r(this,t,"start"),_.mousemove.call(this,t),_.mousedown.call(this,t),o(this);},touchmove:function touchmove(t){t=m(this.dom,t),r(this,t,"change"),_.mousemove.call(this,t),o(this);},touchend:function touchend(t){t=m(this.dom,t),r(this,t,"end"),_.mouseup.call(this,t),+new Date()-this._lastTouchMoment<v&&_.click.call(this,t),o(this);}};h.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){_[t]=function(e){e=m(this.dom,e),this.trigger(t,e);};});var b=l.prototype;b.dispose=function(){for(var t=y.concat(x),e=0;e<t.length;e++){var i=t[e];g(this.dom,n(i),this._handlers[i]);}},b.setCursor=function(t){this.dom.style.cursor=t||"default";},h.mixin(l,c),t.exports=l;},function(t,e,i){"use strict";function n(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i);}function r(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2];}var o=i(87),a=function a(){this._track=[];};a.prototype={constructor:a,recognize:function recognize(t,e,i){return this._doTrack(t,e,i),this._recognize(t);},clear:function clear(){return this._track.length=0,this;},_doTrack:function _doTrack(t,e,i){var n=t.touches;if(n){for(var r={points:[],touches:[],target:e,event:t},a=0,s=n.length;s>a;a++){var l=n[a],u=o.clientToLocal(i,l,{});r.points.push([u.zrX,u.zrY]),r.touches.push(l);}this._track.push(r);}},_recognize:function _recognize(t){for(var e in s){if(s.hasOwnProperty(e)){var i=s[e](this._track,t);if(i)return i;}}}};var s={pinch:function pinch(t,e){var i=t.length;if(i){var o=(t[i-1]||{}).points,a=(t[i-2]||{}).points||o;if(a&&a.length>1&&o&&o.length>1){var s=n(o)/n(a);!isFinite(s)&&(s=1),e.pinchScale=s;var l=r(o);return e.pinchX=l[0],e.pinchY=l[1],{type:"pinch",target:t[0].target,event:e};}}}};t.exports=a;},function(t,e,i){"use strict";function n(t){return parseInt(t,10);}function r(t){return t?t.isBuildin?!0:"function"!=typeof t.resize||"function"!=typeof t.refresh?!1:!0:!1;}function o(t){t.__unusedCount++;}function a(t){1==t.__unusedCount&&t.clear();}function s(t,e,i){return x.copy(t.getBoundingRect()),t.transform&&x.applyTransform(t.transform),_.width=e,_.height=i,!x.intersect(_);}function l(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++){if(t[i]!==e[i])return!0;}}function u(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=n.path;n.setTransform(e),r.beginPath(e),n.buildPath(r,n.shape),e.clip(),n.restoreTransform(e);}}function h(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",i;}var c=i(41),d=i(4),f=i(40),p=i(9),g=i(85),m=i(92),v=i(88),y=5,x=new p(0,0,0,0),_=new p(0,0,0,0),b=function b(t,e,i){var n=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=d.extend({},i||{}),this.dpr=i.devicePixelRatio||c.devicePixelRatio,this._singleCanvas=n,this.root=t;var r=t.style;r&&(r["-webkit-tap-highlight-color"]="transparent",r["-webkit-user-select"]=r["user-select"]=r["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],a=this._layers={};if(this._layerConfig={},n){var s=t.width,l=t.height;this._width=s,this._height=l;var u=new m(t,this,1);u.initContext(),a[0]=u,o.push(0);}else{this._width=this._getSize(0),this._height=this._getSize(1);var f=this._domRoot=h(this._width,this._height);t.appendChild(f);}this.pathToImage=this._createPathToImage(),this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[];};b.prototype={constructor:b,isSingleCanvas:function isSingleCanvas(){return this._singleCanvas;},getViewportRoot:function getViewportRoot(){return this._singleCanvas?this._layers[0].dom:this._domRoot;},refresh:function refresh(t){var e=this.storage.getDisplayList(!0),i=this._zlevelList;this._paintList(e,t);for(var n=0;n<i.length;n++){var r=i[n],o=this._layers[r];!o.isBuildin&&o.refresh&&o.refresh();}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this;},addHover:function addHover(t,e){if(!t.__hoverMir){var i=new t.constructor({style:t.style,shape:t.shape});i.__from=t,t.__hoverMir=i,i.setStyle(e),this._hoverElements.push(i);}},removeHover:function removeHover(t){var e=t.__hoverMir,i=this._hoverElements,n=d.indexOf(i,e);n>=0&&i.splice(n,1),t.__hoverMir=null;},clearHover:function clearHover(t){for(var e=this._hoverElements,i=0;i<e.length;i++){var n=e[i].__from;n&&(n.__hoverMir=null);}e.length=0;},refreshHover:function refreshHover(){var t=this._hoverElements,e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){g(t,this.storage.displayableSortFunc),i||(i=this._hoverlayer=this.getLayer(1e5));var n={};i.ctx.save();for(var r=0;e>r;){var o=t[r],a=o.__from;a&&a.__zr?(r++,a.invisible||(o.transform=a.transform,o.invTransform=a.invTransform,o.__clipPaths=a.__clipPaths,this._doPaintEl(o,i,!0,n))):(t.splice(r,1),a.__hoverMir=null,e--);}i.ctx.restore();}},_startProgessive:function _startProgessive(){function t(){i===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,v(t)):e._progressiveToken=-1);}var e=this;if(e._furtherProgressive){var i=e._progressiveToken=+new Date();e._progress++,v(t);}},_clearProgressive:function _clearProgressive(){this._progressiveToken=-1,this._progress=0,d.each(this._progressiveLayers,function(t){t.__dirty&&t.clear();});},_paintList:function _paintList(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuildinLayer(o),this._doPaintList(t,e),this.eachBuildinLayer(a);},_doPaintList:function _doPaintList(t,e){function i(t){var e=o.dpr||1;o.save(),o.globalAlpha=1,o.shadowBlur=0,n.__dirty=!0,o.setTransform(1,0,0,1,0,0),o.drawImage(t.dom,0,0,h*e,c*e),o.restore();}for(var n,r,o,a,s,l,u=0,h=this._width,c=this._height,p=this._progress,g=0,m=t.length;m>g;g++){var v=t[g],x=this._singleCanvas?0:v.zlevel,_=v.__frame;if(0>_&&s&&(i(s),s=null),r!==x&&(o&&o.restore(),a={},r=x,n=this.getLayer(r),n.isBuildin||f("ZLevel "+r+" has been used by unkown layer "+n.id),o=n.ctx,o.save(),n.__unusedCount=0,(n.__dirty||e)&&n.clear()),n.__dirty||e){if(_>=0){if(!s){if(s=this._progressiveLayers[Math.min(u++,y-1)],s.ctx.save(),s.renderScope={},s&&s.__progress>s.__maxProgress){g=s.__nextIdxNotProg-1;continue;}l=s.__progress,s.__dirty||(p=l),s.__progress=p+1;}_===p&&this._doPaintEl(v,s,!0,s.renderScope);}else this._doPaintEl(v,n,e,a);v.__dirty=!1;}}s&&i(s),o&&o.restore(),this._furtherProgressive=!1,d.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0);},this);},_doPaintEl:function _doPaintEl(t,e,i,n){var r=e.ctx,o=t.transform;if((e.__dirty||i)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!s(t,this._width,this._height))){var a=t.__clipPaths;(n.prevClipLayer!==e||l(a,n.prevElClipPaths))&&(n.prevElClipPaths&&(n.prevClipLayer.ctx.restore(),n.prevClipLayer=n.prevElClipPaths=null,n.prevEl=null),a&&(r.save(),u(a,r),n.prevClipLayer=e,n.prevElClipPaths=a)),t.beforeBrush&&t.beforeBrush(r),t.brush(r,n.prevEl||null),n.prevEl=t,t.afterBrush&&t.afterBrush(r);}},getLayer:function getLayer(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||(e=new m("zr_"+t,this,this.dpr),e.isBuildin=!0,this._layerConfig[t]&&d.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e;},insertLayer:function insertLayer(t,e){var i=this._layers,n=this._zlevelList,o=n.length,a=null,s=-1,l=this._domRoot;if(i[t])return void f("ZLevel "+t+" has been used already");if(!r(e))return void f("Layer of zlevel "+t+" is not valid");if(o>0&&t>n[0]){for(s=0;o-1>s&&!(n[s]<t&&n[s+1]>t);s++){}a=i[n[s]];}if(n.splice(s+1,0,t),a){var u=a.dom;u.nextSibling?l.insertBefore(e.dom,u.nextSibling):l.appendChild(e.dom);}else l.firstChild?l.insertBefore(e.dom,l.firstChild):l.appendChild(e.dom);i[t]=e;},eachLayer:function eachLayer(t,e){var i,n,r=this._zlevelList;for(n=0;n<r.length;n++){i=r[n],t.call(e,this._layers[i],i);}},eachBuildinLayer:function eachBuildinLayer(t,e){var i,n,r,o=this._zlevelList;for(r=0;r<o.length;r++){n=o[r],i=this._layers[n],i.isBuildin&&t.call(e,i,n);}},eachOtherLayer:function eachOtherLayer(t,e){var i,n,r,o=this._zlevelList;for(r=0;r<o.length;r++){n=o[r],i=this._layers[n],i.isBuildin||t.call(e,i,n);}},getLayers:function getLayers(){return this._layers;},_updateLayerStatus:function _updateLayerStatus(t){var e=this._layers,i=this._progressiveLayers,n={},r={};this.eachBuildinLayer(function(t,e){n[e]=t.elCount,t.elCount=0,t.__dirty=!1;}),d.each(i,function(t,e){r[e]=t.elCount,t.elCount=0,t.__dirty=!1;});for(var o,a,s=0,l=0,u=0,h=t.length;h>u;u++){var c=t[u],f=this._singleCanvas?0:c.zlevel,p=e[f],g=c.progressive;if(p&&(p.elCount++,p.__dirty=p.__dirty||c.__dirty),g>=0){a!==g&&(a=g,l++);var v=c.__frame=l-1;if(!o){var x=Math.min(s,y-1);o=i[x],o||(o=i[x]=new m("progressive",this,this.dpr),o.initContext()),o.__maxProgress=0;}o.__dirty=o.__dirty||c.__dirty,o.elCount++,o.__maxProgress=Math.max(o.__maxProgress,v),o.__maxProgress>=o.__progress&&(p.__dirty=!0);}else c.__frame=-1,o&&(o.__nextIdxNotProg=u,s++,o=null);}o&&(s++,o.__nextIdxNotProg=u),this.eachBuildinLayer(function(t,e){n[e]!==t.elCount&&(t.__dirty=!0);}),i.length=Math.min(s,y),d.each(i,function(t,e){r[e]!==t.elCount&&(c.__dirty=!0),t.__dirty&&(t.__progress=0);});},clear:function clear(){return this.eachBuildinLayer(this._clearLayer),this;},_clearLayer:function _clearLayer(t){t.clear();},configLayer:function configLayer(t,e){if(e){var i=this._layerConfig;i[t]?d.merge(i[t],e,!0):i[t]=e;var n=this._layers[t];n&&d.merge(n,i[t],!0);}},delLayer:function delLayer(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(d.indexOf(i,t),1));},resize:function resize(t,e){var i=this._domRoot;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!=t||e!=this._height){i.style.width=t+"px",i.style.height=e+"px";for(var r in this._layers){this._layers.hasOwnProperty(r)&&this._layers[r].resize(t,e);}d.each(this._progressiveLayers,function(i){i.resize(t,e);}),this.refresh(!0);}return this._width=t,this._height=e,this;},clearLayer:function clearLayer(t){var e=this._layers[t];e&&e.clear();},dispose:function dispose(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null;},getRenderedCanvas:function getRenderedCanvas(t){if(t=t||{},this._singleCanvas)return this._layers[0].dom;var e=new m("image",this,t.pixelRatio||this.dpr);e.initContext(),e.clearColor=t.backgroundColor,e.clear();for(var i=this.storage.getDisplayList(!0),n={},r=0;r<i.length;r++){var o=i[r];this._doPaintEl(o,e,!0,n);}return e.dom;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},_getSize:function _getSize(t){var e=this._opts,i=["width","height"][t],r=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],a=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var s=this.root,l=document.defaultView.getComputedStyle(s);return(s[r]||n(l[i])||n(s.style[i]))-(n(l[o])||0)-(n(l[a])||0)|0;},_pathToImage:function _pathToImage(t,e,n,r,o){var a=document.createElement("canvas"),s=a.getContext("2d");a.width=n*o,a.height=r*o,s.clearRect(0,0,n*o,r*o);var l={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[0,0,0],e.rotation=0,e.scale=[1,1],e&&e.brush(s);var u=i(62),h=new u({id:t,style:{x:0,y:0,image:a}});return null!=l.position&&(h.position=e.position=l.position),null!=l.rotation&&(h.rotation=e.rotation=l.rotation),null!=l.scale&&(h.scale=e.scale=l.scale),h;},_createPathToImage:function _createPathToImage(){var t=this;return function(e,i,n,r){return t._pathToImage(e,i,n,r,t.dpr);};}},t.exports=b;},function(t,e,i){function n(){return!1;}function r(t,e,i,n){var r=document.createElement(e),o=i.getWidth(),a=i.getHeight(),s=r.style;return s.position="absolute",s.left=0,s.top=0,s.width=o+"px",s.height=a+"px",r.width=o*n,r.height=a*n,r.setAttribute("data-zr-dom-id",t),r;}var o=i(4),a=i(41),s=i(47),l=i(59),u=function u(t,e,i){var s;i=i||a.devicePixelRatio,"string"==typeof t?s=r(t,"canvas",e,i):o.isObject(t)&&(s=t,t=s.id),this.id=t,this.dom=s;var l=s.style;l&&(s.onselectstart=n,l["-webkit-user-select"]="none",l["user-select"]="none",l["-webkit-touch-callout"]="none",l["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",l.padding=0,l.margin=0,l["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=i;};u.prototype={constructor:u,elCount:0,__dirty:!0,initContext:function initContext(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr;},createBackBuffer:function createBackBuffer(){var t=this.dpr;this.domBack=r("back-"+this.id,"canvas",this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!=t&&this.ctxBack.scale(t,t);},resize:function resize(t,e){var i=this.dpr,n=this.dom,r=n.style,o=this.domBack;r.width=t+"px",r.height=e+"px",n.width=t*i,n.height=e*i,o&&(o.width=t*i,o.height=e*i,1!=i&&this.ctxBack.scale(i,i));},clear:function clear(t){var e=this.dom,i=this.ctx,n=e.width,r=e.height,o=this.clearColor,a=this.motionBlur&&!t,u=this.lastFrameAlpha,h=this.dpr;if(a&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(e,0,0,n/h,r/h)),i.clearRect(0,0,n,r),o){var c;o.colorStops?(c=o.__canvasGradient||s.getGradient(i,o,{x:0,y:0,width:n,height:r}),o.__canvasGradient=c):o.image&&(c=l.prototype.getCanvasPattern.call(o,i)),i.save(),i.fillStyle=c||o,i.fillRect(0,0,n,r),i.restore();}if(a){var d=this.domBack;i.save(),i.globalAlpha=u,i.drawImage(d,0,0,n,r),i.restore();}}},t.exports=u;},function(t,e,i){var n=i(61);t.exports=function(t){function e(e){var i=(e.visualColorAccessPath||"itemStyle.normal.color").split("."),r=e.getData(),o=e.get(i)||e.getColorFromPalette(e.get("name"));r.setVisual("color",o),t.isSeriesFiltered(e)||("function"!=typeof o||o instanceof n||r.each(function(t){r.setItemVisual(t,"color",o(e.getDataParams(t)));}),r.each(function(t){var e=r.getItemModel(t),n=e.get(i,!0);null!=n&&r.setItemVisual(t,"color",n);}));}t.eachRawSeries(e);};},function(t,e,i){function n(t,e){e=e.split(",");for(var i=t,n=0;n<e.length&&(i=i&&i[e[n]],null!=i);n++){}return i;}function r(t,e,i,n){e=e.split(",");for(var r,o=t,a=0;a<e.length-1;a++){r=e[a],null==o[r]&&(o[r]={}),o=o[r];}(n||null==o[e[a]])&&(o[e[a]]=i);}function o(t){c(l,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]]);});}var a=i(4),s=i(95),l=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],u=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],h=["bar","boxplot","candlestick","chord","effectScatter","funnel","gauge","lines","graph","heatmap","line","map","parallel","pie","radar","sankey","scatter","treemap"],c=a.each;t.exports=function(t){c(t.series,function(t){if(a.isObject(t)){var e=t.type;if(s(t),("pie"===e||"gauge"===e)&&null!=t.clockWise&&(t.clockwise=t.clockWise),"gauge"===e){var i=n(t,"pointer.color");null!=i&&r(t,"itemStyle.normal.color",i);}for(var l=0;l<h.length;l++){if(h[l]===t.type){o(t);break;}}}}),t.dataRange&&(t.visualMap=t.dataRange),c(u,function(e){var i=t[e];i&&(a.isArray(i)||(i=[i]),c(i,function(t){o(t);}));});};},function(t,e,i){function n(t){var e=t&&t.itemStyle;e&&r.each(o,function(i){var n=e.normal,o=e.emphasis;n&&n[i]&&(t[i]=t[i]||{},t[i].normal?r.merge(t[i].normal,n[i]):t[i].normal=n[i],n[i]=null),o&&o[i]&&(t[i]=t[i]||{},t[i].emphasis?r.merge(t[i].emphasis,o[i]):t[i].emphasis=o[i],o[i]=null);});}var r=i(4),o=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];t.exports=function(t){if(t){n(t),n(t.markPoint),n(t.markLine);var e=t.data;if(e){for(var i=0;i<e.length;i++){n(e[i]);}var o=t.markPoint;if(o&&o.data)for(var a=o.data,i=0;i<a.length;i++){n(a[i]);}var s=t.markLine;if(s&&s.data)for(var l=s.data,i=0;i<l.length;i++){r.isArray(l[i])?(n(l[i][0]),n(l[i][1])):n(l[i]);}}}};},function(t,e,i){var n=i(43),r=i(4),o=Math.PI;t.exports=function(t,e){e=e||{},r.defaults(e,{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var i=new n.Rect({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4}),a=new n.Arc({shape:{startAngle:-o/2,endAngle:-o/2+.1,r:10},style:{stroke:e.color,lineCap:"round",lineWidth:5},zlevel:e.zlevel,z:10001}),s=new n.Rect({style:{fill:"none",text:e.text,textPosition:"right",textDistance:10,textFill:e.textColor},zlevel:e.zlevel,z:10001});a.animateShape(!0).when(1e3,{endAngle:3*o/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*o/2}).delay(300).start("circularInOut");var l=new n.Group();return l.add(a),l.add(s),l.add(i),l.resize=function(){var e=t.getWidth()/2,n=t.getHeight()/2;a.setShape({cx:e,cy:n});var r=a.shape.r;s.setShape({x:e-r,y:n-r,width:2*r,height:2*r}),i.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()});},l.resize(),l;};},function(t,e,i){(function(e){function n(t){return d.isArray(t)||(t=[t]),t;}function r(t,e){var i=t.dimensions,n=new v(d.map(i,t.getDimensionInfo,t),t.hostModel);m(n,t);for(var r=n._storage={},o=t._storage,a=0;a<i.length;a++){var s=i[a],l=o[s];d.indexOf(e,s)>=0?r[s]=new l.constructor(o[s].length):r[s]=o[s];}return n;}var o="undefined",a="undefined"==typeof window?e:window,s=_typeof(a.Float64Array)===o?Array:a.Float64Array,l=_typeof(a.Int32Array)===o?Array:a.Int32Array,u={"float":s,"int":l,ordinal:Array,number:Array,time:Array},h=i(12),c=i(98),d=i(4),f=i(5),p=d.isObject,g=["stackedOn","hasItemOption","_nameList","_idList","_rawData"],m=function m(t,e){d.each(g.concat(e.__wrappedMethods||[]),function(i){e.hasOwnProperty(i)&&(t[i]=e[i]);}),t.__wrappedMethods=e.__wrappedMethods;},v=function v(t,e){t=t||["x","y"];for(var i={},n=[],r=0;r<t.length;r++){var o,a={};"string"==typeof t[r]?(o=t[r],a={name:o,stackable:!1,type:"number"}):(a=t[r],o=a.name,a.type=a.type||"number"),n.push(o),i[o]=a;}this.dimensions=n,this._dimensionInfos=i,this.hostModel=e,this.dataType,this.indices=[],this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this.stackedOn=null,this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._rawData,this._extent;},y=v.prototype;y.type="list",y.hasItemOption=!0,y.getDimension=function(t){return isNaN(t)||(t=this.dimensions[t]||t),t;},y.getDimensionInfo=function(t){return d.clone(this._dimensionInfos[this.getDimension(t)]);},y.initData=function(t,e,i){if(t=t||[],!d.isArray(t))throw new Error("Invalid data.");this._rawData=t;var n=this._storage={},r=this.indices=[],o=this.dimensions,a=t.length,s=this._dimensionInfos,l=[],h={};e=e||[];for(var c=0;c<o.length;c++){var p=s[o[c]],g=u[p.type];n[o[c]]=new g(a);}var m=this;i||(m.hasItemOption=!1),i=i||function(t,e,i,n){var r=f.getDataItemValue(t);return f.isDataItemOption(t)&&(m.hasItemOption=!0),f.converDataValue(r instanceof Array?r[n]:r,s[e]);};for(var v=0;v<t.length;v++){for(var y=t[v],x=0;x<o.length;x++){var _=o[x],b=n[_];b[v]=i(y,_,v,x);}r.push(v);}for(var c=0;c<t.length;c++){e[c]||t[c]&&null!=t[c].name&&(e[c]=t[c].name);var w=e[c]||"",S=t[c]&&t[c].id;!S&&w&&(h[w]=h[w]||0,S=w,h[w]>0&&(S+="__ec__"+h[w]),h[w]++),S&&(l[c]=S);}this._nameList=e,this._idList=l;},y.count=function(){return this.indices.length;},y.get=function(t,e,i){var n=this._storage,r=this.indices[e];if(null==r)return NaN;var o=n[t]&&n[t][r];if(i){var a=this._dimensionInfos[t];if(a&&a.stackable)for(var s=this.stackedOn;s;){var l=s.get(t,e);(o>=0&&l>0||0>=o&&0>l)&&(o+=l),s=s.stackedOn;}}return o;},y.getValues=function(t,e,i){var n=[];d.isArray(t)||(i=e,e=t,t=this.dimensions);for(var r=0,o=t.length;o>r;r++){n.push(this.get(t[r],e,i));}return n;},y.hasValue=function(t){for(var e=this.dimensions,i=this._dimensionInfos,n=0,r=e.length;r>n;n++){if("ordinal"!==i[e[n]].type&&isNaN(this.get(e[n],t)))return!1;}return!0;},y.getDataExtent=function(t,e){t=this.getDimension(t);var i=this._storage[t],n=this.getDimensionInfo(t);e=n&&n.stackable&&e;var r,o=(this._extent||(this._extent={}))[t+!!e];if(o)return o;if(i){for(var a=1/0,s=-(1/0),l=0,u=this.count();u>l;l++){r=this.get(t,l,e),a>r&&(a=r),r>s&&(s=r);}return this._extent[t+!!e]=[a,s];}return[1/0,-(1/0)];},y.getSum=function(t,e){var i=this._storage[t],n=0;if(i)for(var r=0,o=this.count();o>r;r++){var a=this.get(t,r,e);isNaN(a)||(n+=a);}return n;},y.indexOf=function(t,e){var i=this._storage,n=i[t],r=this.indices;if(n)for(var o=0,a=r.length;a>o;o++){var s=r[o];if(n[s]===e)return o;}return-1;},y.indexOfName=function(t){for(var e=this.indices,i=this._nameList,n=0,r=e.length;r>n;n++){var o=e[n];if(i[o]===t)return n;}return-1;},y.indexOfRawIndex=function(t){var e=this.indices,i=e[t];if(null!=i&&i===t)return t;for(var n=0,r=e.length-1;r>=n;){var o=(n+r)/2|0;if(e[o]<t)n=o+1;else{if(!(e[o]>t))return o;r=o-1;}}return-1;},y.indexOfNearest=function(t,e,i,n){var r=this._storage,o=r[t];null==n&&(n=1/0);var a=-1;if(o)for(var s=Number.MAX_VALUE,l=0,u=this.count();u>l;l++){var h=e-this.get(t,l,i),c=Math.abs(h);n>=h&&(s>c||c===s&&h>0)&&(s=c,a=l);}return a;},y.getRawIndex=function(t){var e=this.indices[t];return null==e?-1:e;},y.getRawDataItem=function(t){return this._rawData[this.getRawIndex(t)];},y.getName=function(t){return this._nameList[this.indices[t]]||"";},y.getId=function(t){return this._idList[this.indices[t]]||this.getRawIndex(t)+"";},y.each=function(t,e,i,r){"function"==typeof t&&(r=i,i=e,e=t,t=[]),t=d.map(n(t),this.getDimension,this);var o=[],a=t.length,s=this.indices;r=r||this;for(var l=0;l<s.length;l++){switch(a){case 0:e.call(r,l);break;case 1:e.call(r,this.get(t[0],l,i),l);break;case 2:e.call(r,this.get(t[0],l,i),this.get(t[1],l,i),l);break;default:for(var u=0;a>u;u++){o[u]=this.get(t[u],l,i);}o[u]=l,e.apply(r,o);}}},y.filterSelf=function(t,e,i,r){"function"==typeof t&&(r=i,i=e,e=t,t=[]),t=d.map(n(t),this.getDimension,this);var o=[],a=[],s=t.length,l=this.indices;r=r||this;for(var u=0;u<l.length;u++){var h;if(1===s)h=e.call(r,this.get(t[0],u,i),u);else{for(var c=0;s>c;c++){a[c]=this.get(t[c],u,i);}a[c]=u,h=e.apply(r,a);}h&&o.push(l[u]);}return this.indices=o,this._extent={},this;},y.mapArray=function(t,e,i,n){"function"==typeof t&&(n=i,i=e,e=t,t=[]);var r=[];return this.each(t,function(){r.push(e&&e.apply(this,arguments));},i,n),r;},y.map=function(t,e,i,o){t=d.map(n(t),this.getDimension,this);var a=r(this,t),s=a.indices=this.indices,l=a._storage,u=[];return this.each(t,function(){var i=arguments[arguments.length-1],n=e&&e.apply(this,arguments);if(null!=n){"number"==typeof n&&(u[0]=n,n=u);for(var r=0;r<n.length;r++){var o=t[r],a=l[o],h=s[i];a&&(a[h]=n[r]);}}},i,o),a;},y.downSample=function(t,e,i,n){for(var o=r(this,[t]),a=this._storage,s=o._storage,l=this.indices,u=o.indices=[],h=[],c=[],d=Math.floor(1/e),f=s[t],p=this.count(),g=0;g<a[t].length;g++){s[t][g]=a[t][g];}for(var g=0;p>g;g+=d){d>p-g&&(d=p-g,h.length=d);for(var m=0;d>m;m++){var v=l[g+m];h[m]=f[v],c[m]=v;}var y=i(h),v=c[n(h,y)||0];f[v]=y,u.push(v);}return o;},y.getItemModel=function(t){var e=this.hostModel;return t=this.indices[t],new h(this._rawData[t],e,e&&e.ecModel);},y.diff=function(t){var e=this._idList,i=t&&t._idList;return new c(t?t.indices:[],this.indices,function(t){return i[t]||t+"";},function(t){return e[t]||t+"";});},y.getVisual=function(t){var e=this._visual;return e&&e[t];},y.setVisual=function(t,e){if(p(t))for(var i in t){t.hasOwnProperty(i)&&this.setVisual(i,t[i]);}else this._visual=this._visual||{},this._visual[t]=e;},y.setLayout=function(t,e){if(p(t))for(var i in t){t.hasOwnProperty(i)&&this.setLayout(i,t[i]);}else this._layout[t]=e;},y.getLayout=function(t){return this._layout[t];},y.getItemLayout=function(t){return this._itemLayouts[t];},y.setItemLayout=function(t,e,i){this._itemLayouts[t]=i?d.extend(this._itemLayouts[t]||{},e):e;},y.clearItemLayouts=function(){this._itemLayouts.length=0;},y.getItemVisual=function(t,e,i){var n=this._itemVisuals[t],r=n&&n[e];return null!=r||i?r:this.getVisual(e);},y.setItemVisual=function(t,e,i){var n=this._itemVisuals[t]||{};if(this._itemVisuals[t]=n,p(e))for(var r in e){e.hasOwnProperty(r)&&(n[r]=e[r]);}else n[e]=i;},y.clearAllVisual=function(){this._visual={},this._itemVisuals=[];};var x=function x(t){t.seriesIndex=this.seriesIndex,t.dataIndex=this.dataIndex,t.dataType=this.dataType;};y.setItemGraphicEl=function(t,e){var i=this.hostModel;e&&(e.dataIndex=t,e.dataType=this.dataType,e.seriesIndex=i&&i.seriesIndex,"group"===e.type&&e.traverse(x,e)),this._graphicEls[t]=e;},y.getItemGraphicEl=function(t){return this._graphicEls[t];},y.eachItemGraphicEl=function(t,e){d.each(this._graphicEls,function(i,n){i&&t&&t.call(e,i,n);});},y.cloneShallow=function(){var t=d.map(this.dimensions,this.getDimensionInfo,this),e=new v(t,this.hostModel);return e._storage=this._storage,m(e,this),e.indices=this.indices.slice(),this._extent&&(e._extent=d.extend({},this._extent)),e;},y.wrapMethod=function(t,e){var i=this[t];"function"==typeof i&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=i.apply(this,arguments);return e.apply(this,[t].concat(d.slice(arguments)));});},y.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],y.CHANGABLE_METHODS=["filterSelf"],t.exports=v;}).call(e,function(){return this;}());},function(t,e){"use strict";function i(t){return t;}function n(t,e,n,r){this._old=t,this._new=e,this._oldKeyGetter=n||i,this._newKeyGetter=r||i;}function r(t,e,i,n){for(var r=0;r<t.length;r++){var o=n(t[r],r),a=e[o];null==a?(i.push(o),e[o]=r):(a.length||(e[o]=a=[a]),a.push(r));}}n.prototype={constructor:n,add:function add(t){return this._add=t,this;},update:function update(t){return this._update=t,this;},remove:function remove(t){return this._remove=t,this;},execute:function execute(){var t,e=this._old,i=this._new,n=this._oldKeyGetter,o=this._newKeyGetter,a={},s={},l=[],u=[];for(r(e,a,l,n),r(i,s,u,o),t=0;t<e.length;t++){var h=l[t],c=s[h];if(null!=c){var d=c.length;d?(1===d&&(s[h]=null),c=c.unshift()):s[h]=null,this._update&&this._update(c,t);}else this._remove&&this._remove(t);}for(var t=0;t<u.length;t++){var h=u[t];if(s.hasOwnProperty(h)){var c=s[h];if(null==c)continue;if(c.length)for(var f=0,d=c.length;d>f;f++){this._add&&this._add(c[f]);}else this._add&&this._add(c);}}}},t.exports=n;},function(t,e,i){var n=i(4),r=i(1),o=r.PRIORITY;i(100),i(103),r.registerVisual(n.curry(i(109),"line","circle","line")),r.registerLayout(n.curry(i(110),"line")),r.registerProcessor(o.PROCESSOR.STATISTIC,n.curry(i(111),"line")),i(112);},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=t.coordinateSystem;if("polar"!==i&&"cartesian2d"!==i)throw new Error("Line not support coordinateSystem besides cartesian and polar");return n(t.data,this,e);},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clipOverflow:!0,label:{normal:{position:"top"}},lineStyle:{normal:{width:2,type:"solid"}},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:!1,connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});},function(t,e,i){"use strict";function n(t){for(var e=0;e<t.length&&null==t[e];){e++;}return t[e];}function r(t){var e=n(t);return null!=e&&!c.isArray(p(e));}function o(t,e,i){if(t=t||[],!c.isArray(t))throw new Error("Invalid data.");var n=e.get("coordinateSystem"),o=m[n],a=f.get(n),s=o&&o(t,e,i),v=s&&s.dimensions;v||(v=a&&a.dimensions||["x","y"],v=h(v,t,v.concat(["value"])));var y=s?s.categoryIndex:-1,x=new u(v,e),_=l(s,t),b={},w=y>=0&&r(t)?function(t,e,i,n){return d.isDataItemOption(t)&&(x.hasItemOption=!0),n===y?i:g(p(t),v[n]);}:function(t,e,i,n){var r=p(t),o=g(r&&r[n],v[n]);d.isDataItemOption(t)&&(x.hasItemOption=!0);var a=s&&s.categoryAxesModels;return a&&a[e]&&"string"==typeof o&&(b[e]=b[e]||a[e].getCategories(),o=c.indexOf(b[e],o),0>o&&!isNaN(o)&&(o=+o)),o;};return x.hasItemOption=!1,x.initData(t,_,w),x;}function a(t){return"category"!==t&&"time"!==t;}function s(t){return"category"===t?"ordinal":"time"===t?"time":"float";}function l(t,e){var i,n=[],r=t&&t.dimensions[t.categoryIndex];if(r&&(i=t.categoryAxesModels[r.name]),i){var o=i.getCategories();if(o){var a=e.length;if(c.isArray(e[0])&&e[0].length>1){n=[];for(var s=0;a>s;s++){n[s]=o[e[s][t.categoryIndex||0]];}}else n=o.slice(0);}}return n;}var u=i(97),h=i(102),c=i(4),d=i(5),f=i(26),p=d.getDataItemValue,g=d.converDataValue,m={cartesian2d:function cartesian2d(t,e,i){var n=c.map(["xAxis","yAxis"],function(t){return i.queryComponents({mainType:t,index:e.get(t+"Index"),id:e.get(t+"Id")})[0];}),r=n[0],o=n[1];if(!r)throw new Error('xAxis "'+c.retrieve(e.get("xAxisIndex"),e.get("xAxisId"),0)+'" not found');if(!o)throw new Error('yAxis "'+c.retrieve(e.get("xAxisIndex"),e.get("yAxisId"),0)+'" not found');var l=r.get("type"),u=o.get("type"),d=[{name:"x",type:s(l),stackable:a(l)},{name:"y",type:s(u),stackable:a(u)}],f="category"===l,p="category"===u;h(d,t,["x","y","z"]);var g={};return f&&(g.x=r),p&&(g.y=o),{dimensions:d,categoryIndex:f?0:p?1:-1,categoryAxesModels:g};},polar:function polar(t,e,i){var n=i.queryComponents({mainType:"polar",index:e.get("polarIndex"),id:e.get("polarId")})[0],r=n.findAxisModel("angleAxis"),o=n.findAxisModel("radiusAxis");if(!r)throw new Error("angleAxis option not found");if(!o)throw new Error("radiusAxis option not found");var l=o.get("type"),u=r.get("type"),c=[{name:"radius",type:s(l),stackable:a(l)},{name:"angle",type:s(u),stackable:a(u)}],d="category"===u,f="category"===l;h(c,t,["radius","angle","value"]);var p={};return f&&(p.radius=o),d&&(p.angle=r),{dimensions:c,categoryIndex:d?1:f?0:-1,categoryAxesModels:p};},geo:function geo(t,e,i){return{dimensions:h([{name:"lng"},{name:"lat"}],t,["lng","lat","value"])};}};t.exports=o;},function(t,e,i){function n(t,e,i,n){if(!e)return t;var s=r(e[0]),l=o.isArray(s)&&s.length||1;i=i||[],n=n||"extra";for(var u=0;l>u;u++){if(!t[u]){var h=i[u]||n+(u-i.length);t[u]=a(e,u)?{type:"ordinal",name:h}:h;}}return t;}function r(t){return o.isArray(t)?t:o.isObject(t)?t.value:t;}var o=i(4),a=n.guessOrdinal=function(t,e){for(var i=0,n=t.length;n>i;i++){var a=r(t[i]);if(!o.isArray(a))return!1;var a=a[e];if(null!=a&&isFinite(a))return!1;if(o.isString(a)&&"-"!==a)return!0;}return!1;};t.exports=n;},function(t,e,i){"use strict";function n(t,e){if(t.length===e.length){for(var i=0;i<t.length;i++){var n=t[i],r=e[i];if(n[0]!==r[0]||n[1]!==r[1])return;}return!0;}}function r(t){return"number"==typeof t?t:t?.3:0;}function o(t){var e=t.getGlobalExtent();if(t.onBand){var i=t.getBandWidth()/2-1,n=e[1]>e[0]?1:-1;e[0]+=n*i,e[1]-=n*i;}return e;}function a(t){return t>=0?1:-1;}function s(t,e){var i=t.getBaseAxis(),n=t.getOtherAxis(i),r=i.onZero?0:n.scale.getExtent()[0],o=n.dim,s="x"===o||"radius"===o?1:0;return e.mapArray([o],function(n,l){for(var u,h=e.stackedOn;h&&a(h.get(o,l))===a(n);){u=h;break;}var c=[];return c[s]=e.get(i.dim,l),c[1-s]=u?u.get(o,l,!0):r,t.dataToPoint(c);},!0);}function l(t,e,i){var n=o(t.getAxis("x")),r=o(t.getAxis("y")),a=t.getBaseAxis().isHorizontal(),s=Math.min(n[0],n[1]),l=Math.min(r[0],r[1]),u=Math.max(n[0],n[1])-s,h=Math.max(r[0],r[1])-l,c=i.get("lineStyle.normal.width")||2,d=i.get("clipOverflow")?c/2:Math.max(u,h);a?(l-=d,h+=2*d):(s-=d,u+=2*d);var f=new y.Rect({shape:{x:s,y:l,width:u,height:h}});return e&&(f.shape[a?"width":"height"]=0,y.initProps(f,{shape:{width:u,height:h}},i)),f;}function u(t,e,i){var n=t.getAngleAxis(),r=t.getRadiusAxis(),o=r.getExtent(),a=n.getExtent(),s=Math.PI/180,l=new y.Sector({shape:{cx:t.cx,cy:t.cy,r0:o[0],r:o[1],startAngle:-a[0]*s,endAngle:-a[1]*s,clockwise:n.inverse}});return e&&(l.shape.endAngle=-a[0]*s,y.initProps(l,{shape:{endAngle:-a[1]*s}},i)),l;}function h(t,e,i){return"polar"===t.type?u(t,e,i):l(t,e,i);}function c(t,e,i){for(var n=e.getBaseAxis(),r="x"===n.dim||"radius"===n.dim?0:1,o=[],a=0;a<t.length-1;a++){var s=t[a+1],l=t[a];o.push(l);var u=[];switch(i){case"end":u[r]=s[r],u[1-r]=l[1-r],o.push(u);break;case"middle":var h=(l[r]+s[r])/2,c=[];u[r]=c[r]=h,u[1-r]=l[1-r],c[1-r]=s[1-r],o.push(u),o.push(c);break;default:u[r]=l[r],u[1-r]=s[1-r],o.push(u);}}return t[a]&&o.push(t[a]),o;}function d(t,e){return Math.max(Math.min(t,e[1]),e[0]);}function f(t,e){var i=t.getVisual("visualMeta");if(i&&i.length&&t.count()){for(var n,r=i.length-1;r>=0;r--){if(i[r].dimension<2){n=i[r];break;}}if(!n||"cartesian2d"!==e.type)return void console.warn("Visual map on line style only support x or y dimension.");var o=n.dimension,a=t.dimensions[o],s=t.getDataExtent(a),l=n.stops,u=[];l[0].interval&&l.sort(function(t,e){return t.interval[0]-e.interval[0];});var h=l[0],c=l[l.length-1],f=h.interval?d(h.interval[0],s):h.value,p=c.interval?d(c.interval[1],s):c.value,g=p-f;if(0===g)return t.getItemVisual(0,"color");for(var r=0;r<l.length;r++){if(l[r].interval){if(l[r].interval[1]===l[r].interval[0])continue;u.push({offset:(d(l[r].interval[0],s)-f)/g,color:l[r].color},{offset:(d(l[r].interval[1],s)-f)/g,color:l[r].color});}else u.push({offset:(l[r].value-f)/g,color:l[r].color});}var m=new y.LinearGradient(0,0,0,0,u,!0),v=e.getAxis(a),x=v.toGlobalCoord(v.dataToCoord(f)),_=v.toGlobalCoord(v.dataToCoord(p));return m[a]=x,m[a+"2"]=_,m;}}var p=i(4),g=i(104),m=i(105),v=i(107),y=i(43),x=i(5),_=i(108),b=i(42);t.exports=b.extend({type:"line",init:function init(){var t=new y.Group(),e=new g();this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t;},render:function render(t,e,i){var o=t.coordinateSystem,a=this.group,l=t.getData(),u=t.getModel("lineStyle.normal"),d=t.getModel("areaStyle.normal"),g=l.mapArray(l.getItemLayout,!0),m="polar"===o.type,v=this._coordSys,y=this._symbolDraw,x=this._polyline,_=this._polygon,b=this._lineGroup,w=t.get("animation"),S=!d.isEmpty(),M=s(o,l),I=t.get("showSymbol"),T=I&&!m&&!t.get("showAllSymbol")&&this._getSymbolIgnoreFunc(l,o),A=this._data;A&&A.eachItemGraphicEl(function(t,e){t.__temp&&(a.remove(t),A.setItemGraphicEl(e,null));}),I||y.remove(),a.add(b);var L=!m&&t.get("step");x&&v.type===o.type&&L===this._step?(S&&!_?_=this._newPolygon(g,M,o,w):_&&!S&&(b.remove(_),_=this._polygon=null),b.setClipPath(h(o,!1,t)),I&&y.updateData(l,T),l.eachItemGraphicEl(function(t){t.stopAnimation(!0);}),n(this._stackedOnPoints,M)&&n(this._points,g)||(w?this._updateAnimation(l,M,o,i,L):(L&&(g=c(g,o,L),M=c(M,o,L)),x.setShape({points:g}),_&&_.setShape({points:g,stackedOnPoints:M})))):(I&&y.updateData(l,T),L&&(g=c(g,o,L),M=c(M,o,L)),x=this._newPolyline(g,o,w),S&&(_=this._newPolygon(g,M,o,w)),b.setClipPath(h(o,!0,t)));var C=f(l,o)||l.getVisual("color");x.useStyle(p.defaults(u.getLineStyle(),{fill:"none",stroke:C,lineJoin:"bevel"}));var D=t.get("smooth");if(D=r(t.get("smooth")),x.setShape({smooth:D,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")}),_){var P=l.stackedOn,k=0;if(_.useStyle(p.defaults(d.getAreaStyle(),{fill:C,opacity:.7,lineJoin:"bevel"})),P){var z=P.hostModel;k=r(z.get("smooth"));}_.setShape({smooth:D,stackedOnSmooth:k,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")});}this._data=l,this._coordSys=o,this._stackedOnPoints=M,this._points=g,this._step=L;},dispose:function dispose(){},highlight:function highlight(t,e,i,n){var r=t.getData(),o=x.queryDataIndex(r,n);if(!(o instanceof Array)&&null!=o&&o>=0){var a=r.getItemGraphicEl(o);if(!a){var s=r.getItemLayout(o);a=new m(r,o),a.position=s,a.setZ(t.get("zlevel"),t.get("z")),a.ignore=isNaN(s[0])||isNaN(s[1]),a.__temp=!0,r.setItemGraphicEl(o,a),a.stopSymbolAnimation(!0),this.group.add(a);}a.highlight();}else b.prototype.highlight.call(this,t,e,i,n);},downplay:function downplay(t,e,i,n){var r=t.getData(),o=x.queryDataIndex(r,n);if(null!=o&&o>=0){var a=r.getItemGraphicEl(o);a&&(a.__temp?(r.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay());}else b.prototype.downplay.call(this,t,e,i,n);},_newPolyline:function _newPolyline(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new _.Polyline({shape:{points:t},silent:!0,z2:10}),this._lineGroup.add(e),this._polyline=e,e;},_newPolygon:function _newPolygon(t,e){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new _.Polygon({shape:{points:t,stackedOnPoints:e},silent:!0}),this._lineGroup.add(i),this._polygon=i,i;},_getSymbolIgnoreFunc:function _getSymbolIgnoreFunc(t,e){var i=e.getAxesByScale("ordinal")[0];return i&&i.isLabelIgnored?p.bind(i.isLabelIgnored,i):void 0;},_updateAnimation:function _updateAnimation(t,e,i,n,r){var o=this._polyline,a=this._polygon,s=t.hostModel,l=v(this._data,t,this._stackedOnPoints,e,this._coordSys,i),u=l.current,h=l.stackedOnCurrent,d=l.next,f=l.stackedOnNext;r&&(u=c(l.current,i,r),h=c(l.stackedOnCurrent,i,r),d=c(l.next,i,r),f=c(l.stackedOnNext,i,r)),o.shape.__points=l.current,o.shape.points=u,y.updateProps(o,{shape:{points:d}},s),a&&(a.setShape({points:u,stackedOnPoints:h}),y.updateProps(a,{shape:{points:d,stackedOnPoints:f}},s));for(var p=[],g=l.status,m=0;m<g.length;m++){var x=g[m].cmd;if("="===x){var _=t.getItemGraphicEl(g[m].idx1);_&&p.push({el:_,ptIdx:m});}}o.animators&&o.animators.length&&o.animators[0].during(function(){for(var t=0;t<p.length;t++){var e=p[t].el;e.attr("position",o.shape.__points[p[t].ptIdx]);}});},remove:function remove(t){var e=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(t,n){t.__temp&&(e.remove(t),i.setItemGraphicEl(n,null));}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null;}});},function(t,e,i){function n(t){this.group=new o.Group(),this._symbolCtor=t||a;}function r(t,e,i){var n=t.getItemLayout(e);return n&&!isNaN(n[0])&&!isNaN(n[1])&&!(i&&i(e))&&"none"!==t.getItemVisual(e,"symbol");}var o=i(43),a=i(105),s=n.prototype;s.updateData=function(t,e){var i=this.group,n=t.hostModel,a=this._data,s=this._symbolCtor,l={itemStyle:n.getModel("itemStyle.normal").getItemStyle(["color"]),hoverItemStyle:n.getModel("itemStyle.emphasis").getItemStyle(),symbolRotate:n.get("symbolRotate"),symbolOffset:n.get("symbolOffset"),hoverAnimation:n.get("hoverAnimation"),labelModel:n.getModel("label.normal"),hoverLabelModel:n.getModel("label.emphasis")};t.diff(a).add(function(n){var o=t.getItemLayout(n);if(r(t,n,e)){var a=new s(t,n,l);a.attr("position",o),t.setItemGraphicEl(n,a),i.add(a);}}).update(function(u,h){var c=a.getItemGraphicEl(h),d=t.getItemLayout(u);return r(t,u,e)?(c?(c.updateData(t,u,l),o.updateProps(c,{position:d},n)):(c=new s(t,u),c.attr("position",d)),i.add(c),void t.setItemGraphicEl(u,c)):void i.remove(c);}).remove(function(t){var e=a.getItemGraphicEl(t);e&&e.fadeOut(function(){i.remove(e);});}).execute(),this._data=t;},s.updateLayout=function(){var t=this._data;t&&t.eachItemGraphicEl(function(e,i){var n=t.getItemLayout(i);e.attr("position",n);});},s.remove=function(t){var e=this.group,i=this._data;i&&(t?i.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t);});}):e.removeAll());},t.exports=n;},function(t,e,i){function n(t){return t=t instanceof Array?t.slice():[+t,+t],t[0]/=2,t[1]/=2,t;}function r(t,e,i){l.Group.call(this),this.updateData(t,e,i);}function o(t,e){this.parent.drift(t,e);}var a=i(4),s=i(106),l=i(43),u=i(7),h=r.prototype;h._createSymbol=function(t,e,i){this.removeAll();var r=e.hostModel,a=e.getItemVisual(i,"color"),u=s.createSymbol(t,-1,-1,2,2,a);u.attr({z2:100,culling:!0,scale:[0,0]}),u.drift=o;var h=n(e.getItemVisual(i,"symbolSize"));l.initProps(u,{scale:h},r,i),this._symbolType=t,this.add(u);},h.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(t);},h.getSymbolPath=function(){return this.childAt(0);},h.getScale=function(){return this.childAt(0).scale;},h.highlight=function(){this.childAt(0).trigger("emphasis");},h.downplay=function(){this.childAt(0).trigger("normal");},h.setZ=function(t,e){var i=this.childAt(0);i.zlevel=t,i.z=e;},h.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":"pointer";},h.updateData=function(t,e,i){this.silent=!1;var r=t.getItemVisual(e,"symbol")||"circle",o=t.hostModel,a=n(t.getItemVisual(e,"symbolSize"));if(r!==this._symbolType)this._createSymbol(r,t,e);else{var s=this.childAt(0);l.updateProps(s,{scale:a},o,e);}this._updateCommon(t,e,a,i),this._seriesModel=o;};var c=["itemStyle","normal"],d=["itemStyle","emphasis"],f=["label","normal"],p=["label","emphasis"];h._updateCommon=function(t,e,i,r){var o=this.childAt(0),s=t.hostModel,h=t.getItemVisual(e,"color");"image"!==o.type&&o.useStyle({strokeNoScale:!0}),r=r||null;var g=r&&r.itemStyle,m=r&&r.hoverItemStyle,v=r&&r.symbolRotate,y=r&&r.symbolOffset,x=r&&r.labelModel,_=r&&r.hoverLabelModel,b=r&&r.hoverAnimation;if(!r||t.hasItemOption){var w=t.getItemModel(e);g=w.getModel(c).getItemStyle(["color"]),m=w.getModel(d).getItemStyle(),v=w.getShallow("symbolRotate"),y=w.getShallow("symbolOffset"),x=w.getModel(f),_=w.getModel(p),b=w.getShallow("hoverAnimation");}else m=a.extend({},m);var S=o.style;o.attr("rotation",(v||0)*Math.PI/180||0),y&&o.attr("position",[u.parsePercent(y[0],i[0]),u.parsePercent(y[1],i[1])]),o.setColor(h),o.setStyle(g);var M=t.getItemVisual(e,"opacity");null!=M&&(S.opacity=M);for(var I,T,A=t.dimensions.slice();A.length&&(I=A.pop(),T=t.getDimensionInfo(I).type,"ordinal"===T||"time"===T);){}null!=I&&x.getShallow("show")?(l.setText(S,x,h),S.text=a.retrieve(s.getFormattedLabel(e,"normal"),t.get(I,e))):S.text="",null!=I&&_.getShallow("show")?(l.setText(m,_,h),m.text=a.retrieve(s.getFormattedLabel(e,"emphasis"),t.get(I,e))):m.text="";var L=n(t.getItemVisual(e,"symbolSize"));if(o.off("mouseover").off("mouseout").off("emphasis").off("normal"),o.hoverStyle=m,l.setHoverStyle(o),b&&s.ifEnableAnimation()){var C=function C(){var t=L[1]/L[0];this.animateTo({scale:[Math.max(1.1*L[0],L[0]+3),Math.max(1.1*L[1],L[1]+3*t)]},400,"elasticOut");},D=function D(){this.animateTo({scale:L},400,"elasticOut");};o.on("mouseover",C).on("mouseout",D).on("emphasis",C).on("normal",D);}},h.fadeOut=function(t){var e=this.childAt(0);this.silent=!0,e.style.text="",l.updateProps(e,{scale:[0,0]},this._seriesModel,this.dataIndex,t);},a.inherits(r,l.Group),t.exports=r;},function(t,e,i){"use strict";var n=i(43),r=i(9),o=n.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n+o),t.lineTo(i-r,n+o),t.closePath();}}),a=n.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n),t.lineTo(i,n+o),t.lineTo(i-r,n),t.closePath();}}),s=n.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.x,n=e.y,r=e.width/5*3,o=Math.max(r,e.height),a=r/2,s=a*a/(o-a),l=n-o+a+s,u=Math.asin(s/a),h=Math.cos(u)*a,c=Math.sin(u),d=Math.cos(u);t.arc(i,l,a,Math.PI-u,2*Math.PI+u);var f=.6*a,p=.7*a;t.bezierCurveTo(i+h-c*f,l+s+d*f,i,n-p,i,n),t.bezierCurveTo(i,n-p,i-h+c*f,l+s+d*f,i-h,l+s),t.closePath();}}),l=n.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function buildPath(t,e){var i=e.height,n=e.width,r=e.x,o=e.y,a=n/3*2;t.moveTo(r,o),t.lineTo(r+a,o+i),t.lineTo(r,o+i/4*3),t.lineTo(r-a,o+i),t.lineTo(r,o),t.closePath();}}),u={line:n.Line,rect:n.Rect,roundRect:n.Rect,square:n.Rect,circle:n.Circle,diamond:a,pin:s,arrow:l,triangle:o},h={line:function line(t,e,i,n,r){r.x1=t,r.y1=e+n/2,r.x2=t+i,r.y2=e+n/2;},rect:function rect(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n;},roundRect:function roundRect(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n,r.r=Math.min(i,n)/4;},square:function square(t,e,i,n,r){var o=Math.min(i,n);r.x=t,r.y=e,r.width=o,r.height=o;},circle:function circle(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.r=Math.min(i,n)/2;},diamond:function diamond(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n;},pin:function pin(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n;},arrow:function arrow(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n;},triangle:function triangle(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n;}},c={};for(var d in u){u.hasOwnProperty(d)&&(c[d]=new u[d]());}var f=n.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function beforeBrush(){var t=this.style,e=this.shape;"pin"===e.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle");},buildPath:function buildPath(t,e,i){var n=e.symbolType,r=c[n];"none"!==e.symbolType&&(r||(n="rect",r=c[n]),h[n](e.x,e.y,e.width,e.height,r.shape),r.buildPath(t,r.shape,i));}}),p=function p(t){if("image"!==this.type){var e=this.style,i=this.shape;i&&"line"===i.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty(!1);}},g={createSymbol:function createSymbol(t,e,i,o,a,s){var l=0===t.indexOf("empty");l&&(t=t.substr(5,1).toLowerCase()+t.substr(6));var u;return u=0===t.indexOf("image://")?new n.Image({style:{image:t.slice(8),x:e,y:i,width:o,height:a}}):0===t.indexOf("path://")?n.makePath(t.slice(7),{},new r(e,i,o,a)):new f({shape:{symbolType:t,x:e,y:i,width:o,height:a}}),u.__isEmptyBrush=l,u.setColor=p,u.setColor(s),u;}};t.exports=g;},function(t,e){function i(t){return t>=0?1:-1;}function n(t,e,n){for(var r,o=t.getBaseAxis(),a=t.getOtherAxis(o),s=o.onZero?0:a.scale.getExtent()[0],l=a.dim,u="x"===l||"radius"===l?1:0,h=e.stackedOn,c=e.get(l,n);h&&i(h.get(l,n))===i(c);){r=h;break;}var d=[];return d[u]=e.get(o.dim,n),d[1-u]=r?r.get(l,n,!0):s,t.dataToPoint(d);}function r(t,e){var i=[];return e.diff(t).add(function(t){i.push({cmd:"+",idx:t});}).update(function(t,e){i.push({cmd:"=",idx:e,idx1:t});}).remove(function(t){i.push({cmd:"-",idx:t});}).execute(),i;}t.exports=function(t,e,i,o,a,s){for(var l=r(t,e),u=[],h=[],c=[],d=[],f=[],p=[],g=[],m=s.dimensions,v=0;v<l.length;v++){var y=l[v],x=!0;switch(y.cmd){case"=":var _=t.getItemLayout(y.idx),b=e.getItemLayout(y.idx1);(isNaN(_[0])||isNaN(_[1]))&&(_=b.slice()),u.push(_),h.push(b),c.push(i[y.idx]),d.push(o[y.idx1]),g.push(e.getRawIndex(y.idx1));break;case"+":var w=y.idx;u.push(a.dataToPoint([e.get(m[0],w,!0),e.get(m[1],w,!0)])),h.push(e.getItemLayout(w).slice()),c.push(n(a,e,w)),d.push(o[w]),g.push(e.getRawIndex(w));break;case"-":var w=y.idx,S=t.getRawIndex(w);S!==w?(u.push(t.getItemLayout(w)),h.push(s.dataToPoint([t.get(m[0],w,!0),t.get(m[1],w,!0)])),c.push(i[w]),d.push(n(s,t,w)),g.push(S)):x=!1;}x&&(f.push(y),p.push(p.length));}p.sort(function(t,e){return g[t]-g[e];});for(var M=[],I=[],T=[],A=[],L=[],v=0;v<p.length;v++){var w=p[v];M[v]=u[w],I[v]=h[w],T[v]=c[w],A[v]=d[w],L[v]=f[w];}return{current:M,next:I,stackedOnCurrent:T,stackedOnNext:A,status:L};};},function(t,e,i){function n(t){return isNaN(t[0])||isNaN(t[1]);}function r(t,e,i,r,o,a,g,m,v,y,x){for(var _=0,b=i,w=0;r>w;w++){var S=e[b];if(b>=o||0>b)break;if(n(S)){if(x){b+=a;continue;}break;}if(b===i)t[a>0?"moveTo":"lineTo"](S[0],S[1]),c(f,S);else if(v>0){var M=b+a,I=e[M];if(x)for(;I&&n(e[M]);){M+=a,I=e[M];}var T=.5,A=e[_],I=e[M];if(!I||n(I))c(p,S);else{n(I)&&!x&&(I=S),s.sub(d,I,A);var L,C;if("x"===y||"y"===y){var D="x"===y?0:1;L=Math.abs(S[D]-A[D]),C=Math.abs(S[D]-I[D]);}else L=s.dist(S,A),C=s.dist(S,I);T=C/(C+L),h(p,S,d,-v*(1-T));}l(f,f,m),u(f,f,g),l(p,p,m),u(p,p,g),t.bezierCurveTo(f[0],f[1],p[0],p[1],S[0],S[1]),h(f,S,d,v*T);}else t.lineTo(S[0],S[1]);_=b,b+=a;}return w;}function o(t,e){var i=[1/0,1/0],n=[-(1/0),-(1/0)];if(e)for(var r=0;r<t.length;r++){var o=t[r];o[0]<i[0]&&(i[0]=o[0]),o[1]<i[1]&&(i[1]=o[1]),o[0]>n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1]);}return{min:e?i:n,max:e?n:i};}var a=i(45),s=i(10),l=s.min,u=s.max,h=s.scaleAndAdd,c=s.copy,d=[],f=[],p=[];t.exports={Polyline:a.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},buildPath:function buildPath(t,e){var i=e.points,a=0,s=i.length,l=o(i,e.smoothConstraint);if(e.connectNulls){for(;s>0&&n(i[s-1]);s--){}for(;s>a&&n(i[a]);a++){}}for(;s>a;){a+=r(t,i,a,s,s,1,l.min,l.max,e.smooth,e.smoothMonotone,e.connectNulls)+1;}}}),Polygon:a.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},buildPath:function buildPath(t,e){var i=e.points,a=e.stackedOnPoints,s=0,l=i.length,u=e.smoothMonotone,h=o(i,e.smoothConstraint),c=o(a,e.smoothConstraint);if(e.connectNulls){for(;l>0&&n(i[l-1]);l--){}for(;l>s&&n(i[s]);s++){}}for(;l>s;){var d=r(t,i,s,l,l,1,h.min,h.max,e.smooth,u,e.connectNulls);r(t,a,s+d-1,d,l,-1,c.min,c.max,e.stackedOnSmooth,u,e.connectNulls),s+=d+1,t.closePath();}}})};},function(t,e){t.exports=function(t,e,i,n,r){n.eachRawSeriesByType(t,function(t){var r=t.getData(),o=t.get("symbol")||e,a=t.get("symbolSize");r.setVisual({legendSymbol:i||o,symbol:o,symbolSize:a}),n.isSeriesFiltered(t)||("function"==typeof a&&r.each(function(e){var i=t.getRawValue(e),n=t.getDataParams(e);r.setItemVisual(e,"symbolSize",a(i,n));}),r.each(function(t){var e=r.getItemModel(t),i=e.getShallow("symbol",!0),n=e.getShallow("symbolSize",!0);null!=i&&r.setItemVisual(t,"symbol",i),null!=n&&r.setItemVisual(t,"symbolSize",n);}));});};},function(t,e){t.exports=function(t,e){e.eachSeriesByType(t,function(t){var e=t.getData(),i=t.coordinateSystem;if(i){var n=i.dimensions;"singleAxis"===i.type?e.each(n[0],function(t,n){e.setItemLayout(n,isNaN(t)?[NaN,NaN]:i.dataToPoint(t));}):e.each(n,function(t,n,r){e.setItemLayout(r,isNaN(t)||isNaN(n)?[NaN,NaN]:i.dataToPoint([t,n]));},!0);}});};},function(t,e){var i={average:function average(t){for(var e=0,i=0,n=0;n<t.length;n++){isNaN(t[n])||(e+=t[n],i++);}return 0===i?NaN:e/i;},sum:function sum(t){for(var e=0,i=0;i<t.length;i++){e+=t[i]||0;}return e;},max:function max(t){for(var e=-(1/0),i=0;i<t.length;i++){t[i]>e&&(e=t[i]);}return e;},min:function min(t){for(var e=1/0,i=0;i<t.length;i++){t[i]<e&&(e=t[i]);}return e;},nearest:function nearest(t){return t[0];}},n=function n(t,e){return Math.round(t.length/2);};t.exports=function(t,e,r){e.eachSeriesByType(t,function(t){var e=t.getData(),r=t.get("sampling"),o=t.coordinateSystem;if("cartesian2d"===o.type&&r){var a=o.getBaseAxis(),s=o.getOtherAxis(a),l=a.getExtent(),u=l[1]-l[0],h=Math.round(e.count()/u);if(h>1){var c;"string"==typeof r?c=i[r]:"function"==typeof r&&(c=r),c&&(e=e.downSample(s.dim,1/h,c,n),t.setData(e));}}},this);};},function(t,e,i){"use strict";var n=i(43),r=i(4),o=i(1);i(113),i(131),o.extendComponentView({type:"grid",render:function render(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new n.Rect({shape:t.coordinateSystem.getRect(),style:r.defaults({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}));}}),o.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={});});},function(t,e,i){function n(t,e,i){return t.findGridModel()===e;}function r(t){var e,i=t.model,n=i.getFormattedLabels(),r=1,o=n.length;o>40&&(r=Math.ceil(o/40));for(var a=0;o>a;a+=r){if(!t.isLabelIgnored(a)){var s=i.getTextRect(n[a]);e?e.union(s):e=s;}}return e;}function o(t,e,i){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(t,e,i),this._model=t;}function a(t,e){var i=t.getExtent(),n=i[0]+i[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord="x"===t.dim?function(t){return t-e;}:function(t){return n-t+e;};}function s(t,e){return c.map(y,function(e){var i=t.getReferringComponents(e)[0];if(!i)throw new Error(e+' "'+c.retrieve(t.get(e+"Index"),t.get(e+"Id"),0)+'" not found');return i;});}function l(t){return"cartesian2d"===t.get("coordinateSystem");}var u=i(21),h=i(114),c=i(4),d=i(120),f=i(122),p=c.each,g=h.ifAxisCrossZero,m=h.niceScaleExtent;i(125);var v=o.prototype;v.type="grid",v.getRect=function(){return this._rect;},v.update=function(t,e){function i(t){var e=n[t];for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r&&("category"===r.type||!g(r)))return!0;}}return!1;}var n=this._axesMap;this._updateScale(t,this._model),p(n.x,function(t){m(t,t.model);}),p(n.y,function(t){m(t,t.model);}),p(n.x,function(t){i("y")&&(t.onZero=!1);}),p(n.y,function(t){i("x")&&(t.onZero=!1);}),this.resize(this._model,e);},v.resize=function(t,e){function i(){p(o,function(t){var e=t.isHorizontal(),i=e?[0,n.width]:[0,n.height],r=t.inverse?1:0;t.setExtent(i[r],i[1-r]),a(t,e?n.x:n.y);});}var n=u.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});this._rect=n;var o=this._axesList;i(),t.get("containLabel")&&(p(o,function(t){if(!t.model.get("axisLabel.inside")){var e=r(t);if(e){var i=t.isHorizontal()?"height":"width",o=t.model.get("axisLabel.margin");n[i]-=e[i]+o,"top"===t.position?n.y+=e.height+o:"left"===t.position&&(n.x+=e.width+o);}}}),i());},v.getAxis=function(t,e){var i=this._axesMap[t];if(null!=i){if(null==e)for(var n in i){if(i.hasOwnProperty(n))return i[n];}return i[e];}},v.getCartesian=function(t,e){if(null!=t&&null!=e){var i="x"+t+"y"+e;return this._coordsMap[i];}for(var n=0,r=this._coordsList;n<r.length;n++){if(r[n].getAxis("x").index===t||r[n].getAxis("y").index===e)return r[n];}},v.convertToPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.dataToPoint(i):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(i)):null;},v.convertFromPixel=function(t,e,i){var n=this._findConvertTarget(t,e);return n.cartesian?n.cartesian.pointToData(i):n.axis?n.axis.coordToData(n.axis.toLocalCoord(i)):null;},v._findConvertTarget=function(t,e){var i,n,r=e.seriesModel,o=e.xAxisModel||r&&r.getReferringComponents("xAxis")[0],a=e.yAxisModel||r&&r.getReferringComponents("yAxis")[0],s=e.gridModel,l=this._coordsList;if(r)i=r.coordinateSystem,c.indexOf(l,i)<0&&(i=null);else if(o&&a)i=this.getCartesian(o.componentIndex,a.componentIndex);else if(o)n=this.getAxis("x",o.componentIndex);else if(a)n=this.getAxis("y",a.componentIndex);else if(s){var u=s.coordinateSystem;u===this&&(i=this._coordsList[0]);}return{cartesian:i,axis:n};},v.containPoint=function(t){var e=this._coordsList[0];return e?e.containPoint(t):void 0;},v._initCartesian=function(t,e,i){function r(i){return function(r,l){if(n(r,t,e)){var u=r.get("position");"x"===i?"top"!==u&&"bottom"!==u&&(u="bottom",o[u]&&(u="top"===u?"bottom":"top")):"left"!==u&&"right"!==u&&(u="left",o[u]&&(u="left"===u?"right":"left")),o[u]=!0;var c=new f(i,h.createScaleByModel(r),[0,0],r.get("type"),u),d="category"===c.type;c.onBand=d&&r.get("boundaryGap"),c.inverse=r.get("inverse"),c.onZero=r.get("axisLine.onZero"),r.axis=c,c.model=r,c.grid=this,c.index=l,this._axesList.push(c),a[i][l]=c,s[i]++;}};}var o={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},s={x:0,y:0};return e.eachComponent("xAxis",r("x"),this),e.eachComponent("yAxis",r("y"),this),s.x&&s.y?(this._axesMap=a,void p(a.x,function(t,e){p(a.y,function(i,n){var r="x"+e+"y"+n,o=new d(r);o.grid=this,this._coordsMap[r]=o,this._coordsList.push(o),o.addAxis(t),o.addAxis(i);},this);},this)):(this._axesMap={},void(this._axesList=[]));},v._updateScale=function(t,e){function i(t,e,i){p(i.coordDimToDataDim(e.dim),function(i){e.scale.unionExtent(t.getDataExtent(i,"ordinal"!==e.scale.type));});}c.each(this._axesList,function(t){t.scale.setExtent(1/0,-(1/0));}),t.eachSeries(function(r){if(l(r)){var o=s(r,t),a=o[0],u=o[1];if(!n(a,e,t)||!n(u,e,t))return;var h=this.getCartesian(a.componentIndex,u.componentIndex),c=r.getData(),d=h.getAxis("x"),f=h.getAxis("y");"list"===c.type&&(i(c,d,r),i(c,f,r));}},this);};var y=["xAxis","yAxis"];o.create=function(t,e){var i=[];return t.eachComponent("grid",function(n,r){var a=new o(n,t,e);a.name="grid_"+r,a.resize(n,e),n.coordinateSystem=a,i.push(a);}),t.eachSeries(function(e){if(l(e)){var i=s(e,t),n=i[0],r=i[1],o=n.findGridModel();if(!o)throw new Error('Grid "'+c.retrieve(n.get("gridIndex"),n.get("gridId"),0)+'" not found');if(n.findGridModel()!==r.findGridModel())throw new Error("xAxis and yAxis must use the same grid");var a=o.coordinateSystem;e.coordinateSystem=a.getCartesian(n.componentIndex,r.componentIndex);}}),i;},o.dimensions=d.prototype.dimensions,i(26).register("cartesian2d",o),t.exports=o;},function(t,e,i){var n=i(115),r=i(117);i(118),i(119);var o=i(116),a=i(7),s=i(4),l=i(8),u={};u.getScaleExtent=function(t,e){var i=t.scale,n=i.getExtent(),r=n[1]-n[0];if("ordinal"===i.type)return isFinite(r)?n:[0,0];var o=e.getMin?e.getMin():e.get("min"),l=e.getMax?e.getMax():e.get("max"),u=e.getNeedCrossZero?e.getNeedCrossZero():!e.get("scale"),h=e.get("boundaryGap");s.isArray(h)||(h=[h||0,h||0]),h[0]=a.parsePercent(h[0],1),h[1]=a.parsePercent(h[1],1);var c=!0,d=!0;return null==o&&(o=n[0]-h[0]*r,c=!1),null==l&&(l=n[1]+h[1]*r,d=!1),"dataMin"===o&&(o=n[0]),"dataMax"===l&&(l=n[1]),u&&(o>0&&l>0&&!c&&(o=0),0>o&&0>l&&!d&&(l=0)),[o,l];},u.niceScaleExtent=function(t,e){var i=t.scale,n=u.getScaleExtent(t,e),r=null!=(e.getMin?e.getMin():e.get("min")),o=null!=(e.getMax?e.getMax():e.get("max")),a=e.get("splitNumber");"log"===i.type&&(i.base=e.get("logBase")),i.setExtent(n[0],n[1]),i.niceExtent(a,r,o);var s=e.get("minInterval");if(isFinite(s)&&!r&&!o&&"interval"===i.type){var l=i.getInterval(),h=Math.max(Math.abs(l),s)/l;n=i.getExtent();var c=(n[1]+n[0])/2;i.setExtent(h*(n[0]-c)+c,h*(n[1]-c)+c),i.niceExtent(a);}var l=e.get("interval");null!=l&&i.setInterval&&i.setInterval(l);},u.createScaleByModel=function(t,e){if(e=e||t.get("type"))switch(e){case"category":return new n(t.getCategories(),[1/0,-(1/0)]);case"value":return new r();default:return(o.getClass(e)||r).create(t);}},u.ifAxisCrossZero=function(t){var e=t.scale.getExtent(),i=e[0],n=e[1];return!(i>0&&n>0||0>i&&0>n);},u.getAxisLabelInterval=function(t,e,i,n){var r,o=0,a=0,s=1;e.length>40&&(s=Math.floor(e.length/40));for(var u=0;u<t.length;u+=s){var h=t[u],c=l.getBoundingRect(e[u],i,"center","top");c[n?"x":"y"]+=h,c[n?"width":"height"]*=1.3,r?r.intersect(c)?(a++,o=Math.max(o,a)):(r.union(c),a=0):r=c.clone();}return 0===o&&s>1?s:(o+1)*s-1;},u.getFormattedLabels=function(t,e){var i=t.scale,n=i.getTicksLabels(),r=i.getTicks();return"string"==typeof e?(e=function(t){return function(e){return t.replace("{value}",e);};}(e),s.map(n,e)):"function"==typeof e?s.map(r,function(n,r){return e("category"===t.type?i.getLabel(n):n,r);},this):n;},t.exports=u;},function(t,e,i){var n=i(4),r=i(116),o=r.prototype,a=r.extend({type:"ordinal",init:function init(t,e){this._data=t,this._extent=e||[0,t.length-1];},parse:function parse(t){return"string"==typeof t?n.indexOf(this._data,t):Math.round(t);},contain:function contain(t){return t=this.parse(t),o.contain.call(this,t)&&null!=this._data[t];},normalize:function normalize(t){return o.normalize.call(this,this.parse(t));},scale:function scale(t){return Math.round(o.scale.call(this,t));},getTicks:function getTicks(){for(var t=[],e=this._extent,i=e[0];i<=e[1];){t.push(i),i++;}return t;},getLabel:function getLabel(t){return this._data[t];},count:function count(){return this._extent[1]-this._extent[0]+1;},niceTicks:n.noop,niceExtent:n.noop});a.create=function(){return new a();},t.exports=a;},function(t,e,i){function n(){this._extent=[1/0,-(1/0)],this._interval=0,this.init&&this.init.apply(this,arguments);}var r=i(13),o=n.prototype;o.parse=function(t){return t;},o.contain=function(t){var e=this._extent;return t>=e[0]&&t<=e[1];},o.normalize=function(t){var e=this._extent;return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0]);},o.scale=function(t){var e=this._extent;return t*(e[1]-e[0])+e[0];},o.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]);},o.getExtent=function(){return this._extent.slice();},o.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=t),isNaN(e)||(i[1]=e);},o.getTicksLabels=function(){for(var t=[],e=this.getTicks(),i=0;i<e.length;i++){t.push(this.getLabel(e[i]));}return t;},r.enableClassExtend(n),r.enableClassManagement(n,{registerWhenExtend:!0}),t.exports=n;},function(t,e,i){var n=i(7),r=i(6),o=i(116),a=Math.floor,s=Math.ceil,l=n.getPrecisionSafe,u=n.round,h=o.extend({type:"interval",_interval:0,setExtent:function setExtent(t,e){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(e)||(i[1]=parseFloat(e));},unionExtent:function unionExtent(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),h.prototype.setExtent.call(this,e[0],e[1]);},getInterval:function getInterval(){return this._interval||this.niceTicks(),this._interval;},setInterval:function setInterval(t){this._interval=t,this._niceExtent=this._extent.slice();},getTicks:function getTicks(){this._interval||this.niceTicks();var t=this._interval,e=this._extent,i=[],n=1e4;if(t){var r=this._niceExtent,o=l(t)+2;e[0]<r[0]&&i.push(e[0]);for(var a=r[0];a<=r[1];){if(i.push(a),a=u(a+t,o),i.length>n)return[];}e[1]>(i.length?i[i.length-1]:r[1])&&i.push(e[1]);}return i;},getTicksLabels:function getTicksLabels(){for(var t=[],e=this.getTicks(),i=0;i<e.length;i++){t.push(this.getLabel(e[i]));}return t;},getLabel:function getLabel(t){return r.addCommas(t);},niceTicks:function niceTicks(t){t=t||5;var e=this._extent,i=e[1]-e[0];if(isFinite(i)){0>i&&(i=-i,e.reverse());var r=u(n.nice(i/t,!0),Math.max(l(e[0]),l(e[1]))+2),o=l(r)+2,h=[u(s(e[0]/r)*r,o),u(a(e[1]/r)*r,o)];this._interval=r,this._niceExtent=h;}},niceExtent:function niceExtent(t,e,i){var n=this._extent;if(n[0]===n[1])if(0!==n[0]){var r=n[0];i?n[0]-=r/2:(n[1]+=r/2,n[0]-=r/2);}else n[1]=1;var o=n[1]-n[0];isFinite(o)||(n[0]=0,n[1]=1),this.niceTicks(t);var l=this._interval;e||(n[0]=u(a(n[0]/l)*l)),i||(n[1]=u(s(n[1]/l)*l));}});h.create=function(){return new h();},t.exports=h;},function(t,e,i){var n=i(4),r=i(7),o=i(6),a=i(117),s=a.prototype,l=Math.ceil,u=Math.floor,h=1e3,c=60*h,d=60*c,f=24*d,p=function p(t,e,i,n){for(;n>i;){var r=i+n>>>1;t[r][2]<e?i=r+1:n=r;}return i;},g=a.extend({type:"time",getLabel:function getLabel(t){var e=this._stepLvl,i=new Date(t);return o.formatTime(e[0],i);},niceExtent:function niceExtent(t,e,i){var n=this._extent;if(n[0]===n[1]&&(n[0]-=f,n[1]+=f),n[1]===-(1/0)&&n[0]===1/0){var o=new Date();n[1]=new Date(o.getFullYear(),o.getMonth(),o.getDate()),n[0]=n[1]-f;}this.niceTicks(t);var a=this._interval;e||(n[0]=r.round(u(n[0]/a)*a)),i||(n[1]=r.round(l(n[1]/a)*a));},niceTicks:function niceTicks(t){t=t||10;var e=this._extent,i=e[1]-e[0],n=i/t,o=m.length,a=p(m,n,0,o),s=m[Math.min(a,o-1)],h=s[2];if("year"===s[0]){var c=i/h,d=r.nice(c/t,!0);h*=d;}var f=[l(e[0]/h)*h,u(e[1]/h)*h];this._stepLvl=s,this._interval=h,this._niceExtent=f;},parse:function parse(t){return+r.parseDate(t);}});n.each(["contain","normalize"],function(t){g.prototype[t]=function(e){return s[t].call(this,this.parse(e));};});var m=[["hh:mm:ss",1,h],["hh:mm:ss",5,5*h],["hh:mm:ss",10,10*h],["hh:mm:ss",15,15*h],["hh:mm:ss",30,30*h],["hh:mm\nMM-dd",1,c],["hh:mm\nMM-dd",5,5*c],["hh:mm\nMM-dd",10,10*c],["hh:mm\nMM-dd",15,15*c],["hh:mm\nMM-dd",30,30*c],["hh:mm\nMM-dd",1,d],["hh:mm\nMM-dd",2,2*d],["hh:mm\nMM-dd",6,6*d],["hh:mm\nMM-dd",12,12*d],["MM-dd\nyyyy",1,f],["week",7,7*f],["month",1,31*f],["quarter",3,380*f/4],["half-year",6,380*f/2],["year",1,380*f]];g.create=function(){return new g();},t.exports=g;},function(t,e,i){function n(t,e){return c(t,h(e));}var r=i(4),o=i(116),a=i(7),s=i(117),l=o.prototype,u=s.prototype,h=a.getPrecisionSafe,c=a.round,d=Math.floor,f=Math.ceil,p=Math.pow,g=Math.log,m=o.extend({type:"log",base:10,$constructor:function $constructor(){o.apply(this,arguments),this._originalScale=new s();},getTicks:function getTicks(){var t=this._originalScale,e=this._extent,i=t.getExtent();return r.map(u.getTicks.call(this),function(r){var o=a.round(p(this.base,r));return o=r===e[0]&&t.__fixMin?n(o,i[0]):o,o=r===e[1]&&t.__fixMax?n(o,i[1]):o;},this);},getLabel:u.getLabel,scale:function scale(t){return t=l.scale.call(this,t),p(this.base,t);},setExtent:function setExtent(t,e){var i=this.base;t=g(t)/g(i),e=g(e)/g(i),u.setExtent.call(this,t,e);},getExtent:function getExtent(){var t=this.base,e=l.getExtent.call(this);e[0]=p(t,e[0]),e[1]=p(t,e[1]);var i=this._originalScale,r=i.getExtent();return i.__fixMin&&(e[0]=n(e[0],r[0])),i.__fixMax&&(e[1]=n(e[1],r[1])),e;},unionExtent:function unionExtent(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=g(t[0])/g(e),t[1]=g(t[1])/g(e),l.unionExtent.call(this,t);},niceTicks:function niceTicks(t){t=t||10;var e=this._extent,i=e[1]-e[0];if(!(i===1/0||0>=i)){var n=a.quantity(i),r=t/i*n;for(.5>=r&&(n*=10);!isNaN(n)&&Math.abs(n)<1&&Math.abs(n)>0;){n*=10;}var o=[a.round(f(e[0]/n)*n),a.round(d(e[1]/n)*n)];this._interval=n,this._niceExtent=o;}},niceExtent:function niceExtent(t,e,i){u.niceExtent.call(this,t,e,i);var n=this._originalScale;n.__fixMin=e,n.__fixMax=i;}});r.each(["contain","normalize"],function(t){m.prototype[t]=function(e){return e=g(e)/g(this.base),l[t].call(this,e);};}),m.create=function(){return new m();},t.exports=m;},function(t,e,i){"use strict";function n(t){o.call(this,t);}var r=i(4),o=i(121);n.prototype={constructor:n,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x");},containPoint:function containPoint(t){var e=this.getAxis("x"),i=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]));},containData:function containData(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1]);},dataToPoints:function dataToPoints(t,e){return t.mapArray(["x","y"],function(t,e){return this.dataToPoint([t,e]);},e,this);},dataToPoint:function dataToPoint(t,e){var i=this.getAxis("x"),n=this.getAxis("y");return[i.toGlobalCoord(i.dataToCoord(t[0],e)),n.toGlobalCoord(n.dataToCoord(t[1],e))];},pointToData:function pointToData(t,e){var i=this.getAxis("x"),n=this.getAxis("y");return[i.coordToData(i.toLocalCoord(t[0]),e),n.coordToData(n.toLocalCoord(t[1]),e)];},getOtherAxis:function getOtherAxis(t){return this.getAxis("x"===t.dim?"y":"x");}},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";function n(t){return this._axes[t];}var r=i(4),o=function o(t){this._axes={},this._dimList=[],this.name=t||"";};o.prototype={constructor:o,type:"cartesian",getAxis:function getAxis(t){return this._axes[t];},getAxes:function getAxes(){return r.map(this._dimList,n,this);},getAxesByScale:function getAxesByScale(t){return t=t.toLowerCase(),r.filter(this.getAxes(),function(e){return e.scale.type===t;});},addAxis:function addAxis(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e);},dataToCoord:function dataToCoord(t){return this._dataCoordConvert(t,"dataToCoord");},coordToData:function coordToData(t){return this._dataCoordConvert(t,"coordToData");},_dataCoordConvert:function _dataCoordConvert(t,e){for(var i=this._dimList,n=t instanceof Array?[]:{},r=0;r<i.length;r++){var o=i[r],a=this._axes[o];n[o]=a[e](t[o]);}return n;}},t.exports=o;},function(t,e,i){var n=i(4),r=i(123),o=i(124),a=function a(t,e,i,n,o){r.call(this,t,e,i),this.type=n||"value",this.position=o||"bottom";};a.prototype={constructor:a,index:0,onZero:!1,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},getGlobalExtent:function getGlobalExtent(){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),t;},getLabelInterval:function getLabelInterval(){var t=this._labelInterval;return t||(t=this._labelInterval=o(this)),t;},isLabelIgnored:function isLabelIgnored(t){if("category"===this.type){var e=this.getLabelInterval();return"function"==typeof e&&!e(t,this.scale.getLabel(t))||t%(e+1);}},toLocalCoord:null,toGlobalCoord:null},n.inherits(a,r),t.exports=a;},function(t,e,i){function n(t,e){var i=t[1]-t[0],n=e,r=i/n/2;t[0]+=r,t[1]-=r;}var r=i(7),o=r.linearMap,a=i(4),s=[0,1],l=function l(t,e,i){this.dim=t,this.scale=e,this._extent=i||[0,0],this.inverse=!1,this.onBand=!1;};l.prototype={constructor:l,contain:function contain(t){var e=this._extent,i=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]);return t>=i&&n>=t;},containData:function containData(t){return this.contain(this.dataToCoord(t));},getExtent:function getExtent(){var t=this._extent.slice();return t;},getPixelPrecision:function getPixelPrecision(t){return r.getPixelPrecision(t||this.scale.getExtent(),this._extent);},setExtent:function setExtent(t,e){var i=this._extent;i[0]=t,i[1]=e;},dataToCoord:function dataToCoord(t,e){var i=this._extent,r=this.scale;return t=r.normalize(t),this.onBand&&"ordinal"===r.type&&(i=i.slice(),n(i,r.count())),o(t,s,i,e);},coordToData:function coordToData(t,e){var i=this._extent,r=this.scale;this.onBand&&"ordinal"===r.type&&(i=i.slice(),n(i,r.count()));var a=o(t,i,s,e);return this.scale.scale(a);},getTicksCoords:function getTicksCoords(t){if(this.onBand&&!t){for(var e=this.getBands(),i=[],n=0;n<e.length;n++){i.push(e[n][0]);}return e[n-1]&&i.push(e[n-1][1]),i;}return a.map(this.scale.getTicks(),this.dataToCoord,this);},getLabelsCoords:function getLabelsCoords(){return a.map(this.scale.getTicks(),this.dataToCoord,this);},getBands:function getBands(){for(var t=this.getExtent(),e=[],i=this.scale.count(),n=t[0],r=t[1],o=r-n,a=0;i>a;a++){e.push([o*a/i+n,o*(a+1)/i+n]);}return e;},getBandWidth:function getBandWidth(){var t=this._extent,e=this.scale.getExtent(),i=e[1]-e[0]+(this.onBand?1:0);0===i&&(i=1);var n=Math.abs(t[1]-t[0]);return Math.abs(n)/i;}},t.exports=l;},function(t,e,i){"use strict";var n=i(4),r=i(114);t.exports=function(t){var e=t.model,i=e.getModel("axisLabel"),o=i.get("interval");return"category"!==t.type||"auto"!==o?"auto"===o?0:o:r.getAxisLabelInterval(n.map(t.scale.getTicks(),t.dataToCoord,t),e.getFormattedLabels(),i.getModel("textStyle").getFont(),t.isHorizontal());};},function(t,e,i){"use strict";i(126);var n=i(19);t.exports=n.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});},function(t,e,i){"use strict";function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(4),a=i(127),s=r.extend({type:"cartesian2dAxis",axis:null,init:function init(){s.superApply(this,"init",arguments),this.resetRange();},mergeOption:function mergeOption(){s.superApply(this,"mergeOption",arguments),this.resetRange();},restoreData:function restoreData(){s.superApply(this,"restoreData",arguments),this.resetRange();},findGridModel:function findGridModel(){return this.ecModel.queryComponents({mainType:"grid",index:this.get("gridIndex"),id:this.get("gridId")})[0];}});o.merge(s.prototype,i(129)),o.merge(s.prototype,i(130));var l={offset:0};a("x",s,n,l),a("y",s,n,l),t.exports=s;},function(t,e,i){var n=i(128),r=i(4),o=i(19),a=i(21),s=["value","category","time","log"];t.exports=function(t,e,i,l){r.each(s,function(o){e.extend({type:t+"Axis."+o,mergeDefaultAndTheme:function mergeDefaultAndTheme(e,n){var s=this.layoutMode,l=s?a.getLayoutParams(e):{},u=n.getTheme();r.merge(e,u.get(o+"Axis")),r.merge(e,this.getDefaultOption()),e.type=i(t,e),s&&a.mergeLayoutParam(e,l,s);},defaultOption:r.mergeAll([{},n[o+"Axis"],l],!0)});}),o.registerSubTypeDefaulter(t+"Axis",r.curry(i,t));};},function(t,e,i){var n=i(4),r={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisLine:{show:!0,onZero:!0,lineStyle:{color:"#333",width:1,type:"solid"}},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},o=n.merge({boundaryGap:!0,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},r),a=n.merge({boundaryGap:[0,0],splitNumber:5},r),s=n.defaults({scale:!0,min:"dataMin",max:"dataMax"},a),l=n.defaults({logBase:10},a);l.scale=!0,t.exports={categoryAxis:o,valueAxis:a,timeAxis:s,logAxis:l};},function(t,e,i){function n(t){return a.isObject(t)&&null!=t.value?t.value:t;}function r(){return"category"===this.get("type")&&a.map(this.get("data"),n);}function o(){return s.getFormattedLabels(this.axis,this.get("axisLabel.formatter"));}var a=i(4),s=i(114);t.exports={getFormattedLabels:o,getCategories:r};},function(t,e){t.exports={getMin:function getMin(){var t=this.option,e=null!=t.rangeStart?t.rangeStart:t.min;return e instanceof Date&&(e=+e),e;},getMax:function getMax(){var t=this.option,e=null!=t.rangeEnd?t.rangeEnd:t.max;return e instanceof Date&&(e=+e),e;},getNeedCrossZero:function getNeedCrossZero(){var t=this.option;return null!=t.rangeStart||null!=t.rangeEnd?!1:!t.scale;},setRange:function setRange(t,e){this.option.rangeStart=t,this.option.rangeEnd=e;},resetRange:function resetRange(){this.option.rangeStart=this.option.rangeEnd=null;}};},function(t,e,i){"use strict";i(126),i(132);},function(t,e,i){function n(t,e){function i(t,e){var i=n.getAxis(t);return i.toGlobalCoord(i.dataToCoord(0));}var n=t.coordinateSystem,r=e.axis,o={},a=r.position,s=r.onZero?"onZero":a,l=r.dim,u=n.getRect(),h=[u.x,u.x+u.width,u.y,u.y+u.height],c=e.get("offset")||0,d={x:{top:h[2]-c,bottom:h[3]+c},y:{left:h[0]-c,right:h[1]+c}};d.x.onZero=Math.max(Math.min(i("y"),d.x.bottom),d.x.top),d.y.onZero=Math.max(Math.min(i("x"),d.y.right),d.y.left),o.position=["y"===l?d.y[s]:h[0],"x"===l?d.x[s]:h[3]],o.rotation=Math.PI/2*("x"===l?0:1);var f={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=f[a],r.onZero&&(o.labelOffset=d[l][a]-d[l].onZero),e.getModel("axisTick").get("inside")&&(o.tickDirection=-o.tickDirection),e.getModel("axisLabel").get("inside")&&(o.labelDirection=-o.labelDirection);var p=e.getModel("axisLabel").get("rotate");return o.labelRotation="top"===s?-p:p,o.labelInterval=r.getLabelInterval(),o.z2=1,o;}var r=i(4),o=i(43),a=i(133),s=a.ifIgnoreOnTick,l=a.getInterval,u=["axisLine","axisLabel","axisTick","axisName"],h=["splitArea","splitLine"],c=i(1).extendComponentView({type:"axis",render:function render(t,e){this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new o.Group(),this.group.add(this._axisGroup),t.get("show")){var s=t.findGridModel(),l=n(s,t),c=new a(t,l);r.each(u,c.add,c),this._axisGroup.add(c.getGroup()),r.each(h,function(e){t.get(e+".show")&&this["_"+e](t,s,l.labelInterval);},this),o.groupTransition(i,this._axisGroup,t);}},_splitLine:function _splitLine(t,e,i){var n=t.axis,a=t.getModel("splitLine"),u=a.getModel("lineStyle"),h=u.get("color"),c=l(a,i);h=r.isArray(h)?h:[h];for(var d=e.coordinateSystem.getRect(),f=n.isHorizontal(),p=0,g=n.getTicksCoords(),m=n.scale.getTicks(),v=[],y=[],x=u.getLineStyle(),_=0;_<g.length;_++){if(!s(n,_,c)){var b=n.toGlobalCoord(g[_]);f?(v[0]=b,v[1]=d.y,y[0]=b,y[1]=d.y+d.height):(v[0]=d.x,v[1]=b,y[0]=d.x+d.width,y[1]=b);var w=p++%h.length;this._axisGroup.add(new o.Line(o.subPixelOptimizeLine({anid:"line_"+m[_],shape:{x1:v[0],y1:v[1],x2:y[0],y2:y[1]},style:r.defaults({stroke:h[w]},x),silent:!0})));}}},_splitArea:function _splitArea(t,e,i){var n=t.axis,a=t.getModel("splitArea"),u=a.getModel("areaStyle"),h=u.get("color"),c=e.coordinateSystem.getRect(),d=n.getTicksCoords(),f=n.scale.getTicks(),p=n.toGlobalCoord(d[0]),g=n.toGlobalCoord(d[0]),m=0,v=l(a,i),y=u.getAreaStyle();h=r.isArray(h)?h:[h];for(var x=1;x<d.length;x++){if(!s(n,x,v)){var _,b,w,S,M=n.toGlobalCoord(d[x]);n.isHorizontal()?(_=p,b=c.y,w=M-_,S=c.height):(_=c.x,b=g,w=c.width,S=M-b);var I=m++%h.length;this._axisGroup.add(new o.Rect({anid:"area_"+f[x],shape:{x:_,y:b,width:w,height:S},style:r.defaults({fill:h[I]},y),silent:!0})),p=_+w,g=b+S;}}}});c.extend({type:"xAxis"}),c.extend({type:"yAxis"});},function(t,e,i){function n(t){var e={componentType:t.mainType};return e[t.mainType+"Index"]=t.componentIndex,e;}function r(t,e,i){var n,r,o=d(e-t.rotation);return f(o)?(r=i>0?"top":"bottom",n="center"):f(o-v)?(r=i>0?"bottom":"top",n="center"):(r="middle",n=o>0&&v>o?i>0?"right":"left":i>0?"left":"right"),{rotation:o,textAlign:n,verticalAlign:r};}function o(t,e,i,n){var r,o,a=d(i-t.rotation),s=n[0]>n[1],l="start"===e&&!s||"start"!==e&&s;return f(a-v/2)?(o=l?"bottom":"top",r="center"):f(a-1.5*v)?(o=l?"top":"bottom",r="center"):(o="middle",r=1.5*v>a&&a>v/2?l?"left":"right":l?"right":"left"),{rotation:a,textAlign:r,verticalAlign:o};}function a(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show);}var s=i(4),l=i(6),u=i(43),h=i(12),c=i(7),d=c.remRadian,f=c.isRadianAroundZero,p=i(10),g=p.applyTransform,m=s.retrieve,v=Math.PI,y=function y(t,e){this.opt=e,this.axisModel=t,s.defaults(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new u.Group();var i=new u.Group({position:e.position.slice(),rotation:e.rotation});i.updateTransform(),this._transform=i.transform,this._dumbGroup=i;};y.prototype={constructor:y,hasBuilder:function hasBuilder(t){return!!x[t];},add:function add(t){x[t].call(this);},getGroup:function getGroup(){return this.group;}};var x={axisLine:function axisLine(){var t=this.opt,e=this.axisModel;if(e.get("axisLine.show")){var i=this.axisModel.axis.getExtent(),n=this._transform,r=[i[0],0],o=[i[1],0];n&&(g(r,r,n),g(o,o,n)),this.group.add(new u.Line(u.subPixelOptimizeLine({anid:"line",shape:{x1:r[0],y1:r[1],x2:o[0],y2:o[1]},style:s.extend({lineCap:"round"},e.getModel("axisLine.lineStyle").getLineStyle()),strokeContainThreshold:t.strokeContainThreshold||5,silent:!0,z2:1})));}},axisTick:function axisTick(){var t=this.axisModel;if(t.get("axisTick.show"))for(var e=t.axis,i=t.getModel("axisTick"),n=this.opt,r=i.getModel("lineStyle"),o=i.get("length"),a=b(i,n.labelInterval),l=e.getTicksCoords(i.get("alignWithLabel")),h=e.scale.getTicks(),c=[],d=[],f=this._transform,p=0;p<l.length;p++){if(!_(e,p,a)){var m=l[p];c[0]=m,c[1]=0,d[0]=m,d[1]=n.tickDirection*o,f&&(g(c,c,f),g(d,d,f)),this.group.add(new u.Line(u.subPixelOptimizeLine({anid:"tick_"+h[p],shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:s.defaults(r.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),z2:2,silent:!0})));}}},axisLabel:function axisLabel(){function t(t,e){var i=t&&t.getBoundingRect().clone(),n=e&&e.getBoundingRect().clone();return i&&n?(i.applyTransform(t.getLocalTransform()),n.applyTransform(e.getLocalTransform()),i.intersect(n)):void 0;}var e=this.opt,i=this.axisModel,o=m(e.axisLabelShow,i.get("axisLabel.show"));if(o){var s=i.axis,l=i.getModel("axisLabel"),c=l.getModel("textStyle"),d=l.get("margin"),f=s.scale.getTicks(),p=i.getFormattedLabels(),g=m(e.labelRotation,l.get("rotate"))||0;g=g*v/180;for(var y=r(e,g,e.labelDirection),x=i.get("data"),b=[],w=a(i),S=i.get("triggerEvent"),M=0;M<f.length;M++){if(!_(s,M,e.labelInterval)){var I=c;x&&x[M]&&x[M].textStyle&&(I=new h(x[M].textStyle,c,i.ecModel));var T=I.getTextColor()||i.get("axisLine.lineStyle.color"),A=s.dataToCoord(f[M]),L=[A,e.labelOffset+e.labelDirection*d],C=s.scale.getLabel(f[M]),D=new u.Text({anid:"label_"+f[M],style:{text:p[M],textAlign:I.get("align",!0)||y.textAlign,textVerticalAlign:I.get("baseline",!0)||y.verticalAlign,textFont:I.getFont(),fill:"function"==typeof T?T(C):T},position:L,rotation:y.rotation,silent:w,z2:10});S&&(D.eventData=n(i),D.eventData.targetType="axisLabel",D.eventData.value=C),this._dumbGroup.add(D),D.updateTransform(),b.push(D),this.group.add(D),D.decomposeTransform();}}if("category"!==s.type){if(i.getMin?i.getMin():i.get("min")){var P=b[0],k=b[1];t(P,k)&&(P.ignore=!0);}if(i.getMax?i.getMax():i.get("max")){var z=b[b.length-1],O=b[b.length-2];t(O,z)&&(z.ignore=!0);}}}},axisName:function axisName(){var t=this.opt,e=this.axisModel,i=m(t.axisName,e.get("name"));if(i){var h,c=e.get("nameLocation"),d=t.nameDirection,f=e.getModel("nameTextStyle"),p=e.get("nameGap")||0,g=this.axisModel.axis.getExtent(),y=g[0]>g[1]?-1:1,x=["start"===c?g[0]-y*p:"end"===c?g[1]+y*p:(g[0]+g[1])/2,"middle"===c?t.labelOffset+d*p:0],_=e.get("nameRotate");null!=_&&(_=_*v/180);var b;"middle"===c?h=r(t,null!=_?_:t.rotation,d):(h=o(t,c,_||0,g),b=t.axisNameAvailableWidth,null!=b&&(b=Math.abs(b/Math.sin(h.rotation)),!isFinite(b)&&(b=null)));var w=f.getFont(),S=e.get("nameTruncate",!0)||{},M=S.ellipsis,I=m(S.maxWidth,b),T=null!=M&&null!=I?l.truncateText(i,I,w,M,{minChar:2,placeholder:S.placeholder}):i,A=e.get("tooltip",!0),L=e.mainType,C={componentType:L,name:i,$vars:["name"]};C[L+"Index"]=e.componentIndex;var D=new u.Text({anid:"name",__fullText:i,__truncatedText:T,style:{text:T,textFont:w,fill:f.getTextColor()||e.get("axisLine.lineStyle.color"),textAlign:h.textAlign,textVerticalAlign:h.verticalAlign},position:x,rotation:h.rotation,silent:a(e),z2:1,tooltip:A&&A.show?s.extend({content:i,formatter:function formatter(){return i;},formatterParams:C},A):null});e.get("triggerEvent")&&(D.eventData=n(e),D.eventData.targetType="axisName",D.eventData.name=i),this._dumbGroup.add(D),D.updateTransform(),this.group.add(D),D.decomposeTransform();}}},_=y.ifIgnoreOnTick=function(t,e,i){var n,r=t.scale;return"ordinal"===r.type&&("function"==typeof i?(n=r.getTicks()[e],!i(n,r.getLabel(n))):e%(i+1));},b=y.getInterval=function(t,e){var i=t.get("interval");return(null==i||"auto"==i)&&(i=e),i;};t.exports=y;},function(t,e,i){var n=i(4);i(113),i(135),i(136);var r=i(138),o=i(1);o.registerLayout(n.curry(r,"bar")),o.registerVisual(function(t){t.eachSeriesByType("bar",function(t){var e=t.getData();e.setVisual("legendSymbol","roundRect");});}),i(112);},function(t,e,i){"use strict";var n=i(28),r=i(101);t.exports=n.extend({type:"series.bar",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=t.coordinateSystem;if("cartesian2d"!==i)throw new Error("Bar only support cartesian2d coordinateSystem");return r(t.data,this,e);},getMarkerPosition:function getMarkerPosition(t){var e=this.coordinateSystem;if(e){var i=e.dataToPoint(t,!0),n=this.getData(),r=n.getLayout("offset"),o=n.getLayout("size"),a=e.getBaseAxis().isHorizontal()?0:1;return i[a]+=r+o/2,i;}return[NaN,NaN];},brushSelector:"rect",defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,itemStyle:{normal:{},emphasis:{}}}});},function(t,e,i){"use strict";function n(t,e){var i=t.width>0?1:-1,n=t.height>0?1:-1;e=Math.min(e,Math.abs(t.width),Math.abs(t.height)),t.x+=i*e/2,t.y+=n*e/2,t.width-=i*e,t.height-=n*e;}var r=i(4),o=i(43);r.extend(i(12).prototype,i(137)),t.exports=i(1).extendChartView({type:"bar",render:function render(t,e,i){var n=t.get("coordinateSystem");return"cartesian2d"===n&&this._renderOnCartesian(t,e,i),this.group;},dispose:r.noop,_renderOnCartesian:function _renderOnCartesian(t,e,i){function a(e,i){var a=l.getItemLayout(e),s=l.getItemModel(e).get(p)||0;n(a,s);var u=new o.Rect({shape:r.extend({},a)});if(f){var h=u.shape,c=d?"height":"width",g={};h[c]=0,g[c]=a[c],o[i?"updateProps":"initProps"](u,{shape:g},t,e);}return u;}var s=this.group,l=t.getData(),u=this._data,h=t.coordinateSystem,c=h.getBaseAxis(),d=c.isHorizontal(),f=t.get("animation"),p=["itemStyle","normal","barBorderWidth"];l.diff(u).add(function(t){if(l.hasValue(t)){var e=a(t);l.setItemGraphicEl(t,e),s.add(e);}}).update(function(e,i){var r=u.getItemGraphicEl(i);if(!l.hasValue(e))return void s.remove(r);r||(r=a(e,!0));var h=l.getItemLayout(e),c=l.getItemModel(e).get(p)||0;n(h,c),o.updateProps(r,{shape:h},t,e),l.setItemGraphicEl(e,r),s.add(r);}).remove(function(e){var i=u.getItemGraphicEl(e);i&&(i.style.text="",o.updateProps(i,{shape:{width:0}},t,e,function(){s.remove(i);}));}).execute(),this._updateStyle(t,l,d),this._data=l;},_updateStyle:function _updateStyle(t,e,i){function n(t,e,i,n,r){o.setText(t,e,i),t.text=n,"outside"===t.textPosition&&(t.textPosition=r);}e.eachItemGraphicEl(function(a,s){var l=e.getItemModel(s),u=e.getItemVisual(s,"color"),h=e.getItemVisual(s,"opacity"),c=e.getItemLayout(s),d=l.getModel("itemStyle.normal"),f=l.getModel("itemStyle.emphasis").getBarItemStyle();a.setShape("r",d.get("barBorderRadius")||0),a.useStyle(r.defaults({fill:u,opacity:h},d.getBarItemStyle()));var p=i?c.height>0?"bottom":"top":c.width>0?"left":"right",g=l.getModel("label.normal"),m=l.getModel("label.emphasis"),v=a.style;g.get("show")?n(v,g,u,r.retrieve(t.getFormattedLabel(s,"normal"),t.getRawValue(s)),p):v.text="",m.get("show")?n(f,m,u,r.retrieve(t.getFormattedLabel(s,"emphasis"),t.getRawValue(s)),p):f.text="",o.setHoverStyle(a,f);});},remove:function remove(t,e){var i=this.group;t.get("animation")?this._data&&this._data.eachItemGraphicEl(function(e){e.style.text="",o.updateProps(e,{shape:{width:0}},t,e.dataIndex,function(){i.remove(e);});}):i.removeAll();}});},function(t,e,i){var n=i(15)([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);t.exports={getBarItemStyle:function getBarItemStyle(t){var e=n.call(this,t);if(this.getBorderLineDash){var i=this.getBorderLineDash();i&&(e.lineDash=i);}return e;}};},function(t,e,i){"use strict";function n(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex;}function r(t){return t.dim+t.index;}function o(t,e){var i={};s.each(t,function(t,e){var o=t.getData(),a=t.coordinateSystem,s=a.getBaseAxis(),l=s.getExtent(),h="category"===s.type?s.getBandWidth():Math.abs(l[1]-l[0])/o.count(),c=i[r(s)]||{bandWidth:h,remainedWidth:h,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},d=c.stacks;i[r(s)]=c;var f=n(t);d[f]||c.autoWidthCount++,d[f]=d[f]||{width:0,maxWidth:0};var p=u(t.get("barWidth"),h),g=u(t.get("barMaxWidth"),h),m=t.get("barGap"),v=t.get("barCategoryGap");p&&!d[f].width&&(p=Math.min(c.remainedWidth,p),d[f].width=p,c.remainedWidth-=p),g&&(d[f].maxWidth=g),null!=m&&(c.gap=m),null!=v&&(c.categoryGap=v);});var o={};return s.each(i,function(t,e){o[e]={};var i=t.stacks,n=t.bandWidth,r=u(t.categoryGap,n),a=u(t.gap,1),l=t.remainedWidth,h=t.autoWidthCount,c=(l-r)/(h+(h-1)*a);c=Math.max(c,0),s.each(i,function(t,e){var i=t.maxWidth;!t.width&&i&&c>i&&(i=Math.min(i,l),l-=i,t.width=i,h--);}),c=(l-r)/(h+(h-1)*a),c=Math.max(c,0);var d,f=0;s.each(i,function(t,e){t.width||(t.width=c),d=t,f+=t.width*(1+a);}),d&&(f-=d.width*a);var p=-f/2;s.each(i,function(t,i){o[e][i]=o[e][i]||{offset:p,width:t.width},p+=t.width*(1+a);});}),o;}function a(t,e,i){var a=o(s.filter(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type;})),l={},u={};e.eachSeriesByType(t,function(t){var e=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),s=n(t),h=a[r(o)][s],c=h.offset,d=h.width,f=i.getOtherAxis(o),p=t.get("barMinHeight")||0,g=o.onZero?f.toGlobalCoord(f.dataToCoord(0)):f.getGlobalExtent()[0],m=i.dataToPoints(e,!0);l[s]=l[s]||[],u[s]=u[s]||[],e.setLayout({offset:c,size:d}),e.each(f.dim,function(t,i){if(!isNaN(t)){l[s][i]||(l[s][i]={p:g,n:g},u[s][i]={p:g,n:g});var n,r,o,a,h=t>=0?"p":"n",v=m[i],y=l[s][i][h],x=u[s][i][h];f.isHorizontal()?(n=y,r=v[1]+c,o=v[0]-x,a=d,u[s][i][h]+=o,Math.abs(o)<p&&(o=(0>o?-1:1)*p),l[s][i][h]+=o):(n=v[0]+c,r=y,o=d,a=v[1]-x,u[s][i][h]+=a,Math.abs(a)<p&&(a=(0>=a?-1:1)*p),l[s][i][h]+=a),e.setItemLayout(i,{x:n,y:r,width:o,height:a});}},!0);},this);}var s=i(4),l=i(7),u=l.parsePercent;t.exports=a;},function(t,e,i){var n=i(4),r=i(1);i(140),i(142),i(143)("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),r.registerVisual(n.curry(i(144),"pie")),r.registerLayout(n.curry(i(145),"pie")),r.registerProcessor(n.curry(i(147),"pie"));},function(t,e,i){"use strict";var n=i(97),r=i(4),o=i(5),a=i(102),s=i(141),l=i(1).extendSeriesModel({type:"series.pie",init:function init(t){l.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;},this.updateSelectedMap(t.data),this._defaultLabelLine(t);},mergeOption:function mergeOption(t){l.superCall(this,"mergeOption",t),this.updateSelectedMap(this.option.data);},getInitialData:function getInitialData(t,e){var i=a(["value"],t.data),r=new n(i,this);return r.initData(t.data),r;},getDataParams:function getDataParams(t){var e=this._data,i=l.superCall(this,"getDataParams",t),n=e.getSum("value");return i.percent=n?+(e.get("value",t)/n*100).toFixed(2):0,i.$vars.push("percent"),i;},_defaultLabelLine:function _defaultLabelLine(t){o.defaultEmphasis(t.labelLine,["show"]);var e=t.labelLine.normal,i=t.labelLine.emphasis;e.show=e.show&&t.label.normal.show,i.show=i.show&&t.label.emphasis.show;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,selectedOffset:10,avoidLabelOverlap:!0,label:{normal:{rotate:!1,show:!0,position:"outer"},emphasis:{}},labelLine:{normal:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}}},itemStyle:{normal:{borderWidth:1},emphasis:{}},animationEasing:"cubicOut",data:[]}});r.mixin(l,s),t.exports=l;},function(t,e,i){var n=i(4);t.exports={updateSelectedMap:function updateSelectedMap(t){this._selectTargetMap=n.reduce(t||[],function(t,e){return t[e.name]=e,t;},{});},select:function select(t){var e=this._selectTargetMap,i=e[t],r=this.get("selectedMode");"single"===r&&n.each(e,function(t){t.selected=!1;}),i&&(i.selected=!0);},unSelect:function unSelect(t){var e=this._selectTargetMap[t];e&&(e.selected=!1);},toggleSelected:function toggleSelected(t){var e=this._selectTargetMap[t];return null!=e?(this[e.selected?"unSelect":"select"](t),e.selected):void 0;},isSelected:function isSelected(t){var e=this._selectTargetMap[t];return e&&e.selected;}};},function(t,e,i){function n(t,e,i,n){var o=e.getData(),a=this.dataIndex,s=o.getName(a),l=e.get("selectedOffset");n.dispatchAction({type:"pieToggleSelect",from:t,name:s,seriesId:e.id}),o.each(function(t){r(o.getItemGraphicEl(t),o.getItemLayout(t),e.isSelected(o.getName(t)),l,i);});}function r(t,e,i,n,r){var o=(e.startAngle+e.endAngle)/2,a=Math.cos(o),s=Math.sin(o),l=i?n:0,u=[a*l,s*l];r?t.animate().when(200,{position:u}).start("bounceOut"):t.attr("position",u);}function o(t,e){function i(){o.ignore=o.hoverIgnore,a.ignore=a.hoverIgnore;}function n(){o.ignore=o.normalIgnore,a.ignore=a.normalIgnore;}s.Group.call(this);var r=new s.Sector({z2:2}),o=new s.Polyline(),a=new s.Text();this.add(r),this.add(o),this.add(a),this.updateData(t,e,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n);}function a(t,e,i,n,r){var o=n.getModel("textStyle"),a="inside"===r||"inner"===r;return{fill:o.getTextColor()||(a?"#fff":t.getItemVisual(e,"color")),opacity:t.getItemVisual(e,"opacity"),textFont:o.getFont(),text:l.retrieve(t.hostModel.getFormattedLabel(e,i),t.getName(e))};}var s=i(43),l=i(4),u=o.prototype;u.updateData=function(t,e,i){function n(){a.stopAnimation(!0),a.animateTo({shape:{r:c.r+10}},300,"elasticOut");}function o(){a.stopAnimation(!0),a.animateTo({shape:{r:c.r}},300,"elasticOut");}var a=this.childAt(0),u=t.hostModel,h=t.getItemModel(e),c=t.getItemLayout(e),d=l.extend({},c);d.label=null,i?(a.setShape(d),a.shape.endAngle=c.startAngle,s.updateProps(a,{shape:{endAngle:c.endAngle}},u,e)):s.updateProps(a,{shape:d},u,e);var f=h.getModel("itemStyle"),p=t.getItemVisual(e,"color");a.useStyle(l.defaults({lineJoin:"bevel",fill:p},f.getModel("normal").getItemStyle())),a.hoverStyle=f.getModel("emphasis").getItemStyle(),r(this,t.getItemLayout(e),h.get("selected"),u.get("selectedOffset"),u.get("animation")),a.off("mouseover").off("mouseout").off("emphasis").off("normal"),h.get("hoverAnimation")&&u.ifEnableAnimation()&&a.on("mouseover",n).on("mouseout",o).on("emphasis",n).on("normal",o),this._updateLabel(t,e),s.setHoverStyle(this);},u._updateLabel=function(t,e){var i=this.childAt(1),n=this.childAt(2),r=t.hostModel,o=t.getItemModel(e),l=t.getItemLayout(e),u=l.label,h=t.getItemVisual(e,"color");s.updateProps(i,{shape:{points:u.linePoints||[[u.x,u.y],[u.x,u.y],[u.x,u.y]]}},r,e),s.updateProps(n,{style:{x:u.x,y:u.y}},r,e),n.attr({style:{textVerticalAlign:u.verticalAlign,textAlign:u.textAlign,textFont:u.font},rotation:u.rotation,origin:[u.x,u.y],z2:10});var c=o.getModel("label.normal"),d=o.getModel("label.emphasis"),f=o.getModel("labelLine.normal"),p=o.getModel("labelLine.emphasis"),g=c.get("position")||d.get("position");n.setStyle(a(t,e,"normal",c,g)),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),i.ignore=i.normalIgnore=!f.get("show"),i.hoverIgnore=!p.get("show"),i.setStyle({stroke:h,opacity:t.getItemVisual(e,"opacity")}),i.setStyle(f.getModel("lineStyle").getLineStyle()),n.hoverStyle=a(t,e,"emphasis",d,g),i.hoverStyle=p.getModel("lineStyle").getLineStyle();var m=f.get("smooth");m&&m===!0&&(m=.4),i.setShape({smooth:m});},l.inherits(o,s.Group);var h=i(42).extend({type:"pie",init:function init(){var t=new s.Group();this._sectorGroup=t;},render:function render(t,e,i,r){if(!r||r.from!==this.uid){var a=t.getData(),s=this._data,u=this.group,h=e.get("animation"),c=!s,d=l.curry(n,this.uid,t,h,i),f=t.get("selectedMode");if(a.diff(s).add(function(t){var e=new o(a,t);c&&e.eachChild(function(t){t.stopAnimation(!0);}),f&&e.on("click",d),a.setItemGraphicEl(t,e),u.add(e);}).update(function(t,e){var i=s.getItemGraphicEl(e);i.updateData(a,t),i.off("click"),f&&i.on("click",d),u.add(i),a.setItemGraphicEl(t,i);}).remove(function(t){var e=s.getItemGraphicEl(t);u.remove(e);}).execute(),h&&c&&a.count()>0){var p=a.getItemLayout(0),g=Math.max(i.getWidth(),i.getHeight())/2,m=l.bind(u.removeClipPath,u);u.setClipPath(this._createClipPath(p.cx,p.cy,g,p.startAngle,p.clockwise,m,t));}this._data=a;}},dispose:function dispose(){},_createClipPath:function _createClipPath(t,e,i,n,r,o,a){var l=new s.Sector({shape:{cx:t,cy:e,r0:0,r:i,startAngle:n,endAngle:n,clockwise:r}});return s.initProps(l,{shape:{endAngle:n+(r?1:-1)*Math.PI*2}},a,o),l;},containPoint:function containPoint(t,e){var i=e.getData(),n=i.getItemLayout(0);if(n){var r=t[0]-n.cx,o=t[1]-n.cy,a=Math.sqrt(r*r+o*o);return a<=n.r&&a>=n.r0;}}});t.exports=h;},function(t,e,i){var n=i(1),r=i(4);t.exports=function(t,e){r.each(e,function(e){e.update="updateView",n.registerAction(e,function(i,n){var r={};return n.eachComponent({mainType:"series",subType:t,query:i},function(t){t[e.method]&&t[e.method](i.name);var n=t.getData();n.each(function(e){var i=n.getName(e);r[i]=t.isSelected(i)||!1;});}),{name:i.name,selected:r};});});};},function(t,e){t.exports=function(t,e){var i={};e.eachRawSeriesByType(t,function(t){var n=t.getRawData(),r={};if(!e.isSeriesFiltered(t)){var o=t.getData();o.each(function(t){var e=o.getRawIndex(t);r[e]=t;}),n.each(function(e){var a=n.getItemModel(e),s=r[e],l=null!=s&&o.getItemVisual(s,"color",!0);if(l)n.setItemVisual(e,"color",l);else{var u=a.get("itemStyle.normal.color")||t.getColorFromPalette(n.getName(e),i);n.setItemVisual(e,"color",u),null!=s&&o.setItemVisual(s,"color",u);}});}});};},function(t,e,i){var n=i(7),r=n.parsePercent,o=i(146),a=i(4),s=2*Math.PI,l=Math.PI/180;t.exports=function(t,e,i,u){e.eachSeriesByType(t,function(t){var e=t.get("center"),u=t.get("radius");a.isArray(u)||(u=[0,u]),a.isArray(e)||(e=[e,e]);var h=i.getWidth(),c=i.getHeight(),d=Math.min(h,c),f=r(e[0],h),p=r(e[1],c),g=r(u[0],d/2),m=r(u[1],d/2),v=t.getData(),y=-t.get("startAngle")*l,x=t.get("minAngle")*l,_=v.getSum("value"),b=Math.PI/(_||v.count())*2,w=t.get("clockwise"),S=t.get("roseType"),M=v.getDataExtent("value");M[0]=0;var I=s,T=0,A=y,L=w?1:-1;if(v.each("value",function(t,e){var i;i="area"!==S?0===_?b:t*b:s/(v.count()||1),x>i?(i=x,I-=x):T+=t;var r=A+L*i;v.setItemLayout(e,{angle:i,startAngle:A,endAngle:r,clockwise:w,cx:f,cy:p,r0:g,r:S?n.linearMap(t,M,[g,m]):m}),A=r;},!0),s>I)if(.001>=I){var C=s/v.count();v.each(function(t){var e=v.getItemLayout(t);e.startAngle=y+L*t*C,e.endAngle=y+L*(t+1)*C;});}else b=I/T,A=y,v.each("value",function(t,e){var i=v.getItemLayout(e),n=i.angle===x?x:t*b;i.startAngle=A,i.endAngle=A+L*n,A+=n;});o(t,m,h,c);});};},function(t,e,i){"use strict";function n(t,e,i,n,r,o,a){function s(e,i,n,r){for(var o=e;i>o;o++){if(t[o].y+=n,o>e&&i>o+1&&t[o+1].y>t[o].y+t[o].height)return void l(o,n/2);}l(i-1,n/2);}function l(e,i){for(var n=e;n>=0&&(t[n].y-=i,!(n>0&&t[n].y>t[n-1].y+t[n-1].height));n--){}}function u(t,e,i,n,r,o){for(var a=o>0?e?Number.MAX_VALUE:0:e?Number.MAX_VALUE:0,s=0,l=t.length;l>s;s++){if("center"!==t[s].position){var u=Math.abs(t[s].y-n),h=t[s].len,c=t[s].len2,d=r+h>u?Math.sqrt((r+h+c)*(r+h+c)-u*u):Math.abs(t[s].x-i);e&&d>=a&&(d=a-10),!e&&a>=d&&(d=a+10),t[s].x=i+d*o,a=d;}}}t.sort(function(t,e){return t.y-e.y;});for(var h,c=0,d=t.length,f=[],p=[],g=0;d>g;g++){h=t[g].y-c,0>h&&s(g,d,-h,r),c=t[g].y+t[g].height;}0>a-c&&l(d-1,c-a);for(var g=0;d>g;g++){t[g].y>=i?p.push(t[g]):f.push(t[g]);}u(f,!1,e,i,n,r),u(p,!0,e,i,n,r);}function r(t,e,i,r,o,a){for(var s=[],l=[],u=0;u<t.length;u++){t[u].x<e?s.push(t[u]):l.push(t[u]);}n(l,e,i,r,1,o,a),n(s,e,i,r,-1,o,a);for(var u=0;u<t.length;u++){var h=t[u].linePoints;if(h){var c=h[1][0]-h[2][0];t[u].x<e?h[2][0]=t[u].x+3:h[2][0]=t[u].x-3,h[1][1]=h[2][1]=t[u].y,h[1][0]=h[2][0]+c;}}}var o=i(8);t.exports=function(t,e,i,n){var a,s,l=t.getData(),u=[],h=!1;l.each(function(i){var n,r,c,d,f=l.getItemLayout(i),p=l.getItemModel(i),g=p.getModel("label.normal"),m=g.get("position")||p.get("label.emphasis.position"),v=p.getModel("labelLine.normal"),y=v.get("length"),x=v.get("length2"),_=(f.startAngle+f.endAngle)/2,b=Math.cos(_),w=Math.sin(_);a=f.cx,s=f.cy;var S="inside"===m||"inner"===m;if("center"===m)n=f.cx,r=f.cy,d="center";else{var M=(S?(f.r+f.r0)/2*b:f.r*b)+a,I=(S?(f.r+f.r0)/2*w:f.r*w)+s;if(n=M+3*b,r=I+3*w,!S){var T=M+b*(y+e-f.r),A=I+w*(y+e-f.r),L=T+(0>b?-1:1)*x,C=A;n=L+(0>b?-5:5),r=C,c=[[M,I],[T,A],[L,C]];}d=S?"center":b>0?"left":"right";}var D=g.getModel("textStyle").getFont(),P=g.get("rotate")?0>b?-_+Math.PI:-_:0,k=t.getFormattedLabel(i,"normal")||l.getName(i),z=o.getBoundingRect(k,D,d,"top");h=!!P,f.label={x:n,y:r,position:m,height:z.height,len:y,len2:x,linePoints:c,textAlign:d,verticalAlign:"middle",font:D,rotation:P},S||u.push(f.label);}),!h&&t.get("avoidLabelOverlap")&&r(u,a,s,e,i,n);};},function(t,e){t.exports=function(t,e){var i=e.findComponents({mainType:"legend"});i&&i.length&&e.eachSeriesByType(t,function(t){var e=t.getData();e.filterSelf(function(t){for(var n=e.getName(t),r=0;r<i.length;r++){if(!i[r].isSelected(n))return!1;}return!0;},this);},this);};},function(t,e,i){var n=i(4),r=i(1);i(149),i(150),r.registerVisual(n.curry(i(109),"scatter","circle",null)),r.registerLayout(n.curry(i(110),"scatter")),i(112);},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.scatter",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=n(t.data,this,e);return i;},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{normal:{opacity:.8}}}});},function(t,e,i){var n=i(104),r=i(151);i(1).extendChartView({type:"scatter",init:function init(){this._normalSymbolDraw=new n(),this._largeSymbolDraw=new r();},render:function render(t,e,i){var n=t.getData(),r=this._largeSymbolDraw,o=this._normalSymbolDraw,a=this.group,s=t.get("large")&&n.count()>t.get("largeThreshold")?r:o;this._symbolDraw=s,s.updateData(n),a.add(s.group),a.remove(s===r?o.group:r.group);},updateLayout:function updateLayout(t){this._symbolDraw.updateLayout(t);},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(e,!0);},dispose:function dispose(){}});},function(t,e,i){function n(){this.group=new r.Group(),this._symbolEl=new a({});}var r=i(43),o=i(106),a=r.extendShape({shape:{points:null,sizes:null},symbolProxy:null,buildPath:function buildPath(t,e){for(var i=e.points,n=e.sizes,r=this.symbolProxy,o=r.shape,a=0;a<i.length;a++){var s=i[a],l=n[a];l[0]<4?t.rect(s[0]-l[0]/2,s[1]-l[1]/2,l[0],l[1]):(o.x=s[0]-l[0]/2,o.y=s[1]-l[1]/2,o.width=l[0],o.height=l[1],r.buildPath(t,o,!0));}},findDataIndex:function findDataIndex(t,e){for(var i=this.shape,n=i.points,r=i.sizes,o=n.length-1;o>=0;o--){var a=n[o],s=r[o],l=a[0]-s[0]/2,u=a[1]-s[1]/2;if(t>=l&&e>=u&&t<=l+s[0]&&e<=u+s[1])return o;}return-1;}}),s=n.prototype;s.updateData=function(t){this.group.removeAll();var e=this._symbolEl,i=t.hostModel;e.setShape({points:t.mapArray(t.getItemLayout),sizes:t.mapArray(function(e){var i=t.getItemVisual(e,"symbolSize");return i instanceof Array||(i=[i,i]),i;})}),e.symbolProxy=o.createSymbol(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor,e.useStyle(i.getModel("itemStyle.normal").getItemStyle(["color"]));var n=t.getVisual("color");n&&e.setColor(n),e.seriesIndex=i.seriesIndex,e.on("mousemove",function(t){e.dataIndex=null;var i=e.findDataIndex(t.offsetX,t.offsetY);i>0&&(e.dataIndex=i);}),this.group.add(e);},s.updateLayout=function(t){var e=t.getData();this._symbolEl.setShape({points:e.mapArray(e.getItemLayout)});},s.remove=function(){this.group.removeAll();},t.exports=n;},function(t,e,i){var n=i(4),r=i(1);i(153),i(158),i(159),r.registerVisual(n.curry(i(144),"radar")),r.registerVisual(n.curry(i(109),"radar","circle",null)),r.registerLayout(i(160)),r.registerProcessor(n.curry(i(147),"radar")),r.registerPreprocessor(i(161));},function(t,e,i){i(154),i(156),i(157);},function(t,e,i){function n(t,e,i){this._model=t,this.dimensions=[],this._indicatorAxes=r.map(t.getIndicatorModels(),function(t,e){var i="indicator_"+e,n=new o(i,new a());return n.name=t.get("name"),n.model=t,t.axis=n,this.dimensions.push(i),n;},this),this.resize(t,i),this.cx,this.cy,this.r,this.startAngle;}var r=i(4),o=i(155),a=i(117),s=i(7),l=i(114);n.prototype.getIndicatorAxes=function(){return this._indicatorAxes;},n.prototype.dataToPoint=function(t,e){var i=this._indicatorAxes[e];return this.coordToPoint(i.dataToCoord(t),e);},n.prototype.coordToPoint=function(t,e){var i=this._indicatorAxes[e],n=i.angle,r=this.cx+t*Math.cos(n),o=this.cy-t*Math.sin(n);return[r,o];},n.prototype.pointToData=function(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=Math.sqrt(e*e+i*i);e/=n,i/=n;for(var r,o=Math.atan2(-i,e),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],h=Math.abs(o-u.angle);a>h&&(r=u,s=l,a=h);}return[s,+(r&&r.coodToData(n))];},n.prototype.resize=function(t,e){var i=t.get("center"),n=e.getWidth(),o=e.getHeight(),a=Math.min(n,o)/2;this.cx=s.parsePercent(i[0],n),this.cy=s.parsePercent(i[1],o),this.startAngle=t.get("startAngle")*Math.PI/180,this.r=s.parsePercent(t.get("radius"),a),r.each(this._indicatorAxes,function(t,e){t.setExtent(0,this.r);var i=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;i=Math.atan2(Math.sin(i),Math.cos(i)),t.angle=i;},this);},n.prototype.update=function(t,e){function i(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),i=t/e;return 2===i?i=5:i*=2,i*e;}var n=this._indicatorAxes,o=this._model;r.each(n,function(t){t.scale.setExtent(1/0,-(1/0));}),t.eachSeriesByType("radar",function(e,i){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===o){var a=e.getData();r.each(n,function(t){t.scale.unionExtent(a.getDataExtent(t.dim));});}},this);var a=o.get("splitNumber");r.each(n,function(t,e){var n=l.getScaleExtent(t,t.model);l.niceScaleExtent(t,t.model);var r=t.model,o=t.scale,u=r.get("min"),h=r.get("max"),c=o.getInterval();if(null!=u&&null!=h)o.setInterval((h-u)/a);else if(null!=u){var d;do{d=u+c*a,o.setExtent(+u,d),o.setInterval(c),c=i(c);}while(d<n[1]&&isFinite(d)&&isFinite(n[1]));}else if(null!=h){var f;do{f=h-c*a,o.setExtent(f,+h),o.setInterval(c),c=i(c);}while(f>n[0]&&isFinite(f)&&isFinite(n[0]));}else{var p=o.getTicks().length-1;p>a&&(c=i(c));var g=Math.round((n[0]+n[1])/2/c)*c,m=Math.round(a/2);o.setExtent(s.round(g-m*c),s.round(g+(a-m)*c)),o.setInterval(c);}});},n.dimensions=[],n.create=function(t,e){var i=[];return t.eachComponent("radar",function(r){var o=new n(r,t,e);i.push(o),r.coordinateSystem=o;}),t.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0]);}),i;},i(26).register("radar",n),t.exports=n;},function(t,e,i){function n(t,e,i){o.call(this,t,e,i),this.type="value",this.angle=0,this.name="",this.model;}var r=i(4),o=i(123);r.inherits(n,o),t.exports=n;},function(t,e,i){function n(t,e){return s.defaults({show:e},t);}var r=i(128),o=r.valueAxis,a=i(12),s=i(4),l=i(129),u=i(1).extendComponentModel({type:"radar",optionUpdated:function optionUpdated(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),i=this.get("scale"),n=this.get("axisLine"),r=this.get("axisTick"),o=this.get("axisLabel"),u=this.get("name.textStyle"),h=this.get("name.show"),c=this.get("name.formatter"),d=this.get("nameGap"),f=this.get("triggerEvent"),p=s.map(this.get("indicator")||[],function(p){null!=p.max&&p.max>0&&!p.min?p.min=0:null!=p.min&&p.min<0&&!p.max&&(p.max=0),p=s.merge(s.clone(p),{boundaryGap:t,splitNumber:e,scale:i,axisLine:n,axisTick:r,axisLabel:o,name:p.text,nameLocation:"end",nameGap:d,nameTextStyle:u,triggerEvent:f},!1),h||(p.name=""),"string"==typeof c?p.name=c.replace("{value}",p.name):"function"==typeof c&&(p.name=c(p.name,p));var g=s.extend(new a(p,null,this.ecModel),l);return g.mainType="radar",g.componentIndex=this.componentIndex,g;},this);this.getIndicatorModels=function(){return p;};},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:s.merge({lineStyle:{color:"#bbb"}},o.axisLine),axisLabel:n(o.axisLabel,!1),axisTick:n(o.axisTick,!1),splitLine:n(o.splitLine,!0),splitArea:n(o.splitArea,!0),indicator:[]}});t.exports=u;},function(t,e,i){var n=i(133),r=i(4),o=i(43),a=["axisLine","axisLabel","axisTick","axisName"];t.exports=i(1).extendComponentView({type:"radar",render:function render(t,e,i){var n=this.group;n.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t);},_buildAxes:function _buildAxes(t){var e=t.coordinateSystem,i=e.getIndicatorAxes(),o=r.map(i,function(t){var i=new n(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return i;});r.each(o,function(t){r.each(a,t.add,t),this.group.add(t.getGroup());},this);},_buildSplitLineAndArea:function _buildSplitLineAndArea(t){function e(t,e,i){var n=i%e.length;return t[n]=t[n]||[],n;}var i=t.coordinateSystem,n=t.get("splitNumber"),a=i.getIndicatorAxes();if(a.length){var s=t.get("shape"),l=t.getModel("splitLine"),u=t.getModel("splitArea"),h=l.getModel("lineStyle"),c=u.getModel("areaStyle"),d=l.get("show"),f=u.get("show"),p=h.get("color"),g=c.get("color");p=r.isArray(p)?p:[p],g=r.isArray(g)?g:[g];var m=[],v=[];if("circle"===s)for(var y=a[0].getTicksCoords(),x=i.cx,_=i.cy,b=0;b<y.length;b++){if(d){var w=e(m,p,b);m[w].push(new o.Circle({shape:{cx:x,cy:_,r:y[b]}}));}if(f&&b<y.length-1){var w=e(v,g,b);v[w].push(new o.Ring({shape:{cx:x,cy:_,r0:y[b],r:y[b+1]}}));}}else for(var S=r.map(a,function(t,e){var n=t.getTicksCoords();return r.map(n,function(t){return i.coordToPoint(t,e);});}),M=[],b=0;n>=b;b++){for(var I=[],T=0;T<a.length;T++){I.push(S[T][b]);}if(I[0]?I.push(I[0].slice()):console.error("Can't draw value axis "+b),d){var w=e(m,p,b);m[w].push(new o.Polyline({shape:{points:I}}));}if(f&&M){var w=e(v,g,b-1);v[w].push(new o.Polygon({shape:{points:I.concat(M)}}));}M=I.slice().reverse();}var A=h.getLineStyle(),L=c.getAreaStyle();r.each(v,function(t,e){this.group.add(o.mergePath(t,{style:r.defaults({stroke:"none",fill:g[e%g.length]},L),silent:!0}));},this),r.each(m,function(t,e){this.group.add(o.mergePath(t,{style:r.defaults({fill:"none",stroke:p[e%p.length]},A),silent:!0}));},this);}}});},function(t,e,i){"use strict";var n=i(28),r=i(97),o=i(102),a=i(4),s=n.extend({type:"series.radar",dependencies:["radar"],init:function init(t){s.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;};},getInitialData:function getInitialData(t,e){var i=t.data||[],n=o([],i,[],"indicator_"),a=new r(n,this);return a.initData(i),a;},formatTooltip:function formatTooltip(t){var e=this.getRawValue(t),i=this.coordinateSystem,n=i.getIndicatorAxes();return(""==this._data.getName(t)?this.name:this._data.getName(t))+"<br/>"+a.map(n,function(t,i){return t.name+" : "+e[i];}).join("<br />");},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{normal:{width:2,type:"solid"}},label:{normal:{position:"top"}},symbol:"emptyCircle",symbolSize:4}});t.exports=s;},function(t,e,i){function n(t){return o.isArray(t)||(t=[+t,+t]),t;}var r=i(43),o=i(4),a=i(106);t.exports=i(1).extendChartView({type:"radar",render:function render(t,e,i){function s(t,e){var i=t.getItemVisual(e,"symbol")||"circle",r=t.getItemVisual(e,"color");if("none"!==i){var o=a.createSymbol(i,-.5,-.5,1,1,r);return o.attr({style:{strokeNoScale:!0},z2:100,scale:n(t.getItemVisual(e,"symbolSize"))}),o;}}function l(e,i,n,o,a,l){n.removeAll();for(var u=0;u<i.length-1;u++){var h=s(o,a);h&&(h.__dimIdx=u,e[u]?(h.attr("position",e[u]),r[l?"initProps":"updateProps"](h,{position:i[u]},t,a)):h.attr("position",i[u]),n.add(h));}}function u(t){return o.map(t,function(t){return[h.cx,h.cy];});}var h=t.coordinateSystem,c=this.group,d=t.getData(),f=this._data;d.diff(f).add(function(e){var i=d.getItemLayout(e);if(i){var n=new r.Polygon(),o=new r.Polyline(),a={shape:{points:i}};n.shape.points=u(i),o.shape.points=u(i),r.initProps(n,a,t,e),r.initProps(o,a,t,e);var s=new r.Group(),h=new r.Group();s.add(o),s.add(n),s.add(h),l(o.shape.points,i,h,d,e,!0),d.setItemGraphicEl(e,s);}}).update(function(e,i){var n=f.getItemGraphicEl(i),o=n.childAt(0),a=n.childAt(1),s=n.childAt(2),u={shape:{points:d.getItemLayout(e)}};u.shape.points&&(l(o.shape.points,u.shape.points,s,d,e,!1),r.updateProps(o,u,t),r.updateProps(a,u,t),d.setItemGraphicEl(e,n));}).remove(function(t){c.remove(f.getItemGraphicEl(t));}).execute(),d.eachItemGraphicEl(function(e,i){function n(){u.attr("ignore",v);}function a(){u.attr("ignore",m);}var s=d.getItemModel(i),l=e.childAt(0),u=e.childAt(1),h=e.childAt(2),f=d.getItemVisual(i,"color");c.add(e),l.useStyle(o.defaults(s.getModel("lineStyle.normal").getLineStyle(),{fill:"none",stroke:f})),l.hoverStyle=s.getModel("lineStyle.emphasis").getLineStyle();var p=s.getModel("areaStyle.normal"),g=s.getModel("areaStyle.emphasis"),m=p.isEmpty()&&p.parentModel.isEmpty(),v=g.isEmpty()&&g.parentModel.isEmpty();v=v&&m,u.ignore=m,u.useStyle(o.defaults(p.getAreaStyle(),{fill:f,opacity:.7})),u.hoverStyle=g.getAreaStyle();var y=s.getModel("itemStyle.normal").getItemStyle(["color"]),x=s.getModel("itemStyle.emphasis").getItemStyle(),_=s.getModel("label.normal"),b=s.getModel("label.emphasis");h.eachChild(function(e){e.setStyle(y),e.hoverStyle=o.clone(x);var n=d.get(d.dimensions[e.__dimIdx],i);r.setText(e.style,_,f),e.setStyle({text:_.get("show")?o.retrieve(t.getFormattedLabel(i,"normal",null,e.__dimIdx),n):""}),r.setText(e.hoverStyle,b,f),e.hoverStyle.text=b.get("show")?o.retrieve(t.getFormattedLabel(i,"emphasis",null,e.__dimIdx),n):"";}),e.off("mouseover").off("mouseout").off("normal").off("emphasis"),e.on("emphasis",n).on("mouseover",n).on("normal",a).on("mouseout",a),r.setHoverStyle(e);}),this._data=d;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});},function(t,e){t.exports=function(t){t.eachSeriesByType("radar",function(t){function e(t,e){n[e]=n[e]||[],n[e][o]=r.dataToPoint(t,o);}var i=t.getData(),n=[],r=t.coordinateSystem;if(r){for(var o=0;o<r.getIndicatorAxes().length;o++){var a=i.dimensions[o];i.each(a,e);}i.each(function(t){n[t][0]&&n[t].push(n[t][0].slice()),i.setItemLayout(t,n[t]);});}});};},function(t,e,i){var n=i(4);t.exports=function(t){var e=t.polar;if(e){n.isArray(e)||(e=[e]);var i=[];n.each(e,function(e,r){e.indicator?(e.type&&!e.shape&&(e.shape=e.type),t.radar=t.radar||[],n.isArray(t.radar)||(t.radar=[t.radar]),t.radar.push(e)):i.push(e);}),t.polar=i;}n.each(t.series,function(t){"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex);});};},function(t,e,i){var n=i(1),r=n.PRIORITY;i(163),i(173),i(177),i(164),n.registerLayout(i(179)),n.registerVisual(i(180)),n.registerProcessor(r.PROCESSOR.STATISTIC,i(181)),n.registerPreprocessor(i(182)),i(143)("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);},function(t,e,i){var n=i(97),r=i(28),o=i(4),a=i(102),s=i(6),l=s.encodeHTML,u=s.addCommas,h=i(141),c=i(164),d=r.extend({type:"series.map",layoutMode:"box",needsDrawMap:!1,seriesGroup:[],init:function init(t){t=this._fillOption(t,t.map),this.option=t,d.superApply(this,"init",arguments),this.updateSelectedMap(t.data);},getInitialData:function getInitialData(t){var e=a(["value"],t.data||[]),i=new n(e,this);return i.initData(t.data),i;},mergeOption:function mergeOption(t){t.data&&(t=this._fillOption(t,this.option.map)),d.superCall(this,"mergeOption",t),this.updateSelectedMap(this.option.data);},_fillOption:function _fillOption(t,e){return t=o.extend({},t),t.data=c.getFilledRegions(t.data,e),t;},getRawValue:function getRawValue(t){return this._data.get("value",t);},getRegionModel:function getRegionModel(t){var e=this.getData();return e.getItemModel(e.indexOfName(t));},formatTooltip:function formatTooltip(t){for(var e=this.getData(),i=u(this.getRawValue(t)),n=e.getName(t),r=this.seriesGroup,o=[],a=0;a<r.length;a++){var s=r[a].originalData.indexOfName(n);isNaN(r[a].originalData.get("value",s))||o.push(l(r[a].name));}return o.join(", ")+"<br />"+n+" : "+i;},getTooltipPosition:function getTooltipPosition(t){if(null!=t){var e=this.getData().getName(t),i=this.coordinateSystem,n=i.getRegion(e);return n&&i.dataToPoint(n.center);}},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"china",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,textStyle:{color:"#000"}},emphasis:{show:!0,textStyle:{color:"rgb(100,0,0)"}}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{areaColor:"rgba(255,215,0,0.8)"}}}});o.mixin(d,h),t.exports=d;},function(t,e,i){function n(t,e){var i,n=this.getBoundingRect(),r=t.get("layoutCenter"),o=t.get("layoutSize"),s=e.getWidth(),u=e.getHeight(),h=t.get("aspectScale")||.75,c=n.width/n.height*h,d=!1;r&&o&&(r=[l.parsePercent(r[0],s),l.parsePercent(r[1],u)],o=l.parsePercent(o,Math.min(s,u)),isNaN(r[0])||isNaN(r[1])||isNaN(o)?console.warn("Given layoutCenter or layoutSize data are invalid. Use left/top/width/height instead."):d=!0);var f;if(d){var f={};c>1?(f.width=o,f.height=o/c):(f.height=o,f.width=o*c),f.y=r[1]-f.height/2,f.x=r[0]-f.width/2;}else i=t.getBoxLayoutParams(),i.aspect=c,f=a.getLayoutRect(i,{width:s,height:u});this.setViewRect(f.x,f.y,f.width,f.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"));}function r(t,e){s.each(e.get("geoCoord"),function(e,i){t.addGeoCoord(i,e);});}var o=i(165),a=i(21),s=i(4),l=i(7),u={},h=function h(t){console.error("Map "+t+" not exists. You can download map file on http://echarts.baidu.com/download-map.html");},c={dimensions:o.prototype.dimensions,create:function create(t,e){var i=[];t.eachComponent("geo",function(t,a){var s=t.get("map"),l=u[s];l||h(s);var c=new o(s+a,s,l&&l.geoJson,l&&l.specialAreas,t.get("nameMap"));c.zoomLimit=t.get("scaleLimit"),i.push(c),r(c,t),t.coordinateSystem=c,c.model=t,c.resize=n,c.resize(t,e);}),t.eachSeries(function(t){var e=t.get("coordinateSystem");if("geo"===e){var n=t.get("geoIndex")||0;t.coordinateSystem=i[n];}});var a={};return t.eachSeriesByType("map",function(t){var e=t.get("map");a[e]=a[e]||[],a[e].push(t);}),s.each(a,function(t,a){var l=u[a];l||h(t[0].get("map"));var c=s.map(t,function(t){return t.get("nameMap");}),d=new o(a,a,l&&l.geoJson,l&&l.specialAreas,s.mergeAll(c));d.zoomLimit=s.retrieve.apply(null,s.map(t,function(t){return t.get("scaleLimit");})),i.push(d),d.resize=n,d.resize(t[0],e),s.each(t,function(t){t.coordinateSystem=d,r(d,t);});}),i;},registerMap:function registerMap(t,e,i){e.geoJson&&!e.features&&(i=e.specialAreas,e=e.geoJson),"string"==typeof e&&(e="undefined"!=typeof JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")()),u[t]={geoJson:e,specialAreas:i};},getMap:function getMap(t){return u[t];},getFilledRegions:function getFilledRegions(t,e){var i=(t||[]).slice(),n=c.getMap(e),r=n&&n.geoJson;if(!r)return h(e),t;for(var o={},a=r.features,s=0;s<i.length;s++){o[i[s].name]=i[s];}for(var s=0;s<a.length;s++){var l=a[s].properties.name;o[l]||i.push({name:l});}return i;}},d=i(1);d.registerMap=c.registerMap,d.getMap=c.getMap,d.loadMap=function(){},d.registerCoordinateSystem("geo",c),t.exports=c;},function(t,e,i){function n(t,e,i,n,r){l.call(this,t),this.map=e,this._nameCoordMap={},this.loadGeoJson(i,n,r);}function r(t,e,i,n){var r=i.geoModel,o=i.seriesModel,a=r?r.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return a===this?a[t](n):null;}var o=i(166),a=i(4),s=i(9),l=i(169),u=[i(170),i(171),i(172)];n.prototype={constructor:n,type:"geo",dimensions:["lng","lat"],containCoord:function containCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return!0;}return!1;},loadGeoJson:function loadGeoJson(t,e,i){try{this.regions=t?o(t):[];}catch(n){throw"Invalid geoJson format\n"+n;}e=e||{},i=i||{};for(var r=this.regions,s={},l=0;l<r.length;l++){var h=r[l].name;h=i[h]||h,r[l].name=h,s[h]=r[l],this.addGeoCoord(h,r[l].center);var c=e[h];c&&r[l].transformTo(c.left,c.top,c.width,c.height);}this._regionsMap=s,this._rect=null,a.each(u,function(t){t(this);},this);},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect();r=r.clone(),r.y=-r.y-r.height;var o=this._viewTransform;o.transform=r.calculateTransform(new s(t,e,i,n)),o.decomposeTransform();var a=o.scale;a[1]=-a[1],o.updateTransform(),this._updateTransform();},getRegion:function getRegion(t){return this._regionsMap[t];},getRegionByCoord:function getRegionByCoord(t){for(var e=this.regions,i=0;i<e.length;i++){if(e[i].contain(t))return e[i];}},addGeoCoord:function addGeoCoord(t,e){this._nameCoordMap[t]=e;},getGeoCoord:function getGeoCoord(t){return this._nameCoordMap[t];},getBoundingRect:function getBoundingRect(){if(this._rect)return this._rect;for(var t,e=this.regions,i=0;i<e.length;i++){var n=e[i].getBoundingRect();t=t||n.clone(),t.union(n);}return this._rect=t||new s(0,0,0,0);},dataToPoints:function dataToPoints(t){var e=[];return t.mapArray(["lng","lat"],function(t,i){return e[0]=t,e[1]=i,this.dataToPoint(e);},this);},dataToPoint:function dataToPoint(t){return"string"==typeof t&&(t=this.getGeoCoord(t)),t?l.prototype.dataToPoint.call(this,t):void 0;},convertToPixel:a.curry(r,"dataToPoint"),convertFromPixel:a.curry(r,"pointToData")},a.mixin(n,l),t.exports=n;},function(t,e,i){function n(t){if(!t.UTF8Encoding)return t;for(var e=t.features,i=0;i<e.length;i++){for(var n=e[i],o=n.geometry,a=o.coordinates,s=o.encodeOffsets,l=0;l<a.length;l++){var u=a[l];if("Polygon"===o.type)a[l]=r(u,s[l]);else if("MultiPolygon"===o.type)for(var h=0;h<u.length;h++){var c=u[h];u[h]=r(c,s[l][h]);}}}return t.UTF8Encoding=!1,t;}function r(t,e){for(var i=[],n=e[0],r=e[1],o=0;o<t.length;o+=2){var a=t.charCodeAt(o)-64,s=t.charCodeAt(o+1)-64;a=a>>1^-(1&a),s=s>>1^-(1&s),a+=n,s+=r,n=a,r=s,i.push([a/1024,s/1024]);}return i;}function o(t){for(var e=[],i=0;i<t.length;i++){for(var n=0;n<t[i].length;n++){e.push(t[i][n]);}}return e;}var a=i(4),s=i(167);t.exports=function(t){return n(t),a.map(a.filter(t.features,function(t){return t.geometry&&t.properties;}),function(t){var e=t.properties,i=t.geometry,n=i.coordinates;return"MultiPolygon"===i.type&&(n=o(n)),new s(e.name,n,e.cp);});};},function(t,e,i){function n(t,e,i){if(this.name=t,this.contours=e,i)i=[i[0],i[1]];else{var n=this.getBoundingRect();i=[n.x+n.width/2,n.y+n.height/2];}this.center=i;}var r=i(168),o=i(9),a=i(51),s=i(10);n.prototype={constructor:n,getBoundingRect:function getBoundingRect(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,i=[e,e],n=[-e,-e],r=[],l=[],u=this.contours,h=0;h<u.length;h++){a.fromPoints(u[h],r,l),s.min(i,i,r),s.max(n,n,l);}return 0===h&&(i[0]=i[1]=n[0]=n[1]=0),this._rect=new o(i[0],i[1],n[0]-i[0],n[1]-i[1]);},contain:function contain(t){var e=this.getBoundingRect(),i=this.contours;if(e.contain(t[0],t[1]))for(var n=0,o=i.length;o>n;n++){if(r.contain(i[n],t[0],t[1]))return!0;}return!1;},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect(),a=r.width/r.height;i?n||(n=i/a):i=a*n;for(var l=new o(t,e,i,n),u=r.calculateTransform(l),h=this.contours,c=0;c<h.length;c++){for(var d=0;d<h[c].length;d++){s.applyTransform(h[c][d],h[c][d],u);}}r=this._rect,r.copy(l),this.center=[r.x+r.width/2,r.y+r.height/2];}},t.exports=n;},function(t,e,i){function n(t,e){return Math.abs(t-e)<a;}function r(t,e,i){var r=0,a=t[0];if(!a)return!1;for(var s=1;s<t.length;s++){var l=t[s];r+=o(a[0],a[1],l[0],l[1],e,i),a=l;}var u=t[0];return n(a[0],u[0])&&n(a[1],u[1])||(r+=o(a[0],a[1],u[0],u[1],e,i)),0!==r;}var o=i(58),a=1e-8;t.exports={contain:r};},function(t,e,i){function n(){l.call(this);}function r(t){this.name=t,this.zoomLimit,l.call(this),this._roamTransform=new n(),this._viewTransform=new n(),this._center,this._zoom;}function o(t,e,i,n){var r=i.seriesModel,o=r?r.coordinateSystem:null;return o===this?o[t](n):null;}var a=i(10),s=i(11),l=i(34),u=i(4),h=i(9),c=a.applyTransform;u.mixin(n,l),r.prototype={constructor:r,type:"view",dimensions:["x","y"],setBoundingRect:function setBoundingRect(t,e,i,n){return this._rect=new h(t,e,i,n),this._rect;},getBoundingRect:function getBoundingRect(){return this._rect;},setViewRect:function setViewRect(t,e,i,n){this.transformTo(t,e,i,n),this._viewRect=new h(t,e,i,n);},transformTo:function transformTo(t,e,i,n){var r=this.getBoundingRect(),o=this._viewTransform;o.transform=r.calculateTransform(new h(t,e,i,n)),o.decomposeTransform(),this._updateTransform();},setCenter:function setCenter(t){t&&(this._center=t,this._updateCenterAndZoom());},setZoom:function setZoom(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom();},getDefaultCenter:function getDefaultCenter(){var t=this.getBoundingRect(),e=t.x+t.width/2,i=t.y+t.height/2;return[e,i];},getCenter:function getCenter(){return this._center||this.getDefaultCenter();},getZoom:function getZoom(){return this._zoom||1;},getRoamTransform:function getRoamTransform(){return this._roamTransform;},_updateCenterAndZoom:function _updateCenterAndZoom(){var t=this._viewTransform.getLocalTransform(),e=this._roamTransform,i=this.getDefaultCenter(),n=this.getCenter(),r=this.getZoom();n=a.applyTransform([],n,t),i=a.applyTransform([],i,t),e.origin=n,e.position=[i[0]-n[0],i[1]-n[1]],e.scale=[r,r],this._updateTransform();},_updateTransform:function _updateTransform(){var t=this._roamTransform,e=this._viewTransform;e.parent=t,t.updateTransform(),e.updateTransform(),e.transform&&s.copy(this.transform||(this.transform=[]),e.transform),this.transform?(this.invTransform=this.invTransform||[],s.invert(this.invTransform,this.transform)):this.invTransform=null,this.decomposeTransform();},getViewRect:function getViewRect(){return this._viewRect;},getViewRectAfterRoam:function getViewRectAfterRoam(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t;},dataToPoint:function dataToPoint(t){var e=this.transform;return e?c([],t,e):[t[0],t[1]];},pointToData:function pointToData(t){var e=this.invTransform;return e?c([],t,e):[t[0],t[1]];},convertToPixel:u.curry(o,"dataToPoint"),convertFromPixel:u.curry(o,"pointToData"),containPoint:function containPoint(t){return this.getViewRect().contain(t[0],t[1]);}},u.mixin(r,l),t.exports=r;},function(t,e,i){for(var n=i(167),r=[126,25],o=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],a=0;a<o.length;a++){for(var s=0;s<o[a].length;s++){o[a][s][0]/=10.5,o[a][s][1]/=-14,o[a][s][0]+=r[0],o[a][s][1]+=r[1];}}t.exports=function(t){"china"===t.map&&t.regions.push(new n("",o,r));};},function(t,e,i){var n=i(4),r={"":[32,80],"":[0,-10],"":[10,5],"":[-10,10],"":[5,5]};t.exports=function(t){n.each(t.regions,function(t){var e=r[t.name];if(e){var i=t.center;i[0]+=e[0]/10.5,i[1]+=-e[1]/14;}});};},function(t,e,i){var n=i(4),r={Russia:[100,60],"United States of America":[-99,38]};t.exports=function(t){n.each(t.regions,function(t){var e=r[t.name];if(e){var i=t.center;i[0]=e[0],i[1]=e[1];}});};},function(t,e,i){var n=i(43),r=i(174);i(1).extendChartView({type:"map",render:function render(t,e,i,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var o=this.group;if(o.removeAll(),n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===t.id){var a=this._mapDraw;a&&o.add(a.group);}else if(t.needsDrawMap){var a=this._mapDraw||new r(i,!0);o.add(a.group),a.draw(t,e,i,this,n),this._mapDraw=a;}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,i);}},remove:function remove(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll();},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;},_renderSymbols:function _renderSymbols(t,e,i){var r=t.originalData,o=this.group;r.each("value",function(e,i){if(!isNaN(e)){var a=r.getItemLayout(i);if(a&&a.point){var s=a.point,l=a.offset,u=new n.Circle({style:{fill:t.getData().getVisual("color")},shape:{cx:s[0]+9*l,cy:s[1],r:3},silent:!0,z2:10});if(!l){var h=t.mainSeries.getData(),c=r.getName(i),d=c,f=h.indexOfName(c),p=r.getItemModel(i),g=p.getModel("label.normal"),m=p.getModel("label.emphasis"),v=g.getModel("textStyle"),y=m.getModel("textStyle"),x=h.getItemGraphicEl(f);u.setStyle({textPosition:"bottom"});var _=function _(){u.setStyle({text:m.get("show")?d:"",textFill:y.getTextColor(),textFont:y.getFont()});},b=function b(){u.setStyle({text:g.get("show")?d:"",textFill:v.getTextColor(),textFont:v.getFont()});};x.on("mouseover",_).on("mouseout",b).on("emphasis",_).on("normal",b),b();}o.add(u);}}});}});},function(t,e,i){function n(t,e){var i=t.getItemStyle(),n=t.get("areaColor");return n&&(i.fill=n),i;}function r(t,e,i,n){e.off("click"),t.get("selectedMode")&&e.on("click",function(r){for(var a=r.target;!a.__region;){a=a.parent;}if(a){var s=a.__region,l={type:("geo"===t.mainType?"geo":"map")+"ToggleSelect",name:s.name,from:n.uid};l[t.mainType+"Id"]=t.id,i.dispatchAction(l),o(t,e);}});}function o(t,e){e.eachChild(function(e){e.__region&&e.trigger(t.isSelected(e.__region.name)?"emphasis":"normal");});}function a(t,e){var i=new l.Group();this._controller=new s(t.getZr(),e?i:null,null),this.group=i,this._updateGroup=e;}var s=i(175),l=i(43),u=i(4);a.prototype={constructor:a,draw:function draw(t,e,i,a,s){var h=t.getData&&t.getData(),c=t.coordinateSystem,d=this.group,f=c.scale,p={position:c.position,scale:f};!d.childAt(0)||s?d.attr(p):l.updateProps(d,p,t),d.removeAll();var g=["itemStyle","normal"],m=["itemStyle","emphasis"],v=["label","normal"],y=["label","emphasis"];u.each(c.regions,function(e){var i=new l.Group(),r=new l.CompoundPath({shape:{paths:[]}});i.add(r);var o,a=t.getRegionModel(e.name)||t,s=a.getModel(g),c=a.getModel(m),p=n(s,f),x=n(c,f),_=a.getModel(v),b=a.getModel(y);if(h){o=h.indexOfName(e.name);var w=h.getItemVisual(o,"color",!0);w&&(p.fill=w);}var S=_.getModel("textStyle"),M=b.getModel("textStyle");u.each(e.contours,function(t){var e=new l.Polygon({shape:{points:t}});r.shape.paths.push(e);}),r.setStyle(p),r.style.strokeNoScale=!0,r.culling=!0;var I=_.get("show"),T=b.get("show"),A=h&&isNaN(h.get("value",o)),L=h&&h.getItemLayout(o);if(!h||A&&(I||T)||L&&L.showLabel){var C=h?o:e.name,D=t.getFormattedLabel(C,"normal"),P=t.getFormattedLabel(C,"emphasis"),k=new l.Text({style:{text:I?D||e.name:"",fill:S.getTextColor(),textFont:S.getFont(),textAlign:"center",textVerticalAlign:"middle"},hoverStyle:{text:T?P||e.name:"",fill:M.getTextColor(),textFont:M.getFont()},position:e.center.slice(),scale:[1/f[0],1/f[1]],z2:10,silent:!0});i.add(k);}if(h)h.setItemGraphicEl(o,i);else{var a=t.getRegionModel(e.name);r.eventData={componentType:"geo",geoIndex:t.componentIndex,name:e.name,region:a&&a.option||{}};}i.__region=e,l.setHoverStyle(i,x),d.add(i);}),this._updateController(t,e,i),r(t,d,i,a),o(t,d);},remove:function remove(){this.group.removeAll(),this._controller.dispose();},_updateController:function _updateController(t,e,i){function n(){var e={type:"geoRoam",componentType:a};return e[a+"Id"]=t.id,e;}var r=t.coordinateSystem,o=this._controller;o.zoomLimit=t.get("scaleLimit"),o.zoom=r.getZoom(),o.enable(t.get("roam")||!1);var a=t.mainType;o.off("pan").on("pan",function(t,e){i.dispatchAction(u.extend(n(),{dx:t,dy:e}));}),o.off("zoom").on("zoom",function(t,e,r){if(i.dispatchAction(u.extend(n(),{zoom:t,originX:e,originY:r})),this._updateGroup){var o=this.group,a=o.scale;o.traverse(function(t){"text"===t.type&&t.attr("scale",[1/a[0],1/a[1]]);});}},this),o.setContainsPoint(function(t,e){return r.getViewRectAfterRoam().contain(t,e);});}},t.exports=a;},function(t,e,i){function n(t){if(!t.target||!t.target.draggable){var e=t.offsetX,i=t.offsetY;this.containsPoint&&this.containsPoint(e,i)&&(this._x=e,this._y=i,this._dragging=!0);}}function r(t){if(this._dragging&&(d.stop(t.event),"pinch"!==t.gestureEvent)){if(f.isTaken(this._zr,"globalPan"))return;var e=t.offsetX,i=t.offsetY,n=this._x,r=this._y,o=e-n,a=i-r;this._x=e,this._y=i;var s=this.target;if(s){var l=s.position;l[0]+=o,l[1]+=a,s.dirty();}d.stop(t.event),this.trigger("pan",o,a,n,r,e,i);}}function o(t){this._dragging=!1;}function a(t){var e=t.wheelDelta>0?1.1:1/1.1;l.call(this,t,e,t.offsetX,t.offsetY);}function s(t){if(!f.isTaken(this._zr,"globalPan")){var e=t.pinchScale>1?1.1:1/1.1;l.call(this,t,e,t.pinchX,t.pinchY);}}function l(t,e,i,n){if(this.containsPoint&&this.containsPoint(i,n)){d.stop(t.event);var r=this.target,o=this.zoomLimit;if(r){var a=r.position,s=r.scale,l=this.zoom=this.zoom||1;if(l*=e,o){var u=o.min||0,h=o.max||1/0;l=Math.max(Math.min(h,l),u);}var c=l/this.zoom;this.zoom=l,a[0]-=(i-a[0])*(c-1),a[1]-=(n-a[1])*(c-1),s[0]*=c,s[1]*=c,r.dirty();}this.trigger("zoom",e,i,n);}}function u(t,e){this.target=e,this.containsPoint,this.zoomLimit,this.zoom,this._zr=t;var i=c.bind,l=i(n,this),u=i(r,this),d=i(o,this),f=i(a,this),p=i(s,this);h.call(this),this.setContainsPoint=function(t){this.containsPoint=t;},this.enable=function(e){this.disable(),null==e&&(e=!0),(e===!0||"move"===e||"pan"===e)&&(t.on("mousedown",l),t.on("mousemove",u),t.on("mouseup",d)),(e===!0||"scale"===e||"zoom"===e)&&(t.on("mousewheel",f),t.on("pinch",p));},this.disable=function(){t.off("mousedown",l),t.off("mousemove",u),t.off("mouseup",d),t.off("mousewheel",f),t.off("pinch",p);},this.dispose=this.disable,this.isDragging=function(){return this._dragging;},this.isPinching=function(){return this._pinching;};}var h=i(33),c=i(4),d=i(87),f=i(176);c.mixin(u,h),t.exports=u;},function(t,e,i){function n(t){return t[r]||(t[r]={});}var r="\x00_ec_interaction_mutex",o={take:function take(t,e,i){var r=n(t);r[e]=i;},release:function release(t,e,i){var r=n(t),o=r[e];o===i&&(r[e]=null);},isTaken:function isTaken(t,e){return!!n(t)[e];}};i(1).registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),t.exports=o;},function(t,e,i){var n=i(4),r=i(178),o=i(1);o.registerAction({type:"geoRoam",event:"geoRoam",update:"updateLayout"},function(t,e){var i=t.componentType||"series";e.eachComponent({mainType:i,query:t},function(e){var o=e.coordinateSystem;if("geo"===o.type){var a=r.updateCenterAndZoom(o,t,e.get("scaleLimit"));e.setCenter&&e.setCenter(a.center),e.setZoom&&e.setZoom(a.zoom),"series"===i&&n.each(e.seriesGroup,function(t){t.setCenter(a.center),t.setZoom(a.zoom);});}});});},function(t,e){var i={};i.updateCenterAndZoom=function(t,e,i){var n=t.getZoom(),r=t.getCenter(),o=e.zoom,a=t.dataToPoint(r);if(null!=e.dx&&null!=e.dy){a[0]-=e.dx,a[1]-=e.dy;var r=t.pointToData(a);t.setCenter(r);}if(null!=o){if(i){var s=i.min||0,l=i.max||1/0;o=Math.max(Math.min(n*o,l),s)/n;}t.scale[0]*=o,t.scale[1]*=o;var u=t.position,h=(e.originX-u[0])*(o-1),c=(e.originY-u[1])*(o-1);u[0]-=h,u[1]-=c,t.updateTransform();var r=t.pointToData(a);t.setCenter(r),t.setZoom(o*n);}return{center:t.getCenter(),zoom:t.getZoom()};},t.exports=i;},function(t,e,i){var n=i(4);t.exports=function(t){var e={};t.eachSeriesByType("map",function(i){var r=i.get("map");if(!e[r]){var o={};n.each(i.seriesGroup,function(e){var i=e.coordinateSystem,n=e.originalData;e.get("showLegendSymbol")&&t.getComponent("legend")&&n.each("value",function(t,e){var r=n.getName(e),a=i.getRegion(r);if(a&&!isNaN(t)){var s=o[r]||0,l=i.dataToPoint(a.center);o[r]=s+1,n.setItemLayout(e,{point:l,offset:s});}});});var a=i.getData();a.each(function(t){var e=a.getName(t),i=a.getItemLayout(t)||{};i.showLabel=!o[e],a.setItemLayout(t,i);}),e[r]=!0;}});};},function(t,e){t.exports=function(t){t.eachSeriesByType("map",function(t){var e=t.get("color"),i=t.getModel("itemStyle.normal"),n=i.get("areaColor"),r=i.get("color")||e[t.seriesIndex%e.length];t.getData().setVisual({areaColor:n,color:r});});};},function(t,e,i){function n(t,e){for(var i={},n=["value"],r=0;r<t.length;r++){t[r].each(n,function(e,n){var o=t[r].getName(n);i[o]=i[o]||[],isNaN(e)||i[o].push(e);});}return t[0].map(n,function(n,r){for(var o=t[0].getName(r),a=0,s=1/0,l=-(1/0),u=i[o].length,h=0;u>h;h++){s=Math.min(s,i[o][h]),l=Math.max(l,i[o][h]),a+=i[o][h];}var c;return c="min"===e?s:"max"===e?l:"average"===e?a/u:a,0===u?NaN:c;});}var r=i(4);t.exports=function(t){var e={};t.eachSeriesByType("map",function(t){var i=t.get("map");e[i]=e[i]||[],e[i].push(t);}),r.each(e,function(t,e){for(var i=n(r.map(t,function(t){return t.getData();}),t[0].get("mapValueCalculation")),o=0;o<t.length;o++){t[o].originalData=t[o].getData();}for(var o=0;o<t.length;o++){t[o].seriesGroup=t,t[o].needsDrawMap=0===o,t[o].setData(i.cloneShallow()),t[o].mainSeries=t[0];}});};},function(t,e,i){var n=i(4);t.exports=function(t){var e=[];n.each(t.series,function(t){"map"===t.type&&e.push(t);}),n.each(e,function(t){t.map=t.map||t.mapType,n.defaults(t,t.mapLocation);});};},function(t,e,i){var n=i(1);i(184),i(188),i(191),n.registerVisual(i(192)),n.registerLayout(i(194));},function(t,e,i){function n(t,e){var i=0;s.each(t.children,function(t){n(t,e);var r=t.value;s.isArray(r)&&(r=r[0]),i+=r;});var r=t.value;e>=0&&(s.isArray(r)?r=r[0]:t.value=new Array(e)),(null==r||isNaN(r))&&(r=i),0>r&&(r=0),e>=0?t.value[0]=r:t.value=r;}function r(t,e){var i=e.get("color");if(i){t=t||[];var n;if(s.each(t,function(t){var e=new l(t),i=e.get("color");(e.get("itemStyle.normal.color")||i&&"none"!==i)&&(n=!0);}),!n){var r=t[0]||(t[0]={});r.color=i.slice();}return t;}}var o=i(28),a=i(185),s=i(4),l=i(12),u=i(6),h=i(187),c=u.encodeHTML,d=u.addCommas;t.exports=o.extend({type:"series.treemap",dependencies:["grid","polar"],_viewRoot:null,defaultOption:{progressive:0,hoverLayerThreshold:1/0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"",visualDimension:0,zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{normal:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}}},label:{normal:{show:!0,position:"inside",textStyle:{color:"#fff",ellipsis:!0}}},itemStyle:{normal:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{}},color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function getInitialData(t,e){var i=t.data||[],o=t.name;null==o&&(o=t.name);var l={name:o,children:t.data},u=(i[0]||{}).value;n(l,s.isArray(u)?u.length:-1);var h=t.levels||[];return h=t.levels=r(h,e),a.createTree(l,this,h).data;},optionUpdated:function optionUpdated(){this.resetViewRoot();},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=d(s.isArray(i)?i[0]:i),r=e.getName(t);return c(r)+": "+n;},getDataParams:function getDataParams(t){var e=o.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=h.wrapTreePathInfo(i,this),e;},setLayoutInfo:function setLayoutInfo(t){this.layoutInfo=this.layoutInfo||{},s.extend(this.layoutInfo,t);},mapIdToIndex:function mapIdToIndex(t){var e=this._idIndexMap;e||(e=this._idIndexMap={},this._idIndexMapCount=0);var i=e[t];return null==i&&(e[t]=i=this._idIndexMapCount++),i;},getViewRoot:function getViewRoot(){return this._viewRoot;},resetViewRoot:function resetViewRoot(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getData().tree.root;(!t||t!==e&&!e.contains(t))&&(this._viewRoot=e);}});},function(t,e,i){function n(t,e){this.root,this.data,this._nodes=[],this.hostModel=t,this.levelModels=o.map(e||[],function(e){return new a(e,t,t.ecModel);});}function r(t,e){var i=e.children;t.parentNode!==e&&(i.push(t),t.parentNode=e);}var o=i(4),a=i(12),s=i(97),l=i(186),u=i(102),h=function h(t,e){this.name=t||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=e;};h.prototype={constructor:h,isRemoved:function isRemoved(){return this.dataIndex<0;},eachNode:function eachNode(t,e,i){"function"==typeof t&&(i=e,e=t,t=null),t=t||{},o.isString(t)&&(t={order:t});var n,r=t.order||"preorder",a=this[t.attr||"children"];"preorder"===r&&(n=e.call(i,this));for(var s=0;!n&&s<a.length;s++){a[s].eachNode(t,e,i);}"postorder"===r&&e.call(i,this);},updateDepthAndHeight:function updateDepthAndHeight(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height);}this.height=e+1;},getNodeById:function getNodeById(t){if(this.getId()===t)return this;for(var e=0,i=this.children,n=i.length;n>e;e++){var r=i[e].getNodeById(t);if(r)return r;}},contains:function contains(t){if(t===this)return!0;for(var e=0,i=this.children,n=i.length;n>e;e++){var r=i[e].contains(t);if(r)return r;}},getAncestors:function getAncestors(t){for(var e=[],i=t?this:this.parentNode;i;){e.push(i),i=i.parentNode;}return e.reverse(),e;},getValue:function getValue(t){var e=this.hostTree.data;return e.get(e.getDimension(t||"value"),this.dataIndex);},setLayout:function setLayout(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e);},getLayout:function getLayout(){return this.hostTree.data.getItemLayout(this.dataIndex);},getModel:function getModel(t){if(!(this.dataIndex<0)){var e=this.hostTree,i=e.data.getItemModel(this.dataIndex),n=this.getLevelModel();return i.getModel(t,(n||e.hostModel).getModel(t));}},getLevelModel:function getLevelModel(){return(this.hostTree.levelModels||[])[this.depth];},setVisual:function setVisual(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e);},getVisual:function getVisual(t,e){return this.hostTree.data.getItemVisual(this.dataIndex,t,e);},getRawIndex:function getRawIndex(){return this.hostTree.data.getRawIndex(this.dataIndex);},getId:function getId(){return this.hostTree.data.getId(this.dataIndex);}},n.prototype={constructor:n,type:"tree",eachNode:function eachNode(t,e,i){this.root.eachNode(t,e,i);},getNodeByDataIndex:function getNodeByDataIndex(t){var e=this.data.getRawIndex(t);return this._nodes[e];},getNodeByName:function getNodeByName(t){return this.root.getNodeByName(t);},update:function update(){for(var t=this.data,e=this._nodes,i=0,n=e.length;n>i;i++){e[i].dataIndex=-1;}for(var i=0,n=t.count();n>i;i++){e[t.getRawIndex(i)].dataIndex=i;}},clearLayouts:function clearLayouts(){this.data.clearItemLayouts();}},n.createTree=function(t,e,i){function o(t,e){c.push(t);var i=new h(t.name,a);e?r(i,e):a.root=i,a._nodes.push(i);var n=t.children;if(n)for(var s=0;s<n.length;s++){o(n[s],i);}}var a=new n(e,i),c=[];o(t),a.root.updateDepthAndHeight(0);var d=u([{name:"value"}],c),f=new s(d,e);return f.initData(c),l({mainData:f,struct:a,structAttr:"tree"}),a.update(),a;},t.exports=n;},function(t,e,i){function n(t){var e=t.mainData,i=t.datas;i||(i={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,u(e,i,t),d(i,function(i){d(e.TRANSFERABLE_METHODS,function(e){i.wrapMethod(e,c.curry(r,t));});}),e.wrapMethod("cloneShallow",c.curry(a,t)),d(e.CHANGABLE_METHODS,function(i){e.wrapMethod(i,c.curry(o,t));}),c.assert(i[e.dataType]===e);}function r(t,e){if(l(this)){var i=c.extend({},this[f]);i[this.dataType]=e,u(e,i,t);}else h(e,this.dataType,this[p],t);return e;}function o(t,e){return t.struct&&t.struct.update(this),e;}function a(t,e){return d(e[f],function(i,n){i!==e&&h(i.cloneShallow(),n,e,t);}),e;}function s(t){var e=this[p];return null==t||null==e?e:e[f][t];}function l(t){return t[p]===t;}function u(t,e,i){t[f]={},d(e,function(e,n){h(e,n,t,i);});}function h(t,e,i,n){i[f][e]=t,t[p]=i,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=s;}var c=i(4),d=c.each,f="\x00__link_datas",p="\x00__link_mainData";t.exports=n;},function(t,e,i){var n=i(4),r={retrieveTargetInfo:function retrieveTargetInfo(t,e){if(t&&("treemapZoomToNode"===t.type||"treemapRootToNode"===t.type)){var i=e.getData().tree.root,n=t.targetNode;if(n&&i.contains(n))return{node:n};var r=t.targetNodeId;if(null!=r&&(n=i.getNodeById(r)))return{node:n};}},getPathToRoot:function getPathToRoot(t){for(var e=[];t;){t=t.parentNode,t&&e.push(t);}return e.reverse();},aboveViewRoot:function aboveViewRoot(t,e){var i=r.getPathToRoot(t);return n.indexOf(i,e)>=0;},wrapTreePathInfo:function wrapTreePathInfo(t,e){for(var i=[];t;){var n=t.dataIndex;i.push({name:t.name,dataIndex:n,value:e.getRawValue(n)}),t=t.parentNode;}return i.reverse(),i;}};t.exports=r;},function(t,e,i){function n(){return{nodeGroup:[],background:[],content:[]};}function r(t,e,i,n,r,l,u,h,c,d){function f(e){E.dataIndex=u.dataIndex,E.seriesIndex=t.seriesIndex;var i=T.borderWidth,n=Math.max(A-2*i,0),r=Math.max(L-2*i,0);E.culling=!0,E.setShape({x:i,y:i,width:n,height:r});var o=u.getVisual("color",!0);p(E,function(){var t={fill:o},e=u.getModel("itemStyle.emphasis").getItemStyle();g(t,e,o,n,r),E.setStyle(t),s.setHoverStyle(E,e);}),e.add(E);}function p(t,e){C?!t.invisible&&l.push(t):(e(),t.__tmWillVisible||(t.invisible=!1));}function g(e,i,n,r,o){var a=u.getModel(),s=a.get("name");if(T.isLeafRoot){var l=t.get("drillDownIcon",!0);s=l?l+" "+s:s;}y(s,e,a,_,n,r,o),y(s,i,a,b,n,r,o);}function y(t,e,i,n,r,o,a){var l=i.getModel(n),u=l.getModel("textStyle");s.setText(e,l,r),e.textAlign=u.get("align"),e.textVerticalAlign=u.get("baseline");var h=u.getTextRect(t);!l.getShallow("show")||h.height>a?e.text="":h.width>o?e.text=u.get("ellipsis")?u.truncateText(t,o,null,{minChar:2}):"":e.text=t;}function x(t,n,a,s){var l=null!=P&&i[t][P],u=r[t];return l?(i[t][P]=null,w(u,l,t)):C||(l=new n({z:o(a,s)}),l.__tmDepth=a,l.__tmStorageName=t,I(u,l,t)),e[t][D]=l;}function w(t,e,i){var n=t[D]={};n.old="nodeGroup"===i?e.position.slice():a.extend({},e.shape);}function I(t,e,i){var o=t[D]={},a=u.parentNode;if(a&&(!n||"drillDown"===n.direction)){var s=0,l=0,h=r.background[a.getRawIndex()];!n&&h&&h.old&&(s=h.old.width,l=h.old.height),o.old="nodeGroup"===i?[0,l]:{x:s,y:l,width:0,height:0};}o.fadein="nodeGroup"!==i;}if(u){var T=u.getLayout();if(T&&T.isInView){var A=T.width,L=T.height,C=T.invisible,D=u.getRawIndex(),P=h&&h.getRawIndex(),k=x("nodeGroup",m);if(k){if(c.add(k),k.attr("position",[T.x||0,T.y||0]),k.__tmNodeWidth=A,k.__tmNodeHeight=L,T.isAboveViewRoot)return k;var z=x("background",v,d,S);z&&(z.setShape({x:0,y:0,width:A,height:L}),p(z,function(){z.setStyle("fill",u.getVisual("borderColor",!0));}),k.add(z));var O=u.viewChildren;if(!O||!O.length){var E=x("content",v,d,M);E&&f(k);}return k;}}}}function o(t,e){var i=t*w+e;return(i-1)/i;}var a=i(4),s=i(43),l=i(98),u=i(187),h=i(189),c=i(175),d=i(9),f=i(11),p=i(190),g=a.bind,m=s.Group,v=s.Rect,y=a.each,x=3,_=["label","normal"],b=["label","emphasis"],w=10,S=1,M=2;t.exports=i(1).extendChartView({type:"treemap",init:function init(t,e){this._containerGroup,this._storage=n(),this._oldTree,this._breadcrumb,this._controller,this._state="ready",this._mayClick;},render:function render(t,e,i,n){var r=e.findComponents({mainType:"series",subType:"treemap",query:n});if(!(a.indexOf(r,t)<0)){this.seriesModel=t,this.api=i,this.ecModel=e;var o=u.retrieveTargetInfo(n,t),s=n&&n.type,l=t.layoutInfo,h=!this._oldTree,c=this._storage,d="treemapRootToNode"===s&&o&&c?{rootNodeGroup:c.nodeGroup[o.node.getRawIndex()],direction:n.direction}:null,f=this._giveContainerGroup(l),p=this._doRender(f,t,d);h||s&&"treemapZoomToNode"!==s&&"treemapRootToNode"!==s?p.renderFinally():this._doAnimation(f,p,t,d),this._resetController(i),this._renderBreadcrumb(t,i,o);}},_giveContainerGroup:function _giveContainerGroup(t){var e=this._containerGroup;return e||(e=this._containerGroup=new m(),this._initEvents(e),this.group.add(e)),e.attr("position",[t.x,t.y]),e;},_doRender:function _doRender(t,e,i){function o(t,e,i,n,r){function s(t){return t.getId();}function u(a,s){var l=null!=a?t[a]:null,u=null!=s?e[s]:null,h=m(l,u,i,r);h&&o(l&&l.viewChildren||[],u&&u.viewChildren||[],h,n,r+1);}n?(e=t,y(t,function(t,e){!t.isRemoved()&&u(e,e);})):new l(e,t,s,s).add(u).update(u).remove(a.curry(u,null)).execute();}function s(t){var e=n();return t&&y(t,function(t,i){var n=e[i];y(t,function(t){t&&(n.push(t),t.__tmWillDelete=1);});}),e;}function u(){y(v,function(t){y(t,function(t){t.parent&&t.parent.remove(t);});}),y(g,function(t){t.invisible=!0,t.dirty();});}var h=e.getData().tree,c=this._oldTree,d=n(),f=n(),p=this._storage,g=[],m=a.curry(r,e,f,p,i,d,g);o(h.root?[h.root]:[],c&&c.root?[c.root]:[],t,h===c||!c,0);var v=s(p);return this._oldTree=h,this._storage=f,{lastsForAnimation:d,willDeleteEls:v,renderFinally:u};},_doAnimation:function _doAnimation(t,e,i,n){if(i.get("animation")){var r=i.get("animationDurationUpdate"),o=i.get("animationEasing"),s=p.createWrap();y(e.willDeleteEls,function(t,e){y(t,function(t,i){if(!t.invisible){var a,l=t.parent;if(n&&"drillDown"===n.direction)a=l===n.rootNodeGroup?{shape:{x:0,y:0,width:l.__tmNodeWidth,height:l.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var u=0,h=0;l.__tmWillDelete||(u=l.__tmNodeWidth/2,h=l.__tmNodeHeight/2),a="nodeGroup"===e?{position:[u,h],style:{opacity:0}}:{shape:{x:u,y:h,width:0,height:0},style:{opacity:0}};}a&&s.add(t,a,r,o);}});}),y(this._storage,function(t,i){y(t,function(t,n){var l=e.lastsForAnimation[i][n],u={};l&&("nodeGroup"===i?l.old&&(u.position=t.position.slice(),t.attr("position",l.old)):(l.old&&(u.shape=a.extend({},t.shape),t.setShape(l.old)),l.fadein?(t.setStyle("opacity",0),u.style={opacity:1}):1!==t.style.opacity&&(u.style={opacity:1})),s.add(t,u,r,o));});},this),this._state="animating",s.done(g(function(){this._state="ready",e.renderFinally();},this)).start();}},_resetController:function _resetController(t){var e=this._controller;e||(e=this._controller=new c(t.getZr()),e.enable(this.seriesModel.get("roam")),e.on("pan",g(this._onPan,this)),e.on("zoom",g(this._onZoom,this)));var i=new d(0,0,t.getWidth(),t.getHeight());e.setContainsPoint(function(t,e){return i.contain(t,e);});},_clearController:function _clearController(){var t=this._controller;t&&(t.dispose(),t=null);},_onPan:function _onPan(t,e){if(this._mayClick=!1,"animating"!==this._state&&(Math.abs(t)>x||Math.abs(e)>x)){var i=this.seriesModel.getData().tree.root;if(!i)return;var n=i.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+t,y:n.y+e,width:n.width,height:n.height}});}},_onZoom:function _onZoom(t,e,i){if(this._mayClick=!1,"animating"!==this._state){var n=this.seriesModel.getData().tree.root;if(!n)return;var r=n.getLayout();if(!r)return;var o=new d(r.x,r.y,r.width,r.height),a=this.seriesModel.layoutInfo;e-=a.x,i-=a.y;var s=f.create();f.translate(s,s,[-e,-i]),f.scale(s,s,[t,t]),f.translate(s,s,[e,i]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}});}},_initEvents:function _initEvents(t){function e(t){var e=this.seriesModel.get("nodeClick",!0);if(e){var i=this.findTarget(t.offsetX,t.offsetY);if(i){var n=i.node;if(n.getLayout().isLeafRoot)this._rootToNode(i);else if("zoomToNode"===e)this._zoomToNode(i);else if("link"===e){var r=n.hostTree.data.getItemModel(n.dataIndex),o=r.get("link",!0),a=r.get("target",!0)||"blank";o&&window.open(o,a);}}}}t.on("mousedown",function(t){"ready"===this._state&&(this._mayClick=!0);},this),t.on("mouseup",function(t){this._mayClick&&(this._mayClick=!1,"ready"===this._state&&e.call(this,t));},this);},_renderBreadcrumb:function _renderBreadcrumb(t,e,i){function n(e){"animating"!==this._state&&(u.aboveViewRoot(t.getViewRoot(),e)?this._rootToNode({node:e}):this._zoomToNode({node:e}));}i||(i=null!=t.get("leafDepth",!0)?{node:t.getViewRoot()}:this.findTarget(e.getWidth()/2,e.getHeight()/2),i||(i={node:t.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new h(this.group))).render(t,e,i.node,g(n,this));},remove:function remove(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=n(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove();},dispose:function dispose(){this._clearController();},_zoomToNode:function _zoomToNode(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},_rootToNode:function _rootToNode(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node});},findTarget:function findTarget(t,e){var i,n=this.seriesModel.getViewRoot();return n.eachNode({attr:"viewChildren",order:"preorder"},function(n){var r=this._storage.background[n.getRawIndex()];if(r){var o=r.transformCoordToLocal(t,e),a=r.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;i={node:n,offsetX:o[0],offsetY:o[1]};}},this),i;}});},function(t,e,i){function n(t){this.group=new a.Group(),t.add(this.group);}function r(t,e,i,n,r,o){var a=[[r?t:t-d,e],[t+i,e],[t+i,e+n],[r?t:t-d,e+n]];return!o&&a.splice(2,0,[t+i+d,e+n/2]),!r&&a.push([t,e+n/2]),a;}function o(t,e,i){t.eventData={componentType:"series",componentSubType:"treemap",seriesIndex:e.componentIndex,seriesName:e.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:i&&i.dataIndex,name:i&&i.name},treePathInfo:i&&u.wrapTreePathInfo(i,e)};}var a=i(43),s=i(21),l=i(4),u=i(187),h=8,c=8,d=5;n.prototype={constructor:n,render:function render(t,e,i,n){var r=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),r.get("show")&&i){var a=r.getModel("itemStyle.normal"),l=a.getModel("textStyle"),u={pos:{left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(i,u,l),this._renderContent(t,u,a,l,n),s.positionGroup(o,u.pos,u.box);}},_prepare:function _prepare(t,e,i){for(var n=t;n;n=n.parentNode){var r=n.getModel().get("name"),o=i.getTextRect(r),a=Math.max(o.width+2*h,e.emptyItemWidth);e.totalWidth+=a+c,e.renderList.push({node:n,text:r,width:a});}},_renderContent:function _renderContent(t,e,i,n,u){for(var h=0,d=e.emptyItemWidth,f=t.get("breadcrumb.height"),p=s.getAvailableSize(e.pos,e.box),g=e.totalWidth,m=e.renderList,v=m.length-1;v>=0;v--){var y=m[v],x=y.node,_=y.width,b=y.text;g>p.width&&(g-=_-d,_=d,b="");var w=new a.Polygon({shape:{points:r(h,0,_,f,v===m.length-1,0===v)},style:l.defaults(i.getItemStyle(),{lineJoin:"bevel",text:b,textFill:n.getTextColor(),textFont:n.getFont()}),z:10,onclick:l.curry(u,x)});this.group.add(w),o(w,t,x),h+=_+c;}},remove:function remove(){this.group.removeAll();}},t.exports=n;},function(t,e,i){function n(){var t,e=[],i={};return{add:function add(t,n,o,a,s){return r.isString(a)&&(s=a,a=0),i[t.id]?!1:(i[t.id]=1,e.push({el:t,target:n,time:o,delay:a,easing:s}),!0);},done:function done(e){return t=e,this;},start:function start(){function n(){r--,r||(e.length=0,i={},t&&t());}for(var r=e.length,o=0,a=e.length;a>o;o++){var s=e[o];s.el.animateTo(s.target,s.time,s.delay,s.easing,n);}return this;}};}var r=i(4);t.exports={createWrap:n};},function(t,e,i){for(var n=i(1),r=i(187),o=function o(){},a=["treemapZoomToNode","treemapRender","treemapMove"],s=0;s<a.length;s++){n.registerAction({type:a[s],update:"updateView"},o);}n.registerAction({type:"treemapRootToNode",update:"updateView"},function(t,e){function i(e,i){var n=r.retrieveTargetInfo(t,e);if(n){var o=e.getViewRoot();o&&(t.direction=r.aboveViewRoot(o,n.node)?"rollUp":"drillDown"),e.resetViewRoot(n.node);}}e.eachComponent({mainType:"series",subType:"treemap",query:t},i);});},function(t,e,i){function n(t,e,i,s,u,c){var d=t.getModel(),p=t.getLayout();if(p&&!p.invisible&&p.isInView){var m,v=t.getModel(g),y=i[t.depth],x=r(v,e,y,s),_=v.get("borderColor"),b=v.get("borderColorSaturation");null!=b&&(m=o(x,t),_=a(b,m)),t.setVisual("borderColor",_);var w=t.viewChildren;if(w&&w.length){var S=l(t,d,p,v,x,w);f.each(w,function(t,e){if(t.depth>=u.length||t===u[t.depth]){var r=h(d,x,t,e,S,c);n(t,r,i,s,u,c);}});}else m=o(x,t),t.setVisual("color",m);}}function r(t,e,i,n){var r=f.extend({},e);return f.each(["color","colorAlpha","colorSaturation"],function(o){var a=t.get(o,!0);null==a&&i&&(a=i[o]),null==a&&(a=e[o]),null==a&&(a=n.get(o)),null!=a&&(r[o]=a);}),r;}function o(t){var e=s(t,"color");if(e){var i=s(t,"colorAlpha"),n=s(t,"colorSaturation");return n&&(e=d.modifyHSL(e,null,null,n)),i&&(e=d.modifyAlpha(e,i)),e;}}function a(t,e){return null!=e?d.modifyHSL(e,null,null,t):null;}function s(t,e){var i=t[e];return null!=i&&"none"!==i?i:void 0;}function l(t,e,i,n,r,o){if(o&&o.length){var a=u(e,"color")||null!=r.color&&"none"!==r.color&&(u(e,"colorAlpha")||u(e,"colorSaturation"));if(a){var s=e.get("colorMappingBy"),l={type:a.name,dataExtent:i.dataExtent,visual:a.range};"color"!==l.type||"index"!==s&&"id"!==s?l.mappingMethod="linear":(l.mappingMethod="category",l.loop=!0);var h=new c(l);return h.__drColorMappingBy=s,h;}}}function u(t,e){var i=t.get(e);return p(i)&&i.length?{name:e,range:i}:null;}function h(t,e,i,n,r,o){var a=f.extend({},e);if(r){var s=r.type,l="color"===s&&r.__drColorMappingBy,u="index"===l?n:"id"===l?o.mapIdToIndex(i.getId()):i.getValue(t.get("visualDimension"));a[s]=r.mapValueToVisual(u);}return a;}var c=i(193),d=i(39),f=i(4),p=f.isArray,g="itemStyle.normal";t.exports=function(t,e,i){var r={mainType:"series",subType:"treemap",query:i};t.eachComponent(r,function(t){var e=t.getData().tree,i=e.root,r=t.getModel(g);if(!i.isRemoved()){var o=f.map(e.levelModels,function(t){return t?t.get(g):null;});n(i,{},o,r,t.getViewRoot().getAncestors(),t);}});};},function(t,e,i){function n(t){var e=t.pieceList;t.hasSpecialVisual=!1,p.each(e,function(e,i){e.originIndex=i,null!=e.visual&&(t.hasSpecialVisual=!0);});}function r(t){var e=t.categories,i=t.visual,n=t.categoryMap={};if(v(e,function(t,e){n[t]=e;}),!p.isArray(i)){var r=[];p.isObject(i)?v(i,function(t,e){var i=n[e];r[null!=i?i:x]=t;}):r[x]=i,i=t.visual=r;}for(var o=e.length-1;o>=0;o--){null==i[o]&&(delete n[e[o]],e.pop());}}function o(t,e){var i=t.visual,n=[];p.isObject(i)?v(i,function(t){n.push(t);}):null!=i&&n.push(i);var r={color:1,symbol:1};e||1!==n.length||r.hasOwnProperty(t.type)||(n[1]=n[0]),t.visual=n;}function a(t){return{applyVisual:function applyVisual(e,i,n){e=this.mapValueToVisual(e),n("color",t(i("color"),e));},_doMap:c([0,1])};}function s(t,e){var i=this.option.visual;return i[Math.round(m(e,[0,1],[0,i.length-1],!0))]||{};}function l(t){return function(e,i,n){n(t,this.mapValueToVisual(e));};}function u(t){var e=this.option.visual;return e[this.option.loop&&t!==x?t%e.length:t];}function h(){return this.option.visual[0];}function c(t){return{linear:function linear(e){return m(e,t,this.option.visual,!0);},category:u,piecewise:function piecewise(e,i){var n=d.call(this,i);return null==n&&(n=m(e,t,this.option.visual,!0)),n;},fixed:h};}function d(t){var e=this.option,i=e.pieceList;if(e.hasSpecialVisual){var n=_.findPieceIndex(t,i),r=i[n];if(r&&r.visual)return r.visual[this.type];}}function f(t,e,i){return t?i>=e:i>e;}var p=i(4),g=i(39),m=i(7).linearMap,v=p.each,y=p.isObject,x=-1,_=function _(t){var e=t.mappingMethod,i=t.type,a=this.option=p.clone(t);this.type=i,this.mappingMethod=e,this._normalizeData=w[e];var s=b[i];this.applyVisual=s.applyVisual,this.getColorMapper=s.getColorMapper,this._doMap=s._doMap[e],"piecewise"===e?(o(a),n(a)):"category"===e?a.categories?r(a):o(a,!0):(p.assert("linear"!==e||a.dataExtent),o(a));};_.prototype={constructor:_,mapValueToVisual:function mapValueToVisual(t){var e=this._normalizeData(t);return this._doMap(e,t);},getNormalizer:function getNormalizer(){return p.bind(this._normalizeData,this);}};var b=_.visualHandlers={color:{applyVisual:l("color"),getColorMapper:function getColorMapper(){var t=this.option,e=p.map(t.visual,g.parse);return p.bind("category"===t.mappingMethod?function(t,e){return!e&&(t=this._normalizeData(t)),u(this,t);}:function(t,i,n){var r=!!n;return!i&&(t=this._normalizeData(t)),n=g.fastMapToColor(t,e,n),r?n:p.stringify(n,"rgba");},this);},_doMap:{linear:function linear(t){return g.mapToColor(t,this.option.visual);},category:u,piecewise:function piecewise(t,e){var i=d.call(this,e);return null==i&&(i=g.mapToColor(t,this.option.visual)),i;},fixed:h}},colorHue:a(function(t,e){return g.modifyHSL(t,e);}),colorSaturation:a(function(t,e){return g.modifyHSL(t,null,e);}),colorLightness:a(function(t,e){return g.modifyHSL(t,null,null,e);}),colorAlpha:a(function(t,e){return g.modifyAlpha(t,e);}),opacity:{applyVisual:l("opacity"),_doMap:c([0,1])},symbol:{applyVisual:function applyVisual(t,e,i){var n=this.mapValueToVisual(t);if(p.isString(n))i("symbol",n);else if(y(n))for(var r in n){n.hasOwnProperty(r)&&i(r,n[r]);}},_doMap:{linear:s,category:u,piecewise:function piecewise(t,e){var i=d.call(this,e);return null==i&&(i=s.call(this,t)),i;},fixed:h}},symbolSize:{applyVisual:l("symbolSize"),_doMap:c([0,1])}},w={linear:function linear(t){return m(t,this.option.dataExtent,[0,1],!0);},piecewise:function piecewise(t){var e=this.option.pieceList,i=_.findPieceIndex(t,e,!0);return null!=i?m(i,[0,e.length-1],[0,1],!0):void 0;},category:function category(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?x:e;},fixed:p.noop};_.addVisualHandler=function(t,e){b[t]=e;},_.isValidType=function(t){return b.hasOwnProperty(t);},_.eachVisual=function(t,e,i){p.isObject(t)?p.each(t,e,i):e.call(i,t);},_.mapVisual=function(t,e,i){var n,r=p.isArray(t)?[]:p.isObject(t)?{}:(n=!0,null);return _.eachVisual(t,function(t,o){var a=e.call(i,t,o);n?r=a:r[o]=a;}),r;},_.retrieveVisuals=function(t){var e,i={};return t&&v(b,function(n,r){t.hasOwnProperty(r)&&(i[r]=t[r],e=!0);}),e?i:null;},_.prepareVisualTypes=function(t){if(y(t)){var e=[];v(t,function(t,i){e.push(i);}),t=e;}else{if(!p.isArray(t))return[];t=t.slice();}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1;}),t;},_.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e;},_.findPieceIndex=function(t,e,i){function n(e,i){var n=Math.abs(e-t);o>n&&(o=n,r=i);}for(var r,o=1/0,a=0,s=e.length;s>a;a++){var l=e[a].value;if(null!=l){if(l===t)return a;i&&n(l,a);}}for(var a=0,s=e.length;s>a;a++){var u=e[a],h=u.interval,c=u.close;if(h){if(h[0]===-(1/0)){if(f(c[1],t,h[1]))return a;}else if(h[1]===1/0){if(f(c[0],h[0],t))return a;}else if(f(c[0],h[0],t)&&f(c[1],t,h[1]))return a;i&&n(h[0],a),i&&n(h[1],a);}}return i?t===1/0?e.length-1:t===-(1/0)?0:r:void 0;},t.exports=_;},function(t,e,i){function n(t,e,i){var n={mainType:"series",subType:"treemap",query:i};t.eachComponent(n,function(t){var n=e.getWidth(),o=e.getHeight(),a=t.option,s=a.size||[],l=b(w(a.width,s[0]),n),u=b(w(a.height,s[1]),o),h=m.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),g=i&&i.type,x=v.retrieveTargetInfo(i,t),_="treemapRender"===g||"treemapMove"===g?i.rootRect:null,M=t.getViewRoot(),I=v.getPathToRoot(M);if("treemapMove"!==g){var T="treemapZoomToNode"===g?c(t,x,M,l,u):_?[_.width,_.height]:[l,u],A=a.sort;A&&"asc"!==A&&"desc"!==A&&(A="desc");var L={squareRatio:a.squareRatio,sort:A,leafDepth:a.leafDepth};M.hostTree.clearLayouts();var C={x:0,y:0,width:T[0],height:T[1],area:T[0]*T[1]};M.setLayout(C),r(M,L,!1,0);var C=M.getLayout();S(I,function(t,e){var i=(I[e+1]||M).getValue();t.setLayout(p.extend({dataExtent:[i,i],borderWidth:0},C));});}var D=t.getData().tree.root;D.setLayout(d(h,_,x),!0),t.setLayoutInfo(h),f(D,new y(-h.x,-h.y,n,o),I,M,0);});}function r(t,e,i,n){var a,s;if(!t.isRemoved()){var l=t.getLayout();a=l.width,s=l.height;var c=t.getModel("itemStyle.normal"),d=c.get("borderWidth"),f=c.get("gapWidth")/2,p=d-f,g=t.getModel();t.setLayout({borderWidth:d},!0),a=x(a-2*p,0),s=x(s-2*p,0);var m=a*s,v=o(t,g,m,e,i,n);if(v.length){var y={x:p,y:p,width:a,height:s},b=_(a,s),w=1/0,S=[];S.area=0;for(var M=0,I=v.length;I>M;){var T=v[M];S.push(T),S.area+=T.getLayout().area;var A=u(S,b,e.squareRatio);w>=A?(M++,w=A):(S.area-=S.pop().getLayout().area,h(S,b,y,f,!1),b=_(y.width,y.height),S.length=S.area=0,w=1/0);}if(S.length&&h(S,b,y,f,!0),!i){var L=g.get("childrenVisibleMin");null!=L&&L>m&&(i=!0);}for(var M=0,I=v.length;I>M;M++){r(v[M],e,i,n+1);}}}}function o(t,e,i,n,r,o){var u=t.children||[],h=n.sort;"asc"!==h&&"desc"!==h&&(h=null);var c=null!=n.leafDepth&&n.leafDepth<=o;if(r&&!c)return t.viewChildren=[];u=p.filter(u,function(t){return!t.isRemoved();}),s(u,h);var d=l(e,u,h);if(0===d.sum)return t.viewChildren=[];if(d.sum=a(e,i,d.sum,h,u),0===d.sum)return t.viewChildren=[];for(var f=0,g=u.length;g>f;f++){var m=u[f].getValue()/d.sum*i;u[f].setLayout({area:m});}return c&&(u.length&&t.setLayout({isLeafRoot:!0},!0),u.length=0),t.viewChildren=u,t.setLayout({dataExtent:d.dataExtent},!0),u;}function a(t,e,i,n,r){if(!n)return i;for(var o=t.get("visibleMin"),a=r.length,s=a,l=a-1;l>=0;l--){var u=r["asc"===n?a-l-1:l].getValue();o>u/i*e&&(s=l,i-=u);}return"asc"===n?r.splice(0,a-s):r.splice(s,a-s),i;}function s(t,e){return e&&t.sort(function(t,i){return"asc"===e?t.getValue()-i.getValue():i.getValue()-t.getValue();}),t;}function l(t,e,i){for(var n=0,r=0,o=e.length;o>r;r++){n+=e[r].getValue();}var a,s=t.get("visualDimension");if(e&&e.length){if("value"===s&&i)a=[e[e.length-1].getValue(),e[0].getValue()],"asc"===i&&a.reverse();else{var a=[1/0,-(1/0)];S(e,function(t){var e=t.getValue(s);e<a[0]&&(a[0]=e),e>a[1]&&(a[1]=e);});}}else a=[NaN,NaN];return{sum:n,dataExtent:a};}function u(t,e,i){for(var n,r=0,o=1/0,a=0,s=t.length;s>a;a++){n=t[a].getLayout().area,n&&(o>n&&(o=n),n>r&&(r=n));}var l=t.area*t.area,u=e*e*i;return l?x(u*r/l,l/(u*o)):1/0;}function h(t,e,i,n,r){var o=e===i.width?0:1,a=1-o,s=["x","y"],l=["width","height"],u=i[s[o]],h=e?t.area/e:0;(r||h>i[l[a]])&&(h=i[l[a]]);for(var c=0,d=t.length;d>c;c++){var f=t[c],p={},g=h?f.getLayout().area/h:0,m=p[l[a]]=x(h-2*n,0),v=i[s[o]]+i[l[o]]-u,y=c===d-1||g>v?v:g,b=p[l[o]]=x(y-2*n,0);p[s[a]]=i[s[a]]+_(n,m/2),p[s[o]]=u+_(n,b/2),u+=y,f.setLayout(p,!0);}i[s[a]]+=h,i[l[a]]-=h;}function c(t,e,i,n,r){var o=(e||{}).node,a=[n,r];if(!o||o===i)return a;for(var s,l=n*r,u=l*t.option.zoomToNodeRatio;s=o.parentNode;){for(var h=0,c=s.children,d=0,f=c.length;f>d;d++){h+=c[d].getValue();}var p=o.getValue();if(0===p)return a;u*=h/p;var m=s.getModel("itemStyle.normal").get("borderWidth");isFinite(m)&&(u+=4*m*m+4*m*Math.pow(u,.5)),u>g.MAX_SAFE_INTEGER&&(u=g.MAX_SAFE_INTEGER),o=s;}l>u&&(u=l);var v=Math.pow(u/l,.5);return[n*v,r*v];}function d(t,e,i){if(e)return{x:e.x,y:e.y};var n={x:0,y:0};if(!i)return n;var r=i.node,o=r.getLayout();if(!o)return n;for(var a=[o.width/2,o.height/2],s=r;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode;}return{x:t.width/2-a[0],y:t.height/2-a[1]};}function f(t,e,i,n,r){var o=t.getLayout(),a=i[r],s=a&&a===t;if(!(a&&!s||r===i.length&&t!==n)){t.setLayout({isInView:!0,invisible:!s&&!e.intersect(o),isAboveViewRoot:s},!0);var l=new y(e.x-o.x,e.y-o.y,e.width,e.height);S(t.viewChildren||[],function(t){f(t,l,i,n,r+1);});}}var p=i(4),g=i(7),m=i(21),v=i(187),y=i(9),v=i(187),x=Math.max,_=Math.min,b=g.parsePercent,w=p.retrieve,S=p.each;t.exports=n;},function(t,e,i){var n=i(1),r=i(4);i(196),i(199),i(204),n.registerProcessor(i(205)),n.registerVisual(r.curry(i(109),"graph","circle",null)),n.registerVisual(i(206)),n.registerVisual(i(207)),n.registerLayout(i(208)),n.registerLayout(i(211)),n.registerLayout(i(213)),n.registerCoordinateSystem("graphView",{create:i(215)});},function(t,e,i){"use strict";var n=i(97),r=i(4),o=i(5),a=i(12),s=i(197),l=i(1).extendSeriesModel({type:"series.graph",init:function init(t){l.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData;},this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeOption:function mergeOption(t){l.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData();},mergeDefaultAndTheme:function mergeDefaultAndTheme(t){l.superApply(this,"mergeDefaultAndTheme",arguments),o.defaultEmphasis(t.edgeLabel,o.LABEL_OPTIONS);},getInitialData:function getInitialData(t,e){function i(t,e){t.wrapMethod("getItemModel",function(t){var e=o._categoriesModels,i=t.getShallow("category"),n=e[i];return n&&(n.parentModel=t.parentModel,t.parentModel=n),t;});var i=o.getModel("edgeLabel"),n=function n(t,e){var r=(t||"").split(".");"label"===r[0]&&(e=e||i.getModel(r.slice(1)));var o=a.prototype.getModel.call(this,r,e);return o.getModel=n,o;};e.wrapMethod("getItemModel",function(t){return t.getModel=n,t;});}var n=t.edges||t.links||[],r=t.data||t.nodes||[],o=this;return r&&n?s(r,n,this,!0,i).data:void 0;},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},getCategoriesData:function getCategoriesData(){return this._categoriesData;},formatTooltip:function formatTooltip(t,e,i){if("edge"===i){var n=this.getData(),r=this.getDataParams(t,i),o=n.graph.getEdgeByIndex(t),a=n.getName(o.node1.dataIndex),s=n.getName(o.node2.dataIndex),u=a+" > "+s;return r.value&&(u+=" : "+r.value),u;}return l.superApply(this,"formatTooltip",arguments);},_updateCategoriesData:function _updateCategoriesData(){var t=r.map(this.option.categories||[],function(t){return null!=t.value?t:r.extend({value:0},t);}),e=new n(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t,!0);});},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;},ifEnableAnimation:function ifEnableAnimation(){return l.superCall(this,"ifEnableAnimation")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"));},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{normal:{position:"middle"},emphasis:{}},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{normal:{show:!1,formatter:"{b}"},emphasis:{show:!0}},itemStyle:{normal:{},emphasis:{}},lineStyle:{normal:{color:"#aaa",width:1,curveness:0,opacity:.5},emphasis:{}}}});t.exports=l;},function(t,e,i){var n=i(97),r=i(198),o=i(186),a=i(102),s=i(26),l=i(4),u=i(101);t.exports=function(t,e,i,h,c){for(var d=new r(h),f=0;f<t.length;f++){d.addNode(l.retrieve(t[f].id,t[f].name,f),f);}for(var p=[],g=[],m=0,f=0;f<e.length;f++){var v=e[f],y=v.source,x=v.target;d.addEdge(y,x,m)&&(g.push(v),p.push(l.retrieve(v.id,y+" > "+x)),m++);}var _,b=i.get("coordinateSystem");if("cartesian2d"===b||"polar"===b)_=u(t,i,i.ecModel);else{var w=s.get(b),S=a((w&&"view"!==w.type?w.dimensions||[]:[]).concat(["value"]),t);_=new n(S,i),_.initData(t);}var M=new n(["value"],i);return M.initData(g,p),c&&c(_,M),o({mainData:_,struct:d,structAttr:"graph",datas:{node:_,edge:M},datasAttr:{node:"data",edge:"edgeData"}}),d.update(),d;};},function(t,e,i){"use strict";function n(t,e){this.id=null==t?"":t,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==e?-1:e;}function r(t,e,i){this.node1=t,this.node2=e,this.dataIndex=null==i?-1:i;}var o=i(4),a=function a(t){this._directed=t||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData;},s=a.prototype;s.type="graph",s.isDirected=function(){return this._directed;},s.addNode=function(t,e){t=t||""+e;var i=this._nodesMap;if(!i[t]){var r=new n(t,e);return r.hostGraph=this,this.nodes.push(r),i[t]=r,r;}},s.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e];},s.getNodeById=function(t){return this._nodesMap[t];},s.addEdge=function(t,e,i){var o=this._nodesMap,a=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),t instanceof n||(t=o[t]),e instanceof n||(e=o[e]),t&&e){var s=t.id+"-"+e.id;if(!a[s]){var l=new r(t,e,i);return l.hostGraph=this,this._directed&&(t.outEdges.push(l),e.inEdges.push(l)),t.edges.push(l),t!==e&&e.edges.push(l),this.edges.push(l),a[s]=l,l;}}},s.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e];},s.getEdge=function(t,e){t instanceof n&&(t=t.id),e instanceof n&&(e=e.id);var i=this._edgesMap;return this._directed?i[t+"-"+e]:i[t+"-"+e]||i[e+"-"+t];},s.eachNode=function(t,e){for(var i=this.nodes,n=i.length,r=0;n>r;r++){i[r].dataIndex>=0&&t.call(e,i[r],r);}},s.eachEdge=function(t,e){for(var i=this.edges,n=i.length,r=0;n>r;r++){i[r].dataIndex>=0&&i[r].node1.dataIndex>=0&&i[r].node2.dataIndex>=0&&t.call(e,i[r],r);}},s.breadthFirstTraverse=function(t,e,i,r){if(e instanceof n||(e=this._nodesMap[e]),e){for(var o="out"===i?"outEdges":"in"===i?"inEdges":"edges",a=0;a<this.nodes.length;a++){this.nodes[a].__visited=!1;}if(!t.call(r,e,null))for(var s=[e];s.length;){for(var l=s.shift(),u=l[o],a=0;a<u.length;a++){var h=u[a],c=h.node1===l?h.node2:h.node1;if(!c.__visited){if(t.call(c,c,l))return;s.push(c),c.__visited=!0;}}}}},s.update=function(){for(var t=this.data,e=this.edgeData,i=this.nodes,n=this.edges,r=0,o=i.length;o>r;r++){i[r].dataIndex=-1;}for(var r=0,o=t.count();o>r;r++){i[t.getRawIndex(r)].dataIndex=r;}e.filterSelf(function(t){var i=n[e.getRawIndex(t)];return i.node1.dataIndex>=0&&i.node2.dataIndex>=0;});for(var r=0,o=n.length;o>r;r++){n[r].dataIndex=-1;}for(var r=0,o=e.count();o>r;r++){n[e.getRawIndex(r)].dataIndex=r;}},s.clone=function(){for(var t=new a(this._directed),e=this.nodes,i=this.edges,n=0;n<e.length;n++){t.addNode(e[n].id,e[n].dataIndex);}for(var n=0;n<i.length;n++){var r=i[n];t.addEdge(r.node1.id,r.node2.id,r.dataIndex);}return t;},n.prototype={constructor:n,degree:function degree(){return this.edges.length;},inDegree:function inDegree(){return this.inEdges.length;},outDegree:function outDegree(){return this.outEdges.length;},getModel:function getModel(t){if(!(this.dataIndex<0)){var e=this.hostGraph,i=e.data.getItemModel(this.dataIndex);return i.getModel(t);}}},r.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,i=e.edgeData.getItemModel(this.dataIndex);return i.getModel(t);}};var l=function l(t,e){return{getValue:function getValue(i){var n=this[t][e];return n.get(n.getDimension(i||"value"),this.dataIndex);},setVisual:function setVisual(i,n){this.dataIndex>=0&&this[t][e].setItemVisual(this.dataIndex,i,n);},getVisual:function getVisual(i,n){return this[t][e].getItemVisual(this.dataIndex,i,n);},setLayout:function setLayout(i,n){this.dataIndex>=0&&this[t][e].setItemLayout(this.dataIndex,i,n);},getLayout:function getLayout(){return this[t][e].getItemLayout(this.dataIndex);},getGraphicEl:function getGraphicEl(){return this[t][e].getItemGraphicEl(this.dataIndex);},getRawIndex:function getRawIndex(){return this[t][e].getRawIndex(this.dataIndex);}};};o.mixin(n,l("hostGraph","data")),o.mixin(r,l("hostGraph","edgeData")),a.Node=n,a.Edge=r,t.exports=a;},function(t,e,i){function n(t,e){return t.getVisual("opacity")||t.getModel().get(e);}var r=i(104),o=i(200),a=i(175),s=i(43),l=i(203),u=i(4),h=["itemStyle","normal","opacity"],c=["lineStyle","normal","opacity"];i(1).extendChartView({type:"graph",init:function init(t,e){var i=new r(),n=new o(),s=this.group,l=new a(e.getZr(),s);s.add(i.group),s.add(n.group),this._symbolDraw=i,this._lineDraw=n,this._controller=l,this._firstRender=!0;},render:function render(t,e,i){var n=t.coordinateSystem;this._model=t,this._nodeScaleRatio=t.get("nodeScaleRatio");var r=this._symbolDraw,o=this._lineDraw,a=this.group;if("view"===n.type){var u={position:n.position,scale:n.scale};this._firstRender?a.attr(u):s.updateProps(a,u,t);}l(t.getGraph(),this._getNodeGlobalScale(t));var h=t.getData();r.updateData(h);var c=t.getEdgeData();o.updateData(c),this._updateNodeAndLinkScale(),this._updateController(t,i),clearTimeout(this._layoutTimeout);var d=t.forceLayout,f=t.get("force.layoutAnimation");d&&this._startForceLayoutIteration(d,f),h.eachItemGraphicEl(function(t,e){var i=h.getItemModel(e);t.off("drag").off("dragend");var n=h.getItemModel(e).get("draggable");n&&t.on("drag",function(){d&&(d.warmUp(),!this._layouting&&this._startForceLayoutIteration(d,f),d.setFixed(e),h.setItemLayout(e,t.position));},this).on("dragend",function(){d&&d.setUnfixed(e);},this),t.setDraggable(n&&d),t.off("mouseover",this._focusNodeAdjacency),t.off("mouseout",this._unfocusAll),i.get("focusNodeAdjacency")&&(t.on("mouseover",this._focusNodeAdjacency,this),t.on("mouseout",this._unfocusAll,this));},this);var p="circular"===t.get("layout")&&t.get("circular.rotateLabel"),g=h.getLayout("cx"),m=h.getLayout("cy");h.eachItemGraphicEl(function(t,e){var i=t.getSymbolPath();if(p){var n=h.getItemLayout(e),r=Math.atan2(n[1]-m,n[0]-g);0>r&&(r=2*Math.PI+r);var o=n[0]<g;o&&(r-=Math.PI);var a=o?"left":"right";i.setStyle({textRotation:r,textPosition:a}),i.hoverStyle&&(i.hoverStyle.textPosition=a);}else i.setStyle({textRotation:0});}),this._firstRender=!1;},dispose:function dispose(){this._controller&&this._controller.dispose();},_focusNodeAdjacency:function _focusNodeAdjacency(t){function e(t,e){var i=n(t,e),r=t.getGraphicEl();null==i&&(i=1),r.traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",.1*i);});}function i(t,e){var i=n(t,e),r=t.getGraphicEl();r.traverse(function(t){t.trigger("emphasis"),"group"!==t.type&&t.setStyle("opacity",i);});}var r=this._model.getData(),o=r.graph,a=t.target,s=a.dataIndex,l=a.dataType;if(null!==s&&"edge"!==l){o.eachNode(function(t){e(t,h);}),o.eachEdge(function(t){e(t,c);});var d=o.getNodeByIndex(s);i(d,h),u.each(d.edges,function(t){t.dataIndex<0||(i(t,c),i(t.node1,h),i(t.node2,h));});}},_unfocusAll:function _unfocusAll(){var t=this._model.getData(),e=t.graph;e.eachNode(function(t){var e=n(t,h);t.getGraphicEl().traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",e);});}),e.eachEdge(function(t){var e=n(t,c);t.getGraphicEl().traverse(function(t){t.trigger("normal"),"group"!==t.type&&t.setStyle("opacity",e);});});},_startForceLayoutIteration:function _startForceLayoutIteration(t,e){var i=this;!function n(){t.step(function(t){i.updateLayout(i._model),(i._layouting=!t)&&(e?i._layoutTimeout=setTimeout(n,16):n());});}();},_updateController:function _updateController(t,e){var i=this._controller,n=this.group;return i.setContainsPoint(function(t,e){var i=n.getBoundingRect();return i.applyTransform(n.transform),i.contain(t,e);}),"view"!==t.coordinateSystem.type?void i.disable():(i.enable(t.get("roam")),i.zoomLimit=t.get("scaleLimit"),i.zoom=t.coordinateSystem.getZoom(),void i.off("pan").off("zoom").on("pan",function(i,n){e.dispatchAction({seriesId:t.id,type:"graphRoam",dx:i,dy:n});}).on("zoom",function(i,n,r){e.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:i,originX:n,originY:r}),this._updateNodeAndLinkScale(),l(t.getGraph(),this._getNodeGlobalScale(t)),this._lineDraw.updateLayout();},this));},_updateNodeAndLinkScale:function _updateNodeAndLinkScale(){var t=this._model,e=t.getData(),i=this._getNodeGlobalScale(t),n=[i,i];e.eachItemGraphicEl(function(t,e){t.attr("scale",n);});},_getNodeGlobalScale:function _getNodeGlobalScale(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=this._nodeScaleRatio,n=e.scale,r=n&&n[0]||1,o=e.getZoom(),a=(o-1)*i+1;return a/r;},updateLayout:function updateLayout(t){l(t.getGraph(),this._getNodeGlobalScale(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout();},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove();}});},function(t,e,i){function n(t){return isNaN(t[0])||isNaN(t[1]);}function r(t){return!n(t[0])&&!n(t[1]);}function o(t){this._ctor=t||s,this.group=new a.Group();}var a=i(43),s=i(201),l=o.prototype;l.updateData=function(t){var e=this._lineData,i=this.group,n=this._ctor,o=t.hostModel,a={lineStyle:o.getModel("lineStyle.normal").getLineStyle(),hoverLineStyle:o.getModel("lineStyle.emphasis").getLineStyle(),labelModel:o.getModel("label.normal"),hoverLabelModel:o.getModel("label.emphasis")};t.diff(e).add(function(e){if(r(t.getItemLayout(e))){var o=new n(t,e,a);t.setItemGraphicEl(e,o),i.add(o);}}).update(function(o,s){var l=e.getItemGraphicEl(s);return r(t.getItemLayout(o))?(l?l.updateData(t,o,a):l=new n(t,o,a),t.setItemGraphicEl(o,l),void i.add(l)):void i.remove(l);}).remove(function(t){i.remove(e.getItemGraphicEl(t));}).execute(),this._lineData=t;},l.updateLayout=function(){var t=this._lineData;t.eachItemGraphicEl(function(e,i){e.updateLayout(t,i);},this);},l.remove=function(){this.group.removeAll();},t.exports=o;},function(t,e,i){function n(t){return"_"+t+"Type";}function r(t,e,i){var n=e.getItemVisual(i,"color"),r=e.getItemVisual(i,t),o=e.getItemVisual(i,t+"Size");if(r&&"none"!==r){f.isArray(o)||(o=[o,o]);var a=u.createSymbol(r,-o[0]/2,-o[1]/2,o[0],o[1],n);return a.name=t,a;}}function o(t){var e=new c({name:"line"});return a(e.shape,t),e;}function a(t,e){var i=e[0],n=e[1],r=e[2];t.x1=i[0],t.y1=i[1],t.x2=n[0],t.y2=n[1],t.percent=1,r?(t.cpx1=r[0],t.cpy1=r[1]):(t.cpx1=NaN,t.cpy1=NaN);}function s(){var t=this,e=t.childOfName("fromSymbol"),i=t.childOfName("toSymbol"),n=t.childOfName("label");if(e||i||!n.ignore){for(var r=1,o=this.parent;o;){o.scale&&(r/=o.scale[0]),o=o.parent;}var a=t.childOfName("line");if(this.__dirty||a.__dirty){var s=a.shape.percent,l=a.pointAt(0),u=a.pointAt(s),c=h.sub([],u,l);if(h.normalize(c,c),e){e.attr("position",l);var d=a.tangentAt(0);e.attr("rotation",Math.PI/2-Math.atan2(d[1],d[0])),e.attr("scale",[r*s,r*s]);}if(i){i.attr("position",u);var d=a.tangentAt(1);i.attr("rotation",-Math.PI/2-Math.atan2(d[1],d[0])),i.attr("scale",[r*s,r*s]);}if(!n.ignore){n.attr("position",u);var f,p,g,m=5*r;if("end"===n.__position)f=[c[0]*m+u[0],c[1]*m+u[1]],p=c[0]>.8?"left":c[0]<-.8?"right":"center",g=c[1]>.8?"top":c[1]<-.8?"bottom":"middle";else if("middle"===n.__position){var v=s/2,d=a.tangentAt(v),y=[d[1],-d[0]],x=a.pointAt(v);y[1]>0&&(y[0]=-y[0],y[1]=-y[1]),f=[x[0]+y[0]*m,x[1]+y[1]*m],p="center",g="bottom";var _=-Math.atan2(d[1],d[0]);u[0]<l[0]&&(_=Math.PI+_),n.attr("rotation",_);}else f=[-c[0]*m+l[0],-c[1]*m+l[1]],p=c[0]>.8?"right":c[0]<-.8?"left":"center",g=c[1]>.8?"bottom":c[1]<-.8?"top":"middle";n.attr({style:{textVerticalAlign:n.__verticalAlign||g,textAlign:n.__textAlign||p},position:f,scale:[r,r]});}}}}function l(t,e,i){d.Group.call(this),this._createLine(t,e,i);}var u=i(106),h=i(10),c=i(202),d=i(43),f=i(4),p=i(7),g=["fromSymbol","toSymbol"],m=l.prototype;m.beforeUpdate=s,m._createLine=function(t,e,i){var a=t.hostModel,s=t.getItemLayout(e),l=o(s);l.shape.percent=0,d.initProps(l,{shape:{percent:1}},a,e),this.add(l);var u=new d.Text({name:"label"});this.add(u),f.each(g,function(i){var o=r(i,t,e);this.add(o),this[n(i)]=t.getItemVisual(e,i);},this),this._updateCommonStl(t,e,i);},m.updateData=function(t,e,i){var o=t.hostModel,s=this.childOfName("line"),l=t.getItemLayout(e),u={shape:{}};a(u.shape,l),d.updateProps(s,u,o,e),f.each(g,function(i){var o=t.getItemVisual(e,i),a=n(i);if(this[a]!==o){this.remove(this.childOfName(i));var s=r(i,t,e);this.add(s);}this[a]=o;},this),this._updateCommonStl(t,e,i);},m._updateCommonStl=function(t,e,i){var n=t.hostModel,r=this.childOfName("line"),o=i&&i.lineStyle,a=i&&i.hoverLineStyle,s=i&&i.labelModel,l=i&&i.hoverLabelModel;if(!i||t.hasItemOption){var u=t.getItemModel(e);o=u.getModel("lineStyle.normal").getLineStyle(),a=u.getModel("lineStyle.emphasis").getLineStyle(),s=u.getModel("label.normal"),l=u.getModel("label.emphasis");}var h=t.getItemVisual(e,"color"),c=f.retrieve(t.getItemVisual(e,"opacity"),o.opacity,1);r.useStyle(f.defaults({strokeNoScale:!0,fill:"none",stroke:h,opacity:c},o)),r.hoverStyle=a,f.each(g,function(t){var e=this.childOfName(t);e&&(e.setColor(h),e.setStyle({opacity:c}));},this);var m,v,y=s.getShallow("show"),x=l.getShallow("show"),_=this.childOfName("label");if(y||x){var b=n.getRawValue(e);v=null==b?v=t.getName(e):isFinite(b)?p.round(b):b,m=h||"#000";}if(y){var w=s.getModel("textStyle");_.setStyle({text:f.retrieve(n.getFormattedLabel(e,"normal",t.dataType),v),textFont:w.getFont(),fill:w.getTextColor()||m}),_.__textAlign=w.get("align"),_.__verticalAlign=w.get("baseline"),_.__position=s.get("position");}else _.setStyle("text","");if(x){var S=l.getModel("textStyle");_.hoverStyle={text:f.retrieve(n.getFormattedLabel(e,"emphasis",t.dataType),v),textFont:S.getFont(),fill:S.getTextColor()||m};}else _.hoverStyle={text:""};_.ignore=!y&&!x,d.setHoverStyle(this);},m.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e));},m.setLinePoints=function(t){var e=this.childOfName("line");a(e.shape,t),e.dirty();},f.inherits(l,d.Group),t.exports=l;},function(t,e,i){function n(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1);}var r=i(43),o=i(10),a=r.Line.prototype,s=r.BezierCurve.prototype;t.exports=r.extendShape({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function buildPath(t,e){(n(e)?a:s).buildPath(t,e);},pointAt:function pointAt(t){return n(this.shape)?a.pointAt.call(this,t):s.pointAt.call(this,t);},tangentAt:function tangentAt(t){var e=this.shape,i=n(e)?[e.x2-e.x1,e.y2-e.y1]:s.tangentAt.call(this,t);return o.normalize(i,i);}});},function(t,e,i){function n(t,e,i){for(var n,r=t[0],o=t[1],d=t[2],f=1/0,p=i*i,g=.1,m=.1;.9>=m;m+=.1){a[0]=u(r[0],o[0],d[0],m),a[1]=u(r[1],o[1],d[1],m);var v=c(h(a,e)-p);f>v&&(f=v,n=m);}for(var y=0;32>y;y++){var x=n+g;s[0]=u(r[0],o[0],d[0],n),s[1]=u(r[1],o[1],d[1],n),l[0]=u(r[0],o[0],d[0],x),l[1]=u(r[1],o[1],d[1],x);var v=h(s,e)-p;if(c(v)<.01)break;var _=h(l,e)-p;g/=2,0>v?_>=0?n+=g:n-=g:_>=0?n-=g:n+=g;}return n;}var r=i(50),o=i(10),a=[],s=[],l=[],u=r.quadraticAt,h=o.distSquare,c=Math.abs;t.exports=function(t,e){function i(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),e;}var a=[],s=r.quadraticSubdivide,l=[[],[],[]],u=[[],[]],h=[];e/=2,t.eachEdge(function(t,r){var c=t.getLayout(),d=t.getVisual("fromSymbol"),f=t.getVisual("toSymbol");c.__original||(c.__original=[o.clone(c[0]),o.clone(c[1])],c[2]&&c.__original.push(o.clone(c[2])));var p=c.__original;if(null!=c[2]){if(o.copy(l[0],p[0]),o.copy(l[1],p[2]),o.copy(l[2],p[1]),d&&"none"!=d){var g=i(t.node1),m=n(l,p[0],g*e);s(l[0][0],l[1][0],l[2][0],m,a),l[0][0]=a[3],l[1][0]=a[4],s(l[0][1],l[1][1],l[2][1],m,a),l[0][1]=a[3],l[1][1]=a[4];}if(f&&"none"!=f){var g=i(t.node2),m=n(l,p[1],g*e);s(l[0][0],l[1][0],l[2][0],m,a),l[1][0]=a[1],l[2][0]=a[2],s(l[0][1],l[1][1],l[2][1],m,a),l[1][1]=a[1],l[2][1]=a[2];}o.copy(c[0],l[0]),o.copy(c[1],l[2]),o.copy(c[2],l[1]);}else{if(o.copy(u[0],p[0]),o.copy(u[1],p[1]),o.sub(h,u[1],u[0]),o.normalize(h,h),d&&"none"!=d){var g=i(t.node1);o.scaleAndAdd(u[0],u[0],h,g*e);}if(f&&"none"!=f){var g=i(t.node2);o.scaleAndAdd(u[1],u[1],h,-g*e);}o.copy(c[0],u[0]),o.copy(c[1],u[1]);}});};},function(t,e,i){var n=i(1),r=i(178),o={type:"graphRoam",event:"graphRoam",update:"none"};n.registerAction(o,function(t,e){e.eachComponent({mainType:"series",query:t},function(e){var i=e.coordinateSystem,n=r.updateCenterAndZoom(i,t);e.setCenter&&e.setCenter(n.center),e.setZoom&&e.setZoom(n.zoom);});});},function(t,e){t.exports=function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getGraph(),r=n.data,o=i.mapArray(i.getName);r.filterSelf(function(t){var i=r.getItemModel(t),n=i.getShallow("category");if(null!=n){"number"==typeof n&&(n=o[n]);for(var a=0;a<e.length;a++){if(!e[a].isSelected(n))return!1;}}return!0;});},this);};},function(t,e){t.exports=function(t){var e={};t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getData(),r={};i.each(function(n){var o=i.getName(n);r[o]=n;var a=i.getItemModel(n),s=a.get("itemStyle.normal.color")||t.getColorFromPalette(o,e);i.setItemVisual(n,"color",s);}),i.count()&&n.each(function(t){var e=n.getItemModel(t),o=e.getShallow("category");null!=o&&("string"==typeof o&&(o=r[o]),n.getItemVisual(t,"color",!0)||n.setItemVisual(t,"color",i.getItemVisual(o,"color")));});});};},function(t,e){function i(t){return t instanceof Array||(t=[t,t]),t;}t.exports=function(t){t.eachSeriesByType("graph",function(t){var e=t.getGraph(),n=t.getEdgeData(),r=i(t.get("edgeSymbol")),o=i(t.get("edgeSymbolSize")),a="lineStyle.normal.color".split("."),s="lineStyle.normal.opacity".split(".");n.setVisual("fromSymbol",r&&r[0]),n.setVisual("toSymbol",r&&r[1]),n.setVisual("fromSymbolSize",o&&o[0]),n.setVisual("toSymbolSize",o&&o[1]),n.setVisual("color",t.get(a)),n.setVisual("opacity",t.get(s)),n.each(function(t){var r=n.getItemModel(t),o=e.getEdgeByIndex(t),l=i(r.getShallow("symbol",!0)),u=i(r.getShallow("symbolSize",!0)),h=r.get(a),c=r.get(s);switch(h){case"source":h=o.node1.getVisual("color");break;case"target":h=o.node2.getVisual("color");}l[0]&&o.setVisual("fromSymbol",l[0]),l[1]&&o.setVisual("toSymbol",l[1]),u[0]&&o.setVisual("fromSymbolSize",u[0]),u[1]&&o.setVisual("toSymbolSize",u[1]),o.setVisual("color",h),o.setVisual("opacity",c);});});};},function(t,e,i){var n=i(209),r=i(210);t.exports=function(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),i=t.coordinateSystem;if(i&&"view"!==i.type){var o=t.getData();o.each(i.dimensions,function(t,e,n){isNaN(t)||isNaN(e)?o.setItemLayout(n,[NaN,NaN]):o.setItemLayout(n,i.dataToPoint([t,e]));}),r(o.graph);}else e&&"none"!==e||n(t);});};},function(t,e,i){var n=i(210);t.exports=function(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=t.getGraph();i.eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")]);}),n(i);}};},function(t,e,i){var n=i(10);t.exports=function(t){t.eachEdge(function(t){var e=t.getModel().get("lineStyle.normal.curveness")||0,i=n.clone(t.node1.getLayout()),r=n.clone(t.node2.getLayout()),o=[i,r];+e&&o.push([(i[0]+r[0])/2-(i[1]-r[1])*e,(i[1]+r[1])/2-(r[0]-i[0])*e]),t.setLayout(o);});};},function(t,e,i){var n=i(212);t.exports=function(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&n(t);});};},function(t,e,i){var n=i(10);t.exports=function(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=e.getBoundingRect(),r=t.getData(),o=r.graph,a=0,s=r.getSum("value"),l=2*Math.PI/(s||r.count()),u=i.width/2+i.x,h=i.height/2+i.y,c=Math.min(i.width,i.height)/2;o.eachNode(function(t){var e=t.getValue("value");a+=l*(s?e:1)/2,t.setLayout([c*Math.cos(a)+u,c*Math.sin(a)+h]),a+=l*(s?e:1)/2;}),r.setLayout({cx:u,cy:h}),o.eachEdge(function(t){var e,i=t.getModel().get("lineStyle.normal.curveness")||0,r=n.clone(t.node1.getLayout()),o=n.clone(t.node2.getLayout()),a=(r[0]+o[0])/2,s=(r[1]+o[1])/2;+i&&(i*=3,e=[u*i+a*(1-i),h*i+s*(1-i)]),t.setLayout([r,o,e]);});}};},function(t,e,i){var n=i(214),r=i(7),o=i(209),a=i(212),s=i(10),l=i(4);t.exports=function(t){t.eachSeriesByType("graph",function(t){var e=t.coordinateSystem;if(!e||"view"===e.type)if("force"===t.get("layout")){var i=t.preservedPoints||{},u=t.getGraph(),h=u.data,c=u.edgeData,d=t.getModel("force"),f=d.get("initLayout");t.preservedPoints?h.each(function(t){var e=h.getId(t);h.setItemLayout(t,i[e]||[NaN,NaN]);}):f&&"none"!==f?"circular"===f&&a(t):o(t);var p=h.getDataExtent("value"),g=c.getDataExtent("value"),m=d.get("repulsion"),v=d.get("edgeLength");l.isArray(m)||(m=[m,m]),l.isArray(v)||(v=[v,v]),v=[v[1],v[0]];var y=h.mapArray("value",function(t,e){var i=h.getItemLayout(e),n=r.linearMap(t,p,m);return isNaN(n)&&(n=(m[0]+m[1])/2),{w:n,rep:n,p:!i||isNaN(i[0])||isNaN(i[1])?null:i};}),x=c.mapArray("value",function(t,e){var i=u.getEdgeByIndex(e),n=r.linearMap(t,g,v);return isNaN(n)&&(n=(v[0]+v[1])/2),{n1:y[i.node1.dataIndex],n2:y[i.node2.dataIndex],d:n,curveness:i.getModel().get("lineStyle.normal.curveness")||0};}),e=t.coordinateSystem,_=e.getBoundingRect(),b=n(y,x,{rect:_,gravity:d.get("gravity")}),w=b.step;b.step=function(t){for(var e=0,n=y.length;n>e;e++){y[e].fixed&&s.copy(y[e].p,u.getNodeByIndex(e).getLayout());}w(function(e,n,r){for(var o=0,a=e.length;a>o;o++){e[o].fixed||u.getNodeByIndex(o).setLayout(e[o].p),i[h.getId(o)]=e[o].p;}for(var o=0,a=n.length;a>o;o++){var l=n[o],c=u.getEdgeByIndex(o),d=l.n1.p,f=l.n2.p,p=c.getLayout();p=p?p.slice():[],p[0]=p[0]||[],p[1]=p[1]||[],s.copy(p[0],d),s.copy(p[1],f),+l.curveness&&(p[2]=[(d[0]+f[0])/2-(d[1]-f[1])*l.curveness,(d[1]+f[1])/2-(f[0]-d[0])*l.curveness]),c.setLayout(p);}t&&t(r);});},t.forceLayout=b,t.preservedPoints=i,b.step();}else t.forceLayout=null;});};},function(t,e,i){var n=i(10),r=n.scaleAndAdd;t.exports=function(t,e,i){for(var o=i.rect,a=o.width,s=o.height,l=[o.x+a/2,o.y+s/2],u=null==i.gravity?.1:i.gravity,h=0;h<t.length;h++){var c=t[h];c.p||(c.p=n.create(a*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),c.pp=n.clone(c.p),c.edges=null;}var d=.6;return{warmUp:function warmUp(){d=.5;},setFixed:function setFixed(e){t[e].fixed=!0;},setUnfixed:function setUnfixed(e){t[e].fixed=!1;},step:function step(i){for(var o=[],a=t.length,s=0;s<e.length;s++){var h=e[s],c=h.n1,f=h.n2;n.sub(o,f.p,c.p);var p=n.len(o)-h.d,g=f.w/(c.w+f.w);n.normalize(o,o),!c.fixed&&r(c.p,c.p,o,g*p*d),!f.fixed&&r(f.p,f.p,o,-(1-g)*p*d);}for(var s=0;a>s;s++){var m=t[s];m.fixed||(n.sub(o,l,m.p),n.scaleAndAdd(m.p,m.p,o,u*d));}for(var s=0;a>s;s++){for(var c=t[s],v=s+1;a>v;v++){var f=t[v];n.sub(o,f.p,c.p);var p=n.len(o);0===p&&(n.set(o,Math.random()-.5,Math.random()-.5),p=1);var y=(c.rep+f.rep)/p/p;!c.fixed&&r(c.pp,c.pp,o,y),!f.fixed&&r(f.pp,f.pp,o,-y);}}for(var x=[],s=0;a>s;s++){var m=t[s];m.fixed||(n.sub(x,m.p,m.pp),n.scaleAndAdd(m.p,m.p,x,d),n.copy(m.pp,m.p));}d=.992*d,i&&i(t,e,.01>d);}};};},function(t,e,i){function n(t,e,i){var n=t.getBoxLayoutParams();return n.aspect=i,o.getLayoutRect(n,{width:e.getWidth(),height:e.getHeight()});}var r=i(169),o=i(21),a=i(51);t.exports=function(t,e){var i=[];return t.eachSeriesByType("graph",function(t){var o=t.get("coordinateSystem");if(!o||"view"===o){var s=t.getData(),l=s.mapArray(function(t){var e=s.getItemModel(t);return[+e.get("x"),+e.get("y")];}),u=[],h=[];a.fromPoints(l,u,h),h[0]-u[0]===0&&(h[0]+=1,u[0]-=1),h[1]-u[1]===0&&(h[1]+=1,u[1]-=1);var c=(h[0]-u[0])/(h[1]-u[1]),d=n(t,e,c);isNaN(c)&&(u=[d.x,d.y],h=[d.x+d.width,d.y+d.height]);var f=h[0]-u[0],p=h[1]-u[1],g=d.width,m=d.height,v=t.coordinateSystem=new r();v.zoomLimit=t.get("scaleLimit"),v.setBoundingRect(u[0],u[1],f,p),v.setViewRect(d.x,d.y,g,m),v.setCenter(t.get("center")),v.setZoom(t.get("zoom")),i.push(v);}}),i;};},function(t,e,i){i(217),i(218);},function(t,e,i){var n=i(97),r=i(28),o=i(4),a=r.extend({type:"series.gauge",getInitialData:function getInitialData(t,e){var i=new n(["value"],this),r=t.data||[];return o.isArray(r)||(r=[r]),i.initData(r),i;},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,textStyle:{color:"auto"}},pointer:{show:!0,length:"80%",width:8},itemStyle:{normal:{color:"auto"}},title:{show:!0,offsetCenter:[0,"-40%"],textStyle:{color:"#333",fontSize:15}},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:40,offsetCenter:[0,"40%"],textStyle:{color:"auto",fontSize:30}}}});t.exports=a;},function(t,e,i){function n(t,e){var i=t.get("center"),n=e.getWidth(),r=e.getHeight(),o=Math.min(n,r),a=l(i[0],e.getWidth()),s=l(i[1],e.getHeight()),u=l(t.get("radius"),o/2);return{cx:a,cy:s,r:u};}function r(t,e){return e&&("string"==typeof e?t=e.replace("{value}",t):"function"==typeof e&&(t=e(t))),t;}var o=i(219),a=i(43),s=i(7),l=s.parsePercent,u=2*Math.PI,h=i(42).extend({type:"gauge",render:function render(t,e,i){this.group.removeAll();var r=t.get("axisLine.lineStyle.color"),o=n(t,i);this._renderMain(t,e,i,r,o);},dispose:function dispose(){},_renderMain:function _renderMain(t,e,i,n,r){for(var o=this.group,s=t.getModel("axisLine"),l=s.getModel("lineStyle"),h=t.get("clockwise"),c=-t.get("startAngle")/180*Math.PI,d=-t.get("endAngle")/180*Math.PI,f=(d-c)%u,p=c,g=l.get("width"),m=0;m<n.length;m++){var v=Math.min(Math.max(n[m][0],0),1),d=c+f*v,y=new a.Sector({shape:{startAngle:p,endAngle:d,cx:r.cx,cy:r.cy,clockwise:h,r0:r.r-g,r:r.r},silent:!0});y.setStyle({fill:n[m][1]}),y.setStyle(l.getLineStyle(["color","borderWidth","borderColor"])),o.add(y),p=d;}var x=function x(t){if(0>=t)return n[0][1];for(var e=0;e<n.length;e++){if(n[e][0]>=t&&(0===e?0:n[e-1][0])<t)return n[e][1];}return n[e-1][1];};if(!h){var _=c;c=d,d=_;}this._renderTicks(t,e,i,x,r,c,d,h),this._renderPointer(t,e,i,x,r,c,d,h),this._renderTitle(t,e,i,x,r),this._renderDetail(t,e,i,x,r);},_renderTicks:function _renderTicks(t,e,i,n,o,u,h,c){for(var d=this.group,f=o.cx,p=o.cy,g=o.r,m=t.get("min"),v=t.get("max"),y=t.getModel("splitLine"),x=t.getModel("axisTick"),_=t.getModel("axisLabel"),b=t.get("splitNumber"),w=x.get("splitNumber"),S=l(y.get("length"),g),M=l(x.get("length"),g),I=u,T=(h-u)/b,A=T/w,L=y.getModel("lineStyle").getLineStyle(),C=x.getModel("lineStyle").getLineStyle(),D=_.getModel("textStyle"),P=0;b>=P;P++){var k=Math.cos(I),z=Math.sin(I);if(y.get("show")){var O=new a.Line({shape:{x1:k*g+f,y1:z*g+p,x2:k*(g-S)+f,y2:z*(g-S)+p},style:L,silent:!0});"auto"===L.stroke&&O.setStyle({stroke:n(P/b)}),d.add(O);}if(_.get("show")){var E=r(s.round(P/b*(v-m)+m),_.get("formatter")),R=_.get("distance"),N=new a.Text({style:{text:E,x:k*(g-S-R)+f,y:z*(g-S-R)+p,fill:D.getTextColor(),textFont:D.getFont(),textVerticalAlign:-.4>z?"top":z>.4?"bottom":"middle",textAlign:-.4>k?"left":k>.4?"right":"center"},silent:!0});"auto"===N.style.fill&&N.setStyle({fill:n(P/b)}),d.add(N);}if(x.get("show")&&P!==b){for(var V=0;w>=V;V++){var k=Math.cos(I),z=Math.sin(I),B=new a.Line({shape:{x1:k*g+f,y1:z*g+p,x2:k*(g-M)+f,y2:z*(g-M)+p},silent:!0,style:C});"auto"===C.stroke&&B.setStyle({stroke:n((P+V/w)/b)}),d.add(B),I+=A;}I-=A;}else I+=T;}},_renderPointer:function _renderPointer(t,e,i,n,r,u,h,c){var d=[+t.get("min"),+t.get("max")],f=[u,h],p=t.getData(),g=this._data,m=this.group;p.diff(g).add(function(e){var i=new o({shape:{angle:u}});a.updateProps(i,{shape:{angle:s.linearMap(p.get("value",e),d,f,!0)}},t),m.add(i),p.setItemGraphicEl(e,i);}).update(function(e,i){var n=g.getItemGraphicEl(i);a.updateProps(n,{shape:{angle:s.linearMap(p.get("value",e),d,f,!0)}},t),m.add(n),p.setItemGraphicEl(e,n);}).remove(function(t){var e=g.getItemGraphicEl(t);m.remove(e);}).execute(),p.eachItemGraphicEl(function(t,e){var i=p.getItemModel(e),o=i.getModel("pointer");t.setShape({x:r.cx,y:r.cy,width:l(o.get("width"),r.r),r:l(o.get("length"),r.r)}),t.useStyle(i.getModel("itemStyle.normal").getItemStyle()),"auto"===t.style.fill&&t.setStyle("fill",n((p.get("value",e)-d[0])/(d[1]-d[0]))),a.setHoverStyle(t,i.getModel("itemStyle.emphasis").getItemStyle());}),this._data=p;},_renderTitle:function _renderTitle(t,e,i,n,r){var o=t.getModel("title");if(o.get("show")){var s=o.getModel("textStyle"),u=o.get("offsetCenter"),h=r.cx+l(u[0],r.r),c=r.cy+l(u[1],r.r),d=new a.Text({style:{x:h,y:c,text:t.getData().getName(0),fill:s.getTextColor(),textFont:s.getFont(),textAlign:"center",textVerticalAlign:"middle"}});this.group.add(d);}},_renderDetail:function _renderDetail(t,e,i,n,o){var u=t.getModel("detail"),h=t.get("min"),c=t.get("max");if(u.get("show")){var d=u.getModel("textStyle"),f=u.get("offsetCenter"),p=o.cx+l(f[0],o.r),g=o.cy+l(f[1],o.r),m=l(u.get("width"),o.r),v=l(u.get("height"),o.r),y=t.getData().get("value",0),x=new a.Rect({shape:{x:p-m/2,y:g-v/2,width:m,height:v},style:{text:r(y,u.get("formatter")),fill:u.get("backgroundColor"),textFill:d.getTextColor(),textFont:d.getFont()}});"auto"===x.style.textFill&&x.setStyle("textFill",n(s.linearMap(y,[h,c],[0,1],!0))),x.setStyle(u.getItemStyle(["color"])),this.group.add(x);}}});t.exports=h;},function(t,e,i){t.exports=i(45).extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function buildPath(t,e){var i=Math.cos,n=Math.sin,r=e.r,o=e.width,a=e.angle,s=e.x-i(a)*o*(o>=r/3?1:2),l=e.y-n(a)*o*(o>=r/3?1:2);a=e.angle-Math.PI/2,t.moveTo(s,l),t.lineTo(e.x+i(a)*o,e.y+n(a)*o),t.lineTo(e.x+i(e.angle)*r,e.y+n(e.angle)*r),t.lineTo(e.x-i(a)*o,e.y-n(a)*o),t.lineTo(s,l);}});},function(t,e,i){var n=i(4),r=i(1);i(221),i(222),r.registerVisual(n.curry(i(144),"funnel")),r.registerLayout(i(223)),r.registerProcessor(n.curry(i(147),"funnel"));},function(t,e,i){"use strict";var n=i(97),r=i(5),o=i(102),a=i(1).extendSeriesModel({type:"series.funnel",init:function init(t){a.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._dataBeforeProcessed;},this._defaultLabelLine(t);},getInitialData:function getInitialData(t,e){var i=o(["value"],t.data),r=new n(i,this);return r.initData(t.data),r;},_defaultLabelLine:function _defaultLabelLine(t){r.defaultEmphasis(t.labelLine,["show"]);var e=t.labelLine.normal,i=t.labelLine.emphasis;e.show=e.show&&t.label.normal.show,i.show=i.show&&t.label.emphasis.show;},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",gap:0,funnelAlign:"center",label:{normal:{show:!0,position:"outer"},emphasis:{show:!0}},labelLine:{normal:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},emphasis:{}},itemStyle:{normal:{borderColor:"#fff",borderWidth:1},emphasis:{}}}});t.exports=a;},function(t,e,i){function n(t,e){function i(){a.ignore=a.hoverIgnore,s.ignore=s.hoverIgnore;}function n(){a.ignore=a.normalIgnore,s.ignore=s.normalIgnore;}o.Group.call(this);var r=new o.Polygon(),a=new o.Polyline(),s=new o.Text();this.add(r),this.add(a),this.add(s),this.updateData(t,e,!0),this.on("emphasis",i).on("normal",n).on("mouseover",i).on("mouseout",n);}function r(t,e,i,n){var r=n.getModel("textStyle"),o=n.get("position"),s="inside"===o||"inner"===o||"center"===o;return{fill:r.getTextColor()||(s?"#fff":t.getItemVisual(e,"color")),textFont:r.getFont(),text:a.retrieve(t.hostModel.getFormattedLabel(e,i),t.getName(e))};}var o=i(43),a=i(4),s=n.prototype,l=["itemStyle","normal","opacity"];s.updateData=function(t,e,i){var n=this.childAt(0),r=t.hostModel,s=t.getItemModel(e),u=t.getItemLayout(e),h=t.getItemModel(e).get(l);h=null==h?1:h,n.useStyle({}),i?(n.setShape({points:u.points}),n.setStyle({opacity:0}),o.initProps(n,{style:{opacity:h}},r,e)):o.updateProps(n,{style:{opacity:h},shape:{points:u.points}},r,e);var c=s.getModel("itemStyle"),d=t.getItemVisual(e,"color");n.setStyle(a.defaults({lineJoin:"round",fill:d},c.getModel("normal").getItemStyle(["opacity"]))),n.hoverStyle=c.getModel("emphasis").getItemStyle(),this._updateLabel(t,e),o.setHoverStyle(this);},s._updateLabel=function(t,e){var i=this.childAt(1),n=this.childAt(2),a=t.hostModel,s=t.getItemModel(e),l=t.getItemLayout(e),u=l.label,h=t.getItemVisual(e,"color");o.updateProps(i,{shape:{points:u.linePoints||u.linePoints}},a,e),o.updateProps(n,{style:{x:u.x,y:u.y}},a,e),n.attr({style:{textAlign:u.textAlign,textVerticalAlign:u.verticalAlign,textFont:u.font},rotation:u.rotation,origin:[u.x,u.y],z2:10});var c=s.getModel("label.normal"),d=s.getModel("label.emphasis"),f=s.getModel("labelLine.normal"),p=s.getModel("labelLine.emphasis");n.setStyle(r(t,e,"normal",c)),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),i.ignore=i.normalIgnore=!f.get("show"),i.hoverIgnore=!p.get("show"),i.setStyle({stroke:h}),i.setStyle(f.getModel("lineStyle").getLineStyle()),n.hoverStyle=r(t,e,"emphasis",d),i.hoverStyle=p.getModel("lineStyle").getLineStyle();},a.inherits(n,o.Group);var u=i(42).extend({type:"funnel",render:function render(t,e,i){var r=t.getData(),o=this._data,a=this.group;r.diff(o).add(function(t){var e=new n(r,t);r.setItemGraphicEl(t,e),a.add(e);}).update(function(t,e){var i=o.getItemGraphicEl(e);i.updateData(r,t),a.add(i),r.setItemGraphicEl(t,i);}).remove(function(t){var e=o.getItemGraphicEl(t);a.remove(e);}).execute(),this._data=r;},remove:function remove(){this.group.removeAll(),this._data=null;},dispose:function dispose(){}});t.exports=u;},function(t,e,i){function n(t,e){return a.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}function r(t,e){for(var i=t.mapArray("value",function(t){return t;}),n=[],r="ascending"===e,o=0,a=t.count();a>o;o++){n[o]=o;}return n.sort(function(t,e){return r?i[t]-i[e]:i[e]-i[t];}),n;}function o(t){t.each(function(e){var i,n,r,o,a=t.getItemModel(e),s=a.getModel("label.normal"),l=s.get("position"),u=a.getModel("labelLine.normal"),h=t.getItemLayout(e),c=h.points,d="inner"===l||"inside"===l||"center"===l;if(d)n=(c[0][0]+c[1][0]+c[2][0]+c[3][0])/4,r=(c[0][1]+c[1][1]+c[2][1]+c[3][1])/4,i="center",o=[[n,r],[n,r]];else{var f,p,g,m=u.get("length");"left"===l?(f=(c[3][0]+c[0][0])/2,p=(c[3][1]+c[0][1])/2,g=f-m,n=g-5,i="right"):(f=(c[1][0]+c[2][0])/2,p=(c[1][1]+c[2][1])/2,g=f+m,n=g+5,i="left");var v=p;o=[[f,p],[g,v]],r=v;}h.label={linePoints:o,x:n,y:r,verticalAlign:"middle",textAlign:i,inside:d};});}var a=i(21),s=i(7),l=s.parsePercent;t.exports=function(t,e,i){t.eachSeriesByType("funnel",function(t){var i=t.getData(),a=t.get("sort"),u=n(t,e),h=r(i,a),c=[l(t.get("minSize"),u.width),l(t.get("maxSize"),u.width)],d=i.getDataExtent("value"),f=t.get("min"),p=t.get("max");null==f&&(f=Math.min(d[0],0)),null==p&&(p=d[1]);var g=t.get("funnelAlign"),m=t.get("gap"),v=(u.height-m*(i.count()-1))/i.count(),y=u.y,x=function x(t,e){var n,r=i.get("value",t)||0,o=s.linearMap(r,[f,p],c,!0);switch(g){case"left":n=u.x;break;case"center":n=u.x+(u.width-o)/2;break;case"right":n=u.x+u.width-o;}return[[n,e],[n+o,e]];};"ascending"===a&&(v=-v,m=-m,y+=u.height,h=h.reverse());for(var _=0;_<h.length;_++){var b=h[_],w=h[_+1],S=x(b,y),M=x(w,y+v);y+=v+m,i.setItemLayout(b,{points:S.concat(M.slice().reverse())});}o(i);});};},function(t,e,i){var n=i(1);i(225),i(236),i(237),n.registerVisual(i(238));},function(t,e,i){i(226),i(229),i(231);var n=i(1),r=i(4),o=5;n.extendComponentView({type:"parallel",render:function render(t,e,i){var n=i.getZr();if(!this.__onMouseDown){var a;n.on("mousedown",this.__onMouseDown=function(t){a=[t.offsetX,t.offsetY];}),n.on("mouseup",this.__onMouseUp=function(e){var n=[e.offsetX,e.offsetY],s=Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2);if(t.get("axisExpandable")&&!(s>o)){var l=t.coordinateSystem,u=l.findClosestAxisDim(n);if(u){var h=r.indexOf(l.dimensions,u);i.dispatchAction({type:"parallelAxisExpand",axisExpandCenter:h});}}});}},dispose:function dispose(t,e){e.getZr().off(this.__onMouseDown),e.getZr().off(this.__onMouseUp);}}),n.registerPreprocessor(i(235));},function(t,e,i){function n(t,e){var i=[];return t.eachComponent("parallel",function(n,o){var a=new r(n,t,e);a.name="parallel_"+o,a.resize(n,e),n.coordinateSystem=a,a.model=n,i.push(a);}),t.eachSeries(function(e){if("parallel"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"parallel",index:e.get("parallelIndex"),id:e.get("parallelId")})[0];e.coordinateSystem=i.coordinateSystem;}}),i;}var r=i(227);i(26).register("parallel",{create:n});},function(t,e,i){function n(t,e,i){this._axesMap={},this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,e,i);}var r=i(21),o=i(114),a=i(4),s=i(228),l=i(43),u=i(11),h=a.each,c=Math.PI;n.prototype={type:"parallel",constructor:n,_init:function _init(t,e,i){var n=t.dimensions,r=t.parallelAxisIndex;h(n,function(t,i){var n=r[i],a=e.getComponent("parallelAxis",n),l=this._axesMap[t]=new s(t,o.createScaleByModel(a),[0,0],a.get("type"),n),u="category"===l.type;l.onBand=u&&a.get("boundaryGap"),l.inverse=a.get("inverse"),a.axis=l,l.model=a;},this);},update:function update(t,e){this._updateAxesFromSeries(this._model,t);},_updateAxesFromSeries:function _updateAxesFromSeries(t,e){e.eachSeries(function(i){if(t.contains(i,e)){var n=i.getData();h(this.dimensions,function(t){var e=this._axesMap[t];e.scale.unionExtent(n.getDataExtent(t)),o.niceScaleExtent(e,e.model);},this);}},this);},resize:function resize(t,e){this._rect=r.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes(t);},getRect:function getRect(){return this._rect;},_layoutAxes:function _layoutAxes(t){var e=this._rect,i=t.get("layout"),n=this._axesMap,r=this.dimensions,o=[e.width,e.height],a="horizontal"===i?0:1,s=o[a],l=o[1-a],d=[0,l];h(n,function(t){var e=t.inverse?1:0;t.setExtent(d[e],d[1-e]);});var f,p=t.get("axisExpandable"),g=t.get("axisExpandWidth"),m=t.get("axisExpandCenter"),v=t.get("axisExpandCount")||0;if(null!=m){var y=Math.max(0,Math.floor(m-(v-1)/2)),x=y+v-1;x>=r.length&&(x=r.length-1,y=Math.max(0,Math.floor(x-v+1))),f=[y,x];}var _=p&&f&&g?function(t,e,i){var n,r=f[1]-f[0],o=(e-g*r)/(i-1-r);return n=t<f[0]?(t-1)*o:t<=f[1]?f[0]*o+(t-f[0])*g:t===i-1?e:f[0]*o+r*g+(t-f[1])*o,{position:n,axisNameAvailableWidth:f[0]<t&&t<f[1]?g:o};}:function(t,e,i){var n=e/(i-1);return{position:n*t,axisNameAvailableWidth:n};};h(r,function(t,n){var o=_(n,s,r.length),a={horizontal:{x:o.position,y:l},vertical:{x:0,y:o.position}},h={horizontal:c/2,vertical:0},d=[a[i].x+e.x,a[i].y+e.y],p=h[i],g=u.create();u.rotate(g,g,p),u.translate(g,g,d),this._axesLayout[t]={position:d,rotation:p,transform:g,axisNameAvailableWidth:o.axisNameAvailableWidth,tickDirection:1,labelDirection:1,axisExpandWindow:f};},this);},getAxis:function getAxis(t){return this._axesMap[t];},dataToPoint:function dataToPoint(t,e){return this.axisCoordToPoint(this._axesMap[e].dataToCoord(t),e);},eachActiveState:function eachActiveState(t,e,i){for(var n=this.dimensions,r=this._axesMap,o=this.hasAxisbrushed(),a=0,s=t.count();s>a;a++){var l,u=t.getValues(n,a);if(o){l="active";for(var h=0,c=n.length;c>h;h++){var d=n[h],f=r[d].model.getActiveState(u[h],h);if("inactive"===f){l="inactive";break;}}}else l="normal";e.call(i,l,a);}},hasAxisbrushed:function hasAxisbrushed(){for(var t=this.dimensions,e=this._axesMap,i=!1,n=0,r=t.length;r>n;n++){"normal"!==e[t[n]].model.getActiveState()&&(i=!0);}return i;},axisCoordToPoint:function axisCoordToPoint(t,e){var i=this._axesLayout[e];return l.applyTransform([t,0],i.transform);},getAxisLayout:function getAxisLayout(t){return a.clone(this._axesLayout[t]);},findClosestAxisDim:function findClosestAxisDim(t){var e,i=1/0;return a.each(this._axesLayout,function(n,r){var o=l.applyTransform(t,n.transform,!0),a=this._axesMap[r].getExtent();if(!(o[0]<a[0]||o[0]>a[1])){var s=Math.abs(o[1]);i>s&&(i=s,e=r);}},this),e;}},t.exports=n;},function(t,e,i){var n=i(4),r=i(123),o=function o(t,e,i,n,_o3){r.call(this,t,e,i),this.type=n||"value",this.axisIndex=_o3;};o.prototype={constructor:o,model:null},n.inherits(o,r),t.exports=o;},function(t,e,i){var n=i(4),r=i(19);i(230),r.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,parallelAxisDefault:null},init:function init(){r.prototype.init.apply(this,arguments),this.mergeOption({});},mergeOption:function mergeOption(t){var e=this.option;t&&n.merge(e,t,!0),this._initDimensions();},contains:function contains(t,e){var i=t.get("parallelIndex");return null!=i&&e.getComponent("parallel",i)===this;},setAxisExpand:function setAxisExpand(t){n.each(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth"],function(e){t.hasOwnProperty(e)&&(this.option[e]=t[e]);},this);},_initDimensions:function _initDimensions(){var t=this.dimensions=[],e=this.parallelAxisIndex=[],i=n.filter(this.dependentModels.parallelAxis,function(t){return t.get("parallelIndex")===this.componentIndex;});n.each(i,function(i){t.push("dim"+i.get("dim")),e.push(i.componentIndex);});}});},function(t,e,i){function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(4),a=i(15),s=i(127),l=i(7),u=r.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function getAreaSelectStyle(){return a([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]]).call(this.getModel("areaSelectStyle"));},setActiveIntervals:function setActiveIntervals(t){var e=this.activeIntervals=o.clone(t);if(e)for(var i=e.length-1;i>=0;i--){l.asc(e[i]);}},getActiveState:function getActiveState(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t)return"inactive";for(var i=0,n=e.length;n>i;i++){if(e[i][0]<=t&&t<=e[i][1])return"active";}return"inactive";}}),h={type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};o.merge(u.prototype,i(129)),s("parallel",u,n,h),t.exports=u;},function(t,e,i){i(226),i(232),i(233);},function(t,e,i){var n=i(1),r={type:"axisAreaSelect",event:"axisAreaSelected",update:"updateVisual"};n.registerAction(r,function(t,e){e.eachComponent({mainType:"parallelAxis",query:t},function(e){e.axis.model.setActiveIntervals(t.intervals);});}),n.registerAction("parallelAxisExpand",function(t,e){e.eachComponent({mainType:"parallel",query:t},function(e){e.setAxisExpand(t);});});},function(t,e,i){function n(t,e,i){return i&&"axisAreaSelect"===i.type&&e.findComponents({mainType:"parallelAxis",query:i})[0]===t;}var r=i(4),o=i(133),a=i(234),s=i(43),l=["axisLine","axisLabel","axisTick","axisName"],u=i(1).extendComponentView({type:"parallelAxis",init:function init(t,e){u.superApply(this,"init",arguments),(this._brushController=new a(e.getZr())).on("brush",r.bind(this._onBrush,this));},render:function render(t,e,i,a){if(!n(t,e,a)){this.axisModel=t,this.api=i,this.group.removeAll();var u=this._axisGroup;if(this._axisGroup=new s.Group(),this.group.add(this._axisGroup),t.get("show")){var h,c=e.getComponent("parallel",t.get("parallelIndex")).coordinateSystem,d=t.getAreaSelectStyle(),f=d.width,p=t.axis.dim,g=c.getAxisLayout(p),m=r.indexOf(c.dimensions,p),v=g.axisExpandWindow;v&&(m<=v[0]||m>=v[1])&&(h=!1);var y=r.extend({axisLabelShow:h,strokeContainThreshold:f},g),x=new o(t,y);r.each(l,x.add,x),this._axisGroup.add(x.getGroup()),this._refreshBrushController(y,d,t,f),s.groupTransition(u,this._axisGroup,t);}}},_refreshBrushController:function _refreshBrushController(t,e,i,n){var o=i.axis,a=r.map(i.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[o.dataToCoord(t[0],!0),o.dataToCoord(t[1],!0)]};}),l=o.getExtent(),u=l[1]-l[0],h=Math.min(30,.1*Math.abs(u)),c=s.BoundingRect.create({x:l[0],y:-n/2,width:u,height:n});c.x-=h,c.width+=2*h,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,position:t.position}).setPanels([{panelId:"pl",rect:c}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers(a);},_onBrush:function _onBrush(t,e){var i=this.axisModel,n=i.axis,o=r.map(t,function(t){return[n.coordToData(t.range[0],!0),n.coordToData(t.range[1],!0)];});(!i.option.realtime===e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:o});},dispose:function dispose(){this._brushController.dispose();}});t.exports=u;},function(t,e,i){function n(t){V.assert(t),N.call(this),this._zr=t,this.group=new G.Group(),this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,this._mounted,this._uid="brushController_"+it++,this._handlers={},Z(nt,function(t,e){this._handlers[e]=V.bind(t,this);},this);}function r(t,e){var i=t._zr;t._enableGlobalPan||F.take(i,K,t._uid),Z(t._handlers,function(t,e){i.on(e,t);}),t._brushType=e.brushType,t._brushOption=V.merge(V.clone(et),e,!0);}function o(t){var e=t._zr;F.release(e,K,t._uid),Z(t._handlers,function(t,i){e.off(i,t);}),t._brushType=t._brushOption=null;}function a(t,e){var i=rt[e.brushType].createCover(t,e);return u(i),i.__brushOption=e,t.group.add(i),i;}function s(t,e){var i=c(e);return i.endCreating&&(i.endCreating(t,e),u(e)),e;}function l(t,e){var i=e.__brushOption;c(e).updateCoverShape(t,e,i.range,i);}function u(t){t.traverse(function(t){t.z=Y,t.z2=Y;});}function h(t,e){c(e).updateCommon(t,e),l(t,e);}function c(t){return rt[t.__brushOption.brushType];}function d(t,e,i){var n=t._panels;if(!n)return!0;var r;return Z(n,function(t){t.contain(e,i)&&(r=t);}),r;}function f(t,e){var i=t._panels;if(!i)return!0;var n=e.__brushOption.panelId;return null!=n?i[n]:!0;}function p(t){var e=t._covers,i=e.length;return Z(e,function(e){t.group.remove(e);},t),e.length=0,!!i;}function g(t,e){var i=q(t._covers,function(t){var e=t.__brushOption,i=V.clone(e.range);return{brushType:e.brushType,panelId:e.panelId,range:i};});t.trigger("brush",i,{isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick});}function m(t){var e=t._track;if(!e.length)return!1;var i=e[e.length-1],n=e[0],r=i[0]-n[0],o=i[1]-n[1],a=X(r*r+o*o,.5);return a>$;}function v(t){var e=t.length-1;return 0>e&&(e=0),[t[0],t[e]];}function y(t,e,i,n){var r=new G.Group();return r.add(new G.Rect({name:"main",style:w(i),silent:!0,draggable:!0,cursor:"move",drift:W(t,e,r,"nswe"),ondragend:W(g,e,{isEnd:!0})})),Z(n,function(i){r.add(new G.Rect({name:i,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:W(t,e,r,i),ondragend:W(g,e,{isEnd:!0})}));}),r;}function x(t,e,i,n){var r=n.brushStyle.lineWidth||0,o=j(r,Q),a=i[0][0],s=i[1][0],l=a-r/2,u=s-r/2,h=i[0][1],c=i[1][1],d=h-o+r/2,f=c-o+r/2,p=h-a,g=c-s,m=p+r,v=g+r;b(t,e,"main",a,s,p,g),n.transformable&&(b(t,e,"w",l,u,o,v),b(t,e,"e",d,u,o,v),b(t,e,"n",l,u,m,o),b(t,e,"s",l,f,m,o),b(t,e,"nw",l,u,o,o),b(t,e,"ne",d,u,o,o),b(t,e,"sw",l,f,o,o),b(t,e,"se",d,f,o,o));}function _(t,e){var i=e.__brushOption,n=i.transformable,r=e.childAt(0);r.useStyle(w(i)),r.attr({silent:!n,cursor:n?"move":"default"}),Z(["w","e","n","s","se","sw","ne","nw"],function(i){var r=e.childOfName(i),o=I(t,i);r&&r.attr({silent:!n,invisible:!n,cursor:n?tt[o]+"-resize":null});});}function b(t,e,i,n,r,o,a){var s=e.childOfName(i);s&&s.setShape(D(C(t,e,[[n,r],[n+o,r+a]])));}function w(t){return V.defaults({strokeNoScale:!0},t.brushStyle);}function S(t,e,i,n){var r=[U(t,i),U(e,n)],o=[j(t,i),j(e,n)];return[[r[0],o[0]],[r[1],o[1]]];}function M(t){return G.getTransform(t.group);}function I(t,e){if(e.length>1){e=e.split("");var i=[I(t,e[0]),I(t,e[1])];return("e"===i[0]||"w"===i[0])&&i.reverse(),i.join("");}var n={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},i=G.transformDirection(n[e],M(t));return r[i];}function T(t,e,i,n,r,o,a,s){var l=n.__brushOption,u=t(l.range),c=L(i,o,a);Z(r.split(""),function(t){var e=J[t];u[e[0]][e[1]]+=c[e[0]];}),l.range=e(S(u[0][0],u[1][0],u[0][1],u[1][1])),h(i,n),g(i,{isEnd:!1});}function A(t,e,i,n,r){var o=e.__brushOption.range,a=L(t,i,n);Z(o,function(t){t[0]+=a[0],t[1]+=a[1];}),h(t,e),g(t,{isEnd:!1});}function L(t,e,i){var n=t.group,r=n.transformCoordToLocal(e,i),o=n.transformCoordToLocal(0,0);return[r[0]-o[0],r[1]-o[1]];}function C(t,e,i){var n=f(t,e);if(n===!0)return V.clone(i);var r=n.getBoundingRect();return V.map(i,function(t){var e=t[0];e=j(e,r.x),e=U(e,r.x+r.width);var i=t[1];return i=j(i,r.y),i=U(i,r.y+r.height),[e,i];});}function D(t){var e=U(t[0][0],t[1][0]),i=U(t[0][1],t[1][1]),n=j(t[0][0],t[1][0]),r=j(t[0][1],t[1][1]);return{x:e,y:i,width:n-e,height:r-i};}function P(t,e){var i=e.offsetX,n=e.offsetY,r=t._zr;if(t._brushType){for(var o,a=t._panels,s=t._covers,l=0;l<s.length;l++){if(rt[s[l].__brushOption.brushType].contain(s[l],i,n)){o=!0;break;}}o||(a?Z(a,function(t){t.contain(i,n)&&r.setCursorStyle("crosshair");}):r.setCursorStyle("crosshair"));}}function k(t){var e=t.event;e.preventDefault&&e.preventDefault();}function z(t,e,i){return t.childOfName("main").contain(e,i);}function O(t,e,i){var n,r=e.offsetX,o=e.offsetY,u=t._creatingCover,h=t._creatingPanel,c=t._brushOption;if(t._track.push(t.group.transformCoordToLocal(r,o)),m(t)||u){if(h&&!u){"single"===c.brushMode&&p(t);var f=V.clone(c);f.panelId=h===!0?null:h.__brushPanelId,u=t._creatingCover=a(t,f),t._covers.push(u);}if(u){var g=rt[t._brushType],v=u.__brushOption;v.range=g.getCreatingRange(C(t,u,t._track)),i&&(s(t,u),g.updateCommon(t,u)),l(t,u),n={isEnd:i};}}else i&&"single"===c.brushMode&&c.removeOnClick&&d(t,r,o)&&p(t)&&(n={isEnd:i,removeOnClick:!0});return n;}function E(t){if(this._dragging){k(t);var e=O(this,t,!0);this._dragging=!1,this._track=[],this._creatingCover=null,e&&g(this,e);}}function R(t){return{createCover:function createCover(e,i){return y(W(T,function(e){var i=[e,[0,100]];return t&&i.reverse(),i;},function(e){return e[t];}),e,i,[["w","e"],["n","s"]][t]);},getCreatingRange:function getCreatingRange(e){var i=v(e),n=U(i[0][t],i[1][t]),r=j(i[0][t],i[1][t]);return[n,r];},updateCoverShape:function updateCoverShape(e,i,n,r){var o,a=r.brushStyle.width;if(null==a){var s=f(e,i),l=0;if(s!==!0){var u=s.getBoundingRect();a=t?u.width:u.height,l=t?u.x:u.y;}o=[l,l+(a||0)];}else o=[-a/2,a/2];var h=[n,o];t&&h.reverse(),x(e,i,h,r);},updateCommon:_,contain:z};}var N=i(33),V=i(4),B=i(9),G=i(43),F=i(176),H=i(98),W=V.curry,Z=V.each,q=V.map,U=Math.min,j=Math.max,X=Math.pow,Y=1e4,$=6,Q=6,K="globalPan",J={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},tt={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},et={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},it=0;n.prototype={constructor:n,enableBrush:function enableBrush(t){return V.assert(this._mounted),this._brushType&&o(this),t.brushType&&r(this,t),this;},setPanels:function setPanels(t){var e=this._panels||{},i=this._panels=t&&t.length&&{},n=this.group;return i&&Z(t,function(t){var r=t.panelId,o=e[r];o||(o=new G.Rect({silent:!0,invisible:!0}),n.add(o));var a=t.rect;a instanceof B||(a=B.create(a)),o.attr("shape",a.plain()),o.__brushPanelId=r,i[r]=o,e[r]=null;}),Z(e,function(t){t&&n.remove(t);}),this;},mount:function mount(t){t=t||{},this._mounted=!0,this._enableGlobalPan=t.enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({position:t.position||[0,0],rotation:t.rotation||0,scale:t.scale||[1,1]}),this;},eachCover:function eachCover(t,e){Z(this._covers,t,e);},updateCovers:function updateCovers(t){function e(t,e){return(null!=t.id?t.id:o+e)+"-"+t.brushType;}function i(t,i){return e(t.__brushOption,i);}function n(e,i){var n=t[e];if(null!=i&&l[i]===d)u[e]=l[i];else{var r=u[e]=null!=i?(l[i].__brushOption=n,l[i]):s(c,a(c,n));h(c,r);}}function r(t){l[t]!==d&&c.group.remove(l[t]);}V.assert(this._mounted),t=V.map(t,function(t){return V.merge(V.clone(et),t,!0);});var o="\x00-brush-index-",l=this._covers,u=this._covers=[],c=this,d=this._creatingCover;return new H(l,t,i,e).add(n).update(n).remove(r).execute(),this;},unmount:function unmount(){return this.enableBrush(!1),p(this),this._zr.remove(this.group),this._mounted=!1,this;},dispose:function dispose(){this.unmount(),this.off();}},V.mixin(n,N);var nt={mousedown:function mousedown(t){if(this._dragging)E.call(this,t);else if(!t.target||!t.target.draggable){k(t);var e=t.offsetX,i=t.offsetY;this._creatingCover=null;var n=this._creatingPanel=d(this,e,i);n&&(this._dragging=!0,this._track=[this.group.transformCoordToLocal(e,i)]);}},mousemove:function mousemove(t){if(P(this,t),this._dragging){k(t);var e=O(this,t,!1);e&&g(this,e);}},mouseup:E},rt={lineX:R(0),lineY:R(1),rect:{createCover:function createCover(t,e){return y(W(T,function(t){return t;},function(t){return t;}),t,e,["w","e","n","s","se","sw","ne","nw"]);},getCreatingRange:function getCreatingRange(t){var e=v(t);return S(e[1][0],e[1][1],e[0][0],e[0][1]);},updateCoverShape:function updateCoverShape(t,e,i,n){x(t,e,i,n);},updateCommon:_,contain:z},polygon:{createCover:function createCover(t,e){var i=new G.Group();return i.add(new G.Polyline({name:"main",style:w(e),silent:!0})),i;},getCreatingRange:function getCreatingRange(t){return t;},endCreating:function endCreating(t,e){e.remove(e.childAt(0)),e.add(new G.Polygon({name:"main",draggable:!0,drift:W(A,t,e),ondragend:W(g,t,{isEnd:!0})}));},updateCoverShape:function updateCoverShape(t,e,i,n){e.childAt(0).setShape({points:C(t,e,i)});},updateCommon:_,contain:z}};t.exports=n;},function(t,e,i){function n(t){if(!t.parallel){var e=!1;o.each(t.series,function(t){t&&"parallel"===t.type&&(e=!0);}),e&&(t.parallel=[{}]);}}function r(t){var e=a.normalizeToArray(t.parallelAxis);o.each(e,function(e){if(o.isObject(e)){var i=e.parallelIndex||0,n=a.normalizeToArray(t.parallel)[i];n&&n.parallelAxisDefault&&o.merge(e,n.parallelAxisDefault,!1);}});}var o=i(4),a=i(5);t.exports=function(t){n(t),r(t);};},function(t,e,i){function n(t,e,i){var n=t.get("data"),o=r(e);n&&n.length&&s.each(i,function(t){if(t){var e=s.indexOf(n,t[o]);t[o]=e>=0?e:NaN;}});}function r(t){return+t.replace("dim","");}function o(t,e){var i=0;s.each(t,function(t){var e=r(t);e>i&&(i=e);});var n=e[0];n&&n.length-1>i&&(i=n.length-1);for(var o=[],a=0;i>=a;a++){o.push("dim"+a);}return o;}var a=i(97),s=i(4),l=i(28),u=i(102);t.exports=l.extend({type:"series.parallel",dependencies:["parallel"],getInitialData:function getInitialData(t,e){var i=e.getComponent("parallel",this.get("parallelIndex")),r=i.parallelAxisIndex,l=t.data,h=i.dimensions,c=o(h,l),d=s.map(c,function(t,i){var o=s.indexOf(h,t),a=o>=0&&e.getComponent("parallelAxis",r[o]);return a&&"category"===a.get("type")?(n(a,t,l),{name:t,type:"ordinal"}):0>o&&u.guessOrdinal(l,i)?{name:t,type:"ordinal"}:t;}),f=new a(d,this);return f.initData(l),this.option.progressive&&(this.option.animation=!1),f;},getRawIndicesByActiveState:function getRawIndicesByActiveState(t){var e=this.coordinateSystem,i=this.getData(),n=[];return e.eachActiveState(i,function(e,r){t===e&&n.push(i.getRawIndex(r));}),n;},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{normal:{show:!1},emphasis:{show:!1}},inactiveOpacity:.05,activeOpacity:1,lineStyle:{normal:{width:1,opacity:.45,type:"solid"}},progressive:!1,smooth:!1,animationEasing:"linear"}});},function(t,e,i){function n(t,e,i){var n=t.model,r=t.getRect(),o=new l.Rect({shape:{x:r.x,y:r.y,width:r.width,height:r.height}}),a="horizontal"===n.get("layout")?"width":"height";return o.setShape(a,0),l.initProps(o,{shape:{width:r.width,height:r.height}},e,i),o;}function r(t,e,i,n){for(var r=[],o=0;o<i.length;o++){var a=i[o],l=t.get(a,e);s(l,n.getAxis(a).type)||r.push(n.dataToPoint(l,a));}return r;}function o(t,e,i,n,o){var a=r(t,i,n,o),s=new l.Polyline({shape:{points:a},silent:!0,z2:10});e.add(s),t.setItemGraphicEl(i,s);}function a(t,e){var i=t.hostModel.getModel("lineStyle.normal"),n=i.getLineStyle();t.eachItemGraphicEl(function(r,o){if(t.hasItemOption){var a=t.getItemModel(o),s=a.getModel("lineStyle.normal",i);n=s.getLineStyle();}r.useStyle(u.extend(n,{fill:null,stroke:t.getItemVisual(o,"color"),opacity:t.getItemVisual(o,"opacity")})),r.shape.smooth=e;});}function s(t,e){return"category"===e?null==t:null==t||isNaN(t);}var l=i(43),u=i(4),h=.3,c=i(42).extend({type:"parallel",init:function init(){this._dataGroup=new l.Group(),this.group.add(this._dataGroup),this._data;},render:function render(t,e,i,n){this._renderForNormal(t);},dispose:function dispose(){},_renderForNormal:function _renderForNormal(t){function e(t){o(c,u,t,p,f,null,m);}function i(e,i){var n=d.getItemGraphicEl(i),o=r(c,e,p,f);c.setItemGraphicEl(e,n),l.updateProps(n,{shape:{points:o}},t,e);}function s(t){var e=d.getItemGraphicEl(t);u.remove(e);}var u=this._dataGroup,c=t.getData(),d=this._data,f=t.coordinateSystem,p=f.dimensions,g=t.option,m=g.smooth?h:null;if(c.diff(d).add(e).update(i).remove(s).execute(),a(c,m),!this._data){var v=n(f,t,function(){setTimeout(function(){u.removeClipPath();});});u.setClipPath(v);}this._data=c;},remove:function remove(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null;}});t.exports=c;},function(t,e){t.exports=function(t){t.eachSeriesByType("parallel",function(e){var i=e.getModel("itemStyle.normal"),n=e.getModel("lineStyle.normal"),r=t.get("color"),o=n.get("color")||i.get("color")||r[e.seriesIndex%r.length],a=e.get("inactiveOpacity"),s=e.get("activeOpacity"),l=e.getModel("lineStyle.normal").getLineStyle(),u=e.coordinateSystem,h=e.getData(),c={normal:l.opacity,active:s,inactive:a};u.eachActiveState(h,function(t,e){h.setItemVisual(e,"opacity",c[t]);}),h.setVisual("color",o);});};},function(t,e,i){var n=i(1);i(240),i(241),n.registerLayout(i(242)),n.registerVisual(i(244));},function(t,e,i){var n=i(28),r=i(197),o=n.extend({type:"series.sankey",layoutInfo:null,getInitialData:function getInitialData(t){var e=t.edges||t.links,i=t.data||t.nodes;if(i&&e){var n=r(i,e,this,!0);return n.data;}},getGraph:function getGraph(){return this.getData().graph;},getEdgeData:function getEdgeData(){return this.getGraph().edgeData;},formatTooltip:function formatTooltip(t,e,i){if("edge"===i){var n=this.getDataParams(t,i),r=n.data,a=r.source+" -- "+r.target;return n.value&&(a+=" : "+n.value),a;}return o.superCall(this,"formatTooltip",t,e);},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",nodeWidth:20,nodeGap:8,layoutIterations:32,label:{normal:{show:!0,position:"right",textStyle:{color:"#000",fontSize:12}},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:1,borderColor:"#333"}},lineStyle:{normal:{color:"#314656",opacity:.2,curveness:.5},emphasis:{opacity:.6}},animationEasing:"linear",animationDuration:1e3}});t.exports=o;},function(t,e,i){function n(t,e,i){var n=new r.Rect({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return r.initProps(n,{shape:{width:t.width+20,height:t.height+20}},e,i),n;}var r=i(43),o=i(4),a=r.extendShape({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0},buildPath:function buildPath(t,e){var i=e.extent/2;t.moveTo(e.x1,e.y1-i),t.bezierCurveTo(e.cpx1,e.cpy1-i,e.cpx2,e.cpy2-i,e.x2,e.y2-i),t.lineTo(e.x2,e.y2+i),t.bezierCurveTo(e.cpx2,e.cpy2+i,e.cpx1,e.cpy1+i,e.x1,e.y1+i),t.closePath();}});t.exports=i(1).extendChartView({type:"sankey",_model:null,render:function render(t,e,i){var s=t.getGraph(),l=this.group,u=t.layoutInfo,h=t.getData(),c=t.getData("edge");this._model=t,l.removeAll(),l.position=[u.x,u.y],s.eachEdge(function(e){var i=new a();i.dataIndex=e.dataIndex,i.seriesIndex=t.seriesIndex,i.dataType="edge";var n=e.getModel("lineStyle.normal"),o=n.get("curveness"),s=e.node1.getLayout(),u=e.node2.getLayout(),h=e.getLayout();i.shape.extent=Math.max(1,h.dy);var d=s.x+s.dx,f=s.y+h.sy+h.dy/2,p=u.x,g=u.y+h.ty+h.dy/2,m=d*(1-o)+p*o,v=f,y=d*o+p*(1-o),x=g;switch(i.setShape({x1:d,y1:f,x2:p,y2:g,cpx1:m,cpy1:v,cpx2:y,cpy2:x}),i.setStyle(n.getItemStyle()),i.style.fill){case"source":i.style.fill=e.node1.getVisual("color");break;case"target":i.style.fill=e.node2.getVisual("color");}r.setHoverStyle(i,e.getModel("lineStyle.emphasis").getItemStyle()),l.add(i),c.setItemGraphicEl(e.dataIndex,i);}),s.eachNode(function(e){var i=e.getLayout(),n=e.getModel(),a=n.getModel("label.normal"),s=a.getModel("textStyle"),u=n.getModel("label.emphasis"),c=u.getModel("textStyle"),d=new r.Rect({shape:{x:i.x,y:i.y,width:e.getLayout().dx,height:e.getLayout().dy},style:{text:a.get("show")?t.getFormattedLabel(e.dataIndex,"normal")||e.id:"",textFont:s.getFont(),textFill:s.getTextColor(),textPosition:a.get("position")}});d.setStyle(o.defaults({fill:e.getVisual("color")},n.getModel("itemStyle.normal").getItemStyle())),r.setHoverStyle(d,o.extend(e.getModel("itemStyle.emphasis"),{text:u.get("show")?t.getFormattedLabel(e.dataIndex,"emphasis")||e.id:"",textFont:c.getFont(),textFill:c.getTextColor(),textPosition:u.get("position")})),l.add(d),h.setItemGraphicEl(e.dataIndex,d),d.dataType="node";}),!this._data&&t.get("animation")&&l.setClipPath(n(l.getBoundingRect(),t,function(){l.removeClipPath();})),this._data=t.getData();},dispose:function dispose(){}});},function(t,e,i){function n(t,e){return M.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});}function r(t,e,i,n,r,o,s){a(t,i,r),u(t,e,o,n,s),m(t);}function o(t){T.each(t,function(t){var e=x(t.outEdges,S),i=x(t.inEdges,S),n=Math.max(e,i);t.setLayout({value:n},!0);});}function a(t,e,i){for(var n=t,r=null,o=0,a=0;n.length;){r=[];for(var u=0,h=n.length;h>u;u++){var c=n[u];c.setLayout({x:o},!0),c.setLayout({dx:e},!0);for(var d=0,f=c.outEdges.length;f>d;d++){r.push(c.outEdges[d].node2);}}n=r,++o;}s(t,o),a=(i-e)/(o-1),l(t,a);}function s(t,e){T.each(t,function(t){t.outEdges.length||t.setLayout({x:e-1},!0);});}function l(t,e){T.each(t,function(t){var i=t.getLayout().x*e;t.setLayout({x:i},!0);});}function u(t,e,i,n,r){var o=I().key(function(t){return t.getLayout().x;}).sortKeys(w).entries(t).map(function(t){return t.values;});h(t,o,e,i,n),c(o,n,i);for(var a=1;r>0;r--){a*=.99,d(o,a),c(o,n,i),p(o,a),c(o,n,i);}}function h(t,e,i,n,r){var o=[];T.each(e,function(t){var e=t.length,i=0;T.each(t,function(t){i+=t.getLayout().value;});var a=(n-(e-1)*r)/i;o.push(a);}),o.sort(function(t,e){return t-e;});var a=o[0];T.each(e,function(t){T.each(t,function(t,e){t.setLayout({y:e},!0);var i=t.getLayout().value*a;t.setLayout({dy:i},!0);});}),T.each(i,function(t){var e=+t.getValue()*a;t.setLayout({dy:e},!0);});}function c(t,e,i){T.each(t,function(t){var n,r,o,a=0,s=t.length;for(t.sort(b),o=0;s>o;o++){if(n=t[o],r=a-n.getLayout().y,r>0){var l=n.getLayout().y+r;n.setLayout({y:l},!0);}a=n.getLayout().y+n.getLayout().dy+e;}if(r=a-e-i,r>0){var l=n.getLayout().y-r;for(n.setLayout({y:l},!0),a=n.getLayout().y,o=s-2;o>=0;--o){n=t[o],r=n.getLayout().y+n.getLayout().dy+e-a,r>0&&(l=n.getLayout().y-r,n.setLayout({y:l},!0)),a=n.getLayout().y;}}});}function d(t,e){T.each(t.slice().reverse(),function(t){T.each(t,function(t){if(t.outEdges.length){var i=x(t.outEdges,f)/x(t.outEdges,S),n=t.getLayout().y+(i-_(t))*e;t.setLayout({y:n},!0);}});});}function f(t){return _(t.node2)*t.getValue();}function p(t,e){T.each(t,function(t){T.each(t,function(t){if(t.inEdges.length){var i=x(t.inEdges,g)/x(t.inEdges,S),n=t.getLayout().y+(i-_(t))*e;t.setLayout({y:n},!0);}});});}function g(t){return _(t.node1)*t.getValue();}function m(t){T.each(t,function(t){t.outEdges.sort(v),t.inEdges.sort(y);}),T.each(t,function(t){var e=0,i=0;T.each(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy;}),T.each(t.inEdges,function(t){t.setLayout({ty:i},!0),i+=t.getLayout().dy;});});}function v(t,e){return t.node2.getLayout().y-e.node2.getLayout().y;}function y(t,e){return t.node1.getLayout().y-e.node1.getLayout().y;}function x(t,e){for(var i=0,n=t.length,r=-1;++r<n;){var o=+e.call(t,t[r],r);isNaN(o)||(i+=o);}return i;}function _(t){return t.getLayout().y+t.getLayout().dy/2;}function b(t,e){return t.getLayout().y-e.getLayout().y;}function w(t,e){return e>t?-1:t>e?1:t===e?0:NaN;}function S(t){return t.getValue();}var M=i(21),I=i(243),T=i(4);t.exports=function(t,e,i){t.eachSeriesByType("sankey",function(t){var i=t.get("nodeWidth"),a=t.get("nodeGap"),s=n(t,e);t.layoutInfo=s;var l=s.width,u=s.height,h=t.getGraph(),c=h.nodes,d=h.edges;o(c);var f=c.filter(function(t){return 0===t.getLayout().value;}),p=0!==f.length?0:t.get("layoutIterations");r(c,d,i,a,l,u,p);});};},function(t,e,i){function n(){function t(e,n){if(n>=i.length)return e;for(var o=-1,a=e.length,s=i[n++],l={},u={};++o<a;){var h=s(e[o]),c=u[h];c?c.push(e[o]):u[h]=[e[o]];}return r.each(u,function(e,i){l[i]=t(e,n);}),l;}function e(t,o){if(o>=i.length)return t;var a=[],s=n[o++];return r.each(t,function(t,i){a.push({key:i,values:e(t,o)});}),s?a.sort(function(t,e){return s(t.key,e.key);}):a;}var i=[],n=[];return{key:function key(t){return i.push(t),this;},sortKeys:function sortKeys(t){return n[i.length-1]=t,this;},entries:function entries(i){return e(t(i,0),0);}};}var r=i(4);t.exports=n;},function(t,e,i){var n=i(193);t.exports=function(t,e){t.eachSeriesByType("sankey",function(t){var e=t.getGraph(),i=e.nodes;i.sort(function(t,e){return t.getLayout().value-e.getLayout().value;});var r=i[0].getLayout().value,o=i[i.length-1].getLayout().value;i.forEach(function(e){var i=new n({type:"color",mappingMethod:"linear",dataExtent:[r,o],visual:t.get("color")}),a=i.mapValueToVisual(e.getLayout().value);e.setVisual("color",a);var s=e.getModel(),l=s.get("itemStyle.normal.color");null!=l&&e.setVisual("color",l);});});};},function(t,e,i){var n=i(1);i(246),i(249),n.registerVisual(i(250)),n.registerLayout(i(251));},function(t,e,i){"use strict";var n=i(4),r=i(28),o=i(247),a=r.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],valueDimensions:["min","Q1","median","Q3","max"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{normal:{color:"#fff",borderWidth:1},emphasis:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}});n.mixin(a,o.seriesModelMixin,!0),t.exports=a;},function(t,e,i){"use strict";function n(t){return null==t.value?t:t.value;}var r=i(97),o=i(102),a=i(248),s=i(4),l={_baseAxisDim:null,getInitialData:function getInitialData(t,e){var i,a,s=e.getComponent("xAxis",this.get("xAxisIndex")),l=e.getComponent("yAxis",this.get("yAxisIndex")),u=s.get("type"),h=l.get("type");"category"===u?(t.layout="horizontal",i=s.getCategories(),a=!0):"category"===h?(t.layout="vertical",i=l.getCategories(),a=!0):t.layout=t.layout||"horizontal",this._baseAxisDim="horizontal"===t.layout?"x":"y";var c=t.data,d=this.dimensions=["base"].concat(this.valueDimensions);o(d,c);var f=new r(d,this);return f.initData(c,i?i.slice():null,function(t,e,i,r){var o=n(t);return a?"base"===e?i:o[r-1]:o[r];}),f;},coordDimToDataDim:function coordDimToDataDim(t){var e=this.valueDimensions.slice(),i=["base"],n={horizontal:{x:i,y:e},vertical:{x:e,y:i}};return n[this.get("layout")][t];},dataDimToCoordDim:function dataDimToCoordDim(t){var e;return s.each(["x","y"],function(i,n){var r=this.coordDimToDataDim(i);s.indexOf(r,t)>=0&&(e=i);},this),e;},getBaseAxis:function getBaseAxis(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis;}},u={init:function init(){var t=this._whiskerBoxDraw=new a(this.getStyleUpdater());this.group.add(t.group);},render:function render(t,e,i){this._whiskerBoxDraw.updateData(t.getData());},remove:function remove(t){this._whiskerBoxDraw.remove();}};t.exports={seriesModelMixin:l,viewMixin:u};},function(t,e,i){function n(t,e,i,n){l.Group.call(this),this.bodyIndex,this.whiskerIndex,this.styleUpdater=i,this._createContent(t,e,n),this.updateData(t,e,n),this._seriesModel;}function r(t,e,i){return s.map(t,function(t){return t=t.slice(),t[e]=i.initBaseline,t;});}function o(t){var e={};return s.each(t,function(t,i){e["ends"+i]=t;}),e;}function a(t){this.group=new l.Group(),this.styleUpdater=t;}var s=i(4),l=i(43),u=i(45),h=u.extend({type:"whiskerInBox",shape:{},buildPath:function buildPath(t,e){for(var i in e){if(e.hasOwnProperty(i)&&0===i.indexOf("ends")){var n=e[i];t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]);}}}}),c=n.prototype;c._createContent=function(t,e,i){var n=t.getItemLayout(e),a="horizontal"===n.chartLayout?1:0,u=0;this.add(new l.Polygon({shape:{points:i?r(n.bodyEnds,a,n):n.bodyEnds},style:{strokeNoScale:!0},z2:100})),this.bodyIndex=u++;var c=s.map(n.whiskerEnds,function(t){return i?r(t,a,n):t;});this.add(new h({shape:o(c),style:{strokeNoScale:!0},z2:100})),this.whiskerIndex=u++;},c.updateData=function(t,e,i){var n=this._seriesModel=t.hostModel,r=t.getItemLayout(e),a=l[i?"initProps":"updateProps"];a(this.childAt(this.bodyIndex),{shape:{points:r.bodyEnds}},n,e),a(this.childAt(this.whiskerIndex),{shape:o(r.whiskerEnds)},n,e),this.styleUpdater.call(null,this,t,e);},s.inherits(n,l.Group);var d=a.prototype;d.updateData=function(t){var e=this.group,i=this._data,r=this.styleUpdater;t.diff(i).add(function(i){if(t.hasValue(i)){var o=new n(t,i,r,!0);t.setItemGraphicEl(i,o),e.add(o);}}).update(function(o,a){var s=i.getItemGraphicEl(a);return t.hasValue(o)?(s?s.updateData(t,o):s=new n(t,o,r),e.add(s),void t.setItemGraphicEl(o,s)):void e.remove(s);}).remove(function(t){var n=i.getItemGraphicEl(t);n&&e.remove(n);}).execute(),this._data=t;},d.remove=function(){var t=this.group,e=this._data;this._data=null,e&&e.eachItemGraphicEl(function(e){e&&t.remove(e);});},t.exports=a;},function(t,e,i){"use strict";function n(t,e,i){var n=e.getItemModel(i),r=n.getModel(u),o=e.getItemVisual(i,"color"),s=r.getItemStyle(["borderColor"]),l=t.childAt(t.whiskerIndex);l.style.set(s),l.style.stroke=o,l.dirty();var c=t.childAt(t.bodyIndex);c.style.set(s),c.style.stroke=o,c.dirty();var d=n.getModel(h).getItemStyle();a.setHoverStyle(t,d);}var r=i(4),o=i(42),a=i(43),s=i(247),l=o.extend({type:"boxplot",getStyleUpdater:function getStyleUpdater(){return n;},dispose:r.noop});r.mixin(l,s.viewMixin,!0);var u=["itemStyle","normal"],h=["itemStyle","emphasis"];t.exports=l;},function(t,e){var i=["itemStyle","normal","borderColor"];t.exports=function(t,e){var n=t.get("color");t.eachRawSeriesByType("boxplot",function(e){var r=n[e.seriesIndex%n.length],o=e.getData();o.setVisual({legendSymbol:"roundRect",color:e.get(i)||r}),t.isSeriesFiltered(e)||o.each(function(t){var e=o.getItemModel(t);o.setItemVisual(t,{color:e.get(i,!0)});});});};},function(t,e,i){function n(t){var e=[],i=[];return t.eachSeriesByType("boxplot",function(t){var n=t.getBaseAxis(),r=a.indexOf(i,n);0>r&&(r=i.length,i[r]=n,e[r]={axis:n,seriesModels:[]}),e[r].seriesModels.push(t);}),e;}function r(t){var e,i,n=t.axis,r=t.seriesModels,o=r.length,s=t.boxWidthList=[],h=t.boxOffsetList=[],c=[];if("category"===n.type)i=n.getBandWidth();else{var d=0;u(r,function(t){d=Math.max(d,t.getData().count());}),e=n.getExtent(),Math.abs(e[1]-e[0])/d;}u(r,function(t){var e=t.get("boxWidth");a.isArray(e)||(e=[e,e]),c.push([l(e[0],i)||0,l(e[1],i)||0]);});var f=.8*i-2,p=f/o*.3,g=(f-p*(o-1))/o,m=g/2-f/2;u(r,function(t,e){h.push(m),m+=p+g,s.push(Math.min(Math.max(g,c[e][0]),c[e][1]));});}function o(t,e,i){var n=t.coordinateSystem,r=t.getData(),o=t.dimensions,a=t.get("layout"),s=i/2;r.each(o,function(){function t(t){var i=[];i[f]=c,i[p]=t;var r;return isNaN(c)||isNaN(t)?r=[NaN,NaN]:(r=n.dataToPoint(i),r[f]+=e),r;}function i(t,e){var i=t.slice(),n=t.slice();i[f]+=s,n[f]-=s,e?x.push(i,n):x.push(n,i);}function l(t){var e=[t.slice(),t.slice()];e[0][f]-=s,e[1][f]+=s,y.push(e);}var u=arguments,h=o.length,c=u[0],d=u[h],f="horizontal"===a?0:1,p=1-f,g=t(u[3]),m=t(u[1]),v=t(u[5]),y=[[m,t(u[2])],[v,t(u[4])]];l(m),l(v),l(g);var x=[];i(y[0][1],0),i(y[1][1],1),r.setItemLayout(d,{chartLayout:a,initBaseline:g[p],median:g,bodyEnds:x,whiskerEnds:y});});}var a=i(4),s=i(7),l=s.parsePercent,u=a.each;t.exports=function(t){var e=n(t);u(e,function(t){var e=t.seriesModels;e.length&&(r(t),u(e,function(e,i){o(e,t.boxOffsetList[i],t.boxWidthList[i]);}));});};},function(t,e,i){var n=i(1);i(253),i(254),n.registerPreprocessor(i(255)),n.registerVisual(i(256)),n.registerLayout(i(257));},function(t,e,i){"use strict";var n=i(4),r=i(28),o=i(247),a=i(6),s=a.encodeHTML,l=a.addCommas,u=r.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],valueDimensions:["open","close","lowest","highest"],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,itemStyle:{normal:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{borderWidth:2}},animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function getShadowDim(){return"open";},formatTooltip:function formatTooltip(t,e){var i=n.map(this.valueDimensions,function(e){return e+": "+l(this._data.get(e,t));},this);return s(this.name)+"<br />"+i.join("<br />");},brushSelector:function brushSelector(t,e){return e.rect(t.brushRect);}});n.mixin(u,o.seriesModelMixin,!0),t.exports=u;},function(t,e,i){"use strict";function n(t,e,i){var n=e.getItemModel(i),r=n.getModel(u),o=e.getItemVisual(i,"color"),s=e.getItemVisual(i,"borderColor")||o,l=r.getItemStyle(["color","color0","borderColor","borderColor0"]),c=t.childAt(t.whiskerIndex);c.useStyle(l),c.style.stroke=s;var d=t.childAt(t.bodyIndex);d.useStyle(l),d.style.fill=o,d.style.stroke=s;var f=n.getModel(h).getItemStyle();a.setHoverStyle(t,f);}var r=i(4),o=i(42),a=i(43),s=i(247),l=o.extend({type:"candlestick",getStyleUpdater:function getStyleUpdater(){return n;},dispose:r.noop});r.mixin(l,s.viewMixin,!0);var u=["itemStyle","normal"],h=["itemStyle","emphasis"];t.exports=l;},function(t,e,i){var n=i(4);t.exports=function(t){t&&n.isArray(t.series)&&n.each(t.series,function(t){n.isObject(t)&&"k"===t.type&&(t.type="candlestick");});};},function(t,e){var i=["itemStyle","normal","borderColor"],n=["itemStyle","normal","borderColor0"],r=["itemStyle","normal","color"],o=["itemStyle","normal","color0"];t.exports=function(t,e){t.eachRawSeriesByType("candlestick",function(e){var a=e.getData();a.setVisual({legendSymbol:"roundRect"}),t.isSeriesFiltered(e)||a.each(function(t){var e=a.getItemModel(t),s=a.getItemLayout(t).sign;a.setItemVisual(t,{color:e.get(s>0?r:o),borderColor:e.get(s>0?i:n)});});});};},function(t,e){function i(t,e){var i,a=t.getBaseAxis(),s="category"===a.type?a.getBandWidth():(i=a.getExtent(),Math.abs(i[1]-i[0])/e.count());return s/2-2>r?s/2-2:s-r>o?r:Math.max(s-o,n);}var n=2,r=5,o=4;t.exports=function(t){t.eachSeriesByType("candlestick",function(t){var e=t.coordinateSystem,n=t.getData(),r=t.dimensions,o=t.get("layout"),a=i(t,n);n.each(r,function(){function t(t){var i=[];return i[d]=h,i[f]=t,isNaN(h)||isNaN(t)?[NaN,NaN]:e.dataToPoint(i);}function i(t,e){var i=t.slice(),n=t.slice();i[d]+=a/2,n[d]-=a/2,e?I.push(i,n):I.push(n,i);}function s(){var e=t(Math.min(p,g,m,v)),i=t(Math.max(p,g,m,v));return e[d]-=a/2,i[d]-=a/2,{x:e[0],y:e[1],width:f?a:i[0]-e[0],height:f?i[1]-e[1]:a};}var l=arguments,u=r.length,h=l[0],c=l[u],d="horizontal"===o?0:1,f=1-d,p=l[1],g=l[2],m=l[3],v=l[4],y=Math.min(p,g),x=Math.max(p,g),_=t(y),b=t(x),w=t(m),S=t(v),M=[[S,b],[w,_]],I=[];i(b,0),i(_,1),n.setItemLayout(c,{chartLayout:o,sign:p>g?-1:g>p?1:0,initBaseline:p>g?b[f]:_[f],bodyEnds:I,whiskerEnds:M,brushRect:s()});},!0);});};},function(t,e,i){var n=i(4),r=i(1);i(259),i(260),r.registerVisual(n.curry(i(109),"effectScatter","circle",null)),r.registerLayout(n.curry(i(110),"effectScatter"));},function(t,e,i){"use strict";var n=i(101),r=i(28);t.exports=r.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function getInitialData(t,e){var i=n(t.data,this,e);return i;},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});},function(t,e,i){var n=i(104),r=i(261);i(1).extendChartView({type:"effectScatter",init:function init(){this._symbolDraw=new n(r);},render:function render(t,e,i){var n=t.getData(),r=this._symbolDraw;r.updateData(n),this.group.add(r.group);},updateLayout:function updateLayout(){this._symbolDraw.updateLayout();},remove:function remove(t,e){this._symbolDraw&&this._symbolDraw.remove(e);},dispose:function dispose(){}});},function(t,e,i){function n(t){return a.isArray(t)||(t=[+t,+t]),t;}function r(t,e){t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?e.color:null,fill:"fill"===e.brushType?e.color:null}});});}function o(t,e){c.call(this);var i=new h(t,e),n=new c();this.add(i),this.add(n),n.beforeUpdate=function(){this.attr(i.getScale());},this.updateData(t,e);}var a=i(4),s=i(106),l=i(43),u=i(7),h=i(105),c=l.Group,d=3,f=o.prototype;f.stopEffectAnimation=function(){this.childAt(1).removeAll();},f.startEffectAnimation=function(t){for(var e=t.symbolType,i=t.color,n=this.childAt(1),o=0;d>o;o++){var a=s.createSymbol(e,-1,-1,2,2,i);a.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var l=-o/d*t.period+t.effectOffset;a.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(l).start(),a.animateStyle(!0).when(t.period,{opacity:0}).delay(l).start(),n.add(a);}r(n,t);},f.updateEffectAnimation=function(t){for(var e=this._effectCfg,i=this.childAt(1),n=["symbolType","period","rippleScale"],o=0;n>o;o++){var a=n[o];if(e[a]!==t[a])return this.stopEffectAnimation(),void this.startEffectAnimation(t);}r(i,t);},f.highlight=function(){this.trigger("emphasis");},f.downplay=function(){this.trigger("normal");},f.updateData=function(t,e){var i=t.hostModel;this.childAt(0).updateData(t,e);var r=this.childAt(1),o=t.getItemModel(e),a=t.getItemVisual(e,"symbol"),s=n(t.getItemVisual(e,"symbolSize")),l=t.getItemVisual(e,"color");r.attr("scale",s),r.traverse(function(t){t.attr({fill:l});});var h=o.getShallow("symbolOffset");if(h){var c=r.position;c[0]=u.parsePercent(h[0],s[0]),c[1]=u.parsePercent(h[1],s[1]);}r.rotation=(o.getShallow("symbolRotate")||0)*Math.PI/180||0;var d={};if(d.showEffectOn=i.get("showEffectOn"),d.rippleScale=o.get("rippleEffect.scale"),d.brushType=o.get("rippleEffect.brushType"),d.period=1e3*o.get("rippleEffect.period"),d.effectOffset=e/t.count(),d.z=o.getShallow("z")||0,d.zlevel=o.getShallow("zlevel")||0,d.symbolType=a,d.color=l,this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===d.showEffectOn)this._effectCfg?this.updateEffectAnimation(d):this.startEffectAnimation(d),this._effectCfg=d;else{this._effectCfg=null,this.stopEffectAnimation();var f=this.childAt(0),p=function p(){f.trigger("emphasis"),"render"!==d.showEffectOn&&this.startEffectAnimation(d);},g=function g(){f.trigger("normal"),"render"!==d.showEffectOn&&this.stopEffectAnimation();};this.on("mouseover",p,this).on("mouseout",g,this).on("emphasis",p,this).on("normal",g,this);}this._effectCfg=d;},f.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t();},a.inherits(o,c),t.exports=o;},function(t,e,i){i(263),i(264);var n=i(1);n.registerLayout(i(269));},function(t,e,i){"use strict";function n(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(console.warn("Lines data configuration has been changed to { coords:[[1,2],[2,3]] }"),t.data=a.map(e,function(t){var e=[t[0].coord,t[1].coord],i={coords:e};return t[0].name&&(i.fromName=t[0].name),t[1].name&&(i.toName=t[1].name),a.mergeAll([i,t[0],t[1]]);}));}var r=i(28),o=i(97),a=i(4),s=i(26),l=r.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.normal.color",init:function init(t){n(t),l.superApply(this,"init",arguments);},mergeOption:function mergeOption(t){n(t),l.superApply(this,"mergeOption",arguments);},getInitialData:function getInitialData(t,e){var i=s.get(t.coordinateSystem);if(!i)throw new Error("Unkown coordinate system "+t.coordinateSystem);var n=new o(["value"],this);return n.hasItemOption=!1,n.initData(t.data,[],function(t,e,i,r){if(t instanceof Array)return NaN;n.hasItemOption=!0;var o=t.value;return null!=o?o instanceof Array?o[r]:o:void 0;}),n;},formatTooltip:function formatTooltip(t){var e=this.getData(),i=e.getItemModel(t),n=i.get("name");if(n)return n;var r=i.get("fromName"),o=i.get("toName");return r+" > "+o;},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,label:{normal:{show:!1,position:"end"}},lineStyle:{normal:{opacity:.5}}}});},function(t,e,i){var n=i(200),r=i(265),o=i(201),a=i(266),s=i(267),l=i(268);i(1).extendChartView({type:"lines",init:function init(){},render:function render(t,e,i){var u=t.getData(),h=this._lineDraw,c=t.get("effect.show"),d=t.get("polyline"),f=t.get("large")&&u.count()>=t.get("largeThreshold");c&&f&&console.warn("Large lines not support effect"),(c!==this._hasEffet||d!==this._isPolyline||f!==this._isLarge)&&(h&&h.remove(),h=this._lineDraw=f?new l():new n(d?c?s:a:c?r:o),this._hasEffet=c,this._isPolyline=d,this._isLarge=f);var p=t.get("zlevel"),g=t.get("effect.trailLength"),m=i.getZr();if(m.painter.getLayer(p).clear(!0),null!=this._lastZlevel&&m.configLayer(this._lastZlevel,{motionBlur:!1}),c&&g){var v=!1;e.eachSeries(function(e){e!==t&&e.get("zlevel")===p&&(v=!0);}),v&&console.warn("Lines with trail effect should have an individual zlevel"),m.configLayer(p,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(g/10+.9,1),0)});}this.group.add(h.group),h.updateData(u),this._lastZlevel=p;},updateLayout:function updateLayout(t,e,i){this._lineDraw.updateLayout(t);var n=i.getZr();n.painter.getLayer(this._lastZlevel).clear(!0);},remove:function remove(t,e){this._lineDraw&&this._lineDraw.remove(e,!0);},dispose:function dispose(){}});},function(t,e,i){function n(t,e,i){r.Group.call(this),this.add(this.createLine(t,e,i)),this._updateEffectSymbol(t,e);}var r=i(43),o=i(201),a=i(4),s=i(106),l=i(10),u=i(50),h=n.prototype;h.createLine=function(t,e,i){return new o(t,e,i);},h._updateEffectSymbol=function(t,e){var i=t.getItemModel(e),n=i.getModel("effect"),r=n.get("symbolSize"),o=n.get("symbol");a.isArray(r)||(r=[r,r]);var l=n.get("color")||t.getItemVisual(e,"color"),u=this.childAt(1);this._symbolType!==o&&(this.remove(u),u=s.createSymbol(o,-.5,-.5,1,1,l),u.z2=100,u.culling=!0,this.add(u)),u&&(u.setStyle("shadowColor",l),u.setStyle(n.getItemStyle(["color"])),u.attr("scale",r),u.setColor(l),u.attr("scale",r),this._symbolType=o,this._updateEffectAnimation(t,n,e));},h._updateEffectAnimation=function(t,e,i){var n=this.childAt(1);if(n){var r=this,o=t.getItemLayout(i),s=1e3*e.get("period"),l=e.get("loop"),u=e.get("constantSpeed"),h=a.retrieve(e.get("delay"),function(e){return e/t.count()*s/3;}),c="function"==typeof h;if(n.ignore=!0,this.updateAnimationPoints(n,o),u>0&&(s=this.getLineLength(n)/u*1e3),s!==this._period||l!==this._loop){n.stopAnimation();var d=h;c&&(d=h(i)),n.__t>0&&(d=-s*n.__t),n.__t=0;var f=n.animate("",l).when(s,{__t:1}).delay(d).during(function(){r.updateSymbolPosition(n);});l||f.done(function(){r.remove(n);}),f.start();}this._period=s,this._loop=l;}},h.getLineLength=function(t){return l.dist(t.__p1,t.__cp1)+l.dist(t.__cp1,t.__p2);},h.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];},h.updateData=function(t,e,i){this.childAt(0).updateData(t,e,i),this._updateEffectSymbol(t,e);},h.updateSymbolPosition=function(t){var e=t.__p1,i=t.__p2,n=t.__cp1,r=t.__t,o=t.position,a=u.quadraticAt,s=u.quadraticDerivativeAt;o[0]=a(e[0],n[0],i[0],r),o[1]=a(e[1],n[1],i[1],r);var l=s(e[0],n[0],i[0],r),h=s(e[1],n[1],i[1],r);t.rotation=-Math.atan2(h,l)-Math.PI/2,t.ignore=!1;},h.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var i=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,i,e);},a.inherits(n,r.Group),t.exports=n;},function(t,e,i){function n(t,e,i){r.Group.call(this),this._createPolyline(t,e,i);}var r=i(43),o=i(4),a=n.prototype;a._createPolyline=function(t,e,i){var n=t.getItemLayout(e),o=new r.Polyline({shape:{points:n}});this.add(o),this._updateCommonStl(t,e,i);},a.updateData=function(t,e,i){var n=t.hostModel,o=this.childAt(0),a={shape:{points:t.getItemLayout(e)}};r.updateProps(o,a,n,e),this._updateCommonStl(t,e,i);},a._updateCommonStl=function(t,e,i){var n=this.childAt(0),a=t.getItemModel(e),s=t.getItemVisual(e,"color"),l=i&&i.lineStyle,u=i&&i.hoverLineStyle;(!i||t.hasItemOption)&&(l=a.getModel("lineStyle.normal").getLineStyle(),u=a.getModel("lineStyle.emphasis").getLineStyle()),n.useStyle(o.defaults({strokeNoScale:!0,fill:"none",stroke:s},l)),n.hoverStyle=u,r.setHoverStyle(this);},a.updateLayout=function(t,e){var i=this.childAt(0);i.setShape("points",t.getItemLayout(e));},o.inherits(n,r.Group),t.exports=n;},function(t,e,i){function n(t,e,i){a.call(this,t,e,i),this._lastFrame=0,this._lastFramePercent=0;}var r=i(266),o=i(4),a=i(265),s=i(10),l=n.prototype;l.createLine=function(t,e,i){return new r(t,e,i);},l.updateAnimationPoints=function(t,e){this._points=e;for(var i=[0],n=0,r=1;r<e.length;r++){var o=e[r-1],a=e[r];n+=s.dist(o,a),i.push(n);}if(0!==n){for(var r=0;r<i.length;r++){i[r]/=n;}this._offsets=i,this._length=n;}},l.getLineLength=function(t){return this._length;},l.updateSymbolPosition=function(t){var e=t.__t,i=this._points,n=this._offsets,r=i.length;if(n){var o,a=this._lastFrame;if(e<this._lastFramePercent){var l=Math.min(a+1,r-1);for(o=l;o>=0&&!(n[o]<=e);o--){}o=Math.min(o,r-2);}else{for(var o=a;r>o&&!(n[o]>e);o++){}o=Math.min(o-1,r-2);}s.lerp(t.position,i[o],i[o+1],(e-n[o])/(n[o+1]-n[o]));var u=i[o+1][0]-i[o][0],h=i[o+1][1]-i[o][1];t.rotation=-Math.atan2(h,u)-Math.PI/2,this._lastFrame=o,this._lastFramePercent=e,t.ignore=!1;}},o.inherits(n,a),t.exports=n;},function(t,e,i){function n(){this.group=new r.Group(),this._lineEl=new s();}var r=i(43),o=i(55),a=i(53),s=r.extendShape({shape:{polyline:!1,segs:[]},buildPath:function buildPath(t,e){for(var i=e.segs,n=e.polyline,r=0;r<i.length;r++){var o=i[r];if(n){t.moveTo(o[0][0],o[0][1]);for(var a=1;a<o.length;a++){t.lineTo(o[a][0],o[a][1]);}}else t.moveTo(o[0][0],o[0][1]),o.length>2?t.quadraticCurveTo(o[2][0],o[2][1],o[1][0],o[1][1]):t.lineTo(o[1][0],o[1][1]);}},findDataIndex:function findDataIndex(t,e){for(var i=this.shape,n=i.segs,r=i.polyline,s=Math.max(this.style.lineWidth,1),l=0;l<n.length;l++){var u=n[l];if(r){for(var h=1;h<u.length;h++){if(a.containStroke(u[h-1][0],u[h-1][1],u[h][0],u[h][1],s,t,e))return l;}}else if(u.length>2){if(o.containStroke(u[0][0],u[0][1],u[2][0],u[2][1],u[1][0],u[1][1],s,t,e))return l;}else if(a.containStroke(u[0][0],u[0][1],u[1][0],u[1][1],s,t,e))return l;}return-1;}}),l=n.prototype;l.updateData=function(t){this.group.removeAll();var e=this._lineEl,i=t.hostModel;e.setShape({segs:t.mapArray(t.getItemLayout),polyline:i.get("polyline")}),e.useStyle(i.getModel("lineStyle.normal").getLineStyle());var n=t.getVisual("color");n&&e.setStyle("stroke",n),e.setStyle("fill"),e.seriesIndex=i.seriesIndex,e.on("mousemove",function(t){e.dataIndex=null;var i=e.findDataIndex(t.offsetX,t.offsetY);i>0&&(e.dataIndex=i);}),this.group.add(e);},l.updateLayout=function(t){var e=t.getData();this._lineEl.setShape({segs:e.mapArray(e.getItemLayout)});},l.remove=function(){this.group.removeAll();},t.exports=n;},function(t,e,i){t.exports=function(t){t.eachSeriesByType("lines",function(t){var e=t.coordinateSystem,i=t.getData();i.each(function(n){var r=i.getItemModel(n),o=r.option instanceof Array?r.option:r.get("coords");if(!(o instanceof Array&&o.length>0&&o[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(o)+". Lines must have 2d coords array in data item.");var a=[];if(t.get("polyline"))for(var s=0;s<o.length;s++){a.push(e.dataToPoint(o[s]));}else{a[0]=e.dataToPoint(o[0]),a[1]=e.dataToPoint(o[1]);var l=r.get("lineStyle.normal.curveness");+l&&(a[2]=[(a[0][0]+a[1][0])/2-(a[0][1]-a[1][1])*l,(a[0][1]+a[1][1])/2-(a[1][0]-a[0][0])*l]);}i.setItemLayout(n,a);});});};},function(t,e,i){i(271),i(272);},function(t,e,i){var n=i(28),r=i(101);t.exports=n.extend({type:"series.heatmap",getInitialData:function getInitialData(t,e){return r(t.data,this,e);},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}});},function(t,e,i){function n(t,e,i){var n=t[1]-t[0];e=l.map(e,function(e){return{interval:[(e.interval[0]-t[0])/n,(e.interval[1]-t[0])/n]};});var r=e.length,o=0;return function(t){for(var n=o;r>n;n++){var a=e[n].interval;if(a[0]<=t&&t<=a[1]){o=n;break;}}if(n===r)for(var n=o-1;n>=0;n--){var a=e[n].interval;if(a[0]<=t&&t<=a[1]){o=n;break;}}return n>=0&&r>n&&i[n];};}function r(t,e){var i=t[1]-t[0];return e=[(e[0]-t[0])/i,(e[1]-t[0])/i],function(t){return t>=e[0]&&t<=e[1];};}function o(t){var e=t.dimensions;return"lng"===e[0]&&"lat"===e[1];}var a=i(43),s=i(273),l=i(4);t.exports=i(1).extendChartView({type:"heatmap",render:function render(t,e,i){var n;if(e.eachComponent("visualMap",function(e){e.eachTargetSeries(function(i){i===t&&(n=e);});}),!n)throw new Error("Heatmap must use with visualMap");this.group.removeAll();var r=t.coordinateSystem;"cartesian2d"===r.type?this._renderOnCartesian(r,t,i):o(r)&&this._renderOnGeo(r,t,n,i);},dispose:function dispose(){},_renderOnCartesian:function _renderOnCartesian(t,e,i){var n=t.getAxis("x"),r=t.getAxis("y"),o=this.group;if("category"!==n.type||"category"!==r.type)throw new Error("Heatmap on cartesian must have two category axes");if(!n.onBand||!r.onBand)throw new Error("Heatmap on cartesian must have two axes with boundaryGap true");var s=n.getBandWidth(),u=r.getBandWidth(),h=e.getData(),c="itemStyle.normal",d="itemStyle.emphasis",f="label.normal",p="label.emphasis",g=e.getModel(c).getItemStyle(["color"]),m=e.getModel(d).getItemStyle(),v=e.getModel("label.normal"),y=e.getModel("label.emphasis");h.each(["x","y","z"],function(i,n,r,x){var _=h.getItemModel(x),b=t.dataToPoint([i,n]);if(!isNaN(r)){var w=new a.Rect({shape:{x:b[0]-s/2,y:b[1]-u/2,width:s,height:u},style:{fill:h.getItemVisual(x,"color"),opacity:h.getItemVisual(x,"opacity")}});h.hasItemOption&&(g=_.getModel(c).getItemStyle(["color"]),m=_.getModel(d).getItemStyle(),v=_.getModel(f),y=_.getModel(p));var S=e.getRawValue(x),M="-";S&&null!=S[2]&&(M=S[2]),v.getShallow("show")&&(a.setText(g,v),g.text=e.getFormattedLabel(x,"normal")||M),y.getShallow("show")&&(a.setText(m,y),m.text=e.getFormattedLabel(x,"emphasis")||M),w.setStyle(g),a.setHoverStyle(w,h.hasItemOption?m:l.extend({},m)),o.add(w),h.setItemGraphicEl(x,w);}});},_renderOnGeo:function _renderOnGeo(t,e,i,o){var l=i.targetVisuals.inRange,u=i.targetVisuals.outOfRange,h=e.getData(),c=this._hmLayer||this._hmLayer||new s();c.blurSize=e.get("blurSize"),c.pointSize=e.get("pointSize"),c.minOpacity=e.get("minOpacity"),c.maxOpacity=e.get("maxOpacity");var d=t.getViewRect().clone(),f=t.getRoamTransform().transform;d.applyTransform(f);var p=Math.max(d.x,0),g=Math.max(d.y,0),m=Math.min(d.width+d.x,o.getWidth()),v=Math.min(d.height+d.y,o.getHeight()),y=m-p,x=v-g,_=h.mapArray(["lng","lat","value"],function(e,i,n){var r=t.dataToPoint([e,i]);return r[0]-=p,r[1]-=g,r.push(n),r;}),b=i.getExtent(),w="visualMap.continuous"===i.type?r(b,i.option.range):n(b,i.getPieceList(),i.option.selected);c.update(_,y,x,l.color.getNormalizer(),{inRange:l.color.getColorMapper(),outOfRange:u.color.getColorMapper()},w);var S=new a.Image({style:{width:y,height:x,x:p,y:g,image:c.canvas},silent:!0});this.group.add(S);}});},function(t,e,i){function n(){var t=o.createCanvas();this.canvas=t,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={};}var r=256,o=i(4);n.prototype={update:function update(t,e,i,n,o,a){var s=this._getBrush(),l=this._getGradient(t,o,"inRange"),u=this._getGradient(t,o,"outOfRange"),h=this.pointSize+this.blurSize,c=this.canvas,d=c.getContext("2d"),f=t.length;c.width=e,c.height=i;for(var p=0;f>p;++p){var g=t[p],m=g[0],v=g[1],y=g[2],x=n(y);d.globalAlpha=x,d.drawImage(s,m-h,v-h);}for(var _=d.getImageData(0,0,c.width,c.height),b=_.data,w=0,S=b.length,M=this.minOpacity,I=this.maxOpacity,T=I-M;S>w;){var x=b[w+3]/256,A=4*Math.floor(x*(r-1));if(x>0){var L=a(x)?l:u;x>0&&(x=x*T+M),b[w++]=L[A],b[w++]=L[A+1],b[w++]=L[A+2],b[w++]=L[A+3]*x*256;}else w+=4;}return d.putImageData(_,0,0),c;},_getBrush:function _getBrush(){var t=this._brushCanvas||(this._brushCanvas=o.createCanvas()),e=this.pointSize+this.blurSize,i=2*e;t.width=i,t.height=i;var n=t.getContext("2d");return n.clearRect(0,0,i,i),n.shadowOffsetX=i,n.shadowBlur=this.blurSize,n.shadowColor="#000",n.beginPath(),n.arc(-e,e,this.pointSize,0,2*Math.PI,!0),n.closePath(),n.fill(),t;},_getGradient:function _getGradient(t,e,i){for(var n=this._gradientPixels,r=n[i]||(n[i]=new Uint8ClampedArray(1024)),o=[],a=0,s=0;256>s;s++){e[i](s/255,!0,o),r[a++]=o[0],r[a++]=o[1],r[a++]=o[2],r[a++]=o[3];}return r;}},t.exports=n;},function(t,e,i){i(275),i(276),i(277);var n=i(1);n.registerProcessor(i(279));},function(t,e,i){"use strict";var n=i(4),r=i(12),o=i(1).extendComponentModel({type:"legend",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function init(t,e,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{};},mergeOption:function mergeOption(t){o.superCall(this,"mergeOption",t);},optionUpdated:function optionUpdated(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,i=0;i<t.length;i++){var n=t[i].get("name");if(this.isSelected(n)){this.select(n),e=!0;break;}}!e&&this.select(t[0].get("name"));}},_updateData:function _updateData(t){var e=n.map(this.get("data")||[],function(t){return("string"==typeof t||"number"==typeof t)&&(t={name:t}),new r(t,this,this.ecModel);},this);this._data=e;var i=n.map(t.getSeries(),function(t){return t.name;});t.eachSeries(function(t){if(t.legendDataProvider){var e=t.legendDataProvider();i=i.concat(e.mapArray(e.getName));}}),this._availableNames=i;},getData:function getData(){return this._data;},select:function select(t){var e=this.option.selected,i=this.get("selectedMode");if("single"===i){var r=this._data;n.each(r,function(t){e[t.get("name")]=!1;});}e[t]=!0;},unSelect:function unSelect(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1);},toggleSelected:function toggleSelected(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t);},isSelected:function isSelected(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&n.indexOf(this._availableNames,t)>=0;},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:"top",align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",textStyle:{color:"#333"},selectedMode:!0,tooltip:{show:!1}}});t.exports=o;},function(t,e,i){function n(t,e,i){var n,r={},a="toggleSelected"===t;return i.eachComponent("legend",function(i){a&&null!=n?i[n?"select":"unSelect"](e.name):(i[t](e.name),n=i.isSelected(e.name));var s=i.getData();o.each(s,function(t){var e=t.get("name");if("\n"!==e&&""!==e){var n=i.isSelected(e);e in r?r[e]=r[e]&&n:r[e]=n;}});}),{name:e.name,selected:r};}var r=i(1),o=i(4);r.registerAction("legendToggleSelect","legendselectchanged",o.curry(n,"toggleSelected")),r.registerAction("legendSelect","legendselected",o.curry(n,"select")),r.registerAction("legendUnSelect","legendunselected",o.curry(n,"unSelect"));},function(t,e,i){function n(t,e){e.dispatchAction({type:"legendToggleSelect",name:t});}function r(t,e,i){var n=i.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||t.get("legendHoverLink")&&i.dispatchAction({type:"highlight",seriesName:t.name,name:e});}function o(t,e,i){var n=i.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||t.get("legendHoverLink")&&i.dispatchAction({type:"downplay",seriesName:t.name,name:e});}var a=i(4),s=i(106),l=i(43),u=i(278),h=a.curry;t.exports=i(1).extendComponentView({type:"legend",init:function init(){this._symbolTypeStore={};},render:function render(t,e,i){var s=this.group;if(s.removeAll(),t.get("show")){var c=t.get("selectedMode"),d=t.get("align");"auto"===d&&(d="right"===t.get("left")&&"vertical"===t.get("orient")?"right":"left");var f={};a.each(t.getData(),function(a){var u=a.get("name");if(""===u||"\n"===u)return void s.add(new l.Group({newline:!0}));var p=e.getSeriesByName(u)[0];if(!f[u]){if(p){var g=p.getData(),m=g.getVisual("color");"function"==typeof m&&(m=m(p.getDataParams(0)));var v=g.getVisual("legendSymbol")||"roundRect",y=g.getVisual("symbol"),x=this._createItem(u,a,t,v,y,d,m,c);x.on("click",h(n,u,i)).on("mouseover",h(r,p,null,i)).on("mouseout",h(o,p,null,i)),f[u]=!0;}else e.eachRawSeries(function(e){if(!f[u]&&e.legendDataProvider){var s=e.legendDataProvider(),l=s.indexOfName(u);if(0>l)return;var p=s.getItemVisual(l,"color"),g="roundRect",m=this._createItem(u,a,t,g,null,d,p,c);m.on("click",h(n,u,i)).on("mouseover",h(r,e,u,i)).on("mouseout",h(o,e,u,i)),f[u]=!0;}},this);f[u]||console.warn(u+" series not exists. Legend data should be same with series name or data name.");}},this),u.layout(s,t,i),u.addBackground(s,t);}},_createItem:function _createItem(t,e,i,n,r,o,u,h){var c=i.get("itemWidth"),d=i.get("itemHeight"),f=i.get("inactiveColor"),p=i.isSelected(t),g=new l.Group(),m=e.getModel("textStyle"),v=e.get("icon"),y=e.getModel("tooltip"),x=y.parentModel;if(n=v||n,g.add(s.createSymbol(n,0,0,c,d,p?u:f)),!v&&r&&(r!==n||"none"==r)){var _=.8*d;"none"===r&&(r="circle"),g.add(s.createSymbol(r,(c-_)/2,(d-_)/2,_,_,p?u:f));}var b="left"===o?c+5:-5,w=o,S=i.get("formatter"),M=t;"string"==typeof S&&S?M=S.replace("{name}",t):"function"==typeof S&&(M=S(t));var I=new l.Text({style:{text:M,x:b,y:d/2,fill:p?m.getTextColor():f,textFont:m.getFont(),textAlign:w,textVerticalAlign:"middle"}});g.add(I);var T=new l.Rect({shape:g.getBoundingRect(),invisible:!0,tooltip:y.get("show")?a.extend({content:t,formatter:x.get("formatter",!0)||function(){return t;},formatterParams:{componentType:"legend",legendIndex:i.componentIndex,name:t,$vars:["name"]}},y.option):null});return g.add(T),g.eachChild(function(t){t.silent=!0;}),T.silent=!h,this.group.add(g),l.setHoverStyle(g),g;}});},function(t,e,i){function n(t,e,i){r.positionGroup(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()},e.get("padding"));}var r=i(21),o=i(6),a=i(43);t.exports={layout:function layout(t,e,i){var o=r.getLayoutRect(e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()},e.get("padding"));r.box(e.get("orient"),t,e.get("itemGap"),o.width,o.height),n(t,e,i);},addBackground:function addBackground(t,e){var i=o.normalizeCssArray(e.get("padding")),n=t.getBoundingRect(),r=e.getItemStyle(["color","opacity"]);r.fill=e.get("backgroundColor");var s=new a.Rect({shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[1]+i[3],height:n.height+i[0]+i[2]},style:r,silent:!0,z2:-1});a.subPixelOptimizeRect(s),t.add(s);}};},function(t,e){t.exports=function(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(t){for(var i=0;i<e.length;i++){if(!e[i].isSelected(t.name))return!1;}return!0;});};},function(t,e,i){i(281),i(282),i(1).registerAction({type:"showTip",event:"showTip",update:"none"},function(){}),i(1).registerAction({type:"hideTip",event:"hideTip",update:"none"},function(){});},function(t,e,i){i(1).extendComponentModel({type:"tooltip",defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove",alwaysShowContent:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:!0,animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",lineStyle:{color:"#555",width:1,type:"solid"},crossStyle:{color:"#555",width:1,type:"dashed",textStyle:{}},shadowStyle:{color:"rgba(150,150,150,0.3)"}},textStyle:{color:"#fff",fontSize:14}}});},function(t,e,i){function n(t,e){if(!t||!e)return!1;var i=g.round;return i(t[0])===i(e[0])&&i(t[1])===i(e[1]);}function r(t,e,i,n){return{x1:t,y1:e,x2:i,y2:n};}function o(t,e,i,n){return{x:t,y:e,width:i,height:n};}function a(t,e,i,n,r,o){return{cx:t,cy:e,r0:i,r:n,startAngle:r,endAngle:o,clockwise:!0};}function s(t,e,i,n,r){var o=i.clientWidth,a=i.clientHeight,s=20;return t+o+s>n?t-=o+s:t+=s,e+a+s>r?e-=a+s:e+=s,[t,e];}function l(t,e,i){var n=i.clientWidth,r=i.clientHeight,o=5,a=0,s=0,l=e.width,u=e.height;switch(t){case"inside":a=e.x+l/2-n/2,s=e.y+u/2-r/2;break;case"top":a=e.x+l/2-n/2,s=e.y-r-o;break;case"bottom":a=e.x+l/2-n/2,s=e.y+u+o;break;case"left":a=e.x-n-o,s=e.y+u/2-r/2;break;case"right":a=e.x+l+o,s=e.y+u/2-r/2;}return[a,s];}function u(t,e,i,n,r,o,a){var u=a.getWidth(),h=a.getHeight(),c=o&&o.getBoundingRect().clone();if(o&&c.applyTransform(o.transform),"function"==typeof t&&(t=t([e,i],r,n.el,c)),f.isArray(t))e=v(t[0],u),i=v(t[1],h);else if("string"==typeof t&&o){var d=l(t,c,n.el);e=d[0],i=d[1];}else{var d=s(e,i,n.el,u,h);e=d[0],i=d[1];}n.moveTo(e,i);}function h(t){var e=t.coordinateSystem,i=t.get("tooltip.trigger",!0);return!(!e||"cartesian2d"!==e.type&&"polar"!==e.type&&"singleAxis"!==e.type||"item"===i);}var c=i(283),d=i(43),f=i(4),p=i(6),g=i(7),m=i(5),v=g.parsePercent,y=i(2),x=i(12);i(1).extendComponentView({type:"tooltip",_axisPointers:{},init:function init(t,e){if(!y.node){var i=new c(e.getDom(),e);this._tooltipContent=i,e.on("showTip",this._manuallyShowTip,this),e.on("hideTip",this._manuallyHideTip,this);}},render:function render(t,e,i){if(!y.node){this.group.removeAll(),this._axisPointers={},this._tooltipModel=t,this._ecModel=e,this._api=i,this._lastHover={};var n=this._tooltipContent;n.update(),n.enterable=t.get("enterable"),this._alwaysShowContent=t.get("alwaysShowContent"),this._seriesGroupByAxis=this._prepareAxisTriggerData(t,e);var r=this._crossText;r&&this.group.add(r);var o=t.get("triggerOn");if(null!=this._lastX&&null!=this._lastY&&"none"!==o){var a=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){a._manuallyShowTip({x:a._lastX,y:a._lastY});});}var s=this._api.getZr();s.off("click",this._tryShow),s.off("mousemove",this._mousemove),s.off("mouseout",this._hide),s.off("globalout",this._hide),"click"===o?s.on("click",this._tryShow,this):"mousemove"===o&&(s.on("mousemove",this._mousemove,this),s.on("mouseout",this._hide,this),s.on("globalout",this._hide,this));}},_mousemove:function _mousemove(t){var e=this._tooltipModel.get("showDelay"),i=this;clearTimeout(this._showTimeout),e>0?this._showTimeout=setTimeout(function(){i._tryShow(t);},e):this._tryShow(t);},_manuallyShowTip:function _manuallyShowTip(t){if(t.from!==this.uid){var e=this._ecModel,i=t.seriesIndex,n=e.getSeriesByIndex(i),r=this._api;if(null==t.x||null==t.y){if(n||e.eachSeries(function(t){h(t)&&!n&&(n=t);}),n){var o=n.getData(),a=m.queryDataIndex(o,t);if(null==a||f.isArray(a))return;var s,l,u=o.getItemGraphicEl(a),c=n.coordinateSystem;if(n.getTooltipPosition){var d=n.getTooltipPosition(a)||[];s=d[0],l=d[1];}else if(c&&c.dataToPoint){var d=c.dataToPoint(o.getValues(f.map(c.dimensions,function(t){return n.coordDimToDataDim(t)[0];}),a,!0));s=d&&d[0],l=d&&d[1];}else if(u){var p=u.getBoundingRect().clone();p.applyTransform(u.transform),s=p.x+p.width/2,l=p.y+p.height/2;}null!=s&&null!=l&&this._tryShow({offsetX:s,offsetY:l,position:t.position,target:u,event:{}});}}else{var u=r.getZr().handler.findHover(t.x,t.y);this._tryShow({offsetX:t.x,offsetY:t.y,position:t.position,target:u,event:{}});}}},_manuallyHideTip:function _manuallyHideTip(t){t.from!==this.uid&&this._hide();},_prepareAxisTriggerData:function _prepareAxisTriggerData(t,e){var i={};return e.eachSeries(function(t){if(h(t)){var e,n,r=t.coordinateSystem;"cartesian2d"===r.type?(e=r.getBaseAxis(),n=e.dim+e.index):"singleAxis"===r.type?(e=r.getAxis(),n=e.dim+e.type):(e=r.getBaseAxis(),n=e.dim+r.name),i[n]=i[n]||{coordSys:[],series:[]},i[n].coordSys.push(r),i[n].series.push(t);}},this),i;},_tryShow:function _tryShow(t){var e=t.target,i=this._tooltipModel,n=i.get("trigger"),r=this._ecModel,o=this._api;if(i)if(this._lastX=t.offsetX,this._lastY=t.offsetY,e&&null!=e.dataIndex){var a=e.dataModel||r.getSeriesByIndex(e.seriesIndex),s=e.dataIndex,l=a.getData().getItemModel(s);"axis"===(l.get("tooltip.trigger")||n)?this._showAxisTooltip(i,r,t):(this._ticket="",this._hideAxisPointer(),this._resetLastHover(),this._showItemTooltipContent(a,s,e.dataType,t)),o.dispatchAction({type:"showTip",from:this.uid,dataIndexInside:e.dataIndex,seriesIndex:e.seriesIndex});}else if(e&&e.tooltip){var u=e.tooltip;if("string"==typeof u){var h=u;u={content:h,formatter:h};}var c=new x(u,i),d=c.get("content"),f=Math.random();this._showTooltipContent(c,d,c.get("formatterParams")||{},f,t.offsetX,t.offsetY,t.position,e,o);}else"item"===n?this._hide():this._showAxisTooltip(i,r,t),"cross"===i.get("axisPointer.type")&&o.dispatchAction({type:"showTip",from:this.uid,x:t.offsetX,y:t.offsetY});},_showAxisTooltip:function _showAxisTooltip(t,e,i){var r=t.getModel("axisPointer"),o=r.get("type");if("cross"===o){var a=i.target;if(a&&null!=a.dataIndex){var s=e.getSeriesByIndex(a.seriesIndex),l=a.dataIndex;this._showItemTooltipContent(s,l,a.dataType,i);}}this._showAxisPointer();var u=!0;f.each(this._seriesGroupByAxis,function(t){var e=t.coordSys,a=e[0],s=[i.offsetX,i.offsetY];if(!a.containPoint(s))return void this._hideAxisPointer(a.name);u=!1;var l=a.dimensions,h=a.pointToData(s,!0);s=a.dataToPoint(h);var c=a.getBaseAxis(),d=r.get("axis");"auto"===d&&(d=c.dim);var p=!1,g=this._lastHover;if("cross"===o)n(g.data,h)&&(p=!0),g.data=h;else{var m=f.indexOf(l,d);g.data===h[m]&&(p=!0),g.data=h[m];}"cartesian2d"!==a.type||p?"polar"!==a.type||p?"singleAxis"!==a.type||p||this._showSinglePointer(r,a,d,s):this._showPolarPointer(r,a,d,s):this._showCartesianPointer(r,a,d,s),"cross"!==o&&this._dispatchAndShowSeriesTooltipContent(a,t.series,s,h,p,i.position);},this),this._tooltipModel.get("show")||this._hideAxisPointer(),u&&this._hide();},_showCartesianPointer:function _showCartesianPointer(t,e,i,n){function a(i,n,o){var a="x"===i?r(n[0],o[0],n[0],o[1]):r(o[0],n[1],o[1],n[1]),s=l._getPointerElement(e,t,i,a);d.subPixelOptimizeLine({shape:a,style:s.style}),c?d.updateProps(s,{shape:a},t):s.attr({shape:a});}function s(i,n,r){var a=e.getAxis(i),s=a.getBandWidth(),u=r[1]-r[0],h="x"===i?o(n[0]-s/2,r[0],s,u):o(r[0],n[1]-s/2,u,s),f=l._getPointerElement(e,t,i,h);c?d.updateProps(f,{shape:h},t):f.attr({shape:h});}var l=this,u=t.get("type"),h=e.getBaseAxis(),c="cross"!==u&&"category"===h.type&&h.getBandWidth()>20;if("cross"===u)a("x",n,e.getAxis("y").getGlobalExtent()),a("y",n,e.getAxis("x").getGlobalExtent()),this._updateCrossText(e,n,t);else{var f=e.getAxis("x"===i?"y":"x"),p=f.getGlobalExtent();"cartesian2d"===e.type&&("line"===u?a:s)(i,n,p);}},_showSinglePointer:function _showSinglePointer(t,e,i,n){function o(i,n,o){var s=e.getAxis(),u=s.orient,h="horizontal"===u?r(n[0],o[0],n[0],o[1]):r(o[0],n[1],o[1],n[1]),c=a._getPointerElement(e,t,i,h);l?d.updateProps(c,{shape:h},t):c.attr({shape:h});}var a=this,s=t.get("type"),l="cross"!==s&&"category"===e.getBaseAxis().type,u=e.getRect(),h=[u.y,u.y+u.height];o(i,n,h);},_showPolarPointer:function _showPolarPointer(t,e,i,n){function o(i,n,o){var a,s=e.pointToCoord(n);if("angle"===i){var u=e.coordToPoint([o[0],s[1]]),h=e.coordToPoint([o[1],s[1]]);a=r(u[0],u[1],h[0],h[1]);}else a={cx:e.cx,cy:e.cy,r:s[0]};var c=l._getPointerElement(e,t,i,a);f?d.updateProps(c,{shape:a},t):c.attr({shape:a});}function s(i,n,r){var o,s=e.getAxis(i),u=s.getBandWidth(),h=e.pointToCoord(n),c=Math.PI/180;o="angle"===i?a(e.cx,e.cy,r[0],r[1],(-h[1]-u/2)*c,(-h[1]+u/2)*c):a(e.cx,e.cy,h[0]-u/2,h[0]+u/2,0,2*Math.PI);var p=l._getPointerElement(e,t,i,o);f?d.updateProps(p,{shape:o},t):p.attr({shape:o});}var l=this,u=t.get("type"),h=e.getAngleAxis(),c=e.getRadiusAxis(),f="cross"!==u&&"category"===e.getBaseAxis().type;if("cross"===u)o("angle",n,c.getExtent()),o("radius",n,h.getExtent()),this._updateCrossText(e,n,t);else{var p=e.getAxis("radius"===i?"angle":"radius"),g=p.getExtent();("line"===u?o:s)(i,n,g);}},_updateCrossText:function _updateCrossText(t,e,i){var n=i.getModel("crossStyle"),r=n.getModel("textStyle"),o=this._tooltipModel,a=this._crossText;a||(a=this._crossText=new d.Text({style:{textAlign:"left",textVerticalAlign:"bottom"}}),this.group.add(a));var s=t.pointToData(e),l=t.dimensions;s=f.map(s,function(e,i){var n=t.getAxis(l[i]);return e="category"===n.type||"time"===n.type?n.scale.getLabel(e):p.addCommas(e.toFixed(n.getPixelPrecision()));}),a.setStyle({fill:r.getTextColor()||n.get("color"),textFont:r.getFont(),text:s.join(", "),x:e[0]+5,y:e[1]-5}),a.z=o.get("z"),a.zlevel=o.get("zlevel");},_getPointerElement:function _getPointerElement(t,e,i,n){var r=this._tooltipModel,o=r.get("z"),a=r.get("zlevel"),s=this._axisPointers,l=t.name;if(s[l]=s[l]||{},s[l][i])return s[l][i];var u=e.get("type"),h=e.getModel(u+"Style"),c="shadow"===u,f=h[c?"getAreaStyle":"getLineStyle"](),p="polar"===t.type?c?"Sector":"radius"===i?"Circle":"Line":c?"Rect":"Line";c?f.stroke=null:f.fill=null;var g=s[l][i]=new d[p]({style:f,z:o,zlevel:a,silent:!0,shape:n});return this.group.add(g),g;},_dispatchAndShowSeriesTooltipContent:function _dispatchAndShowSeriesTooltipContent(t,e,i,n,r,o){var a=this._tooltipModel,s=t.getBaseAxis(),l="x"===s.dim||"radius"===s.dim?0:1,h=f.map(e,function(t){return{seriesIndex:t.seriesIndex,dataIndexInside:t.getAxisTooltipDataIndex?t.getAxisTooltipDataIndex(t.coordDimToDataDim(s.dim),n,s):t.getData().indexOfNearest(t.coordDimToDataDim(s.dim)[0],n[l],!1,"category"===s.type?.5:null)};}),c=this._lastHover,d=this._api;if(c.payloadBatch&&!r&&d.dispatchAction({type:"downplay",batch:c.payloadBatch}),r||(d.dispatchAction({type:"highlight",batch:h}),c.payloadBatch=h),d.dispatchAction({type:"showTip",dataIndexInside:h[0].dataIndexInside,seriesIndex:h[0].seriesIndex,from:this.uid}),s&&a.get("showContent")&&a.get("show")){var p=f.map(e,function(t,e){return t.getDataParams(h[e].dataIndexInside);});if(r)u(o||a.get("position"),i[0],i[1],this._tooltipContent,p,null,d);else{var g=h[0].dataIndexInside,m="time"===s.type?s.scale.getLabel(n[l]):e[0].getData().getName(g),v=(m?m+"<br />":"")+f.map(e,function(t,e){return t.formatTooltip(h[e].dataIndexInside,!0);}).join("<br />"),y="axis_"+t.name+"_"+g;this._showTooltipContent(a,v,p,y,i[0],i[1],o,null,d);}}},_showItemTooltipContent:function _showItemTooltipContent(t,e,i,n){var r=this._api,o=t.getData(i),a=o.getItemModel(e),s=a.get("tooltip",!0);if("string"==typeof s){var l=s;s={formatter:l};}var u=this._tooltipModel,h=t.getModel("tooltip",u),c=new x(s,h,h.ecModel),d=t.getDataParams(e,i),f=t.formatTooltip(e,!1,i),p="item_"+t.name+"_"+e;this._showTooltipContent(c,f,d,p,n.offsetX,n.offsetY,n.position,n.target,r);},_showTooltipContent:function _showTooltipContent(t,e,i,n,r,o,a,s,l){if(this._ticket="",t.get("showContent")&&t.get("show")){var h=this._tooltipContent,c=t.get("formatter");a=a||t.get("position");var d=e;if(c)if("string"==typeof c)d=p.formatTpl(c,i);else if("function"==typeof c){var f=this,g=n,m=function m(t,e){t===f._ticket&&(h.setContent(e),u(a,r,o,h,i,s,l));};f._ticket=g,d=c(i,g,m);}h.show(t),h.setContent(d),u(a,r,o,h,i,s,l);}},_showAxisPointer:function _showAxisPointer(t){if(t){var e=this._axisPointers[t];e&&f.each(e,function(t){t.show();});}else this.group.eachChild(function(t){t.show();}),this.group.show();},_resetLastHover:function _resetLastHover(){var t=this._lastHover;t.payloadBatch&&this._api.dispatchAction({type:"downplay",batch:t.payloadBatch}),this._lastHover={};},_hideAxisPointer:function _hideAxisPointer(t){if(t){var e=this._axisPointers[t];e&&f.each(e,function(t){t.hide();});}else this.group.children().length&&this.group.hide();},_hide:function _hide(){clearTimeout(this._showTimeout),this._hideAxisPointer(),this._resetLastHover(),this._alwaysShowContent||this._tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._api.dispatchAction({type:"hideTip",from:this.uid}),this._lastX=this._lastY=null;},dispose:function dispose(t,e){if(!y.node){var i=e.getZr();this._tooltipContent.hide(),i.off("click",this._tryShow),i.off("mousemove",this._mousemove),i.off("mouseout",this._hide),i.off("globalout",this._hide),e.off("showTip",this._manuallyShowTip),e.off("hideTip",this._manuallyHideTip);}}});},function(t,e,i){function n(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",i="left "+t+"s "+e+",top "+t+"s "+e;return l.map(g,function(t){return t+"transition:"+i;}).join(";");}function r(t){var e=[],i=t.get("fontSize"),n=t.getTextColor();return n&&e.push("color:"+n),e.push("font:"+t.getFont()),i&&e.push("line-height:"+Math.round(3*i/2)+"px"),d(["decoration","align"],function(i){var n=t.get(i);n&&e.push("text-"+i+":"+n);}),e.join(";");}function o(t){t=t;var e=[],i=t.get("transitionDuration"),o=t.get("backgroundColor"),a=t.getModel("textStyle"),s=t.get("padding");return i&&e.push(n(i)),o&&(p.canvasSupported?e.push("background-Color:"+o):(e.push("background-Color:#"+u.toHex(o)),e.push("filter:alpha(opacity=70)"))),d(["width","color","radius"],function(i){var n="border-"+i,r=f(n),o=t.get(r);null!=o&&e.push(n+":"+o+("color"===i?"":"px"));}),e.push(r(a)),null!=s&&e.push("padding:"+c.normalizeCssArray(s).join("px ")+"px"),e.join(";")+";";}function a(t,e){var i=document.createElement("div"),n=e.getZr();this.el=i,this._x=e.getWidth()/2,this._y=e.getHeight()/2,t.appendChild(i),this._container=t,this._show=!1,this._hideTimeout;var r=this;i.onmouseenter=function(){r.enterable&&(clearTimeout(r._hideTimeout),r._show=!0),r._inContent=!0;},i.onmousemove=function(e){if(e=e||window.event,!r.enterable){var i=n.handler;h.normalizeEvent(t,e,!0),i.dispatch("mousemove",e);}},i.onmouseleave=function(){r.enterable&&r._show&&r.hideLater(r._hideDelay),r._inContent=!1;},s(i,t);}function s(t,e){function i(t){n(t.target)||t.preventDefault();}function n(i){for(;i&&i!==e;){if(i===t)return!0;i=i.parentNode;}}h.addEventListener(e,"touchstart",i),h.addEventListener(e,"touchmove",i),h.addEventListener(e,"touchend",i);}var l=i(4),u=i(39),h=i(87),c=i(6),d=l.each,f=c.toCamelCase,p=i(2),g=["","-webkit-","-moz-","-o-"],m="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;";a.prototype={constructor:a,enterable:!0,update:function update(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),i=t.style;"absolute"!==i.position&&"absolute"!==e.position&&(i.position="relative");},show:function show(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText=m+o(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",this._show=!0;},setContent:function setContent(t){var e=this.el;e.innerHTML=t,e.style.display=t?"block":"none";},moveTo:function moveTo(t,e){var i=this.el.style;i.left=t+"px",i.top=e+"px",this._x=t,this._y=e;},hide:function hide(){this.el.style.display="none",this._show=!1;},hideLater:function hideLater(t){!this._show||this._inContent&&this.enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(l.bind(this.hide,this),t)):this.hide());},isShow:function isShow(){return this._show;}},t.exports=a;},function(t,e,i){"use strict";i(285),i(291),i(293),i(1).extendComponentView({type:"polar"});},function(t,e,i){function n(t,e){var i=t.get("center"),n=t.get("radius"),r=e.getWidth(),o=e.getHeight(),a=s.parsePercent;this.cx=a(i[0],r),this.cy=a(i[1],o);var l=this.getRadiusAxis(),u=Math.min(r,o)/2;l.setExtent(0,a(n,u));}function r(t,e){var i=this,n=i.getAngleAxis(),r=i.getRadiusAxis();if(n.scale.setExtent(1/0,-(1/0)),r.scale.setExtent(1/0,-(1/0)),t.eachSeries(function(t){if(t.coordinateSystem===i){var e=t.getData();r.scale.unionExtent(e.getDataExtent("radius","category"!==r.type)),n.scale.unionExtent(e.getDataExtent("angle","category"!==n.type));}}),h(n,n.model),h(r,r.model),"category"===n.type&&!n.onBand){var o=n.getExtent(),a=360/n.scale.count();n.inverse?o[1]+=a:o[1]-=a,n.setExtent(o[0],o[1]);}}function o(t,e){if(t.type=e.get("type"),t.scale=u.createScaleByModel(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,"angleAxis"===e.mainType){var i=e.get("startAngle");t.inverse=e.get("inverse")^e.get("clockwise"),t.setExtent(i,i+(t.inverse?-360:360));}e.axis=t,t.model=e;}var a=i(286),s=i(7),l=i(4),u=i(114),h=u.niceScaleExtent;i(289);var c={dimensions:a.prototype.dimensions,create:function create(t,e){var i=[];return t.eachComponent("polar",function(t,s){var l=new a(s);l.resize=n,l.update=r;var u=l.getRadiusAxis(),h=l.getAngleAxis(),c=t.findAxisModel("radiusAxis"),d=t.findAxisModel("angleAxis");o(u,c),o(h,d),l.resize(t,e),i.push(l),t.coordinateSystem=l;}),t.eachSeries(function(e){if("polar"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"polar",index:e.get("polarIndex"),id:e.get("polarId")})[0];if(!i)throw new Error('Polar "'+l.retrieve(e.get("polarIndex"),e.get("polarId"),0)+'" not found');e.coordinateSystem=i.coordinateSystem;}}),i;}};i(26).register("polar",c);},function(t,e,i){"use strict";var n=i(287),r=i(288),o=function o(t){this.name=t||"",this.cx=0,this.cy=0,this._radiusAxis=new n(),this._angleAxis=new r();};o.prototype={constructor:o,type:"polar",dimensions:["radius","angle"],containPoint:function containPoint(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1]);},containData:function containData(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1]);},getAxis:function getAxis(t){return this["_"+t+"Axis"];},getAxesByScale:function getAxesByScale(t){var e=[],i=this._angleAxis,n=this._radiusAxis;return i.scale.type===t&&e.push(i),n.scale.type===t&&e.push(n),e;},getAngleAxis:function getAngleAxis(){return this._angleAxis;},getRadiusAxis:function getRadiusAxis(){return this._radiusAxis;},getOtherAxis:function getOtherAxis(t){var e=this._angleAxis;return t===e?this._radiusAxis:e;},getBaseAxis:function getBaseAxis(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis();},dataToPoints:function dataToPoints(t){return t.mapArray(this.dimensions,function(t,e){return this.dataToPoint([t,e]);},this);},dataToPoint:function dataToPoint(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)]);},pointToData:function pointToData(t,e){var i=this.pointToCoord(t);return[this._radiusAxis.radiusToData(i[0],e),this._angleAxis.angleToData(i[1],e)];},pointToCoord:function pointToCoord(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=this.getAngleAxis(),r=n.getExtent(),o=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);n.inverse?o=a-360:a=o+360;var s=Math.sqrt(e*e+i*i);e/=s,i/=s;for(var l=Math.atan2(-i,e)/Math.PI*180,u=o>l?1:-1;o>l||l>a;){l+=360*u;}return[s,l];},coordToPoint:function coordToPoint(t){var e=t[0],i=t[1]/180*Math.PI,n=Math.cos(i)*e+this.cx,r=-Math.sin(i)*e+this.cy;return[n,r];}},t.exports=o;},function(t,e,i){"use strict";function n(t,e){o.call(this,"radius",t,e),this.type="category";}var r=i(4),o=i(123);n.prototype={constructor:n,dataToRadius:o.prototype.dataToCoord,radiusToData:o.prototype.coordToData},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";function n(t,e){e=e||[0,360],o.call(this,"angle",t,e),this.type="category";}var r=i(4),o=i(123);n.prototype={constructor:n,dataToAngle:o.prototype.dataToCoord,angleToData:o.prototype.coordToData},r.inherits(n,o),t.exports=n;},function(t,e,i){"use strict";i(290),i(1).extendComponentModel({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function findAxisModel(t){var e,i=this.ecModel;return i.eachComponent(t,function(t){var n=i.queryComponents({mainType:"polar",index:t.getShallow("polarIndex"),id:t.getShallow("polarId")})[0];n===this&&(e=t);},this),e;},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}});},function(t,e,i){"use strict";function n(t,e){return e.type||(e.data?"category":"value");}var r=i(4),o=i(19),a=i(127),s=o.extend({type:"polarAxis",axis:null});r.merge(s.prototype,i(129)),r.merge(s.prototype,i(130));var l={angle:{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}},radius:{splitNumber:5}};a("angle",s,n,l.angle),a("radius",s,n,l.radius);},function(t,e,i){"use strict";i(285),i(292);},function(t,e,i){"use strict";function n(t,e,i,n){var r=t.coordToPoint([e,n]),o=t.coordToPoint([i,n]);return{x1:r[0],y1:r[1],x2:o[0],y2:o[1]};}var r=i(4),o=i(43),a=i(12),s=["axisLine","axisLabel","axisTick","splitLine","splitArea"];i(1).extendComponentView({type:"angleAxis",render:function render(t,e){if(this.group.removeAll(),t.get("show")){var i=e.getComponent("polar",t.get("polarIndex")),n=t.axis,o=i.coordinateSystem,a=o.getRadiusAxis().getExtent(),l=n.getTicksCoords();"category"!==n.type&&l.pop(),r.each(s,function(e){t.get(e+".show")&&this["_"+e](t,o,l,a);},this);}},_axisLine:function _axisLine(t,e,i,n){var r=t.getModel("axisLine.lineStyle"),a=new o.Circle({shape:{cx:e.cx,cy:e.cy,r:n[1]},style:r.getLineStyle(),z2:1,silent:!0});a.style.fill=null,this.group.add(a);},_axisTick:function _axisTick(t,e,i,a){var s=t.getModel("axisTick"),l=(s.get("inside")?-1:1)*s.get("length"),u=r.map(i,function(t){return new o.Line({shape:n(e,a[1],a[1]+l,t)});});this.group.add(o.mergePath(u,{style:r.defaults(s.getModel("lineStyle").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})}));},_axisLabel:function _axisLabel(t,e,i,n){for(var r=t.axis,s=t.get("data"),l=t.getModel("axisLabel"),u=l.getModel("textStyle"),h=t.getFormattedLabels(),c=l.get("margin"),d=r.getLabelsCoords(),f=0;f<i.length;f++){var p=n[1],g=e.coordToPoint([p+c,d[f]]),m=e.cx,v=e.cy,y=Math.abs(g[0]-m)/p<.3?"center":g[0]>m?"left":"right",x=Math.abs(g[1]-v)/p<.3?"middle":g[1]>v?"top":"bottom",_=u;s&&s[f]&&s[f].textStyle&&(_=new a(s[f].textStyle,u)),this.group.add(new o.Text({style:{x:g[0],y:g[1],fill:_.getTextColor()||t.get("axisLine.lineStyle.color"),text:h[f],textAlign:y,textVerticalAlign:x,textFont:_.getFont()},silent:!0}));}},_splitLine:function _splitLine(t,e,i,a){var s=t.getModel("splitLine"),l=s.getModel("lineStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=0;d<i.length;d++){var f=h++%u.length;c[f]=c[f]||[],c[f].push(new o.Line({shape:n(e,a[0],a[1],i[d])}));}for(var d=0;d<c.length;d++){this.group.add(o.mergePath(c[d],{style:r.defaults({stroke:u[d%u.length]},l.getLineStyle()),silent:!0,z:t.get("z")}));}},_splitArea:function _splitArea(t,e,i,n){var a=t.getModel("splitArea"),s=a.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var h=[],c=Math.PI/180,d=-i[0]*c,f=Math.min(n[0],n[1]),p=Math.max(n[0],n[1]),g=t.get("clockwise"),m=1;m<i.length;m++){var v=u++%l.length;h[v]=h[v]||[],h[v].push(new o.Sector({shape:{cx:e.cx,cy:e.cy,r0:f,r:p,startAngle:d,endAngle:-i[m]*c,clockwise:g},silent:!0})),d=-i[m]*c;}for(var m=0;m<h.length;m++){this.group.add(o.mergePath(h[m],{style:r.defaults({fill:l[m%l.length]},s.getAreaStyle()),silent:!0}));}}});},function(t,e,i){i(285),i(294);},function(t,e,i){"use strict";function n(t,e,i){return{position:[t.cx,t.cy],rotation:i/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotation:e.getModel("axisLabel").get("rotate"),z2:1};}var r=i(4),o=i(43),a=i(133),s=["axisLine","axisLabel","axisTick","axisName"],l=["splitLine","splitArea"];i(1).extendComponentView({type:"radiusAxis",render:function render(t,e){if(this.group.removeAll(),t.get("show")){var i=e.getComponent("polar",t.get("polarIndex")),o=i.coordinateSystem.getAngleAxis(),u=t.axis,h=i.coordinateSystem,c=u.getTicksCoords(),d=o.getExtent()[0],f=u.getExtent(),p=n(h,t,d),g=new a(t,p);r.each(s,g.add,g),this.group.add(g.getGroup()),r.each(l,function(e){t.get(e+".show")&&this["_"+e](t,h,d,f,c);},this);}},_splitLine:function _splitLine(t,e,i,n,a){var s=t.getModel("splitLine"),l=s.getModel("lineStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=0;d<a.length;d++){var f=h++%u.length;c[f]=c[f]||[],c[f].push(new o.Circle({shape:{cx:e.cx,cy:e.cy,r:a[d]},silent:!0}));}for(var d=0;d<c.length;d++){this.group.add(o.mergePath(c[d],{style:r.defaults({stroke:u[d%u.length],fill:null},l.getLineStyle()),silent:!0}));}},_splitArea:function _splitArea(t,e,i,n,a){var s=t.getModel("splitArea"),l=s.getModel("areaStyle"),u=l.get("color"),h=0;u=u instanceof Array?u:[u];for(var c=[],d=a[0],f=1;f<a.length;f++){var p=h++%u.length;c[p]=c[p]||[],c[p].push(new o.Sector({shape:{cx:e.cx,cy:e.cy,r0:d,r:a[f],startAngle:0,endAngle:2*Math.PI},silent:!0})),d=a[f];}for(var f=0;f<c.length;f++){this.group.add(o.mergePath(c[f],{style:r.defaults({fill:u[f%u.length]},l.getAreaStyle()),silent:!0}));}}});},function(t,e,i){function n(t,e){e.update="updateView",r.registerAction(e,function(e,i){var n={};return i.eachComponent({mainType:"geo",query:e},function(i){i[t](e.name);var r=i.coordinateSystem;o.each(r.regions,function(t){n[t.name]=i.isSelected(t.name)||!1;});}),{selected:n,name:e.name};});}i(296),i(164),i(297),i(177);var r=i(1),o=i(4);n("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),n("select",{type:"geoSelect",event:"geoselected"}),n("unSelect",{type:"geoUnSelect",event:"geounselected"});},function(t,e,i){"use strict";var n=i(5),r=i(19),o=i(12),a=i(4),s=i(141),l=i(164),u=r.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function init(t){r.prototype.init.apply(this,arguments),n.defaultEmphasis(t.label,["position","show","textStyle","distance","formatter"]);},optionUpdated:function optionUpdated(){var t=this.option,e=this;t.regions=l.getFilledRegions(t.regions,t.map),this._optionModelMap=a.reduce(t.regions||[],function(t,i){return i.name&&(t[i.name]=new o(i,e)),t;},{}),this.updateSelectedMap(t.regions);},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:.75,silent:!1,map:"",center:null,zoom:1,scaleLimit:null,label:{normal:{show:!1,textStyle:{color:"#000"}},emphasis:{show:!0,textStyle:{color:"rgb(100,0,0)"}}},itemStyle:{normal:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function getRegionModel(t){return this._optionModelMap[t];},getFormattedLabel:function getFormattedLabel(t,e){var i=this.get("label."+e+".formatter"),n={name:t};return"function"==typeof i?(n.status=e,i(n)):"string"==typeof i?i.replace("{a}",n.seriesName):void 0;},setZoom:function setZoom(t){this.option.zoom=t;},setCenter:function setCenter(t){this.option.center=t;}});a.mixin(u,s),t.exports=u;},function(t,e,i){"use strict";var n=i(174);t.exports=i(1).extendComponentView({type:"geo",init:function init(t,e){var i=new n(e,!0);this._mapDraw=i,this.group.add(i.group);},render:function render(t,e,i,n){if(!n||"geoToggleSelect"!==n.type||n.from!==this.uid){var r=this._mapDraw;t.get("show")?r.draw(t,e,i,this,n):this._mapDraw.group.removeAll(),this.group.silent=t.get("silent");}},dispose:function dispose(){this._mapDraw&&this._mapDraw.remove();}});},function(t,e,i){i(299),i(302),i(303);var n=i(1);n.extendComponentView({type:"single"});},function(t,e,i){function n(t,e){var i=[];return t.eachComponent("singleAxis",function(n,o){var a=new r(n,t,e);a.name="single_"+o,a.resize(n,e),n.coordinateSystem=a,i.push(a);}),t.eachSeries(function(e){if("singleAxis"===e.get("coordinateSystem")){var i=t.queryComponents({mainType:"singleAxis",index:e.get("singleAxisIndex"),id:e.get("singleAxisId")})[0];e.coordinateSystem=i.coordinateSystem;}}),i;}var r=i(300);i(26).register("single",{create:n,dimensions:r.prototype.dimensions});},function(t,e,i){function n(t,e,i){this.dimension="x",this.dimensions=["x"],this._axis=null,this._rect,this._init(t,e,i),this._model=t;}var r=i(301),o=i(114),a=i(21);n.prototype={type:"singleAxis",constructor:n,_init:function _init(t,e,i){var n=this.dimension,a=new r(n,o.createScaleByModel(t),[0,0],t.get("type"),t.get("position")),s="category"===a.type;a.onBand=s&&t.get("boundaryGap"),a.inverse=t.get("inverse"),a.orient=t.get("orient"),t.axis=a,a.model=t,this._axis=a;},update:function update(t,e){this._updateAxisFromSeries(t);},_updateAxisFromSeries:function _updateAxisFromSeries(t){t.eachSeries(function(t){var e=t.getData(),i=this.dimension;this._axis.scale.unionExtent(e.getDataExtent(t.coordDimToDataDim(i))),o.niceScaleExtent(this._axis,this._axis.model);},this);},resize:function resize(t,e){this._rect=a.getLayoutRect({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis();},getRect:function getRect(){return this._rect;},_adjustAxis:function _adjustAxis(){var t=this._rect,e=this._axis,i=e.isHorizontal(),n=i?[0,t.width]:[0,t.height],r=e.reverse?1:0;e.setExtent(n[r],n[1-r]),this._updateAxisTransform(e,i?t.x:t.y);},_updateAxisTransform:function _updateAxisTransform(t,e){var i=t.getExtent(),n=i[0]+i[1],r=t.isHorizontal();t.toGlobalCoord=r?function(t){return t+e;}:function(t){return n-t+e;},t.toLocalCoord=r?function(t){return t-e;}:function(t){return n-t+e;};},getAxis:function getAxis(){return this._axis;},getBaseAxis:function getBaseAxis(){return this._axis;},containPoint:function containPoint(t){var e=this.getRect(),i=this.getAxis(),n=i.orient;return"horizontal"===n?i.contain(i.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:i.contain(i.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height;},pointToData:function pointToData(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))];},dataToPoint:function dataToPoint(t){var e=this.getAxis(),i=this.getRect(),n=[],r="horizontal"===e.orient?0:1;return n[r]=e.toGlobalCoord(e.dataToCoord(+t)),n[1-r]=0===r?i.y+i.height/2:i.x+i.width/2,n;}},t.exports=n;},function(t,e,i){var n=i(4),r=i(123),o=i(114),a=function a(t,e,i,n,o){r.call(this,t,e,i),this.type=n||"value",this.position=o||"bottom",this.orient=null,this._labelInterval=null;};a.prototype={constructor:a,model:null,isHorizontal:function isHorizontal(){var t=this.position;return"top"===t||"bottom"===t;},getLabelInterval:function getLabelInterval(){var t=this._labelInterval;if(!t){var e=this.model,i=e.getModel("axisLabel"),r=i.get("interval");if("category"!==this.type||"auto"!==r)return t=this._labelInterval="auto"===r?0:r;t=this._labelInterval=o.getAxisLabelInterval(n.map(this.scale.getTicks(),this.dataToCoord,this),e.getFormattedLabels(),i.getModel("textStyle").getFont(),this.isHorizontal());}return t;},toGlobalCoord:null,toLocalCoord:null},n.inherits(a,r),t.exports=a;},function(t,e,i){function n(t){var e=t.coordinateSystem,i=t.axis,n={},r=i.position,o=i.orient,a=e.getRect(),s=[a.x,a.x+a.width,a.y,a.y+a.height],l={horizontal:{top:s[2],bottom:s[3]},vertical:{left:s[0],right:s[1]}};n.position=["vertical"===o?l.vertical[r]:s[0],"horizontal"===o?l.horizontal[r]:s[3]];var u={horizontal:0,vertical:1};n.rotation=Math.PI/2*u[o];var h={top:-1,bottom:1,right:1,left:-1};n.labelDirection=n.tickDirection=n.nameDirection=h[r],t.getModel("axisTick").get("inside")&&(n.tickDirection=-n.tickDirection),t.getModel("axisLabel").get("inside")&&(n.labelDirection=-n.labelDirection);var c=t.getModel("axisLabel").get("rotate");return n.labelRotation="top"===r?-c:c,n.labelInterval=i.getLabelInterval(),n.z2=1,n;}var r=i(133),o=i(4),a=i(43),s=r.getInterval,l=r.ifIgnoreOnTick,u=["axisLine","axisLabel","axisTick","axisName"],h="splitLine",c=i(1).extendComponentView({type:"singleAxis",render:function render(t,e){var i=this.group;i.removeAll();var a=n(t),s=new r(t,a);o.each(u,s.add,s),i.add(s.getGroup()),t.get(h+".show")&&this["_"+h](t,a.labelInterval);},_splitLine:function _splitLine(t,e){var i=t.axis,n=t.getModel("splitLine"),r=n.getModel("lineStyle"),o=r.get("width"),u=r.get("color"),h=s(n,e);u=u instanceof Array?u:[u];for(var c=t.coordinateSystem.getRect(),d=i.isHorizontal(),f=[],p=0,g=i.getTicksCoords(),m=[],v=[],y=0;y<g.length;++y){if(!l(i,y,h)){var x=i.toGlobalCoord(g[y]);d?(m[0]=x,m[1]=c.y,v[0]=x,v[1]=c.y+c.height):(m[0]=c.x,m[1]=x,v[0]=c.x+c.width,v[1]=x);var _=p++%u.length;f[_]=f[_]||[],f[_].push(new a.Line(a.subPixelOptimizeLine({shape:{x1:m[0],y1:m[1],x2:v[0],y2:v[1]},style:{lineWidth:o},silent:!0})));}}for(var y=0;y<f.length;++y){this.group.add(a.mergePath(f[y],{style:{stroke:u[y%u.length],lineDash:r.getLineDash(o),lineWidth:o},silent:!0}));}}});t.exports=c;},function(t,e,i){function n(t,e){return e.type||(e.data?"category":"value");}var r=i(19),o=i(127),a=i(4),s=r.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null}),l={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:2,type:"solid"}},axisTick:{show:!0,length:6,lineStyle:{width:2}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}};a.merge(s.prototype,i(129)),o("single",s,n,l),t.exports=s;},function(t,e,i){i(1).registerPreprocessor(i(305)),i(306),i(311),i(312),i(313),i(314);},function(t,e,i){function n(t){var e={};r.each(t,function(t){e[t]=1;}),t.length=0,r.each(e,function(e,i){t.push(i);});}var r=i(4),o=["rect","polygon","keep","clear"];t.exports=function(t,e){var i=t&&t.brush;if(r.isArray(i)||(i=i?[i]:[]),i.length){var a=[];r.each(i,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(a=a.concat(e));});var s=t&&t.toolbox;r.isArray(s)&&(s=s[0]),s||(s={feature:{}},t.toolbox=[s]);var l=s.feature||(s.feature={}),u=l.brush||(l.brush={}),h=u.type||(u.type=[]);h.push.apply(h,a),n(h),e&&!h.length&&h.push.apply(h,o);}};},function(t,e,i){function n(t,e,i,n,o){if(o){var a=t.getZr();if(!a[x]){a[y]||(a[y]=r);var s=g.createOrUpdate(a,y,i,e);s(t,n);}}}function r(t,e){if(!t.isDisposed()){var i=t.getZr();i[x]=!0,t.dispatchAction({type:"brushSelect",batch:e}),i[x]=!1;}}function o(t,e,i,n){for(var r=i.getItemLayout(n),o=0,a=e.length;a>o;o++){var s=e[o];if(t[s.brushType](r,s.selectors,s))return!0;}}function a(t){var e=t.brushSelector;if(d.isString(e)){var i=[];return d.each(p,function(t,n){i[n]=t[e];}),i;}if(d.isFunction(e)){var n={};return d.each(p,function(t,i){n[i]=e;}),n;}return e;}function s(t,e){var i=t.option.seriesIndex;return null!=i&&"all"!==i&&(d.isArray(i)?d.indexOf(i,e)<0:e!==i);}function l(t){var e=t.selectors={};return d.each(p[t.brushType],function(i,n){e[n]=function(n){return i(n,e,t);};}),t;}function u(t){return new f(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0]);}var h=i(1),c=i(307),d=i(4),f=i(9),p=i(308),g=i(309),m=i(310),v=["inBrush","outOfBrush"],y="__ecBrushSelect",x="__ecInBrushSelectEvent",_=h.PRIORITY.VISUAL.BRUSH;h.registerLayout(_,function(t,e,i){t.eachComponent({mainType:"brush"},function(e){i&&"takeGlobalCursor"===i.type&&e.setBrushOption("brush"===i.key?i.brushOption:{brushType:!1}),e.coordInfoList=m.makeCoordInfoList(e.option,t),m.parseInputRanges(e,t);});}),h.registerVisual(_,function(t,e,i){var r,u,h=[];t.eachComponent({mainType:"brush"},function(e,i){function n(t){return"all"===_||w[t];}function f(t){return!!t.length;}function p(t,e){var i=t.coordinateSystem;I|=i.hasAxisbrushed(),n(e)&&i.eachActiveState(t.getData(),function(t,e){"active"===t&&(S[e]=1);});}function g(t,i,r){var l=a(t);if(l&&!s(e,i)&&(d.each(T,function(i){l[i.brushType]&&m.controlSeries(i,e,t)&&r.push(i),I|=f(r);}),n(i)&&f(r))){var u=t.getData();u.each(function(t){o(l,r,u,t)&&(S[t]=1);});}}var y={brushId:e.id,brushIndex:i,brushName:e.name,areas:d.clone(e.areas),selected:[]};h.push(y);var x=e.option,_=x.brushLink,w=[],S=[],M=[],I=0;i||(r=x.throttleType,u=x.throttleDelay);var T=d.map(e.areas,function(t){return l(d.defaults({boundingRect:b[t.brushType](t)},t));}),A=c.createVisualMappings(e.option,v,function(t){t.mappingMethod="fixed";});d.isArray(_)&&d.each(_,function(t){w[t]=1;}),t.eachSeries(function(t,e){var i=M[e]=[];"parallel"===t.subType?p(t,e,i):g(t,e,i);}),t.eachSeries(function(t,e){var i={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};y.selected.push(i);var r=a(t),s=M[e],l=t.getData(),u=n(e)?function(t){return S[t]?(i.dataIndex.push(l.getRawIndex(t)),"inBrush"):"outOfBrush";}:function(t){return o(r,s,l,t)?(i.dataIndex.push(l.getRawIndex(t)),"inBrush"):"outOfBrush";};(n(e)?I:f(s))&&c.applyVisual(v,A,l,u);});}),n(e,r,u,h,i);});var b={lineX:d.noop,lineY:d.noop,rect:function rect(t){return u(t.range);},polygon:function polygon(t){for(var e,i=t.range,n=0,r=i.length;r>n;n++){e=e||[[1/0,-(1/0)],[1/0,-(1/0)]];var o=i[n];o[0]<e[0][0]&&(e[0][0]=o[0]),o[0]>e[0][1]&&(e[0][1]=o[0]),o[1]<e[1][0]&&(e[1][0]=o[1]),o[1]>e[1][1]&&(e[1][1]=o[1]);}return e&&u(e);}};},function(t,e,i){function n(t){if(t)for(var e in t){if(t.hasOwnProperty(e))return!0;}}var r=i(4),o=i(193),a=r.each,s={createVisualMappings:function createVisualMappings(t,e,i){function n(){var t=function t(){};t.prototype.__hidden=t.prototype;var e=new t();return e;}var s={};return a(e,function(e){var l=s[e]=n();a(t[e],function(t,n){if(o.isValidType(n)){var a={type:n,visual:t};i&&i(a,e),l[n]=new o(a),"opacity"===n&&(a=r.clone(a),a.type="colorAlpha",l.__hidden.__alphaForOpacity=new o(a));}});}),s;},replaceVisualOption:function replaceVisualOption(t,e,i){var o;r.each(i,function(t){e.hasOwnProperty(t)&&n(e[t])&&(o=!0);}),o&&r.each(i,function(i){e.hasOwnProperty(i)&&n(e[i])?t[i]=r.clone(e[i]):delete t[i];});},applyVisual:function applyVisual(t,e,i,n,a,s){function l(t){return i.getItemVisual(d,t);}function u(t,e){i.setItemVisual(d,t,e);}function h(t,i){d=null==s?t:i;for(var r=n.call(a,t),o=e[r],h=c[r],f=0,p=h.length;p>f;f++){var g=h[f];o[g]&&o[g].applyVisual(t,l,u);}}var c={};r.each(t,function(t){var i=o.prepareVisualTypes(e[t]);c[t]=i;});var d;null==s?i.each(h,!0):i.each([s],h,!0);}};t.exports=s;},function(t,e,i){function n(t){var e=["x","y"],i=["width","height"];return{point:function point(e,i,n){var o=n.range,a=e[t];return r(a,o);},rect:function rect(n,o,a){var s=a.range;return r(n[e[t]],s)||r(n[e[t]]+n[i[t]],s);}};}function r(t,e){return e[0]<=t&&t<=e[1];}function o(t,e,i,n,r){for(var o=0,s=r[r.length-1];o<r.length;o++){var l=r[o];if(a(t,e,i,n,l[0],l[1],s[0],s[1]))return!0;s=l;}}function a(t,e,i,n,r,o,a,u){var h=l(i-t,r-a,n-e,o-u);if(s(h))return!1;var c=l(r-t,r-a,o-e,o-u)/h;if(0>c||c>1)return!1;var d=l(i-t,r-t,n-e,o-e)/h;return 0>d||d>1?!1:!0;}function s(t){return 1e-6>=t&&t>=-1e-6;}function l(t,e,i,n){return t*n-e*i;}var u=i(168).contain,h=i(9),c={lineX:n(0),lineY:n(1),rect:{point:function point(t,e,i){return i.boundingRect.contain(t[0],t[1]);},rect:function rect(t,e,i){return i.boundingRect.intersect(t);}},polygon:{point:function point(t,e,i){return i.boundingRect.contain(t[0],t[1])&&u(i.range,t[0],t[1]);},rect:function rect(t,e,i){var n=i.range;if(n.length<=1)return!1;var r=t.x,a=t.y,s=t.width,l=t.height,c=n[0];return u(n,r,a)||u(n,r+s,a)||u(n,r,a+l)||u(n,r+s,a+l)||h.create(t).contain(c[0],c[1])||o(r,a,r+s,a,n)||o(r,a,r,a+l,n)||o(r+s,a,r+s,a+l,n)||o(r,a+l,r+s,a+l,n)?!0:void 0;}}};t.exports=c;},function(t,e){var i={},n="\x00__throttleOriginMethod",r="\x00__throttleRate",o="\x00__throttleType";i.throttle=function(t,e,i){function n(){u=new Date().getTime(),h=null,t.apply(a,s||[]);}var r,o,a,s,l=0,u=0,h=null;e=e||0;var c=function c(){r=new Date().getTime(),a=this,s=arguments,o=r-(i?l:u)-e,clearTimeout(h),i?h=setTimeout(n,e):o>=0?n():h=setTimeout(n,-o),l=r;};return c.clear=function(){h&&(clearTimeout(h),h=null);},c;},i.createOrUpdate=function(t,e,a,s){var l=t[e];if(l){var u=l[n]||l,h=l[o],c=l[r];if(c!==a||h!==s){if(null==a||!s)return t[e]=u;l=t[e]=i.throttle(u,a,"debounce"===s),l[n]=u,l[o]=s,l[r]=a;}return l;}},i.clear=function(t,e){var i=t[e];i&&i[n]&&(t[e]=i[n]);},t.exports=i;},function(t,e,i){function n(t){return t[0]>t[1]&&t.reverse(),t;}function r(t,e){for(var i=!0,n=0;n<h.length;n++){var r=h[n]+"Index";if(t[r]>=0){i=!1;for(var o=0;o<e.length;o++){if(e[o][r]===t[r])return e[o];}}}return i;}function o(t,e,i,r){var o=i.coordSys.getAxis(t);return a.assert(o,"line brush is only available in cartesian (grid)."),n(a.map([0,1],function(t){return e?o.coordToData(o.toLocalCoord(r[t])):o.toGlobalCoord(o.dataToCoord(r[t]));}));}var a=i(4),s=i(43),l=a.each,u={},h=["geo","xAxis","yAxis"],c="--",d=["dataToPoint","pointToData"];u.parseOutputRanges=function(t,e,i,n){l(t,function(t,i){var o=t.panelId;if(o){o=o.split(c),t[o[0]+"Index"]=+o[1];var a=r(t,e);t.coordRange=f[t.brushType](1,a,t.range),n&&(n[i]=a);}});},u.parseInputRanges=function(t,e){l(t.areas,function(e){var i=r(e,t.coordInfoList);a.assert(!i||i===!0||e.coordRange,"coordRange must be specified when coord index specified."),a.assert(!i||i!==!0||e.range,"range must be specified."),e.range=e.range||[],i&&i!==!0&&(e.range=f[e.brushType](0,i,e.coordRange),e.panelId=i.panelId);});},u.makePanelOpts=function(t){var e=[];return l(t,function(t){var i,n=t.coordSys;t.geoIndex>=0?(i=n.getBoundingRect().clone(),i.applyTransform(s.getTransform(n))):i=n.grid.getRect().clone(),e.push({panelId:t.panelId,rect:i});}),e;},u.makeCoordInfoList=function(t,e){var i=[];return l(h,function(n){var r=t[n+"Index"];null!=r&&"none"!==r&&("all"===r||a.isArray(r)||(r=[r]),e.eachComponent({mainType:n},function(t,e){if(!("all"!==r&&a.indexOf(r,e)<0)){var o,s;"xAxis"===n||"yAxis"===n?o=t.axis.grid:s=t.coordinateSystem;for(var l,u=0,h=i.length;h>u;u++){var d=i[u];if(a.assert(d[n+"Index"]!=e,"Coord should not be defined duplicately: "+n+e),"yAxis"===n&&!d.yAxis&&d.xAxis){var f=o.getCartesian(d.xAxisIndex,e);if(f){s=f,l=d;break;}}}!l&&i.push(l={}),l[n]=t,l[n+"Index"]=e,l.panelId=n+c+e,l.coordSys=s||o.getCartesian(l.xAxisIndex,l.yAxisIndex),l.coordSys?i[n+"Has"]=!0:i.pop();}}));}),i;},u.controlSeries=function(t,e,i){var n=r(t,e.coordInfoList);return n===!0||n&&n.coordSys===i.coordinateSystem;};var f={lineX:a.curry(o,"x"),lineY:a.curry(o,"y"),rect:function rect(t,e,i){var r=e.coordSys,o=r[d[t]]([i[0][0],i[1][0]]),a=r[d[t]]([i[0][1],i[1][1]]);return[n([o[0],a[0]]),n([o[1],a[1]])];},polygon:function polygon(t,e,i){var n=e.coordSys;return a.map(i,n[d[t]],n);}};t.exports=u;},function(t,e,i){var n=i(1),r=i(4),o=i(307),a=i(12),s=["#ddd"],l=n.extendComponentModel({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)",width:null},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function optionUpdated(t,e){var i=this.option;!e&&o.replaceVisualOption(i,t,["inBrush","outOfBrush"]),i.inBrush=i.inBrush||{},i.outOfBrush=i.outOfBrush||{color:s};},setAreas:function setAreas(t){r.assert(r.isArray(t)),r.each(t,function(t){r.assert(t.brushType,"Illegal areas");}),t&&(this.areas=r.map(t,function(t){return this._mergeBrushOption(t);},this));},setBrushOption:function setBrushOption(t){this.brushOption=this._mergeBrushOption(t),this.brushType=this.brushOption.brushType;},_mergeBrushOption:function _mergeBrushOption(t){var e=this.option;return r.merge({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new a(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick},t,!0);}});t.exports=l;},function(t,e,i){function n(t,e,i,n){(!n||n.$from!==t.id)&&this._brushController.setPanels(s.makePanelOpts(t.coordInfoList)).enableBrush(t.brushOption).updateCovers(t.areas.slice());}var r=i(4),o=i(234),a=i(1),s=i(310);t.exports=a.extendComponentView({type:"brush",init:function init(t,e){this.ecModel=t,this.api=e,this.model,(this._brushController=new o(e.getZr())).on("brush",r.bind(this._onBrush,this)).mount();},render:function render(t){return this.model=t,n.apply(this,arguments);},updateView:n,updateLayout:n,updateVisual:n,dispose:function dispose(){this._brushController.dispose();},_onBrush:function _onBrush(t,e){var i=this.model.id;s.parseOutputRanges(t,this.model.coordInfoList,this.ecModel),(!e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:i,areas:r.clone(t),$from:i});}});},function(t,e,i){var n=i(1);n.registerAction({type:"brush",event:"brush",update:"updateView"},function(t,e){e.eachComponent({mainType:"brush",query:t},function(e){e.setAreas(t.areas);});}),n.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},function(){});},function(t,e,i){"use strict";function n(t,e,i){this.model=t,this.ecModel=e,this.api=i,this._brushType,this._brushMode;}var r=i(315),o=i(4);n.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}};var a=n.prototype;a.render=a.updateView=a.updateLayout=function(t,e,i){var n,r,a;e.eachComponent({mainType:"brush"},function(t){n=t.brushType,r=t.brushOption.brushMode||"single",a|=t.areas.length;}),this._brushType=n,this._brushMode=r,o.each(t.get("type",!0),function(e){t.setIconStatus(e,("keep"===e?"multiple"===r:"clear"===e?a:e===n)?"emphasis":"normal");});},a.getIcons=function(){var t=this.model,e=t.get("icon",!0),i={};return o.each(t.get("type",!0),function(t){e[t]&&(i[t]=e[t]);}),i;},a.onclick=function(t,e,i){var e=this.api,n=this._brushType,r=this._brushMode;"clear"===i?e.dispatchAction({type:"brush",areas:[]}):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===i?n:n===i?!1:i,brushMode:"keep"===i?"multiple"===r?"single":"multiple":r}});},r.register("brush",n),t.exports=n;},function(t,e){"use strict";var i={};t.exports={register:function register(t,e){i[t]=e;},get:function get(t){return i[t];}};},function(t,e,i){"use strict";var n=i(1),r=i(43),o=i(21);n.extendComponentModel({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),n.extendComponentView({type:"title",render:function render(t,e,i){if(this.group.removeAll(),t.get("show")){var n=this.group,a=t.getModel("textStyle"),s=t.getModel("subtextStyle"),l=t.get("textAlign"),u=t.get("textBaseline"),h=new r.Text({style:{text:t.get("text"),textFont:a.getFont(),fill:a.getTextColor()},z2:10}),c=h.getBoundingRect(),d=t.get("subtext"),f=new r.Text({style:{text:d,textFont:s.getFont(),fill:s.getTextColor(),y:c.height+t.get("itemGap"),textBaseline:"top"},z2:10}),p=t.get("link"),g=t.get("sublink");h.silent=!p,f.silent=!g,p&&h.on("click",function(){window.open(p,"_"+t.get("target"));}),g&&f.on("click",function(){window.open(g,"_"+t.get("subtarget"));}),n.add(h),d&&n.add(f);var m=n.getBoundingRect(),v=t.getBoxLayoutParams();v.width=m.width,v.height=m.height;var y=o.getLayoutRect(v,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));l||(l=t.get("left")||t.get("right"),"middle"===l&&(l="center"),"right"===l?y.x+=y.width:"center"===l&&(y.x+=y.width/2)),u||(u=t.get("top")||t.get("bottom"),"center"===u&&(u="middle"),"bottom"===u?y.y+=y.height:"middle"===u&&(y.y+=y.height/2),u=u||"top"),n.attr("position",[y.x,y.y]);var x={textAlign:l,textVerticalAlign:u};h.setStyle(x),f.setStyle(x),m=n.getBoundingRect();var _=y.margin,b=t.getItemStyle(["color","opacity"]);b.fill=t.get("backgroundColor");var w=new r.Rect({shape:{x:m.x-_[3],y:m.y-_[0],width:m.width+_[1]+_[3],height:m.height+_[0]+_[2]},style:b,silent:!0});r.subPixelOptimizeRect(w),n.add(w);}}});},function(t,e,i){i(318),i(319),i(322),i(323),i(324),i(326),i(327),i(329),i(330);},function(t,e,i){i(19).registerSubTypeDefaulter("dataZoom",function(t){return"slider";});},function(t,e,i){function n(t){var e={};return c(["start","end","startValue","endValue","throttle"],function(i){t.hasOwnProperty(i)&&(e[i]=t[i]);}),e;}function r(t,e,i,n){null!=i[e]&&null==i[t]&&(n[t]=null);}var o=i(4),a=i(2),s=i(1),l=i(5),u=i(320),h=i(321),c=o.each,d=u.eachAxisDim,f=s.extendComponentModel({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null},init:function init(t,e,i){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0;var r=n(t);this.mergeDefaultAndTheme(t,i),this.doInit(r);},mergeOption:function mergeOption(t){var e=n(t);o.merge(this.option,t,!0),this.doInit(e);},doInit:function doInit(t){var e=this.option;a.canvasSupported||(e.realtime=!1),this._setDefaultThrottle(t),r("start","startValue",t,e),r("end","endValue",t,e),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies();},_giveAxisProxies:function _giveAxisProxies(){var t=this._axisProxies;this.eachTargetAxis(function(e,i,n,r){var o=this.dependentModels[e.axis][i],a=o.__dzAxisProxy||(o.__dzAxisProxy=new h(e.name,i,this,r));t[e.name+"_"+i]=a;},this);},_resetTarget:function _resetTarget(){var t=this.option,e=this._judgeAutoMode();d(function(e){var i=e.axisIndex;t[i]=l.normalizeToArray(t[i]);},this),"axisIndex"===e?this._autoSetAxisIndex():"orient"===e&&this._autoSetOrient();},_judgeAutoMode:function _judgeAutoMode(){var t=this.option,e=!1;d(function(i){null!=t[i.axisIndex]&&(e=!0);},this);var i=t.orient;return null==i&&e?"orient":e?void 0:(null==i&&(t.orient="horizontal"),"axisIndex");},_autoSetAxisIndex:function _autoSetAxisIndex(){var t=!0,e=this.get("orient",!0),i=this.option;if(t){var n="vertical"===e?{dim:"y",axisIndex:"yAxisIndex",axis:"yAxis"}:{dim:"x",axisIndex:"xAxisIndex",axis:"xAxis"};this.dependentModels[n.axis].length&&(i[n.axisIndex]=[0],t=!1);}t&&d(function(e){if(t){var n=[],r=this.dependentModels[e.axis];if(r.length&&!n.length)for(var o=0,a=r.length;a>o;o++){"category"===r[o].get("type")&&n.push(o);}i[e.axisIndex]=n,n.length&&(t=!1);}},this),t&&this.ecModel.eachSeries(function(t){this._isSeriesHasAllAxesTypeOf(t,"value")&&d(function(e){var n=i[e.axisIndex],r=t.get(e.axisIndex),a=t.get(e.axisId),s=t.ecModel.queryComponents({mainType:e.axis,index:r,id:a})[0];if(!s)throw new Error(e.axis+' "'+o.retrieve(r,a,0)+'" not found');r=s.componentIndex,o.indexOf(n,r)<0&&n.push(r);});},this);},_autoSetOrient:function _autoSetOrient(){var t;this.eachTargetAxis(function(e){!t&&(t=e.name);},this),this.option.orient="y"===t?"vertical":"horizontal";},_isSeriesHasAllAxesTypeOf:function _isSeriesHasAllAxesTypeOf(t,e){var i=!0;return d(function(n){var r=t.get(n.axisIndex),o=this.dependentModels[n.axis][r];o&&o.get("type")===e||(i=!1);},this),i;},_setDefaultThrottle:function _setDefaultThrottle(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&e.animationDurationUpdate>0?100:20;}},getFirstTargetAxisModel:function getFirstTargetAxisModel(){var t;return d(function(e){if(null==t){var i=this.get(e.axisIndex);i.length&&(t=this.dependentModels[e.axis][i[0]]);}},this),t;},eachTargetAxis:function eachTargetAxis(t,e){var i=this.ecModel;d(function(n){c(this.get(n.axisIndex),function(r){t.call(e,n,r,this,i);},this);},this);},getAxisProxy:function getAxisProxy(t,e){return this._axisProxies[t+"_"+e];},setRawRange:function setRawRange(t){c(["start","end","startValue","endValue"],function(e){this.option[e]=t[e];},this);},getPercentRange:function getPercentRange(){var t=this.findRepresentativeAxisProxy();return t?t.getDataPercentWindow():void 0;},getValueRange:function getValueRange(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var i=this.findRepresentativeAxisProxy();return i?i.getDataValueWindow():void 0;},findRepresentativeAxisProxy:function findRepresentativeAxisProxy(){var t=this._axisProxies;for(var e in t){if(t.hasOwnProperty(e)&&t[e].hostedBy(this))return t[e];}for(var e in t){if(t.hasOwnProperty(e)&&!t[e].hostedBy(this))return t[e];}}});t.exports=f;},function(t,e,i){var n=i(6),r=i(4),o={},a=["x","y","z","radius","angle"];o.createNameEach=function(t,e){t=t.slice();var i=r.map(t,n.capitalFirst);e=(e||[]).slice();var o=r.map(e,n.capitalFirst);return function(n,a){r.each(t,function(t,r){for(var s={name:t,capital:i[r]},l=0;l<e.length;l++){s[e[l]]=t+o[l];}n.call(a,s);});};},o.eachAxisDim=o.createNameEach(a,["axisIndex","axis","index","id"]),o.createLinkedNodesFinder=function(t,e,i){function n(t,e){return r.indexOf(e.nodes,t)>=0;}function o(t,n){var o=!1;return e(function(e){r.each(i(t,e)||[],function(t){n.records[e.name][t]&&(o=!0);});}),o;}function a(t,n){n.nodes.push(t),e(function(e){r.each(i(t,e)||[],function(t){n.records[e.name][t]=!0;});});}return function(i){function r(t){!n(t,s)&&o(t,s)&&(a(t,s),l=!0);}var s={nodes:[],records:{}};if(e(function(t){s.records[t.name]={};}),!i)return s;a(i,s);var l;do{l=!1,t(r);}while(l);return s;};},t.exports=o;},function(t,e,i){function n(t,e){var i=[1/0,-(1/0)];return u(e,function(e){var n=e.getData();n&&u(e.coordDimToDataDim(t),function(t){var e=n.getDataExtent(t);e[0]<i[0]&&(i[0]=e[0]),e[1]>i[1]&&(i[1]=e[1]);});},this),i;}function r(t,e,i){var n=i.getAxisModel(),r=n.axis.scale,a=[0,100],s=[t.start,t.end],c=[];return e=e.slice(),o(e,n,r),u(["startValue","endValue"],function(e){c.push(null!=t[e]?r.parse(t[e]):null);}),u([0,1],function(t){var i=c[t],n=s[t];null!=n||null==i?(null==n&&(n=a[t]),i=r.parse(l.linearMap(n,a,e,!0))):n=l.linearMap(i,e,a,!0),c[t]=i,s[t]=n;}),{valueWindow:h(c),percentWindow:h(s)};}function o(t,e,i){return u(["min","max"],function(n,r){var o=e.get(n,!0);null!=o&&(o+"").toLowerCase()!=="data"+n&&(t[r]=i.parse(o));}),e.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t;}function a(t,e){var i=t.getAxisModel(),n=t._percentWindow,r=t._valueWindow;if(n){var o=e||0===n[0]&&100===n[1],a=!e&&l.getPixelPrecision(r,[0,500]),s=!(e||20>a&&a>=0),u=e||o||s;i.setRange&&i.setRange(u?null:+r[0].toFixed(a),u?null:+r[1].toFixed(a));}}var s=i(4),l=i(7),u=s.each,h=l.asc,c=function c(t,e,i,n){this._dimName=t,this._axisIndex=e,this._valueWindow,this._percentWindow,this._dataExtent,this.ecModel=n,this._dataZoomModel=i;};c.prototype={constructor:c,hostedBy:function hostedBy(t){return this._dataZoomModel===t;},getDataExtent:function getDataExtent(){return this._dataExtent.slice();},getDataValueWindow:function getDataValueWindow(){return this._valueWindow.slice();},getDataPercentWindow:function getDataPercentWindow(){return this._percentWindow.slice();},getTargetSeriesModels:function getTargetSeriesModels(){var t=[],e=this.ecModel;return e.eachSeries(function(i){var n=i.get("coordinateSystem");if("cartesian2d"===n||"polar"===n){var r=this._dimName,o=e.queryComponents({mainType:r+"Axis",index:i.get(r+"AxisIndex"),id:i.get(r+"AxisId")})[0];this._axisIndex===(o&&o.componentIndex)&&t.push(i);}},this),t;},getAxisModel:function getAxisModel(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex);},getOtherAxisModel:function getOtherAxisModel(){var t,e,i=this._dimName,n=this.ecModel,r=this.getAxisModel(),o="x"===i||"y"===i;o?(e="gridIndex",t="x"===i?"y":"x"):(e="polarIndex",t="angle"===i?"radius":"angle");var a;return n.eachComponent(t+"Axis",function(t){(t.get(e)||0)===(r.get(e)||0)&&(a=t);}),a;},reset:function reset(t){if(t===this._dataZoomModel){var e=this._dataExtent=n(this._dimName,this.getTargetSeriesModels()),i=r(t.option,e,this);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,a(this);}},restore:function restore(t){t===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,a(this,!0));},filterData:function filterData(t){function e(t){return t>=o[0]&&t<=o[1];}if(t===this._dataZoomModel){var i=this._dimName,n=this.getTargetSeriesModels(),r=t.get("filterMode"),o=this._valueWindow,a=this.getOtherAxisModel();t.get("$fromToolbox")&&a&&"category"===a.get("type")&&(r="empty"),u(n,function(t){var n=t.getData();n&&u(t.coordDimToDataDim(i),function(i){"empty"===r?t.setData(n.map(i,function(t){return e(t)?t:NaN;})):n.filterSelf(i,e);});});}}},t.exports=c;},function(t,e,i){var n=i(29);t.exports=n.extend({type:"dataZoom",render:function render(t,e,i,n){this.dataZoomModel=t,this.ecModel=e,this.api=i;},getTargetInfo:function getTargetInfo(){function t(t,e,i,n){for(var r,o=0;o<i.length;o++){if(i[o].model===t){r=i[o];break;}}r||i.push(r={model:t,axisModels:[],coordIndex:n}),r.axisModels.push(e);}var e=this.dataZoomModel,i=this.ecModel,n=[],r=[],o=[];return e.eachTargetAxis(function(e,a){var s=i.getComponent(e.axis,a);if(s){o.push(s);var l,u=e.axis;"xAxis"===u||"yAxis"===u?l="grid":("angleAxis"===u||"radiusAxis"===u)&&(l="polar");var h=l?i.queryComponents({mainType:l,index:s.get(l+"Index"),id:s.get(l+"Id")})[0]:null;null!=h&&t(h,s,"grid"===l?n:r,h.componentIndex);}},this),{cartesians:n,polars:r,axisModels:o};}});},function(t,e,i){var n=i(319),r=n.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});t.exports=r;},function(t,e,i){function n(t){return"x"===t?"y":"x";}var r=i(4),o=i(43),a=i(309),s=i(322),l=o.Rect,u=i(7),h=u.linearMap,c=i(21),d=i(325),f=u.asc,p=r.bind,g=r.each,m=7,v=1,y=30,x="horizontal",_="vertical",b=5,w=["line","bar","candlestick","scatter"],S=s.extend({type:"dataZoom.slider",init:function init(t,e){this._displayables={},this._orient,this._range,this._handleEnds,this._size,this._handleWidth,this._handleHeight,this._location,this._dragging,this._dataShadowInfo,this.api=e;},render:function render(t,e,i,n){return S.superApply(this,"render",arguments),a.createOrUpdate(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=t.get("orient"),this.dataZoomModel.get("show")===!1?void this.group.removeAll():(n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),void this._updateView());},remove:function remove(){S.superApply(this,"remove",arguments),a.clear(this,"_dispatchZoomAction");},dispose:function dispose(){S.superApply(this,"dispose",arguments),a.clear(this,"_dispatchZoomAction");},_buildView:function _buildView(){var t=this.group;t.removeAll(),this._resetLocation(),this._resetInterval();var e=this._displayables.barGroup=new o.Group();this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup();},_resetLocation:function _resetLocation(){var t=this.dataZoomModel,e=this.api,i=this._findCoordRect(),n={width:e.getWidth(),height:e.getHeight()},o=this._orient===x?{right:n.width-i.x-i.width,top:n.height-y-m,width:i.width,height:y}:{right:m,top:i.y,width:y,height:i.height},a=c.getLayoutParams(t.option);r.each(["right","top","width","height"],function(t){"ph"===a[t]&&(a[t]=o[t]);});var s=c.getLayoutRect(a,n,t.padding);this._location={x:s.x,y:s.y},this._size=[s.width,s.height],this._orient===_&&this._size.reverse();},_positionGroup:function _positionGroup(){var t=this.group,e=this._location,i=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),r=n&&n.get("inverse"),o=this._displayables.barGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(i!==x||r?i===x&&r?{scale:a?[-1,1]:[-1,-1]}:i!==_||r?{scale:a?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:a?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:a?[1,1]:[1,-1]});var s=t.getBoundingRect([o]);t.attr("position",[e.x-s.x,e.y-s.y]);},_getViewExtent:function _getViewExtent(){return[0,this._size[0]];},_renderBackground:function _renderBackground(){var t=this.dataZoomModel,e=this._size;this._displayables.barGroup.add(new l({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40}));},_renderDataShadow:function _renderDataShadow(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(t){var e=this._size,i=t.series,n=i.getRawData(),a=i.getShadowDim?i.getShadowDim():t.otherDim,s=n.getDataExtent(a),l=.3*(s[1]-s[0]);s=[s[0]-l,s[1]+l];var u,c=[0,e[1]],d=[0,e[0]],f=[[e[0],0],[0,0]],p=[],g=d[1]/(n.count()-1),m=0,v=Math.round(n.count()/e[0]);n.each([a],function(t,e){if(v>0&&e%v)return void(m+=g);var i=null==t||isNaN(t)||""===t,n=i?0:h(t,s,c,!0);i&&!u&&e?(f.push([f[f.length-1][0],0]),p.push([p[p.length-1][0],0])):!i&&u&&(f.push([m,0]),p.push([m,0])),f.push([m,n]),p.push([m,n]),m+=g,u=i;});var y=this.dataZoomModel;this._displayables.barGroup.add(new o.Polygon({shape:{points:f},style:r.defaults({fill:y.get("dataBackgroundColor")},y.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new o.Polyline({shape:{points:p},style:y.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}));}},_prepareDataShadowInfo:function _prepareDataShadowInfo(){var t=this.dataZoomModel,e=t.get("showDataShadow");if(e!==!1){var i,o=this.ecModel;return t.eachTargetAxis(function(a,s){var l=t.getAxisProxy(a.name,s).getTargetSeriesModels();r.each(l,function(t){if(!(i||e!==!0&&r.indexOf(w,t.get("type"))<0)){var l=n(a.name),u=o.getComponent(a.axis,s).axis;i={thisAxis:u,series:t,thisDim:a.name,otherDim:l,otherAxisInverse:t.coordinateSystem.getOtherAxis(u).inverse};}},this);},this),i;}},_renderHandle:function _renderHandle(){var t=this._displayables,e=t.handles=[],i=t.handleLabels=[],n=this._displayables.barGroup,r=this._size,a=this.dataZoomModel;n.add(t.filler=new l({draggable:!0,cursor:"move",drift:p(this._onDragMove,this,"all"),ondragstart:p(this._showDataInfo,this,!0),ondragend:p(this._onDragEnd,this),onmouseover:p(this._showDataInfo,this,!0),onmouseout:p(this._showDataInfo,this,!1),style:{fill:a.get("fillerColor"),textPosition:"inside"}})),n.add(new l(o.subPixelOptimizeRect({silent:!0,shape:{x:0,y:0,width:r[0],height:r[1]},style:{stroke:a.get("dataBackgroundColor")||a.get("borderColor"),lineWidth:v,fill:"rgba(0,0,0,0)"}})));var s=a.get("handleIcon");g([0,1],function(t){var r=o.makePath(s,{style:{strokeNoScale:!0},rectHover:!0,cursor:"vertical"===this._orient?"ns-resize":"ew-resize",draggable:!0,drift:p(this._onDragMove,this,t),ondragend:p(this._onDragEnd,this),onmouseover:p(this._showDataInfo,this,!0),onmouseout:p(this._showDataInfo,this,!1)},{x:-.5,y:0,width:1,height:1},"center"),l=r.getBoundingRect();this._handleHeight=u.parsePercent(a.get("handleSize"),this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,r.setStyle(a.getModel("handleStyle").getItemStyle());var h=a.get("handleColor");null!=h&&(r.style.fill=h),n.add(e[t]=r);var c=a.textStyleModel;this.group.add(i[t]=new o.Text({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",fill:c.getTextColor(),textFont:c.getFont()},z2:10}));},this);},_resetInterval:function _resetInterval(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[h(t[0],[0,100],e,!0),h(t[1],[0,100],e,!0)];},_updateInterval:function _updateInterval(t,e){var i=this._handleEnds,n=this._getViewExtent();d(e,i,n,"all"===t||this.dataZoomModel.get("zoomLock")?"rigid":"cross",t),this._range=f([h(i[0],n,[0,100],!0),h(i[1],n,[0,100],!0)]);},_updateView:function _updateView(){var t=this._displayables,e=this._handleEnds,i=f(e.slice()),n=this._size;g([0,1],function(i){var r=t.handles[i],o=this._handleHeight;r.attr({scale:[o,o],position:[e[i],n[1]/2-o/2]});},this),t.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:n[1]}),this._updateDataInfo();},_updateDataInfo:function _updateDataInfo(){function t(t){var e=o.getTransform(i.handles[t].parent,this.group),s=o.transformDirection(0===t?"right":"left",e),l=this._handleWidth/2+b,h=o.applyTransform([u[t]+(0===t?-l:l),this._size[1]/2],e);n[t].setStyle({x:h[0],y:h[1],textVerticalAlign:r===x?"middle":s,textAlign:r===x?s:"center",text:a[t]});}var e=this.dataZoomModel,i=this._displayables,n=i.handleLabels,r=this._orient,a=["",""];if(e.get("showDetail")){var s,l;e.eachTargetAxis(function(t,i){s||(s=e.getAxisProxy(t.name,i).getDataValueWindow(),l=this.ecModel.getComponent(t.axis,i).axis);},this),s&&(a=[this._formatLabel(s[0],l),this._formatLabel(s[1],l)]);}var u=f(this._handleEnds.slice());t.call(this,0),t.call(this,1);},_formatLabel:function _formatLabel(t,e){var i=this.dataZoomModel,n=i.get("labelFormatter"),o=i.get("labelPrecision");(null==o||"auto"===o)&&(o=e.getPixelPrecision());var a=null==t&&isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel(Math.round(t)):t.toFixed(Math.min(o,20));return r.isFunction(n)?n(t,a):r.isString(n)?n.replace("{value}",a):a;},_showDataInfo:function _showDataInfo(t){t=this._dragging||t;var e=this._displayables.handleLabels;e[0].attr("invisible",!t),e[1].attr("invisible",!t);},_onDragMove:function _onDragMove(t,e,i){this._dragging=!0;var n=this._applyBarTransform([e,i],!0);this._updateInterval(t,n[0]),this._updateView(),this.dataZoomModel.get("realtime")&&this._dispatchZoomAction();},_onDragEnd:function _onDragEnd(){this._dragging=!1,this._showDataInfo(!1),this._dispatchZoomAction();},_dispatchZoomAction:function _dispatchZoomAction(){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:t[0],end:t[1]});},_applyBarTransform:function _applyBarTransform(t,e){var i=this._displayables.barGroup.getLocalTransform();return o.applyTransform(t,i,e);},_findCoordRect:function _findCoordRect(){var t,e=this.getTargetInfo();if(e.cartesians.length)t=e.cartesians[0].model.coordinateSystem.getRect();else{var i=this.api.getWidth(),n=this.api.getHeight();t={x:.2*i,y:.2*n,width:.6*i,height:.6*n};}return t;}});t.exports=S;},function(t,e){t.exports=function(t,e,i,n,r){function o(t,e,i){var n=e.length?e.slice():[e,e];return e[0]>e[1]&&n.reverse(),0>t&&n[0]+t<i[0]&&(t=i[0]-n[0]),t>0&&n[1]+t>i[1]&&(t=i[1]-n[1]),t;}return t?("rigid"===n?(t=o(t,e,i),e[0]+=t,e[1]+=t):(t=o(t,e[r],i),e[r]+=t,"push"===n&&e[0]>e[1]&&(e[1-r]=e[r])),e):e;};},function(t,e,i){t.exports=i(319).extend({type:"dataZoom.inside",defaultOption:{silent:!1,zoomLock:!1}});},function(t,e,i){function n(t){var e=[0,100];return!(t[0]<=e[1])&&(t[0]=e[1]),!(t[1]<=e[1])&&(t[1]=e[1]),!(t[0]>=e[0])&&(t[0]=e[0]),!(t[1]>=e[0])&&(t[1]=e[0]),t;}var r=i(322),o=i(4),a=i(325),s=i(328),l=o.bind,u=r.extend({type:"dataZoom.inside",init:function init(t,e){this._range;},render:function render(t,e,i,n){u.superApply(this,"render",arguments),s.shouldRecordRange(n,t.id)&&(this._range=t.getPercentRange());var r=this.getTargetInfo();o.each(["cartesians","polars"],function(e){var n=r[e],a=o.map(n,function(t){return s.generateCoordId(t.model);});o.each(n,function(n){var r=n.model,o=r.coordinateSystem;s.register(i,{coordId:s.generateCoordId(r),allCoordIds:a,coordinateSystem:o,containsPoint:l(h[e].containsPoint,this,o),dataZoomId:t.id,throttleRate:t.get("throttle",!0),panGetRange:l(this._onPan,this,n,e),zoomGetRange:l(this._onZoom,this,n,e)});},this);},this);},dispose:function dispose(){s.unregister(this.api,this.dataZoomModel.id),u.superApply(this,"dispose",arguments),this._range=null;},_onPan:function _onPan(t,e,i,n,r,o,s,l,u){if(this.dataZoomModel.option.silent)return this._range;var c=this._range.slice(),d=t.axisModels[0];if(d){var f=h[e].getDirectionInfo([o,s],[l,u],d,i,t),p=f.signal*(c[1]-c[0])*f.pixel/f.pixelLength;return a(p,c,[0,100],"rigid"),this._range=c;}},_onZoom:function _onZoom(t,e,i,r,o,a){var s=this.dataZoomModel.option;if(s.silent||s.zoomLock)return this._range;var l=this._range.slice(),u=t.axisModels[0];if(u){var c=h[e].getDirectionInfo(null,[o,a],u,i,t),d=(c.pixel-c.pixelStart)/c.pixelLength*(l[1]-l[0])+l[0];return r=Math.max(1/r,0),l[0]=(l[0]-d)*r+d,l[1]=(l[1]-d)*r+d,this._range=n(l);}}}),h={cartesians:{getDirectionInfo:function getDirectionInfo(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(a.pixel=e[0]-t[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a;},containsPoint:function containsPoint(t,e,i){return t.getRect().contain(e,i);}},polars:{getDirectionInfo:function getDirectionInfo(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===i.mainType?(a.pixel=e[0]-t[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=u[1]-u[0],a.pixelStart=u[0],a.signal=o.inverse?-1:1),a;},containsPoint:function containsPoint(t,e,i){var n=t.getRadiusAxis().getExtent()[1],r=t.cx,o=t.cy;return Math.pow(e-r,2)+Math.pow(i-o,2)<=Math.pow(n,2);}}};t.exports=u;},function(t,e,i){function n(t){var e=t.getZr();return e[p]||(e[p]={});}function r(t,e,i){var n=new c(t.getZr());return n.enable(),n.on("pan",f(a,i)),n.on("zoom",f(s,i)),n;}function o(t){h.each(t,function(e,i){e.count||(e.controller.dispose(),delete t[i]);});}function a(t,e,i,n,r,o,a){l(t,function(s){return s.panGetRange(t.controller,e,i,n,r,o,a);});}function s(t,e,i,n){l(t,function(r){return r.zoomGetRange(t.controller,e,i,n);});}function l(t,e){var i=[];h.each(t.dataZoomInfos,function(t){var n=e(t);n&&i.push({dataZoomId:t.dataZoomId,start:n[0],end:n[1]});}),t.dispatchAction(i);}function u(t,e){t.dispatchAction({type:"dataZoom",batch:e});}var h=i(4),c=i(175),d=i(309),f=h.curry,p="\x00_ec_dataZoom_roams",g={register:function register(t,e){var i=n(t),a=e.dataZoomId,s=e.coordId;h.each(i,function(t,i){var n=t.dataZoomInfos;n[a]&&h.indexOf(e.allCoordIds,s)<0&&(delete n[a],t.count--);}),o(i);var l=i[s];l||(l=i[s]={coordId:s,dataZoomInfos:{},count:0},l.controller=r(t,e,l),l.dispatchAction=h.curry(u,t)),l.controller.setContainsPoint(e.containsPoint),d.createOrUpdate(l,"dispatchAction",e.throttleRate,"fixRate"),!l.dataZoomInfos[a]&&l.count++,l.dataZoomInfos[a]=e;},unregister:function unregister(t,e){var i=n(t);h.each(i,function(t){t.controller.dispose();var i=t.dataZoomInfos;i[e]&&(delete i[e],t.count--);}),o(i);},shouldRecordRange:function shouldRecordRange(t,e){if(t&&"dataZoom"===t.type&&t.batch)for(var i=0,n=t.batch.length;n>i;i++){if(t.batch[i].dataZoomId===e)return!1;}return!0;},generateCoordId:function generateCoordId(t){return t.type+"\x00_"+t.id;}};t.exports=g;},function(t,e,i){function n(t,e,i){i.getAxisProxy(t.name,e).reset(i);}function r(t,e,i){i.getAxisProxy(t.name,e).filterData(i);}var o=i(1);o.registerProcessor(function(t,e){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(n),t.eachTargetAxis(r);}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy(),i=e.getDataPercentWindow(),n=e.getDataValueWindow();t.setRawRange({start:i[0],end:i[1],startValue:n[0],endValue:n[1]});});});},function(t,e,i){var n=i(4),r=i(320),o=i(1);o.registerAction("dataZoom",function(t,e){var i=r.createLinkedNodesFinder(n.bind(e.eachComponent,e,"dataZoom"),r.eachAxisDim,function(t,e){return t.get(e.axisIndex);}),o=[];e.eachComponent({mainType:"dataZoom",query:t},function(t,e){o.push.apply(o,i(t).nodes);}),n.each(o,function(e,i){e.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue});});});},function(t,e,i){i(332),i(343);},function(t,e,i){i(1).registerPreprocessor(i(333)),i(334),i(335),i(336),i(339),i(342);},function(t,e,i){function n(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e);}var r=i(4),o=r.each;t.exports=function(t){var e=t&&t.visualMap;r.isArray(e)||(e=e?[e]:[]),o(e,function(t){if(t){n(t,"splitList")&&!n(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var e=t.pieces;e&&r.isArray(e)&&o(e,function(t){r.isObject(t)&&(n(t,"start")&&!n(t,"min")&&(t.min=t.start),n(t,"end")&&!n(t,"max")&&(t.max=t.end));});}});};},function(t,e,i){i(19).registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?t.pieces.length>0:t.splitNumber>0)&&!t.calculable?"piecewise":"continuous";});},function(t,e,i){function n(t,e){t.eachTargetSeries(function(e){var i=e.getData();s.applyVisual(t.stateList,t.targetVisuals,i,t.getValueState,t,t.getDataDimension(i));});}function r(t){t.eachSeries(function(e){var i=e.getData(),n=[];t.eachComponent("visualMap",function(t){if(t.isTargetSeries(e)){var r={};n.push(r),r.stops=t.getStops(e,o),r.dimension=t.getDataDimension(i);}}),e.getData().setVisual("visualMeta",n);});}function o(t,e,i){function n(t){return s[t];}function r(t,e){s[t]=e;}for(var o=t.targetVisuals[i],a=l.prepareVisualTypes(o),s={},u=0,h=a.length;h>u;u++){var c=a[u],d=o["colorAlpha"===c?"__alphaForOpacity":c];d&&d.applyVisual(e,n,r);}return s.color;}var a=i(1),s=i(307),l=i(193);a.registerVisual(a.PRIORITY.VISUAL.COMPONENT,function(t){t.eachComponent("visualMap",function(e){n(e,t);}),r(t);});},function(t,e,i){function n(t,e,i){var n=t.targetVisuals[e].color;if(!n)return i.slice();var r=n.option.visual.length;if(1>=r||i[0]===i[1])return i.slice();for(var o=(i[1]-i[0])/(r-1),a=i[0],s=[],l=0;r>l&&a<i[1];l++){s.push(a),a+=o;}return s.push(i[1]),s;}function r(t,e,i,r){var o=n(t,e,i);a.each(o,function(t){for(var i={value:t,valueState:e},n=0,o=0;o<r.length;o++){if(n|="inRange"===r[o].valueState,t<r[o].value)return void r.splice(o,0,i);n&&(r[o].valueState="inRange");}r.push(i);});}var o=i(337),a=i(4),s=i(7),l=[20,140],u=o.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:!0},optionUpdated:function optionUpdated(t,e){u.superApply(this,"optionUpdated",arguments),this.resetTargetSeries(),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent();}),this._resetRange();},resetItemSize:function resetItemSize(){u.superApply(this,"resetItemSize",arguments);var t=this.itemSize;"horizontal"===this._orient&&t.reverse(),(null==t[0]||isNaN(t[0]))&&(t[0]=l[0]),(null==t[1]||isNaN(t[1]))&&(t[1]=l[1]);},_resetRange:function _resetRange(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):a.isArray(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]));},completeVisualOption:function completeVisualOption(){o.prototype.completeVisualOption.apply(this,arguments),a.each(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=0);},this);},setSelected:function setSelected(t){this.option.range=t.slice(),this._resetRange();},getSelected:function getSelected(){var t=this.getExtent(),e=s.asc((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e;},getValueState:function getValueState(t){var e=this.option.range,i=this.getExtent();return(e[0]<=i[0]||e[0]<=t)&&(e[1]>=i[1]||t<=e[1])?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(t){var e=[];return this.eachTargetSeries(function(i){var n=[],r=i.getData();r.each(this.getDataDimension(r),function(e,i){t[0]<=e&&e<=t[1]&&n.push(i);},!0,this),e.push({seriesId:i.id,dataIndex:n});},this),e;},getStops:function getStops(t,e){var i=[];return r(this,"outOfRange",this.getExtent(),i),r(this,"inRange",this.option.range.slice(),i),a.each(i,function(t){t.color=e(this,t.value,t.valueState);},this),i;}});t.exports=u;},function(t,e,i){var n=i(1),r=i(4),o=i(2),a=i(338),s=i(193),l=i(307),u=s.mapVisual,h=i(5),c=s.eachVisual,d=i(7),f=r.isArray,p=r.each,g=d.asc,m=d.linearMap,v=r.noop,y=["#f6efa6","#d88273","#bf444c"],x=n.extendComponentModel({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-(1/0),1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:null,min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function init(t,e,i){this._dataExtent,this.targetVisuals={},this.controllerVisuals={},this.textStyleModel,this.itemSize,this.mergeDefaultAndTheme(t,i);},optionUpdated:function optionUpdated(t,e){var i=this.option;o.canvasSupported||(i.realtime=!1),!e&&l.replaceVisualOption(i,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption();},resetVisual:function resetVisual(t){var e=this.stateList;t=r.bind(t,this),this.controllerVisuals=l.createVisualMappings(this.option.controller,e,t),this.targetVisuals=l.createVisualMappings(this.option.target,e,t);},resetTargetSeries:function resetTargetSeries(){var t=this.option,e=null==t.seriesIndex;t.seriesIndex=e?[]:h.normalizeToArray(t.seriesIndex),e&&this.ecModel.eachSeries(function(e,i){t.seriesIndex.push(i);});},eachTargetSeries:function eachTargetSeries(t,e){r.each(this.option.seriesIndex,function(i){t.call(e,this.ecModel.getSeriesByIndex(i));},this);},isTargetSeries:function isTargetSeries(t){var e=!1;return this.eachTargetSeries(function(i){i===t&&(e=!0);}),e;},formatValueText:function formatValueText(t,e,i){function n(t){return t===u[0]?"min":t===u[1]?"max":(+t).toFixed(l);}var o,a,s=this.option,l=s.precision,u=this.dataBound,h=s.formatter;return i=i||["<",">"],r.isArray(t)&&(t=t.slice(),o=!0),a=e?t:o?[n(t[0]),n(t[1])]:n(t),r.isString(h)?h.replace("{value}",o?a[0]:a).replace("{value2}",o?a[1]:a):r.isFunction(h)?o?h(t[0],t[1]):h(t):o?t[0]===u[0]?i[0]+" "+a[1]:t[1]===u[1]?i[1]+" "+a[0]:a[0]+" - "+a[1]:a;},resetExtent:function resetExtent(){var t=this.option,e=g([t.min,t.max]);this._dataExtent=e;},getDataDimension:function getDataDimension(t){var e=this.option.dimension;return null!=e?e:t.dimensions.length-1;},getExtent:function getExtent(){return this._dataExtent.slice();},completeVisualOption:function completeVisualOption(){function t(t){f(n.color)&&!t.inRange&&(t.inRange={color:n.color.slice().reverse()}),t.inRange=t.inRange||{color:y},p(this.stateList,function(e){var i=t[e];if(r.isString(i)){var n=a.get(i,"active",d);n?(t[e]={},t[e][i]=n):delete t[e];}},this);}function e(t,e,i){var n=t[e],r=t[i];n&&!r&&(r=t[i]={},p(n,function(t,e){if(s.isValidType(e)){var i=a.get(e,"inactive",d);null!=i&&(r[e]=i,"color"!==e||r.hasOwnProperty("opacity")||r.hasOwnProperty("colorAlpha")||(r.opacity=[0,0]));}}));}function i(t){var e=(t.inRange||{}).symbol||(t.outOfRange||{}).symbol,i=(t.inRange||{}).symbolSize||(t.outOfRange||{}).symbolSize,n=this.get("inactiveColor");p(this.stateList,function(o){var a=this.itemSize,s=t[o];s||(s=t[o]={color:d?n:[n]}),null==s.symbol&&(s.symbol=e&&r.clone(e)||(d?"roundRect":["roundRect"])),null==s.symbolSize&&(s.symbolSize=i&&r.clone(i)||(d?a[0]:[a[0],a[0]])),s.symbol=u(s.symbol,function(t){return"none"===t||"square"===t?"roundRect":t;});var l=s.symbolSize;if(null!=l){var h=-(1/0);c(l,function(t){t>h&&(h=t);}),s.symbolSize=u(l,function(t){return m(t,[0,h],[0,a[0]],!0);});}},this);}var n=this.option,o={inRange:n.inRange,outOfRange:n.outOfRange},l=n.target||(n.target={}),h=n.controller||(n.controller={});r.merge(l,o),r.merge(h,o);var d=this.isCategory();t.call(this,l),t.call(this,h),e.call(this,l,"inRange","outOfRange"),i.call(this,h);},resetItemSize:function resetItemSize(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))];},isCategory:function isCategory(){return!!this.option.categories;},setSelected:v,getValueState:v});t.exports=x;},function(t,e,i){var n=i(4),r={get:function get(t,e,i){var r=n.clone((o[t]||{})[e]);return i&&n.isArray(r)?r[r.length-1]:r;}},o={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}};t.exports=r;},function(t,e,i){function n(t,e,i,n){return new u.Polygon({shape:{points:t},draggable:!!i,cursor:e,drift:i,ondragend:n});}function r(t,e){return 0===t?[[0,0],[e,0],[e,-e]]:[[0,0],[e,0],[e,e]];}function o(t,e,i,n){return t?[[0,-y(e,x(i,0))],[b,0],[0,y(e,x(n-i,0))]]:[[0,0],[5,-5],[5,5]];}function a(t,e,i){var n=_/2,r=t.get("hoverLinkDataSize");return r&&(n=m(r,e,i,!0)/2),n;}function s(t){return!t.get("realtime")&&t.get("hoverLinkOnHandle");}var l=i(340),u=i(43),h=i(4),c=i(7),d=i(325),f=i(79),p=i(341),g=i(5),m=c.linearMap,v=h.each,y=Math.min,x=Math.max,_=12,b=6,w=l.extend({type:"visualMap.continuous",init:function init(){w.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._orient,this._useHandle,this._hoverLinkDataIndices=[],this._dragging,this._hovering;},doRender:function doRender(t,e,i,n){n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView();},_buildView:function _buildView(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var i=t.get("text");this._renderEndsText(e,i,0),this._renderEndsText(e,i,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e);},_renderEndsText:function _renderEndsText(t,e,i){if(e){var n=e[1-i];n=null!=n?n+"":"";var r=this.visualMapModel,o=r.get("textGap"),a=r.itemSize,s=this._shapes.barGroup,l=this._applyTransform([a[0]/2,0===i?-o:a[1]+o],s),h=this._applyTransform(0===i?"bottom":"top",s),c=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new u.Text({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===c?"middle":h,textAlign:"horizontal"===c?h:"center",text:n,textFont:d.getFont(),fill:d.getTextColor()}}));}},_renderBar:function _renderBar(t){var e=this.visualMapModel,i=this._shapes,r=e.itemSize,o=this._orient,a=this._useHandle,s=p.getItemAlign(e,this.api,r),l=i.barGroup=this._createBarGroup(s);l.add(i.outOfRange=n()),l.add(i.inRange=n(null,a?"move":null,h.bind(this._dragHandle,this,"all",!1),h.bind(this._dragHandle,this,"all",!0)));var u=e.textStyleModel.getTextRect(""),c=x(u.width,u.height);a&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(l,0,r,c,o,s),this._createHandle(l,1,r,c,o,s)),this._createIndicator(l,r,c,o),t.add(l);},_createHandle:function _createHandle(t,e,i,o,a){var s=h.bind(this._dragHandle,this,e,!1),l=h.bind(this._dragHandle,this,e,!0),c=n(r(e,o),"move",s,l);c.position[0]=i[0],t.add(c);var d=this.visualMapModel.textStyleModel,f=new u.Text({draggable:!0,drift:s,ondragend:l,style:{x:0,y:0,text:"",textFont:d.getFont(),fill:d.getTextColor()}});this.group.add(f);var p=["horizontal"===a?o/2:1.5*o,"horizontal"===a?0===e?-(1.5*o):1.5*o:0===e?-o/2:o/2],g=this._shapes;g.handleThumbs[e]=c,g.handleLabelPoints[e]=p,g.handleLabels[e]=f;},_createIndicator:function _createIndicator(t,e,i,r){var o=n([[0,0]],"move");o.position[0]=e[0],o.attr({invisible:!0,silent:!0}),t.add(o);var a=this.visualMapModel.textStyleModel,s=new u.Text({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:a.getFont(),fill:a.getTextColor()}});this.group.add(s);var l=["horizontal"===r?i/2:b+3,0],h=this._shapes;h.indicator=o,h.indicatorLabel=s,h.indicatorLabelPoint=l;},_dragHandle:function _dragHandle(t,e,i,n){if(this._useHandle){if(this._dragging=!e,!e){var r=this._applyTransform([i,n],this._shapes.barGroup,!0);this._updateInterval(t,r[1]),this._updateView();}e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?!this._hovering&&this._clearHoverLinkToSeries():s(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1);}},_resetInterval:function _resetInterval(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),i=t.getExtent(),n=[0,t.itemSize[1]];this._handleEnds=[m(e[0],i,n,!0),m(e[1],i,n,!0)];},_updateInterval:function _updateInterval(t,e){e=e||0;var i=this.visualMapModel,n=this._handleEnds;d(e,n,[0,i.itemSize[1]],"all"===t?"rigid":"push",t);var r=i.getExtent(),o=[0,i.itemSize[1]];this._dataInterval=[m(n[0],o,r,!0),m(n[1],o,r,!0)];},_updateView:function _updateView(t){var e=this.visualMapModel,i=e.getExtent(),n=this._shapes,r=[0,e.itemSize[1]],o=t?r:this._handleEnds,a=this._createBarVisual(this._dataInterval,i,o,"inRange"),s=this._createBarVisual(i,i,r,"outOfRange");n.inRange.setStyle({fill:a.barColor,opacity:a.opacity}).setShape("points",a.barPoints),n.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(o,a);},_createBarVisual:function _createBarVisual(t,e,i,n){var r={forceState:n,convertOpacityToAlpha:!0},o=this._makeColorGradient(t,r),a=[this.getControllerVisual(t[0],"symbolSize",r),this.getControllerVisual(t[1],"symbolSize",r)],s=this._createBarPoints(i,a);return{barColor:new f(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]};},_makeColorGradient:function _makeColorGradient(t,e){var i=100,n=[],r=(t[1]-t[0])/i;n.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var o=1;i>o;o++){var a=t[0]+r*o;if(a>t[1])break;n.push({color:this.getControllerVisual(a,"color",e),offset:o/i});}return n.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),n;},_createBarPoints:function _createBarPoints(t,e){var i=this.visualMapModel.itemSize;return[[i[0]-e[0],t[0]],[i[0],t[0]],[i[0],t[1]],[i[0]-e[1],t[1]]];},_createBarGroup:function _createBarGroup(t){var e=this._orient,i=this.visualMapModel.get("inverse");return new u.Group("horizontal"!==e||i?"horizontal"===e&&i?{scale:"bottom"===t?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==e||i?{scale:"left"===t?[1,1]:[-1,1]}:{scale:"left"===t?[1,-1]:[-1,-1]}:{scale:"bottom"===t?[1,1]:[-1,1],rotation:Math.PI/2});},_updateHandle:function _updateHandle(t,e){if(this._useHandle){var i=this._shapes,n=this.visualMapModel,r=i.handleThumbs,o=i.handleLabels;v([0,1],function(a){var s=r[a];s.setStyle("fill",e.handlesColor[a]),s.position[1]=t[a];var l=u.applyTransform(i.handleLabelPoints[a],u.getTransform(s,this.group));o[a].setStyle({x:l[0],y:l[1],text:n.formatValueText(this._dataInterval[a]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===a?"bottom":"top":"left",i.barGroup)});},this);}},_showIndicator:function _showIndicator(t,e,i,n){var r=this.visualMapModel,a=r.getExtent(),s=r.itemSize,l=[0,s[1]],h=m(t,a,l,!0),c=this._shapes,d=c.indicator;if(d){d.position[1]=h,d.attr("invisible",!1),d.setShape("points",o(!!i,n,h,s[1]));var f={convertOpacityToAlpha:!0},p=this.getControllerVisual(t,"color",f);d.setStyle("fill",p);var g=u.applyTransform(c.indicatorLabelPoint,u.getTransform(d,this.group)),v=c.indicatorLabel;v.attr("invisible",!1);var y=this._applyTransform("left",c.barGroup),x=this._orient;v.setStyle({text:(i?i:"")+r.formatValueText(e),textVerticalAlign:"horizontal"===x?y:"middle",textAlign:"horizontal"===x?"center":y,x:g[0],y:g[1]});}},_enableHoverLinkToSeries:function _enableHoverLinkToSeries(){var t=this;this._shapes.barGroup.on("mousemove",function(e){if(t._hovering=!0,!t._dragging){var i=t.visualMapModel.itemSize,n=t._applyTransform([e.offsetX,e.offsetY],t._shapes.barGroup,!0,!0);n[1]=y(x(0,n[1]),i[1]),t._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=i[0]);}}).on("mouseout",function(){t._hovering=!1,!t._dragging&&t._clearHoverLinkToSeries();});},_enableHoverLinkFromSeries:function _enableHoverLinkFromSeries(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries();},_doHoverLinkToSeries:function _doHoverLinkToSeries(t,e){var i=this.visualMapModel,n=i.itemSize;if(i.option.hoverLink){var r=[0,n[1]],o=i.getExtent();t=y(x(r[0],t),r[1]);var l=a(i,o,r),u=[t-l,t+l],h=m(t,r,o,!0),c=[m(u[0],r,o,!0),m(u[1],r,o,!0)];u[0]<r[0]&&(c[0]=-(1/0)),u[1]>r[1]&&(c[1]=1/0),e&&(c[0]===-(1/0)?this._showIndicator(h,c[1],"< ",l):c[1]===1/0?this._showIndicator(h,c[0],"> ",l):this._showIndicator(h,h," ",l));var d=this._hoverLinkDataIndices,f=[];(e||s(i))&&(f=this._hoverLinkDataIndices=i.findTargetDataIndices(c));var v=g.compressBatches(d,f);this._dispatchHighDown("downplay",p.convertDataIndex(v[0])),this._dispatchHighDown("highlight",p.convertDataIndex(v[1]));}},_hoverLinkFromSeriesMouseOver:function _hoverLinkFromSeriesMouseOver(t){var e=t.target;if(e&&null!=e.dataIndex){var i=e.dataModel||this.ecModel.getSeriesByIndex(e.seriesIndex),n=i.getData(e.dataType),r=n.getDimension(this.visualMapModel.getDataDimension(n)),o=n.get(r,e.dataIndex,!0);isNaN(o)||this._showIndicator(o,o);}},_hideIndicator:function _hideIndicator(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0);},_clearHoverLinkToSeries:function _clearHoverLinkToSeries(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",p.convertDataIndex(t)),t.length=0;},_clearHoverLinkFromSeries:function _clearHoverLinkFromSeries(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator);},_applyTransform:function _applyTransform(t,e,i,n){var r=u.getTransform(e,n?null:this.group);return u[h.isArray(t)?"applyTransform":"transformDirection"](t,r,i);},_dispatchHighDown:function _dispatchHighDown(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e});},dispose:function dispose(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();},remove:function remove(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries();}});t.exports=w;},function(t,e,i){var n=i(4),r=i(43),o=i(6),a=i(21),s=i(1),l=i(193);t.exports=s.extendComponentView({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function init(t,e){this.ecModel=t,this.api=e,this.visualMapModel;},render:function render(t,e,i,n){return this.visualMapModel=t,t.get("show")===!1?void this.group.removeAll():void this.doRender.apply(this,arguments);},renderBackground:function renderBackground(t){var e=this.visualMapModel,i=o.normalizeCssArray(e.get("padding")||0),n=t.getBoundingRect();t.add(new r.Rect({z2:-1,silent:!0,shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[3]+i[1],height:n.height+i[0]+i[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}));},getControllerVisual:function getControllerVisual(t,e,i){function r(t){return u[t];}function o(t,e){u[t]=e;}i=i||{};var a=i.forceState,s=this.visualMapModel,u={};if("symbol"===e&&(u.symbol=s.get("itemSymbol")),"color"===e){var h=s.get("contentColor");u.color=h;}var c=s.controllerVisuals[a||s.getValueState(t)],d=l.prepareVisualTypes(c);return n.each(d,function(n){var a=c[n];i.convertOpacityToAlpha&&"opacity"===n&&(n="colorAlpha",a=c.__alphaForOpacity),l.dependsOn(n,e)&&a&&a.applyVisual(t,r,o);}),u[e];},positionGroup:function positionGroup(t){var e=this.visualMapModel,i=this.api;a.positionGroup(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()});},doRender:n.noop});},function(t,e,i){var n=i(4),r=i(21),o={getItemAlign:function getItemAlign(t,e,i){var n=t.option,o=n.align;if(null!=o&&"auto"!==o)return o;for(var a={width:e.getWidth(),height:e.getHeight()},s="horizontal"===n.orient?1:0,l=[["left","right","width"],["top","bottom","height"]],u=l[s],h=[0,null,10],c={},d=0;3>d;d++){c[l[1-s][d]]=h[d],c[u[d]]=2===d?i[0]:n[u[d]];}var f=[["x","width",3],["y","height",0]][s],p=r.getLayoutRect(c,a,n.padding);return u[(p.margin[f[2]]||0)+p[f[0]]+.5*p[f[1]]<.5*a[f[1]]?0:1];},convertDataIndex:function convertDataIndex(t){return n.each(t||[],function(e){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null);}),t;}};t.exports=o;},function(t,e,i){var n=i(1),r={type:"selectDataRange",event:"dataRangeSelected",update:"update"};n.registerAction(r,function(t,e){e.eachComponent({mainType:"visualMap",query:t},function(e){e.setSelected(t.selected);});});},function(t,e,i){i(1).registerPreprocessor(i(333)),i(334),i(335),i(344),i(345),i(342);},function(t,e,i){function n(t,e){var i=t.inverse;("vertical"===t.orient?!i:i)&&e.reverse();}function r(t){function e(t,i,n){return n=n||0,t.interval[n]<i.interval[n]||t.interval[n]===i.interval[n]&&(+t.close[n]>i.close[n]||e(t,i,1));}t.sort(function(t,i){return e(t,i)?-1:1;});for(var i=-(1/0),n=0;n<t.length;n++){for(var r=t[n].interval,o=t[n].close,a=0;2>a;a++){r[a]<i&&(r[a]=i,o[a]=1-a),i=r[a];}}}var o=i(337),a=i(4),s=i(193),l=o.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0},optionUpdated:function optionUpdated(t,e){l.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetTargetSeries(),this.resetExtent();var i=this._mode=this._determineMode();u[this._mode].call(this),this._resetSelected(t,e);var n=this.option.categories;this.resetVisual(function(t,e){"categories"===i?(t.mappingMethod="category",t.categories=a.clone(n)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=a.map(this._pieceList,function(t){var t=a.clone(t);return"inRange"!==e&&(t.visual=null),t;}));});},_resetSelected:function _resetSelected(t,e){var i=this.option,n=this._pieceList,r=(e?i:t).selected||{};if(i.selected=r,a.each(n,function(t,e){var i=this.getSelectedMapKey(t);r.hasOwnProperty(i)||(r[i]=!0);},this),"single"===i.selectedMode){var o=!1;a.each(n,function(t,e){var i=this.getSelectedMapKey(t);r[i]&&(o?r[i]=!1:o=!0);},this);}},getSelectedMapKey:function getSelectedMapKey(t){return"categories"===this._mode?t.value+"":t.index+"";},getPieceList:function getPieceList(){return this._pieceList;},_determineMode:function _determineMode(){var t=this.option;return t.pieces&&t.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber";},setSelected:function setSelected(t){this.option.selected=a.clone(t);},getValueState:function getValueState(t){var e=s.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange";},findTargetDataIndices:function findTargetDataIndices(t){var e=[];return this.eachTargetSeries(function(i){var n=[],r=i.getData();r.each(this.getDataDimension(r),function(e,i){var r=s.findPieceIndex(e,this._pieceList);r===t&&n.push(i);},!0,this),e.push({seriesId:i.id,dataIndex:n});},this),e;},getRepresentValue:function getRepresentValue(t){var e;if(this.isCategory())e=t.value;else if(null!=t.value)e=t.value;else{var i=t.interval||[];e=(i[0]+i[1])/2;}return e;},getStops:function getStops(t,e){function i(t){n.push(t),t.color=e(r,r.getRepresentValue(t),t.valueState);}var n=[],r=this,o=-(1/0);return a.each(this._pieceList,function(t){var e=t.interval;e&&(e[0]>o&&i({interval:[o,e[0]],valueState:"outOfRange"}),i({interval:e.slice(),valueState:this.getValueState((e[0]+e[1])/2)}),o=e[1]);},this),n;}}),u={splitNumber:function splitNumber(){var t=this.option,e=this._pieceList,i=t.precision,n=this.getExtent(),o=t.splitNumber;o=Math.max(parseInt(o,10),1),t.splitNumber=o;for(var s=(n[1]-n[0])/o;+s.toFixed(i)!==s&&5>i;){i++;}t.precision=i,s=+s.toFixed(i);var l=0;t.minOpen&&e.push({index:l++,interval:[-(1/0),n[0]],close:[0,0]});for(var u=n[0],h=l+o;h>l;u+=s){var c=l===o-1?n[1]:u+s;e.push({index:l++,interval:[u,c],close:[1,1]});}t.maxOpen&&e.push({index:l++,interval:[n[1],1/0],close:[0,0]}),r(e),a.each(e,function(t){t.text=this.formatValueText(t.interval);},this);},categories:function categories(){var t=this.option;a.each(t.categories,function(t){this._pieceList.push({text:this.formatValueText(t,!0),value:t});},this),n(t,this._pieceList);},pieces:function pieces(){var t=this.option,e=this._pieceList;a.each(t.pieces,function(t,i){a.isObject(t)||(t={value:t});var n={text:"",index:i};if(null!=t.label&&(n.text=t.label),t.hasOwnProperty("value")){var r=n.value=t.value;n.interval=[r,r],n.close=[1,1];}else{for(var o=n.interval=[],l=n.close=[0,0],u=[1,0,1],h=[-(1/0),1/0],c=[],d=0;2>d;d++){for(var f=[["gte","gt","min"],["lte","lt","max"]][d],p=0;3>p&&null==o[d];p++){o[d]=t[f[p]],l[d]=u[p],c[d]=2===p;}null==o[d]&&(o[d]=h[d]);}c[0]&&o[1]===1/0&&(l[0]=0),c[1]&&o[0]===-(1/0)&&(l[1]=0),o[0]>o[1]&&console.warn("Piece "+i+"is illegal: "+o+" lower bound should not greater then uppper bound."),o[0]===o[1]&&l[0]&&l[1]&&(n.value=o[0]);}n.visual=s.retrieveVisuals(t),e.push(n);},this),n(t,e),r(e),a.each(e,function(t){var e=t.close,i=[["<",""][e[1]],[">",""][e[0]]];t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,i);},this);}};t.exports=l;},function(t,e,i){var n=i(340),r=i(4),o=i(43),a=i(106),s=i(21),l=i(341),u=n.extend({type:"visualMap.piecewise",doRender:function doRender(){function t(t){var a=t.piece,s=new o.Group();s.onclick=r.bind(this._onItemClick,this,a),this._enableHoverLink(s,t.indexInModelPieceList);var d=i.getRepresentValue(a);if(this._createItemSymbol(s,d,[0,0,c[0],c[1]]),f){var p=this.visualMapModel.getValueState(d);s.add(new o.Text({style:{x:"right"===h?-n:c[0]+n,y:c[1]/2,text:a.text,textVerticalAlign:"middle",textAlign:h,textFont:l,fill:u,opacity:"outOfRange"===p?.5:1}}));}e.add(s);}var e=this.group;e.removeAll();var i=this.visualMapModel,n=i.get("textGap"),a=i.textStyleModel,l=a.getFont(),u=a.getTextColor(),h=this._getItemAlign(),c=i.itemSize,d=this._getViewData(),f=!d.endsText,p=!f;p&&this._renderEndsText(e,d.endsText[0],c),r.each(d.viewPieceList,t,this),p&&this._renderEndsText(e,d.endsText[1],c),s.box(i.get("orient"),e,i.get("itemGap")),this.renderBackground(e),this.positionGroup(e);},_enableHoverLink:function _enableHoverLink(t,e){function i(t){var i=this.visualMapModel;i.option.hoverLink&&this.api.dispatchAction({type:t,batch:l.convertDataIndex(i.findTargetDataIndices(e))});}t.on("mouseover",r.bind(i,this,"highlight")).on("mouseout",r.bind(i,this,"downplay"));},_getItemAlign:function _getItemAlign(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return l.getItemAlign(t,this.api,t.itemSize);var i=e.align;return i&&"auto"!==i||(i="left"),i;},_renderEndsText:function _renderEndsText(t,e,i){if(e){var n=new o.Group(),r=this.visualMapModel.textStyleModel;n.add(new o.Text({style:{x:i[0]/2,y:i[1]/2,textVerticalAlign:"middle",textAlign:"center",text:e,textFont:r.getFont(),fill:r.getTextColor()}})),t.add(n);}},_getViewData:function _getViewData(){var t=this.visualMapModel,e=r.map(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e};}),i=t.get("text"),n=t.get("orient"),o=t.get("inverse");return("horizontal"===n?o:!o)?e.reverse():i&&(i=i.slice().reverse()),{viewPieceList:e,endsText:i};},_createItemSymbol:function _createItemSymbol(t,e,i){t.add(a.createSymbol(this.getControllerVisual(e,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(e,"color")));},_onItemClick:function _onItemClick(t){var e=this.visualMapModel,i=e.option,n=r.clone(i.selected),o=e.getSelectedMapKey(t);"single"===i.selectedMode?(n[o]=!0,r.each(n,function(t,e){n[e]=e===o;})):n[o]=!n[o],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:n});}});t.exports=u;},function(t,e,i){i(347),i(349),i(1).registerPreprocessor(function(t){t.markPoint=t.markPoint||{};});},function(t,e,i){t.exports=i(348).extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"inside"},emphasis:{show:!0}},itemStyle:{normal:{borderWidth:2}}}});},function(t,e,i){function n(t){r.defaultEmphasis(t.label,r.LABEL_OPTIONS);}var r=i(5),o=i(4),a=i(2),s=i(6),l=s.addCommas,u=s.encodeHTML,h=i(1).extendComponentModel({type:"marker",dependencies:["series","grid","polar","geo"],init:function init(t,e,i,n){if("marker"===this.type)throw new Error("Marker component is abstract component. Use markLine, markPoint, markArea instead.");this.mergeDefaultAndTheme(t,i),this.mergeOption(t,i,n.createdBySelf,!0);},ifEnableAnimation:function ifEnableAnimation(){if(a.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.ifEnableAnimation();},mergeOption:function mergeOption(t,e,i,r){var a=this.constructor,s=this.mainType+"Model";i||e.eachSeries(function(t){var i=t.get(this.mainType),l=t[s];return i&&i.data?(l?l.mergeOption(i,e,!0):(r&&n(i),o.each(i.data,function(t){t instanceof Array?(n(t[0]),n(t[1])):n(t);}),l=new a(i,this,e),o.extend(l,{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),l.__hostSeries=t),void(t[s]=l)):void(t[s]=null);},this);},formatTooltip:function formatTooltip(t){var e=this.getData(),i=this.getRawValue(t),n=o.isArray(i)?o.map(i,l).join(", "):l(i),r=e.getName(t),a=this.name;return(null!=i||r)&&(a+="<br />"),r&&(a+=u(r),null!=i&&(a+=" : ")),null!=i&&(a+=n),a;},getData:function getData(){return this._data;},setData:function setData(t){this._data=t;}});o.mixin(h,r.dataFormatMixin),t.exports=h;},function(t,e,i){function n(t,e,i){var n=e.coordinateSystem;t.each(function(r){var o,a=t.getItemModel(r),l=s.parsePercent(a.get("x"),i.getWidth()),u=s.parsePercent(a.get("y"),i.getHeight());if(isNaN(l)||isNaN(u)){if(e.getMarkerPosition)o=e.getMarkerPosition(t.getValues(t.dimensions,r));else if(n){var h=t.get(n.dimensions[0],r),c=t.get(n.dimensions[1],r);o=n.dataToPoint([h,c]);}}else o=[l,u];isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u),t.setItemLayout(r,o);});}function r(t,e,i){var n;n=t?a.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}):[{name:"value",type:"float"}];var r=new l(n,i),o=a.map(i.get("data"),a.curry(u.dataTransform,e));return t&&(o=a.filter(o,a.curry(u.dataFilter,t))),r.initData(o,null,t?u.dimValueGetter:function(t){return t.value;}),r;}var o=i(104),a=i(4),s=i(7),l=i(97),u=i(350);i(351).extend({type:"markPoint",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markPointModel;e&&(n(e.getData(),t,i),this.markerGroupMap[t.name].updateLayout(e));},this);},renderSeries:function renderSeries(t,e,i,a){var s=t.coordinateSystem,l=t.name,u=t.getData(),h=this.markerGroupMap,c=h[l];c||(c=h[l]=new o());var d=r(s,t,e);e.setData(d),n(e.getData(),t,a),d.each(function(t){var i=d.getItemModel(t),n=i.getShallow("symbolSize");"function"==typeof n&&(n=n(e.getRawValue(t),e.getDataParams(t))),d.setItemVisual(t,{symbolSize:n,color:i.get("itemStyle.normal.color")||u.getVisual("color"),symbol:i.getShallow("symbol")});}),c.updateData(d),this.group.add(c.group),d.eachItemGraphicEl(function(t){t.traverse(function(t){t.dataModel=e;});}),c.__keep=!0,c.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){function n(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)));}function r(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y));}function o(t,e,i){var n=-1;do{n=Math.max(l.getPrecision(t.get(e,i)),n),t=t.stackedOn;}while(t);return n;}function a(t,e,i,n,r,a){var s=[],l=m(e,n,t),u=e.indexOfNearest(n,l,!0);s[r]=e.get(i,u,!0),s[a]=e.get(n,u,!0);var h=o(e,n,u);return h>=0&&(s[a]=+s[a].toFixed(h)),s;}var s=i(4),l=i(7),u=s.indexOf,h=s.curry,c={min:h(a,"min"),max:h(a,"max"),average:h(a,"average")},d=function d(t,e){var i=t.getData(),n=t.coordinateSystem;if(e&&!r(e)&&!s.isArray(e.coord)&&n){var o=n.dimensions,a=f(e,i,n,t);if(e=s.clone(e),e.type&&c[e.type]&&a.baseAxis&&a.valueAxis){var l=u(o,a.baseAxis.dim),h=u(o,a.valueAxis.dim);e.coord=c[e.type](i,a.baseDataDim,a.valueDataDim,l,h),e.value=e.coord[h];}else{for(var d=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],p=0;2>p;p++){if(c[d[p]]){var g=t.coordDimToDataDim(o[p])[0];d[p]=m(i,g,d[p]);}}e.coord=d;}}return e;},f=function f(t,e,i,n){var r={};return null!=t.valueIndex||null!=t.valueDim?(r.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,r.valueAxis=i.getAxis(n.dataDimToCoordDim(r.valueDataDim)),r.baseAxis=i.getOtherAxis(r.valueAxis),r.baseDataDim=n.coordDimToDataDim(r.baseAxis.dim)[0]):(r.baseAxis=n.getBaseAxis(),r.valueAxis=i.getOtherAxis(r.baseAxis),r.baseDataDim=n.coordDimToDataDim(r.baseAxis.dim)[0],r.valueDataDim=n.coordDimToDataDim(r.valueAxis.dim)[0]),r;},p=function p(t,e){return t&&t.containData&&e.coord&&!n(e)?t.containData(e.coord):!0;},g=function g(t,e,i,n){return 2>n?t.coord&&t.coord[n]:t.value;},m=function m(t,e,i){if("average"===i){var n=0,r=0;return t.each(e,function(t,e){isNaN(t)||(n+=t,r++);},!0),n/r;}return t.getDataExtent(e,!0)["max"===i?1:0];};t.exports={dataTransform:d,dataFilter:p,dimValueGetter:g,getAxisInfo:f,numCalculate:m};},function(t,e,i){t.exports=i(1).extendComponentView({type:"marker",init:function init(){this.markerGroupMap={};},render:function render(t,e,i){var n=this.markerGroupMap;for(var r in n){n.hasOwnProperty(r)&&(n[r].__keep=!1);}var o=this.type+"Model";e.eachSeries(function(t){var n=t[o];n&&this.renderSeries(t,n,e,i);},this);for(var r in n){n.hasOwnProperty(r)&&!n[r].__keep&&this.group.remove(n[r].group);}},renderSeries:function renderSeries(){}});},function(t,e,i){i(353),i(354),i(1).registerPreprocessor(function(t){t.markLine=t.markLine||{};});},function(t,e,i){t.exports=i(348).extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{normal:{show:!0,position:"end"},emphasis:{show:!0}},lineStyle:{normal:{type:"dashed"},emphasis:{width:3}},animationEasing:"linear"}});},function(t,e,i){function n(t){return!isNaN(t)&&!isFinite(t);}function r(t,e,i,r){var o=1-t,a=r.dimensions[t];return n(e[o])&&n(i[o])&&e[t]===i[t]&&r.getAxis(a).containData(e[t]);}function o(t,e){if("cartesian2d"===t.type){var i=e[0].coord,n=e[1].coord;if(i&&n&&(r(1,i,n,t)||r(0,i,n,t)))return!0;}return c.dataFilter(t,e[0])&&c.dataFilter(t,e[1]);}function a(t,e,i,r,o){var a,s=r.coordinateSystem,l=t.getItemModel(e),u=h.parsePercent(l.get("x"),o.getWidth()),c=h.parsePercent(l.get("y"),o.getHeight());if(isNaN(u)||isNaN(c)){if(r.getMarkerPosition)a=r.getMarkerPosition(t.getValues(t.dimensions,e));else{var d=s.dimensions,f=t.get(d[0],e),p=t.get(d[1],e);a=s.dataToPoint([f,p]);}if("cartesian2d"===s.type){var g=s.getAxis("x"),m=s.getAxis("y"),d=s.dimensions;n(t.get(d[0],e))?a[0]=g.toGlobalCoord(g.getExtent()[i?0:1]):n(t.get(d[1],e))&&(a[1]=m.toGlobalCoord(m.getExtent()[i?0:1]));}isNaN(u)||(a[0]=u),isNaN(c)||(a[1]=c);}else a=[u,c];t.setItemLayout(e,a);}function s(t,e,i){var n;n=t?l.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}):[{name:"value",type:"float"}];var r=new u(n,i),a=new u(n,i),s=new u([],i),h=l.map(i.get("data"),l.curry(f,e,t,i));t&&(h=l.filter(h,l.curry(o,t)));var d=t?c.dimValueGetter:function(t){return t.value;};return r.initData(l.map(h,function(t){return t[0];}),null,d),a.initData(l.map(h,function(t){return t[1];}),null,d),s.initData(l.map(h,function(t){return t[2];})),s.hasItemOption=!0,{from:r,to:a,line:s};}var l=i(4),u=i(97),h=i(7),c=i(350),d=i(200),f=function f(t,e,i,n){var r=t.getData(),o=n.type;if(!l.isArray(n)&&("min"===o||"max"===o||"average"===o||null!=n.xAxis||null!=n.yAxis)){var a,s,u;if(null!=n.yAxis||null!=n.xAxis)s=null!=n.yAxis?"y":"x",a=e.getAxis(s),u=l.retrieve(n.yAxis,n.xAxis);else{var h=c.getAxisInfo(n,r,e,t);s=h.valueDataDim,a=h.valueAxis,u=c.numCalculate(r,s,o);}var d="x"===s?0:1,f=1-d,p=l.clone(n),g={};p.type=null,p.coord=[],g.coord=[],p.coord[f]=-(1/0),g.coord[f]=1/0;var m=i.get("precision");m>=0&&"number"==typeof u&&(u=+u.toFixed(m)),p.coord[d]=g.coord[d]=u,n=[p,g,{type:o,valueIndex:n.valueIndex,value:u}];}return n=[c.dataTransform(t,n[0]),c.dataTransform(t,n[1]),l.extend({},n[2])],n[2].type=n[2].type||"",l.merge(n[2],n[0]),l.merge(n[2],n[1]),n;};i(351).extend({type:"markLine",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markLineModel;if(e){var n=e.getData(),r=e.__from,o=e.__to;r.each(function(e){a(r,e,!0,t,i),a(o,e,!1,t,i);}),n.each(function(t){n.setItemLayout(t,[r.getItemLayout(t),o.getItemLayout(t)]);}),this.markerGroupMap[t.name].updateLayout();}},this);},renderSeries:function renderSeries(t,e,i,n){function r(e,i,r){var o=e.getItemModel(i);a(e,i,r,t,n),e.setItemVisual(i,{symbolSize:o.get("symbolSize")||x[r?0:1],symbol:o.get("symbol",!0)||y[r?0:1],color:o.get("itemStyle.normal.color")||h.getVisual("color")});}var o=t.coordinateSystem,u=t.name,h=t.getData(),c=this.markerGroupMap,f=c[u];f||(f=c[u]=new d()),this.group.add(f.group);var p=s(o,t,e),g=p.from,m=p.to,v=p.line;e.__from=g,e.__to=m,e.setData(v);var y=e.get("symbol"),x=e.get("symbolSize");l.isArray(y)||(y=[y,y]),"number"==typeof x&&(x=[x,x]),p.from.each(function(t){r(g,t,!0),r(m,t,!1);}),v.each(function(t){var e=v.getItemModel(t).get("lineStyle.normal.color");v.setItemVisual(t,{color:e||g.getItemVisual(t,"color")}),v.setItemLayout(t,[g.getItemLayout(t),m.getItemLayout(t)]),v.setItemVisual(t,{fromSymbolSize:g.getItemVisual(t,"symbolSize"),fromSymbol:g.getItemVisual(t,"symbol"),toSymbolSize:m.getItemVisual(t,"symbolSize"),toSymbol:m.getItemVisual(t,"symbol")});}),f.updateData(v),p.line.eachItemGraphicEl(function(t,i){t.traverse(function(t){t.dataModel=e;});}),f.__keep=!0,f.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){i(356),i(357),i(1).registerPreprocessor(function(t){t.markArea=t.markArea||{};});},function(t,e,i){t.exports=i(348).extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{normal:{show:!0,position:"top"},emphasis:{show:!0,position:"top"}},itemStyle:{normal:{borderWidth:0}}}});},function(t,e,i){function n(t){return!isNaN(t)&&!isFinite(t);}function r(t,e,i,r){var o=1-t;return n(e[o])&&n(i[o]);}function o(t,e){var i=e.coord[0],n=e.coord[1];return"cartesian2d"===t.type&&i&&n&&(r(1,i,n,t)||r(0,i,n,t))?!0:f.dataFilter(t,{coord:i,x:e.x0,y:e.y0})||f.dataFilter(t,{coord:n,x:e.x1,y:e.y1});}function a(t,e,i,r,o){var a,s=r.coordinateSystem,l=t.getItemModel(e),u=h.parsePercent(l.get(i[0]),o.getWidth()),c=h.parsePercent(l.get(i[1]),o.getHeight());if(isNaN(u)||isNaN(c)){if(r.getMarkerPosition)a=r.getMarkerPosition(t.getValues(i,e));else{var d=t.get(i[0],e),f=t.get(i[1],e);a=s.dataToPoint([d,f],!0);}if("cartesian2d"===s.type){var p=s.getAxis("x"),g=s.getAxis("y"),d=t.get(i[0],e),f=t.get(i[1],e);n(d)?a[0]=p.toGlobalCoord(p.getExtent()["x0"===i[0]?0:1]):n(f)&&(a[1]=g.toGlobalCoord(g.getExtent()["y0"===i[1]?0:1]));}isNaN(u)||(a[0]=u),isNaN(c)||(a[1]=c);}else a=[u,c];return a;}function s(t,e,i){var n,r,a=["x0","y0","x1","y1"];t?(n=l.map(t&&t.dimensions,function(t){var i=e.getData().getDimensionInfo(e.coordDimToDataDim(t)[0])||{};return i.name=t,i;}),r=new u(l.map(a,function(t,e){return{name:t,type:n[e%2].type};}),i)):(n=[{name:"value",type:"float"}],r=new u(n,i));var s=l.map(i.get("data"),l.curry(p,e,t,i));t&&(s=l.filter(s,l.curry(o,t)));var h=t?function(t,e,i,n){return t.coord[Math.floor(n/2)][n%2];}:function(t){return t.value;};return r.initData(s,null,h),r.hasItemOption=!0,r;}var l=i(4),u=i(97),h=i(7),c=i(43),d=i(39),f=i(350),p=function p(t,e,i,n){var r=f.dataTransform(t,n[0]),o=f.dataTransform(t,n[1]),a=l.retrieve,s=r.coord,u=o.coord;s[0]=a(s[0],-(1/0)),s[1]=a(s[1],-(1/0)),u[0]=a(u[0],1/0),u[1]=a(u[1],1/0);var h=l.mergeAll([{},r,o]);return h.coord=[r.coord,o.coord],h.x0=r.x,h.y0=r.y,h.x1=o.x,h.y1=o.y,h;},g=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];i(351).extend({type:"markArea",updateLayout:function updateLayout(t,e,i){e.eachSeries(function(t){var e=t.markAreaModel;if(e){var n=e.getData();n.each(function(e){var r=l.map(g,function(r){return a(n,e,r,t,i);});n.setItemLayout(e,r);var o=n.getItemGraphicEl(e);o.setShape("points",r);});}},this);},renderSeries:function renderSeries(t,e,i,n){var r=t.coordinateSystem,o=t.name,u=t.getData(),h=this.markerGroupMap,f=h[o];f||(f=h[o]={group:new c.Group()}),this.group.add(f.group),f.__keep=!0;var p=s(r,t,e);e.setData(p),p.each(function(e){p.setItemLayout(e,l.map(g,function(i){return a(p,e,i,t,n);})),p.setItemVisual(e,{color:u.getVisual("color")});}),p.diff(f.__data).add(function(t){var e=new c.Polygon({shape:{points:p.getItemLayout(t)}});p.setItemGraphicEl(t,e),f.group.add(e);}).update(function(t,i){var n=f.__data.getItemGraphicEl(i);c.updateProps(n,{shape:{points:p.getItemLayout(t)}},e,t),f.group.add(n),p.setItemGraphicEl(t,n);}).remove(function(t){var e=f.__data.getItemGraphicEl(t);f.group.remove(e);}).execute(),p.eachItemGraphicEl(function(t,i){var n=p.getItemModel(i),r=n.getModel("label.normal"),o=n.getModel("label.emphasis"),a=p.getItemVisual(i,"color");t.useStyle(l.defaults(n.getModel("itemStyle.normal").getItemStyle(),{fill:d.modifyAlpha(a,.4),stroke:a})),t.hoverStyle=n.getModel("itemStyle.normal").getItemStyle();var s=p.getName(i)||"",u=a||t.style.fill;c.setText(t.style,r,u),t.style.text=l.retrieve(e.getFormattedLabel(i,"normal"),s),c.setText(t.hoverStyle,o,u),t.hoverStyle.text=l.retrieve(e.getFormattedLabel(i,"emphasis"),s),c.setHoverStyle(t,{}),t.dataModel=e;}),f.__data=p,f.group.silent=e.get("silent")||t.get("silent");}});},function(t,e,i){var n=i(1);n.registerPreprocessor(i(359)),i(360),i(361),i(362),i(364);},function(t,e,i){function n(t){var e=t.type,i={number:"value",time:"time"};if(i[e]&&(t.axisType=i[e],delete t.type),r(t),o(t,"controlPosition")){var n=t.controlStyle||(t.controlStyle={});o(n,"position")||(n.position=t.controlPosition),"none"!==n.position||o(n,"show")||(n.show=!1,delete n.position),delete t.controlPosition;}a.each(t.data||[],function(t){a.isObject(t)&&!a.isArray(t)&&(!o(t,"value")&&o(t,"name")&&(t.value=t.name),r(t));});}function r(t){var e=t.itemStyle||(t.itemStyle={}),i=e.emphasis||(e.emphasis={}),n=t.label||t.label||{},r=n.normal||(n.normal={}),s={normal:1,emphasis:1};a.each(n,function(t,e){s[e]||o(r,e)||(r[e]=t);}),i.label&&!o(n,"emphasis")&&(n.emphasis=i.label,delete i.label);}function o(t,e){return t.hasOwnProperty(e);}var a=i(4);t.exports=function(t){var e=t&&t.timeline;a.isArray(e)||(e=e?[e]:[]),a.each(e,function(t){t&&n(t);});};},function(t,e,i){i(19).registerSubTypeDefaulter("timeline",function(){return"slider";});},function(t,e,i){var n=i(1),r=i(4);n.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e){var i=e.getComponent("timeline");return i&&null!=t.currentIndex&&(i.setCurrentIndex(t.currentIndex),!i.get("loop",!0)&&i.isIndexMax()&&i.setPlayState(!1)),e.resetOption("timeline"),r.defaults({currentIndex:i.option.currentIndex},t);}),n.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var i=e.getComponent("timeline");i&&null!=t.playState&&i.setPlayState(t.playState);});},function(t,e,i){var n=i(363),r=i(4),o=i(5),a=n.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",normal:{show:!0,interval:"auto",rotate:0,textStyle:{color:"#304654"}},emphasis:{show:!0,textStyle:{color:"#c23531"}}},itemStyle:{normal:{color:"#304654",borderWidth:1},emphasis:{color:"#c23531"}},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",normal:{color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}});r.mixin(a,o.dataFormatMixin),t.exports=a;},function(t,e,i){var n=i(19),r=i(97),o=i(4),a=i(5),s=n.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{normal:{},emphasis:{}},label:{normal:{textStyle:{color:"#000"}},emphasis:{}},data:[]},init:function init(t,e,i){this._data,this._names,this.mergeDefaultAndTheme(t,i),this._initData();},mergeOption:function mergeOption(t){s.superApply(this,"mergeOption",arguments),this._initData();},setCurrentIndex:function setCurrentIndex(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(t>=e&&(t=e-1),0>t&&(t=0)),this.option.currentIndex=t;},getCurrentIndex:function getCurrentIndex(){return this.option.currentIndex;},isIndexMax:function isIndexMax(){return this.getCurrentIndex()>=this._data.count()-1;},setPlayState:function setPlayState(t){this.option.autoPlay=!!t;},getPlayState:function getPlayState(){return!!this.option.autoPlay;},_initData:function _initData(){var t=this.option,e=t.data||[],i=t.axisType,n=this._names=[];if("category"===i){var s=[];o.each(e,function(t,e){var i,r=a.getDataItemValue(t);o.isObject(t)?(i=o.clone(t),i.value=e):i=e,s.push(i),o.isString(r)||null!=r&&!isNaN(r)||(r=""),n.push(r+"");}),e=s;}var l={category:"ordinal",time:"time"}[i]||"number",u=this._data=new r([{name:"value",type:l}],this);u.initData(e,n);},getData:function getData(){return this._data;},getCategories:function getCategories(){return"category"===this.get("axisType")?this._names.slice():void 0;}});t.exports=s;},function(t,e,i){function n(t,e){return u.getLayoutRect(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"));}function r(t,e,i,n){var r=l.makePath(t.get(e).replace(/^path:\/\//,""),s.clone(n||{}),new p(i[0],i[1],i[2],i[3]),"center");return r;}function o(t,e,i,n,r,o){var a=e.get("color");if(r)r.setColor(a),i.add(r),o&&o.onUpdate(r);else{var l=t.get("symbol");r=d.createSymbol(l,-1,-1,2,2,a),r.setStyle("strokeNoScale",!0),i.add(r),o&&o.onCreate(r);}var u=e.getItemStyle(["color","symbol","symbolSize"]);r.setStyle(u),n=s.merge({rectHover:!0,z2:100},n,!0);var h=t.get("symbolSize");h=h instanceof Array?h.slice():[+h,+h],h[0]/=2,h[1]/=2,n.scale=h;var c=t.get("symbolOffset");if(c){var f=n.position=n.position||[0,0];f[0]+=m.parsePercent(c[0],h[0]),f[1]+=m.parsePercent(c[1],h[1]);}var p=t.get("symbolRotate");return n.rotation=(p||0)*Math.PI/180||0,r.attr(n),r.updateTransform(),r;}function a(t,e,i,n,r){if(!t.dragging){var o=n.getModel("checkpointStyle"),a=i.dataToCoord(n.getData().get(["value"],e));r||!o.get("animation",!0)?t.attr({position:[a,0]}):(t.stopAnimation(!0),t.animateTo({position:[a,0]},o.get("animationDuration",!0),o.get("animationEasing",!0)));}}var s=i(4),l=i(43),u=i(21),h=i(365),c=i(366),d=i(106),f=i(114),p=i(9),g=i(11),m=i(7),v=i(6),y=v.encodeHTML,x=s.bind,_=s.each,b=Math.PI;t.exports=h.extend({type:"timeline.slider",init:function init(t,e){this.api=e,this._axis,this._viewRect,this._timer,this._currentPointer,this._mainGroup,this._labelGroup;},render:function render(t,e,i,n){if(this.model=t,this.api=i,this.ecModel=e,this.group.removeAll(),t.get("show",!0)){var r=this._layout(t,i),o=this._createGroup("mainGroup"),a=this._createGroup("labelGroup"),s=this._axis=this._createAxis(r,t);t.formatTooltip=function(t){return y(s.scale.getLabel(t));},_(["AxisLine","AxisTick","Control","CurrentPointer"],function(e){this["_render"+e](r,o,s,t);},this),this._renderAxisLabel(r,a,s,t),this._position(r,t);}this._doPlayStop();},remove:function remove(){this._clearTimer(),this.group.removeAll();},dispose:function dispose(){this._clearTimer();},_layout:function _layout(t,e){var i=t.get("label.normal.position"),r=t.get("orient"),o=n(t,e);null==i||"auto"===i?i="horizontal"===r?o.y+o.height/2<e.getHeight()/2?"-":"+":o.x+o.width/2<e.getWidth()/2?"+":"-":isNaN(i)&&(i={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[r][i]);var a={horizontal:"center",vertical:i>=0||"+"===i?"left":"right"},s={horizontal:i>=0||"+"===i?"top":"bottom",vertical:"middle"},l={horizontal:0,vertical:b/2},u="vertical"===r?o.height:o.width,h=t.getModel("controlStyle"),c=h.get("show"),d=c?h.get("itemSize"):0,f=c?h.get("itemGap"):0,p=d+f,g=t.get("label.normal.rotate")||0;g=g*b/180;var m,v,y,x,_=h.get("position",!0),c=h.get("show",!0),w=c&&h.get("showPlayBtn",!0),S=c&&h.get("showPrevBtn",!0),M=c&&h.get("showNextBtn",!0),I=0,T=u;return"left"===_||"bottom"===_?(w&&(m=[0,0],I+=p),S&&(v=[I,0],I+=p),M&&(y=[T-d,0],T-=p)):(w&&(m=[T-d,0],T-=p),S&&(v=[0,0],I+=p),M&&(y=[T-d,0],T-=p)),x=[I,T],t.get("inverse")&&x.reverse(),{viewRect:o,mainLength:u,orient:r,rotation:l[r],labelRotation:g,labelPosOpt:i,labelAlign:a[r],labelBaseline:s[r],playPosition:m,prevBtnPosition:v,nextBtnPosition:y,axisExtent:x,controlSize:d,controlGap:f};},_position:function _position(t,e){function i(t){var e=t.position;t.origin=[c[0][0]-e[0],c[1][0]-e[1]];}function n(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]];}function r(t,e,i,n,r){t[n]+=i[n][r]-e[n][r];}var o=this._mainGroup,a=this._labelGroup,s=t.viewRect;if("vertical"===t.orient){var l=g.create(),u=s.x,h=s.y+s.height;g.translate(l,l,[-u,-h]),g.rotate(l,l,-b/2),g.translate(l,l,[u,h]),s=s.clone(),s.applyTransform(l);}var c=n(s),d=n(o.getBoundingRect()),f=n(a.getBoundingRect()),p=o.position,m=a.position;m[0]=p[0]=c[0][0];var v=t.labelPosOpt;if(isNaN(v)){var y="+"===v?0:1;r(p,d,c,1,y),r(m,f,c,1,1-y);}else{var y=v>=0?0:1;r(p,d,c,1,y),m[1]=p[1]+v;}o.attr("position",p),a.attr("position",m),o.rotation=a.rotation=t.rotation,i(o),i(a);},_createAxis:function _createAxis(t,e){var i=e.getData(),n=e.get("axisType"),r=f.createScaleByModel(e,n),o=i.getDataExtent("value");r.setExtent(o[0],o[1]),this._customizeScale(r,i),r.niceTicks();var a=new c("value",r,t.axisExtent,n);return a.model=e,a;},_customizeScale:function _customizeScale(t,e){t.getTicks=function(){return e.mapArray(["value"],function(t){return t;});},t.getTicksLabels=function(){return s.map(this.getTicks(),t.getLabel,t);};},_createGroup:function _createGroup(t){var e=this["_"+t]=new l.Group();return this.group.add(e),e;},_renderAxisLine:function _renderAxisLine(t,e,i,n){var r=i.getExtent();n.get("lineStyle.show")&&e.add(new l.Line({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:s.extend({lineCap:"round"},n.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}));},_renderAxisTick:function _renderAxisTick(t,e,i,n){var r=n.getData(),a=i.scale.getTicks();_(a,function(t,a){var s=i.dataToCoord(t),u=r.getItemModel(a),h=u.getModel("itemStyle.normal"),c=u.getModel("itemStyle.emphasis"),d={position:[s,0],onclick:x(this._changeTimeline,this,a)},f=o(u,h,e,d);l.setHoverStyle(f,c.getItemStyle()),u.get("tooltip")?(f.dataIndex=a,f.dataModel=n):f.dataIndex=f.dataModel=null;},this);},_renderAxisLabel:function _renderAxisLabel(t,e,i,n){var r=n.getModel("label.normal");if(r.get("show")){var o=n.getData(),a=i.scale.getTicks(),s=f.getFormattedLabels(i,r.get("formatter")),u=i.getLabelInterval();_(a,function(n,r){if(!i.isLabelIgnored(r,u)){var a=o.getItemModel(r),h=a.getModel("label.normal.textStyle"),c=a.getModel("label.emphasis.textStyle"),d=i.dataToCoord(n),f=new l.Text({style:{text:s[r],textAlign:t.labelAlign,textVerticalAlign:t.labelBaseline,textFont:h.getFont(),fill:h.getTextColor()},position:[d,0],rotation:t.labelRotation-t.rotation,onclick:x(this._changeTimeline,this,r),silent:!1});e.add(f),l.setHoverStyle(f,c.getItemStyle());}},this);}},_renderControl:function _renderControl(t,e,i,n){function o(t,i,o,d){if(t){var f={position:t,origin:[a/2,0],rotation:d?-s:0,rectHover:!0,style:u,onclick:o},p=r(n,i,c,f);e.add(p),l.setHoverStyle(p,h);}}var a=t.controlSize,s=t.rotation,u=n.getModel("controlStyle.normal").getItemStyle(),h=n.getModel("controlStyle.emphasis").getItemStyle(),c=[0,-a/2,a,a],d=n.getPlayState(),f=n.get("inverse",!0);o(t.nextBtnPosition,"controlStyle.nextIcon",x(this._changeTimeline,this,f?"-":"+")),o(t.prevBtnPosition,"controlStyle.prevIcon",x(this._changeTimeline,this,f?"+":"-")),o(t.playPosition,"controlStyle."+(d?"stopIcon":"playIcon"),x(this._handlePlayClick,this,!d),!0);},_renderCurrentPointer:function _renderCurrentPointer(t,e,i,n){var r=n.getData(),s=n.getCurrentIndex(),l=r.getItemModel(s).getModel("checkpointStyle"),u=this,h={onCreate:function onCreate(t){t.draggable=!0,t.drift=x(u._handlePointerDrag,u),t.ondragend=x(u._handlePointerDragend,u),a(t,s,i,n,!0);},onUpdate:function onUpdate(t){a(t,s,i,n);}};this._currentPointer=o(l,l,this._mainGroup,{},this._currentPointer,h);},_handlePlayClick:function _handlePlayClick(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid});},_handlePointerDrag:function _handlePointerDrag(t,e,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY]);},_handlePointerDragend:function _handlePointerDragend(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0);},_pointerChangeTimeline:function _pointerChangeTimeline(t,e){var i=this._toAxisCoord(t)[0],n=this._axis,r=m.asc(n.getExtent().slice());i>r[1]&&(i=r[1]),i<r[0]&&(i=r[0]),this._currentPointer.position[0]=i,this._currentPointer.dirty();var o=this._findNearestTick(i),a=this.model;(e||o!==a.getCurrentIndex()&&a.get("realtime"))&&this._changeTimeline(o);},_doPlayStop:function _doPlayStop(){function t(){var t=this.model;this._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1));}this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(x(t,this),this.model.get("playInterval")));},_toAxisCoord:function _toAxisCoord(t){var e=this._mainGroup.getLocalTransform();return l.applyTransform(t,e,!0);},_findNearestTick:function _findNearestTick(t){var e,i=this.model.getData(),n=1/0,r=this._axis;return i.each(["value"],function(i,o){var a=r.dataToCoord(i),s=Math.abs(a-t);n>s&&(n=s,e=o);}),e;},_clearTimer:function _clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null);},_changeTimeline:function _changeTimeline(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid});}});},function(t,e,i){var n=i(29);t.exports=n.extend({type:"timeline"});},function(t,e,i){var n=i(4),r=i(123),o=i(114),a=function a(t,e,i,n){r.call(this,t,e,i),this.type=n||"value",this._autoLabelInterval,this.model=null;};a.prototype={constructor:a,getLabelInterval:function getLabelInterval(){var t=this.model,e=t.getModel("label.normal"),i=e.get("interval");if(null!=i&&"auto"!=i)return i;var i=this._autoLabelInterval;return i||(i=this._autoLabelInterval=o.getAxisLabelInterval(n.map(this.scale.getTicks(),this.dataToCoord,this),o.getFormattedLabels(this,e.get("formatter")),e.getModel("textStyle").getFont(),"horizontal"===t.get("orient"))),i;},isLabelIgnored:function isLabelIgnored(t){if("category"===this.type){var e=this.getLabelInterval();return"function"==typeof e&&!e(t,this.scale.getLabel(t))||t%(e+1);}}},n.inherits(a,r),t.exports=a;},function(t,e,i){i(368),i(369),i(371),i(372),i(373),i(374),i(379);},function(t,e,i){var n=i(315),r=i(4),o=i(1).extendComponentModel({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},mergeDefaultAndTheme:function mergeDefaultAndTheme(t){o.superApply(this,"mergeDefaultAndTheme",arguments),r.each(this.option.feature,function(t,e){var i=n.get(e);i&&r.merge(t,i.defaultOption);});},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{normal:{borderColor:"#666",color:"none"},emphasis:{borderColor:"#3E98C5"}}}});t.exports=o;},function(t,e,i){(function(e){function n(t){return 0===t.indexOf("my");}var r=i(315),o=i(4),a=i(43),s=i(12),l=i(98),u=i(278),h=i(8);t.exports=i(1).extendComponentView({type:"toolbox",render:function render(t,e,i,c){function d(o,a){var l,u=y[o],h=y[a],d=m[u],p=new s(d,t,t.ecModel);if(u&&!h){if(n(u))l={model:p,onclick:p.option.onclick,featureName:u};else{var g=r.get(u);if(!g)return;l=new g(p,e,i);}v[u]=l;}else{if(l=v[h],!l)return;l.model=p,l.ecModel=e,l.api=i;}return!u&&h?void(l.dispose&&l.dispose(e,i)):!p.get("show")||l.unusable?void(l.remove&&l.remove(e,i)):(f(p,l,u),p.setIconStatus=function(t,e){var i=this.option,n=this.iconPaths;i.iconStatus=i.iconStatus||{},i.iconStatus[t]=e,n[t]&&n[t].trigger(e);},void(l.render&&l.render(p,e,i,c)));}function f(n,r,s){var l=n.getModel("iconStyle"),u=r.getIcons?r.getIcons():n.get("icon"),h=n.get("title")||{};if("string"==typeof u){var c=u,d=h;u={},h={},u[s]=c,h[s]=d;}var f=n.iconPaths={};o.each(u,function(s,u){var c=l.getModel("normal").getItemStyle(),d=l.getModel("emphasis").getItemStyle(),m={x:-g/2,y:-g/2,width:g,height:g},v=0===s.indexOf("image://")?(m.image=s.slice(8),new a.Image({style:m})):a.makePath(s.replace("path://",""),{style:c,hoverStyle:d,rectHover:!0},m,"center");a.setHoverStyle(v),t.get("showTitle")&&(v.__title=h[u],v.on("mouseover",function(){var t=l.getModel("emphasis").getItemStyle();v.setStyle({text:h[u],textPosition:t.textPosition||"bottom",textFill:t.fill||t.stroke||"#000",textAlign:t.textAlign||"center"});}).on("mouseout",function(){v.setStyle({textFill:null});})),v.trigger(n.get("iconStatus."+u)||"normal"),p.add(v),v.on("click",o.bind(r.onclick,r,e,i,u)),f[u]=v;});}var p=this.group;if(p.removeAll(),t.get("show")){var g=+t.get("itemSize"),m=t.get("feature")||{},v=this._features||(this._features={}),y=[];o.each(m,function(t,e){y.push(e);}),new l(this._featureNames||[],y).add(d).update(d).remove(o.curry(d,null)).execute(),this._featureNames=y,u.layout(p,t,i),u.addBackground(p,t),p.eachChild(function(t){var e=t.__title,n=t.hoverStyle;if(n&&e){var r=h.getBoundingRect(e,n.font),o=t.position[0]+p.position[0],a=t.position[1]+p.position[1]+g,s=!1;a+r.height>i.getHeight()&&(n.textPosition="top",s=!0);var l=s?-5-r.height:g+8;o+r.width/2>i.getWidth()?(n.textPosition=["100%",l],n.textAlign="right"):o-r.width/2<0&&(n.textPosition=[0,l],n.textAlign="left");}});}},updateView:function updateView(t,e,i,n){o.each(this._features,function(t){t.updateView&&t.updateView(t.model,e,i,n);});},updateLayout:function updateLayout(t,e,i,n){o.each(this._features,function(t){t.updateLayout&&t.updateLayout(t.model,e,i,n);});},remove:function remove(t,e){o.each(this._features,function(i){i.remove&&i.remove(t,e);}),this.group.removeAll();},dispose:function dispose(t,e){o.each(this._features,function(i){i.dispose&&i.dispose(t,e);});}});}).call(e,i(370));},function(t,e){function i(){throw new Error("setTimeout has not been defined");}function n(){throw new Error("clearTimeout has not been defined");}function r(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0);}catch(e){try{return h.call(null,t,0);}catch(e){return h.call(this,t,0);}}}function o(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t);}catch(e){try{return c.call(null,t);}catch(e){return c.call(this,t);}}}function a(){g&&f&&(g=!1,f.length?p=f.concat(p):m=-1,p.length&&s());}function s(){if(!g){var t=r(a);g=!0;for(var e=p.length;e;){for(f=p,p=[];++m<e;){f&&f[m].run();}m=-1,e=p.length;}f=null,g=!1,o(t);}}function l(t,e){this.fun=t,this.array=e;}function u(){}var h,c,d=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i;}catch(t){h=i;}try{c="function"==typeof clearTimeout?clearTimeout:n;}catch(t){c=n;}}();var f,p=[],g=!1,m=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i];}p.push(new l(t,e)),1!==p.length||g||r(s);},l.prototype.run=function(){this.fun.apply(null,this.array);},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.binding=function(t){throw new Error("process.binding is not supported");},d.cwd=function(){return"/";},d.chdir=function(t){throw new Error("process.chdir is not supported");},d.umask=function(){return 0;};},function(t,e,i){function n(t){this.model=t;}var r=i(2);n.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:"",type:"png",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:[""]},n.prototype.unusable=!r.canvasSupported;var o=n.prototype;o.onclick=function(t,e){var i=this.model,n=i.get("name")||t.get("title.0.text")||"echarts",r=document.createElement("a"),o=i.get("type",!0)||"png";r.download=n+"."+o,r.target="_blank";var a=e.getConnectedDataURL({type:o,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")});if(r.href=a,"function"==typeof MouseEvent){var s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});r.dispatchEvent(s);}else{var l=i.get("lang"),u='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(l&&l[0]||"")+'" /></body>',h=window.open();h.document.write(u);}},i(315).register("saveAsImage",n),t.exports=n;},function(t,e,i){"use strict";function n(t){this.model=t;}var r=i(4);n.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z",tiled:"M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z"},title:{line:"",bar:"",stack:"",tiled:""},option:{},seriesIndex:{}};var o=n.prototype;o.getIcons=function(){var t=this.model,e=t.get("icon"),i={};return r.each(t.get("type"),function(t){e[t]&&(i[t]=e[t]);}),i;};var a={line:function line(t,e,i,n){return"bar"===t?r.merge({id:e,type:"line",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.line")||{},!0):void 0;},bar:function bar(t,e,i,n){return"line"===t?r.merge({id:e,type:"bar",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get("option.bar")||{},!0):void 0;},stack:function stack(t,e,i,n){return"line"===t||"bar"===t?r.merge({id:e,stack:"__ec_magicType_stack__"},n.get("option.stack")||{},!0):void 0;},tiled:function tiled(t,e,i,n){return"line"===t||"bar"===t?r.merge({id:e,stack:""},n.get("option.tiled")||{},!0):void 0;}},s=[["line","bar"],["stack","tiled"]];o.onclick=function(t,e,i){var n=this.model,o=n.get("seriesIndex."+i);if(a[i]){var l={series:[]},u=function u(e){var o=e.subType,s=e.id,u=a[i](o,s,e,n);u&&(r.defaults(u,e.option),l.series.push(u));var h=e.coordinateSystem;if(h&&"cartesian2d"===h.type&&("line"===i||"bar"===i)){var c=h.getAxesByScale("ordinal")[0];if(c){var d=c.dim,f=d+"Axis",p=t.queryComponents({mainType:f,index:e.get(name+"Index"),id:e.get(name+"Id")})[0],g=p.componentIndex;l[f]=l[f]||[];for(var m=0;g>=m;m++){l[f][g]=l[f][g]||{};}l[f][g].boundaryGap="bar"===i?!0:!1;}}};r.each(s,function(t){r.indexOf(t,i)>=0&&r.each(t,function(t){n.setIconStatus(t,"normal");});}),n.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:null==o?null:{seriesIndex:o}},u),e.dispatchAction({type:"changeMagicType",currentType:i,newOption:l});}};var l=i(1);l.registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption);}),i(315).register("magicType",n),t.exports=n;},function(t,e,i){function n(t){var e={},i=[],n=[];return t.eachRawSeries(function(t){var r=t.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)i.push(t);else{var o=r.getBaseAxis();if("category"===o.type){var a=o.dim+"_"+o.index;e[a]||(e[a]={categoryAxis:o,valueAxis:r.getOtherAxis(o),series:[]},n.push({axisDim:o.dim,axisIndex:o.index})),e[a].series.push(t);}else i.push(t);}}),{seriesGroupByCategoryAxis:e,other:i,meta:n};}function r(t){var e=[];return p.each(t,function(t,i){var n=t.categoryAxis,r=t.valueAxis,o=r.dim,a=[" "].concat(p.map(t.series,function(t){return t.name;})),s=[n.model.getCategories()];p.each(t.series,function(t){s.push(t.getRawData().mapArray(o,function(t){return t;}));});for(var l=[a.join(v)],u=0;u<s[0].length;u++){for(var h=[],c=0;c<s.length;c++){h.push(s[c][u]);}l.push(h.join(v));}e.push(l.join("\n"));}),e.join("\n\n"+m+"\n\n");}function o(t){return p.map(t,function(t){var e=t.getRawData(),i=[t.name],n=[];return e.each(e.dimensions,function(){for(var t=arguments.length,r=arguments[t-1],o=e.getName(r),a=0;t-1>a;a++){n[a]=arguments[a];}i.push((o?o+v:"")+n.join(v));}),i.join("\n");}).join("\n\n"+m+"\n\n");}function a(t){var e=n(t);return{value:p.filter([r(e.seriesGroupByCategoryAxis),o(e.other)],function(t){return t.replace(/[\n\t\s]/g,"");}).join("\n\n"+m+"\n\n"),meta:e.meta};}function s(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function l(t){var e=t.slice(0,t.indexOf("\n"));return e.indexOf(v)>=0?!0:void 0;}function u(t){for(var e=t.split(/\n+/g),i=s(e.shift()).split(y),n=[],r=p.map(i,function(t){return{name:t,data:[]};}),o=0;o<e.length;o++){var a=s(e[o]).split(y);n.push(a.shift());for(var l=0;l<a.length;l++){r[l]&&(r[l].data[o]=a[l]);}}return{series:r,categories:n};}function h(t){for(var e=t.split(/\n+/g),i=s(e.shift()),n=[],r=0;r<e.length;r++){var o,a=s(e[r]).split(y),l="",u=!1;isNaN(a[0])?(u=!0,l=a[0],a=a.slice(1),n[r]={name:l,value:[]},o=n[r].value):o=n[r]=[];for(var h=0;h<a.length;h++){o.push(+a[h]);}1===o.length&&(u?n[r].value=o[0]:n[r]=o[0]);}return{name:i,data:n};}function c(t,e){var i=t.split(new RegExp("\n*"+m+"\n*","g")),n={series:[]};return p.each(i,function(t,i){if(l(t)){var r=u(t),o=e[i],a=o.axisDim+"Axis";o&&(n[a]=n[a]||[],n[a][o.axisIndex]={data:r.categories},n.series=n.series.concat(r.series));}else{var r=h(t);n.series.push(r);}}),n;}function d(t){this._dom=null,this.model=t;}function f(t,e){return p.map(t,function(t,i){var n=e&&e[i];return p.isObject(n)&&!p.isArray(n)?(p.isObject(t)&&!p.isArray(t)&&(t=t.value),p.defaults({value:t},n)):t;});}var p=i(4),g=i(87),m=new Array(60).join("-"),v="	",y=new RegExp("["+v+"]+","g");d.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:"",lang:["","",""],backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},d.prototype.onclick=function(t,e){function i(){n.removeChild(o),M._dom=null;}var n=e.getDom(),r=this.model;this._dom&&n.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",o.style.backgroundColor=r.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=r.get("lang")||[];s.innerHTML=l[0]||r.get("title"),s.style.cssText="margin: 10px 20px;",s.style.color=r.get("textColor");var u=document.createElement("div"),h=document.createElement("textarea");u.style.cssText="display:block;width:100%;overflow:hidden;";var d=r.get("optionToContent"),f=r.get("contentToOption"),m=a(t);if("function"==typeof d){var y=d(e.getOption());"string"==typeof y?u.innerHTML=y:p.isDom(y)&&u.appendChild(y);}else u.appendChild(h),h.readOnly=r.get("readOnly"),h.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",h.style.color=r.get("textColor"),h.style.borderColor=r.get("textareaBorderColor"),h.style.backgroundColor=r.get("textareaColor"),h.value=m.value;var x=m.meta,_=document.createElement("div");_.style.cssText="position:absolute;bottom:0;left:0;right:0;";var b="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",w=document.createElement("div"),S=document.createElement("div");b+=";background-color:"+r.get("buttonColor"),b+=";color:"+r.get("buttonTextColor");var M=this;g.addEventListener(w,"click",i),g.addEventListener(S,"click",function(){var t;try{t="function"==typeof f?f(u,e.getOption()):c(h.value,x);}catch(n){throw i(),new Error("Data view format error "+n);}t&&e.dispatchAction({type:"changeDataView",newOption:t}),i();}),w.innerHTML=l[1],S.innerHTML=l[2],S.style.cssText=b,w.style.cssText=b,!r.get("readOnly")&&_.appendChild(S),_.appendChild(w),g.addEventListener(h,"keydown",function(t){if(9===(t.keyCode||t.which)){var e=this.value,i=this.selectionStart,n=this.selectionEnd;this.value=e.substring(0,i)+v+e.substring(n),this.selectionStart=this.selectionEnd=i+1,g.stop(t);}}),o.appendChild(s),o.appendChild(u),o.appendChild(_),u.style.height=n.clientHeight-80+"px",n.appendChild(o),this._dom=o;},d.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom);},d.prototype.dispose=function(t,e){this.remove(t,e);},i(315).register("dataView",d),i(1).registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,e){var i=[];p.each(t.newOption.series,function(t){var n=e.getSeriesByName(t.name)[0];if(n){var r=n.get("data");i.push({name:t.name,data:f(t.data,r)});}else i.push(p.extend({type:"scatter"},t));}),e.mergeOption(p.defaults({series:i},t.newOption));}),t.exports=d;},function(t,e,i){"use strict";function n(t,e,i){(this._brushController=new l(i.getZr())).on("brush",s.bind(this._onBrush,this)).mount(),this._isZoomActive;}function r(t){var e={};return s.each(["xAxisIndex","yAxisIndex"],function(i){e[i]=t[i],null==e[i]&&(e[i]="all"),(e[i]===!1||"none"===e[i])&&(e[i]=[]);}),e;}function o(t,e){t.setIconStatus("back",h.count(e)>1?"emphasis":"normal");}function a(t,e,i,n){var o=i._isZoomActive;n&&"takeGlobalCursor"===n.type&&(o="dataZoomSelect"===n.key?n.dataZoomSelectActive:!1),i._isZoomActive=o,t.setIconStatus("zoom",o?"emphasis":"normal");var a=u.makeCoordInfoList(r(t.option),e),s=a.xAxisHas&&!a.yAxisHas?"lineX":!a.xAxisHas&&a.yAxisHas?"lineY":"rect";i._brushController.setPanels(u.makePanelOpts(a)).enableBrush(o?{brushType:s,brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}}:!1);}var s=i(4),l=i(234),u=i(310),h=i(375),c=s.each;i(376);var d="\x00_ec_\x00toolbox-dataZoom_";n.defaultOption={show:!0,icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:{zoom:"",back:""}};var f=n.prototype;f.render=function(t,e,i,n){this.model=t,this.ecModel=e,this.api=i,a(t,e,this,n),o(t,e);},f.onclick=function(t,e,i){p[i].call(this);},f.remove=function(t,e){this._brushController.unmount();},f.dispose=function(t,e){this._brushController.dispose();};var p={zoom:function zoom(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t});},back:function back(){this._dispatchZoomAction(h.pop(this.ecModel));}};f._onBrush=function(t,e){function i(t,e,i){var r=n(t,i[t],a);r&&(o[r.id]={dataZoomId:r.id,startValue:e[0],endValue:e[1]});}function n(t,e,i){var n;return i.eachComponent({mainType:"dataZoom",subType:"select"},function(r,o){var a=r.get(t+"Index");null!=a&&i.getComponent(t,a)===e&&(n=r);}),n;}if(e.isEnd&&t.length){var o={},a=this.ecModel;this._brushController.updateCovers([]);var s=u.makeCoordInfoList(r(this.model.option),a),l=[];u.parseOutputRanges(t,s,a,l);var c=t[0],d=l[0],f=c.coordRange,p=c.brushType;if(d&&f)if("rect"===p)i("xAxis",f[0],d),i("yAxis",f[1],d);else{var g={lineX:"xAxis",lineY:"yAxis"};i(g[p],f,d);}h.push(a,o),this._dispatchZoomAction(o);}},f._dispatchZoomAction=function(t){var e=[];c(t,function(t,i){e.push(s.clone(t));}),e.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:e});},i(315).register("dataZoom",n),i(1).registerPreprocessor(function(t){function e(t,e){if(e){var r=t+"Index",o=e[r];null==o||"all"==o||s.isArray(o)||(o=o===!1||"none"===o?[]:[o]),i(t,function(e,i){if(null==o||"all"==o||-1!==s.indexOf(o,i)){var a={type:"select",$fromToolbox:!0,id:d+t+i};a[r]=i,n.push(a);}});}}function i(e,i){var n=t[e];s.isArray(n)||(n=n?[n]:[]),c(n,i);}if(t){var n=t.dataZoom||(t.dataZoom=[]);s.isArray(n)||(t.dataZoom=n=[n]);var r=t.toolbox;if(r&&(s.isArray(r)&&(r=r[0]),r&&r.feature)){var o=r.feature.dataZoom;e("xAxis",o),e("yAxis",o);}}}),t.exports=n;},function(t,e,i){function n(t){var e=t[a];return e||(e=t[a]=[{}]),e;}var r=i(4),o=r.each,a="\x00_ec_hist_store",s={push:function push(t,e){var i=n(t);o(e,function(e,n){for(var r=i.length-1;r>=0;r--){var o=i[r];if(o[n])break;}if(0>r){var a=t.queryComponents({mainType:"dataZoom",subType:"select",id:n})[0];if(a){var s=a.getPercentRange();i[0][n]={dataZoomId:n,start:s[0],end:s[1]};}}}),i.push(e);},pop:function pop(t){var e=n(t),i=e[e.length-1];e.length>1&&e.pop();var r={};return o(i,function(t,i){for(var n=e.length-1;n>=0;n--){var t=e[n][i];if(t){r[i]=t;break;}}}),r;},clear:function clear(t){t[a]=null;},count:function count(t){return n(t).length;}};t.exports=s;},function(t,e,i){i(318),i(319),i(322),i(377),i(378),i(329),i(330);},function(t,e,i){var n=i(319);t.exports=n.extend({type:"dataZoom.select"});},function(t,e,i){t.exports=i(322).extend({type:"dataZoom.select"});},function(t,e,i){"use strict";function n(t){this.model=t;}var r=i(375);n.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:""};var o=n.prototype;o.onclick=function(t,e,i){r.clear(t),e.dispatchAction({type:"restore",from:this.uid});},i(315).register("restore",n),i(1).registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate");}),t.exports=n;},function(t,e,i){i(381),i(81).registerPainter("vml",i(383));},function(t,e,i){if(!i(2).canvasSupported){var n=i(10),r=i(9),o=i(49).CMD,a=i(39),s=i(8),l=i(48),u=i(46),h=i(62),c=i(64),d=i(45),f=i(61),p=i(382),g=Math.round,m=Math.sqrt,v=Math.abs,y=Math.cos,x=Math.sin,_=Math.max,b=n.applyTransform,w=",",S="progid:DXImageTransform.Microsoft",M=21600,I=M/2,T=1e5,A=1e3,L=function L(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=M+","+M,t.coordorigin="0,0";},C=function C(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;");},D=function D(t,e,i){return"rgb("+[t,e,i].join(",")+")";},P=function P(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e);},k=function k(t,e){e&&t&&e.parentNode===t&&t.removeChild(e);},z=function z(t,e,i){return(parseFloat(t)||0)*T+(parseFloat(e)||0)*A+i;},O=function O(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t;},E=function E(t,e,i){var n=a.parse(e);i=+i,isNaN(i)&&(i=1),n&&(t.color=D(n[0],n[1],n[2]),t.opacity=i*n[3]);},R=function R(t){var e=a.parse(t);return[D(e[0],e[1],e[2]),e[3]];},N=function N(t,e,i){var n=e.fill;if(null!=n)if(n instanceof f){var r,o=0,a=[0,0],s=0,l=1,u=i.getBoundingRect(),h=u.width,c=u.height;if("linear"===n.type){r="gradient";var d=i.transform,p=[n.x*h,n.y*c],g=[n.x2*h,n.y2*c];d&&(b(p,p,d),b(g,g,d));var m=g[0]-p[0],v=g[1]-p[1];o=180*Math.atan2(m,v)/Math.PI,0>o&&(o+=360),1e-6>o&&(o=0);}else{r="gradientradial";var p=[n.x*h,n.y*c],d=i.transform,y=i.scale,x=h,w=c;a=[(p[0]-u.x)/x,(p[1]-u.y)/w],d&&b(p,p,d),x/=y[0]*M,w/=y[1]*M;var S=_(x,w);s=0/S,l=2*n.r/S-s;}var I=n.colorStops.slice();I.sort(function(t,e){return t.offset-e.offset;});for(var T=I.length,A=[],L=[],C=0;T>C;C++){var D=I[C],P=R(D.color);L.push(D.offset*l+s+" "+P[0]),(0===C||C===T-1)&&A.push(P);}if(T>=2){var k=A[0][0],z=A[1][0],O=A[0][1]*e.opacity,N=A[1][1]*e.opacity;t.type=r,t.method="none",t.focus="100%",t.angle=o,t.color=k,t.color2=z,t.colors=L.join(","),t.opacity=N,t.opacity2=O;}"radial"===r&&(t.focusposition=a.join(","));}else E(t,n,e.opacity);},V=function V(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof f||E(t,e.stroke,e.opacity);},B=function B(t,e,i,n){var r="fill"==e,o=t.getElementsByTagName(e)[0];null!=i[e]&&"none"!==i[e]&&(r||!r&&i.lineWidth)?(t[r?"filled":"stroked"]="true",i[e]instanceof f&&k(t,o),o||(o=p.createNode(e)),r?N(o,i,n):V(o,i),P(t,o)):(t[r?"filled":"stroked"]="false",k(t,o));},G=[[],[],[]],F=function F(t,e){var i,n,r,a,s,l,u=o.M,h=o.C,c=o.L,d=o.A,f=o.Q,p=[];for(a=0;a<t.length;){switch(r=t[a++],n="",i=0,r){case u:n=" m ",i=1,s=t[a++],l=t[a++],G[0][0]=s,G[0][1]=l;break;case c:n=" l ",i=1,s=t[a++],l=t[a++],G[0][0]=s,G[0][1]=l;break;case f:case h:n=" c ",i=3;var v,_,S=t[a++],T=t[a++],A=t[a++],L=t[a++];r===f?(v=A,_=L,A=(A+2*S)/3,L=(L+2*T)/3,S=(s+2*S)/3,T=(l+2*T)/3):(v=t[a++],_=t[a++]),G[0][0]=S,G[0][1]=T,G[1][0]=A,G[1][1]=L,G[2][0]=v,G[2][1]=_,s=v,l=_;break;case d:var C=0,D=0,P=1,k=1,z=0;e&&(C=e[4],D=e[5],P=m(e[0]*e[0]+e[1]*e[1]),k=m(e[2]*e[2]+e[3]*e[3]),z=Math.atan2(-e[1]/k,e[0]/P));var O=t[a++],E=t[a++],R=t[a++],N=t[a++],V=t[a++]+z,B=t[a++]+V+z;a++;var F=t[a++],H=O+y(V)*R,W=E+x(V)*N,S=O+y(B)*R,T=E+x(B)*N,Z=F?" wa ":" at ";Math.abs(H-S)<1e-10&&(Math.abs(B-V)>.01?F&&(H+=270/M):Math.abs(W-E)<1e-10?F&&O>H||!F&&H>O?T-=270/M:T+=270/M:F&&E>W||!F&&W>E?S+=270/M:S-=270/M),p.push(Z,g(((O-R)*P+C)*M-I),w,g(((E-N)*k+D)*M-I),w,g(((O+R)*P+C)*M-I),w,g(((E+N)*k+D)*M-I),w,g((H*P+C)*M-I),w,g((W*k+D)*M-I),w,g((S*P+C)*M-I),w,g((T*k+D)*M-I)),s=S,l=T;break;case o.R:var q=G[0],U=G[1];q[0]=t[a++],q[1]=t[a++],U[0]=q[0]+t[a++],U[1]=q[1]+t[a++],e&&(b(q,q,e),b(U,U,e)),q[0]=g(q[0]*M-I),U[0]=g(U[0]*M-I),q[1]=g(q[1]*M-I),U[1]=g(U[1]*M-I),p.push(" m ",q[0],w,q[1]," l ",U[0],w,q[1]," l ",U[0],w,U[1]," l ",q[0],w,U[1]);break;case o.Z:p.push(" x ");}if(i>0){p.push(n);for(var j=0;i>j;j++){var X=G[j];e&&b(X,X,e),p.push(g(X[0]*M-I),w,g(X[1]*M-I),i-1>j?w:"");}}}return p.join("");};d.prototype.brushVML=function(t){var e=this.style,i=this._vmlEl;i||(i=p.createNode("shape"),L(i),this._vmlEl=i),B(i,"fill",e,this),B(i,"stroke",e,this);var n=this.transform,r=null!=n,o=i.getElementsByTagName("stroke")[0];if(o){var a=e.lineWidth;if(r&&!e.strokeNoScale){var s=n[0]*n[3]-n[1]*n[2];a*=m(v(s));}o.weight=a+"px";}var l=this.path;this.__dirtyPath&&(l.beginPath(),this.buildPath(l,this.shape),l.toStatic(),this.__dirtyPath=!1),i.path=F(l.data,this.transform),i.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,i),e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t);},d.prototype.onRemove=function(t){k(t,this._vmlEl),this.removeRectText(t);},d.prototype.onAdd=function(t){P(t,this._vmlEl),this.appendRectText(t);};var H=function H(t){return"object"==(typeof t==="undefined"?"undefined":_typeof(t))&&t.tagName&&"IMG"===t.tagName.toUpperCase();};h.prototype.brushVML=function(t){var e,i,n=this.style,r=n.image;if(H(r)){var o=r.src;if(o===this._imageSrc)e=this._imageWidth,i=this._imageHeight;else{var a=r.runtimeStyle,s=a.width,l=a.height;a.width="auto",a.height="auto",e=r.width,i=r.height,a.width=s,a.height=l,this._imageSrc=o,this._imageWidth=e,this._imageHeight=i;}r=o;}else r===this._imageSrc&&(e=this._imageWidth,i=this._imageHeight);if(r){var u=n.x||0,h=n.y||0,c=n.width,d=n.height,f=n.sWidth,v=n.sHeight,y=n.sx||0,x=n.sy||0,M=f&&v,I=this._vmlEl;I||(I=p.doc.createElement("div"),L(I),this._vmlEl=I);var T,A=I.style,C=!1,D=1,k=1;if(this.transform&&(T=this.transform,D=m(T[0]*T[0]+T[1]*T[1]),k=m(T[2]*T[2]+T[3]*T[3]),C=T[1]||T[2]),C){var O=[u,h],E=[u+c,h],R=[u,h+d],N=[u+c,h+d];b(O,O,T),b(E,E,T),b(R,R,T),b(N,N,T);var V=_(O[0],E[0],R[0],N[0]),B=_(O[1],E[1],R[1],N[1]),G=[];G.push("M11=",T[0]/D,w,"M12=",T[2]/k,w,"M21=",T[1]/D,w,"M22=",T[3]/k,w,"Dx=",g(u*D+T[4]),w,"Dy=",g(h*k+T[5])),A.padding="0 "+g(V)+"px "+g(B)+"px 0",A.filter=S+".Matrix("+G.join("")+", SizingMethod=clip)";}else T&&(u=u*D+T[4],h=h*k+T[5]),A.filter="",A.left=g(u)+"px",A.top=g(h)+"px";var F=this._imageEl,W=this._cropEl;F||(F=p.doc.createElement("div"),this._imageEl=F);var Z=F.style;if(M){if(e&&i)Z.width=g(D*e*c/f)+"px",Z.height=g(k*i*d/v)+"px";else{var q=new Image(),U=this;q.onload=function(){q.onload=null,e=q.width,i=q.height,Z.width=g(D*e*c/f)+"px",Z.height=g(k*i*d/v)+"px",U._imageWidth=e,U._imageHeight=i,U._imageSrc=r;},q.src=r;}W||(W=p.doc.createElement("div"),W.style.overflow="hidden",this._cropEl=W);var j=W.style;j.width=g((c+y*c/f)*D),j.height=g((d+x*d/v)*k),j.filter=S+".Matrix(Dx="+-y*c/f*D+",Dy="+-x*d/v*k+")",W.parentNode||I.appendChild(W),F.parentNode!=W&&W.appendChild(F);}else Z.width=g(D*c)+"px",Z.height=g(k*d)+"px",I.appendChild(F),W&&W.parentNode&&(I.removeChild(W),this._cropEl=null);var X="",Y=n.opacity;1>Y&&(X+=".Alpha(opacity="+g(100*Y)+") "),X+=S+".AlphaImageLoader(src="+r+", SizingMethod=scale)",Z.filter=X,I.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,I),n.text&&this.drawRectText(t,this.getBoundingRect());}},h.prototype.onRemove=function(t){k(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t);},h.prototype.onAdd=function(t){P(t,this._vmlEl),this.appendRectText(t);};var W,Z="normal",q={},U=0,j=100,X=document.createElement("div"),Y=function Y(t){var e=q[t];if(!e){U>j&&(U=0,q={});var i,n=X.style;try{n.font=t,i=n.fontFamily.split(",")[0];}catch(r){}e={style:n.fontStyle||Z,variant:n.fontVariant||Z,weight:n.fontWeight||Z,size:0|parseFloat(n.fontSize||12),family:i||"Microsoft YaHei"},q[t]=e,U++;}return e;};s.measureText=function(t,e){var i=p.doc;W||(W=i.createElement("div"),W.style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",p.doc.body.appendChild(W));try{W.style.font=e;}catch(n){}return W.innerHTML="",W.appendChild(i.createTextNode(t)),{width:W.offsetWidth};};for(var $=new r(),Q=function Q(t,e,i,n){var r=this.style,o=r.text;if(o){var a,l,u=r.textAlign,h=Y(r.textFont),c=h.style+" "+h.variant+" "+h.weight+" "+h.size+'px "'+h.family+'"',d=r.textBaseline,f=r.textVerticalAlign;i=i||s.getBoundingRect(o,c,u,d);var m=this.transform;if(m&&!n&&($.copy(e),$.applyTransform(m),e=$),n)a=e.x,l=e.y;else{var v=r.textPosition,y=r.textDistance;if(v instanceof Array)a=e.x+O(v[0],e.width),l=e.y+O(v[1],e.height),u=u||"left",d=d||"top";else{var x=s.adjustTextPositionOnRect(v,e,i,y);a=x.x,l=x.y,u=u||x.textAlign,d=d||x.textBaseline;}}if(f){switch(f){case"middle":l-=i.height/2;break;case"bottom":l-=i.height;}d="top";}var _=h.size;switch(d){case"hanging":case"top":l+=_/1.75;break;case"middle":break;default:l-=_/2.25;}switch(u){case"left":break;case"center":a-=i.width/2;break;case"right":a-=i.width;}var S,M,I,T=p.createNode,A=this._textVmlEl;A?(I=A.firstChild,S=I.nextSibling,M=S.nextSibling):(A=T("line"),S=T("path"),M=T("textpath"),I=T("skew"),M.style["v-text-align"]="left",L(A),S.textpathok=!0,M.on=!0,A.from="0 0",A.to="1000 0.05",P(A,I),P(A,S),P(A,M),this._textVmlEl=A);var D=[a,l],k=A.style;m&&n?(b(D,D,m),I.on=!0,I.matrix=m[0].toFixed(3)+w+m[2].toFixed(3)+w+m[1].toFixed(3)+w+m[3].toFixed(3)+",0,0",I.offset=(g(D[0])||0)+","+(g(D[1])||0),I.origin="0 0",k.left="0px",k.top="0px"):(I.on=!1,k.left=g(a)+"px",k.top=g(l)+"px"),M.string=C(o);try{M.style.font=c;}catch(E){}B(A,"fill",{fill:n?r.fill:r.textFill,opacity:r.opacity},this),B(A,"stroke",{stroke:n?r.stroke:r.textStroke,opacity:r.opacity,lineDash:r.lineDash},this),A.style.zIndex=z(this.zlevel,this.z,this.z2),P(t,A);}},K=function K(t){k(t,this._textVmlEl),this._textVmlEl=null;},J=function J(t){P(t,this._textVmlEl);},tt=[l,u,h,d,c],et=0;et<tt.length;et++){var it=tt[et].prototype;it.drawRectText=Q,it.removeRectText=K,it.appendRectText=J;}c.prototype.brushVML=function(t){var e=this.style;e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t);},c.prototype.onRemove=function(t){this.removeRectText(t);},c.prototype.onAdd=function(t){this.appendRectText(t);};}},function(t,e,i){if(!i(2).canvasSupported){var n,r="urn:schemas-microsoft-com:vml",o=window,a=o.document,s=!1;try{!a.namespaces.zrvml&&a.namespaces.add("zrvml",r),n=function n(t){return a.createElement("<zrvml:"+t+' class="zrvml">');};}catch(l){n=function n(t){return a.createElement("<"+t+' xmlns="'+r+'" class="zrvml">');};}var u=function u(){if(!s){s=!0;var t=a.styleSheets;t.length<31?a.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)");}};t.exports={doc:a,initVML:u,createNode:n};}},function(t,e,i){function n(t){return parseInt(t,10);}function r(t,e){s.initVML(),this.root=t,this.storage=e;var i=document.createElement("div"),n=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",n.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=n,this._vmlViewport=i,this.resize();var r=e.delFromMap,o=e.addToMap;e.delFromMap=function(t){var i=e.get(t);r.call(e,t),i&&i.onRemove&&i.onRemove(n);},e.addToMap=function(t){t.onAdd&&t.onAdd(n),o.call(e,t);},this._firstPaint=!0;}function o(t){return function(){a('In IE8.0 VML mode painter not support method "'+t+'"');};}var a=i(40),s=i(382);r.prototype={constructor:r,getViewportRoot:function getViewportRoot(){return this._vmlViewport;},refresh:function refresh(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t);},_paintList:function _paintList(t){for(var e=this._vmlRoot,i=0;i<t.length;i++){var n=t[i];n.invisible||n.ignore?(n.__alreadyNotVisible||n.onRemove(e),n.__alreadyNotVisible=!0):(n.__alreadyNotVisible&&n.onAdd(e),n.__alreadyNotVisible=!1,n.__dirty&&(n.beforeBrush&&n.beforeBrush(),(n.brushVML||n.brush).call(n,e),n.afterBrush&&n.afterBrush())),n.__dirty=!1;}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1);},resize:function resize(t,e){var t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var i=this._vmlViewport.style;i.width=t+"px",i.height=e+"px";}},dispose:function dispose(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null;},getWidth:function getWidth(){return this._width;},getHeight:function getHeight(){return this._height;},clear:function clear(){this._vmlViewport&&this.root.removeChild(this._vmlViewport);},_getWidth:function _getWidth(){var t=this.root,e=t.currentStyle;return(t.clientWidth||n(e.width))-n(e.paddingLeft)-n(e.paddingRight)|0;},_getHeight:function _getHeight(){var t=this.root,e=t.currentStyle;return(t.clientHeight||n(e.height))-n(e.paddingTop)-n(e.paddingBottom)|0;}};for(var l=["getLayer","insertLayer","eachLayer","eachBuildinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],u=0;u<l.length;u++){var h=l[u];r.prototype[h]=o(h);}t.exports=r;}]);});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(q){var I,J,K,L,M,N,v,s={},w={},x={},O={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(b){var a=b.treeObj,c=f.event;a.bind(c.NODECREATED,function(a,c,g){j.apply(b.callback.onNodeCreated,[a,c,g]);});a.bind(c.CLICK,function(a,c,g,m,h){j.apply(b.callback.onClick,[c,g,m,h]);});a.bind(c.EXPAND,function(a,c,g){j.apply(b.callback.onExpand,[a,c,g]);});a.bind(c.COLLAPSE,function(a,c,g){j.apply(b.callback.onCollapse,[a,c,g]);});a.bind(c.ASYNC_SUCCESS,function(a,c,g,h){j.apply(b.callback.onAsyncSuccess,[a,c,g,h]);});a.bind(c.ASYNC_ERROR,function(a,c,g,h,f,i){j.apply(b.callback.onAsyncError,[a,c,g,h,f,i]);});a.bind(c.REMOVE,function(a,c,g){j.apply(b.callback.onRemove,[a,c,g]);});a.bind(c.SELECTED,function(a,c,g){j.apply(b.callback.onSelected,[c,g]);});a.bind(c.UNSELECTED,function(a,c,g){j.apply(b.callback.onUnSelected,[c,g]);});}],z=[function(b){var a=f.event;b.treeObj.unbind(a.NODECREATED).unbind(a.CLICK).unbind(a.EXPAND).unbind(a.COLLAPSE).unbind(a.ASYNC_SUCCESS).unbind(a.ASYNC_ERROR).unbind(a.REMOVE).unbind(a.SELECTED).unbind(a.UNSELECTED);}],A=[function(b){var a=h.getCache(b);a||(a={},h.setCache(b,a));a.nodes=[];a.doms=[];}],B=[function(b,a,c,d,e,g){if(c){var m=h.getRoot(b),f=b.data.key.children;c.level=a;c.tId=b.treeId+"_"+ ++m.zId;c.parentTId=d?d.tId:null;c.open=typeof c.open=="string"?j.eqs(c.open,"true"):!!c.open;c[f]&&c[f].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent=typeof c.isParent=="string"?j.eqs(c.isParent,"true"):!!c.isParent,c.open=c.isParent&&!b.async.enable?c.open:!1,c.zAsync=!c.isParent);c.isFirstNode=e;c.isLastNode=g;c.getParentNode=function(){return h.getNodeCache(b,c.parentTId);};c.getPreNode=function(){return h.getPreNode(b,c);};c.getNextNode=function(){return h.getNextNode(b,c);};c.getIndex=function(){return h.getNodeIndex(b,c);};c.getPath=function(){return h.getNodePath(b,c);};c.isAjaxing=!1;h.fixPIdKeyValue(b,c);}}],u=[function(b){var a=b.target,c=h.getSetting(b.data.treeId),d="",e=null,g="",m="",i=null,n=null,k=null;if(j.eqs(b.type,"mousedown"))m="mousedown";else if(j.eqs(b.type,"mouseup"))m="mouseup";else if(j.eqs(b.type,"contextmenu"))m="contextmenu";else if(j.eqs(b.type,"click")){if(j.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+f.id.SWITCH)!==null)d=j.getNodeMainDom(a).id,g="switchNode";else{if(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}]))d=j.getNodeMainDom(k).id,g="clickNode";}}else if(j.eqs(b.type,"dblclick")&&(m="dblclick",k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id,g="switchNode";if(m.length>0&&d.length==0&&(k=j.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))d=j.getNodeMainDom(k).id;if(d.length>0)switch(e=h.getNodeCache(c,d),g){case"switchNode":e.isParent?j.eqs(b.type,"click")||j.eqs(b.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand)?i=I:g="":g="";break;case"clickNode":i=J;}switch(m){case"mousedown":n=K;break;case"mouseup":n=L;break;case"dblclick":n=M;break;case"contextmenu":n=N;}return{stop:!1,node:e,nodeEventType:g,nodeEventCallback:i,treeEventType:m,treeEventCallback:n};}],C=[function(b){var a=h.getRoot(b);a||(a={},h.setRoot(b,a));a[b.data.key.children]=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[];a.zId=0;a._ver=new Date().getTime();}],D=[],E=[],F=[],G=[],H=[],h={addNodeCache:function addNodeCache(b,a){h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=a;},getNodeCacheId:function getNodeCacheId(b){return b.substring(b.lastIndexOf("_")+1);},addAfterA:function addAfterA(b){E.push(b);},addBeforeA:function addBeforeA(b){D.push(b);},addInnerAfterA:function addInnerAfterA(b){G.push(b);},addInnerBeforeA:function addInnerBeforeA(b){F.push(b);},addInitBind:function addInitBind(b){y.push(b);},addInitUnBind:function addInitUnBind(b){z.push(b);},addInitCache:function addInitCache(b){A.push(b);},addInitNode:function addInitNode(b){B.push(b);},addInitProxy:function addInitProxy(b,a){a?u.splice(0,0,b):u.push(b);},addInitRoot:function addInitRoot(b){C.push(b);},addNodesData:function addNodesData(b,a,c,d){var e=b.data.key.children;a[e]?c>=a[e].length&&(c=-1):(a[e]=[],c=-1);if(a[e].length>0&&c===0)a[e][0].isFirstNode=!1,i.setNodeLineIcos(b,a[e][0]);else if(a[e].length>0&&c<0)a[e][a[e].length-1].isLastNode=!1,i.setNodeLineIcos(b,a[e][a[e].length-1]);a.isParent=!0;c<0?a[e]=a[e].concat(d):(b=[c,0].concat(d),a[e].splice.apply(a[e],b));},addSelectedNode:function addSelectedNode(b,a){var c=h.getRoot(b);h.isSelectedNode(b,a)||c.curSelectedList.push(a);},addCreatedNode:function addCreatedNode(b,a){(b.callback.onNodeCreated||b.view.addDiyDom)&&h.getRoot(b).createdNodes.push(a);},addZTreeTools:function addZTreeTools(b){H.push(b);},exSetting:function exSetting(b){q.extend(!0,O,b);},fixPIdKeyValue:function fixPIdKeyValue(b,a){b.data.simpleData.enable&&(a[b.data.simpleData.pIdKey]=a.parentTId?a.getParentNode()[b.data.simpleData.idKey]:b.data.simpleData.rootPId);},getAfterA:function getAfterA(b,a,c){for(var d=0,e=E.length;d<e;d++){E[d].apply(this,arguments);}},getBeforeA:function getBeforeA(b,a,c){for(var d=0,e=D.length;d<e;d++){D[d].apply(this,arguments);}},getInnerAfterA:function getInnerAfterA(b,a,c){for(var d=0,e=G.length;d<e;d++){G[d].apply(this,arguments);}},getInnerBeforeA:function getInnerBeforeA(b,a,c){for(var d=0,e=F.length;d<e;d++){F[d].apply(this,arguments);}},getCache:function getCache(b){return x[b.treeId];},getNodeIndex:function getNodeIndex(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e;}return-1;},getNextNode:function getNextNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length-1;e<=g;e++){if(d[c][e]===a)return e==g?null:d[c][e+1];}return null;},getNodeByParam:function getNodeByParam(b,a,c,d){if(!a||!c)return null;for(var e=b.data.key.children,g=0,f=a.length;g<f;g++){if(a[g][c]==d)return a[g];var i=h.getNodeByParam(b,a[g][e],c,d);if(i)return i;}return null;},getNodeCache:function getNodeCache(b,a){if(!a)return null;var c=x[b.treeId].nodes[h.getNodeCacheId(a)];return c?c:null;},getNodeName:function getNodeName(b,a){return""+a[b.data.key.name];},getNodePath:function getNodePath(b,a){if(!a)return null;var c;(c=a.parentTId?a.getParentNode().getPath():[])&&c.push(a);return c;},getNodeTitle:function getNodeTitle(b,a){return""+a[b.data.key.title===""?b.data.key.name:b.data.key.title];},getNodes:function getNodes(b){return h.getRoot(b)[b.data.key.children];},getNodesByParam:function getNodesByParam(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],f=0,i=a.length;f<i;f++){a[f][c]==d&&g.push(a[f]),g=g.concat(h.getNodesByParam(b,a[f][e],c,d));}return g;},getNodesByParamFuzzy:function getNodesByParamFuzzy(b,a,c,d){if(!a||!c)return[];for(var e=b.data.key.children,g=[],d=d.toLowerCase(),f=0,i=a.length;f<i;f++){typeof a[f][c]=="string"&&a[f][c].toLowerCase().indexOf(d)>-1&&g.push(a[f]),g=g.concat(h.getNodesByParamFuzzy(b,a[f][e],c,d));}return g;},getNodesByFilter:function getNodesByFilter(b,a,c,d,e){if(!a)return d?null:[];for(var g=b.data.key.children,f=d?null:[],i=0,n=a.length;i<n;i++){if(j.apply(c,[a[i],e],!1)){if(d)return a[i];f.push(a[i]);}var k=h.getNodesByFilter(b,a[i][g],c,d,e);if(d&&k)return k;f=d?k:f.concat(k);}return f;},getPreNode:function getPreNode(b,a){if(!a)return null;for(var c=b.data.key.children,d=a.parentTId?a.getParentNode():h.getRoot(b),e=0,g=d[c].length;e<g;e++){if(d[c][e]===a)return e==0?null:d[c][e-1];}return null;},getRoot:function getRoot(b){return b?w[b.treeId]:null;},getRoots:function getRoots(){return w;},getSetting:function getSetting(b){return s[b];},getSettings:function getSettings(){return s;},getZTreeTools:function getZTreeTools(b){return(b=this.getRoot(this.getSetting(b)))?b.treeTools:null;},initCache:function initCache(b){for(var a=0,c=A.length;a<c;a++){A[a].apply(this,arguments);}},initNode:function initNode(b,a,c,d,e,g){for(var f=0,h=B.length;f<h;f++){B[f].apply(this,arguments);}},initRoot:function initRoot(b){for(var a=0,c=C.length;a<c;a++){C[a].apply(this,arguments);}},isSelectedNode:function isSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d])return!0;}return!1;},removeNodeCache:function removeNodeCache(b,a){var c=b.data.key.children;if(a[c])for(var d=0,e=a[c].length;d<e;d++){arguments.callee(b,a[c][d]);}h.getCache(b).nodes[h.getNodeCacheId(a.tId)]=null;},removeSelectedNode:function removeSelectedNode(b,a){for(var c=h.getRoot(b),d=0,e=c.curSelectedList.length;d<e;d++){if(a===c.curSelectedList[d]||!h.getNodeCache(b,c.curSelectedList[d].tId))c.curSelectedList.splice(d,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,a]),d--,e--;}},setCache:function setCache(b,a){x[b.treeId]=a;},setRoot:function setRoot(b,a){w[b.treeId]=a;},setZTreeTools:function setZTreeTools(b,a){for(var c=0,d=H.length;c<d;c++){H[c].apply(this,arguments);}},transformToArrayFormat:function transformToArrayFormat(b,a){if(!a)return[];var c=b.data.key.children,d=[];if(j.isArray(a))for(var e=0,g=a.length;e<g;e++){d.push(a[e]),a[e][c]&&(d=d.concat(h.transformToArrayFormat(b,a[e][c])));}else d.push(a),a[c]&&(d=d.concat(h.transformToArrayFormat(b,a[c])));return d;},transformTozTreeFormat:function transformTozTreeFormat(b,a){var c,d,e=b.data.simpleData.idKey,g=b.data.simpleData.pIdKey,f=b.data.key.children;if(!e||e==""||!a)return[];if(j.isArray(a)){var h=[],i=[];for(c=0,d=a.length;c<d;c++){i[a[c][e]]=a[c];}for(c=0,d=a.length;c<d;c++){i[a[c][g]]&&a[c][e]!=a[c][g]?(i[a[c][g]][f]||(i[a[c][g]][f]=[]),i[a[c][g]][f].push(a[c])):h.push(a[c]);}return h;}else return[a];}},l={bindEvent:function bindEvent(b){for(var a=0,c=y.length;a<c;a++){y[a].apply(this,arguments);}},unbindEvent:function unbindEvent(b){for(var a=0,c=z.length;a<c;a++){z[a].apply(this,arguments);}},bindTree:function bindTree(b){var a={treeId:b.treeId},c=b.treeObj;b.view.txtSelectedEnable||c.bind("selectstart",v).css({"-moz-user-select":"-moz-none"});c.bind("click",a,l.proxy);c.bind("dblclick",a,l.proxy);c.bind("mouseover",a,l.proxy);c.bind("mouseout",a,l.proxy);c.bind("mousedown",a,l.proxy);c.bind("mouseup",a,l.proxy);c.bind("contextmenu",a,l.proxy);},unbindTree:function unbindTree(b){b.treeObj.unbind("selectstart",v).unbind("click",l.proxy).unbind("dblclick",l.proxy).unbind("mouseover",l.proxy).unbind("mouseout",l.proxy).unbind("mousedown",l.proxy).unbind("mouseup",l.proxy).unbind("contextmenu",l.proxy);},doProxy:function doProxy(b){for(var a=[],c=0,d=u.length;c<d;c++){var e=u[c].apply(this,arguments);a.push(e);if(e.stop)break;}return a;},proxy:function proxy(b){var a=h.getSetting(b.data.treeId);if(!j.uCanDo(a,b))return!0;for(var a=l.doProxy(b),c=!0,d=0,e=a.length;d<e;d++){var g=a[d];g.nodeEventCallback&&(c=g.nodeEventCallback.apply(g,[b,g.node])&&c);g.treeEventCallback&&(c=g.treeEventCallback.apply(g,[b,g.node])&&c);}return c;}};I=function I(b,a){var c=h.getSetting(b.data.treeId);if(a.open){if(j.apply(c.callback.beforeCollapse,[c.treeId,a],!0)==!1)return!0;}else if(j.apply(c.callback.beforeExpand,[c.treeId,a],!0)==!1)return!0;h.getRoot(c).expandTriggerFlag=!0;i.switchNode(c,a);return!0;};J=function J(b,a){var c=h.getSetting(b.data.treeId),d=c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&h.isSelectedNode(c,a)?0:c.view.autoCancelSelected&&(b.ctrlKey||b.metaKey)&&c.view.selectedMulti?2:1;if(j.apply(c.callback.beforeClick,[c.treeId,a,d],!0)==!1)return!0;d===0?i.cancelPreSelectedNode(c,a):i.selectNode(c,a,d===2);c.treeObj.trigger(f.event.CLICK,[b,c.treeId,a,d]);return!0;};K=function K(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseDown,[c.treeId,a],!0)&&j.apply(c.callback.onMouseDown,[b,c.treeId,a]);return!0;};L=function L(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeMouseUp,[c.treeId,a],!0)&&j.apply(c.callback.onMouseUp,[b,c.treeId,a]);return!0;};M=function M(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeDblClick,[c.treeId,a],!0)&&j.apply(c.callback.onDblClick,[b,c.treeId,a]);return!0;};N=function N(b,a){var c=h.getSetting(b.data.treeId);j.apply(c.callback.beforeRightClick,[c.treeId,a],!0)&&j.apply(c.callback.onRightClick,[b,c.treeId,a]);return typeof c.callback.onRightClick!="function";};v=function v(b){b=b.originalEvent.srcElement.nodeName.toLowerCase();return b==="input"||b==="textarea";};var j={apply:function apply(b,a,c){return typeof b=="function"?b.apply(P,a?a:[]):c;},canAsync:function canAsync(b,a){var c=b.data.key.children;return b.async.enable&&a&&a.isParent&&!(a.zAsync||a[c]&&a[c].length>0);},clone:function clone(b){if(b===null)return null;var a=j.isArray(b)?[]:{},c;for(c in b){a[c]=b[c]instanceof Date?new Date(b[c].getTime()):_typeof(b[c])==="object"?arguments.callee(b[c]):b[c];}return a;},eqs:function eqs(b,a){return b.toLowerCase()===a.toLowerCase();},isArray:function isArray(b){return Object.prototype.toString.apply(b)==="[object Array]";},$:function $(b,a,c){a&&typeof a!="string"&&(c=a,a="");return typeof b=="string"?q(b,c?c.treeObj.get(0).ownerDocument:null):q("#"+b.tId+a,c?c.treeObj:null);},getMDom:function getMDom(b,a,c){if(!a)return null;for(;a&&a.id!==b.treeId;){for(var d=0,e=c.length;a.tagName&&d<e;d++){if(j.eqs(a.tagName,c[d].tagName)&&a.getAttribute(c[d].attrName)!==null)return a;}a=a.parentNode;}return null;},getNodeMainDom:function getNodeMainDom(b){return q(b).parent("li").get(0)||q(b).parentsUntil("li").parent().get(0);},isChildOrSelf:function isChildOrSelf(b,a){return q(b).closest("#"+a).length>0;},uCanDo:function uCanDo(){return!0;}},i={addNodes:function addNodes(b,a,c,d,e){if(!b.data.keep.leaf||!a||a.isParent)if(j.isArray(d)||(d=[d]),b.data.simpleData.enable&&(d=h.transformTozTreeFormat(b,d)),a){var g=k(a,f.id.SWITCH,b),m=k(a,f.id.ICON,b),o=k(a,f.id.UL,b);if(!a.open)i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,m,f.folder.CLOSE),a.open=!1,o.css({display:"none"});h.addNodesData(b,a,c,d);i.createNodes(b,a.level+1,d,a,c);e||i.expandCollapseParentNode(b,a,!0);}else h.addNodesData(b,h.getRoot(b),c,d),i.createNodes(b,0,d,null,c);},appendNodes:function appendNodes(b,a,c,d,e,g,f){if(!c)return[];var j=[],k=b.data.key.children,l=(d?d:h.getRoot(b))[k],r,Q;if(!l||e>=l.length)e=-1;for(var t=0,q=c.length;t<q;t++){var p=c[t];g&&(r=(e===0||l.length==c.length)&&t==0,Q=e<0&&t==c.length-1,h.initNode(b,a,p,d,r,Q,f),h.addNodeCache(b,p));r=[];p[k]&&p[k].length>0&&(r=i.appendNodes(b,a+1,p[k],p,-1,g,f&&p.open));f&&(i.makeDOMNodeMainBefore(j,b,p),i.makeDOMNodeLine(j,b,p),h.getBeforeA(b,p,j),i.makeDOMNodeNameBefore(j,b,p),h.getInnerBeforeA(b,p,j),i.makeDOMNodeIcon(j,b,p),h.getInnerAfterA(b,p,j),i.makeDOMNodeNameAfter(j,b,p),h.getAfterA(b,p,j),p.isParent&&p.open&&i.makeUlHtml(b,p,j,r.join("")),i.makeDOMNodeMainAfter(j,b,p),h.addCreatedNode(b,p));}return j;},appendParentULDom:function appendParentULDom(b,a){var c=[],d=k(a,b);!d.get(0)&&a.parentTId&&(i.appendParentULDom(b,a.getParentNode()),d=k(a,b));var e=k(a,f.id.UL,b);e.get(0)&&e.remove();e=i.appendNodes(b,a.level+1,a[b.data.key.children],a,-1,!1,!0);i.makeUlHtml(b,a,c,e.join(""));d.append(c.join(""));},asyncNode:function asyncNode(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;else if(a&&a.isAjaxing)return!1;else if(j.apply(b.callback.beforeAsync,[b.treeId,a],!0)==!1)return j.apply(d),!1;if(a)a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:"","class":f.className.BUTTON+" "+f.className.ICO_LOADING});var m={};for(e=0,g=b.async.autoParam.length;a&&e<g;e++){var o=b.async.autoParam[e].split("="),n=o;o.length>1&&(n=o[1],o=o[0]);m[n]=a[o];}if(j.isArray(b.async.otherParam))for(e=0,g=b.async.otherParam.length;e<g;e+=2){m[b.async.otherParam[e]]=b.async.otherParam[e+1];}else for(var l in b.async.otherParam){m[l]=b.async.otherParam[l];}var r=h.getRoot(b)._ver;q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:m,dataType:b.async.dataType,success:function success(e){if(r==h.getRoot(b)._ver){var g=[];try{g=!e||e.length==0?[]:typeof e=="string"?eval("("+e+")"):e;}catch(m){g=e;}if(a)a.isAjaxing=null,a.zAsync=!0;i.setNodeLineIcos(b,a);g&&g!==""?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c);b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]);j.apply(d);}},error:function error(c,d,e){if(r==h.getRoot(b)._ver){if(a)a.isAjaxing=null;i.setNodeLineIcos(b,a);b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,c,d,e]);}}});return!0;},cancelPreSelectedNode:function cancelPreSelectedNode(b,a,c){var d=h.getRoot(b).curSelectedList,e,g;for(e=d.length-1;e>=0;e--){if(g=d[e],a===g||!a&&(!c||c!==g))if(k(g,f.id.A,b).removeClass(f.node.CURSELECTED),a){h.removeSelectedNode(b,a);break;}else d.splice(e,1),b.treeObj.trigger(f.event.UNSELECTED,[b.treeId,g]);}},createNodeCallback:function createNodeCallback(b){if(b.callback.onNodeCreated||b.view.addDiyDom)for(var a=h.getRoot(b);a.createdNodes.length>0;){var c=a.createdNodes.shift();j.apply(b.view.addDiyDom,[b.treeId,c]);b.callback.onNodeCreated&&b.treeObj.trigger(f.event.NODECREATED,[b.treeId,c]);}},createNodes:function createNodes(b,a,c,d,e){if(c&&c.length!=0){var g=h.getRoot(b),j=b.data.key.children,j=!d||d.open||!!k(d[j][0],b).get(0);g.createdNodes=[];var a=i.appendNodes(b,a,c,d,e,!0,j),o,n;d?(d=k(d,f.id.UL,b),d.get(0)&&(o=d)):o=b.treeObj;o&&(e>=0&&(n=o.children()[e]),e>=0&&n?q(n).before(a.join("")):o.append(a.join("")));i.createNodeCallback(b);}},destroy:function destroy(b){b&&(h.initCache(b),h.initRoot(b),l.unbindTree(b),l.unbindEvent(b),b.treeObj.empty(),delete s[b.treeId]);},expandCollapseNode:function expandCollapseNode(b,a,c,d,e){var g=h.getRoot(b),m=b.data.key.children;if(a){if(g.expandTriggerFlag){var o=e,e=function e(){o&&o();a.open?b.treeObj.trigger(f.event.EXPAND,[b.treeId,a]):b.treeObj.trigger(f.event.COLLAPSE,[b.treeId,a]);};g.expandTriggerFlag=!1;}if(!a.open&&a.isParent&&(!k(a,f.id.UL,b).get(0)||a[m]&&a[m].length>0&&!k(a[m][0],b).get(0)))i.appendParentULDom(b,a),i.createNodeCallback(b);if(a.open==c)j.apply(e,[]);else{var c=k(a,f.id.UL,b),g=k(a,f.id.SWITCH,b),n=k(a,f.id.ICON,b);a.isParent?(a.open=!a.open,a.iconOpen&&a.iconClose&&n.attr("style",i.makeNodeIcoStyle(b,a)),a.open?(i.replaceSwitchClass(a,g,f.folder.OPEN),i.replaceIcoClass(a,n,f.folder.OPEN),d==!1||b.view.expandSpeed==""?(c.show(),j.apply(e,[])):a[m]&&a[m].length>0?c.slideDown(b.view.expandSpeed,e):(c.show(),j.apply(e,[]))):(i.replaceSwitchClass(a,g,f.folder.CLOSE),i.replaceIcoClass(a,n,f.folder.CLOSE),d==!1||b.view.expandSpeed==""||!(a[m]&&a[m].length>0)?(c.hide(),j.apply(e,[])):c.slideUp(b.view.expandSpeed,e))):j.apply(e,[]);}}else j.apply(e,[]);},expandCollapseParentNode:function expandCollapseParentNode(b,a,c,d,e){a&&(a.parentTId?(i.expandCollapseNode(b,a,c,d),a.parentTId&&i.expandCollapseParentNode(b,a.getParentNode(),c,d,e)):i.expandCollapseNode(b,a,c,d,e));},expandCollapseSonNode:function expandCollapseSonNode(b,a,c,d,e){var g=h.getRoot(b),f=b.data.key.children,g=a?a[f]:g[f],f=a?!1:d,j=h.getRoot(b).expandTriggerFlag;h.getRoot(b).expandTriggerFlag=!1;if(g)for(var k=0,l=g.length;k<l;k++){g[k]&&i.expandCollapseSonNode(b,g[k],c,f);}h.getRoot(b).expandTriggerFlag=j;i.expandCollapseNode(b,a,c,d,e);},isSelectedNode:function isSelectedNode(b,a){if(!a)return!1;var c=h.getRoot(b).curSelectedList,d;for(d=c.length-1;d>=0;d--){if(a===c[d])return!0;}return!1;},makeDOMNodeIcon:function makeDOMNodeIcon(b,a,c){var d=h.getNodeName(a,c),d=a.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");b.push("<span id='",c.tId,f.id.ICON,"' title='' treeNode",f.id.ICON," class='",i.makeNodeIcoClass(a,c),"' style='",i.makeNodeIcoStyle(a,c),"'></span><span id='",c.tId,f.id.SPAN,"'>",d,"</span>");},makeDOMNodeLine:function makeDOMNodeLine(b,a,c){b.push("<span id='",c.tId,f.id.SWITCH,"' title='' class='",i.makeNodeLineClass(a,c),"' treeNode",f.id.SWITCH,"></span>");},makeDOMNodeMainAfter:function makeDOMNodeMainAfter(b){b.push("</li>");},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(b,a,c){b.push("<li id='",c.tId,"' class='",f.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>");},makeDOMNodeNameAfter:function makeDOMNodeNameAfter(b){b.push("</a>");},makeDOMNodeNameBefore:function makeDOMNodeNameBefore(b,a,c){var d=h.getNodeTitle(a,c),e=i.makeNodeUrl(a,c),g=i.makeNodeFontCss(a,c),m=[],k;for(k in g){m.push(k,":",g[k],";");}b.push("<a id='",c.tId,f.id.A,"' class='",f.className.LEVEL,c.level,"' treeNode",f.id.A,' onclick="',c.click||"",'" ',e!=null&&e.length>0?"href='"+e+"'":""," target='",i.makeNodeTarget(c),"' style='",m.join(""),"'");j.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&d&&b.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");b.push(">");},makeNodeFontCss:function makeNodeFontCss(b,a){var c=j.apply(b.view.fontCss,[b.treeId,a],b.view.fontCss);return c&&typeof c!="function"?c:{};},makeNodeIcoClass:function makeNodeIcoClass(b,a){var c=["ico"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+"_":"")+c[0],a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU));return f.className.BUTTON+" "+c.join("_");},makeNodeIcoStyle:function makeNodeIcoStyle(b,a){var c=[];if(!a.isAjaxing){var d=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a[b.data.key.icon];d&&c.push("background:url(",d,") 0 0 no-repeat;");(b.view.showIcon==!1||!j.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push("width:0px;height:0px;");}return c.join("");},makeNodeLineClass:function makeNodeLineClass(b,a){var c=[];b.view.showLine?a.level==0&&a.isFirstNode&&a.isLastNode?c.push(f.line.ROOT):a.level==0&&a.isFirstNode?c.push(f.line.ROOTS):a.isLastNode?c.push(f.line.BOTTOM):c.push(f.line.CENTER):c.push(f.line.NOLINE);a.isParent?c.push(a.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU);return i.makeNodeLineClassEx(a)+c.join("_");},makeNodeLineClassEx:function makeNodeLineClassEx(b){return f.className.BUTTON+" "+f.className.LEVEL+b.level+" "+f.className.SWITCH+" ";},makeNodeTarget:function makeNodeTarget(b){return b.target||"_blank";},makeNodeUrl:function makeNodeUrl(b,a){var c=b.data.key.url;return a[c]?a[c]:null;},makeUlHtml:function makeUlHtml(b,a,c,d){c.push("<ul id='",a.tId,f.id.UL,"' class='",f.className.LEVEL,a.level," ",i.makeUlLineClass(b,a),"' style='display:",a.open?"block":"none","'>");c.push(d);c.push("</ul>");},makeUlLineClass:function makeUlLineClass(b,a){return b.view.showLine&&!a.isLastNode?f.line.LINE:"";},removeChildNodes:function removeChildNodes(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){for(var e=0,g=d.length;e<g;e++){h.removeNodeCache(b,d[e]);}h.removeSelectedNode(b);delete a[c];b.data.keep.parent?k(a,f.id.UL,b).empty():(a.isParent=!1,a.open=!1,c=k(a,f.id.SWITCH,b),d=k(a,f.id.ICON,b),i.replaceSwitchClass(a,c,f.folder.DOCU),i.replaceIcoClass(a,d,f.folder.DOCU),k(a,f.id.UL,b).remove());}}},setFirstNode:function setFirstNode(b,a){var c=b.data.key.children;if(a[c].length>0)a[c][0].isFirstNode=!0;},setLastNode:function setLastNode(b,a){var c=b.data.key.children,d=a[c].length;if(d>0)a[c][d-1].isLastNode=!0;},removeNode:function removeNode(b,a){var c=h.getRoot(b),d=b.data.key.children,e=a.parentTId?a.getParentNode():c;a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null;};a.getNextNode=function(){return null;};if(h.getNodeCache(b,a.tId)){k(a,b).remove();h.removeNodeCache(b,a);h.removeSelectedNode(b,a);for(var g=0,j=e[d].length;g<j;g++){if(e[d][g].tId==a.tId){e[d].splice(g,1);break;}}i.setFirstNode(b,e);i.setLastNode(b,e);var o,g=e[d].length;if(!b.data.keep.parent&&g==0)e.isParent=!1,e.open=!1,g=k(e,f.id.UL,b),j=k(e,f.id.SWITCH,b),o=k(e,f.id.ICON,b),i.replaceSwitchClass(e,j,f.folder.DOCU),i.replaceIcoClass(e,o,f.folder.DOCU),g.css("display","none");else if(b.view.showLine&&g>0){var n=e[d][g-1],g=k(n,f.id.UL,b),j=k(n,f.id.SWITCH,b);o=k(n,f.id.ICON,b);e==c?e[d].length==1?i.replaceSwitchClass(n,j,f.line.ROOT):(c=k(e[d][0],f.id.SWITCH,b),i.replaceSwitchClass(e[d][0],c,f.line.ROOTS),i.replaceSwitchClass(n,j,f.line.BOTTOM)):i.replaceSwitchClass(n,j,f.line.BOTTOM);g.removeClass(f.line.LINE);}}},replaceIcoClass:function replaceIcoClass(b,a,c){if(a&&!b.isAjaxing&&(b=a.attr("class"),b!=void 0)){b=b.split("_");switch(c){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:b[b.length-1]=c;}a.attr("class",b.join("_"));}},replaceSwitchClass:function replaceSwitchClass(b,a,c){if(a){var d=a.attr("class");if(d!=void 0){d=d.split("_");switch(c){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:d[0]=i.makeNodeLineClassEx(b)+c;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:d[1]=c;}a.attr("class",d.join("_"));c!==f.folder.DOCU?a.removeAttr("disabled"):a.attr("disabled","disabled");}}},selectNode:function selectNode(b,a,c){c||i.cancelPreSelectedNode(b,null,a);k(a,f.id.A,b).addClass(f.node.CURSELECTED);h.addSelectedNode(b,a);b.treeObj.trigger(f.event.SELECTED,[b.treeId,a]);},setNodeFontCss:function setNodeFontCss(b,a){var c=k(a,f.id.A,b),d=i.makeNodeFontCss(b,a);d&&c.css(d);},setNodeLineIcos:function setNodeLineIcos(b,a){if(a){var c=k(a,f.id.SWITCH,b),d=k(a,f.id.UL,b),e=k(a,f.id.ICON,b),g=i.makeUlLineClass(b,a);g.length==0?d.removeClass(f.line.LINE):d.addClass(g);c.attr("class",i.makeNodeLineClass(b,a));a.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");e.removeAttr("style");e.attr("style",i.makeNodeIcoStyle(b,a));e.attr("class",i.makeNodeIcoClass(b,a));}},setNodeName:function setNodeName(b,a){var c=h.getNodeTitle(b,a),d=k(a,f.id.SPAN,b);d.empty();b.view.nameIsHTML?d.html(h.getNodeName(b,a)):d.text(h.getNodeName(b,a));j.apply(b.view.showTitle,[b.treeId,a],b.view.showTitle)&&k(a,f.id.A,b).attr("title",!c?"":c);},setNodeTarget:function setNodeTarget(b,a){k(a,f.id.A,b).attr("target",i.makeNodeTarget(a));},setNodeUrl:function setNodeUrl(b,a){var c=k(a,f.id.A,b),d=i.makeNodeUrl(b,a);d==null||d.length==0?c.removeAttr("href"):c.attr("href",d);},switchNode:function switchNode(b,a){a.open||!j.canAsync(b,a)?i.expandCollapseNode(b,a,!a.open):b.async.enable?i.asyncNode(b,a)||i.expandCollapseNode(b,a,!a.open):a&&i.expandCollapseNode(b,a,!a.open);}};q.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:l,data:h},getZTreeObj:function getZTreeObj(b){return(b=h.getZTreeTools(b))?b:null;},destroy:function destroy(b){if(b&&b.length>0)i.destroy(h.getSetting(b));else for(var a in s){i.destroy(s[a]);}},init:function init(b,a,c){var d=j.clone(O);q.extend(!0,d,a);d.treeId=b.attr("id");d.treeObj=b;d.treeObj.empty();s[d.treeId]=d;if(typeof document.body.style.maxHeight==="undefined")d.view.expandSpeed="";h.initRoot(d);b=h.getRoot(d);a=d.data.key.children;c=c?j.clone(j.isArray(c)?c:[c]):[];b[a]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c;h.initCache(d);l.unbindTree(d);l.bindTree(d);l.unbindEvent(d);l.bindEvent(d);c={setting:d,addNodes:function addNodes(a,b,c,f){function h(){i.addNodes(d,a,b,l,f==!0);}a||(a=null);if(a&&!a.isParent&&d.data.keep.leaf)return null;var k=parseInt(b,10);isNaN(k)?(f=!!c,c=b,b=-1):b=k;if(!c)return null;var l=j.clone(j.isArray(c)?c:[c]);j.canAsync(d,a)?i.asyncNode(d,a,f,h):h();return l;},cancelSelectedNode:function cancelSelectedNode(a){i.cancelPreSelectedNode(d,a);},destroy:function destroy(){i.destroy(d);},expandAll:function expandAll(a){a=!!a;i.expandCollapseSonNode(d,null,a,!0);return a;},expandNode:function expandNode(a,b,c,f,n){if(!a||!a.isParent)return null;b!==!0&&b!==!1&&(b=!a.open);if((n=!!n)&&b&&j.apply(d.callback.beforeExpand,[d.treeId,a],!0)==!1)return null;else if(n&&!b&&j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)==!1)return null;b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1);if(b===a.open&&!c)return null;h.getRoot(d).expandTriggerFlag=n;if(!j.canAsync(d,a)&&c)i.expandCollapseSonNode(d,a,b,!0,function(){if(f!==!1)try{k(a,d).focus().blur();}catch(b){}});else if(a.open=!b,i.switchNode(this.setting,a),f!==!1)try{k(a,d).focus().blur();}catch(l){}return b;},getNodes:function getNodes(){return h.getNodes(d);},getNodeByParam:function getNodeByParam(a,b,c){return!a?null:h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodeByTId:function getNodeByTId(a){return h.getNodeCache(d,a);},getNodesByParam:function getNodesByParam(a,b,c){return!a?null:h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByParamFuzzy:function getNodesByParamFuzzy(a,b,c){return!a?null:h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b);},getNodesByFilter:function getNodesByFilter(a,b,c,f){b=!!b;return!a||typeof a!="function"?b?null:[]:h.getNodesByFilter(d,c?c[d.data.key.children]:h.getNodes(d),a,b,f);},getNodeIndex:function getNodeIndex(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),f=0,i=c[b].length;f<i;f++){if(c[b][f]==a)return f;}return-1;},getSelectedNodes:function getSelectedNodes(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,f=b.length;c<f;c++){a.push(b[c]);}return a;},isSelectedNode:function isSelectedNode(a){return h.isSelectedNode(d,a);},reAsyncChildNodes:function reAsyncChildNodes(a,b,c){if(this.setting.async.enable){var j=!a;j&&(a=h.getRoot(d));if(b=="refresh"){for(var b=this.setting.data.key.children,l=0,q=a[b]?a[b].length:0;l<q;l++){h.removeNodeCache(d,a[b][l]);}h.removeSelectedNode(d);a[b]=[];j?this.setting.treeObj.empty():k(a,f.id.UL,d).empty();}i.asyncNode(this.setting,j?null:a,!!c);}},refresh:function refresh(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d);a[d.data.key.children]=b;h.initCache(d);i.createNodes(d,0,a[d.data.key.children],null,-1);},removeChildNodes:function removeChildNodes(a){if(!a)return null;var b=a[d.data.key.children];i.removeChildNodes(d,a);return b?b:null;},removeNode:function removeNode(a,b){a&&(b=!!b,b&&j.apply(d.callback.beforeRemove,[d.treeId,a],!0)==!1||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(f.event.REMOVE,[d.treeId,a])));},selectNode:function selectNode(a,b){if(a&&j.uCanDo(d)){b=d.view.selectedMulti&&b;if(a.parentTId)i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{k(a,d).focus().blur();}catch(b){}});else try{k(a,d).focus().blur();}catch(c){}i.selectNode(d,a,b);}},transformTozTreeNodes:function transformTozTreeNodes(a){return h.transformTozTreeFormat(d,a);},transformToArray:function transformToArray(a){return h.transformToArrayFormat(d,a);},updateNode:function updateNode(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a));}};b.treeTools=c;h.setZTreeTools(d,c);b[a]&&b[a].length>0?i.createNodes(d,0,b[a],null,-1):d.async.enable&&d.async.url&&d.async.url!==""&&i.asyncNode(d);return c;}};var P=q.fn.zTree,k=j.$,f=P.consts;})(jQuery);(function(m){var p,q,r,o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};p=function p(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=b.data.key.checked;if(k.apply(b.callback.beforeCheck,[b.treeId,a],!0)==!1)return!0;a[d]=!a[d];e.checkNodeRelation(b,a);d=n(a,j.id.CHECK,b);e.setChkClass(b,d,a);e.repairParentChkClassWithSelf(b,a);b.treeObj.trigger(j.event.CHECK,[c,b.treeId,a]);return!0;};q=function q(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!0;e.setChkClass(b,d,a);return!0;};r=function r(c,a){if(a.chkDisabled===!0)return!1;var b=g.getSetting(c.data.treeId),d=n(a,j.id.CHECK,b);a.check_Focus=!1;e.setChkClass(b,d,a);return!0;};m.extend(!0,m.fn.zTree.consts,o);m.extend(!0,m.fn.zTree._z,{tools:{},view:{checkNodeRelation:function checkNodeRelation(c,a){var b,d,h,i=c.data.key.children,l=c.data.key.checked;b=j.radio;if(c.check.chkStyle==b.STYLE){var f=g.getRadioCheckedList(c);if(a[l]){if(c.check.radioType==b.TYPE_ALL){for(d=f.length-1;d>=0;d--){b=f[d],b[l]&&b!=a&&(b[l]=!1,f.splice(d,1),e.setChkClass(c,n(b,j.id.CHECK,c),b),b.parentTId!=a.parentTId&&e.repairParentChkClassWithSelf(c,b));}f.push(a);}else{f=a.parentTId?a.getParentNode():g.getRoot(c);for(d=0,h=f[i].length;d<h;d++){b=f[i][d],b[l]&&b!=a&&(b[l]=!1,e.setChkClass(c,n(b,j.id.CHECK,c),b));}}}else if(c.check.radioType==b.TYPE_ALL)for(d=0,h=f.length;d<h;d++){if(a==f[d]){f.splice(d,1);break;}}}else a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.Y.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!0),!a[l]&&(!a[i]||a[i].length==0||c.check.chkboxType.N.indexOf("s")>-1)&&e.setSonNodeCheckBox(c,a,!1),a[l]&&c.check.chkboxType.Y.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!0),!a[l]&&c.check.chkboxType.N.indexOf("p")>-1&&e.setParentNodeCheckBox(c,a,!1);},makeChkClass:function makeChkClass(c,a){var b=c.data.key.checked,d=j.checkbox,h=j.radio,i="",i=a.chkDisabled===!0?d.DISABLED:a.halfCheck?d.PART:c.check.chkStyle==h.STYLE?a.check_Child_State<1?d.FULL:d.PART:a[b]?a.check_Child_State===2||a.check_Child_State===-1?d.FULL:d.PART:a.check_Child_State<1?d.FULL:d.PART,b=c.check.chkStyle+"_"+(a[b]?d.TRUE:d.FALSE)+"_"+i,b=a.check_Focus&&a.chkDisabled!==!0?b+"_"+d.FOCUS:b;return j.className.BUTTON+" "+d.DEFAULT+" "+b;},repairAllChk:function repairAllChk(c,a){if(c.check.enable&&c.check.chkStyle===j.checkbox.STYLE)for(var b=c.data.key.checked,d=c.data.key.children,h=g.getRoot(c),i=0,l=h[d].length;i<l;i++){var f=h[d][i];f.nocheck!==!0&&f.chkDisabled!==!0&&(f[b]=a);e.setSonNodeCheckBox(c,f,a);}},repairChkClass:function repairChkClass(c,a){if(a&&(g.makeChkFlag(c,a),a.nocheck!==!0)){var b=n(a,j.id.CHECK,c);e.setChkClass(c,b,a);}},repairParentChkClass:function repairParentChkClass(c,a){if(a&&a.parentTId){var b=a.getParentNode();e.repairChkClass(c,b);e.repairParentChkClass(c,b);}},repairParentChkClassWithSelf:function repairParentChkClassWithSelf(c,a){if(a){var b=c.data.key.children;a[b]&&a[b].length>0?e.repairParentChkClass(c,a[b][0]):e.repairParentChkClass(c,a);}},repairSonChkDisabled:function repairSonChkDisabled(c,a,b,d){if(a){var h=c.data.key.children;if(a.chkDisabled!=b)a.chkDisabled=b;e.repairChkClass(c,a);if(a[h]&&d)for(var i=0,l=a[h].length;i<l;i++){e.repairSonChkDisabled(c,a[h][i],b,d);}}},repairParentChkDisabled:function repairParentChkDisabled(c,a,b,d){if(a){if(a.chkDisabled!=b&&d)a.chkDisabled=b;e.repairChkClass(c,a);e.repairParentChkDisabled(c,a.getParentNode(),b,d);}},setChkClass:function setChkClass(c,a,b){a&&(b.nocheck===!0?a.hide():a.show(),a.attr("class",e.makeChkClass(c,b)));},setParentNodeCheckBox:function setParentNodeCheckBox(c,a,b,d){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);g.makeChkFlag(c,a);a.nocheck!==!0&&a.chkDisabled!==!0&&(a[i]=b,e.setChkClass(c,l,a),c.check.autoCheckTrigger&&a!=d&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]));if(a.parentTId){l=!0;if(!b)for(var h=a.getParentNode()[h],f=0,k=h.length;f<k;f++){if(h[f].nocheck!==!0&&h[f].chkDisabled!==!0&&h[f][i]||(h[f].nocheck===!0||h[f].chkDisabled===!0)&&h[f].check_Child_State>0){l=!1;break;}}l&&e.setParentNodeCheckBox(c,a.getParentNode(),b,d);}},setSonNodeCheckBox:function setSonNodeCheckBox(c,a,b,d){if(a){var h=c.data.key.children,i=c.data.key.checked,l=n(a,j.id.CHECK,c);d||(d=a);var f=!1;if(a[h])for(var k=0,m=a[h].length;k<m&&a.chkDisabled!==!0;k++){var o=a[h][k];e.setSonNodeCheckBox(c,o,b,d);o.chkDisabled===!0&&(f=!0);}if(a!=g.getRoot(c)&&a.chkDisabled!==!0){f&&a.nocheck!==!0&&g.makeChkFlag(c,a);if(a.nocheck!==!0&&a.chkDisabled!==!0){if(a[i]=b,!f)a.check_Child_State=a[h]&&a[h].length>0?b?2:0:-1;}else a.check_Child_State=-1;e.setChkClass(c,l,a);c.check.autoCheckTrigger&&a!=d&&a.nocheck!==!0&&a.chkDisabled!==!0&&c.treeObj.trigger(j.event.CHECK,[null,c.treeId,a]);}}}},event:{},data:{getRadioCheckedList:function getRadioCheckedList(c){for(var a=g.getRoot(c).radioCheckedList,b=0,d=a.length;b<d;b++){g.getNodeCache(c,a[b].tId)||(a.splice(b,1),b--,d--);}return a;},getCheckStatus:function getCheckStatus(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled)return null;var b=c.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:c.check.chkStyle==j.radio.STYLE?a.check_Child_State===2:a[b]?a.check_Child_State>-1&&a.check_Child_State<2:a.check_Child_State>0};},getTreeCheckedNodes:function getTreeCheckedNodes(c,a,b,d){if(!a)return[];for(var h=c.data.key.children,i=c.data.key.checked,e=b&&c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL,d=!d?[]:d,f=0,k=a.length;f<k;f++){if(a[f].nocheck!==!0&&a[f].chkDisabled!==!0&&a[f][i]==b&&(d.push(a[f]),e))break;g.getTreeCheckedNodes(c,a[f][h],b,d);if(e&&d.length>0)break;}return d;},getTreeChangeCheckedNodes:function getTreeChangeCheckedNodes(c,a,b){if(!a)return[];for(var d=c.data.key.children,h=c.data.key.checked,b=!b?[]:b,i=0,e=a.length;i<e;i++){a[i].nocheck!==!0&&a[i].chkDisabled!==!0&&a[i][h]!=a[i].checkedOld&&b.push(a[i]),g.getTreeChangeCheckedNodes(c,a[i][d],b);}return b;},makeChkFlag:function makeChkFlag(c,a){if(a){var b=c.data.key.children,d=c.data.key.checked,h=-1;if(a[b])for(var i=0,e=a[b].length;i<e;i++){var f=a[b][i],g=-1;if(c.check.chkStyle==j.radio.STYLE){if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?2:f[d]?2:f.check_Child_State>0?2:0,g==2){h=2;break;}else g==0&&(h=0);}else if(c.check.chkStyle==j.checkbox.STYLE)if(g=f.nocheck===!0||f.chkDisabled===!0?f.check_Child_State:f.halfCheck===!0?1:f[d]?f.check_Child_State===-1||f.check_Child_State===2?2:1:f.check_Child_State>0?1:0,g===1){h=1;break;}else if(g===2&&h>-1&&i>0&&g!==h){h=1;break;}else if(h===2&&g>-1&&g<2){h=1;break;}else g>-1&&(h=g);}a.check_Child_State=h;}}}});var m=m.fn.zTree,k=m._z.tools,j=m.consts,e=m._z.view,g=m._z.data,n=k.$;g.exSetting(v);g.addInitBind(function(c){c.treeObj.bind(j.event.CHECK,function(a,b,d,h){a.srcEvent=b;k.apply(c.callback.onCheck,[a,d,h]);});});g.addInitUnBind(function(c){c.treeObj.unbind(j.event.CHECK);});g.addInitCache(function(){});g.addInitNode(function(c,a,b,d){if(b){a=c.data.key.checked;typeof b[a]=="string"&&(b[a]=k.eqs(b[a],"true"));b[a]=!!b[a];b.checkedOld=b[a];if(typeof b.nocheck=="string")b.nocheck=k.eqs(b.nocheck,"true");b.nocheck=!!b.nocheck||c.check.nocheckInherit&&d&&!!d.nocheck;if(typeof b.chkDisabled=="string")b.chkDisabled=k.eqs(b.chkDisabled,"true");b.chkDisabled=!!b.chkDisabled||c.check.chkDisabledInherit&&d&&!!d.chkDisabled;if(typeof b.halfCheck=="string")b.halfCheck=k.eqs(b.halfCheck,"true");b.halfCheck=!!b.halfCheck;b.check_Child_State=-1;b.check_Focus=!1;b.getCheckStatus=function(){return g.getCheckStatus(c,b);};c.check.chkStyle==j.radio.STYLE&&c.check.radioType==j.radio.TYPE_ALL&&b[a]&&g.getRoot(c).radioCheckedList.push(b);}});g.addInitProxy(function(c){var a=c.target,b=g.getSetting(c.data.treeId),d="",h=null,e="",l=null;if(k.eqs(c.type,"mouseover")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoverCheck";}else if(k.eqs(c.type,"mouseout")){if(b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="mouseoutCheck";}else if(k.eqs(c.type,"click")&&b.check.enable&&k.eqs(a.tagName,"span")&&a.getAttribute("treeNode"+j.id.CHECK)!==null)d=k.getNodeMainDom(a).id,e="checkNode";if(d.length>0)switch(h=g.getNodeCache(b,d),e){case"checkNode":l=p;break;case"mouseoverCheck":l=q;break;case"mouseoutCheck":l=r;}return{stop:e==="checkNode",node:h,nodeEventType:e,nodeEventCallback:l,treeEventType:"",treeEventCallback:null};},!0);g.addInitRoot(function(c){g.getRoot(c).radioCheckedList=[];});g.addBeforeA(function(c,a,b){c.check.enable&&(g.makeChkFlag(c,a),b.push("<span ID='",a.tId,j.id.CHECK,"' class='",e.makeChkClass(c,a),"' treeNode",j.id.CHECK,a.nocheck===!0?" style='display:none;'":"","></span>"));});g.addZTreeTools(function(c,a){a.checkNode=function(a,b,c,g){var f=this.setting.data.key.checked;if(a.chkDisabled!==!0&&(b!==!0&&b!==!1&&(b=!a[f]),g=!!g,(a[f]!==b||c)&&!(g&&k.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)==!1)&&k.uCanDo(this.setting)&&this.setting.check.enable&&a.nocheck!==!0))a[f]=b,b=n(a,j.id.CHECK,this.setting),(c||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,a),e.setChkClass(this.setting,b,a),e.repairParentChkClassWithSelf(this.setting,a),g&&this.setting.treeObj.trigger(j.event.CHECK,[null,this.setting.treeId,a]);};a.checkAllNodes=function(a){e.repairAllChk(this.setting,!!a);};a.getCheckedNodes=function(a){var b=this.setting.data.key.children;return g.getTreeCheckedNodes(this.setting,g.getRoot(this.setting)[b],a!==!1);};a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return g.getTreeChangeCheckedNodes(this.setting,g.getRoot(this.setting)[a]);};a.setChkDisabled=function(a,b,c,g){b=!!b;c=!!c;e.repairSonChkDisabled(this.setting,a,b,!!g);e.repairParentChkDisabled(this.setting,a.getParentNode(),b,c);};var b=a.updateNode;a.updateNode=function(c,g){b&&b.apply(a,arguments);if(c&&this.setting.check.enable&&n(c,this.setting).get(0)&&k.uCanDo(this.setting)){var i=n(c,j.id.CHECK,this.setting);(g==!0||this.setting.check.chkStyle===j.radio.STYLE)&&e.checkNodeRelation(this.setting,c);e.setChkClass(this.setting,i,c);e.repairParentChkClassWithSelf(this.setting,c);}};});var s=e.createNodes;e.createNodes=function(c,a,b,d,g){s&&s.apply(e,arguments);b&&e.repairParentChkClassWithSelf(c,d);};var t=e.removeNode;e.removeNode=function(c,a){var b=a.getParentNode();t&&t.apply(e,arguments);a&&b&&(e.repairChkClass(c,b),e.repairParentChkClass(c,b));};var u=e.appendNodes;e.appendNodes=function(c,a,b,d,h,i,j){var f="";u&&(f=u.apply(e,arguments));d&&g.makeChkFlag(c,d);return f;};})(jQuery);(function(i){i.extend(!0,i.fn.zTree._z,{view:{clearOldFirstNode:function clearOldFirstNode(c,a){for(var b=a.getNextNode();b;){if(b.isFirstNode){b.isFirstNode=!1;d.setNodeLineIcos(c,b);break;}if(b.isLastNode)break;b=b.getNextNode();}},clearOldLastNode:function clearOldLastNode(c,a,b){for(a=a.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1;b&&d.setNodeLineIcos(c,a);break;}if(a.isFirstNode)break;a=a.getPreNode();}},makeDOMNodeMainBefore:function makeDOMNodeMainBefore(c,a,b){c.push("<li ",b.isHidden?"style='display:none;' ":"","id='",b.tId,"' class='",l.className.LEVEL,b.level,"' tabindex='0' hidefocus='true' treenode>");},showNode:function showNode(c,a){a.isHidden=!1;f.initShowForExCheck(c,a);j(a,c).show();},showNodes:function showNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if(!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.showNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForShow(c,a),d.setLastNodeForShow(c,a);}}},hideNode:function hideNode(c,a){a.isHidden=!0;a.isFirstNode=!1;a.isLastNode=!1;f.initHideForExCheck(c,a);d.cancelPreSelectedNode(c,a);j(a,c).hide();},hideNodes:function hideNodes(c,a,b){if(a&&a.length!=0){var e={},g,k;for(g=0,k=a.length;g<k;g++){var h=a[g];if((h.isFirstNode||h.isLastNode)&&!e[h.parentTId]){var i=h.getParentNode();e[h.parentTId]=i===null?f.getRoot(c):h.getParentNode();}d.hideNode(c,h,b);}for(var j in e){a=e[j][c.data.key.children],d.setFirstNodeForHide(c,a),d.setLastNodeForHide(c,a);}}},setFirstNode:function setFirstNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][0].isFirstNode=!0:e>0&&d.setFirstNodeForHide(c,a[b]);},setLastNode:function setLastNode(c,a){var b=c.data.key.children,e=a[b].length;e>0&&!a[b][0].isHidden?a[b][e-1].isLastNode=!0:e>0&&d.setLastNodeForHide(c,a[b]);},setFirstNodeForHide:function setFirstNodeForHide(c,a){var b,e,g;for(e=0,g=a.length;e<g;e++){b=a[e];if(b.isFirstNode)break;if(!b.isHidden&&!b.isFirstNode){b.isFirstNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setFirstNodeForShow:function setFirstNodeForShow(c,a){var b,e,g,f,h;for(e=0,g=a.length;e<g;e++){if(b=a[e],!f&&!b.isHidden&&b.isFirstNode){f=b;break;}else if(!f&&!b.isHidden&&!b.isFirstNode)b.isFirstNode=!0,f=b,d.setNodeLineIcos(c,b);else if(f&&b.isFirstNode){b.isFirstNode=!1;h=b;d.setNodeLineIcos(c,b);break;}}return{"new":f,old:h};},setLastNodeForHide:function setLastNodeForHide(c,a){var b,e;for(e=a.length-1;e>=0;e--){b=a[e];if(b.isLastNode)break;if(!b.isHidden&&!b.isLastNode){b.isLastNode=!0;d.setNodeLineIcos(c,b);break;}else b=null;}return b;},setLastNodeForShow:function setLastNodeForShow(c,a){var b,e,g,f;for(e=a.length-1;e>=0;e--){if(b=a[e],!g&&!b.isHidden&&b.isLastNode){g=b;break;}else if(!g&&!b.isHidden&&!b.isLastNode)b.isLastNode=!0,g=b,d.setNodeLineIcos(c,b);else if(g&&b.isLastNode){b.isLastNode=!1;f=b;d.setNodeLineIcos(c,b);break;}}return{"new":g,old:f};}},data:{initHideForExCheck:function initHideForExCheck(c,a){if(a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck=="undefined")a._nocheck=!!a.nocheck,a.nocheck=!0;a.check_Child_State=-1;d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}},initShowForExCheck:function initShowForExCheck(c,a){if(!a.isHidden&&c.check&&c.check.enable){if(typeof a._nocheck!="undefined")a.nocheck=a._nocheck,delete a._nocheck;if(d.setChkClass){var b=j(a,l.id.CHECK,c);d.setChkClass(c,b,a);}d.repairParentChkClassWithSelf&&d.repairParentChkClassWithSelf(c,a);}}}});var i=i.fn.zTree,m=i._z.tools,l=i.consts,d=i._z.view,f=i._z.data,j=m.$;f.addInitNode(function(c,a,b){if(typeof b.isHidden=="string")b.isHidden=m.eqs(b.isHidden,"true");b.isHidden=!!b.isHidden;f.initHideForExCheck(c,b);});f.addBeforeA(function(){});f.addZTreeTools(function(c,a){a.showNodes=function(a,b){d.showNodes(c,a,b);};a.showNode=function(a,b){a&&d.showNodes(c,[a],b);};a.hideNodes=function(a,b){d.hideNodes(c,a,b);};a.hideNode=function(a,b){a&&d.hideNodes(c,[a],b);};var b=a.checkNode;if(b)a.checkNode=function(c,d,f,h){(!c||!c.isHidden)&&b.apply(a,arguments);};});var n=f.initNode;f.initNode=function(c,a,b,e,g,i,h){var j=(e?e:f.getRoot(c))[c.data.key.children];f.tmpHideFirstNode=d.setFirstNodeForHide(c,j);f.tmpHideLastNode=d.setLastNodeForHide(c,j);h&&(d.setNodeLineIcos(c,f.tmpHideFirstNode),d.setNodeLineIcos(c,f.tmpHideLastNode));g=f.tmpHideFirstNode===b;i=f.tmpHideLastNode===b;n&&n.apply(f,arguments);h&&i&&d.clearOldLastNode(c,b,h);};var o=f.makeChkFlag;if(o)f.makeChkFlag=function(c,a){(!a||!a.isHidden)&&o.apply(f,arguments);};var p=f.getTreeCheckedNodes;if(p)f.getTreeCheckedNodes=function(c,a,b,e){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return p.apply(f,arguments);};var q=f.getTreeChangeCheckedNodes;if(q)f.getTreeChangeCheckedNodes=function(c,a,b){if(a&&a.length>0){var d=a[0].getParentNode();if(d&&d.isHidden)return[];}return q.apply(f,arguments);};var r=d.expandCollapseSonNode;if(r)d.expandCollapseSonNode=function(c,a,b,e,f){(!a||!a.isHidden)&&r.apply(d,arguments);};var s=d.setSonNodeCheckBox;if(s)d.setSonNodeCheckBox=function(c,a,b,e){(!a||!a.isHidden)&&s.apply(d,arguments);};var t=d.repairParentChkClassWithSelf;if(t)d.repairParentChkClassWithSelf=function(c,a){(!a||!a.isHidden)&&t.apply(d,arguments);};})(jQuery);(function(v){var I={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},x={onHoverOverNode:function onHoverOverNode(b,a){var c=m.getSetting(b.data.treeId),d=m.getRoot(c);if(d.curHoverNode!=a)x.onHoverOutNode(b);d.curHoverNode=a;f.addHoverDom(c,a);},onHoverOutNode:function onHoverOutNode(b){var b=m.getSetting(b.data.treeId),a=m.getRoot(b);if(a.curHoverNode&&!m.isSelectedNode(b,a.curHoverNode))f.removeTreeDom(b,a.curHoverNode),a.curHoverNode=null;},onMousedownNode:function onMousedownNode(b,a){function c(b){if(B.dragFlag==0&&Math.abs(N-b.clientX)<e.edit.drag.minMoveSize&&Math.abs(O-b.clientY)<e.edit.drag.minMoveSize)return!0;var a,c,n,k,i;i=e.data.key.children;M.css("cursor","pointer");if(B.dragFlag==0){if(g.apply(e.callback.beforeDrag,[e.treeId,l],!0)==!1)return r(b),!0;for(a=0,c=l.length;a<c;a++){if(a==0)B.dragNodeShowBefore=[];n=l[a];n.isParent&&n.open?(f.expandCollapseNode(e,n,!n.open),B.dragNodeShowBefore[n.tId]=!0):B.dragNodeShowBefore[n.tId]=!1;}B.dragFlag=1;t.showHoverDom=!1;g.showIfameMask(e,!0);n=!0;k=-1;if(l.length>1){var j=l[0].parentTId?l[0].getParentNode()[i]:m.getNodes(e);i=[];for(a=0,c=j.length;a<c;a++){if(B.dragNodeShowBefore[j[a].tId]!==void 0&&(n&&k>-1&&k+1!==a&&(n=!1),i.push(j[a]),k=a),l.length===i.length){l=i;break;}}}n&&(H=l[0].getPreNode(),R=l[l.length-1].getNextNode());D=o("<ul class='zTreeDragUL'></ul>",e);for(a=0,c=l.length;a<c;a++){n=l[a],n.editNameFlag=!1,f.selectNode(e,n,a>0),f.removeTreeDom(e,n),a>e.edit.drag.maxShowNodeNum-1||(k=o("<li id='"+n.tId+"_tmp'></li>",e),k.append(o(n,d.id.A,e).clone()),k.css("padding","0"),k.children("#"+n.tId+d.id.A).removeClass(d.node.CURSELECTED),D.append(k),a==e.edit.drag.maxShowNodeNum-1&&(k=o("<li id='"+n.tId+"_moretmp'><a>  ...  </a></li>",e),D.append(k)));}D.attr("id",l[0].tId+d.id.UL+"_tmp");D.addClass(e.treeObj.attr("class"));D.appendTo(M);A=o("<span class='tmpzTreeMove_arrow'></span>",e);A.attr("id","zTreeMove_arrow_tmp");A.appendTo(M);e.treeObj.trigger(d.event.DRAG,[b,e.treeId,l]);}if(B.dragFlag==1){s&&A.attr("id")==b.target.id&&u&&b.clientX+F.scrollLeft()+2>v("#"+u+d.id.A,s).offset().left?(n=v("#"+u+d.id.A,s),b.target=n.length>0?n.get(0):b.target):s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));u=s=null;J=!1;h=e;n=m.getSettings();for(var y in n){if(n[y].treeId&&n[y].edit.enable&&n[y].treeId!=e.treeId&&(b.target.id==n[y].treeId||v(b.target).parents("#"+n[y].treeId).length>0))J=!0,h=n[y];}y=F.scrollTop();k=F.scrollLeft();i=h.treeObj.offset();a=h.treeObj.get(0).scrollHeight;n=h.treeObj.get(0).scrollWidth;c=b.clientY+y-i.top;var p=h.treeObj.height()+i.top-b.clientY-y,q=b.clientX+k-i.left,x=h.treeObj.width()+i.left-b.clientX-k;i=c<e.edit.drag.borderMax&&c>e.edit.drag.borderMin;var j=p<e.edit.drag.borderMax&&p>e.edit.drag.borderMin,K=q<e.edit.drag.borderMax&&q>e.edit.drag.borderMin,G=x<e.edit.drag.borderMax&&x>e.edit.drag.borderMin,p=c>e.edit.drag.borderMin&&p>e.edit.drag.borderMin&&q>e.edit.drag.borderMin&&x>e.edit.drag.borderMin,q=i&&h.treeObj.scrollTop()<=0,x=j&&h.treeObj.scrollTop()+h.treeObj.height()+10>=a,P=K&&h.treeObj.scrollLeft()<=0,Q=G&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=n;if(b.target&&g.isChildOrSelf(b.target,h.treeId)){for(var E=b.target;E&&E.tagName&&!g.eqs(E.tagName,"li")&&E.id!=h.treeId;){E=E.parentNode;}var S=!0;for(a=0,c=l.length;a<c;a++){if(n=l[a],E.id===n.tId){S=!1;break;}else if(o(n,e).find("#"+E.id).length>0){S=!1;break;}}if(S&&b.target&&g.isChildOrSelf(b.target,E.id+d.id.A))s=v(E),u=E.id;}n=l[0];if(p&&g.isChildOrSelf(b.target,h.treeId)){if(!s&&(b.target.id==h.treeId||q||x||P||Q)&&(J||!J&&n.parentTId))s=h.treeObj;i?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):j&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10);K?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):G&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10);s&&s!=h.treeObj&&s.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+s.offset().left-h.treeObj.offset().left);}D.css({top:b.clientY+y+3+"px",left:b.clientX+k+3+"px"});i=a=0;if(s&&s.attr("id")!=h.treeId){var z=u==null?null:m.getNodeCache(h,u);c=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;a=!!(H&&u===H.tId);i=!!(R&&u===R.tId);k=n.parentTId&&n.parentTId==u;n=(c||!i)&&g.apply(h.edit.drag.prev,[h.treeId,l,z],!!h.edit.drag.prev);a=(c||!a)&&g.apply(h.edit.drag.next,[h.treeId,l,z],!!h.edit.drag.next);G=(c||!k)&&!(h.data.keep.leaf&&!z.isParent)&&g.apply(h.edit.drag.inner,[h.treeId,l,z],!!h.edit.drag.inner);if(!n&&!a&&!G){if(s=null,u="",w=d.move.TYPE_INNER,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;}else{c=v("#"+u+d.id.A,s);i=z.isLastNode?null:v("#"+z.getNextNode().tId+d.id.A,s.next());j=c.offset().top;k=c.offset().left;K=n?G?0.25:a?0.5:1:-1;G=a?G?0.75:n?0.5:0:-1;y=(b.clientY+y-j)/c.height();(K==1||y<=K&&y>=-0.2)&&n?(a=1-A.width(),i=j-A.height()/2,w=d.move.TYPE_PREV):(G==0||y>=G&&y<=1.2)&&a?(a=1-A.width(),i=i==null||z.isParent&&z.open?j+c.height()-A.height()/2:i.offset().top-A.height()/2,w=d.move.TYPE_NEXT):(a=5-A.width(),i=j,w=d.move.TYPE_INNER);A.css({display:"block",top:i+"px",left:k+a+"px"});c.addClass(d.node.TMPTARGET_NODE+"_"+w);if(T!=u||U!=w)L=new Date().getTime();if(z&&z.isParent&&w==d.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==z.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===z.tId&&(y=!1),y))window.zTreeMoveTimer=setTimeout(function(){w==d.move.TYPE_INNER&&z&&z.isParent&&!z.open&&new Date().getTime()-L>h.edit.drag.autoOpenTime&&g.apply(h.callback.beforeDragOpen,[h.treeId,z],!0)&&(f.switchNode(h,z),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(d.event.EXPAND,[h.treeId,z]));},h.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=z.tId;}}else if(w=d.move.TYPE_INNER,s&&g.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?s.addClass(d.node.TMPTARGET_TREE):s=null,A.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;T=u;U=w;e.treeObj.trigger(d.event.DRAGMOVE,[b,e.treeId,l]);}return!1;}function r(b){if(window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;U=T=null;F.unbind("mousemove",c);F.unbind("mouseup",r);F.unbind("selectstart",k);M.css("cursor","auto");s&&(s.removeClass(d.node.TMPTARGET_TREE),u&&v("#"+u+d.id.A,s).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+I.move.TYPE_INNER));g.showIfameMask(e,!1);t.showHoverDom=!0;if(B.dragFlag!=0){B.dragFlag=0;var a,i,j;for(a=0,i=l.length;a<i;a++){j=l[a],j.isParent&&B.dragNodeShowBefore[j.tId]&&!j.open&&(f.expandCollapseNode(e,j,!j.open),delete B.dragNodeShowBefore[j.tId]);}D&&D.remove();A&&A.remove();var p=(b.ctrlKey||b.metaKey)&&e.edit.drag.isMove&&e.edit.drag.isCopy||!e.edit.drag.isMove&&e.edit.drag.isCopy;!p&&s&&u&&l[0].parentTId&&u==l[0].parentTId&&w==d.move.TYPE_INNER&&(s=null);if(s){var q=u==null?null:m.getNodeCache(h,u);if(g.apply(e.callback.beforeDrop,[h.treeId,l,q,w,p],!0)==!1)f.selectNodes(x,l);else{var C=p?g.clone(l):l;a=function a(){if(J){if(!p)for(var a=0,c=l.length;a<c;a++){f.removeNode(e,l[a]);}w==d.move.TYPE_INNER?f.addNodes(h,q,-1,C):f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);}else if(p&&w==d.move.TYPE_INNER)f.addNodes(h,q,-1,C);else if(p)f.addNodes(h,q.getParentNode(),w==d.move.TYPE_PREV?q.getIndex():q.getIndex()+1,C);else if(w!=d.move.TYPE_NEXT)for(a=0,c=C.length;a<c;a++){f.moveNode(h,q,C[a],w,!1);}else for(a=-1,c=C.length-1;a<c;c--){f.moveNode(h,q,C[c],w,!1);}f.selectNodes(h,C);o(C[0],e).focus().blur();e.treeObj.trigger(d.event.DROP,[b,h.treeId,C,q,w,p]);};w==d.move.TYPE_INNER&&g.canAsync(h,q)?f.asyncNode(h,q,!1,a):a();}}else f.selectNodes(x,l),e.treeObj.trigger(d.event.DROP,[b,e.treeId,l,null,null,null]);}}function k(){return!1;}var i,j,e=m.getSetting(b.data.treeId),B=m.getRoot(e),t=m.getRoots();if(b.button==2||!e.edit.enable||!e.edit.drag.isCopy&&!e.edit.drag.isMove)return!0;var p=b.target,q=m.getRoot(e).curSelectedList,l=[];if(m.isSelectedNode(e,a))for(i=0,j=q.length;i<j;i++){if(q[i].editNameFlag&&g.eqs(p.tagName,"input")&&p.getAttribute("treeNode"+d.id.INPUT)!==null)return!0;l.push(q[i]);if(l[0].parentTId!==q[i].parentTId){l=[a];break;}}else l=[a];f.editNodeBlur=!0;f.cancelCurEditNode(e);var F=v(e.treeObj.get(0).ownerDocument),M=v(e.treeObj.get(0).ownerDocument.body),D,A,s,J=!1,h=e,x=e,H,R,T=null,U=null,u=null,w=d.move.TYPE_INNER,N=b.clientX,O=b.clientY,L=new Date().getTime();g.uCanDo(e)&&F.bind("mousemove",c);F.bind("mouseup",r);F.bind("selectstart",k);b.preventDefault&&b.preventDefault();return!0;}};v.extend(!0,v.fn.zTree.consts,I);v.extend(!0,v.fn.zTree._z,{tools:{getAbs:function getAbs(b){b=b.getBoundingClientRect();return[b.left+(document.body.scrollLeft+document.documentElement.scrollLeft),b.top+(document.body.scrollTop+document.documentElement.scrollTop)];},inputFocus:function inputFocus(b){b.get(0)&&(b.focus(),g.setCursorPosition(b.get(0),b.val().length));},inputSelect:function inputSelect(b){b.get(0)&&(b.focus(),b.select());},setCursorPosition:function setCursorPosition(b,a){if(b.setSelectionRange)b.focus(),b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0);c.moveEnd("character",a);c.moveStart("character",a);c.select();}},showIfameMask:function showIfameMask(b,a){for(var c=m.getRoot(b);c.dragMaskList.length>0;){c.dragMaskList[0].remove(),c.dragMaskList.shift();}if(a)for(var d=o("iframe",b),f=0,i=d.length;f<i;f++){var j=d.get(f),e=g.getAbs(j),j=o("<div id='zTreeMask_"+f+"' class='zTreeMask' style='top:"+e[1]+"px; left:"+e[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>",b);j.appendTo(o("body",b));c.dragMaskList.push(j);}}},view:{addEditBtn:function addEditBtn(b,a){if(!(a.editNameFlag||o(a,d.id.EDIT,b).length>0)&&g.apply(b.edit.showRenameBtn,[b.treeId,a],b.edit.showRenameBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" edit' id='"+a.tId+d.id.EDIT+"' title='"+g.apply(b.edit.renameTitle,[b.treeId,a],b.edit.renameTitle)+"' treeNode"+d.id.EDIT+" style='display:none;'></span>";c.append(r);o(a,d.id.EDIT,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeEditName,[b.treeId,a],!0)==!1)return!1;f.editNode(b,a);return!1;}).show();}},addRemoveBtn:function addRemoveBtn(b,a){if(!(a.editNameFlag||o(a,d.id.REMOVE,b).length>0)&&g.apply(b.edit.showRemoveBtn,[b.treeId,a],b.edit.showRemoveBtn)){var c=o(a,d.id.A,b),r="<span class='"+d.className.BUTTON+" remove' id='"+a.tId+d.id.REMOVE+"' title='"+g.apply(b.edit.removeTitle,[b.treeId,a],b.edit.removeTitle)+"' treeNode"+d.id.REMOVE+" style='display:none;'></span>";c.append(r);o(a,d.id.REMOVE,b).bind("click",function(){if(!g.uCanDo(b)||g.apply(b.callback.beforeRemove,[b.treeId,a],!0)==!1)return!1;f.removeNode(b,a);b.treeObj.trigger(d.event.REMOVE,[b.treeId,a]);return!1;}).bind("mousedown",function(){return!0;}).show();}},addHoverDom:function addHoverDom(b,a){if(m.getRoots().showHoverDom)a.isHover=!0,b.edit.enable&&(f.addEditBtn(b,a),f.addRemoveBtn(b,a)),g.apply(b.view.addHoverDom,[b.treeId,a]);},cancelCurEditNode:function cancelCurEditNode(b,a,c){var r=m.getRoot(b),k=b.data.key.name,i=r.curEditNode;if(i){var j=r.curEditInput,a=a?a:c?i[k]:j.val();if(g.apply(b.callback.beforeRename,[b.treeId,i,a,c],!0)===!1)return!1;i[k]=a;o(i,d.id.A,b).removeClass(d.node.CURSELECTED_EDIT);j.unbind();f.setNodeName(b,i);i.editNameFlag=!1;r.curEditNode=null;r.curEditInput=null;f.selectNode(b,i,!1);b.treeObj.trigger(d.event.RENAME,[b.treeId,i,c]);}return r.noSelection=!0;},editNode:function editNode(b,a){var c=m.getRoot(b);f.editNodeBlur=!1;if(m.isSelectedNode(b,a)&&c.curEditNode==a&&a.editNameFlag)setTimeout(function(){g.inputFocus(c.curEditInput);},0);else{var r=b.data.key.name;a.editNameFlag=!0;f.removeTreeDom(b,a);f.cancelCurEditNode(b);f.selectNode(b,a,!1);o(a,d.id.SPAN,b).html("<input type=text class='rename' id='"+a.tId+d.id.INPUT+"' treeNode"+d.id.INPUT+" >");var k=o(a,d.id.INPUT,b);k.attr("value",a[r]);b.edit.editNameSelectAll?g.inputSelect(k):g.inputFocus(k);k.bind("blur",function(){f.editNodeBlur||f.cancelCurEditNode(b);}).bind("keydown",function(a){a.keyCode=="13"?(f.editNodeBlur=!0,f.cancelCurEditNode(b)):a.keyCode=="27"&&f.cancelCurEditNode(b,null,!0);}).bind("click",function(){return!1;}).bind("dblclick",function(){return!1;});o(a,d.id.A,b).addClass(d.node.CURSELECTED_EDIT);c.curEditInput=k;c.noSelection=!1;c.curEditNode=a;}},moveNode:function moveNode(b,a,c,r,k,i){var j=m.getRoot(b),e=b.data.key.children;if(a!=c&&(!b.data.keep.leaf||!a||a.isParent||r!=d.move.TYPE_INNER)){var g=c.parentTId?c.getParentNode():j,t=a===null||a==j;t&&a===null&&(a=j);if(t)r=d.move.TYPE_INNER;j=a.parentTId?a.getParentNode():j;if(r!=d.move.TYPE_PREV&&r!=d.move.TYPE_NEXT)r=d.move.TYPE_INNER;if(r==d.move.TYPE_INNER)if(t)c.parentTId=null;else{if(!a.isParent)a.isParent=!0,a.open=!!a.open,f.setNodeLineIcos(b,a);c.parentTId=a.tId;}var p;t?p=t=b.treeObj:(!i&&r==d.move.TYPE_INNER?f.expandCollapseNode(b,a,!0,!1):i||f.expandCollapseNode(b,a.getParentNode(),!0,!1),t=o(a,b),p=o(a,d.id.UL,b),t.get(0)&&!p.get(0)&&(p=[],f.makeUlHtml(b,a,p,""),t.append(p.join(""))),p=o(a,d.id.UL,b));var q=o(c,b);q.get(0)?t.get(0)||q.remove():q=f.appendNodes(b,c.level,[c],null,-1,!1,!0).join("");p.get(0)&&r==d.move.TYPE_INNER?p.append(q):t.get(0)&&r==d.move.TYPE_PREV?t.before(q):t.get(0)&&r==d.move.TYPE_NEXT&&t.after(q);var l=-1,v=0,x=null,t=null,D=c.level;if(c.isFirstNode){if(l=0,g[e].length>1)x=g[e][1],x.isFirstNode=!0;}else if(c.isLastNode)l=g[e].length-1,x=g[e][l-1],x.isLastNode=!0;else for(p=0,q=g[e].length;p<q;p++){if(g[e][p].tId==c.tId){l=p;break;}}l>=0&&g[e].splice(l,1);if(r!=d.move.TYPE_INNER)for(p=0,q=j[e].length;p<q;p++){j[e][p].tId==a.tId&&(v=p);}if(r==d.move.TYPE_INNER){a[e]||(a[e]=[]);if(a[e].length>0)t=a[e][a[e].length-1],t.isLastNode=!1;a[e].splice(a[e].length,0,c);c.isLastNode=!0;c.isFirstNode=a[e].length==1;}else a.isFirstNode&&r==d.move.TYPE_PREV?(j[e].splice(v,0,c),t=a,t.isFirstNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!0,c.isLastNode=!1):a.isLastNode&&r==d.move.TYPE_NEXT?(j[e].splice(v+1,0,c),t=a,t.isLastNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(r==d.move.TYPE_PREV?j[e].splice(v,0,c):j[e].splice(v+1,0,c),c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!1);m.fixPIdKeyValue(b,c);m.setSonNodeLevel(b,c.getParentNode(),c);f.setNodeLineIcos(b,c);f.repairNodeLevelClass(b,c,D);!b.data.keep.parent&&g[e].length<1?(g.isParent=!1,g.open=!1,a=o(g,d.id.UL,b),r=o(g,d.id.SWITCH,b),e=o(g,d.id.ICON,b),f.replaceSwitchClass(g,r,d.folder.DOCU),f.replaceIcoClass(g,e,d.folder.DOCU),a.css("display","none")):x&&f.setNodeLineIcos(b,x);t&&f.setNodeLineIcos(b,t);b.check&&b.check.enable&&f.repairChkClass&&(f.repairChkClass(b,g),f.repairParentChkClassWithSelf(b,g),g!=c.parent&&f.repairParentChkClassWithSelf(b,c));i||f.expandCollapseParentNode(b,c.getParentNode(),!0,k);}},removeEditBtn:function removeEditBtn(b,a){o(a,d.id.EDIT,b).unbind().remove();},removeRemoveBtn:function removeRemoveBtn(b,a){o(a,d.id.REMOVE,b).unbind().remove();},removeTreeDom:function removeTreeDom(b,a){a.isHover=!1;f.removeEditBtn(b,a);f.removeRemoveBtn(b,a);g.apply(b.view.removeHoverDom,[b.treeId,a]);},repairNodeLevelClass:function repairNodeLevelClass(b,a,c){if(c!==a.level){var f=o(a,b),g=o(a,d.id.A,b),b=o(a,d.id.UL,b),c=d.className.LEVEL+c,a=d.className.LEVEL+a.level;f.removeClass(c);f.addClass(a);g.removeClass(c);g.addClass(a);b.removeClass(c);b.addClass(a);}},selectNodes:function selectNodes(b,a){for(var c=0,d=a.length;c<d;c++){f.selectNode(b,a[c],c>0);}}},event:{},data:{setSonNodeLevel:function setSonNodeLevel(b,a,c){if(c){var d=b.data.key.children;c.level=a?a.level+1:0;if(c[d])for(var a=0,f=c[d].length;a<f;a++){c[d][a]&&m.setSonNodeLevel(b,c,c[d][a]);}}}}});var H=v.fn.zTree,g=H._z.tools,d=H.consts,f=H._z.view,m=H._z.data,o=g.$;m.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});m.addInitBind(function(b){var a=b.treeObj,c=d.event;a.bind(c.RENAME,function(a,c,d,f){g.apply(b.callback.onRename,[a,c,d,f]);});a.bind(c.DRAG,function(a,c,d,f){g.apply(b.callback.onDrag,[c,d,f]);});a.bind(c.DRAGMOVE,function(a,c,d,f){g.apply(b.callback.onDragMove,[c,d,f]);});a.bind(c.DROP,function(a,c,d,f,e,m,o){g.apply(b.callback.onDrop,[c,d,f,e,m,o]);});});m.addInitUnBind(function(b){var b=b.treeObj,a=d.event;b.unbind(a.RENAME);b.unbind(a.DRAG);b.unbind(a.DRAGMOVE);b.unbind(a.DROP);});m.addInitCache(function(){});m.addInitNode(function(b,a,c){if(c)c.isHover=!1,c.editNameFlag=!1;});m.addInitProxy(function(b){var a=b.target,c=m.getSetting(b.data.treeId),f=b.relatedTarget,k="",i=null,j="",e=null,o=null;if(g.eqs(b.type,"mouseover")){if(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}]))k=g.getNodeMainDom(o).id,j="hoverOverNode";}else if(g.eqs(b.type,"mouseout"))o=g.getMDom(c,f,[{tagName:"a",attrName:"treeNode"+d.id.A}]),o||(k="remove",j="hoverOutNode");else if(g.eqs(b.type,"mousedown")&&(o=g.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+d.id.A}])))k=g.getNodeMainDom(o).id,j="mousedownNode";if(k.length>0)switch(i=m.getNodeCache(c,k),j){case"mousedownNode":e=x.onMousedownNode;break;case"hoverOverNode":e=x.onHoverOverNode;break;case"hoverOutNode":e=x.onHoverOutNode;}return{stop:!1,node:i,nodeEventType:j,nodeEventCallback:e,treeEventType:"",treeEventCallback:null};});m.addInitRoot(function(b){var b=m.getRoot(b),a=m.getRoots();b.curEditNode=null;b.curEditInput=null;b.curHoverNode=null;b.dragFlag=0;b.dragNodeShowBefore=[];b.dragMaskList=[];a.showHoverDom=!0;});m.addZTreeTools(function(b,a){a.cancelEditName=function(a){m.getRoot(this.setting).curEditNode&&f.cancelCurEditNode(this.setting,a?a:null,!0);};a.copyNode=function(a,b,k,i){if(!b)return null;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;var j=this,e=g.clone(b);if(!a)a=null,k=d.move.TYPE_INNER;k==d.move.TYPE_INNER?(b=function b(){f.addNodes(j.setting,a,-1,[e],i);},g.canAsync(this.setting,a)?f.asyncNode(this.setting,a,i,b):b()):(f.addNodes(this.setting,a.parentNode,-1,[e],i),f.moveNode(this.setting,a,e,k,!1,i));return e;};a.editName=function(a){a&&a.tId&&a===m.getNodeCache(this.setting,a.tId)&&(a.parentTId&&f.expandCollapseParentNode(this.setting,a.getParentNode(),!0),f.editNode(this.setting,a));};a.moveNode=function(a,b,k,i){function j(){f.moveNode(e.setting,a,b,k,!1,i);}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&k===d.move.TYPE_INNER)return null;else if(a&&(b.parentTId==a.tId&&k==d.move.TYPE_INNER||o(b,this.setting).find("#"+a.tId).length>0))return null;else a||(a=null);var e=this;g.canAsync(this.setting,a)&&k===d.move.TYPE_INNER?f.asyncNode(this.setting,a,i,j):j();return b;};a.setEditable=function(a){this.setting.edit.enable=a;return this.refresh();};});var N=f.cancelPreSelectedNode;f.cancelPreSelectedNode=function(b,a){for(var c=m.getRoot(b).curSelectedList,d=0,g=c.length;d<g;d++){if(!a||a===c[d])if(f.removeTreeDom(b,c[d]),a)break;}N&&N.apply(f,arguments);};var O=f.createNodes;f.createNodes=function(b,a,c,d,g){O&&O.apply(f,arguments);c&&f.repairParentChkClassWithSelf&&f.repairParentChkClassWithSelf(b,d);};var V=f.makeNodeUrl;f.makeNodeUrl=function(b,a){return b.edit.enable?null:V.apply(f,arguments);};var L=f.removeNode;f.removeNode=function(b,a){var c=m.getRoot(b);if(c.curEditNode===a)c.curEditNode=null;L&&L.apply(f,arguments);};var P=f.selectNode;f.selectNode=function(b,a,c){var d=m.getRoot(b);if(m.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag)return!1;P&&P.apply(f,arguments);f.addHoverDom(b,a);return!0;};var Q=g.uCanDo;g.uCanDo=function(b,a){var c=m.getRoot(b);if(a&&(g.eqs(a.type,"mouseover")||g.eqs(a.type,"mouseout")||g.eqs(a.type,"mousedown")||g.eqs(a.type,"mouseup")))return!0;if(c.curEditNode)f.editNodeBlur=!1,c.curEditInput.focus();return!c.curEditNode&&(Q?Q.apply(f,arguments):!0);};})(jQuery);var theme={};theme.Dark={backgroundColor:'transport',color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500'],title:{textStyle:{fontWeight:'normal',color:'#fff'}},legend:{textStyle:{color:'#999999'},top:30},visualMap:{itemWidth:15,color:['#FFF808','#21BCF9'],textStyle:{color:'#ccc'}},toolbox:{showTitle:false},tooltip:{trigger:'axis',backgroundColor:'rgba(250,250,250,0.9)',axisPointer:{type:'line',lineStyle:{color:'#aaa'},crossStyle:{color:'#aaa'},shadowStyle:{color:'rgba(200,200,200,0.2)'}},textStyle:{color:'#333'},extraCssText:'text-align: left;'},dataZoom:{dataBackgroundColor:'#555',fillerColor:'rgba(200,200,200,0.2)',handleColor:'#eee'},grid:{borderWidth:0,left:80,bottom:40,right:80,top:80},valueAxis:{axisLine:{show:false},axisTick:{show:false},axisLabel:{textStyle:{color:'#a2adbc'},margin:10},splitLine:{lineStyle:{color:['#4e5d77'],type:"solid",opacity:'0.6'}},nameTextStyle:{color:'#999999'}},categoryAxis:{axisLine:{lineStyle:{color:'#4e5d77'}},axisTick:{show:false},axisLabel:{textStyle:{color:'#a2adbc'},margin:10},splitLine:{show:false},nameTextStyle:{color:'#999999'}},textStyle:{fontFamily:'Microsoft YaHei, Arial, Verdana, sans-serif'},polar:{name:{textStyle:{color:'#ccc'}},axisLine:{lineStyle:{color:'#ddd'}},splitArea:{show:true,areaStyle:{color:['rgba(250,250,250,0.2)','rgba(200,200,200,0.2)']}},splitLine:{lineStyle:{color:'#ddd'}}},timeline:{label:{textStyle:{color:'#ccc'}},lineStyle:{color:'#aaa'},controlStyle:{normal:{color:'#fff'},emphasis:{color:'#FE8463'}},symbolSize:3},line:{smooth:true},pie:{type:'pie',radius:['50%','70%'],labelLine:{normal:{show:true,lineStyle:{width:[2]}}},hoverAnimation:false},gauge:{center:['50%','70%'],itemStyle:{normal:{color:['#d7603f']}},detail:{offsetCenter:['0','20%'],textStyle:{color:'#ccc'}},radius:'105%',data:[{value:50,name:''}],startAngle:180,endAngle:0,axisLine:{show:true,lineStyle:{color:[[0.25,'#04A0D6'],[0.5,'#689C0F'],[0.75,'#FEC500'],[1,'#109d83']],width:5}},axisTick:{length:35,lineStyle:{color:'auto',width:3}},axisLabel:{textStyle:{color:'#a2adbc'}},splitLine:{length:45,lineStyle:{width:4,color:'auto'}}}};var Internationalization=function(){function Internationalization(lang,resource){this.type=lang||localStorage["language"];this.resource=resource||{};}
Internationalization.prototype={getResource:function getResource(){return this.resource;},fillPage:function fillPage(){this.fill2($('[i18n]'));},fillArea:function fillArea(element){this.fill2(element.find('[i18n]'));try{Permission.check(element);}catch(e){console.log('check permission failed:'+e);}},fillAreaAttribute:function fillAreaAttribute(element,attributeName){this.fill(element.find('[i18n]['+attributeName+']'),attributeName);},fill:function fill(arrElement,attributeName){for(var i=0,arrPath,text,len=arrElement.length;i<len;i++){arrPath=arrElement[i].attributes["i18n"].value.split('.');text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
if(!attributeName){arrElement[i].innerHTML=text;}else{arrElement[i].setAttribute(attributeName,text);}}},getI18nValue:function getI18nValue(i18nKey){if(!i18nKey){return'';}
var arrPath=i18nKey.split('.');var text=this.resource;for(var j=0;j<arrPath.length;j++){text=text&&text[arrPath[j]];}
return text;},fill2:function fill2(arrElement){for(var i=0,len=arrElement.length;i<len;i++){var i18nValue=arrElement[i].attributes["i18n"];var items=i18nValue.value.split(';'),item,attrMap;for(var j=0;j<items.length;j++){item=items[j];if(!item){continue;}
if(item.indexOf('=')===-1){i18nValue=this.getI18nValue(item);arrElement[i].innerHTML=i18nValue;}else{attrMap=item.split('=');if(!attrMap[0]){continue;}
arrElement[i].setAttribute(attrMap[0],this.getI18nValue(attrMap[1]));}}}},findContent:function findContent(strPath){var arrPath=strPath.split('.');var text=this.resource;for(var i=0,len=arrPath.length;i<len;i++){text=text&&text[arrPath[i]];}
return text;}};return Internationalization;}();function InitI18nResource(strLanguage,isForce,filePath){if(!strLanguage){strLanguage=localStorage["isUserSelectedLanguage"]||navigator.language.split('-')[0];}
if(isForce){localStorage["isUserSelectedLanguage"]=strLanguage;}else if(localStorage["isUserSelectedLanguage"]){strLanguage=localStorage["isUserSelectedLanguage"];}
filePath=filePath||'/static/views/js/i18n/';return $.ajax({async:false,url:filePath+strLanguage+".js",dataType:"script"}).then(function(){localStorage["language"]=strLanguage;return i18n_resource;},function(){return $.ajax({async:false,url:filePath+"en.js",dataType:'script'}).then(function(){localStorage["language"]="en";return i18n_resource;},function(){console.warn('i18n files loading failed!');return{};});});}
var FactoryIoC=function(){function FactoryIoC(strType){this.listClass=[];this.init(strType);};FactoryIoC.prototype={init:function init(strType){switch(strType){case'compatibleFrame':this.initCompatibleFrameModule();break;case'report':this.initReportModule();break;default:break;}},add:function add(entityClass){this.listClass.push(entityClass);},getModel:function getModel(strModelName){for(var i=0,len=this.listClass.length;i<len;i++){if(strModelName.toLowerCase()==this.listClass[i].prototype.optionTemplate.type.toLowerCase()){return this.listClass[i];}}
return null;},getList:function getList(){return this.listClass;},initCompatibleFrameModule:function initCompatibleFrameModule(){this.add(ModalNone);this.add(ModalHistoryChart);this.add(ModalHistoryChartNormal);this.add(ModalHistoryChartEnergyConsume);this.add(ModalHistoryChartYearOnYearLine);this.add(ModalHistoryChartYearOnYearBar);this.add(ModalChart);this.add(ModalRealtimePieEnegBrkd);this.add(ModalRealtimeLineOutdoor);this.add(ModalRealtimeBarSub);this.add(ModalRealtimeGauge);this.add(ModalRealtimeBarEnegBrkd);this.add(ModalMultiple);this.add(ModalPredictPointLine);this.add(ModalMix);this.add(ModalHtml);this.add(ModalInteract);this.add(ModalDiagnosisPanelHtml);},initReportModule:function initReportModule(){var ns=namespace('factory.report.components');this.add(ns.Summary);this.add(ns.ChapterContainer);this.add(ns.Text);this.add(ns.Html);this.add(ns.Chart);this.add(ns.Block);this.add(ns.Table);}};return FactoryIoC;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var beop=beop||{};beop.constant={project_img_path:'/static/images/project_img/',project_default_img:'default.jpg',BEOP_IMG_HOST:'http://images.rnbtech.com.hk',OSS_PROJECT_IMG_PATH:'/custom/project_img/'};var ObjectId=function ObjectId(){var timestamp=new Date().valueOf();var userId=('000'+(window.AppConfig&&window.AppConfig.userId||'000')).slice(-3);var hex8=('00000000'+Math.floor(Math.random()*0xFFFFFFFF).toString(16)).slice(-8);return timestamp+userId+hex8;};(function(exports){exports.namespace=function(path){var obj=window;path=path.split('.');path.forEach(function(p,i){p=p.trim();if(i===0&&p==='window')return;obj=obj[p]=obj[p]||{};});return obj;};})(window);(function(exports){exports.Mixin=function(){var prototype={};var methods;for(var i=0,len=arguments.length;i<len;i++){methods=arguments[i];for(var m in methods){prototype[m]=methods[m];}}
return prototype;};})(window);(function(){var ENUM_LEVEL={LOG:1,INFO:2,DEBUG:3,WARN:4,ERROR:5,EXCEPTION:6};window.Log={level:ENUM_LEVEL.WARN,log:function log(){if(this.level>ENUM_LEVEL.LOG)return;Log._out('log',arguments);},info:function info(){if(this.level>ENUM_LEVEL.INFO)return;Log._out('info',arguments);},debug:function debug(){if(this.level>ENUM_LEVEL.DEBUG)return;Log._out('debug',arguments);},warn:function warn(){if(this.level>ENUM_LEVEL.WARN)return;Log._out('warn',arguments);},error:function error(){if(this.level>ENUM_LEVEL.ERROR)return;Log._out('error',arguments);},exception:function exception(message,_exception){if(this.level>ENUM_LEVEL.EXCEPTION)return;if(_exception){Log.error('Exception: ',message,_exception.stack||_exception);}else{Log.error('Exception: ',message);}},_out:function _out(type,args){console[type].apply(console,args);}};})();if(!Array.toMap){Array.toMap=function(arr,key){var map={};arr.forEach(function(row,i){map[row[key]]=row;});return map;};}
var FullScreenManager=function(){var manager=Object.create({init:function init(){var _this=this;$(document).off('webkitfullscreenchange');$(document).on('webkitfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('mozfullscreenchange');$(document).on('mozfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});$(document).off('msfullscreenchange');$(document).on('msfullscreenchange',function(){var isFullScreen=!!document.webkitFullscreenElement;if(isFullScreen){_this.onFullScreenEnter();}else{_this.onFullScreenOut();}});if(typeof onError==='function'){$(document).off('webkitfullscreenerror');$(document).on('webkitfullscreenerror',this.onFullScreenError);$(document).off('mozfullscreenerror');$(document).on('mozfullscreenerror',this.onFullScreenError);$(document).off('msfullscreenerror');$(document).on('msfullscreenerror',this.onFullScreenError);}},onFullScreenEnter:function onFullScreenEnter(){},onFullScreenOut:function onFullScreenOut(){},onFullScreenError:function onFullScreenError(){},toggle:function toggle(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen();}else if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen();}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen();}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}}else{if(document.exitFullscreen){document.exitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}}}});manager.init();return manager;}();function StringBuilder(){this.data=Array("");}
StringBuilder.prototype.append=function(){this.data.push(arguments[0]);return this;};StringBuilder.prototype.toString=function(){return this.data.join("");};StringBuilder.prototype.getLength=function(){return this.data.length;};if(!String.prototype.format){String.prototype.format=function(){if(arguments[0]===undefined){return'';}
if(arguments[0].constructor===Array){var args=arguments[0];}else{var args=arguments;}
return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};}
if(!String.prototype.formatEL){String.prototype.formatEL=function(o,defaultVal){var str=this.toString();if(!str||!o)return'';for(var p in o){if(o.hasOwnProperty(p)){str=str.replace(new RegExp('{'+p+'}','g'),o[p]);}}
if(typeof defaultVal!=='undefined'){str=str.replace(/{[^{}]*?}/g,defaultVal);}
return str;};}
String.prototype.toDate=function(){var str=this;if(str.indexOf('-')>-1)
str=str.replace('-','/').replace('-','/');return new Date(str);};if(!String.prototype.startsWith){String.prototype.startsWith=function(word){return new RegExp('^'+word).test(this);};}
Number.prototype.toDate=function(){return new Date(this);};function Alert(targetElement,type,msg){this.element=targetElement;this.str=new StringBuilder();this.str.append('<div style="display:none;" class="alert beop-alert alert-').append(type).append(' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>').append('<div class="alert-msg">'+msg+'</div>').append('</div>');this.$alert=$(this.str.toString());}
Alert.danger=function(targetElement,msg){return new Alert(targetElement,Alert.type.danger,msg);};Alert.warning=function(targetElement,msg){return new Alert(targetElement,Alert.type.warning,msg);};Alert.success=function(targetElement,msg){return new Alert(targetElement,Alert.type.success,msg);};Alert.info=function(targetElement,msg){return new Alert(targetElement,Alert.type.info,msg);};Alert.closeAll=function(){$('.beop-alert').remove();};Alert.type={danger:'danger',warning:'warning',success:'success',info:'info'};Alert.prototype.show=function(duration){Alert.closeAll();if(duration){var _this=this;setTimeout(function(){_this.close();},duration);}
$(this.element).append(this.$alert);this.$alert.slideDown(500);return this;};Alert.prototype.close=function(){var _this=this;this.$alert.slideUp(500,function(){_this.$alert.remove();_this=null;});};Alert.prototype.setMessage=function(msg){if(!msg){return false;}
this.$alert.find('.alert-msg').text(msg);};Alert.prototype.setStyle=function(style){if(style&&typeof style!=='string'){this.$alert.css(style);}
return this;};Alert.prototype.showAtTop=function(duration){this.setStyle({position:'absolute',top:0,left:0,right:0,margin:'auto',width:'30%',textAlign:'center',zIndex:10000});if(!duration){duration=2000;}
this.show(duration);};function showDialog(url){return WebAPI.get(url).done(function(resultHtml){$("#dialogContent").html(resultHtml);$('#dialogModal').modal({});});}
function clone(obj){if(obj==null||(typeof obj==='undefined'?'undefined':_typeof(obj))!='object')return obj;var temp=obj.constructor();for(var key in obj){if(obj.hasOwnProperty(key)){temp[key]=clone(obj[key]);}}
return temp;}
Date.prototype.format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};var week={"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}
if(/(E+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+week[this.getDay()+""]);}
for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));}}
return fmt;};Date.prototype.timeFormat=function(format,type,language,option){var date=this;if(format&&(typeof format=='string'||(typeof format==='undefined'?'undefined':_typeof(format))=='object')){if((typeof format==='undefined'?'undefined':_typeof(format))=='object'&&(!format.separators||!format.parts)){format='yyyy-mm-dd hh:ii:ss';}}else{format='yyyy-mm-dd hh:ii:ss';}
if(arguments.length>=2){var paramArr=function(arrayish){return[].slice.call(arrayish);}(arguments);paramArr.shift();type=language=option=null;paramArr.forEach(function(it,i){if(typeof it=='string'){language=it;}else if(typeof it=='number'){type=it;}else if((typeof it==='undefined'?'undefined':_typeof(it))=='object'){option=it;}});}
var isReturnNull=false;if(option){for(var k in option){if(k=='isReturnNull'){isReturnNull=option[k];}}}
if(date=='Invalid Date'){console.warn("Invalid date.");if(isReturnNull){return'';}else{return date.toString();}}
var DATES={en:{"days":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],"daysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],"daysMin":["Su","Mo","Tu","We","Th","Fr","Sa","Su"],"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"meridiem":["am","pm"]}};language=language?DATES[language]?language:'en':'en';var formatObj=function(formatStr){if((typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return formatStr;}
if(type){formatStr=timeFormatChange(formatStr,type);}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(format);var val={yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear(),m:date.getMonth()+1,M:DATES[language].monthsShort[date.getMonth()],MM:DATES[language].months[date.getMonth()],d:date.getDate(),D:DATES[language].daysShort[date.getDay()],DD:DATES[language].days[date.getDay()],p:DATES[language].meridiem.length==2?DATES[language].meridiem[date.getHours()<12?0:1]:'',h:date.getHours(),i:date.getMinutes(),s:date.getSeconds()};if(DATES[language].meridiem.length==2){val.H=val.h%12==0?12:val.h%12;}else{val.H=val.h;}
val.HH=(val.H<10?'0':'')+val.H;val.P=val.p.toUpperCase();val.hh=(val.h<10?'0':'')+val.h;val.ii=(val.i<10?'0':'')+val.i;val.ss=(val.s<10?'0':'')+val.s;val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;var finTime='';for(var i=0,len=formatObj.separators.length;i<len;i++){finTime+=formatObj.separators[i]+(formatObj.parts[i]?val[formatObj.parts[i]]:'');}
return finTime;};var DateUtil=function(){var dateLocale={month:{en:{month_names:['January','February','March','April','May','June','July','August','September','October','November','December'],month_names_short:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']},zh:{month_names:['','','','','','','','','','','',''],month_names_short:['','','','','','','','','','','','']}}};function getWeekNumber(d){d=new Date(+d);d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1);var weekNo=Math.ceil(((d-yearStart)/86400000+1)/7);return[d.getFullYear(),weekNo];}
function getLastWeekNumberOf(y,w){w-=1;if(w===0){y=y-1;w=52;}
return[y,w];}
function getNextWeekNumberOf(y,w){w+=1;if(w===53){y+=1;w=1;}
return[y,w];}
function isLeapYear(y){if(Object.prototype.toString.call(y)==='[object Date]'){y=y.getFullYear();}
return y%4===0&&y%100!==0||y%400===0;}
function daysInMonth(dt){var m=dt.getMonth();if(m===1){return isLeapYear(dt)?29:28;}
return[31,28,31,30,31,30,31,31,30,31,30,31][m];}
function getFirstDayOfWeek(year,week){var d=new Date(year,0,1),offset=d.getTimezoneOffset();d.setDate(d.getDate()+4-(d.getDay()||7));d.setTime(d.getTime()+7*24*60*60*1000*(week+(year==d.getFullYear()?-1:0)));d.setTime(d.getTime()+(d.getTimezoneOffset()-offset)*60*1000);d.setDate(d.getDate()-3);return d;}
function getDateRangeOnWeekNumber(year,week){if(!year||!week){return;}
var firstDay=getFirstDayOfWeek(year,week),lastDay=new Date(firstDay);lastDay.setDate(firstDay.getDate()+6);return[firstDay,lastDay];}
function getMonthName(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names:dateLocale.month['en'].month_names;return monthList[index];}
function getMonthNameShort(index,language){var monthList=language&&language in dateLocale.month?dateLocale.month[language].month_names_short:dateLocale.month['en'].month_names_short;return monthList[index];}
function getLastMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===1){return 12;}else{return currentMonth-1;}}
function getNextMonth(currentMonth){if(!currentMonth){currentMonth=new Date().getMonth()+1;}
if(currentMonth===12){return 1;}else{return currentMonth+1;}}
function getRelativeDateInfo(date1,date2){var now=new Date();var lang=I18n.type;var value1,value2,ts,info;if(!date1&&!date2)return'';value1=(date1||now).valueOf();value2=(date2||now).valueOf();ts=Math.floor(Math.abs(value1-value2)/1000);switch(true){case ts<60:info=ts+(ts===1?' second':' seconds');break;case ts<3600:ts=Math.floor(ts/60);info=ts+(ts===1?' minute':' minutes');break;case ts<86400:ts=Math.floor(ts/3600);info=ts+(ts===1?' hour':' hours');break;case ts<31536000:ts=Math.floor(ts/86400);info=ts+(ts===1?' day':' days');break;default:ts=Math.floor(ts/31536000);info=ts+(ts===1?' year':' years');break;}
info+=value1>value2?' ago':' later';if(lang==='zh'){info=info.replace(/\s(seconds?|minutes?|hours?|days?|years?)\s(ago|later)$/,function($0,$1,$2){var rs='';if($1.indexOf('second')>-1)rs+='';if($1.indexOf('minute')>-1)rs+='';if($1.indexOf('hour')>-1)rs+='';if($1.indexOf('day')>-1)rs+='';if($1.indexOf('year')>-1)rs+='';if($2==='ago')rs+='';if($2==='later')rs+='';return rs;});}
return info;}
return{getWeekNumber:getWeekNumber,isLeapYear:isLeapYear,daysInMonth:daysInMonth,getLastWeekNumberOf:getLastWeekNumberOf,getNextWeekNumberOf:getNextWeekNumberOf,getDateRangeOnWeekNumber:getDateRangeOnWeekNumber,getFirstDayOfWeek:getFirstDayOfWeek,getMonthName:getMonthName,getMonthNameShort:getMonthNameShort,getLastMonth:getLastMonth,getNextMonth:getNextMonth,getRelativeDateInfo:getRelativeDateInfo,DATA_FORMAT:{FULL_DATETIME:'yyyy-mm-dd hh:ii:ss',FULL_DATETIME_CHANGE:'yyyy-MM-dd HH:mm:ss',FULL_DATETIME_ALL_SEC_CHANGE:'yyyy-MM-dd 00:00:00',FULL_DATETIME_ZERO_SEC_CHANGE:'yyyy-MM-dd HH:mm:00',FULL_DATETIME_NO_SEC_CHANGE:'yyyy-MM-dd HH:mm',FULL_DATETIME_ZERO_SEC:'yyyy-mm-dd hh:ii:00',FULL_DATETIME_HH_00_00:'yyyy-mm-dd hh:00:00',FULL_DATETIME_00_00_00:'yyyy-mm-dd 00:00:00',FULL_DATETIME_NO_SEC:'yyyy-mm-dd hh:ii',FULL_DATETIME_HH_00:'yyyy-mm-dd hh:00',FULL_DATETIME_00_00:'yyyy-mm-dd 00:00',FULL_DATE:'yyyy-mm-dd',TIME:'hh:ii:ss',TIME_HOUR_MINUTE:'hh:ii',TIME_ZERO_SEC:'hh:ii:00'}};}();var StringUtil=function(){var HTML_ENTITIES={'&':'&amp;','>':'&gt;','<':'&lt;','"':'&quot;',"'":'&#39;','`':'&#x60;'},HTML_ENTITIES_INVERT=invert(HTML_ENTITIES);function invert(obj){var result={},keys=Object.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;}
function padLeft(oldStr,padNum,padStr){if(!padStr){return oldStr;}
return new Array(padNum-String(oldStr).length+1).join(padStr)+oldStr;}
function htmlEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES[character];});}
function htmlUnEscape(text){if(!text){return text;}
var source='(?:'+Object.keys(HTML_ENTITIES_INVERT).join('|')+')',replaceRegexp=new RegExp(source,'g');return text.replace(replaceRegexp,function(character){return HTML_ENTITIES_INVERT[character];});}
var getI18nProjectName=function getI18nProjectName(project){if(!I18n||!project){return'';}
var result='';switch(I18n.type){case'en':{result=project.name_english;break;}
case'zh':{result=project.name_cn;break;}
default:{result=project.name_english;}}
return result||'';};return{padLeft:padLeft,htmlEscape:htmlEscape,htmlUnEscape:htmlUnEscape,getI18nProjectName:getI18nProjectName};}();var BEOPUtil=function(){var jsType={function:_typeof($.noop),number:_typeof(0),string:_typeof(''),undefined:typeof undefined==='undefined'?'undefined':_typeof(undefined)};var projectImgPath=beop.constant.project_img_path;var setRelativePosition=function setRelativePosition($obj,$target,topOffset,leftOffset){$target.css({"left":$obj.offset().left+$obj.width()+(leftOffset||5),"top":$obj.offset().top+(topOffset||10)});};var projectDefaultImgPath=projectImgPath+beop.constant.project_default_img;var getProjectImgPath=function getProjectImgPath(project){if(project){return project.pic?projectImgPath+project.pic:projectDefaultImgPath;}};var getProjectFromAppConfig=function getProjectFromAppConfig(projectId){for(var m=0,len=AppConfig.projectList.length;m<len;m++){if(AppConfig.projectList[m].id==projectId){return AppConfig.projectList[m];}}};function getFunctionName(func){if(!func||(typeof func==='undefined'?'undefined':_typeof(func))!=jsType.function){return'';}
var ret=func.toString();ret=ret.substr('function '.length);ret=ret.substr(0,ret.indexOf('('));return ret;}
function isUndefined(obj){return(typeof obj==='undefined'?'undefined':_typeof(obj))===jsType.undefined;}
function getCookie(name){var value="; "+document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)return parts.pop().split(";").shift();}
function logicContentHandle(content){if(content){content=content.replace(/\t/g,'    ');}
return content;}
function copyToClipboard(text,valueContainer){var valueContainer=valueContainer?valueContainer:document.body;if(window.clipboardData&&window.clipboardData.setData){return clipboardData.setData("Text",text);}else if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=text;textarea.style.position="fixed";valueContainer.appendChild(textarea);textarea.select();try{return document.execCommand("copy");}catch(ex){console.warn("Copy to clipboard failed.",ex);return false;}finally{valueContainer.removeChild(textarea);}}}
var projectImgType={logo:'logo.png',pdfCover:'pdf_cover.jpg'};function getProjectImgByType(projectId,name,extension){var img='';if(projectId){img+=projectId+'_';}
img+=name;if(extension){img+='.'+extension;}
return beop.constant.BEOP_IMG_HOST+beop.constant.OSS_PROJECT_IMG_PATH+img;}
function getProjectById(id){if(!id||!AppConfig.projectList){return null;}
for(var i=0;i<AppConfig.projectList.length;i++){var project=AppConfig.projectList[i];if(project.id==id){return project;}}
return null;}
return{setRelativePosition:setRelativePosition,getProjectImgPath:getProjectImgPath,getFunctionName:getFunctionName,isUndefined:isUndefined,getCookie:getCookie,getProjectFromAppConfig:getProjectFromAppConfig,logicContentHandle:logicContentHandle,copyToClipboard:copyToClipboard,getProjectImgByType:getProjectImgByType,getProjectById:getProjectById,projectImgType:projectImgType};}();(function(){var beop_tmpl_cache={};this.beopTmpl=function tmpl(str,data,htmlStr){var fn=!/\W/.test(str)?beop_tmpl_cache[str]=beop_tmpl_cache[str]||tmpl(htmlStr?htmlStr:document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split(/<!/).join("\t").replace(/((^|!>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)!>/g,"',$1,'").split("\t").join("');").split(/!>/).join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn;};})();var SidebarMenuEffect=function(){function SidebarMenuEffect(){}
SidebarMenuEffect.prototype.init=function(center,left,right){var _this=this;this.$paneCt=$(center);this.$leftBtn=$(center).find('#leftCt');this.$rightBtn=$(center).find('#rightCt');var container=document.getElementById('st-container'),buttons=Array.prototype.slice.call(document.querySelectorAll('.sideTrans')),refresh=function refresh(){var leftCol=0,rightCol=0,centerCol=0;var leftArrow='<span class="glyphicon glyphicon-chevron-left"></span>';var rightArrow='<span class="glyphicon glyphicon-chevron-right"></span>';if(_this.$leftBtn.length>0){if(container.className.indexOf('st-effect-7')>0){var prev=_this.$paneCt.prev('div')[0];if(prev&&prev.className.indexOf('col-')>-1){leftCol=parseInt(prev.classList[0].split('-')[2]);}else{leftCol=0;}
_this.$leftBtn.removeClass('leftCtClose').addClass('leftCtOpen').html(leftArrow);}else{leftCol=0;_this.$leftBtn.removeClass('leftCtOpen').addClass('leftCtClose').html(rightArrow);}}
if(_this.$rightBtn.length>0){if(container.className.indexOf('st-effect-1')>0){var next=_this.$paneCt.next('div')[0];if(next&&next.className.indexOf('col-')>-1){rightCol=parseInt(next.classList[0].split('-')[2]);}else{rightCol=0;}
_this.$rightBtn.removeClass('rightCtClose').addClass('rightCtOpen').html(rightArrow);}else{rightCol=0;_this.$rightBtn.removeClass('rightCtOpen').addClass('rightCtClose').html(leftArrow);}}
centerCol=12-leftCol-rightCol;_this.$paneCt.removeClass().addClass('col-sm-'+centerCol+' st-content');};buttons.forEach(function(el,i){var effect=el.getAttribute('data-effect');el.addEventListener('click',function(ev){var target=ev.target.getAttribute('data-effect')!=null?ev.target.getAttribute('data-effect'):ev.target.parentNode.getAttribute('data-effect');var stCtClass=document.getElementById('st-container').className;if(stCtClass.indexOf(target)<0){ev.stopPropagation();ev.preventDefault();container.classList.add(effect);setTimeout(function(){if($(container.children[0]).children('div').length==3){container.classList.add('st-menu-open');}
refresh();},250);}else{container.classList.remove(target);refresh();}});});};return SidebarMenuEffect;}();(function(window){{var unknown='-';var screenSize='';if(screen.width){var width=screen.width?screen.width:'';var height=screen.height?screen.height:'';screenSize+=''+width+" x "+height;}
var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browser=navigator.appName;var version=''+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=nAgt.indexOf('Opera'))!=-1){browser='Opera';version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('MSIE'))!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(verOffset+5);}
else if((verOffset=nAgt.indexOf('Chrome'))!=-1){browser='Chrome';version=nAgt.substring(verOffset+7);}
else if((verOffset=nAgt.indexOf('Safari'))!=-1){browser='Safari';version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf('Version'))!=-1){version=nAgt.substring(verOffset+8);}}
else if((verOffset=nAgt.indexOf('Firefox'))!=-1){browser='Firefox';version=nAgt.substring(verOffset+8);}
else if(nAgt.indexOf('Trident/')!=-1){browser='Microsoft Internet Explorer';version=nAgt.substring(nAgt.indexOf('rv:')+3);}
else if((nameOffset=nAgt.lastIndexOf(' ')+1)<(verOffset=nAgt.lastIndexOf('/'))){browser=nAgt.substring(nameOffset,verOffset);version=nAgt.substring(verOffset+1);if(browser.toLowerCase()==browser.toUpperCase()){browser=navigator.appName;}}
if((ix=version.indexOf(';'))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(' '))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(')'))!=-1)version=version.substring(0,ix);majorVersion=parseInt(''+version,10);if(isNaN(majorVersion)){version=''+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10);}
var mobile=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=='undefined'&&!cookieEnabled){document.cookie='testcookie';cookieEnabled=document.cookie.indexOf('testcookie')!=-1?true:false;}
var os=unknown;var clientStrings=[{s:'Windows 3.11',r:/Win16/},{s:'Windows 95',r:/(Windows 95|Win95|Windows_95)/},{s:'Windows ME',r:/(Win 9x 4.90|Windows ME)/},{s:'Windows 98',r:/(Windows 98|Win98)/},{s:'Windows CE',r:/Windows CE/},{s:'Windows 2000',r:/(Windows NT 5.0|Windows 2000)/},{s:'Windows XP',r:/(Windows NT 5.1|Windows XP)/},{s:'Windows Server 2003',r:/Windows NT 5.2/},{s:'Windows Vista',r:/Windows NT 6.0/},{s:'Windows 7',r:/(Windows 7|Windows NT 6.1)/},{s:'Windows 8.1',r:/(Windows 8.1|Windows NT 6.3)/},{s:'Windows 8',r:/(Windows 8|Windows NT 6.2)/},{s:'Windows NT 4.0',r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:'Windows ME',r:/Windows ME/},{s:'Android',r:/Android/},{s:'Open BSD',r:/OpenBSD/},{s:'Sun OS',r:/SunOS/},{s:'Linux',r:/(Linux|X11)/},{s:'iOS',r:/(iPhone|iPad|iPod)/},{s:'Mac OS X',r:/Mac OS X/},{s:'Mac OS',r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:'QNX',r:/QNX/},{s:'UNIX',r:/UNIX/},{s:'BeOS',r:/BeOS/},{s:'OS/2',r:/OS\/2/},{s:'Search Bot',r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var id in clientStrings){var cs=clientStrings[id];if(cs.r.test(nAgt)){os=cs.s;break;}}
var osVersion=unknown;if(/Windows/.test(os)){osVersion=/Windows (.*)/.exec(os)[1];os='Windows';}
switch(os){case'Mac OS X':osVersion=/Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];break;case'Android':osVersion=/Android ([\.\_\d]+)/.exec(nAgt)[1];break;case'iOS':osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);osVersion=osVersion[1]+'.'+osVersion[2]+'.'+(osVersion[3]|0);break;}}
window.jscd={screen:screenSize,browser:browser,browserVersion:version,mobile:mobile,os:os,osVersion:osVersion,cookies:cookieEnabled};})(this);var getUrlParams=function getUrlParams(){var search=window.location.search.substring(1);var kvArr=search.split('&');var rs={};kvArr.forEach(function(kv){var arr=kv.split('=');if(typeof arr[1]!=='undefined'){rs[arr[0]]=arr[1];}});return rs;};$.fn.serializeObject=function(){var obj={};this.serializeArray().map(function(item){if(/\[\]$/.test(item.name)){if(obj[item.name]){obj[item.name].push(item.value);}else{obj[item.name]=[item.value];}}else{obj[item.name]=item.value;}});return obj;};function kIntSeparate(num,n){var number=num.toFixed(n?n:0);var source=String(number).split(".");source[0]=source[0].replace(new RegExp('(\\d)(?=(\\d{3})+$)','ig'),"$1,");return source.join(".");}
function timeFormatChange(format,type){var lastStr='';var formatObj=function(formatStr){if(!formatStr||(typeof formatStr==='undefined'?'undefined':_typeof(formatStr))=='object'){return;}
var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){return;}
return{separators:separators,parts:parts};}(format);if(formatObj){format='';for(var i=0,len=formatObj.separators.length-1;i<len;i++){format+=formatObj.separators[i]+formatObj.parts[i];}
lastStr=formatObj.separators[len];}
var formatArr=['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'];var formatChangeArr=[['yyyy-mm-dd hh:ii:ss','yyyy-mm-dd hh:ii','yyyy-mm-dd hh','yyyy-mm-dd','yyyy-mm','mm-dd hh:ii:ss','mm-dd hh:ii','mm-dd hh','mm-dd'],['M d, yyyy hh:ii:ss','M d, yyyy hh:ii','M d, yyyy hh','M d, yyyy','M, yyyy','M d hh:ii:ss','M d hh:ii','M d hh','M d'],['dd/mm/yyyy hh:ii:ss','dd/mm/yyyy hh:ii','dd/mm/yyyy hh','dd/mm/yyyy','mm/yyyy','dd/mm hh:ii:ss','dd/mm hh:ii','dd/mm hh','dd/mm']];if(formatArr.findIndex){var index=formatArr.findIndex(function(v){return v===format;});}else{for(var i=0;i<formatArr.length;i++){if(formatArr[i]===format){var index=i;break;}}}
type=Number(type);type&&type>=formatChangeArr.length&&(type=formatChangeArr.length-1);if(index==-1){console.log('format is not defined');return format+lastStr;}else{if(type===0){return formatChangeArr[0][index]+lastStr;}
return formatChangeArr[type||AppConfig.projectTimeFormat||0][index]+lastStr;}}
function timeFormat(time,format,language,option){var date,arr,arr2;var sort=function sort(year,month,day,time){year=year==undefined?'2001':year;month=month==undefined?'01':month;day=day==undefined?'01':day;time=time==undefined?'':' '+time;return new Date(year+'/'+month+'/'+day+time);};if(time instanceof Date){date=time;}else if(typeof time=='string'){if(/^\d{1,2}-\d{1,2}/.test(time)){arr=time.split(' ');arr2=arr[0].split('-');time=arr2[1]+'-'+arr2[0]+(arr2[2]==undefined?'':'-'+arr2[2])+(arr[1]==undefined?'':' '+arr[1]);}
time=time.replace(/-/g,"/");arr=time.split(' ');arr2=arr[0].split('/');if(/^\d{4}/.test(time)){date=sort(arr2[0],arr2[1],arr2[2],arr[1]);}else if(/^\d{1,2}\/\d{4}/.test(time)){date=sort(arr2[1],arr2[0],'01',arr[1]);}else if(/^\d{1,2}\/\d{1,2}/.test(time)){date=sort(arr2[2],arr2[1],arr2[0],arr[1]);}else{date=new Date(time);}}else{date=new Date(time);}
return date.timeFormat(format,language,option);}
(function(exports){var MINITE_1=60000;var MINITE_5=300000;var HOUR_1=3600000;var DAY_1=86400000;var DAY_365=31536000000;function _formatTimeStr(str,format){var arr=str.split(' ');var date=arr[0].split('-');var time=arr[1].split(':');return format.replace('yyyy',date[0]).replace('MM',date[1]).replace('dd',date[2]).replace('HH',time[0]).replace('mm',time[1]).replace('ss',time[2]);}
function _explainPattern(timeShaft){var startTime=new Date(timeShaft[0]);var endTime=new Date(timeShaft[timeShaft.length-1]);var timeRange=endTime.valueOf()-startTime.valueOf();var timeInterval=timeRange/(timeShaft.length-1);var pattern='MM-dd HH:mm';if(timeInterval<=MINITE_5){if(timeRange<=HOUR_1){pattern='HH:mm';}else if(timeRange<=DAY_1){pattern='HH:mm';}}
else if(timeInterval<=HOUR_1){if(timeRange<=DAY_1){pattern='HH:mm';}else{pattern='MM-dd HH:mm';}}
else if(timeInterval<=DAY_1){if(timeRange<=DAY_365){pattern='MM-dd';}else{pattern='yyyy-MM-dd';}}
else{pattern='yyyy-MM';}
return pattern;}
function _explain(timeShaft){pattern=getPattern(timeShaft);if(pattern){timeShaft=timeShaft.map(function(row){return _formatTimeStr(row,pattern);});}
return timeShaft;}
function _valid(params){var flag=Object.prototype.toString.call(params)==='[object Array]';return flag&&/^[\d-]{10} [\d:]{8}$/.test(params[0]);}
var _getTimePattern=function _getTimePattern(timeShaft){if(!_valid(timeShaft)){return;}
if(timeShaft.length<=1){return;}
return _explainPattern(timeShaft);};var formatTimeShaft=exports.formatTimeShaft=function(timeShaft){if(!_valid(timeShaft)){console.warn('function arguments is not a valid time shaft array!');return timeShaft;}
if(timeShaft.length<=1){return timeShaft;}
return _explain(timeShaft);};function _formatTimeStrByAppConfig(data){var formatArr,formatStr,regularArr,language,formatObj;switch(AppConfig.projectTimeFormat||0){case 0:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';break;case 1:formatArr=['M d, yyyy','M d hh:ii','M, yyyy','M, yyyy','M d'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;case 2:formatArr=['dd/mm/yyyy','dd/mm hh:ii','mm/yyyy','mm/yyyy','dd/mm'];regularArr=[/^[\d-]{10}$/,/^[\d-]{5} [\d:]{5}$/,/^[\d-]{7}$/,/^[\d-]{6}$/,/^[\d-]{5}$/];language='en';break;default:formatArr=['yyyy-mm-dd'];regularArr=[/^[\d-]{10}$/];language='en';}
for(var i=0,len=regularArr.length;i<len;i++){if(regularArr[i].test(data)){formatStr=formatArr[i];break;}}
if(formatStr){formatObj=function _parseFormat(formatStr){var reg=/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;var separators=formatStr.replace(reg,'\0').split('\0');var parts=formatStr.match(reg);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};}(formatStr);return{formatStr:formatStr,language:language,formatObj:formatObj};}else{return;}}
if(window.echarts){echarts.registerPreprocessor(function(option){var pattern;var formatInfo,firstValue;if(option.formatTime===false){pattern=_getTimePattern(option.xAxis[0].data);echarts.formatTimePattern=pattern;return;}
if(option.xAxis&&option.xAxis.length){option.xAxis.forEach(function(row){if(row.data&&row.data.length){pattern=_getTimePattern(row.data);formatInfo=_formatTimeStrByAppConfig(row.data[0]);if(pattern){row.data=row.data.map(function(row){return row.substr(0,16);});firstValue=_formatTimeStr(row.data[0],pattern);formatInfo=_formatTimeStrByAppConfig(firstValue);if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}else{row.data=row.data.map(function(it,i){return _formatTimeStr(it,pattern);});}}else if(formatInfo){row.data=row.data.map(function(it,i){return timeFormat(it,formatInfo.formatObj,formatInfo.language);});}}});}});}})(window);var generateTimeOption=function generateTimeOption(option){var timeConfig=clone(option);!timeConfig.timeStart&&(timeConfig.timeStart=timeConfig.startTime);!timeConfig.timeEnd&&(timeConfig.timeEnd=timeConfig.endTime);!timeConfig.timeFormat&&(timeConfig.timeFormat=timeConfig.format);var recentTime={};var now=new Date();if(typeof option=='string'){recentTime=generateRecentTime(option);}else if(option&&option.timeRecent){if(typeof option.timeRecent=='string'){recentTime=generateRecentTime(option.timeRecent);}else if(option.timeRecent.hasOwnProperty('unit')&&option.timeRecent.hasOwnProperty('val')){recentTime=generateRecentTimeCustom(option.timeRecent);}}
if(recentTime&&Object.keys(recentTime).length>0){timeConfig.timeStart=recentTime.timeStart;timeConfig.timeEnd=recentTime.timeEnd;if(recentTime.format){timeConfig.timeFormat=recentTime.format;}
switch(timeConfig.timeFormat){case'h1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd HH:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd HH:00:00');break;case'd1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-dd 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-dd 00:00:00');break;case'M1':timeConfig.timeEnd=new Date(recentTime.timeEnd).format('yyyy-MM-01 00:00:00');timeConfig.timeStart=new Date(recentTime.timeStart).format('yyyy-MM-01 00:00:00');break;}}
timeConfig.startTime=timeConfig.timeStart;timeConfig.endTime=timeConfig.timeEnd;timeConfig.format=timeConfig.timeFormat;return timeConfig;function generateRecentTime(time){var startTime,endTime,format;switch(time){case'today':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-86400000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'threeDay':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-259200000).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'yesterday':endTime=new Date(new Date().setDate(now.getDate()-1)).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(new Date().setDate(now.getDate()-2)).format('yyyy-MM-dd HH:mm:ss');format='h1';break;case'thisWeek':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now-604800000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'lastWeek':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='d1';break;case'thisYear':endTime=new Date(now-(now.getDay()+1)*86400000).format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-(now.getDay()+7)*86400000).format('yyyy-MM-dd HH:mm:ss');format='M1';break;}
return{timeStart:startTime,timeEnd:endTime,format:format};}
function generateRecentTimeCustom(time){var startTime,endTime,format;switch(time.unit){case'hour':endTime=now.format('yyyy-MM-dd HH:mm:ss');startTime=new Date(now-3600000*time.val).format('yyyy-MM-dd HH:mm:ss');break;case'day':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-86400000*time.val).format('yyyy-MM-dd HH:00:00');break;case'month':endTime=now.format('yyyy-MM-dd HH:00:00');startTime=new Date(now-2592000000*time.val).format('yyyy-MM-dd HH:00:00');break;}
return{timeStart:startTime,timeEnd:endTime};}};var WebAPI=function(){var siteId;switch(window.location.hostname){case'beop.rnbtech.com.hk':siteId='b79c068f77198848e22fe79758836e53';break;case'beop6.rnbtech.com.hk':siteId='f1f6b2b9e6b64592c0b4cb5e9b8bd79e';break;case'beopdemo.rnbtech.com.hk':siteId='ac0df98f274d9a5980a571297248d80b';break;default:break;}
(function(){if(siteId){var hm=document.createElement("script");hm.src="//hm.baidu.com/hm.js?"+siteId;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);}})();var mockList={'/static/mock/analysis_workspace_saveLayout.json':/\/analysis\/workspace\/saveLayout\/\d+\/[01]/i,'/static/mock/analysis_template_get.json':/\/analysis\/template\/get\/\d+/i};function mock(url){var match=null;for(var i in mockList){match=url.match(mockList[i]);if(match!==null)return i;}
return url;}
function requestFailHandle(result){if(result&&result.status==401){alert(i18n_resource.error.noPermission);}}
function WebAPI(){}
WebAPI.isMock=false;$.ajaxSetup({converters:{"text json":true},dataFilter:function dataFilter(result,type){var data=result;if(type==='script'){return data;}else if(typeof data==='string'){if(/^\s*</.test(data)){return data;}
try{data=JSON.parse(result);}catch(e){console.log('request error: '+e+', the data is :'+data);return data;}}
if(data){if(data.error){switch(data.error){case'token_invalid':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');if(typeof LoginValidate!='undefined'){var validate=new LoginValidate();validate.show();return;}
confirm(i18n_resource.error.token[data.msg]+'. '+i18n_resource.error.relogin+'.',function(){if(AppConfig.isMobile){location.reload();}else{location.href='/';}});break;}
case'historyData':{console.log(this.url+' ('+data.error+': code"'+data.msg+'")');alert(data.msg);return{};}
default:break;}}
if(data.code==403){console.log(this.url+' ('+data.msg+'")');alert(I18n.resource.error.noPermission);return{};}}
return data;}});WebAPI.post=function(url,data,isMock){var mockUrl;isMock=isMock===undefined?WebAPI.isMock:isMock;if(isMock){mockUrl=mock(url);if(url!==mockUrl)return this.get(mockUrl,false);}
if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'POST',data:JSON.stringify(data),contentType:'application/json'}).fail(requestFailHandle);};WebAPI.get=function(url,isMock){isMock=isMock===undefined?WebAPI.isMock:isMock;url=isMock?mock(url):url;if(window._hmt&&url.indexOf('.html')>0)window._hmt.push(['_trackPageview',url]);if(typeof cordova!='undefined'&&AppConfig.host){if(url.indexOf('.html')==-1){url=AppConfig.host+url;}else if(url[0]=='/'){url=url.slice(1);}}
return $.ajax({url:url,type:'Get',contentType:'application/json'}).fail(requestFailHandle);};WebAPI.getHistoryDS=function(callback){};WebAPI.getHistory=function(callback){};return WebAPI;}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var EventAdapter=function(){var eventData,eventStatus;function EventAdapter($){}
EventAdapter.on=function(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<3||arguments.length>5){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(arguments[0])!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}}
if(typeof arguments[1]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[1];}
if(typeof arguments[2]=='function'){eventFunction=arguments[2];eventSelector=null;eventHmt=arguments[3];}else if(typeof arguments[2]=='string'){if(arguments[3]&&typeof arguments[3]=='function'){eventSelector=arguments[2];eventFunction=arguments[3];eventHmt=arguments[4];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':eventTarget.on('touchstart',eventSelector,function(e){mobileDragStart.call(this,e,eventTarget,finalFunction);});break;case'dragover':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragOver.call(this,e,eventTarget,finalFunction);});break;case'dragleave':$(document).on('touchmove.drag',eventSelector,function(e){mobileDragLeave.call(this,e,eventTarget,finalFunction);});break;case'drop':$(document).on('touchend.drop',eventSelector,function(e){mobileDrop.call(this,e,eventTarget,finalFunction);});break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;};EventAdapter.off=function(){if(arguments.length>3||arguments.length<1||arguments[0]&&typeof arguments[1]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(arguments[0]instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=arguments[0];}
if(arguments.length==1){eventTarget.off();return eventTarget;}
if(typeof arguments[1]=='string'){eventType=arguments[1];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[2]=='string'){eventSelector=arguments[2];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;};$.fn.extend({'eventOn':function eventOn(){var eventTarget,eventType,eventFunction,eventSelector,eventHmt,finalFunction;if(arguments.length<2||arguments.length>4){console.log('EventAdapter.on arguments.length error');return;}
if(_typeof(this)!='object'){console.log('EventAdapter.on arguments[0] type error');return;}else{if(!(this instanceof jQuery)){eventTarget=jQuery(arguments[0]);}else{eventTarget=this;}}
if(typeof arguments[0]!='string'){console.log('EventAdapter.on arguments[1] type error');return;}else{eventType=arguments[0];}
if(typeof arguments[1]=='function'){eventFunction=arguments[1];eventSelector=null;eventHmt=arguments[2];}else if(typeof arguments[1]=='string'){if(arguments[2]&&typeof arguments[2]=='function'){eventSelector=arguments[1];eventFunction=arguments[2];eventHmt=arguments[3];}else{console.log('EventAdapter.on arguments[2 or 3] type error');return;}}
finalFunction=function finalFunction(e){if(!(eventHmt===false)){EventAdapter.analyse(e,eventType,eventHmt);}
eventFunction.call(this,e);};if(!AppConfig.isMobile){eventTarget.on(eventType,eventSelector,finalFunction);}else{switch(eventType){case'click':eventTarget.on('touchstart',eventSelector,finalFunction);break;case'dragstart':mobileDragStart(eventTarget,eventSelector,finalFunction);break;case'dragover':mobileDragOver(eventTarget,eventSelector,finalFunction);break;case'dragleave':mobileDragLeave(eventTarget,eventSelector,finalFunction);break;case'drop':mobileDrop(eventTarget,eventSelector,finalFunction);break;default:eventTarget.on(eventType,eventSelector,finalFunction);break;}}
return eventTarget;},'eventOff':function eventOff(){if(arguments.length>2||arguments[0]&&typeof arguments[0]!='string'){console.log('EventAdapter.off arguments error');return;}
var eventTarget,eventType,eventSelector;if(!(this instanceof jQuery)){eventTarget=jQuery(this);}else{eventTarget=this;}
if(arguments.length==0){eventTarget.off();return eventTarget;}
if(typeof arguments[0]=='string'){eventType=arguments[0];}else{console.log('EventAdapter.off eventType Error');return;}
if(typeof arguments[1]=='string'){eventSelector=arguments[1];}else{eventSelector=null;}
if(!AppConfig.isMobile){eventTarget.off(eventType,eventSelector);}else{switch(eventType){case'click':eventTarget.off('touchstart',eventSelector,mobileDragStart);break;case'dragstart':eventTarget.draggable('destroy');break;case'dragover':eventTarget.droppable('destroy');break;case'dragleave':eventTarget.droppable('destroy');break;case'drop':eventTarget.droppable('destroy');break;default:eventTarget.off(eventType,eventSelector);break;}}
return eventTarget;}});EventAdapter.setData=function(date){if(date==undefined)return;eventData=date;};EventAdapter.getData=function(){return eventData;};document.addEventListener('drop',function(){eventData=null;},false);document.addEventListener('touchend',function(){eventData=null;},false);EventAdapter.clearEvent=function(){$(document).off('touchmove.copy');$(document).off('touchmove.drag');$(document).off('touchend.drop');};EventAdapter.analyse=function(e,eventType,hmtInfo){var mainInfo='',initArrTag,finalArrTag,tag,unitTag;var target=$(e.currentTarget);if(hmtInfo instanceof Array&&hmtInfo[0]){mainInfo=judgeWay(hmtInfo[0]);initArrTag=hmtInfo.filter(function(ele,index){return index>0&&ele!='';});finalArrTag=[];for(var i=0;i<initArrTag.length;i++){unitTag=judgeWay(initArrTag[i]);if(unitTag=='')continue;finalArrTag.push(unitTag);}
tag=finalArrTag.join('-');}else{if(hmtInfo!=undefined){mainInfo=judgeWay(hmtInfo);}else{mainInfo=getInfo(target);}
mainInfo=mainInfo?mainInfo:'';tag=mainInfo;}
_hmt.push(['_trackEvent',mainInfo.substr(0,30),eventType,'user-'+(AppConfig.userId?AppConfig.userId:0)+'/project-'+(AppConfig.projectId?AppConfig.projectId:0)]);function getInfo(tar){if(tar.length==0)return;var tarInfo;if(tar.attr('id')){tarInfo=tar.attr('id');}else if(tar.attr('i18n')){tarInfo=tar.attr('i18n');}else if(tar.attr('title')){tarInfo=tar.attr('title');}else{tarInfo=tar[0].innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}
return tarInfo;}
function judgeWay(arg){if(typeof arg=='undefined'){return'';}
if(arg instanceof Function){return arg.call(this,e);}else if(typeof arg=='string'){if(arg=='text'){return e.currentTarget.innerText.replace(/^\s\s*/,'').replace(/\s\s*$/,'').substr(0,30);}else{return $(e.currentTarget).attr(arg)?$(e.currentTarget).attr(arg):arg;}}else if(typeof arg=='number'){return arg;}}};var mobileDragStart=function mobileDragStart(e,target,eventFunction){var originalTarget=$(e.target).closest('[draggable="true"]')[0];var ev=e.type=='touchstart'?e.originalEvent.touches[0]:e,startPos={left:$(originalTarget).css('left'),top:$(originalTarget).css('top'),zIndex:$(originalTarget).css('z-index')},disX=originalTarget.offsetWidth/2,disY=originalTarget.offsetHeight/2;var $copyTarget=$(originalTarget).clone();$copyTarget.data('startPos',startPos);$copyTarget.css('z-index',10000);$copyTarget.css('position','absolute');$copyTarget.css('opacity','0.5');$copyTarget.css('pointer-events','none');var $container=$('body');$container.append($copyTarget);var sPos=$(originalTarget)[0].getBoundingClientRect();$copyTarget.css('left',sPos.left-$container[0].offsetLeft+'px');$copyTarget.css('top',sPos.top-$container[0].offsetTop+'px');$copyTarget[0].cssText=originalTarget.cssText;$copyTarget.css('width',originalTarget.offsetWidth);$copyTarget.css('height',originalTarget.offsetHeight);eventStatus='dragStart';eventFunction.call(this,ev);$(document).off('touchend.copy').on('touchend.copy',function(e){$copyTarget.remove();eventStatus='dragEnd';});$(document).on('touchmove.copy',function(e){eventStatus='dragMove';var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var $parent=$copyTarget.offsetParent();$parent=$parent.is(':root')?$(window):$parent;var targetLeft=ev.pageX-disX;var targetTop=ev.pageY-disY;$copyTarget.css({left:targetLeft+'px',top:targetTop+'px','z-index':10000});});};var mobileDragOver=function mobileDragOver(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn'&&eventStatus!='dragMoveOut')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveIn';eventFunction.call(this,e);break;}}};var mobileDragLeave=function mobileDragLeave(e,target,eventFunction){if(eventStatus!='dragMoveIn')return;var ev=e.type=='touchmove'?e.originalEvent.touches[0]:e;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(!(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY)){e.target=target[i];e.currentTarget=target[i];eventStatus='dragMoveOut';eventFunction.call(this,e);}}};var mobileDragEnd=function mobileDragEnd(e,target,eventFunction){eventFunction.call(this,e);};var mobileDrop=function mobileDrop(e,target,eventFunction){if(eventStatus!='dragMove'&&eventStatus!='dragMoveIn')return;var ev=e.type=='touchend'?e.originalEvent.changedTouches[0]:e;var eventTarget=target;var targetWidth,targetHeight;for(var i=0;i<target.length;i++){targetWidth=target[i].offsetWidth;targetHeight=target[i].offsetHeight;if(target.eq(i).offset().left<ev.pageX&&target.eq(i).offset().left+targetWidth>ev.pageX&&target.eq(i).offset().top<ev.pageY&&target.eq(i).offset().top+targetHeight>ev.pageY){e.target=target[i];e.currentTarget=target[i];eventFunction.call(this,e);break;}}};return EventAdapter;}(jQuery);var EnergyScreen=function(){function EnergyScreen(id,store,shareSaveChange,dsInfoList,isForMobile){if(!id){this.id=ScreenCurrent.id;}else{this.id=id;}
this.factoryIoC=undefined;this.factoryIoCAnalysis=undefined;this.listEntity=undefined;this.mapRefresh={};this.popRefresh={};this.arrEntityOrder=undefined;this.requestPoints=[];this.dictPopToEntity={};this.store=store?store:undefined;this.container=undefined;this.dsInfolist=dsInfoList;if(store){this.sharedesc=store.desc;}else if(shareSaveChange){this.sharedesc=shareSaveChange.desc;}
this.isForReport=store?true:false;this.shareLogId=shareSaveChange?shareSaveChange.shareLogId:false;if(this.shareLogId){this.isForReport=true;}
this.isForBencMark=undefined;this.modalConfigPane=undefined;this.isConfigMode=false;this.workerUpdate=undefined;this.paneDatasource=undefined;this.arrColor=echarts.config.color;this.isScreenChange=undefined;this.isPlayback=false;this.$obCanvasContainer=undefined;this.canvas=undefined;this.toolContainer=undefined;this.isForMobile=isForMobile;this.options={isForMobile:isForMobile};}
EnergyScreen.prototype={show:function show(){var _this=this;ElScreenContainer.innerHTML='';WebAPI.get("/static/views/observer/energyScreen.html").done(function(resultHtml){var divMain=document.createElement('div');divMain.className='indexContent st-pusher';divMain.innerHTML=resultHtml;var stCt=$('<div id="st-container" class="st-container">')[0];stCt.appendChild(divMain);ElScreenContainer.appendChild(stCt);_this.container=document.getElementById('paneCenter');_this.$obCanvasContainer=$(_this.container);_this.modalConfigPane=new modalConfigurePane(document.getElementById('energyModal'),_this,'dashboard');_this.modalConfigPane.show();_this.init();});},close:function close(){if(this.isConfigMode){if(this.isScreenChange){var _this=this;confirm('There are some changes haven\'t been saved, do you want to save them before quit? ',function(){_this.saveLayout();});}}
for(var key in this.listEntity){this.listEntity[key].close();}
if(this.workerUpdate)this.workerUpdate.terminate();this.workerUpdate=null;this.factoryIoC=null;this.factoryIoCAnalysis=null;this.listEntity=null;this.arrEntityOrder=null;this.store=null;this.container=null;this.dictPopToEntity=null;this.UNIT_WIDTH=null;this.UNIT_HEIGHT=null;AppConfig.datasource=null;this.paneDatasource&&this.paneDatasource.close&&this.paneDatasource.close();this.$obCanvasContainer=null;this.canvas=null;this.arrColor=null;this.dsInfolist=null;this.mapRefresh=null;this.modalConfigPane=null;this.popRefresh=null;this.requestPoints=null;this.toolContainer=null;this.isForReport=null;this.isPlayback=null;this.shareLogId=null;if(!this.isForBencMark){if(ToolCurrent)ToolCurrent.close();ToolCurrent=null;$('#ulTools').html('');$('.toolBacktrace').remove();$('#btnConfigDashboard').remove();}
this.isForBencMark=null;},stop:function stop(){if(this.workerUpdate)this.workerUpdate.terminate();},onresize:function onresize(){var entity;for(var key in ScreenCurrent.listEntity){entity=ScreenCurrent.listEntity[key];if(entity.chart)entity.chart.resize();if(entity.entityAnalysis&&entity.entityAnalysis.chart)entity.entityAnalysis.chart.resize();}},init:function init(){var _this=this;Spinner.spin(ElScreenContainer);if(this.store){initByData();Spinner.stop();}else{WebAPI.get("/spring/get/"+this.id).done(function(result){_this.store=result;initByData();}).always(function(e){Spinner.stop();});}
function initByData(){_this.paneDatasource=new DataSource(_this);AppConfig.datasource=_this.paneDatasource;_this.initIoc();_this.initLayout();_this.initToolBar();_this.initWorkerForUpdating();_this.initScreen();if(_this.isForBencMark!==true){_this.initReplay();}}
$('#btnModalAdd').off('click').click(function(e){var entity=new ModalNone(_this,{id:(+new Date()).toString(),spanC:6,spanR:2,modal:{type:"ModalNone"}});_this.arrEntityOrder.push(entity.entity.id);_this.listEntity[entity.entity.id]=entity;entity.render();entity.configure();});},initToolBar:function initToolBar(){var _this=this;var ulTools;if(AppConfig.isMobile)return;if(this.isForBencMark)return;ulTools=$('#ulTools');ulTools.html('');if(this.isForReport){var btnMode=$('<span>').addClass('badge grow toolbar-btn-selected').text('ok').css('cursor','pointer').css('background-color','#5bc0de').click(function(e){_this.saveLayout();_this.isConfigMode=false;});_this.isConfigMode=true;$('.springLinkBtn').hide();$('.sideTrans').fadeIn();$($('.nav-header')[0]).click();btnMode.appendTo($('<li><a>')).appendTo(ulTools);}else{if(AppConfig.permission&&AppConfig.permission.DBWrite){var $liConfig=$('<li class="iconWrap" id="btnConfigDashboard" permission="DBWrite"><a><span class="glyphicon glyphicon-cog"></span><span class="dropdownNav">'+I18n.resource.observer.widgets.CONFIG_MODE+'</span> </a></li>');var btnMode=$('<span>').addClass('badge grow').text('').css('cursor','pointer').css('background-color','#5bc0de').click(function(e){_this.isConfigMode=false;e.currentTarget.classList.remove('toolbar-btn-selected');_this.saveLayout();$('.springLinkBtn').removeAttr('style');});$liConfig.click(function(e){_this.isConfigMode=true;$('.springLinkBtn').hide();_this.showConfigMode();$('.sideTrans').fadeIn();document.querySelector('#leftCt').click();$($('.nav-header')[0]).click();btnMode.text(I18n.resource.observer.widgets.CONFIG_SAVE);});btnMode.appendTo($('<li><a>')).appendTo(ulTools);$liConfig.appendTo($('#liProjectMenu .list-inline'));}else{$('#btnConfigDashboard').remove();}}
try{Permission.check($('#liProjectMenu ul'));}catch(e){console.log(e);}},initIoc:function initIoc(){this.factoryIoC=new FactoryIoC('dashboard');this.factoryIoCAnalysis=new FactoryIoC('analysis');},initLayout:function initLayout(){if(this.options.isForMobile)this.$obCanvasContainer.addClass('forMobile');this.listEntity={};this.arrEntityOrder=[];if(!this.isForBencMark){var side=new SidebarMenuEffect();side.init('#paneContent');}
I18n.fillArea($('#toolBox'));if(!(this.store&&this.store.layout))return;for(var i=0,item;i<this.store.layout.length;i++){for(var j=0;j<this.store.layout[i].length;j++){item=this.store.layout[i][j];var modelClass,entity;if(item.modal.type&&(item.modal.type!='ModalNone'||item.isNotRender==true)){modelClass=this.factoryIoC.getModel(item.modal.type);if(!modelClass)continue;if(item.isNotRender)continue;entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);if(item.modal.interval&&item.modal.interval>=0&&item.modal.points){for(var k=0,point,kLen=item.modal.points.length;k<kLen;k++){point=item.modal.points[k];if(this.requestPoints.indexOf(point)<0){this.requestPoints.push(point);}}}
if(item.modal.popId){if(!this.dictPopToEntity[item.modal.popId])this.dictPopToEntity[item.modal.popId]=[];this.dictPopToEntity[item.modal.popId].push(item.id);if(this.requestPoints.indexOf(item.modal.popId)<0){this.requestPoints.push(item.modal.popId);}}
entity.render();}else if(item.modal.type=='ModalNone'){modelClass=this.factoryIoC.getModel(item.modal.type);entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);entity.render();}}}
var $springCtn=$('#paneCenter').children('.springContainer');if($springCtn.length==1&&parseFloat($springCtn[0].style.height)>=parseFloat("99%")&&parseFloat($springCtn[0].style.width)>=parseFloat("99%")){$springCtn.children('.panel-default').css({border:'none',left:0,top:0,width:'100%',height:'100%',"border-radius":0});}
var _this=this;if(_this.isForReport){_this.showConfigMode();document.querySelector('#leftCt').click();}},initWorkerForUpdating:function initWorkerForUpdating(){this.workerUpdate=new Worker("/static/views/js/worker/workerUpdate.js");this.workerUpdate.self=this;this.workerUpdate.addEventListener("message",this.refreshData,true);this.workerUpdate.addEventListener("error",function(e){console.log(e);},true);if(this.requestPoints&&this.requestPoints.length>0){this.workerUpdate.postMessage({pointList:this.requestPoints,type:"datasourceRealtime"});}},refreshData:function refreshData(e){var _this=this.self?this.self:this;if(!e.data.error&&e.data.dsItemList){var point;for(var i=0,iLen=e.data.dsItemList.length;i<iLen;i++){point=e.data.dsItemList[i];_this.mapRefresh[point.dsItemId]=point;if(_this.dictPopToEntity[point.dsItemId]){_this.popRefresh[point.dsItemId]=point;}}
var entity,arrUpdataData;for(var key in _this.listEntity){entity=_this.listEntity[key];if(entity.entity.modal.type=="ModalNone"||entity.entity.modal.type=="ModalMix")continue;arrUpdataData=[];if(entity.entity.modal&&entity.entity.modal.points){for(var i=0,iLen=entity.entity.modal.points.length;i<iLen;i++){var point=entity.entity.modal.points[i];if(!point)continue;if(entity.entity.modal.points.indexOf(point)!=i)continue;if(_this.mapRefresh[point]!=undefined)arrUpdataData.push(_this.mapRefresh[point]);}
if(entity.entity.modal.type=="ModalAppGauge"){arrUpdataData.push({'guageTitle':entity.entity.modal.option.guageTitle,'guageFulTitle':entity.entity.modal.option.guageFulTitle,'guageFixed':entity.entity.modal.option.guageFixed,'guageUnit':entity.entity.modal.option.guageUnit,'guageMax':entity.entity.modal.option.guageMax,'timeLocal':entity.entity.modal.option.timeLocal,'guageDirect':entity.entity.modal.option.guageDirect,'guageBgColor':entity.entity.modal.option.guageBgColor,'transDataDot':entity.entity.modal.option.transDataDot});}
entity.entity.modal.popId&&entity.renderPop(_this.popRefresh[entity.entity.modal.popId]);entity.update(arrUpdataData);}}}else{}},refreshDataTrace:function refreshDataTrace(e){var _this=this;_this.refreshData(e);for(var key in this.listEntity){if(undefined!=_this.listEntity[key].goBackTrace){_this.listEntity[key].goBackTrace(e);}}},saveLayout:function saveLayout(){var _this=this;var arrEntity=[];var entity=null;for(var i=0;i<this.arrEntityOrder.length;i++){entity=this.listEntity[this.arrEntityOrder[i]].entity;if(entity.modal.type!='ModalMix'){for(var m in this.listEntity){var en=this.listEntity[m].entity;if(en.modal.type==='ModalMix'&&en.modal.option&&en.modal.option.subChartIds&&en.modal.option.subChartIds.length>0){for(var n=0;n<en.modal.option.subChartIds.length;n++){if(en.modal.option.subChartIds[n]){if(entity.id===en.modal.option.subChartIds[n].id&&$('#divContainer_'+entity.id).closest('#divContainer_'+en.id).length==1){entity.isNotRender=true;}}}}}}
if(this.listEntity[this.arrEntityOrder[i]].optionTemplate.needRefresh===false){arrEntity.push(entity);}else if(entity.modal.type=='ModalPointKPI'){arrEntity.push(this.dealWithEntity(entity));}else if(entity.modal.type=='ModalReportChapter'){if(entity.modal.option&&entity.modal.option.menuId&&entity.modal.option.menuId!=''){arrEntity.push(entity);}}else if(entity.modal.type=='ModalAppButton'){if(entity.modal.option&&entity.modal.option.appButton&&entity.modal.option.appButton.length!=0){arrEntity.push(entity);}}else if(entity.modal.type=='ModalDiagnosisPanelHtml'){if(!entity.modal.option){entity.modal.option={html:'<div id="modalDiagnosisPanel'+i+'" style="height:100%;"></div><script>new ModalDiagnosisPanel(document.getElementById("modalDiagnosisPanel'+i+'")).show()</script>'};entity.modal.dsChartCog=[{accuracy:2}];entity.modal.interval=60000;entity.modal.points=[];}
arrEntity.push(entity);}else if(entity.modal.type=='ModalAppBlind'){if(entity.modal.option&&entity.modal.option.length>0){for(var j=0;j<entity.modal.option.length;j++){if(entity.modal.option[j]&&entity.modal.option[j].subChartIds&&entity.modal.option[j].subChartIds[0].id){var id=entity.modal.option[j].subChartIds[0].id;if(!this.listEntity[id]){entity.modal.option.splice(j,1);break;}}}}
arrEntity.push(entity);}else{arrEntity.push(entity);}}
var data={creatorId:AppConfig.userId,menuItemId:this.id,layout:[arrEntity]};this.store.id&&(data.id=this.store.id);Spinner.spin(ElScreenContainer);WebAPI.post('/spring/saveLayout',data).done(function(result){if(_this.isForReport){var argSkin=AppConfig.chartTheme=='macarons'?'':'?skin=dark';_this.initShareIframe("/share/db/"+AppConfig.userId+"/"+_this.id+argSkin);ScreenManager.show(shareLogging,AppConfig.userId);}else{if(_this.isConfigMode&&_this.isScreenChange)return;if(_this.options.isForMobile){ScreenManager.applyScreen(EnergyScreen,null,null,null,null,true);}else{ScreenManager.applyScreen(EnergyScreen);}}}).always(function(result){if(_this.isConfigMode&&_this.isScreenChange)return;Spinner.stop();});if(_this.isForReport){var modeType;if(_this.shareLogId){modeType=true;}else{modeType=false;}
var argSkin=AppConfig.chartTheme=='macarons'?'':'?skin=dark';var arrDesc=_this.sharedesc.split(' ');if(parseInt(arrDesc[arrDesc.length-3])!==_this.arrEntityOrder.length){arrDesc[arrDesc.length-3]=_this.arrEntityOrder.length;_this.sharedesc=arrDesc.join(' ');}
var postData={menuId:_this.id+argSkin,mode:modeType,shareLogId:_this.shareLogId,desc:_this.sharedesc};WebAPI.post('/analysis/saveShareLog/'+AppConfig.userId,postData).done(function(result){console.log(result.status);});}},saveLayoutOnly:function saveLayoutOnly(){var _this=this;var arrEntity=[];var entity=null;for(var i=0;i<this.arrEntityOrder.length;i++){entity=this.listEntity[this.arrEntityOrder[i]].entity;if(['ModalObserver','ModalNote','ModalMix','ModalHtml','ModalChartCustom','ModalWeather'].indexOf(entity.modal.type)>-1){arrEntity.push(entity);}else if(entity.modal.type=='ModalPointKPI'){arrEntity.push(this.dealWithEntity(entity));}else if(entity.modal.type=='ModalReportChapter'){if(entity.modal.option&&entity.modal.option.menuId&&entity.modal.option.menuId!=''){arrEntity.push(entity);}}else{if(entity.modal.type!='ModalNone'&&(!entity.modal.points||entity.modal.points.length==0))continue;arrEntity.push(entity);}}
var data={creatorId:AppConfig.userId,menuItemId:this.id,layout:[arrEntity]};this.store.id&&(data.id=this.store.id);Spinner.spin(ElScreenContainer);WebAPI.post('/spring/saveLayout',data).done(function(result){}).always(function(result){Spinner.stop();});},dealWithEntity:function dealWithEntity(entity){entity.modal.points=[];entity.modal.interval=5;entity.modal.option&&entity.modal.option.kpiList&&entity.modal.option.kpiList.forEach(function(kpiItem){traverseTree(kpiItem);});function traverseTree(tree){dealWithNode(tree);traverse(tree,0);}
function traverse(node,i){var children=node.list;if(children!=null&&children.length>0){dealWithNode(children[i]);if(i==children.length-1){for(var j=0;j<children.length;j++){traverse(children[j],0);}}else{traverse(node,i+1);}}}
function dealWithNode(child){delete child.pointPassData;delete child.show;if(child.pointKPI){entity.modal.points.push(child.pointKPI);}
if(child.pointGrade){entity.modal.points.push(child.pointGrade);}
if(child.pointPass){entity.modal.points.push(child.pointPass);}}
return entity;},setEntity:function setEntity(entity){},replaceEntity:function replaceEntity(sourceId,targetId,parentId){if(sourceId==targetId)return;var _this=this;var source=this.listEntity[sourceId];var target=this.listEntity[targetId];source.entity.id=(+new Date()).toString();target.entity.id=(+new Date()+1).toString();this.listEntity[source.entity.id]=source;this.listEntity[target.entity.id]=target;delete this.listEntity[sourceId];delete this.listEntity[targetId];source.initContainer(targetId).configure();target.initContainer(sourceId).configure();this.arrEntityOrder[this.arrEntityOrder.indexOf(targetId)]=source.entity.id;this.arrEntityOrder[this.arrEntityOrder.indexOf(sourceId)]=target.entity.id;if(parentId){this.listEntity[parentId].entity.modal.option.subChartIds.forEach(function(i){if(i.id==sourceId){i.id=target.entity.id;}});this.listEntity[parentId].entity.modal.option.subChartIds.forEach(function(i){if(i.id==targetId){i.id=source.entity.id;}});}
if(source.entity.modal.type=='ModalMix'){source.entity.modal.option&&source.entity.modal.option.subChartIds&&source.entity.modal.option.subChartIds.forEach(function(i){var entity=_this.listEntity[i.id].entity,modelClass,item;modelClass=_this.factoryIoC.getModel(entity.modal.type);_this.container=$('#divContainer_'+source.entity.id).find('.chartsCt')[0];item=new modelClass(_this,entity);item.configure();});}
if(target.entity.modal.type=='ModalMix'&&target.entity.modal.option&&target.entity.modal.option.subChartIds){target.entity.modal.option.subChartIds.forEach(function(i){var entity=_this.listEntity[i.id].entity,modelClass,item;modelClass=_this.factoryIoC.getModel(entity.modal.type);_this.container=$('#divContainer_'+target.entity.id).find('.chartsCt')[0];item=new modelClass(_this,entity);item.configure();});}},rebornEntity:function rebornEntity(entityParams,tragetType,targetTitle,modalNoneEdit){var oldIndex=this.arrEntityOrder.indexOf(entityParams.id);this.removeEntity(entityParams.id);entityParams.modal.type=tragetType;entityParams.modal.title='';var modelClass=this.factoryIoC.getModel(tragetType);if(!entityParams.isNotRender&&entityParams.modal.type!=='ModalMix'&&!modalNoneEdit){entityParams.spanC=modelClass.prototype.optionTemplate.defaultWidth?modelClass.prototype.optionTemplate.defaultWidth:modelClass.prototype.optionTemplate.minWidth;entityParams.spanR=modelClass.prototype.optionTemplate.defaultHeight?modelClass.prototype.optionTemplate.defaultHeight:modelClass.prototype.optionTemplate.minHeight;}
entityParams.spanC=Math.min(entityParams.spanC,modelClass.prototype.optionTemplate.maxWidth);entityParams.spanR=Math.min(entityParams.spanR,modelClass.prototype.optionTemplate.maxHeight);var entity=new modelClass(this,entityParams);this.listEntity[entity.entity.id]=entity;this.arrEntityOrder.splice(oldIndex,0,entity.entity.id);entity.configure();},removeEntity:function removeEntity(id){this.listEntity[id]=null;delete this.listEntity[id];this.arrEntityOrder.splice(this.arrEntityOrder.indexOf(id),1);},render:function render(data){for(var key in this.listEntity){this.listEntity[key].render();}},showConfigMode:function showConfigMode(){this.stop();Spinner.spin(document.getElementById('paneCenter'));for(var key in this.listEntity){this.listEntity[key].configure();}
this.initDataSourcePanel();this.initToolBox();Spinner.stop();},initToolBox:function initToolBox(){var $toolBox=$($('.col-sm-2')[0].children[0]);var $modals=$('<div id="modalCt" class="panel-body">').appendTo($toolBox);var list,template,option,groupList=[];list=this.factoryIoC.getList();for(var ele=0;ele<list.length;ele++){template=list[ele];option=template.prototype.optionTemplate;if(!option)continue;if(option.parent!=null){if(!groupList[option.parent]){groupList[option.parent]=new Array();}
groupList[option.parent].push(option);}}
for(var i=0;i<groupList.length;i++){$modals.append(getModalList(groupList[i]));}
function getModalList(group){var $ul=$('<ul class="nav nav-list accordion-group">');var $liList=$('<li class="rows" style="display: none;">').appendTo($ul);for(var i in group){if(i==0){var $liHd=$('<li class="nav-header">').append('<i class="icon-plus icon-white"></i>'+I18n.findContent(group[i].name)).click(function(){var $otherUl=$(this).parent('ul').siblings('ul');$otherUl.find('.rows').slideUp();$otherUl.find('i').removeClass('icon-minus').addClass('icon-plus');$(this).next('.rows').slideToggle();var $i=$(this).find('i');var toggleClass=function(){if($i.hasClass('icon-minus'))return'icon-plus icon-white';else return'icon-minus icon-white';}();$(this).find('i').removeClass().addClass(toggleClass);});$ul.prepend($liHd);}else{var $div=$('<div class="lyrow ui-draggable" draggable="true"> ').html(I18n.findContent(group[i].name)).attr('type',group[i].type);$div[0].ondragstart=function(e){e.dataTransfer.setData("type",$(this).attr('type'));e.dataTransfer.setData("title",$(this).text());};$liList.append($div);}}
return $ul;}},initDataSourcePanel:function initDataSourcePanel(){this.paneDatasource=new DataSource(this);AppConfig.datasource=this.paneDatasource;this.paneDatasource.show();},hideAnlsPane:function hideAnlsPane(){$('#paneCenter').hide();$('#energyModal').hide();},showAnlsPane:function showAnlsPane(){$('#paneCenter').show();$('#energyModal').show();},getDSItemById:function getDSItemById(datasourceItemId){for(var i=0,len=this.store.datasources[0].list.length;i<len;i++){if(this.store.datasources[0].list[i].id===datasourceItemId){return this.store.datasources[0].list[i];}}
return null;},updateDataSources:function updateDataSources(updateData){this.store.group=updateData;},initReplay:function initReplay(){var _this=this;var $ele=$('#btnDropdownNavList').find('.toolBacktrace');if($ele.length>0){$ele.remove();}
this.toolContainer=$('#divEnergyTools');var btnTimeShaft=$('<li class="iconWrap"><a><span class="glyphicon glyphicon-play-circle"></span><span class="dropdownNav"></span></a></li>').addClass('toolBacktrace');var enterTime;btnTimeShaft.find('.dropdownNav').text(I18n.resource.observer.widgets.BACKTRACE);btnTimeShaft.eventOn('click',function(e){if(_this.isPlayback){_this.quitBacktraceMode(_this,e);if(enterTime){enterTime=new Date()-enterTime;_hmt.push(['_trackEvent','navTool-backTrace-time','click','btnBakTrace-'+AppConfig.projectShowName+'-'+AppConfig.projectId,enterTime/1000]);}}else{_this.enterBacktraceMode(_this,e);enterTime=new Date();_hmt.push(['_trackEvent','navTool-backTrace-enter','click','btnBakTrace-'+AppConfig.projectShowName+'-'+AppConfig.projectId]);}},'');$('#right-nav').find('#btnOperatingRecord').after(btnTimeShaft);if(this.isInDiagnosis)ToolCurrent=new TimeShaftDashboard(_this);},enterBacktraceMode:function enterBacktraceMode(screen,e){var _this=screen?screen:this;_this.isPlayback=true;if(e){e.currentTarget.classList.add('selected');}
if(!ToolCurrent)ToolCurrent=new TimeShaftDashboard(_this);ToolCurrent.containerHeight=100;ToolCurrent.show();if(_this.workerUpdate){_this.workerUpdate.terminate();_this.workerUpdate=null;}
$.when(ToolCurrent.defer).done(function(){var jCanvas=_this.$obCanvasContainer;jCanvas.css({height:'100%',width:'100%'});var jParent=jCanvas.parent();var height=jCanvas.height()-ToolCurrent.containerHeight;var width=jCanvas.width();if(width>jParent.width()){width=jParent.width();height=width/(_this.canvas.width/_this.canvas.height);}
jCanvas.animate({height:height,width:width,marginTop:(jParent.height()-height-ToolCurrent.containerHeight)/2+'px'},400,function(){_this.initScreen();_this.renderElements();_this.initWorkerForUpdating();});});},quitBacktraceMode:function quitBacktraceMode(screen,e){var _this=screen?screen:this;_this.isPlayback=false;if(e){e.currentTarget.classList.remove('selected');}
ToolCurrent.close();ToolCurrent=null;_this.$obCanvasContainer.animate({height:'100%',width:'100%'},300,function(){_this.initScreen();_this.renderElements();_this.initWorkerForUpdating();});},initScreen:function initScreen(){var _this2=this;if(this.isDetailPage){var _this;var dialogWidth;var detailScreenModal;var $toolBacktrace;var oldDialogTitle;var paddingLeft;var paddingTop;(function(){var convertPositionToReal=function convertPositionToReal(arr){if(arr){for(var i=0;i<arr.length;i++){var temp=arr[i];temp.x=temp.x-paddingLeft;temp.y=temp.y-paddingTop;}}};var convertTempDistributionsToReal=function convertTempDistributionsToReal(dis){if(!dis){return;}
dis.x-=paddingLeft;dis.y-=paddingTop;convertPositionToReal(dis.data);};_this=_this2;dialogWidth=_this2.store.page.width+40>$(window).width()?$(window).width()-200:_this2.store.page.width+40;detailScreenModal=$('#detailScreenModal');$toolBacktrace=$('.toolBacktrace');I18n.fillArea($('#detailScreenModal'));$toolBacktrace.remove();if(_this2.dialogTitle){oldDialogTitle=detailScreenModal.find('.modal-title').text();detailScreenModal.find('.modal-title').text(_this2.dialogTitle);}
detailScreenModal.find('.modal-dialog').css("margin","0 auto 0 auto").css("width",dialogWidth);detailScreenModal.off('hidden.bs.modal').on('hidden.bs.modal',function(e){if(ScreenModal){ScreenModal.close();ScreenModal=null;}
_this.initToolBar(tObscreen);Spinner.stop();oldDialogTitle&&$(this).find('.modal-title').text(oldDialogTitle);}).modal({});Spinner.spin(detailScreenModal.find('.modal-body')[0]);paddingLeft=(1920-_this2.store.page.width)/2;paddingTop=(955-_this2.store.page.height)/2;convertPositionToReal(_this2.store.equipments);convertPositionToReal(_this2.store.buttons);convertPositionToReal(_this2.store.texts);convertTempDistributionsToReal(_this2.store.tempDistributions);})();}else{if(ScreenModal&&!this.isInDiagnosis){if(ScreenCurrent)ScreenCurrent.close();ScreenCurrent=ScreenModal;ScreenModal=null;}
if(this.isInDiagnosis)this.diagScreen.obScreen=this;tObscreen=this;$("#page-"+this.id).parent().addClass("active");}},renderElements:function renderElements(){this.dictRefreshMap={};},renderData:function renderData(dataList,curTm,startTm,endTm){var data={};data.dsItemList=dataList;this.refreshDataTrace({data:data,currentTime:curTm,startTime:startTm,endTime:endTm});},initShareIframe:function initShareIframe(shareURL){var strIframe=new StringBuilder();strIframe.append('<div class="modal fade" id="modalShareIframe" style="overflow-y:hidden">');strIframe.append('  <div class="modal-dialog" style="height:95%;width:80%">');strIframe.append('      <div class="modal-content" style="height:100%;">');strIframe.append('          <div class="modal-header" style="height:60px">');strIframe.append('              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>');strIframe.append('              <h4 class="modal-title">'+this.sharedesc+'</h4>');strIframe.append('          </div>');strIframe.append('          <div class="modal-body" id="divShareIframe" style="height:calc(100% - 60px);padding:0">');strIframe.append('              <iframe src="'+shareURL+'" style="height:100%;width:100%;border:none;"></iframe>');strIframe.append('          </div>');strIframe.append('      </div>');strIframe.append('  </div>');strIframe.append('</div>');$('body').append(strIframe.toString());var $modalShareIframe=$('#modalShareIframe');I18n.fillArea($modalShareIframe);$modalShareIframe.modal({show:true});$modalShareIframe.on('hidden.bs.modal',function(e){$modalShareIframe.remove();});}};return EnergyScreen;}();function ModalConfig(){};var ElScreenContainer=document.getElementById('indexMain');var ScreenCurrent=undefined;var ScreenModal=undefined;var ScreenPrevious=undefined;var ToolCurrent=undefined;var Spinner=new LoadingSpinner({color:'#00FFFF'});var AppConfig=AppConfig||{projectId:undefined,projectName:undefined,userId:undefined,account:undefined,level:undefined,projectList:undefined,isMobile:false,chartTheme:'macarons',isFactory:0};var I18n=I18n?I18n:undefined;var BackgroundWorkers={};echarts.config=echarts.config||{color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500']};$(document).ready(function(){var arrParams=document.cookie.split('; '),dictParams={};for(var i=0;i<arrParams.length;i++){var arr=arrParams[i].split('=');if(arr[0]=='params'){dictParams=JSON.parse(eval(arr[1]));break;}}
var lang=navigator.language?navigator.language:navigator.browserLanguage;lang=lang.split('-')[0];lang=dictParams.lang?dictParams.lang:lang;if(dictParams.projectId)AppConfig.projectId=dictParams.projectId;if(dictParams.systemSkin)AppConfig.userId=666;localStorage.setItem("systemSkin_666",dictParams.systemSkin);InitI18nResource(lang).always(function(rs){I18n=new Internationalization(null,rs);if(dictParams.type=='dashboard'){new EnergyScreen(dictParams.pageId).show();}else if(dictParams.type=='report'){var clazz=namespace('observer.screens.FacReportWrapScreen');new clazz({id:dictParams.pageId,default:dictParams.default},'indexContent').show();}});});var EnergyScreen=function(){function EnergyScreen(id,store){if(!id){this.id=ScreenCurrent.id;}else{this.id=id;}
this.factoryIoC=undefined;this.factoryIoCAnalysis=undefined;this.listEntity=undefined;this.mapRefresh={};this.popRefresh={};this.arrEntityOrder=undefined;this.requestPoints=[];this.dictPopToEntity={};this.store=store?store:undefined;this.container=undefined;if(store){this.sharedesc=store.desc;}
this.isForReport=store?true:false;if(this.shareLogId){this.isForReport=true;}
this.isForBencMark=undefined;this.modalConfigPane=undefined;this.isConfigMode=false;this.workerUpdate=undefined;this.paneDatasource=undefined;this.arrColor=echarts.config.color;this.$obCanvasContainer=undefined;this.canvas=undefined;this.toolContainer=undefined;}
EnergyScreen.prototype={show:function show(){this.container=document.getElementById('paneCenter');this.$obCanvasContainer=$(this.container);this.init();},close:function close(){for(var key in this.listEntity){this.listEntity[key].close();}
if(this.workerUpdate)this.workerUpdate.terminate();this.workerUpdate=null;this.factoryIoC=null;this.factoryIoCAnalysis=null;this.listEntity=null;this.arrEntityOrder=null;this.store=null;this.container=null;this.dictPopToEntity=null;this.UNIT_WIDTH=null;this.UNIT_HEIGHT=null;AppConfig.datasource=null;this.paneDatasource&&this.paneDatasource.close&&this.paneDatasource.close();this.$obCanvasContainer=null;this.canvas=null;this.arrColor=null;this.mapRefresh=null;this.modalConfigPane=null;this.popRefresh=null;this.requestPoints=null;this.toolContainer=null;this.isForReport=null;this.isPlayback=null;this.shareLogId=null;},stop:function stop(){if(this.workerUpdate)this.workerUpdate.terminate();},onresize:function onresize(){var entity;for(var key in ScreenCurrent.listEntity){entity=ScreenCurrent.listEntity[key];if(entity.chart)entity.chart.resize();if(entity.entityAnalysis&&entity.entityAnalysis.chart)entity.entityAnalysis.chart.resize();}},init:function init(){var _this=this;Spinner.spin(ElScreenContainer);if(this.store){initByData();Spinner.stop();}else{WebAPI.get("/spring/get/"+this.id).done(function(result){_this.store=result;initByData();}).always(function(e){Spinner.stop();});}
function initByData(){_this.initIoc();_this.initLayout();_this.initWorkerForUpdating();};},initIoc:function initIoc(){this.factoryIoC=new FactoryIoC('compatibleFrame');},initLayout:function initLayout(){this.listEntity={};this.arrEntityOrder=[];if(!this.isForBencMark){var side=new SidebarMenuEffect();side.init('#paneContent');}
I18n.fillArea($('#toolBox'));if(!(this.store&&this.store.layout))return;for(var i=0,item;i<this.store.layout.length;i++){for(var j=0;j<this.store.layout[i].length;j++){item=this.store.layout[i][j];var modelClass,entity;if(item.modal.type&&(item.modal.type!='ModalNone'||item.isNotRender==true)){modelClass=this.factoryIoC.getModel(item.modal.type);if(!modelClass)continue;if(item.isNotRender)continue;entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);if(item.modal.interval&&item.modal.interval>=0&&item.modal.points){for(var k=0,point,kLen=item.modal.points.length;k<kLen;k++){point=item.modal.points[k];if(this.requestPoints.indexOf(point)<0){this.requestPoints.push(point);}}}
entity.render();}else if(item.modal.type=='ModalNone'){modelClass=this.factoryIoC.getModel(item.modal.type);entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);entity.render();}}}},initWorkerForUpdating:function initWorkerForUpdating(){this.workerUpdate=new Worker("/static/app/CompatibleFrame/workerUpdater.js");this.workerUpdate.self=this;this.workerUpdate.addEventListener("message",this.refreshData,true);this.workerUpdate.addEventListener("error",function(e){console.log(e);},true);if(this.requestPoints&&this.requestPoints.length>0){this.workerUpdate.postMessage({pointList:this.requestPoints,type:"datasourceRealtime"});}},refreshData:function refreshData(e){var _this=this.self?this.self:this;if(!e.data.error&&e.data.dsItemList){var point;for(var i=0,iLen=e.data.dsItemList.length;i<iLen;i++){point=e.data.dsItemList[i];_this.mapRefresh[point.dsItemId]=point;if(_this.dictPopToEntity[point.dsItemId]){_this.popRefresh[point.dsItemId]=point;}}
var entity,arrUpdataData;for(var key in _this.listEntity){entity=_this.listEntity[key];if(entity.entity.modal.type=="ModalNone"||entity.entity.modal.type=="ModalMix")continue;arrUpdataData=[];if(entity.entity.modal&&entity.entity.modal.points){for(var i=0,iLen=entity.entity.modal.points.length;i<iLen;i++){var point=entity.entity.modal.points[i];if(!point)continue;if(entity.entity.modal.points.indexOf(point)!=i)continue;if(_this.mapRefresh[point]!=undefined)arrUpdataData.push(_this.mapRefresh[point]);}
if(entity.entity.modal.type=="ModalAppGauge"){arrUpdataData.push({'guageTitle':entity.entity.modal.option.guageTitle,'guageFulTitle':entity.entity.modal.option.guageFulTitle,'guageFixed':entity.entity.modal.option.guageFixed,'guageUnit':entity.entity.modal.option.guageUnit,'timeLocal':entity.entity.modal.option.timeLocal,'guageDirect':entity.entity.modal.option.guageDirect,'guageBgColor':entity.entity.modal.option.guageBgColor,'transDataDot':entity.entity.modal.option.transDataDot});}
entity.entity.modal.popId&&entity.renderPop(_this.popRefresh[entity.entity.modal.popId]);entity.update(arrUpdataData);}}}else{}},render:function render(data){for(var key in this.listEntity){this.listEntity[key].render();}},getDSItemById:function getDSItemById(datasourceItemId){for(var i=0,len=this.store.datasources[0].list.length;i<len;i++){if(this.store.datasources[0].list[i].id===datasourceItemId){return this.store.datasources[0].list[i];}}
return null;},updateDataSources:function updateDataSources(updateData){this.store.group=updateData;}};return EnergyScreen;}();var ModalBase=function(){function ModalBase(parent,entity,_funcRender,_funcUpdate,_funcConfigMode){if(!parent)return;this.screen=parent;this.entity=entity;this.wikis={};this.container=undefined;this.chart=undefined;this.spinner=undefined;this.executeRender=_funcRender;this.executeConfigMode=_funcConfigMode;this.executeUpdate=_funcUpdate;this.hasEdit=false;this.spanRange={};if(this.configModalOptDefault)this.configModalOpt=$.extend(true,{},this.configModalOptDefault);this.initContainer();};ModalBase.prototype={UNIT_WIDTH:100/12,UNIT_HEIGHT:100/6,initContainer:function initContainer(replacedElementId){var divParent=document.getElementById('divContainer_'+this.entity.id);var isNeedCreateDivParent=false;var scrollClass='';if(!divParent||replacedElementId){var isNeedCreateDivParent=true;}
if(isNeedCreateDivParent){divParent=document.createElement('div');divParent.id='divContainer_'+this.entity.id;}
if(replacedElementId){var $old=$('#divContainer_'+replacedElementId);$(divParent).insertAfter($old);$old.remove();}else{isNeedCreateDivParent&&this.screen.container.appendChild(divParent);}
divParent.className='springContainer';if(this.screen.isForMobile){this.spanRange={minWidth:1,maxWidth:3,minHeight:1,maxHeight:4.5};}else{this.spanRange={minWidth:this.optionTemplate.minWidth,maxWidth:this.optionTemplate.maxWidth,minHeight:this.optionTemplate.minHeight,maxHeight:this.optionTemplate.maxHeight};}
if(AppConfig.isMobile){if(this.optionTemplate.scroll===false||this.entity.scroll===false){divParent.className+=' noScroll';}else{divParent.style.height=this.UNIT_HEIGHT*this.entity.spanR*4/3+'%';}
divParent.style.width=this.UNIT_WIDTH*this.entity.spanC*4+'%';if(this.UNIT_WIDTH*this.entity.spanC*4>100){divParent.style.width='100%';}}else{divParent.style.height=this.UNIT_HEIGHT*this.entity.spanR+'%';divParent.style.width=this.UNIT_WIDTH*this.entity.spanC+'%';}
if(['ModalNote','ModalMix'].indexOf(this.entity.modal.type)>-1){scrollClass=' gray-scrollbar scrollY';}
if(this.entity.modal.title&&this.entity.modal.title!=''&&!this.entity.isNotRender){divParent.innerHTML='<div class="panel panel-default">\
                    <div class="panel-heading springHead">\
                        <h3 class="panel-title" style="font-weight: bold;">'+this.entity.modal.title+'</h3>\
                    </div>\
                    <div class="panel-body springContent'+scrollClass+'" style="position: relative;"></div>\
                </div>';}else{divParent.innerHTML='<div class="panel panel-default">\
                    <span class="springSeHead fontTemp6">'+this.entity.modal.title+'</span>\
                    <div class="panel-body springContent'+scrollClass+'" style="position: relative;height:100%;"></div>\
                </div>';}
this.container=divParent.getElementsByClassName('springContent')[0];if(this.entity.modal.type!=='ModalMix'&&this.entity.modal.type!=='ModalAppBlind'&&this.entity.modal.type!=='ModalAppPie'){this.spinner=new LoadingSpinner({color:'#00FFFF'});this.spinner.spin(this.container);}
return this;},initToolTips:function initToolTips(parent){var _this=this;if(!parent)return;var descTip=new StringBuilder();descTip.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:300px;">');descTip.append('    <div class="tooltipTitle tooltip-inner" style="display:none">GeneralRegressor</div>');descTip.append('    <div class="tooltipContent" style="border:1px solid black">');descTip.append('        <p class="containerDesc" style="word-break:break-all;"><span style="font-weight:bold">').append(_this.entity.modal.desc).append('</span> ').append('</p>');descTip.append('    </div>');descTip.append('    <div class="tooltip-arrow"></div>');descTip.append('</div>');var options={placement:'bottom',title:_this.entity.modal.title,template:descTip.toString()};if(_this.entity.modal.desc&&_this.entity.modal.desc!=''){$(parent).tooltip(options);}},render:function render(){try{this.executeRender();}catch(e){console.warn(e);}
if(this.chart){this.chart.on('resize',function(param){this.resize();});}},update:function update(options){var modal,dsChartConfig,accuracy;var num,specialCond;if(!options||options.length==0)return;modal=this.entity.modal;dsChartConfig=modal.dsChartCog&&modal.dsChartCog.length?modal.dsChartCog[0]:{};accuracy=dsChartConfig.accuracy;if(accuracy!==''&&!isNaN(accuracy)){specialCond=['',null,undefined];options=options.map(function(row,i){if(specialCond.indexOf(row.data)>-1||isNaN(row.data)){return row;}else{num=+row.data;row.data=num.toFixed(accuracy);return row;}});}
try{this.executeUpdate(options);}catch(e){console.warn(e);}},configure:function configure(){this.spinner&&this.spinner.stop();var _this=this;if(this.chart)this.chart.clear();this.divResizeByMouseInit();var divMask=document.createElement('div');divMask.className='springConfigMask';divMask.draggable='true';if(this.entity.modal.type!='ModalAnalysis'||!this.screen.isForReport){var btnConfig=document.createElement('span');btnConfig.className='glyphicon glyphicon-cog springConfigBtn grow';btnConfig.title='Options';btnConfig.onclick=btnConfig_clickEvent;divMask.appendChild(btnConfig);}
var btnRemove=document.createElement('span');btnRemove.className='glyphicon glyphicon-remove-circle springConfigRemoveBtn grow';btnRemove.title='Remove';btnRemove.onclick=function(e,callback){confirm('Are you sure you want to delete it ?',function(){if(_this.chart)_this.chart.clear();if(_this.screen.screen){_this.screen.screen.removeEntity(_this.entity.id);}else{_this.screen.removeEntity(_this.entity.id);}
$('#divContainer_'+_this.entity.id).remove();_this.screen.isScreenChange=true;_this=null;callback&&callback(true);});};divMask.appendChild(btnRemove);var btnHeightResize=document.createElement('div');var maxHeight=this.spanRange.maxHeight;var maxWidth=this.spanRange.maxWidth;var minHeight=this.spanRange.minHeight;var minWidth=this.spanRange.minWidth;btnHeightResize.className='divResize divHeightResize';btnHeightResize.innerHTML='<label for="heightResize" >H: </label>'+'<input type="range" class="inputResize" id="heightResize" name="points" step="0.5" min="'+minHeight+'" max="'+maxHeight+'" value="'+_this.entity.spanR+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanR+' /'+_this.spanRange.maxHeight+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanR+'"/>';divMask.appendChild(btnHeightResize);var btnWidthResize=document.createElement('div');btnWidthResize.className='divResize divWidthResize';btnWidthResize.innerHTML='<label for="widthResize" >W: </label>'+'<input type="range" class="inputResize" id="widthResize" name="points" step="0.5" min="'+minWidth+'" max="'+maxWidth+'" value="'+_this.entity.spanC+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanC+' /'+_this.spanRange.maxWidth+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanC+'"/>';divMask.appendChild(btnWidthResize);var divTitleAndType=document.createElement('div');divTitleAndType.className='divTitleAndType';divMask.appendChild(divTitleAndType);var $divTitle=$('<div class="divResize chartTitle">');var $labelTitle=$('<label for="title">').text(I18n.resource.dashboard.show.TITLE);var inputChartTitle=document.createElement('input');inputChartTitle.id='title';inputChartTitle.className='form-control';inputChartTitle.value=this.entity.modal.title;inputChartTitle.setAttribute('placeholder',I18n.resource.dashboard.show.TITLE_TIP);if(this.entity.modal.title!=''){inputChartTitle.style.display='none';}
inputChartTitle.setAttribute('type','text');$divTitle.append($labelTitle).append($(inputChartTitle));divTitleAndType.appendChild($divTitle[0]);var $divType=$('<div class="divResize chartType">');var $labelType=$('<label>').text(I18n.resource.dashboard.show.TYPE);var chartType=document.createElement('span');chartType.innerHTML=I18n.findContent(this.optionTemplate.name);$divType.append($labelType).append($(chartType));divTitleAndType.appendChild($divType[0]);if(!(this instanceof ModalAnalysis)){var $divLink=$('<div class="divResize chartLink">');var $labelLink=$('<label>').text(I18n.resource.dashboard.show.LINK_TO);var chartLink=document.createElement('select');chartLink.className='form-control';chartLink.options.add(new Option(I18n.resource.dashboard.show.SELECT_LINK,''));for(var i in AppConfig.menu){var option=new Option(AppConfig.menu[i],i);if(this.entity.modal.link==i){option.selected='selected';}
chartLink.options.add(option);}
chartLink.onchange=function(){_this.entity.modal.link=chartLink.value;_this.screen.isScreenChange=true;};$divLink.append($labelLink).append($(chartLink));divMask.appendChild($divLink[0]);}
var chartTitleShow=document.createElement('p');chartTitleShow.innerHTML=inputChartTitle.value;chartTitleShow.className='chartTitleShow';$divTitle[0].appendChild(chartTitleShow);if(this.entity.modal.title==''||this.entity.modal.title==undefined){chartTitleShow.style.display='none';}
chartTitleShow.onclick=function(){chartTitleShow.style.display='none';inputChartTitle.style.display='inline-block';inputChartTitle.focus();};inputChartTitle.onchange=function(){if(inputChartTitle.value!=''){inputChartTitle.style.display='none';chartTitleShow.style.display='inline';}
chartTitleShow.innerHTML=inputChartTitle.value;_this.entity.modal.title=inputChartTitle.value;_this.screen.isScreenChange=true;};this.container.parentNode.appendChild(divMask);if(this.entity.isNotRender){var parentId=undefined,subChartIds;if(this.screen.entity&&this.screen.entity.id){parentId=this.screen.entity.id;}
if(this.screen.store&&this.screen.store.layout[0]){for(var i=0,len=this.screen.store.layout[0].length,entity;i<len;i++){entity=this.screen.store.layout[0][i];if(entity.modal.type=='ModalMix'&&entity.modal.option.subChartIds&&entity.modal.option.subChartIds.length>0){subChartIds=entity.modal.option.subChartIds;for(var j=0,l=subChartIds.length;j<l;j++){if(subChartIds[j].id==this.entity.id){parentId=entity.id;break;}}}
if(entity.modal.type=='ModalAppBlind'){if(!entity.modal.option)break;if(entity.modal.option.length>0&&entity.modal.option[0].subChartIds.length>0){var opts=entity.modal.option;for(var m=0;m<opts.length;m++){if(opts[m].subChartIds[0].id===this.entity.id){parentId=entity.id;break;}}}}}}
if(parentId){if(this.container.parentNode.parentNode.parentNode.className.indexOf('chartsCt')>=0)return;$(document.getElementById('divContainer_'+parentId)).find('.chartsCt')[0].appendChild(this.container.parentNode.parentNode);}}
this.divResizeByToolInit();function btnConfig_clickEvent(e){$('.springSel').removeClass('springSel');$(e.target).closest('.springContainer').addClass('springSel');_this.modalInit();}
var divContainer=$(this.container).closest('.springContainer')[0];divMask.ondragstart=function(e){e.dataTransfer.setData("id",$(e.target).closest('.springContainer').get(0).id.replace('divContainer_',''));};divMask.ondragover=function(e){e.preventDefault();};divMask.ondragleave=function(e){e.preventDefault();};divContainer.ondrop=function(e){e.stopPropagation();var sourceId=e.dataTransfer.getData("id");var $sourceParent,$targetParent;if(sourceId){var targetId=$(e.target).closest('.springContainer').get(0).id.replace('divContainer_','');$sourceParent=$('#divContainer_'+sourceId).parent();$targetParent=$('#divContainer_'+targetId).parent();if(!$sourceParent[0].classList.contains('chartsCt')&&$targetParent[0].classList.contains('chartsCt')){_this.screen.insertChartIntoMix(sourceId,$(e.target).closest('.chartsCt')[0]);}else{if(_this.screen.screen){_this.screen.screen.replaceEntity(sourceId,targetId,_this.screen.entity.id);}else{_this.screen.replaceEntity(sourceId,targetId);}}}
_this.screen.isScreenChange=true;};this.executeConfigMode();},modalInit:function modalInit(){var _this=this;var dataItem=[],option;var dataTypeUnit;var type=false;if(_this.entity.modal.points!=undefined){if(_this.entity.modal.option&&_this.entity.modal.option.paraType){for(var i=0;i<_this.entity.modal.option.paraType.length;i++){dataTypeUnit={dsId:[],dsType:'',dsName:[]};dataTypeUnit.type=_this.entity.modal.option.paraType[i].type;var arrId=[];var arrItem=[];for(var j=0;j<_this.entity.modal.option.paraType[i].arrId.length;j++){arrId.push(_this.entity.modal.option.paraType[i].arrId[j]);}
arrItem=AppConfig.datasource.getDSItemById(arrId);for(var j=0;j<_this.entity.modal.option.paraType[i].arrId.length;j++){var id=_this.entity.modal.option.paraType[i].arrId[j];for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){dataTypeUnit.dsId.push(id);dataTypeUnit.dsName.push(arrItem[m].alias);break;}}}
dataItem.push(dataTypeUnit);}}else{dataTypeUnit={dsId:[],dsType:'',dsName:[]};var arrId=[];var arrItem=[];for(var i=0;i<_this.entity.modal.points.length;i++){arrId.push(_this.entity.modal.points[i]);}
arrItem=AppConfig.datasource.getDSItemById(arrId);for(var i=0;i<_this.entity.modal.points.length;i++){var id=_this.entity.modal.points[i];for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){dataTypeUnit.dsId.push(id);dataTypeUnit.dsName.push(arrItem[m].alias===""?arrItem[m].value:arrItem[m].alias);break;}}}
dataItem.push(dataTypeUnit);}}
if(_this.optionTemplate.mode==='custom'){_this.showConfigModal&&_this.showConfigModal();return;}
if(_this.optionTemplate.type==='ModalReportChapter'){_this.showConfigModal();return;}
if(_this.optionTemplate.type==='ModalMonitor'){_this.showConfigModal();return;}
if(_this.optionTemplate.type==='ModalAppButton'){_this.showConfigModal();return;}
if(_this.optionTemplate.type==='ModalAppKPICollect'){_this.showConfigModal();return;}
if(_this.optionTemplate.type==='ModalReportFactory'){_this.showConfigModal();return;}
var tempOptionPara;_this.entity.modal.option?tempOptionPara=_this.entity.modal.option:tempOptionPara={};tempOptionPara.dataItem=dataItem;option={modeUsable:_this.optionTemplate.mode,allDataNeed:_this.optionTemplate.modelParams?_this.optionTemplate.modelParams.paraAnlysMode:true,rowDataType:_this.optionTemplate.modelParams?_this.optionTemplate.modelParams.paraName:[I18n.resource.analysis.paneConfig.DATA_TYPE_DEFAULT],rowDataTypeShowName:_this.optionTemplate.modelParams?_this.optionTemplate.modelParams.paraShowName:undefined,dataTypeMaxNum:[_this.optionTemplate.maxNum],templateType:_this.optionTemplate.type,dsChartCog:_this.entity.modal.dsChartCog?_this.entity.modal.dsChartCog:null,optionPara:tempOptionPara};if(dataItem.length==0){type=true;}
if(_this.screen.screen){_this.screen.screen.modalConfigPane.showModalInit(type,option,_this);}else{_this.screen.modalConfigPane.showModalInit(type,option,_this);}
_this.screen.isScreenChange=true;},showConfigModal:function showConfigModal(){this.initConfigModalOpt();var ctn=this.screen.container.querySelector('.cfgModal');this.configModal=new ConfigModal(this.configModalOpt,ctn?ctn:this.screen.container);this.configModal.init();this.configModal.show();},initConfigModalOpt:function initConfigModalOpt(){var _this=this;this.configModalOpt.result.func=function(option){_this.setModalOption(option);_this.render();};},setModalOption:function setModalOption(option){},divResizeByToolInit:function divResizeByToolInit(){var _this=this;var $divContainer=$('#divContainer_'+_this.entity.id);var $divResize=$('.divResize');var $inputResize=$('.inputResize');$divContainer.find('#heightResize').mousedown(function(e){$('.springConfigMask').attr('draggable','false');$('.springContent').attr('draggable','false');$(e.target).mousemove(function(e){$(e.target).closest('.springContainer').css('height',$(e.target).val()*_this.UNIT_HEIGHT+'%');_this.entity.spanR=Number($(e.target).val());$(e.target).next().text($(e.target).val()+' /'+_this.spanRange.maxHeight);if(_this.screen.screen){_this.screen.screen.setEntity(_this.entity);}else{_this.screen.setEntity(_this.entity);}});}).mouseup(function(e){$('.springConfigMask').attr('draggable','true');$('.springContent').attr('draggable','true');$(e.target).off('mousemove');if(_this.chart)_this.chart.resize();_this.screen.isScreenChange=true;_this.hasEdit=true;});$divContainer.find('#widthResize').mousedown(function(e){$('.springConfigMask').attr('draggable','false');$('.springContent').attr('draggable','false');$(e.target).mousemove(function(e){$(e.target).closest('.springContainer').css('width',$(e.target).val()*_this.UNIT_WIDTH+'%');_this.entity.spanC=Number($(e.target).val());$(e.target).next().text($(e.target).val()+' /'+_this.spanRange.maxWidth);if(_this.screen.screen){_this.screen.screen.setEntity(_this.entity);}else{_this.screen.setEntity(_this.entity);}});}).mouseup(function(e){$('.springConfigMask').attr('draggable','true');$('.springContent').attr('draggable','true');$(e.target).off('mousemove');if(_this.chart)_this.chart.resize();_this.screen.isScreenChange=true;_this.hasEdit=true;});$divContainer.find('.rangeVal').click(function(e){e.stopPropagation();var valueCurrent=Number($(e.target).prev().val());var valuePre=$(e.target).prev().val();var valueMax=Number($(e.target).prevAll('.inputResize').attr('max'));var valueMin=Number($(e.target).prevAll('.inputResize').attr('min'));$(e.target).nextAll('.rangeChange').css('display','inline-block').focus().off('blur').blur(function(e){valueCurrent=Number($(e.target).val());if(valueCurrent<=valueMax&&valueCurrent>=valueMin){$(e.target).prevAll('.inputResize').val(valueCurrent.toString());if($(e.target).prevAll('.inputResize').attr('id')=='widthResize'){$(e.target).closest('.springContainer').css('width',$(e.target).val()*_this.UNIT_WIDTH+'%');_this.entity.spanC=Number($(e.target).val());_this.screen.setEntity(_this.entity);$(e.target).prev().text($(e.target).val()+' /'+_this.spanRange.maxWidth);if(_this.chart)_this.chart.resize();_this.hasEdit=true;}else{$(e.target).closest('.springContainer').css('height',$(e.target).val()*_this.UNIT_HEIGHT+'%');_this.entity.spanR=Number($(e.target).val());_this.screen.setEntity(_this.entity);$(e.target).prev().text($(e.target).val()+' /'+_this.spanRange.maxHeight);if(_this.chart)_this.chart.resize();_this.hasEdit=true;}
$(e.target).css('display','none');}else if(valueCurrent>valueMax){new Alert($('#resizeAlert'),"danger","<strong>"+I18n.resource.dashboard.resize.ERR1+"</strong>").show().close();$(e.target).val(valuePre).css('display','none');}else if(valueCurrent<valueMin){new Alert($('#resizeAlert'),"danger","<strong>"+I18n.resource.dashboard.resize.ERR2+"</strong>").show().close();$(e.target).val(valuePre).css('display','none');}else{if($(e.target).val()!=""){new Alert($('#resizeAlert'),"danger","<strong>"+I18n.resource.dashboard.resize.ERR3+"</strong>").show().close();}
$(e.target).val(valuePre).css('display','none');}
_this.hasEdit&&(_this.screen.isScreenChange=true);});});},divResizeByMouseInit:function divResizeByMouseInit(){var _this=this;var $widthResize;var $heightResize;var divContainer=$('#divContainer_'+_this.entity.id).get(0);var resizeOnRight=document.createElement('div');resizeOnRight.className='resizeOnRight';divContainer.appendChild(resizeOnRight);var resizeOnBottom=document.createElement('div');resizeOnBottom.className='resizeOnBottom';divContainer.appendChild(resizeOnBottom);var resizeOnCorner=document.createElement('div');resizeOnCorner.className='resizeOnCorner';divContainer.appendChild(resizeOnCorner);var mouseStart={};var divStart={};var rightStart={};var bottomStart={};var w,h,tempSpanR,tempSpanC;resizeOnRight.onmousedown=function(e){e.stopPropagation();if(e.button!=0)return;var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',false);}
$(e.target).prev().children(':last-child').attr('draggable',false);$widthResize=$(e.target).parent().find('#widthResize');var oEvent=e||event;mouseStart.x=oEvent.clientX;mouseStart.y=oEvent.clientY;rightStart.x=resizeOnRight.offsetLeft;doResizeOnRight(e);if(resizeOnRight.setCapture){resizeOnRight.onmousemove=doResizeOnRight;resizeOnRight.onmouseup=stopResizeOnRight;resizeOnRight.setCapture();}else{document.addEventListener("mousemove",doResizeOnRight,false);document.addEventListener("mouseup",stopResizeOnRight,false);}};function doResizeOnRight(e){var oEvent=e||event;var l=oEvent.clientX-mouseStart.x+rightStart.x;w=l+resizeOnCorner.offsetWidth;if(w<resizeOnCorner.offsetWidth){w=resizeOnCorner.offsetWidth;}else if(w>document.documentElement.clientWidth-divContainer.offsetLeft){w=document.documentElement.clientWidth-divContainer.offsetLeft-2;}
divContainer.style.width=w+"px";}
function stopResizeOnRight(e){if(resizeOnRight.releaseCapture){tempSpanC=parseInt(w*100/(divContainer.parentNode.clientWidth*_this.UNIT_WIDTH));rangeJudge();$widthResize.val(tempSpanC.toString());$widthResize.next().text(tempSpanC.toString()+' /'+_this.spanRange.maxWidth);$widthResize.next().next().val(tempSpanC.toString());divContainer.style.width=tempSpanC*_this.UNIT_WIDTH+"%";_this.entity.spanC=tempSpanC;resizeOnRight.onmousemove=null;resizeOnRight.onmouseup=null;resizeOnRight.releaseCapture();if(_this.chart)_this.chart.resize();_this.hasEdit=true;}else{tempSpanC=parseInt(w*100/(divContainer.parentNode.clientWidth*_this.UNIT_WIDTH));rangeJudge();$widthResize.val(tempSpanC.toString());$widthResize.next().text(tempSpanC.toString()+' /'+_this.spanRange.maxWidth);$widthResize.next().next().val(tempSpanC.toString());divContainer.style.width=tempSpanC*_this.UNIT_WIDTH+"%";_this.entity.spanC=tempSpanC;document.removeEventListener("mousemove",doResizeOnRight,false);document.removeEventListener("mouseup",stopResizeOnRight,false);if(_this.chart)_this.chart.resize();_this.hasEdit=true;}
_this.screen.isScreenChange=true;$(e.target).prev().children(':last-child').attr('draggable',true);var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',true);}}
resizeOnBottom.onmousedown=function(e){e.stopPropagation();if(e.button!=0)return;var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',false);}
$(e.target).prev().children(':last-child').attr('draggable',false);$heightResize=$(e.target).parent().find('#heightResize');var oEvent=e||event;mouseStart.x=oEvent.clientX;mouseStart.y=oEvent.clientY;bottomStart.y=resizeOnBottom.offsetTop;doResizeOnBottom(e);if(resizeOnBottom.setCapture){resizeOnBottom.onmousemove=doResizeOnBottom;resizeOnBottom.onmouseup=stopResizeOnBottom;resizeOnBottom.setCapture();}else{document.addEventListener("mousemove",doResizeOnBottom,false);document.addEventListener("mouseup",stopResizeOnBottom,false);}};function doResizeOnBottom(e){var oEvent=e||event;var t=oEvent.clientY-mouseStart.y+bottomStart.y;h=t+resizeOnCorner.offsetHeight;if(h<resizeOnCorner.offsetHeight){h=resizeOnCorner.offsetHeight;}else if(h>document.documentElement.clientHeight-divContainer.offsetTop){h=document.documentElement.clientHeight-divContainer.offsetTop-2;}
divContainer.style.height=h+"px";}
function stopResizeOnBottom(e){if(resizeOnBottom.releaseCapture){tempSpanR=parseInt(h*100/(divContainer.parentNode.clientHeight*_this.UNIT_HEIGHT));rangeJudge();$heightResize.val(tempSpanR.toString());$heightResize.next().text(tempSpanR.toString()+' /'+_this.spanRange.maxHeight);$heightResize.next().next().val(tempSpanR.toString());divContainer.style.height=tempSpanR*_this.UNIT_HEIGHT+"%";_this.entity.spanR=tempSpanR;resizeOnBottom.onmousemove=null;resizeOnBottom.onmouseup=null;resizeOnBottom.releaseCapture();if(_this.chart)_this.chart.resize();_this.hasEdit=true;}else{tempSpanR=parseInt(h*100/(divContainer.parentNode.clientHeight*_this.UNIT_HEIGHT));rangeJudge();$heightResize.val(tempSpanR.toString());$heightResize.next().text(tempSpanR.toString()+' /'+_this.spanRange.maxHeight);$heightResize.next().next().val(tempSpanR.toString());divContainer.style.height=tempSpanR*_this.UNIT_HEIGHT+"%";_this.entity.spanR=tempSpanR;document.removeEventListener("mousemove",doResizeOnBottom,false);document.removeEventListener("mouseup",stopResizeOnBottom,false);if(_this.chart)_this.chart.resize();_this.hasEdit=true;}
_this.screen.isScreenChange=true;$(e.target).prev().children(':last-child').attr('draggable',true);var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',true);}}
resizeOnCorner.onmousedown=function(e){e.stopPropagation();if(e.button!=0)return;var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',false);}
$(e.target).prev().children(':last-child').attr('draggable',false);$widthResize=$(e.target).parent().find('#widthResize');$heightResize=$(e.target).parent().find('#heightResize');var oEvent=e||event;mouseStart.x=oEvent.clientX;mouseStart.y=oEvent.clientY;divStart.x=resizeOnCorner.offsetLeft;divStart.y=resizeOnCorner.offsetTop;doResizeOnCorner(e);if(resizeOnCorner.setCapture){resizeOnCorner.onmousemove=doResizeOnCorner;resizeOnCorner.onmouseup=stopResizeOnCorner;resizeOnCorner.setCapture();}else{document.addEventListener("mousemove",doResizeOnCorner,false);document.addEventListener("mouseup",stopResizeOnCorner,false);}};function doResizeOnCorner(e){var oEvent=e||event;var l=oEvent.clientX-mouseStart.x+divStart.x;var t=oEvent.clientY-mouseStart.y+divStart.y;w=l+resizeOnCorner.offsetWidth;h=t+resizeOnCorner.offsetHeight;if(w<resizeOnCorner.offsetWidth){w=resizeOnCorner.offsetWidth;}else if(w>document.documentElement.clientWidth-divContainer.offsetLeft){w=document.documentElement.clientWidth-divContainer.offsetLeft-2;}
if(h<resizeOnCorner.offsetHeight){h=resizeOnCorner.offsetHeight;}else if(h>document.documentElement.clientHeight-divContainer.offsetTop){h=document.documentElement.clientHeight-divContainer.offsetTop-2;}
divContainer.style.width=w+"px";divContainer.style.height=h+"px";}
function stopResizeOnCorner(e){if(resizeOnCorner.releaseCapture){tempSpanC=parseInt(w*100/(divContainer.parentNode.clientWidth*_this.UNIT_WIDTH));tempSpanR=parseInt(h*100/(divContainer.parentNode.clientHeight*_this.UNIT_HEIGHT));rangeJudge();$widthResize.val(tempSpanC.toString()).get(0).setAttribute('value',tempSpanC.toString());$widthResize.next().text(tempSpanC.toString()+' /'+_this.spanRange.maxWidth);$widthResize.next().next().val(tempSpanC.toString());$heightResize.val(tempSpanR.toString()).get(0).setAttribute('value',tempSpanR.toString());$heightResize.next().text(tempSpanR.toString()+' /'+_this.spanRange.maxHeight);$heightResize.next().next().val(tempSpanR.toString());divContainer.style.width=tempSpanC*_this.UNIT_WIDTH+"%";divContainer.style.height=tempSpanR*_this.UNIT_HEIGHT+"%";_this.entity.spanC=tempSpanC;_this.entity.spanR=tempSpanR;resizeOnCorner.onmousemove=null;resizeOnCorner.onmouseup=null;resizeOnCorner.releaseCapture();if(_this.chart)_this.chart.resize();_this.hasEdit=true;}else{tempSpanC=parseInt(w*100/(divContainer.parentNode.clientWidth*_this.UNIT_WIDTH));tempSpanR=parseInt(h*100/(divContainer.parentNode.clientHeight*_this.UNIT_HEIGHT));rangeJudge();$widthResize.val(tempSpanC.toString());$widthResize.next().text(tempSpanC.toString()+' /'+_this.spanRange.maxWidth);$widthResize.next().next().val(tempSpanC.toString());$heightResize.val(tempSpanR.toString());$heightResize.next().text(tempSpanR.toString()+' /'+_this.spanRange.maxHeight);$heightResize.next().next().val(tempSpanR.toString());divContainer.style.width=tempSpanC*_this.UNIT_WIDTH+"%";divContainer.style.height=tempSpanR*_this.UNIT_HEIGHT+"%";_this.entity.spanC=tempSpanC;_this.entity.spanR=tempSpanR;document.removeEventListener("mousemove",doResizeOnCorner,false);document.removeEventListener("mouseup",stopResizeOnCorner,false);if(_this.chart)_this.chart.resize();_this.hasEdit=true;}
_this.screen.isScreenChange=true;var $possibleParent=$(e.target).closest('.springConfigMask');if($possibleParent.length>0){$possibleParent.attr('draggable',true);}
$(e.target).prev().children(':last-child').attr('draggable',true);}
function rangeJudge(){if(tempSpanC>_this.spanRange.maxWidth){tempSpanC=_this.spanRange.maxWidth;}else if(tempSpanC<_this.spanRange.minWidth){tempSpanC=_this.spanRange.minWidth;}
if(tempSpanR>_this.spanRange.maxHeight){tempSpanR=_this.spanRange.maxHeight;}else if(tempSpanR<_this.spanRange.minHeight){tempSpanR=_this.spanRange.minHeight;}}},initPointAlias:function initPointAlias(arrPoints){var arrPointsAlias=[];var lastRepeatIndex=-1;var tempAlias;var repeatNum=0;var tempIndex;var arrId=[];var arrItem=[];for(var i=0;i<arrPoints.length;++i){arrId.push(arrPoints[i].dsItemId);}
arrItem=AppConfig.datasource.getDSItemById(arrId);for(var i=0;i<arrPoints.length;++i){for(var m=0;m<arrItem.length;m++){if(arrPoints[i].dsItemId==arrItem[m].id){arrPointsAlias.push(arrItem[m].alias);break;}}}
for(var i=0;i<arrPoints.length;++i){lastRepeatIndex=arrPointsAlias.lastIndexOf(arrPointsAlias[i]);if(lastRepeatIndex>i){repeatNum=1;tempAlias=arrPointsAlias[i];arrPointsAlias[i]=tempAlias+'_No1';tempIndex=i;for(var j=tempIndex+1;j<lastRepeatIndex+1;j++){repeatNum+=1;tempIndex=arrPointsAlias.indexOf(tempAlias);if(tempIndex==-1)break;arrPointsAlias[tempIndex]=tempAlias+'_No'+repeatNum;}}}
return arrPointsAlias;},close:function close(){if(this.chart){this.chart.dispose();}
this.container=null;this.entity=null;this.executeConfigMode=null;this.executeRender=null;this.executeUpdate=null;this.screen=null;this.isConfigMode=null;this.reportScreen=null;typeof this._close==='function'&&this._close();},renderPop:function renderPop(pop){if(!pop)return;var $target=$('#divContainer_'+this.entity.id).find('.panel');var $panePop=$target.find('.panePop');var tpl='<div class="divMove"><span>{popMsg}</span></div>\
                <span class="glyphicon glyphicon-remove-circle btnClosePop" title="Close"></span>';if(!$panePop[0]){$panePop=$('<div class="panel-body panePop"></div>');$target.append($panePop);}
$panePop.html(tpl.formatEL({popMsg:pop.data}));var spanWidth=$panePop.find('span').width();var $divMove=$panePop.find('.divMove');if(spanWidth>$divMove.width()){var $marquee=$('<marquee direction="left" onmouseover="this.stop()" onmouseout="this.start()" scrollAmount="3" style="height: 40px; width: calc(100% - 28px);"></marquee>');$marquee.html($panePop.find('span').html());$marquee.appendTo($panePop);$divMove.remove();}
$panePop.find('.btnClosePop').off().click(function(){$panePop.hide();});}};return ModalBase;}();var ModalNone=function(){function ModalNone(screen,entityParams,replacedElementId){ModalBase.call(this,screen,entityParams,this.renderModal,null,null,null,replacedElementId);}
ModalNone.prototype=new ModalBase();ModalNone.prototype.optionTemplate={name:'',mode:['realTime'],maxNum:1,title:'',minHeight:1,minWidth:2,maxHeight:6,maxWidth:12,type:'ModalNone'};ModalNone.prototype.renderModal=function(){I18n.fillArea($('#coalSaveName').parent());$(this.container).parent().css('visibility','hidden');this.spinner.stop();},ModalNone.prototype.configure=function(){this.spinner.stop();var _this=this;$(_this.container).parent().css('visibility','');var divAdd=document.createElement('span');divAdd.className='springConfigTips';divAdd.innerHTML='Drag data meta from left panel';this.container.appendChild(divAdd);var btnRemove=document.createElement('span');btnRemove.className='glyphicon glyphicon-remove-circle springConfigRemoveBtn grow';btnRemove.title='Remove';btnRemove.onclick=function(e){if(_this.chart)_this.chart.clear();if(_this.screen.screen){_this.screen.screen.removeEntity(_this.entity.id);}else{_this.screen.removeEntity(_this.entity.id);}
$('#divContainer_'+_this.entity.id).remove();_this=null;};this.container.appendChild(btnRemove);var btnHeightResize=document.createElement('div');if(AppConfig.isMobile||this.screen.isForMobile||this.screen.options&&this.screen.options.isForMobile||this.screen.screen&&this.screen.screen.options&&this.screen.screen.options.isForMobile){this.entity.spanC=this.optionTemplate.maxWidth=this.optionTemplate.minWidth=3;this.optionTemplate.maxHeight=4.5;this.entity.spanR>this.optionTemplate.maxHeight&&(this.entity.spanR=this.optionTemplate.maxHeight);}
var maxHeight=this.optionTemplate.maxHeight;var maxWidth=this.optionTemplate.maxWidth;var minHeight=this.optionTemplate.minHeight;var minWidth=this.optionTemplate.minWidth;btnHeightResize.className='divResize divHeightResize';btnHeightResize.innerHTML='<label for="heightResize" >H: </label>'+'<input type="range" class="inputResize" id="heightResize" name="points" step="0.5" min="'+minHeight+'" max="'+maxHeight+'" value="'+_this.entity.spanR+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanR+' /'+maxHeight+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanR+'"/>';this.container.appendChild(btnHeightResize);var btnWidthResize=document.createElement('div');btnWidthResize.className='divResize divWidthResize';btnWidthResize.innerHTML='<label for="widthResize" >W: </label>'+'<input type="range" class="inputResize" id="widthResize" name="points" step="0.5" min="'+minWidth+'" max="'+maxWidth+'" value="'+_this.entity.spanC+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanC+' /'+maxWidth+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanC+'"/>';this.container.appendChild(btnWidthResize);this.divResizeByMouseInit();this.divResizeByToolInit();if(this.entity.isNotRender&&this.screen.entity){$(document.getElementById('divContainer_'+this.screen.entity.id)).find('.chartsCt')[0].appendChild(this.container.parentNode.parentNode);}
if(this.entity.isNotRender){var parentId=undefined,subChartIds;if(this.screen.entity&&this.screen.entity.id){parentId=this.screen.entity.id;}
if(this.screen.store&&this.screen.store.layout[0]){for(var i=0,len=this.screen.store.layout[0].length,entity;i<len;i++){entity=this.screen.store.layout[0][i];if(entity.modal.type=='ModalMix'&&entity.modal.option.subChartIds&&entity.modal.option.subChartIds.length>0){subChartIds=entity.modal.option.subChartIds;for(var j=0,l=subChartIds.length;j<l;j++){if(subChartIds[j].id==this.entity.id){parentId=entity.id;break;}}}
if(entity.modal.type=='ModalAppBlind'&&entity.modal.option&&entity.modal.option.length>0&&entity.modal.option[0].subChartIds.length>0){var opts=entity.modal.option;for(var m=0;m<opts.length;m++){if(opts[m].subChartIds[0].id===this.entity.id){parentId=entity.id;break;}}}}}
if(parentId){$(document.getElementById('divContainer_'+parentId)).find('.chartsCt')[0].appendChild(this.container.parentNode.parentNode);}}
var divParent=$(this.container).closest('.springContainer')[0];var divContent=$(divParent).find('.springContent')[0];divContent.draggable='true';divContent.ondragstart=function(e){e.dataTransfer.setData("id",$(e.target).closest('.springContainer').get(0).id.replace('divContainer_',''));};divContent.ondragover=function(e){e.preventDefault();};divContent.ondragleave=function(e){e.preventDefault();};divParent.ondrop=function(e){e.stopPropagation();if(e.dataTransfer.getData("type")&&e.dataTransfer.getData("title")){if(_this.screen.screen){var entity=_this.entity;if(_this.screen.entity.modal.type==='ModalAppBlind'){if(e.dataTransfer.getData("type")=='ModalMix'){alert('');return;}if(e.dataTransfer.getData("type")=="ModalPointKPI"){alert('KPI');return false;}
if(e.dataTransfer.getData("type")=="ModalReportFactory"){alert('');return false;}
if(e.dataTransfer.getData("type")=="ModalAppBlind"){alert('');return false;}else{_this.screen.screen.rebornEntity(entity,e.dataTransfer.getData("type"),e.dataTransfer.getData("title"));}}else{if(e.dataTransfer.getData("type")=='ModalMix'){alert(I18n.resource.toolBox.modal.MSG_MIX_NOT_ALLOW_TO_MIX);return;}
if(e.dataTransfer.getData("type")=="ModalPointKPI"){alert(I18n.resource.toolBox.modal.MSG_KPI_NOT_ALLOW_TO_MIX);return false;}else{_this.screen.screen.rebornEntity(entity,e.dataTransfer.getData("type"),e.dataTransfer.getData("title"));}}}else{_this.screen.rebornEntity(_this.entity,e.dataTransfer.getData("type"),e.dataTransfer.getData("title"),_this.hasEdit);}}else if(e.dataTransfer.getData("id")){var targetId=$(e.target).closest('.springContainer').get(0).id.replace('divContainer_','');if(_this.screen&&_this.screen.replaceEntity){_this.screen.replaceEntity(e.dataTransfer.getData("id"),targetId);}}};};return ModalNone;}();var ModalChart=function(){function ModalChart(screen,entityParams){if(!entityParams)return;ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);this.dicPeriod={'30s':30000,'m1':60000,'m5':300000,'10m':600000,'30m':1800000,'h1':3600000,'d1':86400000,'M1':2592000000};}
ModalChart.prototype=new ModalBase();ModalChart.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_CHART',parent:0,mode:['realTime'],maxNum:10,title:'',minHeight:1,minWidth:1,maxHeight:6,maxWidth:12,type:'ModalChart'};ModalChart.prototype.optionDefault={color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500'],title:{textStyle:{fontWeight:'normal',color:'#008acd'}},legend:{textStyle:{fontFamily:"Microsoft YaHei",fontSize:10},top:'10',left:'center'},dataRange:{itemWidth:15,color:['#5ab1ef','#e0ffff']},toolbox:{x:'right',y:'center',feature:{mark:{show:true},magicType:{show:true,type:['line','bar']},restore:{show:true},saveAsImage:{show:true}},color:['#1e90ff','#1e90ff','#1e90ff','#1e90ff'],effectiveColor:'#ff4500'},tooltip:{trigger:'axis',axisPointer:{type:'line',lineStyle:{color:'#008acd'},crossStyle:{color:'#008acd'},shadowStyle:{color:'rgba(200,200,200,0.2)'}}},dataZoom:{dataBackgroundColor:'#efefff',fillerColor:'rgba(182,162,222,0.2)',handleColor:'#008acd'},grid:function(isMobile){var grid={borderWidth:0,borderColor:'#eee',left:50,bottom:40,right:50,top:40};if(isMobile){grid.x=40;}
return grid;}(AppConfig.isMobile),categoryAxis:{axisLine:{lineStyle:{color:'#008acd'}},splitLine:{lineStyle:{color:['#eee']}}},valueAxis:{axisLine:{lineStyle:{color:'#008acd'}},splitArea:{show:true,areaStyle:{color:['rgba(250,250,250,0.1)','rgba(200,200,200,0.1)']}},splitLine:{lineStyle:{color:['#eee']}}},polar:{axisLine:{lineStyle:{color:'#ddd'}},splitArea:{show:true,areaStyle:{color:['rgba(250,250,250,0.2)','rgba(200,200,200,0.2)']}},splitLine:{lineStyle:{color:'#ddd'}}},timeline:{lineStyle:{color:'#008acd'},controlStyle:{normal:{color:'#008acd'},emphasis:{color:'#008acd'}},symbol:'emptyCircle',symbolSize:3},bar:{itemStyle:{normal:{barBorderRadius:5},emphasis:{barBorderRadius:5}},barMaxWidth:80},line:{smooth:true,symbol:'none',symbolSize:3},k:{itemStyle:{normal:{color:'#d87a80',color0:'#2ec7c9',lineStyle:{color:'#d87a80',color0:'#2ec7c9'}}}},scatter:{symbol:'circle',symbolSize:4},radar:{symbol:'emptyCircle',symbolSize:3},map:{itemStyle:{normal:{areaStyle:{color:'#ddd'},label:{textStyle:{color:'#d87a80'}}},emphasis:{areaStyle:{color:'#fe994e'}}}},force:{itemStyle:{normal:{linkStyle:{color:'#1e90ff'}}}},chord:{itemStyle:{normal:{borderWidth:1,borderColor:'rgba(128, 128, 128, 0.5)',chordStyle:{lineStyle:{color:'rgba(128, 128, 128, 0.5)'}}},emphasis:{borderWidth:1,borderColor:'rgba(128, 128, 128, 0.5)',chordStyle:{lineStyle:{color:'rgba(128, 128, 128, 0.5)'}}}}},gauge:{axisLine:{lineStyle:{color:[[0.2,'#2ec7c9'],[0.8,'#5ab1ef'],[1,'#d87a80']],width:10}},axisTick:{splitNumber:10,length:15,lineStyle:{color:'auto'}},splitLine:{length:22,lineStyle:{color:'auto'}},pointer:{width:5}},textStyle:{fontFamily:', Arial, Verdana, sans-serif'}};ModalChart.prototype.renderModal=function(){this.chart=echarts.init(this.container,AppConfig.chartTheme);this.chart.setOption(this.options);},ModalChart.prototype.updateModal=function(pointName,pointValue){},ModalChart.prototype.showConfigMode=function(){},ModalChart.prototype.dsChartCog=function(cog,option){if(!cog)return;if(cog[0].upper)option.yAxis[0].max=cog[0].upper;if(cog[0].lower)option.yAxis[0].min=cog[0].lower;if(cog[0].unit)option.yAxis[0].name=cog[0].unit;if(cog[0].markLine){if(!option.series[0].markLine){option.series[0].markLine={};option.series[0].markLine.data=new Array();}
for(var i in cog[0].markLine){var markLine=cog[0].markLine[i];if(!markLine.value)continue;var arr=[{name:markLine.name,xAxis:-1,yAxis:markLine.value},{name:markLine.name,xAxis:option.series[0].data.length,yAxis:markLine.value}];option.series[0].markLine.data.push(arr);}}};ModalChart.prototype.coordinate=function(timeShaft){var arr=[],timeFormat=this.entity.modal.option.timeFormat,format;switch(timeFormat){case'm5':format='HH:mm';break;case'h1':format='HH:00';break;case'd1':format='yyyy-MM-dd';break;case'M1':format='yyyy-MM';break;default:format='yyyy-MM-dd HH:mm';break;}
for(var i=0,l=timeShaft.length;i<l;i++){arr.push(timeShaft[i].toDate().format(format));}
return[{data:arr}];},ModalChart.prototype.resize=function(){this.chart&&this.chart.resize();};ModalChart.prototype.getData=function(params){var startTime,endTime,timeFormat,unit,postData={},arrPoint;var now=new Date();if(params&&params.dsItemIds){arrPoint=params.dsItemIds;}else{arrPoint=this.entity.modal.points[0]instanceof Array?this.entity.modal.points[0]:this.entity.modal.points;}
if(params&&params.timeFormat){timeFormat=params.timeFormat;}else{timeFormat=this.entity.modal.option.format;}
if(!params||!params.startTime||!params.endTime){if(this.entity.modal.option.mode==0){switch(this.entity.modal.option.recentTime){case'today':startTime=new Date(now.getTime()-86400000+3600000).format('yyyy-MM-dd HH:00:00');endTime=now.format('yyyy-MM-dd HH:00:00');break;case'threeDay':startTime=new Date(now.getTime()-86400000*3+3600000).format('yyyy-MM-dd HH:00:00');endTime=now.format('yyyy-MM-dd HH:00:00');break;case'yesterday':endTime=now;endTime.setHours(0);endTime.setMinutes(0);endTime.setSeconds(0);startTime=new Date(endTime.getTime()-86400000+3600000).format('yyyy-MM-dd HH:00:00');endTime=endTime.format('yyyy-MM-dd HH:00:00');break;case'thisWeek':endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(endTime);startTime.setDate(startTime.getDate()-6);startTime=startTime.format('yyyy-MM-dd 00:00:00');break;case'lastWeek':endTime=new Date(now.getTime()-now.getDay()*86400000).format('yyyy-MM-dd 00:00:00');;startTime=new Date(now.getTime()-(now.getDay()+6)*86400000).format('yyyy-MM-dd 00:00:00');;break;case'thisYear':endTime=now.format('yyyy-MM-01 00:00:00');startTime=now;startTime.setMonth(startTime.getMonth()-12);startTime=startTime.format('yyyy-MM-01 00:00:00');break;}}else if(this.entity.modal.option.mode==1){if(this.entity.modal.option.startTime&&this.entity.modal.option.endTime){startTime=new Date(this.entity.modal.option.startTime).format('yyyy-MM-dd HH:mm:ss');endTime=new Date(this.entity.modal.option.endTime).format('yyyy-MM-dd HH:mm:ss');}else{alert('/');return;}}else if(this.entity.modal.option.mode==2){if(this.entity.modal.option.unit==='hour'){unit=3600000;endTime=new Date();if(timeFormat==='h1'){endTime.setMinutes(0);endTime.setSeconds(0);}
startTime=new Date(endTime.getTime()-unit*parseInt(this.entity.modal.option.val)+1000).format('yyyy-MM-dd HH:mm:ss');}else if(this.entity.modal.option.unit==='day'){unit=86400000;endTime=new Date();endTime.setMinutes(0);endTime.setSeconds(0);if(timeFormat==='h1'){startTime=new Date(endTime.getTime()-unit*parseInt(this.entity.modal.option.val)+3600000).format('yyyy-MM-dd HH:mm:ss');}else if(timeFormat==='d1'){startTime=new Date(endTime.getTime()-unit*parseInt(this.entity.modal.option.val)+1000).format('yyyy-MM-dd HH:mm:ss');}}else if(this.entity.modal.option.unit==='month'){unit=2592000000;if(timeFormat==='d1'){endTime=now.format('yyyy-MM-dd 00:00:00');startTime=new Date(now.getTime()-86400000*30).format('yyyy-MM-dd 00:00:00');}else if(timeFormat==='M1'){alert('');return;}}
endTime=endTime.format('yyyy-MM-dd HH:mm:ss');}}else{startTime=params.startTime;endTime=params.endTime;}
if(!arrPoint||arrPoint.length===0){postData.errorMsg='Data source is error';}
if(!startTime||!endTime){postData.errorMsg='Start time or end time is error';}
if(!timeFormat){postData.errorMsg='timeFormat is error';}
if(postData.errorMsg){alert(postData.errorMsg);return;}
postData.dsItemIds=arrPoint;postData.timeStart=startTime;postData.timeEnd=endTime;postData.timeFormat=timeFormat;return WebAPI.post('/analysis/startWorkspaceDataGenHistogram',postData);};return ModalChart;}();var ModalRealtimePie=function(){function ModalRealtimePie(screen,entityParams){if(!entityParams)return;ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);};ModalRealtimePie.prototype=new ModalBase();ModalRealtimePie.prototype.optionTemplate={name:'',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12};ModalRealtimePie.prototype.optionDefault={tooltip:{trigger:'item',formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:'vertical',x:'left',y:'center'},toolbox:{show:false,feature:{mark:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:['pie','funnel'],option:{funnel:{x:'25%',width:'50%',funnelAlign:'center',max:1548}}},restore:{show:true},saveAsImage:{show:true}}},calculable:true,color:['#E2583A','#FD9F08','#FEC500','#1D74A9','#04A0D6','#689C0F','#109d83'],series:[{type:'pie',radius:['50%','70%'],center:['50%','50%'],labelLine:{normal:{show:true,length:6,length2:60,lineStyle:{width:[2]}}},itemStyle:{normal:{label:{show:true,formatter:'{d}%'},labelLine:{show:true}},emphasis:{label:{show:true,position:'center',textStyle:{fontSize:'20',fontWeight:'bold'}}}}}]};ModalRealtimePie.prototype.renderModal=function(){this.chart=echarts.init(this.container,AppConfig.chartTheme);this.chart.setOption($.extend(true,{},this.optionDefault,this.option));},ModalRealtimePie.prototype.updateModal=function(points){},ModalRealtimePie.prototype.showConfigMode=function(){},ModalRealtimePie.prototype.dealWithData=function(points,len){var arr=[];var arrLegend=this.initPointAlias(points);var arrSeries=[];for(var i=0;i<points.length;i++){var seriesData={value:tofixed(points[i].data),name:arrLegend[i]};arrSeries.push(seriesData);}
arr.push(arrLegend);arr.push(arrSeries);return arr;},ModalRealtimePie.prototype.setModalOption=function(option){this.entity.modal.interval=5;};return ModalRealtimePie;}();var ModalRealtimeLine=function(){function ModalRealtimeLine(screen,entityParams){if(!entityParams)return;ModalChart.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);};ModalRealtimeLine.prototype=new ModalChart();ModalRealtimeLine.prototype.optionTemplate={name:'',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12};ModalRealtimeLine.prototype.optionDefault=$.extend(true,{},{grid:ModalChart.prototype.optionDefault.grid,legend:ModalChart.prototype.optionDefault.legend},{tooltip:{trigger:'axis'},legend:{data:[],orient:'horizontal'},toolbox:{show:false,feature:{dataView:{show:true,readOnly:false},magicType:{show:true,type:['line','bar']}}},calculable:function(){if(AppConfig.isMobile){return false;}else{return true;}}(),color:['#E2583A','#FEC500','#04A0D6','#FD9F08','#1D74A9','#689C0F','#109d83'],xAxis:[{type:'category',boundaryGap:false,splitLine:{show:false},splitArea:{show:false},axisTick:{show:false}}],yAxis:[{type:'value',scale:true,splitLine:{show:function(){if(AppConfig.isMobile){return false;}else{return true;}}()},splitArea:{show:false},axisLabel:{formatter:function formatter(value){if(AppConfig.isMobile&&value/1000>=1){return value/1000+'k';}else{return value;}}}}],series:[{type:'line',symbol:'none',smooth:true}],animation:true});ModalRealtimeLine.prototype.renderModal=function(){this.chart=echarts.init(this.container,AppConfig.chartTheme);this.chart.setOption($.extend(true,{},this.optionDefault,this.option));},ModalRealtimeLine.prototype.updateModal=function(points){},ModalRealtimeLine.prototype.showConfigMode=function(){},ModalRealtimeLine.prototype.dealWithData=function(points,dsChartCog){var arr=[],arrLegend=[],arrSeries=[],accuracy;if(!dsChartCog){accuracy=2;}else{accuracy=parseInt(dsChartCog[0].accuracy);}
arrLegend=this.initPointAlias(points.list);for(var i=0;i<points.list.length;i++){var dataList=[];for(var j in points.list[i].data){if(typeof points.list[i].data[j]==='number'){dataList.push(points.list[i].data[j].toFixed(accuracy));}}
var series={name:arrLegend[i],type:this.entity.modal.option.showType?this.entity.modal.option.showType:'line',symbol:'none',smooth:true,data:dataList,z:3,itemStyle:{normal:{label:{show:false,position:'top',formatter:'{b}\n{c}'},barBorderRadius:[5,5,0,0]}}};arrSeries.push(series);}
arr.push(arrLegend);arr.push(arrSeries);return arr;},ModalRealtimeLine.prototype.setModalOption=function(option){this.entity.modal.interval=5;};return ModalRealtimeLine;}();var modalRealtimeBar=function(){function modalRealtimeBar(screen,entityParams){if(!entityParams)return;ModalChart.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);};modalRealtimeBar.prototype=new ModalChart();modalRealtimeBar.prototype.optionTemplate={parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12};modalRealtimeBar.prototype.optionDefault=$.extend(true,{},{grid:ModalChart.prototype.optionDefault.grid,legend:ModalChart.prototype.optionDefault.legend},{tooltip:{trigger:'item'},calculable:function(){if(AppConfig.isMobile){return false;}else{return true;}}(),xAxis:[{type:'category',show:true,splitLine:{show:false},splitArea:{show:false},axisTick:{show:false}}],yAxis:[{type:'value',splitArea:{show:false},splitLine:{show:function(){if(AppConfig.isMobile){return false;}else{return true;}}()},axisLabel:{formatter:function formatter(value){if(AppConfig.isMobile&&value/1000>=1){return value/1000+'k';}else{return value;}}}}],animation:true});modalRealtimeBar.prototype.renderModal=function(){this.chart=echarts.init(this.container,AppConfig.chartTheme);this.chart.setOption($.extend(true,{},this.optionDefault,this.option));},modalRealtimeBar.prototype.updateModal=function(points){},modalRealtimeBar.prototype.showConfigMode=function(){},modalRealtimeBar.prototype.setModalOption=function(option){this.entity.modal.interval=5;};return modalRealtimeBar;}();var ModalRealtimeBarEnegBrkd=function(){function ModalRealtimeBarEnegBrkd(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;modalRealtimeBar.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);};ModalRealtimeBarEnegBrkd.prototype=new modalRealtimeBar();ModalRealtimeBarEnegBrkd.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_CHART_BAR_ENERGY',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalRealtimeBarEnegBrkd',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalRealtimeBarEnegBrkd.prototype.renderModal=function(){},ModalRealtimeBarEnegBrkd.prototype.updateModal=function(points){if(points.length<1)return;var now=new Date();if(!this.lastRenderTime||now.getTime()-this.lastRenderTime>this.dicPeriod[_this.entity.modal.option.timeFormat]){this.lastRenderTime=now;var _this=this;var dsChartCog=this.entity.modal.dsChartCog;var entityItem=dealWithData(points,dsChartCog);var optionDefault={tooltip:{trigger:'item'},toolbox:{show:false},calculable:true,xAxis:[{type:'category',show:true}],yAxis:[{type:'value',show:true}],series:[{type:'bar',itemStyle:{normal:{color:function color(params){var colorList=['#C1232B','#B5C334','#FCCE10','#E87C25','#27727B','#FE8463','#9BCA63','#FAD860','#F3A43B','#60C0DD','#D7504B','#C6E579','#F4E001','#F0805A','#26C0C0'];return colorList[params.dataIndex];},label:{show:true,position:'top',formatter:'{c}'}}},barMaxWidth:80}]};var entityData={xAxis:[{data:entityItem[0]}],series:[{data:entityItem[1],markPoint:{data:entityItem[2]}}]};this.dsChartCog(dsChartCog,entityData);!this.chart&&(this.chart=echarts.init(this.container,AppConfig.chartTheme));this.chart.setOption($.extend(true,{},this.optionDefault,optionDefault,entityData));}
function dealWithData(points,dsChartCog){var arr=[],arrXAxis=[],arrData=[],arrMpData=[],accuracy;if(!dsChartCog){accuracy=2;}else{accuracy=parseInt(dsChartCog[0].accuracy);};arrXAxis=_this.initPointAlias(points);for(var i=0,temp;i<points.length;i++){temp=points[i];arrData.push(tofixed(temp.data,accuracy));arrMpData.push({xAxis:i,value:tofixed(temp.data,accuracy),name:arrXAxis[i],symbol:'none'});}
arr.push(arrXAxis);arr.push(arrData);arr.push(arrMpData);return arr;}},ModalRealtimeBarEnegBrkd.prototype.setModalOption=function(option){this.entity.modal.interval=5;};return ModalRealtimeBarEnegBrkd;}();var ModalRealtimeBarSub=function(){function ModalRealtimeBarSub(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;modalRealtimeBar.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);this.m_bIsGoBackTrace=false;this.m_traceData=undefined;};ModalRealtimeBarSub.prototype=new modalRealtimeBar();ModalRealtimeBarSub.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_BAR',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalRealtimeBarSub',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalRealtimeBarSub.prototype.renderModal=function(){},ModalRealtimeBarSub.prototype.updateModal=function(points){if(points.length<1)return;var _this=this;var now=new Date();if(!this.lastRenderTime||now.getTime()-this.lastRenderTime>this.dicPeriod[_this.entity.modal.option.timeFormat]){var pointNameList=function(points){var arr=[];for(var i=0;i<points.length;i++){arr.push(points[i].dsItemId);}
return arr;}(points);var endTime;if(!_this.m_bIsGoBackTrace){endTime=new Date();_this.optionDefault.animation=true;}else{this.m_bIsGoBackTrace=false;endTime=new Date(_this.m_traceData.currentTime);_this.optionDefault.animation=false;}
if(!this.entity.modal.option)this.entity.modal.option={};if(!this.entity.modal.option.timeFormat){this.entity.modal.option.timeFormat='h1';}
if(this.entity.modal.option.timeFormat==='m1'||this.entity.modal.option.timeFormat==='m5'||this.entity.modal.option.timeFormat==='h1'){var startTime=new Date(endTime-86400000);}else if(this.entity.modal.option.timeFormat==='d1'){var startTime=new Date(endTime-2592000000);}else if(this.entity.modal.option.timeFormat==='M1'){var startTime=new Date(endTime-31536000000);}
this.lastRenderTime=now;WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:pointNameList,timeStart:startTime.format('yyyy-MM-dd HH:mm:ss'),timeEnd:endTime.format('yyyy-MM-dd HH:mm:ss'),timeFormat:_this.entity.modal.option.timeFormat}).done(function(dataSrc){if(dataSrc==undefined||dataSrc.length<=0){return;}
var dsChartCog=_this.entity.modal.dsChartCog;var entityItem=_this.dealWithData(dataSrc,dsChartCog);var entityData={legend:{data:entityItem[0],icon:'circle',itemWidth:22,itemHeight:10},xAxis:_this.coordinate(dataSrc.timeShaft),yAxis:[{}],toolbox:{show:false,feature:{dataView:{show:true,readOnly:false},magicType:{show:true,type:['line','bar']}}},series:entityItem[1]};_this.dsChartCog(dsChartCog,entityData);!_this.chart&&(_this.chart=echarts.init(_this.container,AppConfig.chartTheme));_this.chart.clear();_this.chart.setOption($.extend(true,{},_this.optionDefault,entityData));}).error(function(e){}).always(function(e){});}},ModalRealtimeBarSub.prototype.dealWithData=function(points,dsChartCog){var arr=[],arrLegend=[],arrSeries=[],accuracy;if(!dsChartCog){accuracy=2;}else{accuracy=parseInt(dsChartCog[0].accuracy);}
arrLegend=this.initPointAlias(points.list);for(var i=0;i<points.list.length;i++){var key=points.list[i].dsItemId,dataList=[];for(var j in points.list[i].data){dataList.push(points.list[i].data[j].toFixed(accuracy));}
var series={name:arrLegend[i],type:'bar',symbol:'none',smooth:true,data:dataList,itemStyle:{normal:{label:{show:false,position:'top',formatter:'{b}\n{c}'},barBorderRadius:[5,5,0,0]}}};arrSeries.push(series);}
arr.push(arrLegend);arr.push(arrSeries);return arr;},ModalRealtimeBarSub.prototype.setModalOption=function(option){this.entity.modal.interval=5;};ModalRealtimeBarSub.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();};return ModalRealtimeBarSub;}();var ModalRealtimePieEnegBrkd=function(){function ModalRealtimePieEnegBrkd(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalRealtimePie.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);};ModalRealtimePieEnegBrkd.prototype=new ModalRealtimePie();ModalRealtimePieEnegBrkd.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_CHART_PIE_ENERGY',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalRealtimePieEnegBrkd',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalRealtimePieEnegBrkd.prototype.renderModal=function(){};ModalRealtimePieEnegBrkd.prototype.updateModal=function(points){if(points.length<1)return;var _this=this;var now=new Date();if(!this.lastRenderTime||now.getTime()-this.lastRenderTime>this.dicPeriod[_this.entity.modal.option.timeFormat]){this.lastRenderTime=now;var entityItem=this.dealWithData(points,4);var entityData={legend:{data:entityItem[0],icon:'circle',itemWidth:22,itemHeight:10,top:20},series:[{data:entityItem[1]}]};this.chart=echarts.init(this.container,AppConfig.chartTheme).setOption($.extend(true,{},this.optionDefault,entityData));}},ModalRealtimePieEnegBrkd.prototype.setModalOption=function(option){this.entity.modal.interval=5;};return ModalRealtimePieEnegBrkd;}();var ModalRealtimeLineOutdoor=function(){function ModalRealtimeLineOutdoor(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;ModalRealtimeLine.call(this,screen,entityParams,renderModal,updateModal,null);this.m_bIsGoBackTrace=false;this.m_traceData=undefined;!this.entity.modal.option&&(this.entity.modal.option={});!this.entity.modal.option.mode&&(this.entity.modal.option.mode=0);!this.entity.modal.option.recentTime&&(this.entity.modal.option.recentTime='today');!this.entity.modal.option.format&&(this.entity.modal.option.format='h1');};ModalRealtimeLineOutdoor.prototype=new ModalRealtimeLine();ModalRealtimeLineOutdoor.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_CHART_LINE_OUTDOOR',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalRealtimeLineOutdoor',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}},ModalRealtimeLineOutdoor.prototype.renderModal=function(){this.updateModal();};ModalRealtimeLineOutdoor.prototype.updateModal=function(points){var pointNameList=[];if(this.screen.store){if(this.screen.store.model){if(this.screen.store.model.option().bg==="whiteBg"){this.optionDefault.tooltip={trigger:'axis',backgroundColor:'rgba(0,0,0,0.7)',textStyle:{color:"#ffffff"}};}else{this.optionDefault.tooltip={trigger:'axis',backgroundColor:'rgba(255,255,255,0.9)',textStyle:{color:"#000000"}};}}}
if(!points&&this.entity.modal.points){if(this.entity.modal.points[0]instanceof Array){pointNameList=this.entity.modal.points[0];}else{pointNameList=this.entity.modal.points;}}else{points&&points.length>0&&(pointNameList=function(points){var arr=[];for(var i=0;i<points.length;i++){arr.push(points[i].dsItemId);}
return arr;}(points));}
if(pointNameList.length<1)return;var _this=this;var now=new Date();if(!this.lastRenderTime||now.getTime()-this.lastRenderTime>this.dicPeriod[_this.entity.modal.option.timeFormat]){var endTime,startTime;if(!_this.m_bIsGoBackTrace){endTime=new Date();_this.optionDefault.animation=true;}else{this.m_bIsGoBackTrace=false;endTime=new Date(_this.m_traceData.currentTime);_this.optionDefault.animation=false;}
if(!this.entity.modal.option)this.entity.modal.option={};if(!this.entity.modal.option.timeFormat){this.entity.modal.option.timeFormat='h1';}
if(this.entity.modal.option.timeFormat==='m1'||this.entity.modal.option.timeFormat==='m5'||this.entity.modal.option.timeFormat==='h1'){startTime=new Date(endTime-86400000);}else if(this.entity.modal.option.timeFormat==='d1'){startTime=new Date(endTime-2592000000);}else if(this.entity.modal.option.timeFormat==='M1'){startTime=new Date(endTime-31536000000);}
this.lastRenderTime=now;this.getData({dsItemIds:pointNameList,timeFormat:this.entity.modal.option.timeFormat}).done(function(dataSrc){if(dataSrc==undefined||dataSrc.length<=0){return;}
var dsChartCog=_this.entity.modal.dsChartCog;var entityItem=_this.dealWithData(dataSrc,dsChartCog);var entityData={legend:{data:entityItem[0],icon:'circle',itemWidth:22,itemHeight:10},xAxis:_this.coordinate(dataSrc.timeShaft),yAxis:[{}],series:entityItem[1]};_this.dsChartCog(dsChartCog,entityData);!_this.chart&&(_this.chart=echarts.init(_this.container,AppConfig.chartTheme));_this.chart.clear();_this.chart.setOption($.extend(true,{},_this.optionDefault,entityData));}).error(function(e){}).always(function(e){});}},ModalRealtimeLineOutdoor.prototype.setModalOption=function(option){this.entity.modal.interval=5;};ModalRealtimeLineOutdoor.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();};ModalRealtimeLineOutdoor.prototype.modalInit=function(){!this.entity.modal.option&&(this.entity.modal.option={});var _this=this;var configModalOpt={"header":{"needBtnClose":true,"title":""},"area":[{module:'timeConfig',data:{mode:this.entity.modal.option.mode,timeFormat:this.entity.modal.option.format,timeRecent:this.entity.modal.option.recentTime,timeStart:this.entity.modal.option.startTime,timeEnd:this.entity.modal.option.endTime}},{"type":'option',"widget":[{id:'selChartType',type:'select',name:'',opt:{option:[{val:'bar',name:''},{val:'line',name:''}]},data:{val:this.entity.modal.option.showType}}]},{"module":"dsDrag","data":[{type:'point',name:'',data:this.entity.modal.points?this.entity.modal.points[0]instanceof Array?this.entity.modal.points[0]:this.entity.modal.points:[],forChart:false}]},{'type':'footer',"widget":[{type:'confirm',opt:{needClose:true}},{type:'cancel'}]}],result:{func:function func(data){!_this.entity.modal.option&&(_this.entity.modal.option={});_this.entity.modal.option.mode=data.mode;_this.entity.modal.option.format=data.timeFormat;if(data.mode==='1'){_this.entity.modal.option.startTime=data.timeStart;_this.entity.modal.option.endTime=data.timeEnd;}else if(data.mode==='2'){_this.entity.modal.option.unit=data.timeRecent.unit;_this.entity.modal.option.val=data.timeRecent.val;}
_this.entity.modal.option.recentTime=data.timeRecent;_this.entity.modal.option.showType=data.selChartType.val;_this.entity.modal.points=data.points[0];_this.lastRenderTime=null;_this.setModalOption();_this.updateModal();}}};this.configModal=new ConfigModal(configModalOpt,this.screen.container?this.screen.container:this.screen.page.painterCtn);this.configModal.init();this.configModal.show();};return ModalRealtimeLineOutdoor;}();var ModalRealtimeGauge=function(){function ModalRealtimeGauge(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalBase.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);this.entityOption=entityParams.modal.option;};ModalRealtimeGauge.prototype=new ModalBase();ModalRealtimeGauge.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_CHART_GAUGE',parent:0,mode:['gauge'],maxNum:1,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalRealtimeGauge',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalRealtimeGauge.prototype.optionDefault={tooltip:{formatter:"{c}"},animation:true,animationDuration:1000,animationDurationUpdate:1000,series:[{name:'PUE',type:'gauge',splitNumber:8,radius:'100%',axisLine:{show:true,lineStyle:{width:6}},axisTick:{show:true,splitNumber:5,length:10,lineStyle:{width:1,type:'solid',color:'auto'}},axisLabel:{textStyle:{color:'auto'},formatter:function formatter(v){return v.toFixed(0);}},splitLine:{show:true,length:15,lineStyle:{color:'auto',width:3}},pointer:{width:5},detail:{formatter:'{value}',textStyle:{fontSize:12}}}]};ModalRealtimeGauge.prototype.renderModal=function(){},ModalRealtimeGauge.prototype.updateModal=function(points){if(points.length<1)return;var _this=this;var scaleList=[];for(var i=0;i<_this.entityOption.scaleList.length;i++){scaleList.push(_this.entityOption.scaleList[i]);}
var colorList=['#1abc9c','#3598db','#e84c3d'];if(scaleList[scaleList.length-1]<scaleList[0]){scaleList.reverse();colorList=['#e84c3d','#3598db','#1abc9c'];}
this.optionDefault.series[0].max=scaleList[scaleList.length-1];this.optionDefault.series[0].min=scaleList[0];this.optionDefault.series[0].data=[{value:parseFloat(points[0].data).toFixed(2)}];this.optionDefault.series[0].axisLine.lineStyle.color=function(option){var arr=[],colorIndex=0;for(var i=0;i<option.length;i++){if(i==0){continue;}
arr.push([((option[i]-option[0])/(_this.optionDefault.series[0].max-_this.optionDefault.series[0].min)).toFixed(3),colorList[colorIndex]]);colorIndex++;}
return arr;}(scaleList);!this.chart&&(this.chart=echarts.init(this.container,AppConfig.chartTheme));this.chart.setOption(this.optionDefault);},ModalRealtimeGauge.prototype.showConfigMode=function(){},ModalRealtimeGauge.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.option.scaleList=option.scaleList;this.entity.modal.interval=5;};return ModalRealtimeGauge;}();function tofixed(str,accuracy){if(!accuracy)accuracy=2;return parseFloat(str).toFixed(accuracy);}
var ModalHistoryChart=function(){function ModalHistoryChart(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;this.m_bIsGoBackTrace=false;this.m_traceData=undefined;ModalChart.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);};ModalHistoryChart.prototype=new ModalChart();ModalHistoryChart.prototype.optionTemplate={name:'toolBox.modal.HIS_CHART',parent:1,mode:['easyHistory'],maxNum:5,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalHistoryChart'};ModalHistoryChart.prototype.optionDefault={tooltip:{trigger:'axis'},toolbox:{show:false,feature:{dataView:{show:false,readOnly:true},magicType:{show:true,type:['line','bar']},restore:{show:true},saveAsImage:{show:true}}},calculable:false,dataZoom:{show:true},grid:function(){var grid={borderWidth:0,borderColor:'#eee',left:50,bottom:40,right:40,top:40};if(AppConfig.isMobile){grid.x=40;}
return grid;}(),xAxis:[{type:'time',splitLine:{show:false}}],yAxis:[{type:'value',splitArea:{show:false},splitLine:{show:function(){if(AppConfig.isMobile){return false;}else{return true;}}()},axisLabel:{formatter:function formatter(value){if(AppConfig.isMobile&&value/1000>=1){return value/1000+'k';}else{return value;}}}}],animation:true};ModalHistoryChart.prototype.renderModal=function(){var _this=this;var hourMilSec=3600000;var dayMilSec=86400000;var weekMilSec=604800000+dayMilSec;var startDate=new Date();var endDate=new Date();var timeType;if('hour'==_this.entity.modal.option.timeType){timeType='m5';startDate.setTime(endDate.getTime()-hourMilSec);}
if('day'==_this.entity.modal.option.timeType){timeType='h1';startDate.setTime(endDate.getTime()-dayMilSec);}else if('week'==_this.entity.modal.option.timeType){timeType='d1';startDate.setTime(endDate.getTime()-weekMilSec);}else if('month'==_this.entity.modal.option.timeType){timeType='d1';var year=endDate.getFullYear();var month=endDate.getMonth();if(0==month){startDate.setFullYear(year-1);startDate.setMonth(11);}else{startDate.setMonth(month-1);}}else if('year'==_this.entity.modal.option.timeType){timeType='M1';startDate.setFullYear(endDate.getFullYear()-1);}else{return;}
var curDate,startTime,endTime;if(!_this.m_bIsGoBackTrace){startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=endDate.format('yyyy-MM-dd HH:mm:ss');_this.optionDefault.animation=true;}else{curDate=_this.m_traceData.currentTime;_this.optionDefault.animation=false;if('hour'==_this.entity.modal.option.timeType){startDate.setTime(curDate.getTime()-hourMilSec);}else if('day'==_this.entity.modal.option.timeType){startDate.setTime(curDate.getTime()-dayMilSec);}else if('week'==_this.entity.modal.option.timeType){startDate.setTime(curDate.getTime()-weekMilSec);}else if('month'==_this.entity.modal.option.timeType){var year=curDate.getFullYear();var month=curDate.getMonth();if(0==month){startDate.setFullYear(year-1);startDate.setMonth(11);}else{startDate.setMonth(month-1);}}else if('year'==_this.entity.modal.option.timeType){startDate.setFullYear(curDate.getFullYear()-1);}else{return;}
startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=curDate.format('yyyy-MM-dd HH:mm:ss');}
var optPtName=_this.entity.modal.points;WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:optPtName,timeStart:startTime,timeEnd:endTime,timeFormat:timeType}).done(function(dataSrc){if(!dataSrc||!dataSrc.list[0].data||!dataSrc.timeShaft||dataSrc.timeShaft.length<=0){return;}
var option=_this.initOption(dataSrc);if(undefined==option||undefined==option.series[0].data||0==option.series[0].data.length){return;}
var optionTemp={};$.extend(true,optionTemp,_this.optionDefault);if(_this.entity.modal.dsChartCog){if(_this.entity.modal.dsChartCog[0].upper!=''){optionTemp.yAxis[0].max=Number(_this.entity.modal.dsChartCog[0].upper);}
if(_this.entity.modal.dsChartCog[0].lower!=''){optionTemp.yAxis[0].min=Number(_this.entity.modal.dsChartCog[0].lower);}
if(_this.entity.modal.dsChartCog[0].unit!=''){optionTemp.yAxis[0].name=_this.entity.modal.dsChartCog[0].unit;}
if(_this.entity.modal.dsChartCog[0].accuracy!=''){var n=Number(_this.entity.modal.dsChartCog[0].accuracy);for(var i=0;i<option.series.length;i++){for(var j=0;j<option.series[i].data.length;j++){option.series[i].data[j]=Number(option.series[i].data[j].toFixed(n));}}}
var tempMarkLine;for(var k=0;k<4;k++){if(_this.entity.modal.dsChartCog[0].markLine[k].value!=''){if(!option.series[0].markLine){option.series[0].markLine={data:[],symbol:'none',itemStyle:{normal:{label:{show:false}}}};}
tempMarkLine=[{name:_this.entity.modal.dsChartCog[0].markLine[k].name,value:_this.entity.modal.dsChartCog[0].markLine[k].value,xAxis:-1,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)},{xAxis:dataSrc.timeShaft.length,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)}];option.series[0].markLine.data.push(tempMarkLine);}}}
_this.chart.clear();_this.chart.setOption($.extend(true,{},optionTemp,option));}).error(function(e){}).always(function(e){_this.spinner.stop();});},ModalHistoryChart.prototype.updateModal=function(options){},ModalHistoryChart.prototype.showConfigMode=function(){},ModalHistoryChart.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();this.m_bIsGoBackTrace=false;};return ModalHistoryChart;}();var ModalHistoryChartNormal=function(){var m_color=['#e74a37','#ff8050','#1abd9b','#3499da','#3e72ac'];var m_colorLen=m_color.length;function ModalHistoryChartNormal(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalHistoryChart.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);this.chart=echarts.init(this.container,AppConfig.chartTheme);this.spinner.spin(this.container);};ModalHistoryChartNormal.prototype=new ModalHistoryChart();ModalHistoryChartNormal.prototype.optionTemplate={name:'toolBox.modal.HIS_CHART_ENERGY_LINE',parent:1,mode:['easyHistorySelect'],maxNum:5,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalHistoryChartNormal'};ModalHistoryChartNormal.prototype.initOption=function(dataSrc){if(undefined==dataSrc||undefined==dataSrc.list[0].data){return;}
var xLen=dataSrc.timeShaft.length;var xAxis;var arrXAxis=[];if('month'==this.entity.modal.option.timeType){for(var i=0;i<xLen;i++){arrXAxis.push(dataSrc.timeShaft[i].toDate().format("MM-dd"));}}else if('week'==this.entity.modal.option.timeType){for(var i=0;i<xLen;i++){arrXAxis.push(dataSrc.timeShaft[i].toDate().format("yyyy-MM-dd"));}}else if('day'==this.entity.modal.option.timeType){for(var i=0;i<xLen;i++){arrXAxis.push(dataSrc.timeShaft[i].toDate().format("MM-dd HH:00"));}}
xAxis=[{type:'category',data:arrXAxis}];var dataName=this.initPointAlias(dataSrc.list);var arrSeries=[];var showColor='#1abd9b';for(var i=0;i<dataSrc.list.length;i++){if(dataSrc.list.length>1){showColor=m_color[i%m_colorLen];}
arrSeries.push({name:dataName[i],type:this.entity.modal.option.showType,data:dataSrc.list[i].data,itemStyle:{normal:{barBorderRadius:[5,5,0,0]},emphasis:{barBorderRadius:[5,5,0,0]}}});}
var dataOption={title:{text:'',subtext:''},legend:{data:dataName,icon:'circle',itemWidth:20,itemHeight:10,left:'center',top:'10'},dataZoom:{show:false},xAxis:xAxis,series:arrSeries};return dataOption;};ModalHistoryChartNormal.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.option.showType=option.showType;this.entity.modal.option.timeType=option.timeType;};return ModalHistoryChartNormal;}();var ModalHistoryChartEnergyConsume=function(){var m_color=['#e74a37','#ff8050','#1abd9b','#3499da','#3e72ac'];var m_colorLen=m_color.length;function ModalHistoryChartEnergyConsume(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalHistoryChart.call(this,screen,entityParams,renderModal,updateModal,showConfigMode);this.chart=echarts.init(this.container,AppConfig.chartTheme);this.spinner.spin(this.container);};ModalHistoryChartEnergyConsume.prototype=new ModalHistoryChart();ModalHistoryChartEnergyConsume.prototype.optionTemplate={name:'toolBox.modal.HIS_CHART_ENERGY_BAR',parent:1,mode:['easyHistory'],maxNum:5,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalHistoryChartEnergyConsume'};ModalHistoryChartEnergyConsume.prototype.initOption=function(dataSrc){if(undefined==dataSrc||undefined==dataSrc.list||undefined==dataSrc.list[0]){return;}
var xLen=dataSrc.timeShaft.length;var xAxis;var arrXAxis=[];var showColor;if('week'==this.entity.modal.option.timeType){for(var i=0;i<xLen-1;i++){var dayNum=dataSrc.timeShaft[i].toDate().getDay();arrXAxis.push(i18n_resource.dataSource.WEEK[dayNum]);}
showColor='#3499da';}else if('month'==this.entity.modal.option.timeType){for(var i=0;i<xLen-1;i++){arrXAxis.push(dataSrc.timeShaft[i].toDate().format('MM-dd'));}
showColor=m_color[0];}else if('year'==this.entity.modal.option.timeType){for(var i=0;i<xLen-1;i++){var monthNum=dataSrc.timeShaft[i].toDate().getMonth();arrXAxis.push(i18n_resource.dataSource.MONTH[monthNum]);}
showColor='#3e72ac';}else if('day'==this.entity.modal.option.timeType){for(var i=0;i<xLen-1;i++){arrXAxis.push(dataSrc.timeShaft[i].toDate().format('MM-dd HH:00'));}
showColor='#3e72ac';}
xAxis=[{type:'category',data:arrXAxis}];var dataName=this.initPointAlias(dataSrc.list);var arrSeries=[];for(var i=0;i<dataSrc.list.length;i++){if(dataSrc.list.length>1){showColor=m_color[i%m_colorLen];}
var arrData=[];var hisLen=dataSrc.list[0].data.length;var defVal;var fixNum=0;for(var j=1;j<hisLen;j++){var preVal=dataSrc.list[0].data[j-1];if(0==preVal){arrData.push(0);continue;}
defVal=dataSrc.list[0].data[j]-preVal;if(defVal<100){fixNum=2;}else{fixNum=0;}
arrData.push(parseFloat(defVal.toFixed(fixNum)));}
arrSeries.push({name:dataName[i],type:this.entity.modal.option.showType,data:arrData,itemStyle:{normal:{color:showColor,barBorderRadius:[5,5,5,5]},emphasis:{color:showColor,barBorderRadius:[5,5,5,5]}}});i++;}
var dataOption={title:{text:'',subtext:''},legend:{show:false,data:dataName,icon:'circle',itemWidth:20,itemHeight:10,left:'center',top:'10'},dataZoom:{show:false},xAxis:xAxis,series:arrSeries};return dataOption;};ModalHistoryChartEnergyConsume.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.option.showType='bar';this.entity.modal.option.timeType=option.timeType;};return ModalHistoryChartEnergyConsume;}();var ModalHistoryChartYearOnYearLine=function(){var _this;function ModalHistoryChartYearOnYearLine(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigModal=_showConfigMode?_showConfigMode:this.showConfigMode;ModalBase.call(this,screen,entityParams,renderModal,updateModal,showConfigModal);this.option=entityParams.option;this.chart=echarts.init(this.container,AppConfig.chartTheme);this.spinner.spin(this.container);this.store={};this.pointAlias=this.entity.modal.point?AppConfig.datasource.getDSItemById(this.entity.modal.points[0]).alias:'';this.m_bIsGoBackTrace=false;this.m_traceData=undefined;_this=this;};ModalHistoryChartYearOnYearLine.prototype=new ModalBase();ModalHistoryChartYearOnYearLine.prototype.optionTemplate={name:'toolBox.modal.HIS_CHART_YEAR_LINE',parent:1,mode:['easyCompareToggle'],maxNum:1,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalHistoryChartYearOnYearLine'};ModalHistoryChartYearOnYearLine.prototype.optionDefault={tooltip:{trigger:'axis',formatter:function formatter(params){var tar0=params[0];var tar1=params[1];var pointAlias=_this.pointAlias;return pointAlias+' : '+tar0.name+'<br/>'+tar0.seriesName+' : '+tar0.value+'<br/>'+tar1.seriesName+' : '+tar1.value;}},toolbox:{show:false,feature:{dataView:{show:false,readOnly:true},magicType:{show:true,type:['line','bar']},restore:{show:true},saveAsImage:{show:true}}},calculable:false,dataZoom:{show:false},color:['#E2583A','#FD9F08','#FEC500','#1D74A9','#04A0D6','#689C0F','#109d83'],xAxis:[{type:'time',splitLine:{show:false}}],yAxis:[{type:'value',splitArea:{show:false}}],animation:true};ModalHistoryChartYearOnYearLine.prototype.renderModal=function(){var _this=this;var hourMilSec=3600000;var dayMilSec=86400000;var weekMilSec=604800000;var startDate=new Date();var endDate=new Date();var tmFlag=new Date();var timeType;if('hour'==_this.entity.modal.option.timeType){timeType='m5';startDate.setTime(endDate.getTime()-hourMilSec);startDate.setMinutes(0);startDate.setSeconds(0);tmFlag.setTime(endDate.getTime());tmFlag.setMinutes(0);tmFlag.setSeconds(0);tmFlag.setMilliseconds(0);}
if('day'==_this.entity.modal.option.timeType){timeType='h1';startDate.setTime(endDate.getTime()-dayMilSec);startDate.setHours(0);startDate.setMinutes(0);startDate.setSeconds(0);tmFlag.setTime(endDate.getTime());tmFlag.setHours(0);tmFlag.setMinutes(0);tmFlag.setSeconds(0);tmFlag.setMilliseconds(0);}else{return;}
var curDate,startTime,endTime;if(!_this.m_bIsGoBackTrace){startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=endDate.format('yyyy-MM-dd HH:mm:ss');_this.optionDefault.animation=true;}else{curDate=_this.m_traceData.currentTime;_this.optionDefault.animation=false;if('hour'==_this.entity.modal.option.timeType){timeType='m5';startDate.setTime(curDate.getTime()-hourMilSec);startDate.setMinutes(0);startDate.setSeconds(0);tmFlag.setTime(curDate.getTime());tmFlag.setMinutes(0);tmFlag.setSeconds(0);tmFlag.setMilliseconds(0);}else if('day'==_this.entity.modal.option.timeType){timeType='h1';startDate.setTime(curDate.getTime()-dayMilSec);startDate.setHours(0);startDate.setMinutes(0);startDate.setSeconds(0);tmFlag.setTime(curDate.getTime());tmFlag.setHours(0);tmFlag.setMinutes(0);tmFlag.setSeconds(0);tmFlag.setMilliseconds(0);}else{return;}
startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=curDate.format('yyyy-MM-dd HH:mm:ss');}
var optPtName=_this.entity.modal.points;WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:optPtName,timeStart:startTime,timeEnd:endTime,timeFormat:timeType}).done(function(dataSrc){if(!dataSrc||!dataSrc.list[0].data||!dataSrc.timeShaft||dataSrc.timeShaft.length<=0){return;}
var arrXAxis=[];var flagCount=0;var len=dataSrc.timeShaft.length;tmFlag=tmFlag.format('yyyy-MM-dd HH:mm:ss');for(flagCount=0;flagCount<len;flagCount++){if(dataSrc.timeShaft[flagCount]>=tmFlag){break;}}
_this.store.timeShaft=dataSrc.timeShaft.slice(0,flagCount);_this.store.deadline=dataSrc.timeShaft[flagCount-1].toDate().valueOf();var fixNum=0;var setVal;var dataName=[];var arrSeries=[];for(var k=0,lenK=Math.min(flagCount,dataSrc.timeShaft.length);k<lenK;k++){arrXAxis.push(dataSrc.timeShaft[k].toDate().format("HH:mm"));}
var chartType=_this.entity.modal.option.showType?_this.entity.modal.option.showType:'line';var currentCount=0;for(var n=0;n<dataSrc.list.length;n++){var key=dataSrc.list[n].dsItemId;var dataSrc1=[];var dataSrc2=[];var eachName=[];if(1==dataSrc.list.length){dataName.push(I18n.resource.dataSource.TIME_YESTERDAY);dataName.push(I18n.resource.dataSource.TIME_TODAY);eachName.push(I18n.resource.dataSource.TIME_YESTERDAY);eachName.push(I18n.resource.dataSource.TIME_TODAY);}else{dataName.push(key+'_'+I18n.resource.dataSource.TIME_YESTERDAY);dataName.push(key+'_'+I18n.resource.dataSource.TIME_TODAY);eachName.push(key+'_'+I18n.resource.dataSource.TIME_YESTERDAY);eachName.push(key+'_'+I18n.resource.dataSource.TIME_TODAY);}
for(var j=0,len=dataSrc.list[n].data.length;j<len;j++){setVal=dataSrc.list[n].data[j];if(setVal<100){fixNum=2;}else{fixNum=0;}
setVal=parseFloat(setVal.toFixed(fixNum));if(j<flagCount){dataSrc1.push(setVal);}else{dataSrc2.push(setVal);}}
var showColor;var showData;var showMark;for(var i=0;i<2;i++){if(0==i){if(0==currentCount){showColor='#1abd9b';}else{showColor=echarts.config.color[currentCount*2];}
showData=dataSrc1;showMark={data:[{type:'max',name:I18n.resource.dashboard.modalHistoryChart.MAXIMUM},{type:'min',name:I18n.resource.dashboard.modalHistoryChart.MINIMUM}]};}else if(1==i){if(0==currentCount){showColor='#e74a37';}else{showColor=echarts.config.color[currentCount*2+1];}
showData=dataSrc2;var lastCntX=dataSrc2.length-1;var lastCntY=Number(dataSrc2[lastCntX]);showMark={symbol:'emptyCircle',symbolSize:10,effect:{show:true,shadowBlur:0},itemStyle:{normal:{label:{show:false}},emphasis:{label:{position:'top'}}},data:[{name:'',value:lastCntY,xAxis:lastCntX,yAxis:lastCntY}]};}
arrSeries.push({name:eachName[i],type:chartType,data:showData,itemStyle:{normal:{color:showColor,barBorderRadius:[5,5,0,0]},emphasis:{color:showColor,barBorderRadius:[5,5,0,0]}},symbolSize:3});if(i===1){arrSeries[1].symbol='rect';var blingDot=$.extend(true,{},arrSeries[1]);var seriesOne=arrSeries[1];seriesOne.type='effectScatter';seriesOne.symbolSize=10;seriesOne.symbol='circle';seriesOne.rippleEffect={brushType:'stroke'};seriesOne.itemStyle.normal.shadowBlur=10;var blingDotData=$.extend(true,{},showData);for(var p=0,lens=showData.length;p<lens;p++){if(p<lens-1){showData[p]='-';}}
var blingDotDataArr=[];for(var item in blingDotData){blingDotDataArr.push(blingDotData[item]);}
blingDot.data=showData;arrSeries[1]=blingDot;arrSeries[1].data=blingDotDataArr;arrSeries.push(seriesOne);}
showColor='';}
currentCount++;}
var xAxis=[{type:'category',boundaryGap:false,data:arrXAxis}];var option={title:{text:'',subtext:''},dataZoom:{show:false},legend:{data:dataName,icon:'circle',itemWidth:20,itemHeight:10,left:'center',top:'10'},xAxis:xAxis,series:arrSeries};var optionTemp={};$.extend(true,optionTemp,_this.optionDefault);if(_this.entity.modal.dsChartCog){if(_this.entity.modal.dsChartCog[0].upper!=''){optionTemp.yAxis[0].max=Number(_this.entity.modal.dsChartCog[0].upper);}
if(_this.entity.modal.dsChartCog[0].lower!=''){optionTemp.yAxis[0].min=Number(_this.entity.modal.dsChartCog[0].lower);}
if(_this.entity.modal.dsChartCog[0].unit!=''){optionTemp.yAxis[0].name=_this.entity.modal.dsChartCog[0].unit;}
if(_this.entity.modal.dsChartCog[0].accuracy!=''){var n=Number(_this.entity.modal.dsChartCog[0].accuracy);for(var i=0;i<option.series.length;i++){for(var j=0;j<option.series[i].data.length;j++){option.series[i].data[j]=option.series[i].data[j].toFixed(n);}}}
var tempMarkLine;for(var k=0;k<4;k++){if(_this.entity.modal.dsChartCog[0].markLine[k].value!=''){if(!option.series[0].markLine){option.series[0].markLine={data:[],symbol:'none',itemStyle:{normal:{label:{show:false}}}};}
tempMarkLine=[{name:_this.entity.modal.dsChartCog[0].markLine[k].name,value:_this.entity.modal.dsChartCog[0].markLine[k].value,xAxis:-1,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)},{xAxis:dataSrc.timeShaft.length,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)}];option.series[0].markLine.data.push(tempMarkLine);}}}
_this.chart.clear();_this.chart.setOption($.extend(true,{},optionTemp,option));}).error(function(e){}).always(function(e){_this.spinner.stop();});},ModalHistoryChartYearOnYearLine.prototype.updateModal=function(options){var _this=this;var modalOptions=this.entity.modal.option;var lastIndex,lastTick,nowTick;if(undefined===options||options.length<1||undefined===options[0]){return;}
lastIndex=this.chart.getOption().series[1].data.length-1;lastTick=this.store.timeShaft[lastIndex].toDate().valueOf();nowTick=new Date().valueOf();if(lastTick===undefined)return;if('hour'===modalOptions.timeType){lastTick+=3600000;refreshInterval=300000;}
if('day'===modalOptions.timeType){lastTick+=86400000;refreshInterval=3600000;}else{return;}
if(nowTick<lastTick+refreshInterval)return;var opt=_this.chart.getOption();for(var i=0,len=options.length;i<len;i++){if(options[i].data!==null){opt.series[1].data.push(options[i].data);}}
_this.chart.setOption(opt);var dataSeries=_this.chart.getOption().series;if(dataSeries.length<2){return;}
var temp=dataSeries[1].data;var lastCntX=temp.length-1;var lastCntY=Number(temp[lastCntX]);var showMark={symbol:'emptyCircle',symbolSize:10,effect:{show:true,shadowBlur:0},itemStyle:{normal:{label:{show:false}},emphasis:{label:{position:'top'}}},data:[{name:'',value:lastCntY,xAxis:lastCntX,yAxis:lastCntY}]};_this.chart.addMarkPoint(1,showMark);},ModalHistoryChartYearOnYearLine.prototype.showConfigMode=function(){},ModalHistoryChartYearOnYearLine.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.option.showType=option.showType?option.showType:'line';this.entity.modal.option.timeType=option.timeType;};ModalHistoryChartYearOnYearLine.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();this.m_bIsGoBackTrace=false;};return ModalHistoryChartYearOnYearLine;}();var ModalHistoryChartYearOnYearBar=function(){var m_color=['#e74a37','#ff8050','#1abd9b','#3499da','#3e72ac'];function ModalHistoryChartYearOnYearBar(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigModal=_showConfigMode?_showConfigMode:this.showConfigMode;ModalBase.call(this,screen,entityParams,renderModal,updateModal,showConfigModal);this.m_bIsGoBackTrace=false;this.m_traceData=undefined;this.option=entityParams.option;this.chart=echarts.init(this.container,AppConfig.chartTheme);this.spinner.spin(this.container);};ModalHistoryChartYearOnYearBar.prototype=new ModalBase();ModalHistoryChartYearOnYearBar.prototype.optionTemplate={name:'toolBox.modal.HIS_CHART_YEAR_BAR',parent:1,mode:['easyCompare'],maxNum:1,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalHistoryChartYearOnYearBar'};ModalHistoryChartYearOnYearBar.prototype.optionDefault={tooltip:{trigger:'axis'},toolbox:{show:false,feature:{dataView:{show:false,readOnly:true},magicType:{show:true,type:['line','bar']},restore:{show:true},saveAsImage:{show:true}}},calculable:false,dataZoom:{show:false},xAxis:[{type:'category',splitLine:{show:false}}],yAxis:[{type:'value',splitArea:{show:false}}],animation:true};ModalHistoryChartYearOnYearBar.prototype.renderModal=function(){var _this=this;var hourMilSec=3600000;var dayMilSec=86400000;var weekMilSec=604800000;var startDate=new Date();var endDate=new Date();var startDateZero=new Date();var endDateZero=new Date();var timeType;if('day'==_this.entity.modal.option.timeType){timeType='h1';startDate.setTime(endDate.getTime()-dayMilSec);startDateZero.setTime(startDate.getTime());startDateZero.setHours(0);startDateZero.setMinutes(0);startDateZero.setSeconds(0);endDateZero.setTime(endDate.getTime());endDateZero.setHours(0);endDateZero.setMinutes(0);endDateZero.setSeconds(0);}else{return;}
var optPtName=_this.entity.modal.points;if(optPtName.length>1){return;}
var curDate,startTime,endTime;if(!_this.m_bIsGoBackTrace){startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=endDate.format('yyyy-MM-dd HH:mm:ss');_this.optionDefault.animation=true;}else{curDate=_this.m_traceData.currentTime;_this.optionDefault.animation=false;if('day'==_this.entity.modal.option.timeType){timeType='h1';startDate.setTime(curDate.getTime()-dayMilSec);startDateZero.setTime(startDate.getTime());startDateZero.setHours(0);startDateZero.setMinutes(0);startDateZero.setSeconds(0);endDateZero.setTime(curDate.getTime());endDateZero.setHours(0);endDateZero.setMinutes(0);endDateZero.setSeconds(0);}else{return;}
startTime=startDate.format('yyyy-MM-dd HH:mm:ss');endTime=curDate.format('yyyy-MM-dd HH:mm:ss');}
WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:optPtName,timeStart:startDateZero.format('yyyy-MM-dd HH:mm:ss'),timeEnd:endDate.format('yyyy-MM-dd HH:mm:ss'),timeFormat:timeType}).done(function(dataSrc){if(!dataSrc||!dataSrc.list[0].data||!dataSrc.timeShaft||dataSrc.timeShaft.length<=0){return;}
var flag1,flag2;var len=dataSrc.timeShaft.length;for(var i=0;i<len;i++){if(dataSrc.timeShaft[i].toDate()>=startDate){flag1=i;break;}}
for(var i=0;i<len;i++){if(dataSrc.timeShaft[i].toDate()>=endDateZero){flag2=i;break;}}
var arrVal1=[];var arrVal2=[];var val1=0;var val2=0;var fixNum1=0;var fixNum2=0;var preVal=0;for(var i=0;i<dataSrc.list.length;i++){var key=dataSrc.list[i].dsItemId;for(var j=0,len=dataSrc.list[i].data.length;j<len;j++){if(j==flag1){preVal=dataSrc.list[i].data[0];if(0==preVal){val1=0;}else{val1=dataSrc.list[i].data[j]-preVal;}}else if(j==flag2){preVal=dataSrc.list[i].data[j];if(0==preVal){val2=0;}else{val2=dataSrc.list[i].data[len-1]-preVal;}}}
if(val1<100){fixNum1=2;}else{fixNum1=0;}
if(val2<100){fixNum2=2;}else{fixNum2=0;}
arrVal1.push(parseFloat(val1.toFixed(fixNum1)));arrVal2.push(parseFloat(val2.toFixed(fixNum2)));break;}
var tmFlag=new Date();var arrXAxis=[];tmFlag=tmFlag.format('yyyy-MM-dd HH:mm:ss');for(flagCount=0;flagCount<len;flagCount++){if(dataSrc.timeShaft[flagCount]>=tmFlag){break;}}
for(var k=0,lenK=Math.min(flagCount,dataSrc.timeShaft.length);k<lenK;k++){arrXAxis.push(dataSrc.timeShaft[k].toDate().format("HH:mm"));}
var xAxis=[{type:'category',boundaryGap:true,data:arrXAxis}];var chartType=_this.entity.modal.option.showType?_this.entity.modal.option.showType:'bar';var dataName=[];dataName.push(I18n.resource.dataSource.TIME_YESTERDAY);dataName.push(I18n.resource.dataSource.TIME_TODAY);var arrSeries=[{name:dataName[0],type:chartType,data:arrVal1,itemStyle:{normal:{color:m_color[2],barBorderRadius:[5,5,0,0]},emphasis:{color:m_color[2],barBorderRadius:[5,5,0,0]}},markPoint:{data:[{type:'max',name:I18n.resource.dashboard.modalHistoryChart.EnergyConsumption}]}},{name:dataName[1],type:chartType,data:arrVal2,itemStyle:{normal:{color:m_color[1],barBorderRadius:[5,5,0,0]},emphasis:{color:m_color[1],barBorderRadius:[5,5,0,0]}},markPoint:{data:[{type:'max',name:I18n.resource.dashboard.modalHistoryChart.EnergyConsumption}]}}];var option={title:{text:'',subtext:''},dataZoom:{show:false},legend:{data:dataName,icon:'circle',itemWidth:20,itemHeight:10,left:'center',top:'10'},xAxis:xAxis,series:arrSeries};var optionTemp={};$.extend(true,optionTemp,_this.optionDefault);if(_this.entity.modal.dsChartCog){if(_this.entity.modal.dsChartCog[0].upper!=''){optionTemp.yAxis[0].max=Number(_this.entity.modal.dsChartCog[0].upper);}
if(_this.entity.modal.dsChartCog[0].lower!=''){optionTemp.yAxis[0].min=Number(_this.entity.modal.dsChartCog[0].lower);}
if(_this.entity.modal.dsChartCog[0].unit!=''){optionTemp.yAxis[0].name=_this.entity.modal.dsChartCog[0].unit;}
if(_this.entity.modal.dsChartCog[0].accuracy!=''){var n=Number(_this.entity.modal.dsChartCog[0].accuracy);for(var i=0;i<option.series.length;i++){for(var j=0;j<option.series[i].data.length;j++){option.series[i].data[j]=option.series[i].data[j].toFixed(n);}}}
var tempMarkLine;for(var k=0;k<4;k++){if(_this.entity.modal.dsChartCog[0].markLine[k].value!=''){if(!option.series[0].markLine){option.series[0].markLine={data:[],symbol:'none',itemStyle:{normal:{label:{show:false}}}};}
tempMarkLine=[{name:_this.entity.modal.dsChartCog[0].markLine[k].name,value:_this.entity.modal.dsChartCog[0].markLine[k].value,xAxis:-1,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)},{xAxis:dataSrc.timeShaft.length,yAxis:Number(_this.entity.modal.dsChartCog[0].markLine[k].value)}];option.series[0].markLine.data.push(tempMarkLine);}}}
_this.chart.clear();_this.chart.setOption($.extend(true,{},optionTemp,option));}).error(function(e){}).always(function(e){_this.spinner.stop();});},ModalHistoryChartYearOnYearBar.prototype.updateModal=function(options){},ModalHistoryChartYearOnYearBar.prototype.showConfigMode=function(){},ModalHistoryChartYearOnYearBar.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.option.showType='bar';this.entity.modal.option.timeType=option.timeType;};ModalHistoryChart.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();this.m_bIsGoBackTrace=false;};return ModalHistoryChartYearOnYearBar;}();var ModalMultiple=function(){function ModalMultiple(screen,entityParams,_renderModal,_updateModal,_showConfigMode){if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalRealtimeLine.call(this,screen,entityParams,renderModal,updateModal,null);this.m_bIsGoBackTrace=false;this.m_traceData=undefined;};ModalMultiple.prototype=new ModalRealtimeLine();ModalMultiple.prototype.optionTemplate={name:'toolBox.modal.MULTIPLE',parent:0,mode:['multiple'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalMultiple',modelParams:{paraName:['line','bar','area','cumulativeBar'],paraShowName:{'line':'Line Chart Parameters','bar':"Bar Chart Parameters",'area':"Area Chart Parameters",'cumulativeBar':"Cumulative Bar Chart Parameters"},paraAnlysMode:'part'},tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalMultiple.prototype.renderModal=function(){};ModalMultiple.prototype.updateModal=function(points){if(points.length<1)return;var _this=this;var now=new Date();if(!this.lastRenderTime||now.getTime()-this.lastRenderTime>this.dicPeriod[_this.entity.modal.option.timeFormat]){var pointNameList=function(points){var arr=[];for(var i=0;i<points.length;i++){arr.push(points[i].dsItemId);}
return arr;}(points);var endTime;if(!_this.m_bIsGoBackTrace){endTime=new Date().format('yyyy-MM-dd HH:mm:ss');_this.optionDefault.animation=false;}else{this.m_bIsGoBackTrace=false;endTime=new Date(_this.m_traceData.currentTime).format('yyyy-MM-dd HH:mm:ss');_this.optionDefault.animation=false;}
var startTime=endTime.split(' ')[0]+' 00:00:00';this.lastRenderTime=now;WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:pointNameList,timeStart:startTime,timeEnd:endTime,timeFormat:'h1'}).done(function(dataSrc){if(dataSrc==undefined||dataSrc.length<=0){return;}
var entityItem=_this.dealWithData(dataSrc,2);var option={tooltip:{extraCssText:'text-align: left;'},legend:function(){if(AppConfig.isMobile){return{data:entityItem.arrLegend,top:25};}else{return{data:entityItem.arrLegend};}}(),grid:function(){if(AppConfig.isMobile){return{x2:40,top:80};}else{return{x2:50};}}(),xAxis:[{data:['00:00','01:00','02:00','03:00','04:00','05:00','06:00','07:00','08:00','09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00'],boundaryGap:true}],yAxis:[{type:'value',scale:false,splitArea:{show:false}},{type:'value',scale:false,splitArea:{show:false},splitLine:{show:false}}],series:entityItem.arrSeries};if(option.series instanceof Array){var lastType=-1;option.series.forEach(function(item){if(lastType==-1){lastType=item.yAxisIndex;}else{if(item.yAxisIndex!=lastType){lastType='multi';}}});if(lastType!='multi'){option.series.forEach(function(item,index,self){self[index].yAxisIndex=0;});option.yAxis=[option.yAxis[0]];}}
if(AppConfig.isMobile){option.legend={data:entityItem.arrLegend,itemWidth:15,itemHeight:10,textStyle:{fontSize:12}};option.xAxis[0].axisLabel={textStyle:{color:'#e2dfe4'}};var yAxisList=option.yAxis;for(var i=0;i<yAxisList.length;i++){yAxisList[i].axisLabel={textStyle:{color:'#e2dfe4'}};}}
if(_this.entity.modal.dsChartCog){var ptIndex=0;var tempChartMax,tempChartMin;var targetAxis;tempChartMax=null;tempChartMin=null;for(var m=0;m<4;++m){if(!_this.entity.modal.option.paraType[m].arrId.length)continue;if(lastType=='multi'&&m==1){targetAxis=option.yAxis[1];}else{targetAxis=option.yAxis[0];}
if(_this.entity.modal.dsChartCog[m].upper!=''){if(tempChartMax==null||tempChartMax<Number(_this.entity.modal.dsChartCog[m].upper)){tempChartMax=Number(_this.entity.modal.dsChartCog[m].upper);}}
if(_this.entity.modal.dsChartCog[m].lower!=''){if(tempChartMin==null||tempChartMin>Number(_this.entity.modal.dsChartCog[m].lower)){tempChartMin=Number(_this.entity.modal.dsChartCog[m].lower);}}
if(_this.entity.modal.dsChartCog[m].unit!=''){targetAxis.name=_this.entity.modal.dsChartCog[m].unit;}
if(_this.entity.modal.dsChartCog[m].accuracy!=''){var n=Number(_this.entity.modal.dsChartCog[m].accuracy);for(var i=0;i<_this.entity.modal.option.paraType[m].arrId.length;i++){for(var j=0;j<option.series[ptIndex].data.length;j++){option.series[ptIndex].data[j]=Number(option.series[ptIndex].data[j]).toFixed(n);}
ptIndex+=1;}}
if(tempChartMax!=null&&targetAxis){targetAxis.max=Number(tempChartMax);}
if(tempChartMin!=null&&targetAxis){targetAxis.min=Number(tempChartMin);}}
var tempMarkLine;var seriesNum=0;for(var l=0;l<4;l++){for(var index=0;index<_this.entity.modal.option.paraType[l].arrId.length;++index){for(var k=0;k<4;k++){if(_this.entity.modal.dsChartCog[l].markLine[k].value){if(!option.series[seriesNum].markLine){option.series[seriesNum].markLine={data:[],symbol:'none',itemStyle:{normal:{label:{show:false}}}};}
tempMarkLine=[{name:_this.entity.modal.dsChartCog[l].markLine[k].name,value:_this.entity.modal.dsChartCog[l].markLine[k].value,xAxis:-1,yAxis:Number(_this.entity.modal.dsChartCog[l].markLine[k].value)},{xAxis:dataSrc.timeShaft.length,yAxis:Number(_this.entity.modal.dsChartCog[l].markLine[k].value)}];option.series[seriesNum].markLine.data.push(tempMarkLine);}}
seriesNum++;}}}
!_this.chart&&(_this.chart=echarts.init(_this.container,AppConfig.chartTheme));_this.chart.clear();_this.chart.setOption($.extend(true,{},_this.optionDefault,option));}).error(function(e){}).always(function(e){});}};ModalMultiple.prototype.dealWithData=function(points){if(points.error){this.container.innerHTML='<div id="dataAlert" ></div>';new Alert($("#dataAlert"),"danger","<strong>"+points.error+"</strong>").show();return;}
var arr={arrLegend:{},arrSeries:{}};arr.arrLegend=[];arr.arrSeries=[];var arrTempPoints=[];var dataType=this.entity.modal.option.paraType;for(var i=0;i<dataType.length;++i){for(var j=0;j<dataType[i].arrId.length;++j){arrTempPoints.push({dsItemId:dataType[i].arrId[j]});}}
var arrPointAlias=this.initPointAlias(arrTempPoints);var tempNum=0;for(var i=0;i<dataType.length;i++){switch(dataType[i].type){case'bar':for(var j=0;j<dataType[i].arrId.length;j++){for(var k=0;k<points.list.length;++k){if(dataType[i].arrId[j]==points.list[k].dsItemId){if(!AppConfig.isMobile){var series={name:arrPointAlias[tempNum],type:'bar',symbol:'none',itemStyle:{normal:{areaStyle:{type:'default'}}},smooth:true,data:points.list[k].data,yAxisIndex:0};}else{var series={name:arrPointAlias[tempNum],type:'bar',symbol:'none',barGap:0.1,barCategoryGap:0.01,itemStyle:{normal:{shadowBlur:40,shadowColor:'rgba(0, 0, 0, 0.5)',areaStyle:{type:'default'}}},smooth:true,data:points.list[k].data,yAxisIndex:0};}
arr.arrLegend.push(arrPointAlias[tempNum]);arr.arrSeries.push(series);tempNum+=1;break;}}}
break;case'line':for(var j=0;j<dataType[i].arrId.length;j++){for(var k=0;k<points.list.length;++k){if(dataType[i].arrId[j]==points.list[k].dsItemId){var series={name:arrPointAlias[tempNum],type:'line',symbol:'none',smooth:true,data:points.list[k].data,yAxisIndex:1,z:3};arr.arrLegend.push(arrPointAlias[tempNum]);arr.arrSeries.push(series);tempNum+=1;break;}}}
break;case'area':for(var j=0;j<dataType[i].arrId.length;j++){for(var k=0;k<points.list.length;++k){if(dataType[i].arrId[j]==points.list[k].dsItemId){var series={name:arrPointAlias[tempNum],type:'line',symbol:'none',itemStyle:{normal:{}},smooth:true,data:points.list[k].data,yAxisIndex:0,z:3};arr.arrLegend.push(arrPointAlias[tempNum]);arr.arrSeries.push(series);tempNum+=1;break;}}}
break;case'cumulativeBar':for(var j=0;j<dataType[i].arrId.length;j++){for(var k=0;k<points.list.length;++k){if(dataType[i].arrId[j]==points.list[k].dsItemId){if(!AppConfig.isMobile){var series={name:arrPointAlias[tempNum],type:'bar',stack:'',symbol:'none',itemStyle:{normal:{areaStyle:{type:'default'}}},smooth:true,data:points.list[k].data,yAxisIndex:0};}else{var series={name:arrPointAlias[tempNum],type:'bar',stack:'',barGap:0.1,barCategoryGap:0.01,symbol:'none',itemStyle:{normal:{shadowBlur:40,shadowColor:'rgba(0, 0, 0, 0.5)',areaStyle:{type:'default'}}},smooth:true,data:points.list[k].data,yAxisIndex:0};}
arr.arrLegend.push(arrPointAlias[tempNum]);arr.arrSeries.push(series);tempNum+=1;break;}}}
break;}}
return arr;};ModalMultiple.prototype.setModalOption=function(option){this.entity.modal.option={};this.entity.modal.interval=5;this.entity.modal.option.paraType=option.paraType;};ModalMultiple.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();};return ModalMultiple;}();var ModalPredictPointLineConfig=function($,window,undefined){var _this;function ModalPredictPointLineConfig(options){_this=this;ModalConfig.call(this,options);}
ModalPredictPointLineConfig.prototype=Object.create(ModalConfig.prototype);ModalPredictPointLineConfig.prototype.constructor=ModalPredictPointLineConfig;ModalPredictPointLineConfig.prototype.DEFAULTS={htmlUrl:'/static/views/observer/widgets/modalPredictPointLineConfig.html'};ModalPredictPointLineConfig.prototype.init=function(){this.$formWrap=$('.form-wrap',this.$wrap);this.$iptChartYaxisMin=$('.ipt-chart-y-axis-min',this.$formWrap);this.$iptChartYaxisMax=$('.ipt-chart-y-axis-max',this.$formWrap);this.$iptChartValUnits=$('.ipt-chart-val-units',this.$formWrap);this.$iptChartValPrecision=$('.ipt-chart-val-precision',this.$formWrap);this.$btnOptionMode=$('.btn-option-mode',this.$formWrap);this.$btnTimeMode=$('.btn-time-mode',this.$formWrap);this.$btnPredictMode=$('.btn-predict-mode',this.$formWrap);this.$divTargetPoint=$('.div-target-point',this.$formWrap);this.$divPredictPoint=$('.div-predict-point',this.$formWrap);this.$btnSubmit=$('.btn-submit',this.$wrap);this.$dropArea=$('.drop-area',this.$formWrap);this.attachEvents();};ModalPredictPointLineConfig.prototype.recoverForm=function(modal){var name,form,dsChartConfig;if(!modal)return;form=modal.option;dsChartConfig=modal.dsChartCog&&modal.dsChartCog.length?modal.dsChartCog[0]:{};if(!form)return;this._setField('input',this.$iptChartYaxisMin,dsChartConfig.lower);this._setField('input',this.$iptChartYaxisMax,dsChartConfig.upper);this._setField('input',this.$iptChartValUnits,dsChartConfig.unit);this._setField('input',this.$iptChartValPrecision,dsChartConfig.accuracy);this._setField('droparea',this.$divTargetPoint,form.targetPointId);this._setField('droparea',this.$divPredictPoint,form.predictPointId);this._setField('dropdown',this.$btnOptionMode,form.optionsMode);this._setField('dropdown',this.$btnTimeMode,form.timeMode);this._setField('dropdown',this.$btnPredictMode,form.predictMode);};ModalPredictPointLineConfig.prototype.reset=function(){this._setField('input',this.$iptChartYaxisMin);this._setField('input',this.$iptChartYaxisMax);this._setField('input',this.$iptChartValUnits);this._setField('input',this.$iptChartValPrecision);this._setField('droparea',this.$divTargetPoint);this._setField('droparea',this.$divPredictPoint);this._setField('dropdown',this.$btnOptionMode);this._setField('dropdown',this.$btnTimeMode);this._setField('dropdown',this.$btnPredictMode);};ModalPredictPointLineConfig.prototype.attachEvents=function(){this.$btnSubmit.off().click(function(e){var modalIns=_this.options.modalIns;var modal=modalIns.entity.modal;var dsChartConfig={},form={};var val;val=parseFloat(_this.$iptChartYaxisMin.val());dsChartConfig.lower=!isNaN(val)?val:'';val=parseFloat(_this.$iptChartYaxisMax.val());dsChartConfig.upper=!isNaN(val)?val:'';val=parseInt(_this.$iptChartValPrecision.val());dsChartConfig.accuracy=!isNaN(val)?val:'';dsChartConfig.unit=_this.$iptChartValUnits.val();form.optionMode=parseInt(_this.$btnOptionMode.attr('data-value'));form.timeMode=parseInt(_this.$btnTimeMode.attr('data-value'));form.predictMode=parseInt(_this.$btnPredictMode.attr('data-value'));form.targetPointId=_this.$divTargetPoint.attr('data-value');form.predictPointId=_this.$divPredictPoint.attr('data-value');modal.dsChartCog=[dsChartConfig];modal.option=form;modal.points=form.predictMode===0?[form.targetPointId,form.predictPointId]:[form.targetPointId];modal.interval=60000;_this.$modal.modal('hide');e.preventDefault();});};return ModalPredictPointLineConfig;}(jQuery,window);var ModalPredictPointLine=function($,window,undefined){function ModalPredictPointLine(screen,entityParams,_renderModal,_updateModal,_showConfigMode){var _this=this;if(!screen)return;var renderModal=_renderModal?_renderModal:this.renderModal;var updateModal=_updateModal?_updateModal:this.updateModal;var showConfigMode=_showConfigMode?_showConfigMode:this.showConfigMode;ModalRealtimeLine.call(this,screen,entityParams,renderModal,updateModal,null);this.chart=null;this.chartOptions=$.extend(true,{},this.optionDefault,DEFAULTS_CHARTS_OPTIONS);this.period=null;this.firstload=$.Deferred();this.m_bIsGoBackTrace=false;this.m_traceData=undefined;};ModalPredictPointLine.prototype=Object.create(ModalRealtimeLine.prototype);ModalPredictPointLine.prototype.constructor=ModalPredictPointLine;ModalPredictPointLine.prototype.optionTemplate={name:'toolBox.modal.REAL_TIME_PREDICT_POINT_LINE',parent:0,mode:'custom',maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalPredictPointLine',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalPredictPointLine.prototype.renderModal=function(){var _this=this;var modal=this.entity.modal;var dsChartOption=modal.dsChartCog&&modal.dsChartCog.length?modal.dsChartCog[0]:{};var option=modal.option;var chartYaxisMin=dsChartOption.lower;var chartYaxisMax=dsChartOption.upper;var chartValUnits=dsChartOption.unit;var chartValPrecision=dsChartOption.accuracy;var timeMode=option.timeMode;var targetPointId=this.entity.modal.points[0];var predictPointId=option.predictPointId;var predictMode=option.predictMode;var period=this.period=this.getPeriod(timeMode);var params=[];var dsName=[];if(predictMode===undefined)predictMode=option.predictMode=0;params.push({dsItemIds:[targetPointId],timeStart:period.startTime,timeEnd:period.endTime,timeFormat:period.tmFmt});dsName=AppConfig.datasource.getDSItemById(targetPointId).alias||targetPointId;this.chartOptions.legend.data=[dsName];this.chartOptions.series[0].name=dsName;if(predictMode===1&&period.endTime<period.rangeEndTime){params.push({dsItemIds:[predictPointId],timeStart:period.endTime,timeEnd:period.rangeEndTime,timeFormat:period.tmFmt});this.chartOptions.legend.data.push('Predict Line');}
if(chartYaxisMin!=='')this.chartOptions.yAxis[0].min=chartYaxisMin;if(chartYaxisMax!=='')this.chartOptions.yAxis[0].max=chartYaxisMax;this.chartOptions.yAxis[0].name=chartValUnits;if(chartValPrecision==='')chartValPrecision=2;WebAPI.post('/analysis/startWorkspaceDataGenHistogramMulti',params).done(function(rsList){var predictData;var i,t,leni,lent;for(i=0,leni=rsList.length;i<leni;i++){rsList[i].list[0].data=rsList[i].list[0].data.map(function(row,i){return row.toFixed(chartValPrecision);});}
_this.chartOptions.xAxis[0].data=_this.period.timeShaft;predictData=rsList[0].list[0].data;predictData[0]=rsList[0].list[0].data[rsList[0].list[0].data.length-1];predictData=predictData.concat(new Array(_this.period.timeShaft.length-predictData.length+1).join('-').split(''));_this.chartOptions.series[0].data=predictData;if(_this.chart){_this.chart.clear();_this.chart=null;}
_this.chart=echarts.init(_this.container,AppConfig.chartTheme);if(predictMode===1&&rsList[1]){_this.chartOptions.legend.data.push();predictData=rsList[1].list[0].data;predictData[0]=rsList[0].list[0].data[rsList[0].list[0].data.length-1];predictData=new Array(_this.period.timeShaft.length-predictData.length+1).join('-').split('').concat(predictData);_this.chartOptions.series.push({type:'line',name:'Predict Line',symbol:'none',itemStyle:{normal:{lineStyle:{type:'dotted'},color:'#6495ed',label:{position:'right'}}},data:predictData});_this.chart.clear();_this.chart.setOption(_this.chartOptions);return;}
_this.firstload.done(function(points){_this.updateModal(points,true);});});};ModalPredictPointLine.prototype.updateModal=function(points,force){if(this.firstload.state()==='pending')return this.firstload.resolve(points);if(!points||points.length===0)return;var _this=this;var data=this.chartOptions.series[0].data,predictData;var timeShaft=this.chartOptions.xAxis[0].data;var modal=this.entity.modal;var predictMode=modal.option.predictMode;var pointVal,predictPointVal;var pointId=modal.points[0],predictPointId=modal.points[1];var timeInterval=this.period.tmInterval;var dataLen=data.indexOf('-')-1,timeLen=timeShaft.length;var lastTickVal=timeShaft[dataLen].toDate().valueOf();var nowTick=new Date().valueOf();var row,i,len;force=force===undefined?false:force;if(nowTick-lastTickVal<this.period.tmInterval&&!force)return;for(i=0,len=points.length;i<len;i++){row=points[i];if(row.dsItemId===pointId){pointVal=parseFloat(row.data);}
if(row.dsItemId===predictPointId){predictPointVal=parseFloat(row.data);}}
if(pointVal!==undefined&&!force){pointVal=Math.round(pointVal*1000)/1000;data.push(pointVal);}
if(predictMode===1){if(!this.chartOptions.series[1])return;predictData=this.chartOptions.series[1].data;if(predictData[predictData.length-1]==='-'){this.chartOptions.series.pop();}
else{predictData.splice(predictData.lastIndexOf('-')+1,1,'-');}
if(predictData[predictData.length-1]!=='-'){predictData.splice(predictData.lastIndexOf('-')+1,1,pointVal);}}
else if(predictPointVal!==undefined){dataLen=data.indexOf('-')-1;if(dataLen===timeLen){timeShaft.push(new Date(lastTickVal+timeInterval).format('yyyy-MM-dd HH:00:00'));}
this.chartOptions.series[0].markPoint.data=[{name:'Predict Value',value:predictPointVal,xAxis:dataLen+1,yAxis:predictPointVal}];lastVal=data[data.indexOf('-')-1];var seriesRepeat=$.extend(true,{},this.chartOptions.series[0]);var seriesOne=this.chartOptions.series[0];seriesRepeat.data[dataLen+1]=predictPointVal;for(var i=0;i<=dataLen;i++){seriesRepeat.data[i]='-';}
seriesRepeat['lineStyle']={normal:{color:'#81a9f0',type:'dotted'}};seriesRepeat.type='effectScatter';seriesRepeat.markLine.data=[[{xAxis:dataLen,yAxis:lastVal},{xAxis:dataLen+1,yAxis:predictPointVal}]];seriesRepeat.markLine.label.normal.show=false;seriesRepeat.showEffectOn='render';seriesRepeat.rippleEffect={brushType:'stroke'};seriesRepeat.itemStyle={normal:{color:'#6898ed',shadowBlur:10,shadowColor:'#333'}};seriesRepeat.symbol='circle';seriesRepeat.symbolSize=10;seriesOne['lineStyle']={normal:{color:'#e84c3d'}};this.chartOptions.series.push(seriesRepeat);}
this.chart.setOption(this.chartOptions);};ModalPredictPointLine.prototype.getPeriod=function(timeMode){var _this=this;var now,tmFmt,tmInterval,tick,endTick;var start,end;var timeShaft=[];if(!this.m_bIsGoBackTrace){now=new Date();_this.optionDefault.animation=true;}else{now=this.m_traceData.currentTime;_this.optionDefault.animation=false;}
switch(timeMode){case 0:tmFmt='h1';tmInterval=3600000;start=now.format('yyyy-MM-dd')+' 00:00:00';end=now.format('yyyy-MM-dd HH:00:00');endTick=end.toDate().valueOf();deadlineTick=Math.max(start.toDate().valueOf()+86400000,endTick+28800000);break;case 1:default:tmFmt='d1';tmInterval=86400000;start=now.format('yyyy-MM')+'-01 00:00:00';end=now.format('yyyy-MM-dd 00:00:00');endTick=end.toDate().valueOf();if(this.entity.modal.option.predictMode===1){deadlineTick=now.valueOf()+604800000;}else{deadlineTick=Math.max(start.toDate().valueOf()+DateUtil.daysInMonth(now)*86400000,endTick+604800000);}
break;case 2:tmFmt='h1';tmInterval=3600000;start=new Date(now.valueOf()-(now.getDay()+6)%7*86400000).format('yyyy-MM-dd 00:00:00');end=now.format('yyyy-MM-dd HH:00:00');endTick=end.toDate().valueOf();deadlineTick=Math.max(start.toDate().valueOf()+604800000,endTick+144000000);break;};tick=start.toDate().valueOf();while(tick<deadlineTick){timeShaft.push(tick.toDate().format('yyyy-MM-dd HH:00:00'));tick+=tmInterval;};return{startTime:start,endTime:end,rangeStartTime:start,rangeEndTime:timeShaft[timeShaft.length-1],tmFmt:tmFmt,tmInterval:tmInterval,timeShaft:timeShaft,deadlineTick:deadlineTick};};ModalPredictPointLine.prototype.showConfigModal=function(container,options){this.configModal.setOptions({modalIns:this});this.configModal.show();};ModalPredictPointLine.prototype.setOptions=function(options){this.options=$.extend({},this.opitons,options);};ModalPredictPointLine.prototype.setModalOption=function(option){};ModalPredictPointLine.prototype.configModal=new ModalPredictPointLineConfig();ModalPredictPointLine.prototype.goBackTrace=function(data){this.m_bIsGoBackTrace=true;this.m_traceData=data;this.renderModal();this.m_bIsGoBackTrace=false;};var DEFAULTS_CHARTS_OPTIONS={tooltip:{formatter:function formatter(p){var arrHtml=[p[0].name];p.forEach(function(row){if(row.value==='-')return;arrHtml.push(row.seriesName+': '+row.value);});return arrHtml.join('<br/>');}},series:[{markPoint:{symbol:'emptyCircle',symbolSize:5,effect:{show:true,shadowBlur:0},itemStyle:{normal:{color:'#6495ed',label:{position:'top'}}},data:[]},markLine:{symbol:'circle',symbolSize:1.5,itemStyle:{normal:{lineStyle:{type:'dotted'},color:'#6495ed',label:{position:'right'}}},label:{normal:{show:true}},tooltip:{show:false},data:[]}}],toolbox:{show:false}};return ModalPredictPointLine;}(jQuery,window);var ModalMix=function(){function ModalMix(screen,entityParams){if(!entityParams)return;ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);!this.entity.modal.option&&(this.entity.modal.option={});!this.entity.modal.option.subChartIds&&(this.entity.modal.option.subChartIds=[]);!this.entity.modal.option.displayInterval&&(this.entity.modal.option.displayInterval=20);};ModalMix.prototype=new ModalBase();ModalMix.prototype.optionTemplate={name:'toolBox.modal.MIX',parent:0,mode:['realTimeDashboard'],maxNum:10,title:'',minHeight:2,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalMix',tooltip:{'imgPC':true,'imgMobile':true,'isSpecData':false,'desc':''}};ModalMix.prototype.show=function(){this.init();};ModalMix.prototype.init=function(){this.container.style.overflowX='hidden';this.container.style.overflowY='auto';};ModalMix.prototype.initContainer=function(replacedElementId){var divParent=document.getElementById('divContainer_'+this.entity.id);var isNeedCreateDivParent=false;var scrollClass=' gray-scrollbar scrollY';if(!divParent||replacedElementId){isNeedCreateDivParent=true;}
if(isNeedCreateDivParent){divParent=document.createElement('div');divParent.id='divContainer_'+this.entity.id;}
if(replacedElementId){var $old=$('#divContainer_'+replacedElementId);$(divParent).insertAfter($old);$old.remove();}else{isNeedCreateDivParent&&this.screen.container.appendChild(divParent);}
$(divParent).addClass('springContainer');if(AppConfig.isMobile||this.screen.isForMobile||this.screen.options&&this.screen.options.isForMobile||this.screen.screen&&this.screen.screen.options&&this.screen.screen.options.isForMobile){this.spanRange={minWidth:1,maxWidth:3,minHeight:1,maxHeight:4.5,yScale:4/3,xScale:4};}else{this.spanRange={minWidth:this.optionTemplate.minWidth,maxWidth:this.optionTemplate.maxWidth,minHeight:this.optionTemplate.minHeight,maxHeight:this.optionTemplate.maxHeight,yScale:1,xScale:1};}
if(AppConfig.isMobile||this.screen.options&&this.screen.options.isForMobile||this.screen.screen&&this.screen.screen.options&&this.screen.screen.options.isForMobile){var height=100;height=this.UNIT_HEIGHT*this.entity.spanR*this.spanRange.yScale;height>100&&(height=100);divParent.style.height=height+'%';divParent.style.width=this.UNIT_WIDTH*this.entity.spanC*this.spanRange.xScale+'%';if(this.UNIT_WIDTH*this.entity.spanC*this.spanRange.xScale>100){divParent.style.width='100%';}
if(this.UNIT_HEIGHT*this.entity.spanR*this.spanRange.yScale>100){divParent.style.height='100%';}}else{divParent.style.height=this.UNIT_HEIGHT*this.entity.spanR+'%';divParent.style.width=this.UNIT_WIDTH*this.entity.spanC+'%';}
if(this.entity.modal.title&&this.entity.modal.title!=''&&!this.entity.isNotRender){divParent.innerHTML='<div class="panel panel-default">\
                <div class="panel-heading springHead">\
                    <h3 class="panel-title" style="font-weight: bold;">'+this.entity.modal.title+'</h3>\
                </div>\
                <div class="panel-body springContent'+scrollClass+'" style="position: relative;"></div>\
            </div>';}else{divParent.innerHTML='<div class="panel panel-default">\
                <span class="springSeHead fontTemp6">'+(this.entity.modal.title?this.entity.modal.title:'')+'</span>\
                <div class="panel-body springContent'+scrollClass+'" style="position: relative;height:100%;"></div>\
            </div>';}
if(AppConfig.isMobile||this.screen.options&&this.screen.options.isForMobile||this.screen.screen&&this.screen.screen.options&&this.screen.screen.options.isForMobile){divParent.children[0].classList.add('transparent');}
if(!(this instanceof ModalAnalysis)){var divBtnCtn=document.createElement('div');divBtnCtn.className='springLinkBtnCtn';var domPanel=divParent.getElementsByClassName('panel')[0];if(this.entity.modal.points&&this.entity.modal.points.length>0){var lkJump;lkJump=document.createElement('a');lkJump.className='springLinkBtn';lkJump.title='Add to datasource';lkJump.href='javascript:;';lkJump.innerHTML='<span class="glyphicon glyphicon-export"></span>';divBtnCtn.appendChild(lkJump);lkJump.onclick=function(){new ModalAppendPointToDs(true,_this.entity.modal.points,null).show();};}
var link=this.entity.modal.link;var _this=this;if(link&&AppConfig.menu[link]){var linkBtn=document.createElement('a');linkBtn.className='springLinkBtn';linkBtn.innerHTML='<span class="glyphicon glyphicon-link"></span>';linkBtn.setAttribute('pageid',link);linkBtn.title='Link to '+AppConfig.menu[link];divBtnCtn.appendChild(linkBtn);linkBtn.onclick=function(e){var $ev=$('#ulPages [pageid="'+link+'"]');if($ev[0].className!='nav-btn-a'){$ev=$ev.children('a');$ev.closest('.dropdown').children('a').trigger('click');}
$ev.trigger('click');};}
domPanel.appendChild(divBtnCtn);}
this.container=divParent.getElementsByClassName('springContent')[0];return this;};ModalMix.prototype.renderModal=function(e){var _this=this;var $sliderCont;var $sliderDiv=$('.sliderDiv');if(_this.entity.modal.option.displaySlider&&!_this.entity.modal.option.displayInterval){_this.entity.modal.option.displayInterval=5;}
var displaySlider=_this.entity.modal.option.displayInterval;var carouselTime=new Date();this.container.classList.add('modalMix');if(displaySlider&&displaySlider!='0'){$sliderDiv=$('\
                                <div id="carousel_'+carouselTime.getTime()+'" class="carousel slide sliderDiv" data-ride="carousel">'+'<ol class="carousel-indicators" style="bottom:-6px;">'+'</ol><div class="carousel-inner" role="listbox">'+'</div>'+'<a class="left carousel-control" href="#carousel_'+carouselTime.getTime()+'" role="button" data-slide="prev">'+'<span class="glyphicon glyphicon-chevron-left" aria-hidden="true" style="transform: scale(1,1.3)"></span><span class="sr-only">Previous</span></a>'+'<a class="right carousel-control" href="#carousel_'+carouselTime.getTime()+'" role="button" data-slide="next">'+'<span class="glyphicon glyphicon-chevron-right" aria-hidden="true" style="transform: scale(1,1.3)"></span><span class="sr-only">Next</span></a>'+'</div>');$(_this.container).append($sliderDiv);if(AppConfig.isMobile){$(_this.container).append('<style>.carousel-indicators .active{background-color: rgb(242,199,83);border: none;width: 12px;height: 3px;border-radius: 0;}.carousel-indicators li{background-color: rgba(228, 228, 228,0.5);border-width: 0;width: 12px;height: 3px;margin:1.5px!important;}</style>');$('.carousel-control',_this.container).addClass('hidden');this.attachEventSlider();}}
if(!this.entity.modal.option||!this.entity.modal.option.subChartIds)return;var index=0;this.entity.modal.option.subChartIds.forEach(function(obj){for(var i=0,item;i<_this.screen.store.layout.length;i++){if(displaySlider&&displaySlider!='0'){$(_this.container).css({'display':'block','overflow-y':'hidden'});for(var z=0;z<_this.screen.store.layout[i].length;z++){item=_this.screen.store.layout[i][z];if(obj.id!=item.id)continue;var modelClass,entity;_this.screen.store.layout[i][z].spanC=12;var $sliderIner=$('<div class="item sliderIner"><div class="carousel-caption" style="height:100%;width:100%;right:0;left:0;padding-bottom:0;bottom:0px;padding-top:0px;"></div></div>');var $sliderDot=$('<li data-target="#carousel_'+carouselTime.getTime()+'" data-slide-to="'+index+'" style="border-color:#aaa;margin:1.5px 3px;"></li>');if(item.modal.type&&item.modal.type!='ModalNone'){modelClass=_this.screen.factoryIoC.getModel(item.modal.type);if(!modelClass)continue;if(item.isNotRender&&_this.entity.modal.type=='ModalMix'){entity=new modelClass(_this,item);_this.screen.listEntity[item.id]=entity;if(item.modal.type==='ModalAppButton'){if(entity){$(entity.container).height($(_this.container).height()-30);$(entity.container).width($(_this.container).width());}
entity.render();$sliderCont=$(_this.container).children('.springContainer');$sliderIner.children('.carousel-caption').append($sliderCont);$sliderIner.height($(_this.container).height());$sliderDiv.children('.carousel-inner').append($sliderIner);$sliderDiv.children('.carousel-indicators').append($sliderDot);++index;continue;}
if($.inArray(item.id,_this.screen.arrEntityOrder)<0){_this.screen.arrEntityOrder.push(item.id);}
if(item.modal.interval&&item.modal.interval>=0){for(var k=0,point,kLen=item.modal.points.length;k<kLen;k++){point=item.modal.points[k];if(_this.screen.requestPoints.indexOf(point)<0){_this.screen.requestPoints.push(point);}}}
if(item.modal.popId){if(!_this.screen.dictPopToEntity[item.modal.popId])_this.screen.dictPopToEntity[item.modal.popId]=[];_this.screen.dictPopToEntity[item.modal.popId].push(item.id);if(_this.screen.requestPoints.indexOf(item.modal.popId)<0){_this.screen.requestPoints.push(item.modal.popId);}}
if(entity){if(AppConfig.isMobile||_this.screen.options&&_this.screen.options.isForMobile){$(entity.container).height($(_this.container).height()-40);}else{if(entity.entity.modal.title!==''){$(entity.container).height($(_this.container).height()-60);}else{$(entity.container).height($(_this.container).height()-30);}}
$(entity.container).width($(_this.container).width());}
entity.render();}}else if(item.modal.type=='ModalNone'){modelClass=_this.screen.factoryIoC.getModel(item.modal.type);entity=new modelClass(_this,item);_this.screen.listEntity[item.id]=entity;_this.screen.arrEntityOrder.push(item.id);if(entity){$(entity.container).height($(_this.container).height()-30);$(entity.container).width($(_this.container).width());}
entity.render();_this.screen.isForReport&&entity.configure();}
$sliderCont=$(_this.container).children('.springContainer');$sliderIner.children('.carousel-caption').append($sliderCont);$sliderIner.height($(_this.container).height()-6);$sliderDiv.children('.carousel-inner').append($sliderIner);$sliderDiv.children('.carousel-indicators').append($sliderDot);++index;}}else{$(_this.container).css({'display':'flex','overflow-y':'auto','flex-flow':'wrap'});for(var j=0;j<_this.screen.store.layout[i].length;j++){item=_this.screen.store.layout[i][j];if(obj.id!=item.id)continue;var modelClass,entity;if(item.modal.type&&item.modal.type!='ModalNone'){modelClass=_this.screen.factoryIoC.getModel(item.modal.type);if(!modelClass)continue;if(item.isNotRender&&_this.entity.modal.type=='ModalMix'){entity=new modelClass(_this,item);_this.screen.listEntity[item.id]=entity;if(item.modal.type==='ModalAppButton'){entity.render();continue;}
if($.inArray(item.id,_this.screen.arrEntityOrder)<0){_this.screen.arrEntityOrder.push(item.id);}
if(item.modal.interval&&item.modal.interval>=0){for(var k=0,point,kLen=item.modal.points.length;k<kLen;k++){point=item.modal.points[k];if(_this.screen.requestPoints.indexOf(point)<0){_this.screen.requestPoints.push(point);}}}
if(item.modal.popId){if(!_this.screen.dictPopToEntity[item.modal.popId])_this.screen.dictPopToEntity[item.modal.popId]=[];_this.screen.dictPopToEntity[item.modal.popId].push(item.id);if(_this.screen.requestPoints.indexOf(item.modal.popId)<0){_this.screen.requestPoints.push(item.modal.popId);}}
entity.render();}}else if(item.modal.type=='ModalNone'){modelClass=_this.screen.factoryIoC.getModel(item.modal.type);entity=new modelClass(_this,item);_this.screen.listEntity[item.id]=entity;_this.screen.arrEntityOrder.push(item.id);entity.render();_this.screen.isForReport&&entity.configure();}}}}});if(displaySlider){if($(_this.container).find('.item:first')){$(_this.container).find('.item:first').addClass('active');}
if($(_this.container).find('.carousel-indicators').children(':first')){$(_this.container).find('.carousel-indicators').children(':first').addClass('active');}
$(_this.container).find('.sliderDiv').carousel({interval:this.entity.modal.option.displayInterval*1000});}
if(this.entity.modal.option.bgColor){this.container.style.backgroundColor=this.entity.modal.option.bgColor;$(this.container).find('.panel.panel-default').css('cssText','background-color:transparent !important');}};ModalMix.prototype.showConfigMode=function(){};ModalMix.prototype.updateModal=function(points){for(var i in points){var data=points[i].data;if(!isNaN(data)){data=parseFloat(data).toFixed(2);}
$('#'+points[i].dsItemId).html(data);}};ModalMix.prototype.setModalOption=function(option){this.entity.modal.interval=5;};ModalMix.prototype.configure=function(){if(this.spinner)this.spinner.stop();var _this=this;if(this.chart)this.chart.clear();this.divResizeByMouseInit();var divMask=document.createElement('div');divMask.className='springConfigMask';divMask.draggable='true';var btnRemove=document.createElement('span');btnRemove.className='glyphicon glyphicon-remove-circle springConfigRemoveBtn grow';btnRemove.title='Remove';btnRemove.onclick=function(e){confirm('Are you sure you want to delete it ?',function(){if(_this.chart)_this.chart.clear();if(_this.entity.modal.option.subChartIds.length>0){var subChartsIdsMix=_this.entity.modal.option.subChartIds;for(var i=0;i<subChartsIdsMix.length;i++){var item=subChartsIdsMix[i];for(var j=0;j<_this.screen.arrEntityOrder.length;j++){if(item.id===_this.screen.arrEntityOrder[j]){_this.screen.removeEntity(_this.screen.arrEntityOrder[j]);}}}
_this.entity.modal.option.subChartIds=[];}
var oldIndex=_this.screen.arrEntityOrder.indexOf(_this.entity.id);_this.screen.removeEntity(_this.entity.id);var entity=new ModalNone(_this.screen,{id:_this.entity.id,spanC:_this.entity.spanC,spanR:_this.entity.spanR,modal:{type:"ModalNone"}},_this.entity.id);_this.screen.arrEntityOrder.splice(oldIndex,0,entity.entity.id);_this.screen.listEntity[entity.entity.id]=entity;entity.render();entity.configure();entity.hasEdit=true;_this=null;});};divMask.appendChild(btnRemove);var btnAdd=document.createElement('span');btnAdd.className='glyphicon glyphicon-plus-sign springConfigAddBtn grow';btnAdd.title='Add';btnAdd.onclick=function(e){var spanC=6,spanR=6;var $chartsCt=_this.container.classList.contains('chartsCt')?$(_this.container):$(_this.container).siblings().find('.chartsCt');if($chartsCt.children().length>0){var lastDiv=$chartsCt.children()[$chartsCt.children().length-1];spanR=Number(lastDiv.querySelector('#heightResize').value);spanC=Number(lastDiv.querySelector('#widthResize').value);}
if(!_this.container.classList.contains('chartsCt')){_this.container=_this.container.parentElement.getElementsByClassName('chartsCt')[0];}
var entity=new ModalNone(_this,{id:(+new Date()).toString(),spanC:spanC,spanR:spanR,modal:{type:"ModalNone"},isNotRender:true});_this.screen.arrEntityOrder.push(entity.entity.id);_this.screen.listEntity[entity.entity.id]=entity;if(!_this.entity.modal.option){_this.entity.modal.option={};_this.entity.modal.option.subChartIds=new Array();}
_this.entity.modal.option.subChartIds.push({id:entity.entity.id});entity.render();entity.configure();};divMask.appendChild(btnAdd);var btnInstall=document.createElement('span');btnInstall.className='glyphicon glyphicon-cog springConfigInstallBtn grow';btnInstall.title='config';btnInstall.onclick=function(e){_this.showConfigModal();};divMask.appendChild(btnInstall);var btnHeightResize=document.createElement('div');if(AppConfig.isMobile||this.screen.isForMobile||this.screen.options&&this.screen.options.isForMobile){this.entity.spanC=this.optionTemplate.maxWidth=this.optionTemplate.minWidth=3;this.optionTemplate.maxHeight=4.5;this.entity.spanR>this.optionTemplate.maxHeight&&(this.entity.spanR=this.optionTemplate.maxHeight);}
var maxHeight=this.optionTemplate.maxHeight;var maxWidth=this.optionTemplate.maxWidth;var minHeight=this.optionTemplate.minHeight;var minWidth=this.optionTemplate.minWidth;btnHeightResize.className='divResize divHeightResize';btnHeightResize.innerHTML='<label for="heightResize" >H: </label>'+'<input type="range" class="inputResize" id="heightResize" name="points" step="0.5" min="'+minHeight+'" max="'+maxHeight+'" value="'+_this.entity.spanR+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanR+' /'+maxHeight+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanR+'"/>';divMask.appendChild(btnHeightResize);var btnWidthResize=document.createElement('div');btnWidthResize.className='divResize divWidthResize';btnWidthResize.innerHTML='<label for="widthResize" >W: </label>'+'<input type="range" class="inputResize" id="widthResize" name="points" step="0.5" min="'+minWidth+'" max="'+maxWidth+'" value="'+_this.entity.spanC+'"/>'+'<h5 class="rangeVal">'+_this.entity.spanC+' /'+maxWidth+'</h5>'+'<input type="text" class="rangeChange" value="'+_this.entity.spanC+'"/>';divMask.appendChild(btnWidthResize);var divTitleAndType=document.createElement('div');divTitleAndType.className='divTitleAndType';divMask.appendChild(divTitleAndType);var $chartCt=$('<div class="divResize chartsCt gray-scrollbar">');divMask.appendChild($chartCt[0]);var $divTitle=$('<div class="divResize chartTitle">');var $labelTitle=$('<label for="title">').text(I18n.resource.dashboard.show.TITLE);var inputChartTitle=document.createElement('input');inputChartTitle.id='title';inputChartTitle.className='form-control';inputChartTitle.value=this.entity.modal.title;inputChartTitle.setAttribute('placeholder',I18n.resource.dashboard.show.TITLE_TIP);if(this.entity.modal.title!=''){inputChartTitle.style.display='none';}
inputChartTitle.setAttribute('type','text');$divTitle.append($labelTitle).append($(inputChartTitle));divTitleAndType.appendChild($divTitle[0]);var $divType=$('<div class="divResize chartType">');var $labelType=$('<label>').text(I18n.resource.dashboard.show.TYPE);var chartType=document.createElement('span');chartType.innerHTML=I18n.findContent(this.optionTemplate.name);$divType.append($labelType).append($(chartType));divTitleAndType.appendChild($divType[0]);var chartTitleShow=document.createElement('p');chartTitleShow.innerHTML=inputChartTitle.value;chartTitleShow.className='chartTitleShow';$divTitle[0].appendChild(chartTitleShow);if(this.entity.modal.title==''||this.entity.modal.title==undefined){chartTitleShow.style.display='none';}
chartTitleShow.onclick=function(){chartTitleShow.style.display='none';inputChartTitle.style.display='inline-block';inputChartTitle.focus();};inputChartTitle.onblur=function(){if(inputChartTitle.value!=''){inputChartTitle.style.display='none';chartTitleShow.style.display='inline';}
chartTitleShow.innerHTML=inputChartTitle.value;_this.entity.modal.title=inputChartTitle.value;};this.container.parentNode.appendChild(divMask);this.divResizeByToolInit();var divContainer=$(this.container).closest('.springContainer')[0];divMask.ondragstart=function(e){e.dataTransfer.setData("id",$(e.target).closest('.springContainer').get(0).id.replace('divContainer_',''));};divMask.ondragover=function(e){e.preventDefault();};divMask.ondragleave=function(e){e.preventDefault();};divContainer.ondrop=function(e){e.stopPropagation();var sourceId=e.dataTransfer.getData("id");var $sourceParent,$targetParent,$chartsCt;if(sourceId){var targetId=$(e.target).closest('.springContainer').get(0).id.replace('divContainer_','');$sourceParent=$('#divContainer_'+sourceId).parent();$targetParent=$('#divContainer_'+targetId).parent();$chartsCt=e.target.classList.contains('chartsCt')?$(e.target):$(e.target).closest('.chartsCt');if(!$sourceParent[0].classList.contains('chartsCt')&&($targetParent[0].classList.contains('chartsCt')||$chartsCt.length==1)){if($targetParent[0].classList.contains('chartsCt')){_this.insertChartIntoMix(sourceId,$targetParent[0]);}else if($chartsCt.length==1){_this.insertChartIntoMix(sourceId,$chartsCt[0]);}}else{if(_this.screen.screen){_this.screen.screen.replaceEntity(sourceId,targetId,_this.screen.entity.id);}else{_this.screen.replaceEntity(sourceId,targetId);}}}};this.executeConfigMode();},ModalMix.prototype.insertChartIntoMix=function(sourceId,container){if(sourceId){if(this.screen.listEntity[sourceId].entity.modal.type=='ModalMix'){alert(I18n.resource.toolBox.modal.MSG_MIX_NOT_ALLOW_TO_MIX);return false;}
var modelClass,item,entity=this.screen.listEntity[sourceId].entity;$('#divContainer_'+sourceId).remove();entity.isNotRender=true;if(!this.entity.modal.option){this.entity.modal.option={};}
if(!this.entity.modal.option.subChartIds){this.entity.modal.option.subChartIds=[];}
modelClass=this.screen.factoryIoC.getModel(entity.modal.type);this.screen.container=container;if(container.children.length>0){var lastDiv=container.children[container.children.length-1];entity.spanC=Math.round(parseInt(lastDiv.style.width.split('%')[0])/10)*12/10;entity.spanR=Math.round(parseInt(lastDiv.style.height.split('%')[0])/10)*6/10;}else{entity.spanC=6;entity.spanR=6;}
item=new modelClass(this.screen,entity);item.configure();this.entity.modal.option.subChartIds.push({id:entity.id});}};ModalMix.prototype.showConfigModal=function(){var _this=this;var $mixChartShow=$('#mixChartShow');if($mixChartShow.length===0){$mixChartShow=$('\
                            <style>.mixChartShow .row{margin-top: 15px;margin-bottom: 15px;}</style>\
                            <div id="mixChartShow" class="mixChartShow"><div class="modal fade"  style="position:absolute;"><div class="modal-dialog"><div class="modal-content">\
                            <div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\
                            <h4 class="modal-title"></h4></div>\
                            <div class="modal-body">\
                            <div class="row">\
                            <div class="col-xs-3"></div>\
                            <div class="col-xs-6"><input type="number" id="iptInterval" placeholder="" style="width:100px"/>s(0)</div>\
                            </div>\
                            <div class="row">\
                            <div class="col-xs-3"></div>\
                            <div class="col-xs-2">\
                            <select id="selBgColor">\
                            <option value="transparent"></option>\
                            <option value="#ffffff"></option>\
                            <option value="#000000"></option>\
                            <option value="#337ab7"></option>\
                            <option value="#5cb85c"></option>\
                            <option value="custom"></option>\
                            </select>\
                            </div>\
                            <div class="col-xs-2"><input type="input" id="iptBgColor" placeholder="#ffffff" style="width:60px"/></div>\
                            <div class="col-xs-2"><input type="color" class="" id="bgColorView"/></div>\
                            </div>\
                            <div class="modal-footer"><button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSaveConfig"></button></div>\
                            </div></div></div></div>');}
var $paneContent=$('#paneContent');var $konvajsContent=$('.konvajs-content');if($paneContent.length===1){$paneContent.append($mixChartShow);}else if($konvajsContent.length===1){$konvajsContent.append($mixChartShow);}
var $iptBgColor=$('#iptBgColor',$mixChartShow);var $bgColorView=$('#bgColorView',$mixChartShow);var $selBgColor=$('#selBgColor',$mixChartShow);var $iptInterval=$('#iptInterval',$mixChartShow);$iptInterval.val(_this.entity.modal.option.displayInterval?_this.entity.modal.option.displayInterval:20);setShow(_this.entity.modal.option.bgColor?_this.entity.modal.option.bgColor:'transparent');$selBgColor.off('change').on('change',function(e){setShow(this.value,e);});$iptBgColor.off('input').on('input',function(){$bgColorView.val(this.value);});$bgColorView.off('change').on('change',function(e){$iptBgColor.val(this.value);});$('#btnSaveConfig',$mixChartShow).off('click').click(function(){_this.entity.modal.option.displayInterval=$iptInterval.val();_this.entity.modal.option.bgColor=$iptBgColor.val();});$mixChartShow.children('.modal').modal();function setShow(selected,event){if(selected==='transparent'){$bgColorView.hide();}else{$bgColorView.val(selected);$bgColorView.show();}
if(selected==='custom'){$iptBgColor.show();$iptBgColor.val('').focus();}else{$iptBgColor.hide();$iptBgColor.val(selected);}
if(!event){$selBgColor.val(selected);if(!$selBgColor.val()){$selBgColor.val('custom');$iptBgColor.val(selected).show().focus();}}}};ModalMix.prototype.attachEventSlider=function(){var startPos,isScrolling,endPos,_this=this;this.container.addEventListener('touchstart',function(e){e.preventDefault();var touch=event.targetTouches[0];startPos={x:touch.pageX,y:touch.pageY,time:+new Date()};isScrolling=0;_this.container.addEventListener('touchmove',move,false);_this.container.addEventListener('touchend',end,false);},false);function move(){if(event.targetTouches.length>1||event.scale&&event.scale!==1)return;var touch=event.targetTouches[0];endPos={x:touch.pageX-startPos.x,y:touch.pageY-startPos.y};isScrolling=Math.abs(endPos.x)<Math.abs(endPos.y)?1:0;if(isScrolling===1){event.preventDefault();}}
function end(){var duration=+new Date()-startPos.time;var i=0;if(Number(duration)>10){if(isScrolling===1){if(endPos.y<-10){i=1;}else if(endPos.y>10){i=3;}}else if(isScrolling===0){if(endPos.x>10){i=2;}else if(endPos.x<-10){i=4;}}
callback(i);startPos=endPos=null;return false;}
_this.container.removeEventListener('touchmove',this,false);_this.container.removeEventListener('touchend',this,false);}
function callback(direction){switch(direction){case 1:break;case 2:$('.left.carousel-control',_this.container).click();break;case 3:break;case 4:$('.right.carousel-control',_this.container).click();break;default:break;};}};return ModalMix;}();(function(){var tags={};var TOOLBOX=['DataSource','LinkTo'];var PATTERN_STR='<('+TOOLBOX.join('|')+').*?(/|'+TOOLBOX.join('|')+')>';window.__spring_html_modal={};function runScript(content){var done=false;var script=document.createElement("script");var head=document.getElementsByTagName("head")[0];script.type="text\/javascript";script.text=content;head.appendChild(script);head.removeChild(script);}
tags.Base=function(){function Base(modal){this.$textarea=modal.$textarea;this.$modalCt=modal.$modalCt;this.$toolBtn=null;this.init();}
Base.prototype.init=function(){throw new Error('init ');};Base.prototype.render=function($container){throw new Error('render ');};return Base;}();tags.DataSource=function(){var _this;function DataSource(modal){_this=this;tags.Base.call(this,modal);}
DataSource.prototype=Object.create(tags.Base.prototype);DataSource.prototype.constructor=DataSource;DataSource.prototype.insertTpl='<DataSource data-id="{id}"{linkTo}/>';DataSource.prototype.init=function(){var arrHtml=[];this.$toolBtn=$('<button type="button" class="btn btn-default" data-toggle="collapse" data-target="#panelDataSourceConfig" aria-expanded="false">\
                DataSource\
                </button>');this.$toolConfig=$('#panelDataSourceConfig',this.$modalCt);};DataSource.prototype.render=function($btnCtn){$btnCtn.append(this.$toolBtn);this.attachEvents();};DataSource.prototype.attachEvents=function(){};DataSource.save=function(dataset,modal){var id;if(!dataset)return;id=dataset.id;if(id&&modal.points.indexOf(id)===-1)modal.points.push(id);};DataSource.getStaticRender=function(dom){var dataset=dom.dataset;var menuId=dataset.linkTo;var $ele;if(menuId){$ele=$('<a href="javascript:;" data-is="DataSource" data-id="'+dataset.id+'">Loading</a>');$ele.click(function(e){var $ev=$('#ulPages [pageid="'+menuId+'"]');if($ev[0].className!=='nav-btn-a'){$ev=$ev.children('a');$ev.closest('.dropdown').children('a').trigger('click');}
$ev.trigger('click');});return $ele;}else return $('<span data-is="DataSource" data-id="'+dataset.id+'">Loading</span>');};DataSource.getRealTimeRender=function($ele,map){var dataset=$ele[0].dataset;if(isNaN(map[dataset.id])){$ele.html(map[dataset.id]);}else{$ele.html(parseFloat(map[dataset.id]));}};return DataSource;}();tags.LinkTo=function(){var _this;function LinkTo(modal){_this=this;tags.Base.call(this,modal);}
LinkTo.prototype=Object.create(tags.Base.prototype);LinkTo.prototype.constructor=LinkTo;LinkTo.prototype.insertTpl='<LinkTo data-id="{id}" ></LinkTo>';LinkTo.prototype.init=function(){var arrHtml=[];this.$toolBtn=$('<button type="button" class="btn btn-default" data-parent="#collapseList" data-toggle="collapse" data-target="#panelLinkToConfig" aria-expanded="false">LinkTo</button>');this.$toolConfig=$('#panelLinkToConfig',this.$modalCt);};LinkTo.prototype.render=function($btnCtn){$btnCtn.append(this.$toolBtn);this.attachEvents();};LinkTo.prototype.attachEvents=function(){};LinkTo.save=function(dataset,modal){};LinkTo.getStaticRender=function(dom,doc){var dataset=dom.dataset;var menuId=dataset.id;doc=doc||window.document;$ele=$('<a href="javascript:;">'+(dom.innerHTML||'Link To')+'</a>',doc);$ele.click(function(){var $ev=$('#ulPages [pageid="'+menuId+'"]');if($ev.length>0){if($ev[0].className!=='nav-btn-a'){$ev=$ev.children('a');$ev.closest('.dropdown').children('a').trigger('click');}
$ev.trigger('click');}});return $ele;};return LinkTo;}();var ModalHtmlConfig=function(){var _this;var gMenusHtml;function ModalHtmlConfig(options){_this=this;ModalConfig.call(this,options);this.toolbox=[];}
ModalHtmlConfig.prototype=Object.create(ModalConfig.prototype);ModalHtmlConfig.prototype.constructor=ModalHtmlConfig;ModalHtmlConfig.prototype.DEFAULTS={htmlUrl:'/static/views/observer/widgets/modalHtmlConfig.html'};ModalHtmlConfig.prototype.init=function(){this.$modal=$('.modal',this.$wrap);this.$modalCt=$('.modal-content',this.$wrap);this.$formWrap=$('.form-wrap',this.$wrap);this.$dsGroupList=$('.form-horizontal','#panelDataSourceConfig');this.$linkGroupList=$('.form-horizontal','#panelLinkToConfig');this.$textarea=$('.form-textarea',this.$formWrap);this.$btnSubmit=$('.btn-submit',this.$wrap);this.$toolboxCtn=$('.toolbox-ctn',this.$formWrap);this.$btnResizeFull=$('.btn-resize-full',this.$wrap);this.$btnResizeSmall=$('.btn-resize-small',this.$wrap);this.attachEvents();this.initToolbox();};ModalHtmlConfig.prototype.initToolbox=function(){var $toolboxGroup=$('<div class="btn-group" role="group">').appendTo(this.$toolboxCtn);TOOLBOX.forEach(function(row){var labelClass=tags[row];var labelIns;if(typeof labelClass!=='function'){console.warn(I18n.resource.dashboard.modalJumpPages.NO_LABLE+row);return;}
labelIns=new labelClass(_this);labelIns.render($toolboxGroup);});var $tools=$('.btn',$toolboxGroup);$toolboxGroup.on('click','.btn',function(){$(this).toggleClass('btn-primary');});};ModalHtmlConfig.prototype.recoverForm=function(form){var _this=this;var options;if(!form||!form.option){this.addDsFormGroup();return;}
options=form.option;var arrId=[];form.points.forEach(function(row){arrId.push(row);});var arrItem=AppConfig.datasource.getDSItemById(arrId);form.points.forEach(function(row){for(var m=0;m<arrItem.length;m++){if(row==arrItem[m].id){var $ele=_this.addDsFormGroup({id:row,cls:' dropped',value:row,name:arrItem[m].alias||'',display:'inline'});break;}}});this.addDsFormGroup();this._setField('textarea',this.$textarea,options.html);};ModalHtmlConfig.prototype.reset=function(){this.$dsGroupList.empty();this._setField('textarea',this.$textarea);};ModalHtmlConfig.prototype.addDsFormGroup=function(data){if(data===undefined){data={id:I18n.resource.dashboard.modalJumpPages.PARAM_INTRO,cls:'',value:'',name:'<span class="glyphicon glyphicon-plus"></span>'};}
return $('<div class="form-group{cls}">\
                <label class="col-md-2 control-label" for="">Point</label>\
                <div class="col-md-4">\
                    <div class="label-area div-ds-id">{id}</div>\
                </div>\
                <div class="col-md-4">\
                    <div class="drop-area div-ds-point" data-value="{value}">\
                        {name}\
                    </div>\
                </div>\
                <div class="col-md-2">\
                    <div class="opt-icon-area">\
                        <span class="glyphicon glyphicon-remove"></span>\
                    </div>\
                </div>\
            </div>'.formatEL(data)).appendTo(_this.$dsGroupList);};ModalHtmlConfig.prototype.initLinkFormGroup=function(){var arrHtml=[];for(var i in AppConfig.menu){if(!AppConfig.menu.hasOwnProperty(i))continue;arrHtml.push('<div class="form-group">\
                    <label class="col-md-2 control-label" for="">Link</label>\
                    <div class="col-md-4">\
                        <div class="label-area">{id}</div>\
                    </div>\
                    <div class="col-md-4"><div class="label-area">{name}</div></div>\
                </div>'.formatEL({id:i,name:AppConfig.menu[i]}));}
return this.$linkGroupList.html(arrHtml.join(''));};ModalHtmlConfig.prototype.onDropActionPerformed=function(e){$(e.target).removeClass('on');var itemId=EventAdapter.getData().dsItemId;var isNotShowMsg=true;if(Object.prototype.toString.call(itemId)==='[object Array]'){var len=itemId.length;for(var i=0;i<len;i++){addPointDrag(itemId[i]);}}else{addPointDrag(itemId);}
if(isNotShowMsg){alert(I18n.resource.dashboard.modalJumpPages.DATA_EXIST);return false;}
function addPointDrag(itemId){var $target=$('.drop-area[data-value=""]');_this._setField('droparea',$target,itemId);var dsId=$target[0].dataset.value;var $formGroup=$target.closest('.form-group');if(_this.$dsGroupList.find('[data-value="'+dsId+'"]').length>1){_this._setField('droparea',$formGroup.find('.drop-area'));}else{$formGroup.addClass('dropped');$formGroup.find('.label-area').text(dsId);isNotShowMsg=false;_this.addDsFormGroup();}}
e.stopPropagation();};ModalHtmlConfig.prototype.attachEvents=function(){var _this=this;this.$modal.on('show.bs.modal',function(){_this.initLinkFormGroup();});this.$wrap.on('click','.opt-icon-area',function(e){$(this).closest('.form-group').remove();});this.$btnResizeFull.off().click(function(){var height=_this.$modal.height();_this.$modal.addClass('maxium-screen');_this.$textarea.height(height-208);});this.$btnResizeSmall.off().click(function(){_this.$modal.removeClass('maxium-screen');_this.$textarea.height('auto');});this.$btnSubmit.off().click(function(e){var modalIns=_this.options.modalIns;var modal=modalIns.entity.modal;var form={};var html;var toolboxStr,pattern,match;html=form.html=_this.$textarea.val();modal.points=[];_this.$dsGroupList.find('.dropped .drop-area').each(function(){modal.points.push($(this)[0].dataset.value);});toolboxStr=TOOLBOX.join('|');pattern=new RegExp(PATTERN_STR,'ig');while((match=pattern.exec(html))!==null){try{var dom=$(match[0])[0];}catch(e){continue;}
tags[match[1]].save(dom.dataset,modal);}
pattern=new RegExp('<%([^,<>%]+).*?%>','mg');while((match=pattern.exec(html))!==null){if(modal.points.indexOf(match[1])===-1){modal.points.push(match[1]);}}
modal.option=form;modal.dsChartCog=[{accuracy:2}];modal.interval=60000;_this.$modal.modal('hide');modalIns.preview();e.preventDefault();});this.$textarea[0].addEventListener("dragover",function(event){event.preventDefault();});this.$textarea[0].addEventListener("drop",function(event){event.preventDefault();var itemId=EventAdapter.getData().dsItemId;if(Object.prototype.toString.call(itemId)==='[object Array]'){var len=itemId.length;for(var i=0;i<len;i++){dotIsExist(itemId[i]);}}else{dotIsExist(itemId);}
function dotIsExist(itemId){var dropAreaList=$('.drop-area',_this.$wrap);var lens=dropAreaList.length;var isExist=false;for(var j=0;j<lens;j++){if(dropAreaList.eq(j).attr('data-value')===itemId){isExist=true;}}
if(!isExist){var text='<%'+itemId+'%>';insertText(event.target,text);}else{return false;}}
_this.$wrap.find('.drop-area[data-value=""]').trigger('drop',true);});function insertText(obj,str){if(typeof obj.selectionStart==='number'&&typeof obj.selectionEnd==='number'){var startPos=obj.selectionStart,endPos=obj.selectionEnd,cursorPos=startPos,tmpStr=obj.value;obj.value=tmpStr.substring(0,startPos)+str+tmpStr.substring(endPos,tmpStr.length);cursorPos+=str.length;obj.selectionStart=obj.selectionEnd=cursorPos;}else{obj.value+=str;}}};return ModalHtmlConfig;}();this.ModalHtml=function(ToolTipMixin){function ModalHtml(screen,entityParams){ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);this.promise=$.Deferred();this.firstUpdateData=null;this.lastUpdateTimeTick=null;this.customTags={};this.initCustomVaribles();}
ModalHtml.prototype=Object.create(ModalBase.prototype);ModalHtml.prototype.constructor=ModalHtml;ModalHtml.prototype=Mixin(ModalHtml.prototype,ToolTipMixin);ModalHtml.prototype.optionTemplate={name:'toolBox.modal.MODAL_HTML',parent:0,mode:'custom',maxNum:10,title:'',minHeight:1,minWidth:2,maxHeight:6,maxWidth:12,defaultHeight:4.5,defaultWidth:3,type:'ModalHtml',tooltip:{'imgPC':false,'imgMobile':false,'isSpecData':false,'desc':''}};ModalHtml.prototype.initCustomVaribles=function(){var container=this.container;var screen;window.__spring_html_modal[this.entity.id]=this.customVaribles={};this.customVaribles.widgetModal=this.entity.modal;this.customVaribles._wrapContainer=document.querySelector('#divContainer_'+this.entity.id);this.customVaribles.dataMap={};var arrParams=window.location.hash.split('&');if(arrParams&&arrParams.length>0){for(var i=0;i<arrParams.length;i++){if(arrParams[i].indexOf('response=')>-1){this.customVaribles.dataParams=arrParams[i];}}}
this.customVaribles.linkTo=function(menuId,ctnSelector,linkType,linkName,linkParams){var $ev,ctn;if(!ctnSelector&&!linkType){$ev=$('#ulPages [pageid="'+menuId+'"]');if($ev.length>0){if($ev[0].className!=='nav-btn-a'){$ev=$ev.children('a');$ev.closest('.dropdown').children('a').trigger('click');}
if(linkParams){$ev.trigger('click',[{response:linkParams}]);}else{$ev.trigger('click');}
return;}}
if(ctnSelector){ctn=document.querySelector(ctnSelector);if(!ctn)return;ctn.innerHTML='';if(screen){screen.close();screen=null;}}
linkType=linkType||'EnergyScreen';switch(linkType){case'EnergyScreen_M':case'EnergyScreen':if(!ctn){if(!AppConfig.isMobile){ScreenManager.show(EnergyScreen,menuId);}else{var isIndex=linkType=='EnergyScreen_M';router.to({typeClass:ProjectDashboard,data:{menuId:menuId,isIndex:isIndex,name:linkName}});}}else{screen=new EnergyScreen();screen.id=menuId;screen.container=ctn;screen.isForBencMark=true;screen.init();}
break;case'ObserverScreen':if(!ctn){ScreenManager.goTo({page:linkType,id:menuId});}else{screen=new ObserverScreen(menuId);ctn.innerHTML='<div class="divMain" style="width: 100%; height: 100%;">\
                                    <div class="div-canvas-ctn" style="padding: 0; margin: 0 auto; height: 100%; width: 100%;">\
                                        <canvas class="canvas-ctn" style="width: 100%; height: 100%;"></canvas>\
                                    </div>\
                                    <div id="divObserverTools" style="height: 0"></div>\
                                </div>';screen.isInDashBoard=true;screen.show(ctn);}
break;case'FacReportScreen':if(!ctn){ScreenManager.goTo({page:'observer.screens.FacReportScreen',options:{id:menuId},container:'indexMain'});}
break;case'FacReportWrapScreen':if(!ctn){if(AppConfig.isMobile){router.to({typeClass:MessageFactoryReport,data:{}});}else{ScreenManager.goTo({page:'observer.screens.FacReportWrapScreen',options:{id:menuId},container:'indexMain',response:linkParams});}}
break;case'DiagnosisScreen':if(!ctn){ScreenManager.goTo({page:linkType,options:{defaultMenuId:menuId}});}
break;default:return;}};};ModalHtml.prototype.initCustomTags=function(doc){var _this=this;doc=doc||document;TOOLBOX.forEach(function(row,i){var $tagEle=$(row,doc);var thisTags=[];var staticHtmlRender;if(!$tagEle.length)return;if(typeof(staticHtmlRender=tags[row].getStaticRender)!=='function')return;[].forEach.call($tagEle,function(rowt,t){var $rs=staticHtmlRender(rowt);if(!$rs)return;thisTags.push($rs);$(rowt).replaceWith($rs);});if(thisTags.length)_this.customTags[row]=thisTags;});};ModalHtml.prototype.initCustomAttrs=function(){var _this=this;var $container=$(this.container);$container.on('click','[data-link-to]',function(e){var linkType=this.dataset['linkType'];var ctnSelector=this.dataset['linkTarget'];var menuId=this.dataset['linkTo'];var linkName=this.dataset['linkName'];var linkParams=this.dataset['linkParams'];try{linkParams=JSON.parse(linkParams);}catch(e){}
_this.customVaribles.linkTo(menuId,ctnSelector,linkType,linkName,linkParams);e.preventDefault();});};ModalHtml.prototype._parseOptionStr=function(optionStr){var arr=optionStr.split(',');var opt={};arr.forEach(function(kv){var kvArr=kv.split('=');if(kvArr.length===1){opt[kv]='true';}else{opt[kvArr[0]]=kvArr[1];}});return opt;};ModalHtml.prototype._formatNumber=function(num,options){var rs='';var toString=Object.prototype.toString;var decimalPortion;var numstr,isNegative;if(isNaN(num))return num;num=parseFloat(num);isNegative=num<0;num=Math.abs(num);if(!isNaN(options.p)){options.p=parseInt(options.p);num=num.toFixed(options.p);}
decimalPortion=(num+'').split('.')[1]||'';num=parseInt(num);if(options.ts==='true'){numstr=num+'';while(numstr.length>3){rs=','+numstr.substr(-3,3)+rs;numstr=numstr.substr(0,numstr.length-3);}
rs=numstr+rs;}else{rs=num+'';}
rs=decimalPortion===''?rs:rs+'.'+decimalPortion;if(parseFloat(rs)===0){return rs;}
return(isNegative?'-':'')+rs;};ModalHtml.prototype._formatNode=function(node,options,params){var domWrap;if(options.draggable&&!node.parentNode.dataset.h5DraggableNode){domWrap=document.createElement('span');domWrap.draggable='true';domWrap.dataset.h5DraggableNode='true';domWrap.dataset.dsId=params.dsId||'';node.parentNode.insertBefore(domWrap,node);domWrap.appendChild(node);}};ModalHtml.prototype.setToolTip=function(node,params){var domWrap;if(node.parentNode.dataset.h5DraggableNode==='true'){domWrap=node.parentNode;}else{domWrap=document.createElement('span');domWrap.dataset.dsId=params.dsId||'';domWrap.dataset.h5DraggableNode='true';node.parentNode.insertBefore(domWrap,node);domWrap.appendChild(node);}
this.initTooltip({shape:domWrap,ds:params.dsId,container:this.screen.container,clickable:AppConfig.isFactory===0});};ModalHtml.prototype.buildDsBinding=function(){var _this=this;var dataMap=this.customVaribles.dataMap={};var $container=$(this.container);var ds=dataMap;var textNodeMap={},attrNodeMap={};var dsNameList=this.entity.modal.points;var $textNodes=$container.find('.text-node-placeholder');var $attrNodes=$container.find('[data-inner-ds-info]');dsNameList.forEach(function(name){var $nodes;if(($nodes=$textNodes.filter('[data-name^="'+name+'"]')).length){$nodes.each(function(){var nodeDataName=$(this).attr('data-name');if(nodeDataName.split(',')[0]!==name)return;var text=document.createTextNode('');if(!textNodeMap[name]){textNodeMap[name]=[{name:this.getAttribute('data-name'),node:text}];}else{textNodeMap[name].push({name:this.getAttribute('data-name'),node:text});}
this.parentNode.replaceChild(text,this);});}else{textNodeMap[name]=[];}
if(($nodes=$attrNodes.filter('[data-inner-ds-info*="'+name+'"]')).length){$nodes.each(function(){var $this=$(this);var attr=$this.data('ds.attr');var info=$this.data('ds.info');if(attr===undefined){$this.data('ds.attr',attr=this.getAttribute('data-inner-ds-attr'));}
if(info===undefined){info=window.decodeURIComponent(this.getAttribute('data-inner-ds-info'));$this.data('ds.info',info=JSON.parse(info));}
if(!attrNodeMap[name]){attrNodeMap[name]=[{node:this.getAttributeNode(attr),info:info}];}else{attrNodeMap[name].push({node:this.getAttributeNode(attr),info:info});}});}else{attrNodeMap[name]=[];}
if(!ds.__observerProps)ds.__observerProps={};if(!ds.__observerProps.hasOwnProperty(name)){ds.__observerProps[name]=null;Object.defineProperty(ds,name,{get:function get(){return this.__observerProps[name];},set:function set(value){if(value===this.__observerProps[name])return;this.__observerProps[name]=value;textNodeMap[name].forEach(function(row){var content=row.name;var node=row.node;var idx=content.indexOf(',');var options;if(idx>-1){options=_this._parseOptionStr(content.substr(idx+1));node.data=_this._formatNumber(value,options);_this._formatNode(node,options,{dsId:content.substr(0,idx)});}else{node.data=isNaN(value)?_this._decodeHtml(value):parseFloat(value).toString();}
if(!isNaN(value)&&!AppConfig.isMobile){_this.setToolTip(node,{dsId:idx>-1?content.substr(0,idx):content});}});attrNodeMap[name].forEach(function(row){var info=row.info;var str='';info.forEach(function(row){var idx;if(row.type===TextTemplateParser.types.text){str+=row.value;}else if(row.type===TextTemplateParser.types.binding){if(row.value.indexOf(name)>-1){idx=row.value.indexOf(',');if(idx>-1){row.content=_this._formatNumber(value,_this._parseOptionStr(row.value.substr(idx+1)));}else{row.content=isNaN(value)?value:parseFloat(value).toString();}}
str+=row.content;}});row.node.value=str;});}});}});$attrNodes.each(function(){this.removeAttribute('data-inner-ds-info');this.removeAttribute('data-inner-ds-attr');});};ModalHtml.prototype._decodeHtml=function(html){var txt=document.createElement("textarea");txt.innerHTML=html;return txt.value;};ModalHtml.prototype.renderModal=function(){var _this=this;var options=this.entity.modal.option;var info;var parser=TextTemplateParser;if(!options){$(this.container).html('');this.spinner.stop();return;}
info=this.getFormatHtml(options.html);info.html=info.html.replace(/([\w-]+?)="([^"]*<%[^<>]+?%>[^"]*)"/mg,function($0,$1,$2){var tokens=parser.parse($2,['<%','%>']);var infoStr;tokens.forEach(function(row){if(row.type===parser.types.binding){row.content='';}});infoStr=window.encodeURIComponent(JSON.stringify(tokens));return $1+'="" data-inner-ds-info="'+infoStr+'" data-inner-ds-attr="'+$1+'"';});info.html=info.html.replace(/<%(.+?)%>/mg,function($0,$1){return'<span class="text-node-placeholder" data-name="'+$1+'">'+$1+'</span>';});$(this.container).html(info.html);runScript(info.scriptContent);_this.initCustomTags();_this.initCustomAttrs();_this.buildDsBinding();if(typeof _this.customVaribles.onRenderComplete==='function'){_this.customVaribles.onRenderComplete.call(null);}
_this.promise.done(function(data){if(!data)return;_this.updateModal(data);});_this.promise.resolve(_this.firstUpdateData);_this.spinner.stop();};ModalHtml.prototype.updateModal=function(data){var _this=this;var modal,updateInterval,options,now;var thisTags;var dataMap=this.customVaribles.dataMap;var customEventHandlers;if(this.promise.state()==='pending'){this.firstUpdateData=data;return;}
modal=this.entity.modal;updateInterval=modal.interval;options=this.entity.options;nowTick=new Date().valueOf();data.forEach(function(row){dataMap[row.dsItemId]=row.data;});for(var tagName in this.customTags){if(!this.customTags.hasOwnProperty(tagName))continue;thisTags=this.customTags[tagName];thisTags.forEach(function($row,i){var handler=tags[tagName].getRealTimeRender;if(typeof handler!=='function')return;handler($row,dataMap);});}
if(typeof this.customVaribles.onUpdateComplete==='function'){this.customVaribles.onUpdateComplete.call(null,dataMap);}};ModalHtml.prototype.showConfigMode=function(){};ModalHtml.prototype.showConfigModal=function(container,options){this.configModal.setOptions({modalIns:this});this.configModal.show();};ModalHtml.prototype.configModal=new ModalHtmlConfig();ModalHtml.prototype.getFormatHtml=function(html){var _this=this;var patternScript=/(<script\b[^>]*>)([\s\S]*?)(<\/script>)/img;var scriptContent=[];var wrapTpl='(function() { |code| }).call(window.__spring_html_modal[\''+_this.entity.id+'\'])';var formatHtml=html.replace(patternScript,function($0,$1,$2,$3){if($2.trim()!=='')scriptContent.push($2);return'';});return{scriptContent:wrapTpl.replace('|code|',scriptContent.join(';\n')),html:formatHtml};};ModalHtml.prototype.preview=function(){};ModalHtml.prototype.close=function(){this.container.innerHTML='';};return ModalHtml;}(namespace('mixins.TooltipMixin'));var TextTemplateParser=function(){function TextTemplateParser(){}
TextTemplateParser.types={text:0,binding:1};TextTemplateParser.parse=function(template,delimiters){var index,lastIndex,lastToken,length,substring,tokens,value;tokens=[];length=template.length;index=lastIndex=0;while(lastIndex<length){index=template.indexOf(delimiters[0],lastIndex);if(index<0){tokens.push({type:this.types.text,value:template.slice(lastIndex)});break;}else{if(index>0&&lastIndex<index){tokens.push({type:this.types.text,value:template.slice(lastIndex,index)});}
lastIndex=index+delimiters[0].length;index=template.indexOf(delimiters[1],lastIndex);if(index<0){substring=template.slice(lastIndex-delimiters[0].length);lastToken=tokens[tokens.length-1];if((lastToken!==undefined?lastToken.type:void 0)===this.types.text){lastToken.value+=substring;}else{tokens.push({type:this.types.text,value:substring});}
break;}
value=template.slice(lastIndex,index).trim();tokens.push({type:this.types.binding,value:value});lastIndex=index+delimiters[1].length;}}
return tokens;};return TextTemplateParser;}();}).call(this);var ModalInteractConfig=function($,window,undefined){var _this;function ModalInteractConfig(options){_this=this;ModalConfig.call(_this,options);}
ModalInteractConfig.prototype=Object.create(ModalConfig.prototype);ModalInteractConfig.prototype.constructor=ModalInteractConfig;ModalInteractConfig.prototype.DEFAULTS={htmlUrl:'/static/views/observer/widgets/modalInteract.html'};ModalInteractConfig.prototype.init=function(){this.$contain=$('#modalInteract',this.$wrap);this.$btnSubmit=$('.btn-submit',this.$wrap);this.$divCfgData=$('.divConfigData',this.$wrap);this.$divDataGrid=$('#divDataGrid',this.$wrap);this.$divDataTip=$('.dataDragTip',this.$wrap);I18n.fillArea(this.$contain);this.attachEvents();};ModalInteractConfig.prototype.recoverForm=function(modal){var item=_this.$divDataGrid.children('.item');if(item.length>0){item.remove();}
if(modal.points){var dictPtStat=modal.option.dictPtStatus;if(dictPtStat){var num=1;for(var id in dictPtStat){this.insertItem(id,dictPtStat[id].unit,num,dictPtStat[id].name,dictPtStat[id].projName);num++;}}}};ModalInteractConfig.prototype.reset=function(){};ModalInteractConfig.prototype.attachEvents=function(){this.$divCfgData.on('dragover',function(e){e.preventDefault();$(e.currentTarget).find('.dataDragTip').addClass('addData');});this.$divCfgData.on('dragleave',function(e){e.preventDefault();$(e.currentTarget).find('.dataDragTip').removeClass('addData');});this.$divCfgData.on('drop',function(e,arg){$('.addData').removeClass('addData');var dragItemId=EventAdapter.getData().dsItemId;if(!dragItemId){return;}
var item=_this.$divDataGrid.find('.divDsGridItem');var len=item.length;if(Object.prototype.toString.call(dragItemId)==='[object Array]'){var lens=dragItemId.length;for(var j=0;j<lens;j++){var isExist=false;for(var i=0;i<len;i++){if(dragItemId[j]==item.eq(i).attr('dsid')){dragItemId.splice(j,1);lens=lens-1;j=j-1;isExist=true;continue;}}
if(!isExist){dotAdd(dragItemId[j],'array');}}
if(lens<1){return;}}else{var bFind=false;for(var i=0;i<len;i++){if(dragItemId==item.eq(i).attr('dsid')){bFind=true;break;}}
if(bFind){return;}
dotAdd(dragItemId);}
function dotAdd(dragItemId,isArray){if(len>=20){return;}
if(dragItemId){var item=AppConfig.datasource.getDSItemById(dragItemId);if(item&&item.alias){var parent=_this.options.modalIns;var prjName;if(parent){var temp=parent.getProjectNameFromId(item.projId,parent.m_langFlag);if(0==parent.m_langFlag){prjName=''+temp;}else{prjName='Project Name:'+temp;}}
_this.insertItem(dragItemId,'',len+1,item.alias,prjName);len=_this.$divDataGrid.find('.divDsGridItem').length;}}}});this.$btnSubmit.off().click(function(e){var modalIns=_this.options.modalIns;var modal=modalIns.entity.modal;modal.points=[];if(!modal.option){modal.option={};modal.option.dictPtStatus={};}
if(modal.option){modal.option.dictPtStatus={};}
var arrGrid=_this.$divDataGrid.find('.grow');for(var i=0,len=arrGrid.length;i<len;i++){var item=arrGrid.eq(i);var id=item.attr('dsid');var name=item.find('input').val();var proName=item.find('.contentDS').attr('title');modal.points.push(id);modal.option.dictPtStatus[id]={show:0==i?true:false,count:i,unit:'',name:name,projName:proName};}
if(!modal.option.timeMode){var tmEnd=new Date();tmEnd.setHours(23);tmEnd.setMinutes(59);var tmStart=new Date();tmStart.setTime(tmEnd.getTime()-172800000);tmStart.setHours(0);tmStart.setMinutes(0);modal.option.timeMode='recent';modal.option.interval='h1';modal.option.timeStart=tmStart.format('yyyy-MM-dd HH:mm:00');modal.option.timeEnd=tmEnd.format('yyyy-MM-dd HH:mm:00');modal.option.periodVal=3;modal.option.periodUnit='day';modal.interval=3;}
_this.$modal.modal('hide');e.preventDefault();});};ModalInteractConfig.prototype.insertItem=function(id,unit,num,name,projName){if(name==undefined){name=AppConfig.datasource.getDSItemById(id).alias;}
if(!projName){projName='';}
var $item=$('<div class="col-lg-3 col-xs-4 divDsGrid item">\
            <span class="divDsGridNum">'+num+'</span>\
            <span class="divDsGridItem grow" dsid="'+id+'">\
                <span class="contentDS" title="'+projName+'">'+name+'</span>\
                <input type="text" value="'+name+'" style="display:none">\
                <span class="glyphicon glyphicon-remove btnRemoveDS" aria-hidden="true"></span>\
            </span></div>');$item.click(function(e){var $tar=$(e.currentTarget);var $name=$tar.find('.contentDS');var $input=$tar.find('input');$name.hide();$input.show();$input.focus();$input.select();$input.keyup(function(e){if(13==e.keyCode){var newVal=$input.val();$name.text(newVal);$input.blur();}});$input.blur(function(e){$input.val($name.text());$name.show();$input.hide();});});_this.$divDataTip.before($item);_this.$divDataGrid.find('.btnRemoveDS').last().click(function(e){var $dsGrid=$(e.currentTarget).closest('.divDsGrid');if($dsGrid){$dsGrid.remove();}
var gridNum=_this.$divDataGrid.find('.divDsGridNum');if(gridNum){for(var i=0;i<gridNum.length;i++){gridNum.eq(i).text(i+1);}}});_this.$divDataGrid.find('.contentDS').last().dblclick(function(e){var $spanTar=$(e.currentTarget);var name=$spanTar.text();var $inputName=$spanTar.next('input');$inputName.keydown(function(e){if(13==e.keyCode){var $inputTar=$(e.currentTarget);var newName=$inputTar.val();$inputTar.hide();$spanTar.text(newName);$spanTar.show();}});$inputName.blur(function(e){var $inputTar=$(e.currentTarget);var newName=$inputTar.val();$inputTar.hide();$spanTar.text(newName);$spanTar.show();});$spanTar.hide();$inputName.show();$inputName.focus();$inputName.select();});};ModalInteractConfig.prototype.destroy=function(){this.detachEvents();this.$wrap.remove();};return ModalInteractConfig;}(jQuery,window);var ModalInteract=function(){var _this;var g_dictChart={};function ModalInteract(screen,entityParams){_this=this;if(!entityParams)return;ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this._showConfig);this.modal=entityParams.modal;this.modalId=entityParams.id;this.chart=echarts.init(this.container,AppConfig.chartTheme);this.m_langFlag='zh'==localStorage['language']?0:1;this.m_lang=I18n.resource.dataSource;this.screen=screen;this.init();this.arrColor=echarts.config.color;this.timeFlag=undefined;this.arrModal=screen.store.layout[0];g_dictChart[this.modalId]={chart:this.chart,contain:this.container};this.spinner.spin(this.container);};ModalInteract.prototype=new ModalBase();ModalInteract.prototype.optionTemplate={name:'toolBox.modal.INTERACT_CHART',parent:0,mode:'custom',maxNum:10,title:'',minHeight:3,minWidth:9,maxHeight:12,maxWidth:12,type:'ModalInteract',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};ModalInteract.prototype.defaultOptions={title:{text:''},tooltip:{trigger:'axis'},toolbox:{show:false,feature:{dataView:{show:true,readOnly:false},magicType:{show:true,type:['line','bar']},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true},yAxis:[{type:'value',axisLabel:{textStyle:{color:'#777'}},splitLine:{show:true,lineStyle:{color:'#777',width:1,type:'dashed'}}}],animation:false,grid:[{bottom:70}]};ModalInteract.prototype.init=function(){var containWidth=$(this.container).width();var containHeight=$(this.container).height();var $divLeftPart=$('<div style="display:inline-block;height:100%"></div>');$divLeftPart.css('width',containWidth-220+'px');var $divChartCtrl=$('<div id="chartShow"></div>');$divChartCtrl.css('height',containHeight-10+'px');$divLeftPart.append($divChartCtrl);var $divDataCtrl=$('<div id="dataList" style="display:inline-block;position:absolute;top:10px;right:0;width:220px;height:100%;overflow-y:auto"><div class="form-group"></div></div>');if(this.modal.points&&this.modal.option.dictPtStatus){var arrId=[];for(var id in this.modal.option.dictPtStatus){arrId.push(id);}
var arrItem=AppConfig.datasource.getDSItemById(arrId);for(var id in this.modal.option.dictPtStatus){for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var name=this.modal.option.dictPtStatus[id].name;var unit=this.modal.option.dictPtStatus[id].unit;this.insertInteractData($divDataCtrl,id,name,unit);var target=$divDataCtrl.find('.form-inline').last();if(0==arrItem[m].type){}else if(1==arrItem[m].type){var showFormula=AppConfig.datasource.getShowNameFromFormula(arrItem[m].value);this.setFormulaToolTips(target,name,showFormula,arrItem[m].note);}
break;}}}}
$(this.container).empty();$(this.container).append($divLeftPart);$(this.container).append($divDataCtrl);};ModalInteract.prototype.renderModal=function(e){this.drawCharts();this.spinner.stop();};ModalInteract.prototype.updateModal=function(e){var dsId=e[0].dsItemId;var modeName;for(var i=0;i<_this.arrModal.length;i++){var arrPt=_this.arrModal[i].modal.points;for(var j=0;j<arrPt.length;j++){if(dsId==arrPt[j]){modeName=_this.arrModal[i].modal.option.timeMode;break;}}
if(modeName){break;}}
if('recent'==modeName){var newOption=_this.chart.getOption();var newSeries=newOption.series;var arrId=[];for(var i=0,len=e.length;i<len;i++){arrId.push(e[i].dsItemId);}
var arrItem=AppConfig.datasource.getDSItemById(arrId);for(var i=0,len=e.length;i<len;i++){var id=e[i].dsItemId;for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var name=arrItem[m].alias;var bFind=false;var j=0;for(var len2=newSeries.length;j<len2;j++){if(name==newSeries[j].name){bFind=true;break;}}
if(bFind){var flag=false;for(var k=0;k<newSeries[j].data.length;k++){if(undefined==newSeries[j].data[k]){newSeries[j].data[k]=e[i].data;flag=true;break;}}
if(!flag){newSeries[j].data.push(e[i].data);}}
break;}}}
_this.chart.setOption(newOption);_this.chart.refresh();}
var spanReal=$('#dataList').find('.frontCtrl');if(spanReal){for(var j=0,len2=e.length;j<len2;j++){var id=e[j].dsItemId;for(var k=0,len3=spanReal.length;k<len3;k++){if(id==spanReal.eq(k).attr('pId')){spanReal.eq(k).find('.interactRealVal').text(e[j].data);break;}}}}};ModalInteract.prototype.showConfigModal=function(){this.configModal.setOptions({modalIns:this});this.configModal.show();};ModalInteract.prototype._showConfig=function(){};ModalInteract.prototype.setModalOption=function(option){};ModalInteract.prototype.drawCharts=function(parmOption,parmChart,parmContain){if(!parmOption){parmOption=_this.modal.option;}
if(!parmChart){parmChart=_this.chart;}
if(!parmContain){parmContain=_this.container;}
if(parmOption){var arrPoints=[];for(var itemId in parmOption.dictPtStatus){if(parmOption.dictPtStatus[itemId].show){arrPoints.push(itemId);}}
if(0==arrPoints.length){parmChart.clear();_this.setDataListColor();return;}
if('recent'==parmOption.timeMode){var tmEnd=new Date();tmEnd.setHours(23);tmEnd.setMinutes(59);var tmTemp=tmEnd.getTime()-86400000*(parmOption.periodVal-1);var tmStart=new Date();tmStart.setTime(tmTemp);tmStart.setHours(0);tmStart.setMinutes(0);parmOption.timeStart=tmStart.format('yyyy-MM-dd HH:mm:00');parmOption.timeEnd=tmEnd.format('yyyy-MM-dd HH:mm:00');}
WebAPI.post('/analysis/startWorkspaceDataGenHistogram',{dsItemIds:arrPoints,timeStart:new Date(parmOption.timeStart).format('yyyy-MM-dd HH:mm:00'),timeEnd:new Date(parmOption.timeEnd).format('yyyy-MM-dd HH:mm:00'),timeFormat:parmOption.interval}).done(function(result){if(result.timeShaft.length<=0){parmChart=echarts.init($(parmContain,AppConfig.chartTheme).find('#chartShow')[0]).clear();return;}
var arrName=[];var series=[];var arrId=[];var arrItem=[];for(var i=0,len=result.list.length;i<len;i++){arrId.push(result.list[i].dsItemId);}
arrItem=AppConfig.datasource.getDSItemById(arrId);var cntNow=new Date().getTime();var dictLastData={};for(var i=0,len=result.list.length;i<len;i++){var id=result.list[i].dsItemId;for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var showData=[];var lastData;var flag=false;if('recent'==parmOption.timeMode){var n=0;for(;n<result.timeShaft.length;n++){if(Date.parse(result.timeShaft[n])>cntNow){if(!flag){lastData=result.list[i].data[n];flag=true;}
showData.push(undefined);}else{showData.push(result.list[i].data[n]);}}
dictLastData[id]=lastData;}else{showData=result.list[i].data;}
var name=arrItem[m].alias;arrName.push(name);var count=parmOption.dictPtStatus[id].count;var color=_this.arrColor[count];series.push({name:name,type:'line',data:showData,itemStyle:{normal:{color:color}}});break;}}}
var options={legend:{show:false,data:arrName},xAxis:[{type:'category',boundaryGap:false,data:result.timeShaft,axisLabel:{textStyle:{color:'#777'}},splitLine:{show:true,lineStyle:{color:'#777',width:1,type:'dashed'}}}],series:series};var drawOptions={};jQuery.extend(drawOptions,ModalInteract.prototype.defaultOptions,options);parmChart=echarts.init($(parmContain).find('#chartShow')[0],AppConfig.chartTheme);parmChart.setOption(drawOptions);_this.chart=parmChart;_this.setDataListColor(parmContain);if('recent'==parmOption.timeMode){var spanReal=$(parmContain).find('.frontCtrl');if(spanReal){for(var p=0;p<spanReal.length;p++){var $item=spanReal.eq(p);var id=$item.attr('pid');$item.find('.interactRealVal').text(dictLastData[id]);}}}else{var spanReal=$(parmContain).find('.frontCtrl');if(spanReal){for(var p=0;p<spanReal.length;p++){var $item=spanReal.eq(p);var id=$item.attr('pid');$item.find('.interactRealVal').text('');}}}});}};ModalInteract.prototype.drawChartsEx=function(parmOption,modalId){_this.drawCharts(parmOption,g_dictChart[modalId].chart,g_dictChart[modalId].contain);};ModalInteract.prototype.insertInteractData=function($divDst,ptId,ptName,ptUnit){$divDst.append('\
            <form class="form-inline">\
                <span class="form-control frontCtrl interactDsFrame" pId="'+ptId+'" style="cursor:pointer;width:200px;border-radius: 0em 0em 0em 0em;margin-right: -4px;border-width: 0;color: #ccc;border-bottom:1px solid #465b85;">\
                    <span class="interactSpanDsName" style="display:inline-block;width:100px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;vertical-align: bottom;">'+ptName+'</span>\
                    <span class="interactRealVal" style="display:inline-block;width:70px;overflow: hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:bottom;"></span>\
                </span>\
            </form>\
        ');var $front=$divDst.find('.frontCtrl');$front.off().click(function(e){if(_this.modal.option&&_this.modal.option.dictPtStatus){var $tar=$(e.currentTarget);var id=$tar.attr('pId');var $contain=$tar.closest('.springContainer');var modalId;if($contain){var temp=$contain.attr('id');modalId=temp.split('_')[1];for(var i=0;i<_this.arrModal.length;i++){var item=_this.arrModal[i];if(modalId==item.id){item.modal.option.dictPtStatus[id].show=!item.modal.option.dictPtStatus[id].show;break;}}}
_this.screen.saveLayoutOnly();_this.drawCharts(item.modal.option,g_dictChart[modalId].chart,g_dictChart[modalId].contain);}});};ModalInteract.prototype.initInteractTime=function($divDst){$divDst.append('\
            <form class="form-inline" style="margin-top: 3px;font-family:Microsoft YaHei;font-size:14px">\
                <div class="form-group" style="width:140px">\
                    <label for="selMode" style="display:block;color:#fafcfd">'+I18n.resource.modalConfig.option.LABEL_MODE+'</label>\
                    <select class="form-control" id="selMode" style="background-color:#f4f6f8;border:1px solid #465b85;color:#646464;width:inherit">\
                        <option value="fixed">'+I18n.resource.modalConfig.option.MODE_FIXED+'</option>\
                        <option value="recent">'+I18n.resource.modalConfig.option.MODE_RECENT+'</option>\
                    </select>\
                </div>\
                <div class="form-group" style="width:120px">\
                    <label for="selInterval" style="display:block;color:#fafcfd">'+I18n.resource.modalConfig.option.LABEL_INTERVAL+'</label>\
                    <select class="form-control" id="selInterval" style="background-color:#f4f6f8;border:1px solid #465b85;color:#646464;width:inherit">\
                        <option value="m1">'+I18n.resource.modalConfig.option.INTERVAL_MIN1+'</option>\
                        <option value="m5">'+I18n.resource.modalConfig.option.INTERVAL_MIN5+'</option>\
                        <option value="h1">'+I18n.resource.modalConfig.option.INTERVAL_HOUR1+'</option>\
                        <option value="d1">'+I18n.resource.modalConfig.option.INTERVAL_DAY1+'</option>\
                        <option value="M1">'+I18n.resource.modalConfig.option.INTERVAL_MON1+'</option>\
                    </select>\
                </div>\
                <div class="form-group" id="divTmRange" style="width:380px">\
                    <label for="divRange" style="display:block;color:#fafcfd">'+I18n.resource.modalConfig.option.LABEL_TIME_RANGE+'</label>\
                    <div id="divRange" style="display:inline">\
                        <input class="form-control" type="text" id="tmStart" style="width:165px;cursor:pointer;text-align:center" readonly>\
                        <span class="input-group-addon" style="display: inline;padding-top:6px;padding-bottom:7px;text-align:center;border:1px solid rgb(39, 51, 75);color:#646464;margin-right:-6px;background-color:#f4f6f8;">'+I18n.resource.modalConfig.option.TIP_RANGE_TO+'</span>\
                        <input class="form-control" type="text" id="tmEnd" style="width:165px;cursor:pointer;text-align:center" readonly>\
                    </div>\
                </div>\
                <div class="form-group" id="divTmLast" style="width:340px;display:none">\
                    <label for="divLast" style="display:block;color:#fafcfd">'+I18n.resource.modalConfig.option.LABEL_PERIOD+'</label>\
                    <div id="divLast">\
                        <input class="form-control" type="text" id="inputPeriodValue" style="width:165px;background-color:#f4f6f8;border:1px solid #27334b;border-radius:0.5em 0 0 0.5em;margin-right:-5px;color:#646464">\
                        <select class="form-control" id="selPeriodUnit" style="width:165px;background-color:#f4f6f8;border:1px solid #27334b;border-radius:0 0.5em 0.5em 0;color:#646464">\
                            <option value="hour">'+I18n.resource.modalConfig.option.PERIOD_UNIT_HOUR+'</option>\
                            <option value="day">'+I18n.resource.modalConfig.option.PERIOD_UNIT_DAY+'</option>\
                            <option value="month">'+I18n.resource.modalConfig.option.PERIOD_UNIT_MON+'</option>\
                        </select>\
                    </div>\
                </div>\
                <button class="btn" type="button" id="btnOk" modalId="'+_this.modalId+'" style="width:70px;vertical-align:bottom;color:#f4f6f8;background-color:#288add;">'+I18n.resource.observer.widgets.YES+'</button>\
            </form>\
        ');var $selMode=$divDst.find('#selMode');var $selInter=$divDst.find('#selInterval');var $divTmRange=$divDst.find('#divTmRange');var $divTmLast=$divDst.find('#divTmLast');$selMode.change(function(e){var $opt=$selInter.children('option');var flag=$(e.currentTarget).val();switch(flag){case'fixed':$opt.eq(0).css('display','block');$opt.eq(1).css('display','block');$opt.eq(2).css('display','block');$opt.eq(3).css('display','block');$opt.eq(4).css('display','block');$divTmRange.css('display','inline-block');$divTmLast.css('display','none');break;case'recent':$opt.eq(0).css('display','block');$opt.eq(1).css('display','block');$opt.eq(2).css('display','block');$opt.eq(3).css('display','block');$opt.eq(4).css('display','none');$divTmRange.css('display','none');$divTmLast.css('display','inline-block');break;default:break;}});var tmNow=new Date();var tmStart=new Date();tmStart.setFullYear(tmNow.getFullYear()-10);var $inputStart=$divDst.find('#tmStart');$inputStart.val(tmNow.format('yyyy-MM-dd HH:mm:00'));$inputStart.css('background-color','#f4f6f8');$inputStart.css('border','1px solid #27334b');$inputStart.css('color','#646464');$inputStart.css('border-radius','0.5em 0 0 0.5em');$inputStart.css('margin-right','-5px');$inputStart.datetimepicker({format:'yyyy-mm-dd hh:mm:00',startView:'month',minView:'hour',autoclose:true,todayBtn:false,pickerPosition:'top-right',initialDate:tmNow,startDate:tmStart,endDate:tmNow,keyboardNavigation:false}).off('changeDate').on('changeDate',function(ev){});var $inputEnd=$divDst.find('#tmEnd');$inputEnd.val(tmNow.format('yyyy-MM-dd HH:mm:00'));$inputEnd.css('background-color','#f4f6f8');$inputEnd.css('border','1px solid #27334b');$inputEnd.css('color','#646464');$inputEnd.css('border-radius','0 0.5em 0.5em 0');$inputEnd.datetimepicker({format:'yyyy-mm-dd hh:mm:00',startView:'month',minView:'hour',autoclose:true,todayBtn:false,pickerPosition:'top-right',initialDate:tmNow,startDate:tmStart,endDate:tmNow,keyboardNavigation:false}).off('changeDate').on('changeDate',function(ev){});var $inputPerVal=$divDst.find('#inputPeriodValue');var $selPerUnit=$divDst.find('#selPeriodUnit');var $btnOk=$divDst.find('#btnOk');$btnOk.off().click(function(e){var tmMode=$selMode.val();var strStart,strEnd;if('fixed'==tmMode){strStart=$inputStart.val();strEnd=$inputEnd.val();}else if('recent'==tmMode){var tmStart=new Date();var periodVal=parseInt($inputPerVal.val());if(!periodVal){alert('Please input time !');return;}
var periodUnit=$selPerUnit.val();switch(periodUnit){case'hour':var time=tmNow.getTime()-3600000*periodVal;tmStart.setTime(time);break;case'day':var time=tmNow.getTime()-86400000*periodVal;tmStart.setTime(time);break;case'month':var month=tmNow.getMonth();if(0==month){tmStart.setFullYear(tmNow.getFullYear()-1);tmStart.setMonth(11);}else{tmStart.setMonth(month-1);}
break;default:break;}
strStart=tmStart.format('yyyy-MM-dd HH:mm:00');strEnd=tmNow.format('yyyy-MM-dd HH:mm:00');}else{alert('Please select mode !');return;}
var modalId=$(e.currentTarget).attr('modalId');if(modalId){for(var i=0;i<_this.arrModal.length;i++){var item=_this.arrModal[i];if(item){if(modalId==item.id){if(!item.modal.option){item.modal.option={};item.modal.option.dictPtStatus={};}
item.modal.option.timeMode=tmMode;item.modal.option.interval=$selInter.val();item.modal.option.timeStart=strStart;item.modal.option.timeEnd=strEnd;item.modal.option.periodVal=periodVal;item.modal.option.periodUnit=periodUnit;if('recent'==tmMode){item.interval=1000;}else{item.interval=null;}
break;}}}}
_this.screen.saveLayoutOnly();_this.drawCharts(item.modal.option,g_dictChart[modalId].chart,g_dictChart[modalId].contain);});if(_this.modal.option){$selMode.val(_this.modal.option.timeMode);$selInter.val(_this.modal.option.interval);$inputStart.val(_this.modal.option.timeStart);$inputEnd.val(_this.modal.option.timeEnd);$inputPerVal.val(_this.modal.option.periodVal);$selPerUnit.val(_this.modal.option.periodUnit);if('recent'==_this.modal.option.timeMode){$selMode.change();}}};ModalInteract.prototype.setDataListColor=function(contain){var dataListName;if(!contain){dataListName=$('#dataList').find('.frontCtrl');}else{dataListName=$(contain).find('.frontCtrl');}
if(dataListName){for(var j=0,len=dataListName.length;j<len;j++){var $item=dataListName.eq(j);var id=$item.attr('pId');var $contain=$item.closest('.springContainer');var modalId;if($contain){var temp=$contain.attr('id');modalId=temp.split('_')[1];for(var i=0;i<_this.arrModal.length;i++){var item=_this.arrModal[i];if(modalId==item.id){var count=item.modal.option.dictPtStatus[id].count;var bShow=item.modal.option.dictPtStatus[id].show;var $spanDsName=$item.find('.interactSpanDsName');if($spanDsName){if(bShow){$spanDsName.css('color',_this.arrColor[count]);}else{$spanDsName.css('color','');}}
break;}}}}}};ModalInteract.prototype.setToolTips=function(target,customName,projectName,pointName,pointDesc){var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:300px">');show.append('    <div class="tooltipContent interactTipsBackground">');show.append('        <p class="customName interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="projectName interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.PROJECT_NAME).append('</span>: ').append(projectName).append('</p> ');show.append('        <p class="pointName interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.POINT_NAME).append('</span>: ').append(pointName).append('</p> ');show.append('        <p class="pointDesc interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(pointDesc).append('</p> ');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var options={placement:'left',title:_this.m_lang.PARAM,template:show.toString()};target.tooltip(options);};ModalInteract.prototype.setFormulaToolTips=function(target,customName,formula,desc){var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:400px;">');show.append('    <div class="tooltipContent interactTipsBackground">');show.append('        <p class="customName interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="formula interactTipsStyle" style="word-break:normal;"><span class="interactTipsTitleStyle">').append(_this.m_lang.FORMULA_NAME).append('</span>: ').append('</p>');show.append('        <p class="pointDesc interactTipsStyle"><span class="interactTipsTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(desc).append('</p>');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var showFormula=$('<span>'+formula+'</span>');var showObj=$(show.toString());showFormula.appendTo(showObj.find('.formula')).mathquill();var options={placement:'left',title:_this.m_lang.PARAM,template:showObj};target.tooltip(options);};ModalInteract.prototype.getProjectNameFromId=function(id,langFlag){var name;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(id==item.id){if(0==langFlag){name=item.name_cn;}else{name=item.name_en;}
break;}}
return name;};ModalInteract.prototype.configModal=new ModalInteractConfig();return ModalInteract;}();var ModalDiagnosisPanel=function(){var _this=undefined;function ModalDiagnosisPanel(dom){this.ElScreenContainer=window.ElScreenContainer||$('body')[0];this.parent=dom||this.ElScreenContainer;this.dictZone=undefined;this.dictEquipment=undefined;this.dictObserverText=undefined;this.arrLastNotice=[];this.workerUpdate=undefined;this.tabelModelData=undefined;this.tableModelUpdate=undefined;this.floorCount=0;this.dialog=undefined;this.langCfg=I18n.resource.diagnosis.config;this.noticeId=0;this.faId=0;this.faUserId=0;this.obScreen=undefined;this.$obContainer=undefined;this.urgentCount=0;this.criticalCount=0;this.result=undefined;_this=this;}
ModalDiagnosisPanel.prototype={show:function show(){Spinner.spin(this.ElScreenContainer);WebAPI.get("/static/views/observer/widgets/modalDiagnosisPanel.html").done(function(resultHtml){$(_this.parent).html(resultHtml);I18n.fillArea($(_this.parent));_this.init();}).always(function(){Spinner.stop();});},optionTemplate:{name:'toolBox.modal.DIAGNOSIS_PANEL',parent:0,mode:[''],maxNum:1,title:'',minHeight:2,minWidth:4,maxHeight:6,maxWidth:12,type:'ModalDiagnosisPanel'},initStructData:function initStructData(data){var item,arr;this.dictZone=new Object();this.dictEquipment=new Object();this.buildings=[];arr=data.equipments;for(var i=0,len=arr.length;i<len;i++){item=arr[i];item.faultIds=new Array();this.dictEquipment[item.id]=item;}
arr=data.zones;this.floorCount=arr.length;var index=-1,tempBuildingId=undefined;for(var i=0,len=arr.length;i<len;i++){item=arr[i];var equipments=[];for(var j=0;j<data.equipments.length;j++){if(data.equipments[j].zoneId==item.id){equipments.push({equipmentId:data.equipments[j].id,equipmentName:data.equipments[j].name});}}
this.dictZone[item.id]=item;if(tempBuildingId!=item.buildingId){tempBuildingId=item.buildingId;index++;var building={buildId:item.buildingId,buildName:item.buildingName,subBuilds:[{subBuildId:item.subBuildingId,subBuildName:item.subBuildingName,equipments:equipments}]};this.buildings.push(building);}else{var subBuilding={subBuildId:item.subBuildingId,subBuildName:item.subBuildingName,equipments:equipments};this.buildings[index].subBuilds.push(subBuilding);}}},close:function close(){this.dictZone=null;this.dictEquipment=null;this.dictObserverText=null;this.tabelModelData=null;this.arrLastNotice=null;this.floorCount=null;if(this.workerUpdate)this.workerUpdate.terminate();this.workerUpdate=null;if(this.tableModelUpdate)this.tableModelUpdate.terminate();this.tableModelUpdate=null;if(this.dialog)this.dialog.close();if(this.obScreen)this.obScreen.close();if(ToolCurrent)ToolCurrent.close();},onresize:function onresize(){ScreenCurrent.obScreen.resize();},init:function init(){this.$obContainer=$('#obContainer');this.dictObserverText={};WebAPI.get('/diagnosis/getStruct/'+AppConfig.projectId).done(function(result){_this.initStructData(result);_this.initPaneNav();_this.result=result;$('.subBuildingBtn','#paneIcon').eq(0).trigger('click');$('.div-nav-row','#paneIcon').eq(0).children('span:first').trigger('click');});function tabelModelClose(){$('#panelIconNew').hide();if(_this.tableModelUpdate)_this.tableModelUpdate.terminate();_this.tableModelUpdate=null;}
$("#btnNoticeHistory").off().click(function(e){ScreenModal=new DiagnosisLogHistory(_this);ScreenModal.setIsModal(true);ScreenModal.show();});var $flootCt=$('#floorCt');var $floorPB=$flootCt.find('.showCont');var $floorPH=$flootCt.find('.panel-default');$flootCt.find('.panel-heading').off('click').click(function(){$floorPH.hide();$floorPB.show();});$floorPB.off('click').click(function(){$(this).hide();$floorPH.show();});},initWorkerForUpdating:function initWorkerForUpdating(){if(this.workerUpdate){this.workerUpdate.terminate();}
Spinner.spin(this.parent);this.workerUpdate=new Worker("/static/views/js/worker/workerUpdate.js");this.workerUpdate.self=this;this.workerUpdate.addEventListener("message",this.refreshData,true);this.workerUpdate.addEventListener("error",function(e){console.log(e);},true);this.workerUpdate.postMessage({projectId:AppConfig.projectId,type:"diagnosisScreen",zoneId:AppConfig.zoneId});},initObScreen:function initObScreen(){this.obScreen.isInDiagnosis=true;this.obScreen.diagScreen=this;},resetFloor:function resetFloor(){this.refreshData({data:{notice:this.arrLastNotice}},true);},clearNullArr:function clearNullArr(arr){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==""||typeof arr[i]=="undefined"){arr.splice(i,1);len--;i--;}}
return arr;},gradientColors:function gradientColors(colorArr,$gradientDom,valueCurrent,max,min){var valueMark=(max-min)/(colorArr.length-1);var regexp=/[0-9]{0,3}/g;for(var i=0;i<colorArr.length-1;i++){var colorMaxValue=min+(i+1)*valueMark;if(valueCurrent>colorMaxValue)continue;var colorSelPre=colorArr[i];var colorSelTo=colorArr[i+1];var colorValPreArr=[];colorValPreArr=colorSelPre.match(regexp);_this.clearNullArr(colorValPreArr);var colorValToArr=[];colorValToArr=colorSelTo.match(regexp);_this.clearNullArr(colorValToArr);var colorMinValue=min+i*valueMark;if(i==colorArr.length-2){colorMaxValue=max;}
if(valueCurrent<=colorMaxValue){$gradientDom.css('background','rgb('+(parseInt((parseInt(colorValToArr[0]-colorValPreArr[0])*(valueCurrent-colorMinValue)/(colorMaxValue-colorMinValue)).toFixed(0))+parseInt(colorValPreArr[0]))+','+(parseInt((parseInt(colorValToArr[1]-colorValPreArr[1])*(valueCurrent-colorMinValue)/(colorMaxValue-colorMinValue)).toFixed(0))+parseInt(colorValPreArr[1]))+','+(parseInt((parseInt(colorValToArr[2]-colorValPreArr[2])*(valueCurrent-colorMinValue)/(colorMaxValue-colorMinValue)).toFixed(0))+parseInt(colorValPreArr[2]))+')');i=colorArr.length-1;}}},refreshData:function refreshData(e,isOnlyRenderDictFault){if(!e.data||$.isEmptyObject(e.data)||e.data.error){Spinner.stop();}
_this=this.self?this.self:this;if(e.data.notice&&e.data.notice[0]){_this.arrLastNotice=e.data.notice;var existedIds=[];for(var i in _this.arrLastNotice){existedIds.push(_this.arrLastNotice[i].id);}
if($.inArray(e.data.notice[0].id,existedIds)<0){Array.prototype.push.apply(e.data.notice,_this.arrLastNotice);_this.arrLastNotice=e.data.notice;}
for(var key in _this.dictEquipment){_this.dictEquipment[key].faultIds=new Array();}
try{var dictFaultHighestGrade={};for(var i=0;i<e.data.notice.length;i++){var faultId=e.data.notice[i].faultId,equipmentId=e.data.notice[i].equipmentId;var grade;var eq=_this.dictEquipment[equipmentId];eq.faultIds.push(faultId);grade=dictFaultHighestGrade[eq.modalTextId];if(!grade||e.data.notice[i].grade>grade)dictFaultHighestGrade[eq.modalTextId]=e.data.notice[i].grade;}
for(var key in dictFaultHighestGrade){if(_this.dictObserverText[key])_this.dictObserverText[key].updateDiagnosisGrade(dictFaultHighestGrade[key]);}}catch(e){console.log(e);}}else{$('#spinnerLoadingNotice').remove();}
$('#spinnerLoadingNotice').remove();$('#btnWarningLog').fadeIn();$('#navigation').fadeIn();$('#diagnosisLogCt').slideDown();Spinner.stop();if(isOnlyRenderDictFault)return;$('.badge.warningCount','#paneIcon').empty();$('.badge.alertCount','#paneIcon').empty();if(e.data.count&&e.data.count instanceof Array){e.data.count.forEach(function(obj){for(var i in obj){var warningCount=parseInt(obj[i].warning);var alertCount=parseInt(obj[i].alert);var $targetWarning=$('#navFloor-'+i).next('.warningCount');var $targetAlert=$('#navFloor-'+i).siblings('.alertCount');if(warningCount>0){$targetWarning.html(warningCount);}else{$targetWarning.html('');}
if(alertCount>0){$targetAlert.html(alertCount);}else{$targetAlert.html('');}}});}
_this.statisticFaultCount();_this.renderPaneNoticeGroup();},initPaneNav:function initPaneNav(){var pane=document.createElement('div');var div,zoneItem,itemI,itemJ;var zoneItemList=[];var $buildingBox,$subBuilding=$('.subBuilding'),$subBuildingList,countHtml;var $dropdownBtn=$('#dropdownBtn');for(var zoneId in this.dictZone){zoneItem=this.dictZone[zoneId];zoneItemList.push(zoneItem);}
var paneIcon=document.getElementById('paneIcon');paneIcon.innerHTML="";paneIcon.appendChild(pane);for(var i=0;i<zoneItemList.length;i++){countHtml='';var isSameBuild=false;itemI=zoneItemList[i];for(var j=0;j<zoneItemList.length;j++){itemJ=zoneItemList[j];if(itemI.buildingId==itemJ.buildingId){isSameBuild=true;break;}}
if(isSameBuild){$buildingBox=$('.div-nav-box'+itemI.buildingId);if($buildingBox.length===0){$buildingBox=$('<div class="div-nav-box'+itemI.buildingId+'"><span id="building_'+itemI.buildingId+'" class="grow subBuildingBtn"></span><span class="badge warningCount"></span><span class="badge alertCount"></span></div>');$buildingBox.find('#building_'+itemI.buildingId).html(itemI.buildingName);$subBuildingList=$('<div class="subBuildingList" id="subList_'+itemI.buildingId+'"></div>');$buildingBox.append($subBuildingList);$(pane).append($buildingBox);}
if(itemI.count&&itemI.count>0){countHtml='<span class="badge warningCount">'+itemI.count+'</span><span class="badge alertCount"></span>';}else{countHtml='<span class="badge warningCount"></span><span class="badge alertCount"></span>';}
var $subBuildings=$('#subList_'+itemI.buildingId).children('.subBuilding');var countArry=[];for(var k=0;k<$subBuildings.length;k++){countArry.push(parseInt($subBuildings.eq(k).attr('count')));}
if(countArry.length===0||itemI.count>countArry[countArry.length-1]){$subBuilding=$('<div class="div-nav-row subBuilding" count="'+itemI.count+'"><span class="div-row-icon-badge grow subBuildingItem" pageId="'+itemI.pageId+'" id="navFloor-'+itemI.id+'"></span>'+countHtml+'</div>');$subBuilding.find('.subBuildingItem').html(itemI.subBuildingName);$('#subList_'+itemI.buildingId).append($subBuilding);}else{for(var q=0;q<countArry.length;q++){if(itemI.count<countArry[q]){$subBuilding=$('<div class="div-nav-row subBuilding" count="'+itemI.count+'"><span class="div-row-icon-badge grow subBuildingItem" pageId="'+itemI.pageId+'" id="navFloor-'+itemI.id+'"></span>'+countHtml+'</div>');$subBuilding.find('.subBuildingItem').html(itemI.subBuildingName);$($subBuildings[q]).before($subBuilding);break;}else if(itemI.count===countArry[q]){if(countArry[q]===countArry[countArry.length-1]){$subBuilding=$('<div class="div-nav-row subBuilding" count="'+itemI.count+'"><span class="div-row-icon-badge grow subBuildingItem" pageId="'+itemI.pageId+'" id="navFloor-'+itemI.id+'"></span>'+countHtml+'</div>');$subBuilding.find('.subBuildingItem').html(itemI.subBuildingName);$('#subList_'+itemI.buildingId).append($subBuilding);break;}else{for(var p=q;p<countArry.length;p++){if(itemI.count<countArry[p]){$subBuilding=$('<div class="div-nav-row subBuilding" count="'+itemI.count+'"><span class="div-row-icon-badge grow subBuildingItem" pageId="'+itemI.pageId+'" id="navFloor-'+itemI.id+'"></span>'+countHtml+'</div>');$subBuilding.find('.subBuildingItem').html(itemI.subBuildingName);$($subBuildings[p]).before($subBuilding);break;}}
break;}}}}
$dropdownBtn.off('click').on('click',function(){$(this).siblings('.dropdownList').toggleClass('hidden');});$subBuilding.find('.subBuildingItem').off('click').click(function(){var $this=$(this);var id=$this.attr('pageId');AppConfig.zoneId=this.id.split('-')[1];$('.subBuildingItem.selected').removeClass('selected');$this.addClass('selected');$dropdownBtn.html($this.text()+'<span class="caret"></span>');_this.arrLastNotice.length=0;_this.initWorkerForUpdating();$this.closest('.dropdownList').addClass('hidden');});}}
this.statisticFaultCount();$('.subBuildingBtn').off('click').click(function(){$(this).toggleClass('selected');var $subBuildListCur=$(this).siblings('.subBuildingList');if($subBuildListCur.is(':visible')){$subBuildListCur.hide();}else{$subBuildListCur.show();}});},statisticFaultCount:function statisticFaultCount(){var allCount=0;$('[class ^="div-nav-box"]').each(function(){var warningCount=0,alertCount=0;$(this).children('.subBuildingList').find('.warningCount').not(':empty').each(function(){var text=$(this).text();if(Number(text).toString()!='NaN'){warningCount+=parseInt(text);}});if(warningCount>0){$(this).children('.warningCount').html(warningCount);}else{$(this).children('.warningCount').html('');}
$(this).children('.subBuildingList').find('.alertCount').not(':empty').each(function(){var text=$(this).text();if(Number(text).toString()!='NaN'){alertCount+=parseInt(text);}});if(alertCount>0){$(this).children('.alertCount').html(alertCount);}else{$(this).children('.alertCount').html('');}
allCount+=warningCount+alertCount;});$('#logWrap #toolBar #btnWarningLog .badge').html(allCount);},createWorkflowOrder:function createWorkflowOrder(notice){var wiInstance;var momentTime=notice.time.toDate();var back=function back(){wiInstance=null;};var insertCallback=function insertCallback(taskModelInfo){var taskTitle=taskModelInfo&&taskModelInfo.fields?taskModelInfo.fields.title:'';Alert.success(ElScreenContainer,I18n.resource.workflow.main.THE_WORK_ORDER+' '+taskTitle+' '+I18n.resource.workflow.main.IS_CREATED_SUCCESSFULLY).showAtTop(2000);var $faultCount=$('#btnWarningLog .badge');var faultCount=function(txt){if(parseInt(txt).toString()!="NaN"){return parseInt(txt);}
return 0;}($faultCount.text());if(faultCount>0){var count=faultCount-1;count=count>0?count:'';$faultCount.text(count);$('[noticeid="'+notice.id+'"]').remove();if(notice.grade===1){var $warningCount=$('#navFloor-'+AppConfig.zoneId).next('.warningCount');$warningCount.text($warningCount.text()-1);}else if(notice.grade===2){var $alertCount=$('#navFloor-'+AppConfig.zoneId).siblings('.alertCount');$alertCount.text($alertCount.text()-1);}}};var str=notice.description;var arr=notice.detail?notice.detail.split(','):[];var matchRt=str.match(/\{\d\}/g);if(matchRt&&matchRt instanceof Array){matchRt.forEach(function(val,index){str=str.replace(val,arr[index]?arr[index]:'');});}
wiInstance=new WorkflowInsert({noticeId:notice.id,title:notice.name,detail:notice.description,dueDate:new Date(+new Date()+172800000).format('yyyy-MM-dd'),critical:notice.grade,projectId:Number(notice.project),chartPointList:notice.points,chartQueryCircle:'m5',description:str,name:notice.name,time:new Date(momentTime).format('yyyy-MM-dd HH:mm:ss'),chartStartTime:new Date(new Date(momentTime).getTime()-12*60*60*1000).format('yyyy-MM-dd HH:mm:ss'),chartEndTime:new Date(new Date(momentTime).getTime()+12*60*60*1000).format('yyyy-MM-dd HH:mm:ss')});wiInstance.show().submitSuccess(function(taskModelInfo,uploadFiles){insertCallback(taskModelInfo);this.close();back();}).cancel(function(){back();}).fail(function(){Alert.danger(ElScreenContainer,I18n.resource.workflow.main.CREATE_WORKFLOW_FAILED).showAtTop(2000);});return true;},renderPaneNoticeGroup:function renderPaneNoticeGroup(){var _this=this;var urgentCount=0,criticalCount=0,className;this.insertLogGroup();var item,parent;for(var i=0,len=_this.arrLastNotice.length;i<len;i++){item=_this.arrLastNotice[i];var grade=item.grade;if(1==grade){className='adNormal';criticalCount++;}else if(2==grade){className='faultPro';urgentCount++;}else{continue;}
_this.insertLogItem(item,i,className);}
_this.criticalCount=_this.arrLastNotice.length;var $btnErr=$('#abNomalP');if($btnErr&&$btnErr.length>0){$btnErr.change();}},insertLogGroup:function insertLogGroup(){var $abNomalP=$('#abNomalP');var $faultP=$('#faultP');var $divPaneNoticeItem=$('#divPaneNoticeItem');$divPaneNoticeItem.children().remove();$abNomalP.on('change',function(){var $adNormalOne=$divPaneNoticeItem.find('.adNormal');var $faultProOne=$divPaneNoticeItem.find('.faultPro');if($abNomalP.is(':checked')&&$faultP.is(':checked')||!$abNomalP.is(':checked')&&!$faultP.is(':checked')){$adNormalOne.show();$faultProOne.show();}else if($abNomalP.is(':checked')&&!$faultP.is(':checked')){$adNormalOne.show();$faultProOne.hide();}else if(!$abNomalP.is(':checked')&&$faultP.is(':checked')){$adNormalOne.hide();$faultProOne.show();}});$faultP.on('change',function(){var $adNormalTwo=$divPaneNoticeItem.find('.adNormal');var $faultProTwo=$divPaneNoticeItem.find('.faultPro');if($abNomalP.is(':checked')&&$faultP.is(':checked')||!$abNomalP.is(':checked')&&!$faultP.is(':checked')){$adNormalTwo.show();$faultProTwo.show();}else if($abNomalP.is(':checked')&&!$faultP.is(':checked')){$adNormalTwo.show();$faultProTwo.hide();}else if(!$abNomalP.is(':checked')&&$faultP.is(':checked')){$adNormalTwo.hide();$faultProTwo.show();}});},insertLogItem:function insertLogItem(item,itemNum,className){var divParent=$('#divPaneNoticeItem');var _this=this;var divNotice,equipment,zone,sb,span,textId,spanFirst;equipment=this.dictEquipment[item.equipmentId];textId=equipment.modalTextId;zone=this.dictZone[equipment.zoneId];divNotice=document.createElement('div');divNotice.id='divLog-'+itemNum;divNotice.setAttribute('path',zone.id+'-'+equipment.id);divNotice.setAttribute('faultid',item.faultId);divNotice.setAttribute('noticeId',item.id);if(textId!==null)divNotice.setAttribute('data-modaltextid',textId);divNotice.className='div-pane-log';$(divNotice).addClass(className);var parent=$(divNotice);var $spWrap=$('<div style="white-space: nowrap;">');spanFirst=$('<span>');switch(item.grade){case 0:break;case 1:spanFirst.addClass('badge wrongTag').html(_this.langCfg.LEVEL_SET.CRITICAL);break;case 2:spanFirst.addClass('badge dangerTag').html(_this.langCfg.LEVEL_SET.URGENT);break;default:break;}
$spWrap.append(spanFirst);span=$('<span>').addClass('badge grow span-hover-pointer').attr('title','Equipment name').attr('equipment',equipment.pageId).text(equipment.name);span.click(function(e){});$spWrap.append(span);$('<span>').addClass('badge grow span-hover-pointer').attr({'pageId':zone.pageId,'title':'Zone ID','data-zoneId':zone.id}).text(zone.subBuildingName).click(function(e){}).appendTo($spWrap);$('<span>').attr({'title':'Triggering time','data-time':item.time}).text(timeFormat(item.time,timeFormatChange('mm-dd hh:ii'))).addClass('dateTime').appendTo($spWrap);if(item.orderId&&item.orderId!=0&&item.orderId!=''){}else{$('<span>').addClass('createWorkflowSpan glyphicon glyphicon-share grow span-hover-pointer span-btn').attr('title','Create workflow order').click(function(e){_this.createWorkflowOrder(item);}).appendTo($spWrap);}
$('<span class="feedbackSpan glyphicon glyphicon-comment grow span-hover-pointer span-btn" title="feedback">').eventOn('click',function(e){var itemEquipmentId=item.equipmentId;var diagnosisLength=_this.result.equipments.length;for(var i=0;i<diagnosisLength;i++){if(itemEquipmentId==_this.result.equipments[i].id){var currentEquipmentName=_this.result.equipments[i].name;break;}}
var detailPrefix=I18n.resource.workflow.main.ORDER_EQUIPMENT_NAME+currentEquipmentName+"\n"+I18n.resource.workflow.main.ORDER_FAULT_INFO+item.description+"\n"+I18n.resource.workflow.main.ORDER_FEEDBACK_MSG;new WorkflowFeedBack({faultId:item.faultId,title:I18n.resource.workflow.main.FEEDBACK_TITLE+item.name,description:item.description,detailPrefix:detailPrefix,dueDate:new Date(new Date().getTime()+2592000000).format('yyyy-MM-dd HH:mm:ss'),critical:item.grade,projectId:Number(item.project),chartPointList:item.points,chartQueryCircle:'m5',chartStartTime:new Date(new Date(item.time.toDate()).getTime()-43200000).format('yyyy-MM-dd HH:mm:ss'),chartEndTime:new Date(new Date(item.time.toDate()).getTime()+43200000).format('yyyy-MM-dd HH:mm:ss')}).show();},'').appendTo($spWrap);parent.append($spWrap);$('<p>').addClass('pFaultName').css({'font-weight':'bold','padding':'0 8px 0 0'}).text(item.name).appendTo(parent);var strDesc=item.description;if(item.detail){var arr=item.detail.toString().split(',');for(var j=0;j<arr.length;j++){strDesc=strDesc.replace('{'+j.toString()+'}','<span class="variable"> '+arr[j]+' </span>');}}
$('<p>').html(strDesc).appendTo(parent);divParent.append(parent);}};return ModalDiagnosisPanel;}();var ModalDiagnosisPanelHtml=function(){function ModalDiagnosisPanelHtml(screen,entityParams){ModalBase.call(this,screen,entityParams,this.renderModal,this.updateModal,this.showConfigMode);this.screen=screen;this.entity=entityParams;}
ModalDiagnosisPanelHtml.prototype=Object.create(ModalHtml.prototype);ModalDiagnosisPanelHtml.prototype.constructor=ModalDiagnosisPanelHtml;ModalDiagnosisPanelHtml.prototype.optionTemplate={name:'toolBox.modal.DIAGNOSIS_PANEL',parent:0,mode:[''],maxNum:1,title:'',minHeight:4,minWidth:3,maxHeight:6,maxWidth:12,type:'ModalDiagnosisPanelHtml',tooltip:{'imgPC':true,'imgMobile':false,'isSpecData':false,'desc':''}};return ModalDiagnosisPanelHtml;}();var DiagnosisLogHistory=function(){var _this=undefined;function DiagnosisLogHistory(parent){_this=this;this.parent=parent;this.m_tableInfo=[];this.m_bSortTimeAscend=false;this.m_bSortGradeAscend=false;this.m_bSortEquipAscend=false;this.m_bSortZoneAscend=false;this.m_bSortFaultAscend=false;this.m_bSortStatusAscend=false;this.isModal=false;}
DiagnosisLogHistory.prototype={show:function show(){var _this=this;window.ElScreenContainer&&Spinner.spin(ElScreenContainer);WebAPI.get("/static/views/observer/diagnosis/paneHistory.html").done(function(resultHtml){var dialog=$('#dialogModal');if(dialog.length<1){$('body').append('<div class="modal fade" id="dialogModal" tabindex="-1" data-backdrop="static" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg" id="dialogContent"></div></div>');dialog=$('#dialogModal');}
var $dialogContent=dialog.find('#dialogContent');$dialogContent.addClass('historyQueryModel').html(resultHtml).find('.modal-content').css({'height':document.body.scrollHeight-40});if(_this.parent&&_this.parent.optionCss){$dialogContent.find('.modal-content,#btnDownload,#btnDownloadPDF').css(_this.parent.optionCss);}
dialog.off('hidden.bs.modal').on('hidden.bs.modal',function(e){_this.close();ScreenModal=null;Spinner.stop();$dialogContent.removeClass('historyQueryModel');}).modal({});Spinner.spin(dialog.find('.modal-body')[0]);_this.init();$("#datePickerLog").datetimepicker({minView:"month",autoclose:true,todayBtn:true,initialDate:new Date()});$('#btnDownload').attr('title',i18n_resource.diagnosis.historyLog.DOWNLOAD_EXCEL);$('#btnDownloadPDF').attr('title',i18n_resource.diagnosis.historyLog.DOWNLOAD_PDF);var date=new Date();$("#txtLogDate").val(date.timeFormat(timeFormatChange('yyyy-mm-dd')));$('#thTime').click(function(e){_this.sortTable(0);});$('#thGrade').click(function(e){_this.sortTable(1);});$('#thEquip').click(function(e){_this.sortTable(2);});$('#thZone').click(function(e){_this.sortTable(3);});$('#thFault').click(function(e){_this.sortTable(4);});$('#thStatus').click(function(e){_this.sortTable(5);});$('#btnSearchFault').eventOn('click',function(e){_this.searchFaultInfo();},'');$('#inputSearchFault').keyup(function(e){if(13===e.keyCode){_this.searchFaultInfo();}});});},close:function close(){_this.m_tableInfo.forEach(function(m_tableInfo){m_tableInfo&&m_tableInfo.dispose&&m_tableInfo.dispose();m_tableInfo=null;});_this.m_tableInfo=[];$('#dialogContent').empty();},init:function init(){var _this=this;var now=new Date();var startTime=new Date(now.getFullYear(),now.getMonth(),now.getDate());this.refreshData(startTime,now);var timeFormat=timeFormatChange('yyyy-mm-dd');$("#datePickerLog").attr('data-date-format',timeFormat);$("#txtLogDate").eventOn('change',function(e){var startTime=($(this).val()+' 00:00:00').toDate();var endTime=new Date(+startTime+86400000);_this.refreshData(startTime,endTime);},'');EventAdapter.on($("#btnLogPre"),'click',function(e){var endTime=($("#txtLogDate").val()+' 00:00:00').toDate();var preDay=new Date(+endTime-86400000);$("#txtLogDate").val(preDay.timeFormat(timeFormat));_this.refreshData(preDay,endTime);},'');$("#btnLogNext").eventOff('click').eventOn('click',function(e){var startTime=($("#txtLogDate").val()+' 00:00:00').toDate();var nextDay=new Date(+startTime+86400000);$("#txtLogDate").val(nextDay.timeFormat(timeFormat));startTime=($("#txtLogDate").val()+' 00:00:00').toDate();nextDay=new Date(+startTime+86400000);_this.refreshData(startTime,nextDay);},'');$("#btnDownload").eventOff('click').eventOn('click',function(){if($('#tableNoticeHistory tbody tr').length===0){alert('');return;}
var logTime=($("#txtLogDate").val()+' 00:00:00').toDate();var startTime=logTime.format("yyyy-MM-dd HH:mm:ss");var endTime=new Date(+logTime+86400000).format("yyyy-MM-dd HH:mm:ss");var language=localStorage.getItem('language');window.open('/diagnosis/downloadHistoryFault/'+AppConfig.projectId+'/'+startTime+'/'+endTime+'/'+language);},'excel');$("#btnDownloadPDF").eventOff('click').eventOn('click',function(){if($('#tableNoticeHistory tbody tr').length===0){alert('');return;}
var reportTitle=i18n_resource.diagnosis.historyLog.TITLE;Spinner.spin(document.body);var arrHtml=[];$('#tableNoticeHistory').find('.removeNode').remove();arrHtml.push($('#tableWrap').html());var promise=WebAPI.get('/static/views/share/reportWrap/pdfTemplate.html');promise.done(function(html){var xhr,formData;html=html.formatEL({cover:BEOPUtil.getProjectImgByType(AppConfig.projectId,BEOPUtil.projectImgType.pdfCover),title:reportTitle,encoding:'UTF-8',entitiesHtml:arrHtml[0],projName:AppConfig.projectShowName,logo:BEOPUtil.getProjectImgByType(AppConfig.projectId,BEOPUtil.projectImgType.logo),date:$('#txtLogDate').val(),footerLeft:i18n_resource.report.reportWrap.GENERATED_BY_BEOP,footerRight:localStorage.getItem("language")==="zh"?" [page]  [topage]":"Page [page] of [topage]"});formData=new FormData();formData.append('html',html);formData.append('skin','default');xhr=new XMLHttpRequest();xhr.open('POST','/admin/getShareReportWrapPDF');xhr.responseType='arraybuffer';xhr.onload=function(){var blob,url,lkPdfFile;if(this.status===200){blob=new Blob([xhr.response],{type:"application/pdf"});url=URL.createObjectURL(blob);lkPdfFile=document.createElement('a');lkPdfFile.style="display: none";lkPdfFile.id="lkPdfFile";lkPdfFile.href=url;lkPdfFile.download=reportTitle+' '+$('#txtLogDate').val()+'.pdf';document.body.appendChild(lkPdfFile);lkPdfFile.click();window.URL.revokeObjectURL(url);window.setTimeout(function(){lkPdfFile.parentNode.removeChild(lkPdfFile);},0);}else{alert('Generate report failed, please try it again soon!');}
Spinner.stop();};xhr.send(formData);}).fail(function(e){throw e;});},'PDF');},createWorkflowOrder:function createWorkflowOrder(notice){var wiInstance;var momentTime=notice.time.toDate();var back=function back(){wiInstance=null;};var insertCallback=function insertCallback(taskModelInfo){var taskTitle=taskModelInfo&&taskModelInfo.fields?taskModelInfo.fields.title:'';Alert.success(ElScreenContainer,I18n.resource.workflow.main.THE_WORK_ORDER+' '+taskTitle+' '+I18n.resource.workflow.main.IS_CREATED_SUCCESSFULLY).showAtTop(2000);var $faultCount=$('#btnWarningLog .badge');var faultCount=function(txt){if(parseInt(txt).toString()!="NaN"){return parseInt(txt);}
return 0;}($faultCount.text());if(faultCount>0){var count=faultCount-1;count=count>0?count:'';$faultCount.text(count);$('[noticeid="'+notice.id+'"]').remove();if(notice.grade===1){var $warningCount=$('#navFloor-'+AppConfig.zoneId).next('.warningCount');$warningCount.text($warningCount.text()-1);}else if(notice.grade===2){var $alertCount=$('#navFloor-'+AppConfig.zoneId).siblings('.alertCount');$alertCount.text($alertCount.text()-1);}}};wiInstance=new WorkflowInsert({noticeId:notice.id,title:notice.name,detail:notice.description,dueDate:new Date(+new Date()+172800000).format('yyyy-MM-dd'),critical:notice.grade,projectId:Number(notice.project),chartPointList:notice.points,chartQueryCircle:'m5',description:notice.description,name:notice.name,time:new Date(momentTime).format('yyyy-MM-dd HH:mm:ss'),chartStartTime:new Date(new Date(momentTime).getTime()-12*60*60*1000).format('yyyy-MM-dd HH:mm:ss'),chartEndTime:new Date(new Date(momentTime).getTime()+12*60*60*1000).format('yyyy-MM-dd HH:mm:ss')});wiInstance.show().submitSuccess(function(taskModelInfo,uploadFiles){insertCallback(taskModelInfo);this.close();back();}).cancel(function(){back();}).fail(function(){Alert.danger(ElScreenContainer,I18n.resource.workflow.main.CREATE_WORKFLOW_FAILED).showAtTop(2000);});return true;},refreshData:function refreshData(startTime,endTime){var _this=this;startTime=startTime.format("yyyy-MM-dd HH:mm:ss");endTime=endTime.format("yyyy-MM-dd HH:mm:ss");Spinner.spin(document.getElementById('tableNoticeHistory'));WebAPI.get('/diagnosis/getHistoryFault/'+AppConfig.projectId+'/'+startTime+'/'+endTime).done(function(result){_this.m_tableInfo=result;_this.initTable(result);}).error(function(result){var dialog=$('#dialogModal');dialog.find('.modal-body').html('Error query.');}).always(function(){Spinner.stop();});},initTable:function initTable(data){var _this2=this;$('#tableNoticeHistory tbody').remove();var tbody=document.createElement('tbody');var $spanPoint;$('#tableNoticeHistory').append(tbody);if(data.length==0)tbody.innerHTML='no history data';var tr,td,item,sb,equipment,zone,timeDif,strDesc;var _loop=function _loop(){item=data[i];strDesc=item.description;equipment=_this2.parent.dictEquipment[item.equipmentId];if(!equipment)return'continue';zone=_this2.parent.dictZone[equipment.zoneId];tr=document.createElement('tr');tr.id='diagHistory_'+item.id;tr.title=strDesc;tbody.appendChild(tr);$(tr).append($('<td></td>').html(item.time.toDate().timeFormat(timeFormatChange("yyyy-mm-dd hh:ii:ss"))));switch(item.grade){case 0:$(tr).append('<td><span class="badge" style="background-color: #5bc0de;" title="Grade">Normal</span></td>');break;case 1:$(tr).append('<td><span class="badge" style="background-color: #f0ad4e;" title="Grade">Alert</span></td>');break;case 2:$(tr).append('<td><span class="badge" style="background-color: #d9534f;" title="Grade">Fault</span></td>');break;default:$(tr).append('<td><span class="badge" style="background-color: #d9534f;" title="Grade">Unknown</span></td>');break;}
$(tr).append($('<td></td>').html(equipment.name));$(tr).append($('<td></td>').html(zone.subBuildingName));$(tr).append($('<td></td>').html(item.name));switch(item.status){case'0':$(tr).append('<td>Disable</td>');break;case'1':$(tr).append('<td>Delayed</td>');break;case'2':$(tr).append('<td>Realtime</td>');break;default:$(tr).append('<td></td>');break;}
if(!item.resTime||item.resTime==null){$(tr).append($('<td class="removeNode" colspan="2" style="text-align:center;" i18n="diagnosis.historyLog.RESPONSE_CONTENT"></td>'));switch(item.FeedBack){case 0:$(tr).append('<td><span class="badge"></span></td>');break;case 1:$(tr).append('<td><span class="badge" style="background-color: #5bc0de;">Waiting</span></td>');break;case 2:$(tr).append('<td><span class="badge" style="background-color: #f0ad4e;">executing</span></td>');break;case 3:$(tr).append('<td><span class="badge" style="background-color: #5cb85c;">finished</span></td>');break;default:break;}
$spanPoint=pointerClick(item);$(tr).append($('<td class="removeNode someHide"></td>').append($spanPoint));}else{timeDif=Math.floor((new Date(item.resTime).getTime()-new Date(item.time).getTime())/(3600*1000));$(tr).append($('<td class="removeNode"></td>').html(item.executor));$(tr).append($('<td class="removeNode"></td>').html(timeDif));$(tr).append($('<td class="removeNode"></td>').html(''));}
arr=item.detail.toString().split(',');for(j=0;j<arr.length;j++){strDesc=strDesc.replace('{'+j.toString()+'}','<span class="variable">'+arr[j]+'</span>');}
function pointerClick(item){var $pointeer;$pointeer=$('<span class="glyphicon glyphicon-share grow span-hover-pointer" data-dismiss="modal"></span>').off('click').on('click',function(){_this.createWorkflowOrder(item);});return $pointeer;}};for(var i=0,len=data.length;i<len;i++){var arr;var j;var _ret=_loop();if(_ret==='continue')continue;}},sortTable:function sortTable(type){$('#tableNoticeHistory tbody').html('');if(0===type){if(!_this.m_bSortTimeAscend){_this.m_tableInfo.sort(_this.sortTimeAscending);}else{_this.m_tableInfo.sort(_this.sortTimeDescending);}
_this.m_bSortTimeAscend=!_this.m_bSortTimeAscend;}else if(1===type){if(!_this.m_bSortGradeAscend){_this.m_tableInfo.sort(_this.sortGradeAscending);}else{_this.m_tableInfo.sort(_this.sortGradeDescending);}
_this.m_bSortGradeAscend=!_this.m_bSortGradeAscend;}else if(2===type){if(!_this.m_bSortEquipAscend){_this.m_tableInfo.sort(_this.sortEquipAscending);}else{_this.m_tableInfo.sort(_this.sortEquipDescending);}
_this.m_bSortEquipAscend=!_this.m_bSortEquipAscend;}else if(3===type){if(!_this.m_bSortZoneAscend){_this.m_tableInfo.sort(_this.sortZoneAscending);}else{_this.m_tableInfo.sort(_this.sortZoneDescending);}
_this.m_bSortZoneAscend=!_this.m_bSortZoneAscend;}else if(4===type){if(!_this.m_bSortFaultAscend){_this.m_tableInfo.sort(_this.sortFaultAscending);}else{_this.m_tableInfo.sort(_this.sortFaultDescending);}
_this.m_bSortFaultAscend=!_this.m_bSortFaultAscend;}else if(5===type){if(!_this.m_bSortStatusAscend){_this.m_tableInfo.sort(_this.sortStatusAscending);}else{_this.m_tableInfo.sort(_this.sortStatusDescending);}
_this.m_bSortStatusAscend=!_this.m_bSortStatusAscend;}
_this.initTable(_this.m_tableInfo);},sortTimeAscending:function sortTimeAscending(a,b){return new Date(a.time)-new Date(b.time);},sortTimeDescending:function sortTimeDescending(a,b){return new Date(b.time)-new Date(a.time);},sortGradeAscending:function sortGradeAscending(a,b){return a.grade-b.grade;},sortGradeDescending:function sortGradeDescending(a,b){return b.grade-a.grade;},sortEquipAscending:function sortEquipAscending(a,b){var equipA=_this.parent.dictEquipment[a.equipmentId];var equipB=_this.parent.dictEquipment[b.equipmentId];return equipA.name.localeCompare(equipB.name);},sortEquipDescending:function sortEquipDescending(a,b){var equipA=_this.parent.dictEquipment[a.equipmentId];var equipB=_this.parent.dictEquipment[b.equipmentId];return equipB.name.localeCompare(equipA.name);},sortZoneAscending:function sortZoneAscending(a,b){var equip=_this.parent.dictEquipment[a.equipmentId];var zoneA=_this.parent.dictZone[equip.zoneId];equip=_this.parent.dictEquipment[b.equipmentId];var zoneB=_this.parent.dictZone[equip.zoneId];return zoneA.subBuildingName.localeCompare(zoneB.subBuildingName);},sortZoneDescending:function sortZoneDescending(a,b){var equip=_this.parent.dictEquipment[a.equipmentId];var zoneA=_this.parent.dictZone[equip.zoneId];equip=_this.parent.dictEquipment[b.equipmentId];var zoneB=_this.parent.dictZone[equip.zoneId];return zoneB.subBuildingName.localeCompare(zoneA.subBuildingName);},sortFaultAscending:function sortFaultAscending(a,b){return a.name.localeCompare(b.name);},sortFaultDescending:function sortFaultDescending(a,b){return a.name.localeCompare(b.name);},sortStatusAscending:function sortStatusAscending(a,b){return a.status-b.status;},sortStatusDescending:function sortStatusDescending(a,b){return b.status-a.status;},searchFaultInfo:function searchFaultInfo(){var searchVal=$('#inputSearchFault').val();if(null==searchVal||undefined==searchVal){return;}
$('#tableNoticeHistory tbody').html('');if(''==searchVal){_this.initTable(_this.m_tableInfo);return;}
var item;var arrSuit=[];searchVal=searchVal.toLowerCase();for(var i=0,len=_this.m_tableInfo.length;i<len;i++){item=_this.m_tableInfo[i];if(-1!=item.name.toLowerCase().indexOf(searchVal)){arrSuit.push(item);}}
_this.initTable(arrSuit);},setIsModal:function setIsModal(boolean){this.isModal=boolean;},renderChart:function renderChart(record){Spinner.spin($("#wf-add-person")[0]);var list_description=record.list_description,list_value=record.list_value,arrXAxis;if(list_description.length==list_value.length){if(record.list_time.length>0)arrXAxis=record.list_time[0].split(',');var arrSeriesTemp=[];for(var i=0;i<list_value.length;i++){var arrDatas=[];if(i<8){var item=list_value[i];if(item){var strDatas=item.split(",");for(var j=0;j<strDatas.length;++j){arrDatas.push(parseFloat(strDatas[j]).toFixed(1));}}
arrSeriesTemp.push({name:list_description[i],type:'line',itemStyle:{normal:{lineStyle:{type:'solid'}}},data:arrDatas});}}
var option={tooltip:{trigger:'axis',formatter:function formatter(params){var strResult;if(params[0].name.length>0){strResult=params[0].name+'<br/>';for(var i=0;i<params.length;++i){strResult+=params[i].seriesName+' : '+params[i].value;if(i!=params.length-1){strResult+='<br/>';}}}
return strResult;}},legend:{data:list_description,x:'center'},toolbox:{show:true},dataZoom:{show:true,realtime:true,start:0,end:100},xAxis:[{name:"",type:'category',boundaryGap:false,axisLine:{onZero:false},data:arrXAxis}],yAxis:[{name:"",type:'value',scale:true}],series:arrSeriesTemp,showLoading:{text:'loading',effect:'spin'}};var myChart=echarts.init($('#wf-fault-curve').get(0));myChart.setOption(option);window.onresize=myChart.resize;Spinner.stop();}}};return DiagnosisLogHistory;}();var DataSource=function(){var _this;function DataSource(parent,opt){_this=this;this.m_parent=parent;this.m_newPointList=[];this.m_allPointList=[];this.m_allGroupList=[];this.m_arrProjIdColorMap={};this.m_dataSourceId;this.m_lang=I18n.resource.dataSource;this.m_selectItemId=0;this.m_selectGroupId=0;this.m_groupIconOpen='/static/images/dataSource/group_head_sel.png';this.m_groupIconClose='/static/images/dataSource/group_head_normal.png';this.m_cfgPanel;this.m_unassigned='unassigned';this.m_langFlag='zh'==localStorage['language']?0:1;this.$dsNavContain=undefined;this.m_curPageNum=1;this.m_arrCloudTableInfo=[];this.disableIot=opt&&opt.disableIot?true:false;this.treeObj=undefined;this.iotFilter=undefined;this.iotOpt={};}DataSource.prototype={show:function show(){var _this=this;Spinner.spin(ElScreenContainer);I18n.fillArea($('#divAnlsDatasourcePane'));I18n.fillArea($('#divEnergyAnlsPane'));_this.loadDataSourceRecord();_this.initContain();_this.initElement();Spinner.stop();},close:function close(){this.m_newPointList=null;this.m_allPointList=null;},initContain:function initContain(){this.initTreeNavStyle();},initTreeNavStyle:function initTreeNavStyle(){WebAPI.get('/static/views/observer/dataSource.html').done(function(resultHtml){_this.$dsNavContain=$(resultHtml);I18n.fillArea(_this.$dsNavContain);var $pageMine=_this.$dsNavContain.find('#pageMine');var $pageCloud=_this.$dsNavContain.find('#pageCloud');var $pageIot=_this.$dsNavContain.find('#pageIot');AppConfig.isFactory&&_this.$dsNavContain.find('#liMine').css('display','none').attr('class','');_this.$dsNavContain.find('#liMine').click(function(e){$('#liMine').attr('class','active');$('#liCloud').attr('class','');$('#liIot').attr('class','');$pageMine.show();$pageCloud.hide();$pageIot.hide();_this.currentObj='mine';});_this.$dsNavContain.find('#liCloud').click(function(e){if(_this.m_arrCloudTableInfo.length<=0){_this.initDsCloud();}$('#liMine').attr('class','');$('#liCloud').attr('class','active');$('#liIot').attr('class','');$pageMine.hide();$pageIot.hide();$pageCloud.show();_this.currentObj='cloud';});if(_this.disableIot){_this.$dsNavContain.find('#liIot').remove();}else{_this.$dsNavContain.find('#liIot').click(function(e){$('#liMine').attr('class','');$('#liCloud').attr('class','');$('#liIot').attr('class','active');$pageMine.hide();$pageIot.html('').show();$pageCloud.hide();_this.initIotFilter();_this.currentObj='iot';});_this.initIotFilter();}_this.initDsMine();$('#dataSrcContain').empty();$('#dataSrcContain').append(_this.$dsNavContain);AppConfig.isFactory&&$('#liCloud').click();var addGroup=$('<div id="dataSrcAddGroup"><input type="text" id="inputAddGroup" placeholder="+ Add group" ></div>');$pageMine.append(addGroup);$('#inputAddGroup').attr('placeholder',I18n.resource.dataSource.ADD_GROUP);$pageMine.keyup(function(e){if(13==e.keyCode){_this.addNewGroup();}});var inputAdd=addGroup.find('#inputAddGroup');inputAdd.attr('placeholder',_this.m_lang.ADD_GROUP);inputAdd.blur(function(e){_this.addNewGroup();});}).always(function(e){});},initIotFilter:function initIotFilter(){var $ctn=_this.$dsNavContain.find('#pageIot');_this.iotFilter=new HierFilter($ctn);_this.iotFilter.init();_this.iotOpt=$.extend(true,{},{base:{divideByProject:true},tree:{show:true,event:{click:[{act:onNodeClick,tar:['groups','projects']},{act:ontThingClick,tar:'things'},{act:function act(){console.log('click things');},tar:'things'}]},drag:{dragstart:[{act:onAttrDragStart,tar:'attrs'},{act:onThingsDragStart,tar:'things'}],dragend:[{act:onAttrDragEnd,tar:'attrs'}]}}},_this.iotOpt);_this.iotFilter.setOption(_this.iotOpt);function onNodeClick(event,treeId,treeNode){if(_this.iotFilter.setDefault===true){if(!treeNode.children||treeNode.children.length==0)return;var node=treeNode.children[0];_this.iotFilter.tree.selectNode(node);_this.iotFilter.tree.setting.callback.onClick({target:document.getElementById(node.tId)},node['_id'],node);_this.iotFilter.setDefault=false;}}function ontThingClick(event,treeId,treeNode){var attrs=_this.iotFilter.dictClass['things'][treeNode.type].attrs;var arrNode=[];var node;for(var pt in treeNode.arrP){if(!attrs[pt])continue;node={'_id':treeNode.arrP[pt],'name':attrs[pt].name,'attrType':pt,'baseType':'attrs'};arrNode.push(node);}if(!treeNode.children||treeNode.children.length==0){_this.iotFilter.tree.addNodes(treeNode,arrNode,true);}}function onThingsDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragStart(event,treeNode){EventAdapter.setData({'dsItemId':treeNode['_id'],'dsNode':treeNode});$('.templatePara').css('display','block');}function onAttrDragEnd(){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');}function onNodeDblClick(event,treeId,treeNode,widget){}},initDsMine:function initDsMine(){var $inputSearch=_this.$dsNavContain.find('#inputDsMineSearch');$inputSearch.keyup(function(e){var searchVal=$(this).val().trim();if(13==e.keyCode&&searchVal){WebAPI.get('/analysis/datasource/searchDsItemInfo/'+AppConfig.userId+'/'+searchVal).done(function(result){var treeMine=_this.$dsNavContain.find('#treeMine');var zSetting={async:{enable:false},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false,nameIsHTML:true},edit:{enable:true,drag:{isCopy:false,isMove:false}},data:{simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove}};function addDiyDom(treeId,treeNode){var $itemLeaf=$('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}function addHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.setHoverColor(treeNode);}}function removeHoverDom(treeId,treeNode){if(!treeNode.isParent){_this.removeHoverColor(treeNode);}}function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){_this.zTreeBeforeRemoveFunc(treeNode);}var zNodes=_this.generateSearchTree(result,searchVal);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,zNodes);$('#dataSrcAddGroup').hide();});}if(!searchVal){_this.initDsMineTree();$('#dataSrcAddGroup').show();}});_this.$dsNavContain.find('#spanDsMineSearch').click(function(e){$inputSearch.val('');_this.initDsMineTree();$('#dataSrcAddGroup').show();});_this.initDsMineTree();$('#dataSrcAddGroup').show();},initDsMineTree:function initDsMineTree(){var zSetting={async:{enable:true,type:'get',url:function url(treeId,treeNode){return'/analysis/datasource/getDsItemInfo/'+AppConfig.userId+'/'+(typeof treeNode==='undefined'?'null':treeNode.id);},dataFilter:dsItemfilter},view:{addDiyDom:addDiyDom,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false},edit:{enable:true,renameTitle:I18n.resource.dataSource.RENAME,removeTitle:I18n.resource.dataSource.REMOVE,drag:{isCopy:false,isMove:false}},data:{keep:{leaf:true,parent:true},simpleData:{enable:true}},callback:{beforeRename:zTreeBeforeRename,beforeRemove:zTreeBeforeRemove,onAsyncSuccess:zTreeOnAsyncSuccess,onAsyncError:zTreeOnAsyncError,beforeEditName:zTreeBeforEditName}};function zTreeBeforEditName(treeId,treeNode){if(treeNode.note&&treeNode.note!==''&&treeNode.name.indexOf(treeNode.note)>=0){treeNode.name=treeNode.name.split('(')[1].split(')')[0];}}function dsItemfilter(treeId,parentNode,responseData){Spinner.spin(_this.$dsNavContain[8]);return _this.generateTreeEx(responseData);}function addDiyDom(treeId,treeNode){if(treeNode.num){var aObj=_this.$dsNavContain.find("#"+treeNode.tId+"_switch");var $badge=$('<span class="badge treeBadge">'+treeNode.num+'</span>');aObj.next('a').after($badge);}var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);$itemLeaf.attr('ptid',treeNode.id);$itemLeaf.attr('draggable',true);EventAdapter.on($itemLeaf,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$(e.target);var dragSrcId=tar.attr('ptid');EventAdapter.setData({'dsItemId':dragSrcId});_this.stopBubble(e);});EventAdapter.on($itemLeaf,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemLeaf,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});EventAdapter.on($itemLeaf,'drop',function(e){var tar=$(e.target);var dstTLi=tar.closest('li');var dstId=dstTLi.eq(0).attr('id');var dstNode=_this.treeObj.getNodeByTId(dstId);var srcId=EventAdapter.getData().dsItemId;var srcJq=$('li[ptid$='+srcId+']');var srcTId=srcJq.eq(0).attr('id');var srcNode=_this.treeObj.getNodeByTId(srcTId);var dstParentId=dstNode.pId;var dstParentJq=$('li[ptid$='+dstParentId+']');var dstParentTId=dstParentJq.eq(0).attr('id');var dstParentNode=_this.treeObj.getNodeByTId(dstParentTId);var srcParentId=srcNode.pId;var srcParentJq=$('li[ptid$='+srcParentId+']');var srcParentTId=srcParentJq.eq(0).attr('id');var srcParentNode=_this.treeObj.getNodeByTId(srcParentTId);var postData={};var arrSrc=[];var arrDst=[];var srcParId=srcNode.pId;var dstParId=dstNode.pId;var saveType=0;if(srcNode.isParent&&!dstNode.isParent){return;}else if(!srcNode.isParent&&!dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){if(srcParId==dstParId){$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});postData[dstParentId]=arrDst;}else{$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});$.each(dstParentNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstParentNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstParId]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstParId]=arrDst;}}}}else if(!srcNode.isParent&&dstNode.isParent){if(_this.treeObj.moveNode(dstNode,srcNode,'inner',true)){if(srcParentNode.children){$.each(srcParentNode.children,function(i,n){arrSrc.push(n.id);});}$.each(dstNode.children,function(i,n){arrDst.push(n.id);});var nSrcIdx=srcParentNode.getIndex();var nDstIdx=dstNode.getIndex();if(nDstIdx<nSrcIdx){postData[dstNode.id]=arrDst;postData[srcParId]=arrSrc;}else{postData[srcParId]=arrSrc;postData[dstNode.id]=arrDst;}}}else if(srcNode.isParent&&dstNode.isParent){saveType=1;var nSrcIdx=srcNode.getIndex();var nDstIdx=dstNode.getIndex();if(_this.treeObj.moveNode(dstNode,srcNode,'next',true)){var liGroup=$('#treeMine').children('li');if(liGroup&&liGroup.length>0){postData.groupIdList=[];$.each(liGroup,function(i,n){postData.groupIdList.push($(n).attr('ptid'));});}}}if(0==saveType){WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).always(function(){});}else if(1==saveType){WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).always(function(){});}_this.stopBubble(e);});if(treeNode.id==sessionStorage.getItem('dsOpenGroupId')){sessionStorage.removeItem('dsOpenGroupId');if(treeNode.isParent&&_this.treeObj){_this.treeObj.expandNode(treeNode,true,false,true);}}if(!treeNode.isParent){if(0==treeNode.type){var prjName=_this.getProjectNameFromId(treeNode.projId,_this.m_langFlag);_this.initToolTips($itemLeaf,treeNode.name,prjName,treeNode.value,treeNode.note);}else if(1==treeNode.type){var showName=_this.getShowNameFromFormula(treeNode.value);_this.initFormulaToolTips($itemLeaf,treeNode.name,showName,treeNode.note);}}}
function addHoverDom(treeId,treeNode){if(treeNode.isParent){var sObj=$("#"+treeNode.tId+"_span");if(treeNode.editNameFlag||$("#addBtn_"+treeNode.tId).length>0){return;}
if(0==$("#addBtnFormula_"+treeNode.tId).length){var addStr="<span class='iconfont' id='addBtnFormula_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:4px'>&#xe63e;</span>";sObj.after(addStr);var btnGroup=$("#addBtnFormula_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_FORMULA);if(btnGroup)btnGroup.bind("click",function(){if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnPage_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-plus-sign button' id='addBtnPage_"+treeNode.tId+"' title='add point' onfocus='this.blur();' style='margin-left:4px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnPage_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT);if(btnGroup)btnGroup.bind("click",function(){var parentNodes=_this.treeObj.getNodesByParam('id',treeNode.id,null);if(parentNodes.length>0){if(!parentNodes[0].zAsync){_this.treeObj.expandNode(parentNodes[0],true,false,true);}}if(_this.m_cfgPanel){$(_this.m_cfgPanel.container).remove();}var addInterface=$('#addPointPanelContain');if(!addInterface||addInterface.length>0){return;}_this.m_selectGroupId=treeNode.id;WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).always(function(e){});return false;});}if(0==$("#addBtnGroup_"+treeNode.tId).length){var addStr="<span class='glyphicon glyphicon-object-align-bottom button' aria-hidden='true' id='addBtnGroup_"+treeNode.tId+"' title='add group' onfocus='this.blur();' style='margin-left:20px;top:2px'></span>";sObj.after(addStr);var btnGroup=$("#addBtnGroup_"+treeNode.tId);if(btnGroup)btnGroup.attr('title',I18n.resource.dataSource.ADD_POINT_GROUP);if(btnGroup)btnGroup.bind("click",function(){var newName='new group';var postData={'groupId':'','name':newName,'parent':treeNode.id.toString(),'userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return;}var groupId=result.groupId;if(groupId){if(_this.treeObj){if(treeNode.zAsync){_this.treeObj.addNodes(treeNode,{id:result.groupId,pId:result.parentId,name:result.groupName,isParent:true});}else{_this.treeObj.expandNode(treeNode,true,false,true);}}}}).always(function(e){});return false;});}}else{_this.setHoverColor(treeNode);}};function removeHoverDom(treeId,treeNode){$("#addBtnGroup_"+treeNode.tId).unbind().remove();$("#addBtnPage_"+treeNode.tId).unbind().remove();$("#addBtnFormula_"+treeNode.tId).unbind().remove();if(!treeNode.isParent){_this.removeHoverColor(treeNode);}};function zTreeBeforeRename(treeId,treeNode,newName,isCancel){_this.zTreeBeforeRenameFunc(treeNode,newName);}function zTreeBeforeRemove(treeId,treeNode){confirm(I18n.resource.dataSource.DELETE_GROUP_INFO,function(){_this.zTreeBeforeRemoveFunc(treeNode);_this.treeObj.removeNode(treeNode);});return false;}function zTreeOnAsyncSuccess(event,treeId,treeNode,msg){Spinner.stop();};function zTreeOnAsyncError(event,treeId,treeNode,XMLHttpRequest,textStatus,errorThrown){Spinner.stop();};$(document).ready(function(){var treeMine=_this.$dsNavContain.find('#treeMine');var arrInit=_this.generateTreeEx(_this.m_parent.store.group);_this.treeObj=$.fn.zTree.init(treeMine,zSetting,arrInit);});},zTreeBeforeRenameFunc:function zTreeBeforeRenameFunc(treeNode,newName){if(treeNode.isParent){var postData={'groupId':treeNode.id,'name':newName,'parent':Boolean(treeNode.pId)?treeNode.pId.toString():'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var treeNodeNote=treeNode.note?treeNode.note:'';newName=treeNodeNote!==''?treeNodeNote+'('+newName+')':newName;var postData={itemList:[{id:treeNode.id,type:0,projId:treeNode.projId,alias:newName,note:treeNode.note,value:treeNode.value,groupId:treeNode.pId}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){return true;}return false;}).error(function(e){return false;}).always(function(e){treeNode.name=newName;$('#treeMine').find('li[ptid='+treeNode.id+']').find('a span').eq(1).text(newName);});}},zTreeBeforeRemoveFunc:function zTreeBeforeRemoveFunc(treeNode){if(treeNode.isParent){WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+treeNode.id).done(function(result){if('successful'!=result.error){return false;}}).always(function(e){return true;});}else{var $itemLeaf=_this.$dsNavContain.find('#'+treeNode.tId);if($itemLeaf&&$itemLeaf.length>0){$itemLeaf.tooltip('destroy');}WebAPI.get('/analysis/datasource/removeSingle/'+treeNode.id).done(function(data){if(!data.success){return false;}else{var parentId=treeNode.pId;var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num-=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}return true;}}).always(function(){});}},generateTreeEx:function generateTreeEx(arr){var result=[];if(!arr){return result;}var params;var unassigned;for(var i=0,len=arr.length;i<len;i++){var item=arr[i];if(item){var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}params={id:item.id,pId:item.parentId,isParent:item.isParent,name:itemName,value:item.value,note:item.note,projId:item.projId,num:item.num,type:item.type};if(!item.isParent){var leafIcon=1==item.type?'ptFormula':'ptNormal';params['iconSkin']=leafIcon;}if('unassigned'==item.alias){unassigned=params;}else{result.push(params);}}}if(unassigned){result.push(unassigned);}return result;},generateSearchTree:function generateSearchTree(arr,searchText){var result=[];var params;for(var id in arr){params={id:id,pId:null,isParent:true,name:arr[id].groupName,value:id,note:'',projId:'',type:0,open:true};result.push(params);if(arr[id].dsList){for(var i=0,len=arr[id].dsList.length;i<len;i++){var item=arr[id].dsList[i];var keyWordName=item.alias;searchText.replace(/[^\w\d\s\u4e00-\u9fa5]/g,' ').split(/\s/g).forEach(function(search_item){if(search_item){keyWordName=keyWordName.replace(new RegExp("("+search_item+")(?![^<]*>|[^<>]*</)","gi"),'<span class="keyword">$1</span>');}});params={id:item.id,pId:id,isParent:false,name:keyWordName,value:item.value,note:item.note,projId:item.projId,type:item.type,iconSkin:1==item.type?'ptFormula':'ptNormal'};result.push(params);}}}return result;},setHoverColor:function setHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','#FFE6B0');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','#000');}$row.find('.edit').css('color','#000');$row.find('.remove').css('color','#000');}},removeHoverColor:function removeHoverColor(treeNode){var $row=$('#'+treeNode.tId);if($row&&$row.length>0){$row.css('background-color','');var $name=$('#'+treeNode.tId+'_span');if($name&&$name.length>0){$name.css('color','');}$row.find('.edit').css('color','');$row.find('.remove').css('color','');}},initDsCloud:function initDsCloud(){var $selPrjName=_this.$dsNavContain.find('#selectPrjName');$selPrjName.empty();var opt;var prjId=AppConfig.project&&AppConfig.project.bindId?AppConfig.project.bindId:AppConfig.projectId;var nSize=AppConfig.projectList.length;var data=AppConfig.projectList.map(function(v,i){if(0==_this.m_langFlag){return{id:v.id,text:v.name_cn};}else{return{id:v.id,text:v.name_english};}});$selPrjName.select2({data:data}).off('change.myChange').on('change.myChange',function(e){var prjId=$('#selectPrjName').find('option:selected').val();_this.initDsCloudTable(prjId,1,50);}).val(prjId).trigger('change');var $inputSearch=_this.$dsNavContain.find('#inputDsCloudSearch');$inputSearch.keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}var size=50;WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:1,pageSize:size,searchText:searchVal}).done(function(result){if(result.success&&result.data){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();_this.setCloudTable(result.data.pointTable);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(1);}}).always(function(e){});}if(''==searchVal){_this.initDsCloudFunc();}});_this.$dsNavContain.find('#spanDsCloudSearch').click(function(e){$inputSearch.val('');_this.initDsCloudFunc();});},initCurPageNum:function initCurPageNum(page){this.m_curPageNum=page;},initDsCloudTable:function initDsCloudTable(prjId,page,size){if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:page,pageSize:size}).done(function(result){if(result.success&&result.data){_this.m_arrCloudTableInfo=result.data.pointTable;_this.setCloudTable(_this.m_arrCloudTableInfo);var ptTotal=result.data.pointTotal;var allPageNum=Math.ceil(ptTotal/size);_this.setCloudNav(allPageNum);_this.initCurPageNum(page);}}).always(function(e){Spinner.stop();});},initDsCloudFunc:function initDsCloudFunc(){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');$tableBody.empty();var prjId=_this.$dsNavContain.find('#selectPrjName').val();_this.initDsCloudTable(prjId,1,50);},setCurrentPage:function setCurrentPage(curPageNum,size){curPageNum=parseInt(curPageNum,10);var prjId=_this.$dsNavContain.find('#selectPrjName').val();if(!prjId){return false;}Spinner.spin(_this.$dsNavContain[8]);WebAPI.post('/point_tool/getCloudPointTable/',{projectId:parseInt(prjId),currentPage:curPageNum,pageSize:size,searchText:_this.$dsNavContain.find('#inputDsCloudSearch').val()}).done(function(result){if(result.success&&result.data){var ptTotal=result.data.pointTotal?result.data.pointTotal:0;var allPageNum=Math.ceil(ptTotal/size);_this.initCurPageNum(curPageNum);var liPageNum=$('#navPageNum').find('.pageNum');if(curPageNum<=3){liPageNum.eq(0).attr('value','1');liPageNum.eq(1).attr('value','2');liPageNum.eq(2).attr('value','3');liPageNum.eq(3).attr('value','4');liPageNum.eq(4).attr('value','5');liPageNum.eq(0).text('1');liPageNum.eq(1).text('2');liPageNum.eq(2).text('3');liPageNum.eq(3).text('4');liPageNum.eq(4).text('5');}else if(curPageNum>=allPageNum-2){liPageNum.eq(0).attr('value',allPageNum-4);liPageNum.eq(1).attr('value',allPageNum-3);liPageNum.eq(2).attr('value',allPageNum-2);liPageNum.eq(3).attr('value',allPageNum-1);liPageNum.eq(4).attr('value',allPageNum);liPageNum.eq(0).text(allPageNum-4);liPageNum.eq(1).text(allPageNum-3);liPageNum.eq(2).text(allPageNum-2);liPageNum.eq(3).text(allPageNum-1);liPageNum.eq(4).text(allPageNum);}else{liPageNum.eq(0).attr('value',curPageNum-2);liPageNum.eq(1).attr('value',curPageNum-1);liPageNum.eq(2).attr('value',curPageNum);liPageNum.eq(3).attr('value',curPageNum+1);liPageNum.eq(4).attr('value',curPageNum+2);liPageNum.eq(0).text(curPageNum-2);liPageNum.eq(1).text(curPageNum-1);liPageNum.eq(2).text(curPageNum);liPageNum.eq(3).text(curPageNum+1);liPageNum.eq(4).text(curPageNum+2);}
for(var i=0,len=liPageNum.length;i<len;i++){var item=liPageNum.eq(i);if(item.attr('value')==curPageNum){item.closest('li').attr('class','active');}else{item.closest('li').removeAttr('class');}}_this.setCloudTable(result.data.pointTable);}}).always(function(e){Spinner.stop();});},setCloudTable:function setCloudTable(ptTable,searchText){var $tableBody=_this.$dsNavContain.find('#tableDsCloud tbody');if($tableBody){$tableBody.empty();for(var i=0,len=ptTable.length;i<len;i++){var $itemTr=$('<tr ptId="'+ptTable[i]._id+'" draggable="true" title="'+ptTable[i].value+' : '+ptTable[i].alias+' "></tr>');var $itemTd=$('<td>');var $itemTdName=$('<span class="tabColName" data-value="'+ptTable[i].value+'">'+ptTable[i].value+'</span>');var $itemTdDesc=$('<span class="tabColDesc"> -- '+ptTable[i].alias+'</span>');var $itemTdIcon=$('<span class="btnFav glyphicon glyphicon-plus-sign" aria-hidden="true"></span>');$itemTdIcon.off().click(function(e){var $row=$(e.currentTarget).closest('tr');var ptId=$row.attr('ptId');for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){if(ptId==_this.m_arrCloudTableInfo[i]._id){_this.insertIntoMineTable(_this.m_arrCloudTableInfo[i]);break;}}});$itemTd.append($itemTdName);$itemTdDesc.append($itemTdIcon);$itemTd.append($itemTdDesc);$itemTr.append($itemTd);var start=null;EventAdapter.on($itemTr,'click',function(e){e=e||event;var $this=$(this);var $tableDsCloud=$('#tableDsCloud');var trArr=$tableDsCloud.find('tr');if(e.ctrlKey){if(!e.shiftKey){if($this.hasClass('activeTr')){$this.removeClass('activeTr');}else{$this.addClass('activeTr');}start=this;}else{var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);if($(start).hasClass('activeTr')){selTr.addClass('activeTr');}else{selTr.removeClass('activeTr');}}}else if(e.shiftKey){if($('.activeTr').length!==0){var startIndex=$(start).index(),lastIndex=$this.index();var selTr=trArr.slice(Math.min(startIndex,lastIndex),Math.max(startIndex,lastIndex)+1);selTr.addClass('activeTr');trArr.not(selTr).removeClass('activeTr');}else{$this.addClass('activeTr');}}else{trArr.removeClass('activeTr');$this.addClass('activeTr');start=this;}});EventAdapter.on($itemTr,'dragstart',function(e){$('.templatePara').css('display','block');var tar=$('.activeTr').length>1?$('.activeTr'):$(e.target);var targetId=$(e.target).attr('ptid');var dragSrcId=undefined,isDragMore=false,dragId=[];if($('.activeTr').length>1){tar.each(function(i,item){var itemId=$(item).attr('ptid');if(itemId===targetId){isDragMore=true;}dragId.push(itemId);});if(isDragMore){dragSrcId=dragId;}else{dragSrcId=targetId;}}else{dragSrcId=tar.attr('ptid');}
EventAdapter.setData({'dsItemId':dragSrcId});e.originalEvent.dataTransfer.setData('dsItemId',dragSrcId);});EventAdapter.on($itemTr,'dragover',function(e){e.preventDefault();});EventAdapter.on($itemTr,'dragend',function(e){$('.templatePara').css('display','none');var $template=$('#anlsPane').find('.anlsTemplate');$template.attr('class','anlsTemplate');});$tableBody.append($itemTr);}}},setCloudNav:function setCloudNav(allPageNum){var ul=$('<ul class="pagination">\
                <li><a class="pageFlag" value="First"><span aria-hidden="true">&laquo;</span></a></li>\
                <li><a class="pageFlag" value="Previous"><span aria-hidden="true">&lsaquo;</span></a></li>\
            </ul>');if(allPageNum>5){ul.append('<li class="active"><a class="pageFlag pageNum" value="1">1</a></li>\
                    <li><a class="pageFlag pageNum" value="2">2</a></li>\
                    <li><a class="pageFlag pageNum" value="3">3</a></li>\
                    <li><a class="pageFlag pageNum" value="4">4</a></li>\
                    <li><a class="pageFlag pageNum" value="5">5</a></li>');}else{for(var i=0;i<allPageNum;i++){var numTmp=i+1;if(0==i){ul.append('<li class="active"><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}else{ul.append('<li><a class="pageFlag pageNum" value="'+numTmp+'">'+numTmp+'</a></li>');}}}ul.append('<li><a class="pageFlag" value="Next"><span aria-hidden="true">&rsaquo;</span></a></li>\
                        <li><a class="pageFlag" value="Last"><span aria-hidden="true">&raquo;</span></a></li>');var pageFlag=ul.find('.pageFlag');pageFlag.click(function(e){var value=$(e.currentTarget).attr('value');if('First'==value){if(_this.m_curPageNum!=1){_this.setCurrentPage(1,50);}}else if('Previous'==value){if(_this.m_curPageNum>1){_this.setCurrentPage(_this.m_curPageNum-1,50);}}else if('Next'==value){if(_this.m_curPageNum<allPageNum){_this.setCurrentPage(_this.m_curPageNum+1,50);}}else if('Last'==value){if(_this.m_curPageNum!=allPageNum){_this.setCurrentPage(allPageNum,50);}}else{if(_this.m_curPageNum!=value){_this.setCurrentPage(value,50);}}});var $navPage=_this.$dsNavContain.find('#navPageNum');$navPage.empty();$navPage.append(ul);},insertIntoMineTable:function insertIntoMineTable(newNode){var nodeParent=_this.treeObj.getNodesByParam('name','unassigned',null);if(nodeParent.length>0){var postData={itemList:[{type:0,projId:newNode.projId,alias:newNode.value,value:newNode.value,groupId:nodeParent[0].id}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.itemIdList.length>0){var item=data.itemIdList[0];var obj={id:item.id,pId:item.groupId,name:item.alias,isParent:false,value:item.value,note:item.note};_this.treeObj.addNodes(nodeParent[0],-1,obj);}}).always(function(e){});}},initElement:function initElement(){var _this=this;var len=AppConfig.projectList.length;var item;if(!(_this.m_parent.arrColor instanceof Array))return;var nColorSize=_this.m_parent.arrColor.length;for(var i=0;i<len;i++){item=AppConfig.projectList[i];_this.m_arrProjIdColorMap[item.id]=_this.m_parent.arrColor[i-parseInt(i/nColorSize)*nColorSize];}EventAdapter.on($('#data_source_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#data_source_formula_add'),'click',function(e){if(0==_this.m_selectGroupId){alert(_this.m_lang.NO_SELECT_GROUP);return;}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});EventAdapter.on($('#divAnlsDatasourcePane'),'click',function(e){_this.clearSelect();},false);$('#inputDsSearch').keyup(function(e){var searchVal=$(e.currentTarget).val();if(13==e.keyCode){$('#dataSrcPanel').empty();searchVal=searchVal.toLowerCase();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,searchVal);$('#dataSrcAddGroup').hide();}if(''==searchVal){$('#dataSrcPanel').empty();_this.insertTreeAllGroupItem(_this.m_allGroupList,_this.m_allPointList,'');_this.colapseGroupsDefault();$('#dataSrcAddGroup').show();}});},insertIntoDataList:function insertIntoDataList(customName,ptName,ptDesc,prjName,iconColor,itemId,baseNode,bIsAppend,bIsSelected){var _this=this;var div;if(bIsSelected){div=$('<div draggable="true" class="dsItem grow dsSelected" style="height:34px"></div>');}else{div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');}div.attr('id',itemId);div.click(function(e){_this.clearSelect();var target=$(e.currentTarget);if('dsItem grow'==target.attr('class')){target.attr('class','dsItem grow dsSelected');}else{target.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var custName=$('<div class="dsValue" style="height:36px;">'+customName+'</div>');div.append(custName);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}_this.m_selectItemId=$(e.currentTarget).closest('.dsItem').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM_TIPS,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=data.deleteModal;var len=arr.length;if(len>0){var delMod;var arrDelTitle=[];for(var i=0;i<len;i++){delMod=$('#'+arr[i]);arrDelTitle.push(delMod.find('.newDivPageTitle').val());delMod.remove();}var delTitle=_this.m_lang.WORKSPACE+':';for(var i=0,len=arrDelTitle.length;i<len;i++){delTitle+=arrDelTitle[i]+' ';}delTitle+=_this.m_lang.REMOVE_RESULT;alert(delTitle);}}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var ctlPrjName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.PROJECT_NAME+': '+prjName+'</label></div>');ctlPrjName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPrjName);var ctlPtName=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.POINT_NAME+': '+ptName+'</label></div>');ctlPtName.click(function(e){_this.stopBubble(e);});divChange.append(ctlPtName);var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',ptDesc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:0,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);if(bIsAppend){baseNode.append(div);}else{baseNode.after(div);}},initToolTips:function initToolTips(parent,customName,projectName,pointName,pointDesc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:300px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="projectName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.PROJECT_NAME).append('</span>: ').append(projectName).append('</p> ');show.append('        <p class="pointName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_NAME).append('</span>: ').append(pointName).append('</p> ');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(pointDesc).append('</p> ');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var options={placement:'left',title:_this.m_lang.PARAM,template:show.toString(),trigger:'hover'};parent.tooltip(options);},setToolTipsAll:function setToolTipsAll(row,userName,customName,projectName,pointName,pointDesc){var tip=row.data('bs.tooltip').$tip;userName=': '+userName;customName=': '+customName;projectName=': '+projectName;pointName=': '+pointName;pointDesc=': '+pointDesc;tip.find('.userName').text(this.m_lang.USER_NAME+userName);tip.find('.customName').text(this.m_lang.CUSTOM_NAME+customName);tip.find('.projectName').text(this.m_lang.PROJECT_NAME+projectName);tip.find('.pointName').text(this.m_lang.POINT_NAME+pointName);tip.find('.pointDesc').text(this.m_lang.POINT_DESC+pointDesc);},setToolTipsCustomName:function setToolTipsCustomName(row,customName){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').text(this.m_lang.CUSTOM_NAME+': '+customName);},setToolTipsDesc:function setToolTipsDesc(row,ptDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.pointDesc').text(this.m_lang.POINT_DESC+': '+ptDesc);},renderTabel:function renderTabel(){var _this=this;var len=_this.m_newPointList.length;if(len<=0){return;}var div=$('#dataSrcPanel');var rowBaseNum=div.find('.dsItem').length;var rowCount;var item;var eachItem;var postData;len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};var arrOld=[];var bIsExist=false;var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){arrOld=parentNodes[0].children;}for(var i=0;i<len;i++){item=_this.m_newPointList[i];eachItem={type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};var bFlag=false;for(var j=0;j<arrOld.length;j++){if(item.prjId==arrOld[j].projId&&item.ptName==arrOld[j].value){bIsExist=true;bFlag=true;break;}}if(!bFlag){postData.itemList.push(eachItem);}}if(bIsExist){alert(I18n.resource.dataSource.ALREADY_EXIST);}var projName=_this.m_newPointList[0].prjName;var iconColor=_this.m_newPointList[0].iconColor;if(postData.itemList.length>0){WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}var list=data.itemIdList;var nAddlen=postData.itemList.length;for(var i=0;i<nAddlen;i++){if(postData.itemList[i].alias==list[i].alias){postData.itemList[i].itemId=list[i].id;}}
if(_this.treeObj){var parentId=_this.m_newPointList[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<postData.itemList.length;i++){var item=postData.itemList[i];var itemNode=item.note?item.note:'';var itemAlias=item.alias?item.alias:'';var itemName=itemAlias;if(itemNode!==''&&itemAlias!==''){if(itemAlias.indexOf(itemNode)<0){itemName=itemNode+' ('+itemAlias+')';}}arrNodes.push({id:item.itemId,pId:item.groupId,isParent:false,name:itemName,value:item.value,projId:item.projId,note:item.note,type:0,iconSkin:'ptNormal'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=nAddlen;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}
_this.m_allPointList=_this.m_allPointList.concat(_this.m_newPointList);_this.calUpdateDataSources();}).error(function(){}).always(function(){});}}},modifyTable:function modifyTable(){var _this=this;var item;var eachItem;var postData;var len=_this.m_newPointList.length;if(len>0){postData={itemList:[]};item=_this.m_newPointList[0];eachItem={id:item.itemId,type:0,projId:item.prjId,alias:item.customName,note:item.ptDesc,value:item.ptName,groupId:item.groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.datasourceId){_this.m_dataSourceId=data.datasourceId;}for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(item.itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].prjId=item.prjId;_this.m_allPointList[i].prjName=_this.m_newPointList[0].prjName;_this.m_allPointList[i].customName=item.customName;_this.m_allPointList[i].ptName=item.ptName;_this.m_allPointList[i].ptDesc=item.ptDesc;break;}}
var divItem=$('#'+item.itemId);divItem.find('.showName').text(item.customName);_this.setToolTipsAll(divItem,item.userName,item.customName,item.prjName,item.ptName,item.ptDesc);_this.calUpdateDataSources();Beop.cache.ds.remove(item.itemId);}).error(function(){}).always(function(){});}},initDrag:function initDrag(){var _this=this;_this.dragOperateSrc($('#dataSrcPanel').get(0));_this.dragOperateCfg($('.springConfigMask').parent().get(0));},dragOperateSrc:function dragOperateSrc(tableList){if(undefined==tableList){return;}var _this=this;EventAdapter.on($(tableList),'dragstart',function(e){var tar=$(e.target);var className=tar.attr('class');if(!className){e.preventDefault();return;}if(tar.children('input').length>0){e.preventDefault();}if(-1!=className.indexOf('nav nav-list tree-group')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsGroupId':dragSrcId});}else if(-1!=className.indexOf('treeRow ui-draggable')){var dragSrcId=tar.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});}else{return;}$('.templatePara').css('display','block');});EventAdapter.on($(tableList),'dragover',function(e){e.preventDefault();});EventAdapter.on($(tableList),'drop',function(e){var tarItem=$(e.target);var tarId=0;var dstGroupId=0;var srcGroupId=0;var rowClass=tarItem.attr('class');if(!rowClass){return;}var dragType=-1;var draggedID=0;if(-1!=rowClass.indexOf('nav nav-list tree-group')||-1!=rowClass.indexOf('dsTreeHeader')){tarId=tarItem.closest('.nav').attr('id');draggedID=EventAdapter.getData().dsGroupId;if(Boolean(draggedID)){dragType=0;}else{draggedID=EventAdapter.getData().dsItemId;if(Boolean(draggedID)){dragType=2;tarId=tarItem.closest('.nav').attr('id');dstGroupId=tarId;srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}}}else if(-1!=rowClass.indexOf('showName')||-1!=rowClass.indexOf('treeRow ui-draggable')){dragType=1;draggedID=EventAdapter.getData().dsItemId;tarId=tarItem.closest('.treeRow').attr('id');dstGroupId=tarItem.closest('.nav').attr('id');srcGroupId=$('#'+draggedID).closest('.nav').attr('id');}else{return;}if(draggedID==tarId||!draggedID){return;}if(0===dragType){var item,groupName;for(var i=0,len=_this.m_allGroupList.length;i<len;i++){item=_this.m_allGroupList[i];if(draggedID==item.id){groupName=item.name;break;}}$('#'+draggedID).remove();_this.insertTreeGroup(draggedID,groupName,1,$('#'+tarId));for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(draggedID==item.groupId){if(item.itemType==0){_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',true);}else{_this.insertTreeItem($('#'+draggedID),item.itemId,item.iconColor,item.customName,0,'',false);}var prjName=_this.getProjectNameFromId(item.prjId,_this.m_langFlag);_this.initToolTips($('#'+item.itemId),item.customName,prjName,item.ptName,item.ptDesc);}}var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+tarId).find('.rows').find('.treeRow');srcGroup=$('#'+draggedID).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var postData={};postData[tarId]=arrDst;postData[draggedID]=arrSrc;WebAPI.post('/datasource/saveDataSourceGroupLayout/'+AppConfig.userId,postData).done(function(data){if('successful'==data.error){}}).error(function(){}).always(function(){});}else if(1===dragType||2===dragType){var itemType=0;var iconColor='';var custName='';var projId=0;var pointName='';var pointDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(draggedID==_this.m_allPointList[i].itemId){_this.m_allPointList[i].groupId=dstGroupId;itemType=_this.m_allPointList[i].itemType;iconColor=_this.m_allPointList[i].iconColor;custName=_this.m_allPointList[i].customName;projId=_this.m_allPointList[i].prjId;pointName=_this.m_allPointList[i].ptName;pointDesc=_this.m_allPointList[i].ptDesc;break;}}var selItem=$('#'+draggedID);selItem.tooltip('destroy');selItem.remove();if(itemType==0){_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),true);}else{_this.insertTreeItem($('#'+dstGroupId),draggedID,iconColor,custName,dragType,$('#'+tarId),false);}if(0==itemType){var prjName=_this.getProjectNameFromId(projId,_this.m_langFlag);_this.initToolTips($('#'+draggedID),custName,prjName,showName,pointDesc);}else if(1==itemType){var showName=_this.getShowNameFromFormula(pointName);_this.initFormulaToolTips($('#'+draggedID),custName,showName,pointDesc);}else{return;}var postData={};if(dstGroupId==srcGroupId){var srcGroup,arrSrc=[];srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(srcGroup,function(i,n){arrSrc.push(n.id);});postData[srcGroupId]=arrSrc;}else{var dstGroup,srcGroup;var arrDst=[],arrSrc=[];dstGroup=$('#'+dstGroupId).find('.rows').find('.treeRow');srcGroup=$('#'+srcGroupId).find('.rows').find('.treeRow');$.each(dstGroup,function(i,n){arrDst.push(n.id);});$.each(srcGroup,function(i,n){arrSrc.push(n.id);});var dstGroupCnt=0,srcGroupCnt=0;var groups=$('#dataSrcPanel .nav');$.each(groups,function(i,n){if(n.id==dstGroupId){dstGroupCnt=i;}if(n.id==srcGroupId){srcGroupCnt=i;}});if(dstGroupCnt<srcGroupCnt){postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}else{postData[dstGroupId]=arrDst;postData[srcGroupId]=arrSrc;}}WebAPI.post('/analysis/datasource/saveLayout/'+AppConfig.userId,postData).done(function(data){if(data.success){}}).error(function(){}).always(function(){});}});},dragOperateCfg:function dragOperateCfg(divItem){if(undefined==divItem){return;}var _this=this;EventAdapter.on($(divItem),'dragstart',function(e){var target=$(e.target);var className=target.attr('class');if('dsItem grow'!=className&&'dsItem grow dsSelected'!=className){return;}var dragSrcId=target.attr('id');EventAdapter.setData({'dsItemId':dragSrcId});});EventAdapter.on($(divItem),'dragover',function(e){e.preventDefault();});EventAdapter.on($(divItem),'drop',function(e){var target=$(e.target);});},saveCurrentRecords:function saveCurrentRecords(){var _this=this;Spinner.spin(ElScreenContainer);WebAPI.post('/delete_data_source_records_by_userid',{userId:AppConfig.userId}).done(function(result){if(result!=0){Spinner.stop();return;}
var newPtList=[];var id;var len=_this.m_allPointList.length;var newRow;var item;$('#dataSrcPanel .dsItem').each(function(){id=$(this).attr('id');for(var i=0;i<len;i++){item=_this.m_allPointList[i];if(id==item.itemId){var _newRow;newRow=(_newRow={'itemId':id,'userId':item.userId,'userName':item.userName,'customName':item.customName,'prjId':item.prjId,'prjName':item.prjName,'ptName':item.ptName,'ptDesc':item.ptDesc,'iconColor':item.iconColor},_newRow['itemId']=item.itemId,_newRow);newPtList.push(newRow);break;}}});_this.m_allPointList=newPtList;var row;var data=[];var len=_this.m_allPointList.length;for(var i=0;i<len;i++){item=_this.m_allPointList[i];row={'userId':item.userId,'customName':item.customName,'projectId':item.prjId,'pointName':item.ptName,'pointDesc':item.ptDesc,'iconColor':item.iconColor};data.push(row);}WebAPI.post('/save_data_source_record',{sourceList:data}).done(function(result){if(0==result){}}).error(function(result){alert(I18n.resource.observer.widgets.DATABASE_OPERATION_FAILED+'');return;});}).error(function(result){alert(I18n.resource.observer.widgets.FAIL_BEFORE_EXECUTING+'');return;}).always(function(){Spinner.stop();});},loadDataSourceRecord:function loadDataSourceRecord(){var _this=this;var groupInfo=_this.m_parent.store.group;if(!groupInfo){return;}_this.m_allGroupList=[];_this.m_allPointList=[];var itemDefault=null;for(var m=0,n=groupInfo.length;m<n;m++){var groupId=groupInfo[m].groupId;var groupName=groupInfo[m].groupName;var groupIsDefault=Boolean(groupInfo[m].isDefault)?true:false;var data=groupInfo[m].datasourceList;var groupItem={'id':groupId,'name':groupName,'isDefault':groupIsDefault};if(groupIsDefault){itemDefault=groupItem;}else{_this.m_allGroupList.push(groupItem);}if(data){var len=data.length;var item;for(var i=0;i<len;i++){item={userId:AppConfig.userId,userName:AppConfig.account,customName:data[i].alias,prjId:data[i].projId,prjName:_this.getProjectNameFromId(data[i].projId),ptName:data[i].value,ptDesc:data[i].note,iconColor:_this.m_arrProjIdColorMap[data[i].projId],itemId:data[i].id,itemType:data[i].type,itemValue:data[i].value,groupId:groupId,groupName:groupName};if(item.itemType==1){item.iconColor='#000000';}_this.m_allPointList.push(item);}}}if(itemDefault){_this.m_allGroupList.push(itemDefault);}},colapseGroupsDefault:function colapseGroupsDefault(){var treeAllHead=$('.dsTreeHeader .dsGroupName');var item,row;for(var i=0,len=treeAllHead.length;i<len;i++){item=treeAllHead.eq(i);row=item.closest('.tree-group').find('.rows');if(!row||row.length<=0){continue;}if(item.text()==this.m_unassigned){row.css('display','block');}else{row.css('display','none');}}},colapseGroups:function colapseGroups(openGroupId){if(!openGroupId){return;}var treeAllRow=$('#dataSrcPanel .tree-group');var item,row;for(var i=0,len=treeAllRow.length;i<len;i++){item=treeAllRow.eq(i);row=item.find('.rows');if(!row||row.length<=0){continue;}if(item.attr('id')==openGroupId){row.css('display','block');}else{row.css('display','none');}}sessionStorage.removeItem('dsOpenGroupId');},getProjectNameFromId:function getProjectNameFromId(id,langFlag){var name;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(id==item.id){if(0==langFlag){name=item.name_cn;}else{name=item.name_en;}break;}}return name;},getProjectIdFromName:function getProjectIdFromName(projectName){var id;var len=AppConfig.projectList.length;var item;for(var i=0;i<len;i++){item=AppConfig.projectList[i];if(projectName==item.name_cn){id=item.id;break;}}return id;},calUpdateDataSources:function calUpdateDataSources(){return;var _this=this;var updateData=[];for(var i=0,len=_this.m_allGroupList.length;i<len;i++){var groupItem={'groupId':_this.m_allGroupList[i].id,'groupName':_this.m_allGroupList[i].name,'parentId':'','datasourceList':''};var dsList=[];for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){var curItem=_this.m_allPointList[j];if(groupItem.groupId==curItem.groupId){var pushItem={'id':curItem.itemId,'type':curItem.itemType,'projId':curItem.prjId,'alias':curItem.customName,'note':curItem.ptDesc,'value':curItem.ptName,'groupId':curItem.groupId};dsList.push(pushItem);}}groupItem.datasourceList=dsList;updateData.push(groupItem);}this.m_parent.updateDataSources(updateData);},renderFormula:function renderFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var prjId=0;var eachItem={type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var item;var arrNewFormula=[];for(var i=0,len=list.length;i<len;i++){item={'itemId':list[i].id,'itemType':1,'customName':list[i].alias,'itemValue':list[i].value,'ptName':list[i].value,'prjId':prjId,'iconColor':'#000000','ptDesc':_formulaDesc,'groupId':list[i].groupId};arrNewFormula.push(item);}
if(_this.treeObj){var parentId=arrNewFormula[0].groupId;var parentNodes=_this.treeObj.getNodesByParam('id',parentId,null);if(parentNodes.length>0){if(parentNodes[0].zAsync){var arrNodes=[];for(var i=0;i<len;i++){arrNodes.push({id:arrNewFormula[i].itemId,pId:arrNewFormula[i].groupId,isParent:false,name:arrNewFormula[i].customName,value:arrNewFormula[i].itemValue,projId:arrNewFormula[i].prjId,note:arrNewFormula[i].ptDesc,type:1,iconSkin:'ptFormula'});}_this.treeObj.addNodes(parentNodes[0],arrNodes);}else{_this.treeObj.expandNode(parentNodes[0],true,false,true);}
var arrGroup=_this.m_parent.store.group;for(var i=0;i<arrGroup.length;i++){if(arrGroup[i].id==parentId){arrGroup[i].num+=1;var $nodeParent=$("li[ptid='"+parentId+"']");if($nodeParent&&$nodeParent.length>0){var $spanBadge=$nodeParent.find('.treeBadge');if($spanBadge&&$spanBadge.length>0){$spanBadge.text(arrGroup[i].num.toString());}}break;}}}}_this.calUpdateDataSources();});},modifyFormula:function modifyFormula(_customName,_formulaVal,_formulaDesc){var _this=this;var postData={itemList:[]};var itemId=_this.m_selectItemId;var prjId=Number(AppConfig.projectId);var eachItem={id:itemId,type:1,projId:prjId,alias:_customName,note:_formulaDesc,value:_formulaVal,groupId:_this.m_selectGroupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;if(list.length>0){var showName=list[0].value;var arr=showName.split('<%');var arrId=[];var arrItem=[];for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''!=id){arrId.push(id);}}arrItem=_this.getDSItemById(arrId);for(var j=0,len2=arr.length;j<len2;j++){var id=arr[j].split('%>')[0];if(''==id){continue;}for(var m=0;m<arrItem.length;m++){if(id==arrItem[m].id){var retVal=arrItem[m];if(null==retVal){continue;}showName=showName.replace(id,retVal.value);break;}}}showName=showName.replace(/<%/g,'');showName=showName.replace(/%>/g,'');for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(itemId===_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=list[0].alias;_this.m_allPointList[i].ptName=list[0].value;_this.m_allPointList[i].ptDesc=list[0].note;break;}}var divFormula=$('#'+itemId);divFormula.find('.showName').text(list[0].alias);_this.setFormulaToolTipsAll(divFormula,list[0].alias,showName,list[0].note);_this.calUpdateDataSources();Beop.cache.ds.remove(itemId);}});},insertFormula:function insertFormula(itemId,customName,iconColor,formula,desc){var _this=this;var div=$('<div draggable="true" class="dsItem grow" style="height:34px"></div>');div.attr('id',itemId);div.click(function(e){_this.clearSelect();var tar=$(e.currentTarget);if('dsItem grow'==tar.attr('class')){tar.attr('class','dsItem grow dsSelected');}else{tar.attr('class','dsItem grow');}_this.stopBubble(e);});var icon=$('<div class="dsMark"></div>');icon.css('background-color',iconColor);div.append(icon);var name=$('<div class="dsValue" style="height:36px"></div>');name.text(customName);div.append(name);var btnRename=$('<span class="dsBtnRename grow glyphicon glyphicon-wrench"></span>');btnRename.click(function(e){var show=$(e.currentTarget).prevAll('.dsValue');show.css('display','none');var target=$(e.currentTarget).nextAll('.dsDivChange');target.attr('class','dsDivChange show');div.css('height','240px');div.css('width','100%');var item;var strName='';var strFormula='';var strDesc='';for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){strName=item.customName;strFormula=item.ptName;strDesc=item.ptDesc;break;}}var temp=target.find('input');if(temp.length==2){$(temp[0]).val(strName);$(temp[1]).val(strDesc);}_this.stopBubble(e);}).error(function(e){});div.append(btnRename);var btnRemove=$('<span class="dsBtnRemove grow glyphicon glyphicon-remove-sign"></span>');btnRemove.click(function(e){confirm(_this.m_lang.REMOVE_CONFIRM,function(){var div=$(e.currentTarget).closest('.dsItem');var dataSrcItemId=div.attr('id');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();}});});});div.append(btnRemove);var divChange=$('<div class="dsDivChange"></div>');var inputCustName=$('<div class="form-group"><label style="color:#eee">Custom Name</label><input type="text" class="form-control" value="" placeholder="Custom Name"></input></div>');inputCustName.find('label').text(_this.m_lang.CUSTOM_NAME);var ctlInput=inputCustName.find('input');ctlInput.attr('value',customName);ctlInput.attr('placeholder',_this.m_lang.CUSTOM_NAME);inputCustName.click(function(e){_this.stopBubble(e);});divChange.append(inputCustName);var ctlFormula=$('<div class="form-group"><label style="color:#eee">'+_this.m_lang.FORMULA_NAME+': </label></div>');var showFormula=$('<span>'+formula+'</span>');showFormula.appendTo(ctlFormula.find('label')).mathquill();ctlFormula.click(function(e){_this.stopBubble(e);});divChange.append(ctlFormula);var inputDesc=$('<div class="form-group"><label style="color:#eee">Description</label><input type="text" class="form-control" value="" placeholder="Description"></input></div>');inputDesc.find('label').text(_this.m_lang.POINT_DESC);ctlInput=inputDesc.find('input');ctlInput.attr('value',desc);ctlInput.attr('placeholder',_this.m_lang.POINT_DESC);inputDesc.click(function(e){_this.stopBubble(e);});divChange.append(inputDesc);var btnOk=$('<button class="btn btn-default btn-sm" style="position:absolute; right:70px;">OK</button>');btnOk.text(_this.m_lang.SURE);btnOk.click(function(e){var temp=$(e.currentTarget).closest('.dsDivChange').find('input');var strName=$(temp[0]).val();var strDesc=$(temp[1]).val();var prjId,ptName,item;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){prjId=item.prjId;ptName=item.ptName;break;}}var postData={itemList:[{id:itemId,type:1,projId:prjId,alias:strName,note:strDesc,value:ptName,groupId:''}]};WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(0==data.itemIdList.length){return;}var id=data.itemIdList[0].id;for(var i=0,len=_this.m_allPointList.length;i<len;i++){if(id==_this.m_allPointList[i].itemId){_this.m_allPointList[i].customName=strName;_this.m_allPointList[i].ptDesc=strDesc;break;}}_this.setToolTipsCustomName(div,strName);_this.setToolTipsDesc(div,strDesc);_this.calUpdateDataSources();$('#'+id).find('.dsValue').text(strName);}).error(function(e){});});divChange.append(btnOk);var btnCancel=$('<button class="btn btn-default btn-sm" style="position:absolute; right:15px;">Cancel</button>');btnCancel.text(_this.m_lang.CANCEL);btnCancel.click(function(e){});divChange.append(btnCancel);div.append(divChange);$('#dataSrcPanel').append(div);},initFormulaToolTips:function initFormulaToolTips(parent,customName,formula,desc){var _this=this;var show=new StringBuilder();show.append('<div class="tooltip" role="tooltip" style="z-index:10;position:fixed;max-width:400px;">');show.append('    <div class="tooltipTitle tooltip-inner">GeneralRegressor</div>');show.append('    <div class="tooltipContent">');show.append('        <p class="customName tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.CUSTOM_NAME).append('</span>: ').append(customName).append('</p>');show.append('        <p class="formula tipStyle" style="word-break:normal;"><span class="tipTitleStyle">').append(_this.m_lang.FORMULA_NAME).append('</span>: ').append('</p>');show.append('        <p class="pointDesc tipStyle"><span class="tipTitleStyle">').append(_this.m_lang.POINT_DESC).append('</span>: ').append(desc).append('</p>');show.append('    </div>');show.append('    <div class="tooltip-arrow"></div>');show.append('</div>');var showFormula=$('<span>'+formula+'</span>');var showObj=$(show.toString());showFormula.appendTo(showObj.find('.formula')).mathquill();var options={placement:'left',title:_this.m_lang.PARAM,template:showObj};parent.tooltip(options);},setFormulaToolTipsAll:function setFormulaToolTipsAll(row,customName,formulaVal,formulaDesc){var tip=row.data('bs.tooltip').$tip;tip.find('.customName').html('<span style="font-weight:bold">'+this.m_lang.CUSTOM_NAME+'</span>: '+customName);tip.find('.pointDesc').html('<span style="font-weight:bold">'+this.m_lang.POINT_DESC+'</span>: '+formulaDesc);var showFormula=$('<span>'+formulaVal+'</span>');var dst=tip.find('.formula').html('<span style="font-weight:bold">'+this.m_lang.FORMULA_NAME+'</span>: ');showFormula.appendTo(dst).mathquill();},checkRepeatWithCustomName:function checkRepeatWithCustomName(_name){var _this=this;var bRet=false;var grids=$('#dataSrcPanel .dsItem .dsValue');$.each(grids,function(i,n){if(_name==$(n).text()){bRet=true;return false;}});return bRet;},stopBubble:function stopBubble(e){if(e&&e.stopPropagation){e.stopPropagation();}else{window.event.cancelBubble=true;}},clearSelect:function clearSelect(e){var itemList=$('#dataSrcPanel .dsItem');itemList.attr('class','dsItem grow');itemList.css('height','34px');itemList.css('width','33%');var panel=$('#dataSrcPanel');panel.find('.dsDivChange').attr('class','dsDivChange');panel.find('.dsValue').css('display','inline');},insertTreeGroup:function insertTreeGroup(groupId,groupName,type,baseGroup){var _this=this;var divContain=$('#dataSrcPanel');var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true">');var $liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});}).error(function(e){});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add"></span>');EventAdapter.on(btnAddDs,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add" /></span>');EventAdapter.on(btnAddFormula,'click',function(e){var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true"></span>');EventAdapter.on(spanEdit,'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on(inputEdit,'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-default btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on(btnEdit,'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}spanName.text(data.groupName);}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($liHd,'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');var imgPath=icon.attr('src');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').css('font-weight','400');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').css('font-weight','700');curTarHead.find('.dsTreeBtnFormula').css('display','inline');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');$ul.append(divLiRow);if(0===type){divContain.append($ul);}else if(1===type){if(''!=baseGroup){baseGroup.after($ul);}}else if(2===type){if(''!=baseGroup){baseGroup.before($ul);}}},insertTreeItem:function insertTreeItem(divParentGroup,itemId,iconColor,itemName,insertType,baseItem,bIsPoint){var _this=this;var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on(divShowName,'click',function(e){var oldCustName=$(e.currentTarget).text();var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px">');input.blur(function(e){var newCustName=$(e.currentTarget).val();if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:itemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divShowName.text(dstCustomName);_this.setToolTipsCustomName(divShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divShowName.after(input);divShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on(btnRemove,'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}
promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){});});}).error(function(e){});div.append(btnRemove);if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on(btnCfg,'click',function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});}).error(function(e){});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on(div,'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});if(0===insertType){divParentGroup.find('.rows').append(div);}else if(1===insertType){if(''!=baseItem){baseItem.after(div);}}else if(2===insertType){var lyRow=divParentGroup.find('.rows').find('.treeRow');if(0==lyRow.length){divParentGroup.find('.rows').append(div);}else{lyRow.eq(0).before(div);}}},insertTreeAllGroupItem:function insertTreeAllGroupItem(groupList,pointList,searchPointName){var _this=this;var divContain=$('#dataSrcPanel');var groupId,groupName,bIsDefault;for(var i=0,len=groupList.length;i<len;i++){groupId=groupList[i].id;groupName=groupList[i].name;bIsDefault=groupList[i].isDefault;var $ul=$('<ul class="nav nav-list tree-group" id="'+groupId+'" draggable="true" dropable="true" isDefault="'+bIsDefault+'">');var $liHd;if(groupName==this.m_unassigned){$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon open"></span></li>');}else{$liHd=$('<li class="dsTreeHeader"><span class="dsTreeHeaderIcon"></span></li>');}var spanName=$('<span class="dsGroupName">'+groupName+'</span>');$liHd.append(spanName);if(groupName!=_this.m_unassigned){var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnDel" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(btnRemove),'click',function(e){var div=$(e.currentTarget).closest('.nav');WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(_this.m_lang.REMOVE_CONFIRM);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}var groupId=div.attr('id');div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/datasource/deleteDataSourceGroup/'+AppConfig.userId+'/'+groupId).done(function(data){if('successful'==data.error){var len=_this.m_allGroupList.length;for(var i=0;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList.splice(i,1);div.remove();break;}}_this.calUpdateDataSources();}}).fail(function(e){});});res.modal('show');}).always(function(e){});});$liHd.append(btnRemove);}var btnAddDs=$('<span class="glyphicon glyphicon-plus-sign panel-heading-btn grow dsTreeBtnAdd" aria-hidden="true" id="data_source_add" style="display:none"></span>');if(groupName==this.m_unassigned){btnAddDs.css('display','inline');}EventAdapter.on($(btnAddDs),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});$liHd.append(btnAddDs);var btnAddFormula=$('<span><img src="/static/images/dataSource/formula_add_normal.png" alt="Formula add" class="dsTreeBtnFormula" id="data_source_formula_add"  style="display:none"/></span>');if(groupName==this.m_unassigned){btnAddFormula.children('img').css('display','inline');}EventAdapter.on($(btnAddFormula),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}var tar=$(e.currentTarget);_this.m_selectGroupId=tar.closest('.tree-group').get(0).id;_this.stopBubble(e);if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,true,'','','',-1);_this.m_cfgPanel.show();}).error(function(result){}).always(function(e){});});btnAddFormula.mouseenter(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_hover.png');img.css('width','23px');img.css('height','20px');}).error(function(e){});btnAddFormula.mouseleave(function(e){var img=btnAddFormula.find('img');img.attr('src','/static/images/dataSource/formula_add_normal.png');img.css('width','21px');img.css('height','19px');}).error(function(e){});$liHd.append(btnAddFormula);if(groupName!=_this.m_unassigned){var spanEdit=$('<span class="glyphicon glyphicon-pencil panel-heading-btn grow dsEditGroupName" aria-hidden="true" style="display:none"></span>');EventAdapter.on($(spanEdit),'click',function(e){var tar=$(e.currentTarget);var groupName=tar.siblings('.dsGroupName');groupName.hide();var input=tar.siblings('.inputEditGroup');input.val(groupName.text());input.show();input.select();tar.siblings('.btn').show();_this.stopBubble(e);});$liHd.append(spanEdit);var inputEdit=$('<input type="text" value="'+groupName+'" class="inputEditGroup">');inputEdit.hide();EventAdapter.on($(inputEdit),'click',function(e){_this.stopBubble(e);});inputEdit.keyup(function(e){if(13==e.keyCode){var tar=$(e.currentTarget);tar.siblings('button').click();}_this.stopBubble(e);});$liHd.append(inputEdit);var btnEdit=$('<button class="btn btn-primary btn-sm" type="submit">Change</button>');btnEdit.hide();EventAdapter.on($(btnEdit),'click',function(e){var tar=$(e.currentTarget);tar.hide();var input=tar.siblings('.inputEditGroup');var newName=input.val();input.hide();var groupName=tar.siblings('.dsGroupName');var oldName=groupName.text();groupName.show();if(oldName!=newName&&''!=newName){var ulNav=tar.closest('.nav');var groupId=ulNav.attr('id');var postData={'groupId':groupId,'name':newName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if(undefined==data){return;}if('successful'==data.error){for(var i=0,len=_this.m_allGroupList.length;i<len;i++){if(groupId==_this.m_allGroupList[i].id){_this.m_allGroupList[i].name=data.groupName;break;}}var spanName=ulNav.find('.dsGroupName');if(Boolean(spanName)){spanName.text(data.groupName);}}}).fail(function(e){});}_this.stopBubble(e);});$liHd.append(btnEdit);}EventAdapter.on($($liHd),'click',function(e){divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');divContain.find('.dsEditGroupName').css('display','none');var curTarHead=$(e.currentTarget);curTarHead.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarHead.closest('.tree-group').get(0).id;$(this).next('.rows').slideToggle();var icon=$(this).find('.dsTreeHeaderIcon');if(icon.hasClass('open')){icon.removeClass('open');curTarHead.find('.dsGroupName').removeClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','none');curTarHead.find('.dsTreeBtnAdd').css('display','none');curTarHead.find('.dsTreeBtnDel').css('display','none');curTarHead.find('.dsEditGroupName').css('display','none');}else{icon.addClass('open');curTarHead.find('.dsGroupName').addClass('selected');curTarHead.find('.dsTreeBtnFormula').css('display','inline-block');curTarHead.find('.dsTreeBtnAdd').css('display','inline');curTarHead.find('.dsTreeBtnDel').css('display','inline');curTarHead.find('.dsEditGroupName').css('display','inline');}});$ul.prepend($liHd);var divLiRow=$('<li class="rows"></li>');if(groupName==_this.m_unassigned){divLiRow.css('display','block');}else{divLiRow.css('display','none');}$ul.append(divLiRow);var itemId,iconColor,itemName,itemPtName;var bHasSearched=false;for(var j=0,len2=pointList.length;j<len2;j++){if(groupId==pointList[j].groupId){itemId=pointList[j].itemId;iconColor=pointList[j].iconColor;itemName=pointList[j].customName;itemPtName=pointList[j].ptName;if(''!=searchPointName){var custNameLower=itemName.toLowerCase();var ptNameLower=itemPtName.toLowerCase();if(-1==custNameLower.indexOf(searchPointName)&&-1==ptNameLower.indexOf(searchPointName)){continue;}else{bHasSearched=true;}}var div=$('<div class="treeRow ui-draggable" id="'+itemId+'" draggable="true" dropable="true"> ');var icon=$('<div class="dsMark" style="margin-top: -1px"></div>');icon.css('background-color',iconColor);div.append(icon);var divShowName=$('<span class="showName">'+itemName+'</span>');EventAdapter.on($(divShowName),'click',function(e){var divCurShowName=$(e.currentTarget);var oldCustName=divCurShowName.text();var selItemId=divCurShowName.closest('.treeRow').attr('id');var input=$('<input type="text" value="'+oldCustName+'" style="width:300px;position: absolute;top: 4px;background-color:#465b85">');input.blur(function(e){var $tar=$(e.currentTarget);var newCustName=$tar.val();if(''==newCustName){$tar.select();alert(I18n.resource.dataSource.CUSTOM_NOT_NULL);return;}if(oldCustName!=newCustName){var item,type,prjId,ptName,ptDesc,groupId,postData;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(selItemId==item.itemId){type=item.itemType;prjId=item.prjId;ptName=item.ptName;ptDesc=item.ptDesc;groupId=item.groupId;break;}}postData={itemList:[]};var eachItem={id:selItemId,type:type,projId:prjId,alias:newCustName,note:ptDesc,value:ptName,groupId:groupId};postData.itemList.push(eachItem);WebAPI.post('/analysis/datasource/saveMulti',postData).done(function(data){if(data.id!=''){_this.m_dataSourceId=data.id;}var list=data.itemIdList;var dstId,dstCustomName;for(var i=0,len=list.length;i<len;i++){dstId=list[i].id;dstCustomName=list[i].alias;for(var j=0,len2=_this.m_allPointList.length;j<len2;j++){if(dstId==_this.m_allPointList[j].itemId){_this.m_allPointList[j].customName=dstCustomName;break;}}divCurShowName.text(dstCustomName);_this.setToolTipsCustomName(divCurShowName.closest('.treeRow'),dstCustomName);}_this.calUpdateDataSources();});}input.remove();divCurShowName.css('display','inline');});input.keyup(function(e){if(13==e.keyCode){input.blur();}_this.stopBubble(e);});divCurShowName.after(input);divCurShowName.css('display','none');input.select();});div.append(divShowName);var btnRemove=$('<span class="glyphicon glyphicon-remove-sign panel-heading-btn grow dsTreeBtnRemove" aria-hidden="true"></span>');EventAdapter.on($(btnRemove),'click',function(e){var promise=$.Deferred();var div=$(e.currentTarget).closest('.treeRow');var dataSrcItemId=div.attr('id');var dataSrcId=_this.m_dataSourceId;if(typeof _this.m_parent.doSync==='function'){_this.m_parent.doSync().done(function(){promise.resolve();});}else{promise.resolve();}Spinner.spin(div[0]);promise.done(function(){WebAPI.get('/analysis/checkDatasourceBeforeDelete/'+dataSrcItemId+'/'+AppConfig.userId).done(function(chkData){var nWorkSpLen=chkData.workspaceInfo.length;var nDashBoLen=chkData.dashboardInfo.length;if(nWorkSpLen>0||nDashBoLen>0){var show=_this.m_lang.REMOVE_CONFIRM_TIPS;var name;for(var i=0;i<nWorkSpLen;i++){if(0==i){show+='workspace: ';}name=chkData.workspaceInfo[i].modalName;name=Boolean(name)?name:'Untitled';show+=name+',';}for(var j=0;j<nDashBoLen;j++){if(0==j){show+='dashboard: ';}show+=chkData.dashboardInfo[j].modalType+',';}show+=_this.m_lang.REMOVE_CONFIRM;WebAPI.get('/static/views/observer/widgets/modalFrame.html').done(function(result){var res=$(result);res.find('#modalFrmBody').text(show);var btnSure=res.find('#btnSure');btnSure.click(function(e){if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();_this.m_parent.showAnlsPane();}
div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});});res.modal('show');}).always(function(e){});}else{div.css('position','relative');div.css('animation','dsRemove 3s infinite');div.css('-moz-animation','dsRemove 3s infinite');div.css('-webkit-animation','dsRemove 3s infinite');div.css('-o-animation','dsRemove 3s infinite');WebAPI.get('/analysis/datasource/removeSingle/'+dataSrcItemId).done(function(data){if(Boolean(data.success)){var len=_this.m_allPointList.length;for(var i=0;i<len;i++){if(dataSrcItemId==_this.m_allPointList[i].itemId){_this.m_allPointList.splice(i,1);break;}}_this.calUpdateDataSources();div.tooltip('destroy');div.remove();var arr=chkData.workspaceInfo;for(var i=0,len=arr.length;i<len;i++){var divWoSp=$('.divPage');for(var j=0,len2=divWoSp.length;j<len2;j++){if(arr[i].modalName==divWoSp.eq(j).find('.modalNameSp').text()){divWoSp.eq(j).remove();}}}Beop.cache.ds.remove(dataSrcItemId);}}).fail(function(e){});}}).fail(function(e){}).always(function(e){Spinner.stop();});});});div.append(btnRemove);var bIsPoint=0==pointList[j].itemType?true:false;if(bIsPoint){var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,0,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}else{var btnCfg=$('<img src="/static/images/dataSource/item_edit.png" alt="png" class="dsTreeBtnCfg">');EventAdapter.on($(btnCfg),'click',function(e){var $pageFilter=$('#pageDataFilter');if($pageFilter.length>0){$pageFilter.find('#btnCancel').click();}if(undefined!=_this.m_cfgPanel){_this.m_cfgPanel.close();}var curTar=$(e.currentTarget);_this.m_selectItemId=curTar.closest('.treeRow').get(0).id;_this.m_selectGroupId=curTar.closest('.tree-group').get(0).id;var customName,ptDesc,ptName,item,prjId;for(var i=0,len=_this.m_allPointList.length;i<len;i++){item=_this.m_allPointList[i];if(itemId===item.itemId){customName=item.customName;ptName=item.ptName;ptDesc=item.ptDesc;prjId=item.prjId;break;}}WebAPI.get('/static/views/observer/dataSourceAdd.html').done(function(result){_this.m_cfgPanel=new DataSourceConfigure(_this,1,false,customName,ptName,ptDesc,prjId);_this.m_cfgPanel.show();}).fail(function(result){}).always(function(e){});});btnCfg.mouseenter(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit_hover.png');btnCfg.css('width','18px');btnCfg.css('height','18px');}).error(function(e){});btnCfg.mouseleave(function(e){btnCfg.attr('src','/static/images/dataSource/item_edit.png');btnCfg.css('width','16px');btnCfg.css('height','16px');}).error(function(e){});div.append(btnCfg);}EventAdapter.on($(div),'click',function(e){var divContain=$('#dataSrcPanel');divContain.find('.dsTreeBtnCfg').css('display','none');divContain.find('.dsTreeBtnRemove').css('display','none');var curTarItem=$(e.currentTarget);curTarItem.find('.dsTreeBtnCfg').css('display','inline');curTarItem.find('.dsTreeBtnRemove').css('display','inline');_this.m_selectGroupId=curTarItem.closest('.tree-group').get(0).id;});$ul.find('.rows').append(div);if(bIsPoint){var prjName=_this.getProjectNameFromId(pointList[j].prjId,_this.m_langFlag);_this.initToolTips(div,pointList[j].customName,prjName,pointList[j].ptName,pointList[j].ptDesc);}else{var showName=_this.getShowNameFromFormula(pointList[j].ptName);_this.initFormulaToolTips(div,pointList[j].customName,showName,pointList[j].ptDesc);}}}if(''==searchPointName){divContain.append($ul);}else{if(bHasSearched){divContain.append($ul);}}}},getDSItemById:function getDSItemById(datasourceItemId){var _this=this;var ret=[];var postData=[];var bIsArray=Object.prototype.toString.call(datasourceItemId)==='[object Array]';if(!bIsArray){if(this.m_parent.store.dsInfoList){var itemInfo;for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId==itemInfo.id){return itemInfo;}}}for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId==item._id){return{id:item._id,groupId:'',alias:item.alias,projId:item.projId,type:0,value:item.value};}}}else{var copyArr=datasourceItemId.slice();if(this.m_parent.store.dsInfoList){var itemInfo;for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=this.m_parent.store.dsInfoList.length;i<len;i++){itemInfo=this.m_parent.store.dsInfoList[i];if(datasourceItemId[j]==itemInfo.id){ret.push(itemInfo);break;}}}if(ret.length>0){return ret;}}for(var j=0;j<datasourceItemId.length;j++){for(var i=0,len=_this.m_arrCloudTableInfo.length;i<len;i++){var item=_this.m_arrCloudTableInfo[i];if(datasourceItemId[j]==item._id){var index=copyArr.indexOf(item._id);if(index>-1){copyArr.splice(index,1);}ret.push({id:item._id,groupId:'',alias:!!item.alias?item.alias:item.value,projId:item.projId,type:0,value:item.value});}}}if(ret.length==datasourceItemId.length){return ret;}else{datasourceItemId=copyArr;}}if(!bIsArray){postData.push(datasourceItemId);}else{postData=datasourceItemId;}var dsRet=$.ajax({type:'POST',url:'/analysis/datasource/getDsItemsById',data:JSON.stringify(postData),contentType:'application/json',async:false}).responseText;if(dsRet){var temp=JSON.parse(dsRet);if(!bIsArray){ret=temp[0];if(!ret){ret={alias:undefined,groupId:undefined,id:undefined,note:undefined,projId:undefined,type:undefined,value:undefined};}}else{if(temp instanceof Array){temp.map(function(i){if(!i.alias){i.alias=i.value;}});}ret=ret.concat(temp);}return ret;}return{};},getDSItemData:function getDSItemData(target,arrDSItemIds){var _this=this.m_parent;var timeConfig;if(_this.curModal.timeRecent){timeConfig=generateTimeOption(_this.curModal);}else{timeConfig=_this.curModal;}var tmStart=timeConfig.startTime.toDate();var tmEnd=timeConfig.endTime.toDate();var tmFmt=timeConfig.format;var key;var preloadIds=[];var row=null,arrId;var ids=arrDSItemIds.concat();var postData={dsItemIds:ids,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt};var promise=$.Deferred();Beop.cache.ds.getBatch(ids,tmFmt,tmStart,tmEnd).done(function(rs){promise.resolve(rs);}).fail(function(e){console.warn(e);promise.reject();});promise.always(function(rs){var idsNotFound,cacheData;if(rs){idsNotFound=rs.idsNotFound;cacheData=rs.data;if(idsNotFound.length>0){postData.dsItemIds=idsNotFound;}else{target.spinnerStop();target.renderModal(cacheData);return;}}WebAPI.post('/analysis/startWorkspaceDataGenHistogram',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}Beop.cache.ds.set(data,tmFmt,tmStart,tmEnd).done(function(){if(cacheData&&cacheData!==null){data={list:data.list.concat(cacheData.list),timeShaft:data.timeShaft.length>0?data.timeShaft:cacheData.timeShaft};}}).fail(function(e){console.warn(e);}).always(function(){target.renderModal(data);});}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});});},getDSItemDataMulti:function getDSItemDataMulti(target,arrDSItemIds){var _this=this.m_parent;_this.curModal.arrComparePeriodLabel=[];var tmStart=_this.curModal.startTime;tmStart=tmStart.length<=10?tmStart+' 00:00:00':tmStart;var tmEnd=_this.curModal.endTime;tmEnd=tmEnd.length<=10?tmEnd+' 00:00:00':tmEnd;var tmFmt=_this.curModal.format;var comparePeriod=_this.curModal.comparePeriod;var period1,period2,time;var startDate=new Date(tmStart);var endDate=new Date(tmEnd);var compareDateI18n=I18n.resource.analysis.historyCompare;if(comparePeriod=='hour'){time=3600000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate()+' '+startDate.getHours()+':00');_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate()+' '+endDate.getHours()+':00');}if(comparePeriod=='day'){time=86400000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1)+'-'+startDate.getDate());_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1)+'-'+endDate.getDate());}if(comparePeriod=='week'){time=604800000;period1=new Date(startDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');period2=new Date(endDate.getTime()+time).format('yyyy-MM-dd HH:mm:ss');_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',startDate.getFullYear()).replace('<%week%>',getWeekNumber(tmStart)));_this.curModal.arrComparePeriodLabel.push(compareDateI18n.YEAR_WEEK.replace('<%year%>',endDate.getFullYear()).replace('<%week%>',getWeekNumber(tmEnd)));}if(comparePeriod=='month'){var getCurrentMonthLastDay=function getCurrentMonthLastDay(date){var current=date.toDate();var currentMonth=current.getMonth();var nextMonth=++currentMonth;var nextMonthDayOne=new Date(current.getFullYear(),nextMonth,1);return new Date(nextMonthDayOne.getTime());};period1=getCurrentMonthLastDay(tmStart);period2=getCurrentMonthLastDay(tmEnd);_this.curModal.arrComparePeriodLabel.push(startDate.getFullYear()+'-'+(startDate.getMonth()+1));_this.curModal.arrComparePeriodLabel.push(endDate.getFullYear()+'-'+(endDate.getMonth()+1));}var postData=[{dsItemIds:arrDSItemIds,timeStart:tmStart.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period1.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt},{dsItemIds:arrDSItemIds,timeStart:tmEnd.format('yyyy-MM-dd HH:mm:ss'),timeEnd:period2.format('yyyy-MM-dd HH:mm:ss'),timeFormat:tmFmt}];WebAPI.post('/analysis/startWorkspaceDataGenHistogramMulti',postData).done(function(data){if(data.error&&data.error.length>0){target.errAlert(data.error);target.spinnerStop();return;}
target.renderModal(data);}).error(function(e){_this.paneCenter.spinnerStop();_this.alertNoData();});function isLeapYear(year){return year%400==0||year%4==0&&year%100!=0;}function getMonthDays(year,month){return[31,null,31,30,31,30,31,31,30,31,30,31][month]||(isLeapYear(year)?29:28);}function getWeekNumber(date){var now=date.toDate(),year=now.getFullYear(),month=now.getMonth(),days=now.getDate();for(var i=0;i<month;i++){days+=getMonthDays(year,i);}
var yearFirstDay=new Date(year,0,1).getDay()||7;var week=null;if(yearFirstDay==1){week=Math.ceil(days/yearFirstDay);}else{days-=7-yearFirstDay+1;week=Math.ceil(days/7)+1;}return week;}},getShowNameFromFormula:function getShowNameFromFormula(formula){var _this=this;var inputStr=formula;var nStart=inputStr.indexOf('<%');var nEnd=inputStr.indexOf('%>');if(-1==nStart||-1==nEnd){return inputStr;}var id=inputStr.substring(nStart+2,nEnd);if(''==id){return _this.getShowNameFromFormula(inputStr);}var retVal=_this.getDSItemById(id);if(null==retVal){return _this.getShowNameFromFormula(inputStr);}inputStr=inputStr.replace('<%'+id+'%>',retVal.value);return _this.getShowNameFromFormula(inputStr);},addNewGroup:function addNewGroup(){var groupName=$('#inputAddGroup').val();if(''==groupName){return;}var _this=this;var postData={'groupId':'','name':groupName,'parent':'','userId':AppConfig.userId};WebAPI.post('/datasource/saveDataSourceGroup',postData).done(function(data){if('successful'!=data.error){return;}var groupId=data.groupId;if(groupId){if(_this.treeObj){var nodeUnassigned=_this.treeObj.getNodesByParam('name','unassigned',null);var index=-1;if(nodeUnassigned.length>0){index=_this.treeObj.getNodeIndex(nodeUnassigned[0]);}_this.treeObj.addNodes(null,index,{id:data.groupId,pId:data.parentId,name:data.groupName,isParent:true});}}$('#inputAddGroup').val('');$('#inputAddGroup').blur();}).fail(function(result){}).always(function(e){});}};return DataSource;}();(function(){function HTMLParser(htmlString){var div=document.createElement('div');div.innerHTML=htmlString;return div.firstChild;}
if(window.$){$.extend({deepClone:function deepClone(obj){var type=$.type(obj);if(type==='object'){return $.extend(true,{},obj);}
else if(type==='array'){return $.extend(true,[],obj);}
else{return obj;}}});}
if(!String.prototype.toHexString){String.prototype.toHexString=function(){return this.split('').map(function(row){return'\\'+row.charCodeAt(0).toString(16);}).join('');};}
if(!Array.toMap){Array.toMap=function(arr,key){var map={};arr.forEach(function(row,i){map[row[key]]=row;});return map;};}
if(echarts){echarts.config=echarts.config||{color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500']};}
window.HTMLParser=HTMLParser;})();(function(exports){var Events={addEventListener:function addEventListener(events,fn,context){var _this=this;var e=this.__info||(this.__info={});events=events.split(' ');events.forEach(function(event){var evt;event='event:'+event;evt=e[event]||(e[event]=[]);evt.push(fn,context);});},on:function on(events,fn,context){return this.addEventListener(events,fn,context);},once:function once(event,fn,context){var _this=this;this.addEventListener(event,function ofn(){_this.removeEventListener(event,ofn);fn.apply(context,arguments);},context);},removeEventListener:function removeEventListener(events,fn){var e=this.__info;var rs=null;if(e){events=events.split(' ');events.forEach(function(event){var i;event=e['event:'+event];if(event){i=event.indexOf(fn);if(i>-1){rs=event.splice(i,2)[0]||null;}}});}
return rs;},removeAllListeners:function removeAllListeners(event){var e=this.__info;if(e){delete e['event:'+event];}},listeners:function listeners(event){var e=this.__info;if(e){return e['event:'+event]||[];}
return[];},emit:function emit(event){var e=this.__info;if(e){e=e['event:'+event];if(e&&e.length){for(var i=0,len=e.length;i<len;i+=2){try{e[i].apply(e[i+1],arguments);}catch(_){Log.exception('emit',_);}}
return true;}}
return false;}};exports.Events=Events;})(window);(function(exports){function Model(values){this._values=values||{};this.initialize(this._values);}
Model.prototype=Object.create(Events);void function(){this.constructor=Model;this.initialize=function(o){for(var p in o){if(o.hasOwnProperty(p)){this.property(p);}}};this.property=function(name,value){if(!(name in this)){this[name]=this._makeProperty(name);}
return arguments.length===1?this[name]():this[name](value);};this.removeProperty=function(name){var arr,obj,p,lp;if(!(name in this)){return false;}
delete this[name];arr=name.split('.');lp=arr.pop();obj=this._values;while(p=arr.shift()){obj=obj[p];}delete obj[lp];for(var p in this){if(!this.hasOwnProperty(p)||p.indexOf(name)!==0)continue;delete this[p];}
return true;};this.emit=function(event){Events.emit.apply(this,arguments);};this.delayUpdate=function(fn){var pending=false;var propsPathArr=[];if(this.hasOwnProperty('emit')){try{fn.call(this);}catch(e){Log.error(e);}
return;}
try{this.emit=function(event){if(event==='update'){pending=true;}else{this.__proto__.emit.apply(this,arguments);}};propsPathArr=fn.call(this);}finally{delete this.emit;if(pending){this.emit('update',propsPathArr.join(','));}}};this.update=function(props){var _this=this;this.delayUpdate(function(){var propsPathArr=[];for(var prop in props){if(!(prop in this)){throw new Error(''+prop);}
_this[prop](props[prop]);propsPathArr.push('update.'+prop);}
return propsPathArr;});};this.serialize=function(){return this._values;};this._makeProperty=function(prop){var body='var ov = this._values.{p};if(arguments.length && (v !== ov || Object.prototype.toString.call(v) === "[object Object]") ) {this._values.{p}=v; this.emit("update.{p}"); this.emit("update", \'update.{p}\'); } return ov;';return new Function('v',body.replace(/\{p\}/g,prop));};}.call(Model.prototype);Model.prototype.compose=function(){var models=Array.prototype.slice.apply(arguments).concat(this);return{updateAsReplace:function(customEventName,fn){if(typeof fn!=='function'){return;}
customEventName=customEventName||'customEvent';models.forEach(function(model){model.emit=function(){};});fn.call(this);models.forEach(function(model){delete model.emit;});this.emit(customEventName,models);}.bind(this),update:function(customEventName,fn){if(typeof fn!=='function'){return;}
customEventName=customEventName||'customEvent';fn.call(this);this.emit(customEventName,models);}.bind(this)};};exports.Model=Model;})(window);(function(exports,Model){var class2type={};['Boolean','Number','String','Array','Function','Object','Date','RegExp','Error'].forEach(function(type){class2type['[object '+type+']']=type.toLowerCase();});function getType(o){if(o==null){return o+'';}
var type=Object.prototype.toString.call(o);return class2type[type]||'object';}
function NestedModel(){Model.apply(this,arguments);}
NestedModel.prototype=Object.create(Model.prototype);void function(){this.constructor=NestedModel;this.initialize=function(o,path,k){var keys,currentPath;path=path||[];currentPath=path.slice(0);if(typeof k!=='undefined'){currentPath.push(k);}
if(currentPath.length>0){this.property(currentPath.join('.'));}
if(getType(o)==='object'){keys=Object.keys(o);keys.forEach(function(p){this.initialize(o[p],currentPath,p);},this);}};this._makeProperty=function(prop){var body='var o = this._values, isObj = Object.prototype.toString.call(v) === \'[object Object]\', arr = \'{p}\'.split(\'.\'), n = arr.splice(arr.length-1, 1)[0], path = arr.length ? arr.slice(0) : [], row, ov; while(row = arr.shift()) { o = o[row]; }; ov = o[n]; if(arguments.length && (v !== ov || isObj )) {o[n]=v; if(isObj){this.initialize(v,path,n)};this.emit("update.{p}"); this.emit("update", \'update.{p}\'); } return ov;';return new Function('v',body.replace(/\{p\}/g,prop));};}.call(NestedModel.prototype);exports.NestedModel=NestedModel;})(window,window.Model);(function(exports){function ModelSet(models){this.models=models||[];}
ModelSet.prototype=Object.create(Model.prototype);void function(){this.constructor=ModelSet;this.length=function(){return this.models.length;};this.get=function(index){return this.models[index];};this.forEach=function(fn,ctx){return this.models.forEach(fn,ctx);};this.indexOf=function(model){return this.models.indexOf(model);};this.findByProperty=function(name,value){var models=this.models;for(var i=0,len=models.length;i<len;i++){if(models[i][name]()===value){return models[i];}}
return null;};this.findListByProperty=function(name,value){var models=this.models;var rs;rs=models.filter(function(row){if(row[name]()===value){return true;}
return false;});return rs;};this.insertAt=function(idx,model){var count;if(idx<0){idx+=this.models.length+1;}
if(Array.isArray(model)){this.models.splice.apply(this.models,[idx,0].concat(model));count=model.length;}else{this.models.splice(idx,0,model);count=1;model=[model];}
this.emit('insert',{index:idx,count:count,models:model});return count;};this.emit=function(evt){Model.prototype.emit.apply(this,arguments);};this.prepend=function(model){return this.insertAt(0,model);};this.append=function(model){return this.insertAt(-1,model);};this.remove=function(model){var fidx=-1;var count=0;var total=0;var removed=[];if(Array.isArray(model)){model.forEach(function(m){var idx=this.indexOf(m);if(idx===-1)return;total++;if(fidx===-1){fidx=idx;count++;}else if(idx===fidx+count){count++;}else{removed=removed.concat(this.models.splice(fidx,count));fidx=idx<fidx?idx:idx-count;count=1;}},this);if(count){removed=removed.concat(this.models.splice(fidx,count));this.emit('remove',{count:count,models:removed});}}else{var idx=this.indexOf(model);if(idx!==-1){this.models.splice(idx,1);this.emit('remove',{count:1,models:[model]});total=1;}}
return total;};this.removeAll=function(){var len=this.models.length;var removed;if(len){removed=this.models.splice(0,len);this.emit('remove',{count:len,models:removed});return true;}else{return false;}};this.move=function(from,to){var len=this.models.length;var moved=null;while(from<0){from+=len;}
while(to<0){from+=len;}
if(to>=len){while(len++<=to){this.models.push(undefined);}}
moved=this.models.splice(from,1);this.models.splice(to,0,moved[0]);this.emit('move',{from:from,to:to,models:moved});return true;};this.serialize=function(){var ms=[];this.forEach(function(row){ms.push(row.serialize());});return ms;};this.toMap=function(key,returnModelFormat){var map={};for(var i=0,len=this.models.length;i<len;i++){map[this.models[i][key]()]=returnModelFormat?this.models[i]:this.models[i].serialize();}
return map;};}.call(ModelSet.prototype);exports.ModelSet=ModelSet;})(window);;(function(exports){exports.ChartThemeConfig=exports.ChartThemeConfig||{};+function(){var DEFAULT_CHART_OPTIONS={title:{textStyle:{fontWeight:'normal',color:'#000'},left:'center'},toolbox:{showTitle:false},grid:{borderWidth:0,left:80,bottom:40,right:80,top:80},series:[],color:['#E2583A','#FD9F08','#1D74A9','#04A0D6','#689C0F','#109d83','#FEC500'],animation:false};this.PIE_CHART_OPTIONS=$.extend(false,{},DEFAULT_CHART_OPTIONS,{tooltip:{trigger:'item',formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:'horizontal',left:50,data:[]}});this.AXIS_CHART_OPTIONS=$.extend(false,{},DEFAULT_CHART_OPTIONS,{tooltip:{trigger:'axis',backgroundColor:'rgba(0,0,0,0.6)',axisPointer:{type:'line',lineStyle:{color:'#aaa'},crossStyle:{color:'#aaa'},shadowStyle:{color:'rgba(200,200,200,0.2)'}},textStyle:{color:'#ffffff'}},legend:{textStyle:{color:'#999999'},top:30,data:[]},valueAxis:{axisLine:{show:false},axisTick:{show:false},axisLabel:{textStyle:{color:'#8c97aa'},margin:10},splitLine:{lineStyle:{color:['#999999'],type:"solid",opacity:0.4}},nameTextStyle:{color:'#000000'}},categoryAxis:{axisLine:{lineStyle:{color:'#333333',opacity:0.6}},axisTick:{show:false},axisLabel:{textStyle:{color:'#8c97aa'},margin:10},splitLine:{show:false},nameTextStyle:{color:'#000000'}},xAxis:[{axisLine:{lineStyle:{color:'#333333',opacity:0.6}},axisTick:{show:false},axisLabel:{textStyle:{color:'#8c97aa'},margin:10},splitLine:{show:false},nameTextStyle:{color:'#000000'}}],yAxis:[{axisLine:{show:false},axisTick:{show:false},axisLabel:{textStyle:{color:'#8c97aa'},margin:10},splitLine:{lineStyle:{color:['#999999'],type:"solid",opacity:0.4}},nameTextStyle:{color:'#000000'}}]});}.call(exports.ChartThemeConfig);if(AppConfig&&AppConfig.isMobile){+function(){this.PIE_CHART_OPTIONS=$.extend(false,{},this.PIE_CHART_OPTIONS,{tooltip:{trigger:'item'},legend:{orient:'horizontal',left:50,data:[]}});this.AXIS_CHART_OPTIONS=$.extend(false,{},this.AXIS_CHART_OPTIONS,{grid:{left:60,bottom:40,right:20,top:130},yAxis:[{type:'value',axisTick:{show:false},axisLine:{show:false},nameGap:45}]});}.call(exports.ChartThemeConfig);}})(namespace('factory.report.config'));var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function(exports){function VariableProcessMixin(){this.variableProcessTasks=[];}
+function(){this._formatVariables=function(variables){if((typeof variables==='undefined'?'undefined':_typeof(variables))==='object'){variables=$.extend(false,{},variables);Object.keys(variables).forEach(function(key){var row=variables[key];if((typeof row==='undefined'?'undefined':_typeof(row))==='object'&&typeof row['val']!=='undefined'){variables[key]=row['val'];}});}
else{return;}
return variables;};this.registTask=function(variables,ins){var promise=$.Deferred();variables=this._formatVariables(variables);variables=$.extend(true,{},variables);this.variableProcessTasks.push({variables:variables,promise:promise,ins:ins});return promise;};this.processTask=function(){var loadQueue;var api={SUM:function SUM(){var points=Array.prototype.slice.apply(arguments);var total=0;points.forEach(function(p){var sum=0;p.data.forEach(function(num){sum+=num;});total+=sum;});return Math.round(total*100)/100;},SUM_POINT:function SUM_POINT(){var points=Array.prototype.slice.apply(arguments);var rs={data:[],timeShaft:points[0].timeShaft};points[0].data.forEach(function(row,i){var rowSum=0;points.forEach(function(p){rowSum+=p.data[i];});rs.data.push(rowSum);});return rs;},NONZERO_AVERAGE:function NONZERO_AVERAGE(){var points=Array.prototype.slice.apply(arguments);var total=0,count=0;points.forEach(function(p){p.data.forEach(function(num){if(num===0){return;}
total+=num;count++;});});if(count===0){return 0;}
return Math.round(total/count*100)/100;},AVERAGE:function AVERAGE(){var points=Array.prototype.slice.apply(arguments);var total=0,count=0;points.forEach(function(p){p.data.forEach(function(num){total+=num;count++;});});if(count===0){return 0;}
return Math.round(total/count*100)/100;},MAX:function MAX(){var points=Array.prototype.slice.apply(arguments);var data=[],timeShaft=[];var max,idx,indices=[];points.forEach(function(p){data=data.concat(p.data);timeShaft=timeShaft.concat(p.timeShaft);});max=Math.max.apply(null,data);idx=data.indexOf(max);while(idx!==-1){indices.push(idx);idx=data.indexOf(max,idx+1);}
return{value:max,time:indices.map(function(row){return timeShaft[row];})};},MIN:function MIN(){var points=Array.prototype.slice.apply(arguments);var data=[],timeShaft=[];var min,idx,indices=[];points.forEach(function(p){data=data.concat(p.data);timeShaft=timeShaft.concat(p.timeShaft);});min=Math.min.apply(null,data);idx=data.indexOf(min);while(idx!==-1){indices.push(idx);idx=data.indexOf(min,idx+1);}
return{value:min,time:indices.map(function(row){return timeShaft[row];})};},ACCUM_POINT:function ACCUM_POINT(){var points=Array.prototype.slice.apply(arguments);var rs={data:[],timeShaft:points[0].timeShaft};if(points.length){points[0].data.forEach(function(row,i){var rowSum=0;points.forEach(function(p){rowSum+=p.data[i];});rs.data.push(rowSum);});}else{rs=points[0];}
rs.data=rs.data.slice(0,rs.data.length-1).map(function(row,i){return rs.data[i+1]-row;});rs.timeShaft.length=rs.timeShaft.length-1;return rs;}};function getCalcQueue(dpMap,name,deep){var queue=[];var dp=dpMap[name];if(!dp)return[];deep=deep||0;if(deep>20){console.error('');return[];}
deep+=1;dp.forEach(function(row){queue=queue.concat(getCalcQueue(dpMap,row,deep));});queue.push(name);return queue;}
function calc(info,dsMap,scope){var dpMap=info.dependencies;var start=Object.keys(dpMap)[0];var rs={};loadQueue={};Object.keys(dpMap).forEach(function(key){var calcQueue=getCalcQueue(dpMap,key);calcQueue.forEach(function(name){if(loadQueue[name]==='loaded'){return;}
rs[name]=parse(name,info.variables[name]+'',$.extend(false,scope,rs,dsMap));loadQueue[name]='loaded';});});return rs;}
function parse(name,codeStr,map){var str=codeStr.replace(/<[%#](.+?)[%#]>/mg,function($0,$1){return'_map["'+$1+'"]';});if(str===codeStr){return codeStr;}
try{return new Function('SUM','SUM_POINT','NONZERO_AVERAGE','AVERAGE','MAX','MIN','ACCUM_POINT','_map','return '+str)(api['SUM'],api['SUM_POINT'],api['NONZERO_AVERAGE'],api['AVERAGE'],api['MAX'],api['MIN'],api['ACCUM_POINT'],map);}catch(e){Log.error(e);return codeStr;}}
function formatVariables(data){var dsMap={};var dependencies={};if(data){Object.keys(data).forEach(function(key){var row=data[key];var patternDs=/<%(.+?)%>/mg;var patternTpl=/<#(.+?)#>/mg;var match;var str,idx,optionStr;while(match=patternDs.exec(row)){str=match[1];idx=str.indexOf(',');if(idx===-1){dsMap[str]={};}else{optionStr=str.substring(idx);dsMap[str]=function(optionStr){var arr=optionStr.split(',');var opt={};arr.forEach(function(kv){var kvArr=kv.split('=');if(kvArr.length===1){opt[kv]='true';}else{opt[kvArr[0]]=kvArr[1];}});return opt;}(optionStr);}}
dependencies[key]=[];while(match=patternTpl.exec(row)){dependencies[key].push(match[1]);}});}
return{dsMap:dsMap,dependencies:dependencies};}
function format(data){var rs=[];data.forEach(function(row){var info=formatVariables(row.variables);info.variables=row.variables;info.promise=row.promise;info.ins=row.ins;rs.push(info);});return rs;}
function getPeriodTime(row,timeS,timeE,map){var timeStart=timeS;var timeEnd=timeE;var p=map[row];var dayMs=24*60*60*1000;function add0(v){return v<10?'0'+v:v;}
function defaultTimeEnd(y,m,d){var oldTime=new Date(y,m-1,d).getTime()-dayMs,newTime=new Date(oldTime),year=newTime.getFullYear(),month=newTime.getMonth()+1,dat=newTime.getDate();return year+'-'+add0(month)+'-'+add0(dat)+' 23:59:59';}
if(p.period){var date=new Date(),year=date.getFullYear(),month=date.getMonth()+1,dat=date.getDate(),hour,min,sec,other=add0(dat)+' 00:00:00',other2=add0(dat)+' 23:59:59';var reg=/^last(\d+)(days|months|years)$/gm;var arr=reg.exec(p.period);var count,type,oldTime,newTime;var monthCount;if(arr){count=Number.parseInt(arr[1]);type=arr[2];if(type==="days"){timeStart=year+'-'+add0(month)+'-'+other;if(count===0){timeEnd=year+'-'+add0(month)+'-'+other2;}else{timeEnd=defaultTimeEnd(year,month,dat);}
oldTime=new Date(timeStart.replace(/-/g,"/")).getTime()-dayMs*count;newTime=new Date(oldTime);year=newTime.getFullYear();month=newTime.getMonth()+1;dat=newTime.getDate();hour=newTime.getHours();min=newTime.getMinutes();sec=newTime.getSeconds();other=add0(dat)+' '+add0(hour)+':'+add0(min)+':'+add0(sec);}
if(type==="months"){if(count===0){timeEnd=year+'-'+add0(month)+'-'+add0(new Date(year,month-1,0).getDate())+' 23:59:59';}else{timeEnd=defaultTimeEnd(year,month,1);}
other="01 00:00:00";monthCount=year*12+month-count;month=monthCount%12;year=(monthCount-month)/12;}
if(type==="years"){if(count===0){timeEnd=defaultTimeEnd(year+1,1,1);}else{timeEnd=defaultTimeEnd(year,1,1);}
month=1;other="01 00:00:00";year-=count;}
timeStart=year+'-'+add0(month)+'-'+other;}}
return{timeStart:timeStart,timeEnd:timeEnd};}
function getDelayTime(row,time,map){var timeStart=time.timeStart;var timeEnd=time.timeEnd;var p=map[row];var milliSecond=0;if(!p.delay){p['delay']=0;}else{p.delay=Number(p.delay);if(isNaN(p.delay)){Log.warn('there has one point gave an unsupported delay: '+p.delay);return;}}
switch(p.tf){case'm5':milliSecond=300000;break;case'h1':milliSecond=3600000;break;case'd1':milliSecond=86400000;break;}
timeEnd=timeFormat(Date.parse(timeEnd.replace(/-/g,'/'))+milliSecond*p.delay);return{timeStart:timeStart,timeEnd:timeEnd};}
function formatParamsMap(map,reportOptions){var listMap={'m5':[],'h1':[],'d1':[]};var defaultTF=reportOptions['timeFormat'];var timeStart=reportOptions['startTime'];var timeEnd=reportOptions['endTime'];var listOrder=[];Object.keys(map).forEach(function(row){var p=map[row];if(!p.tf){p['tf']=defaultTF;}
if(listMap[p.tf]){var id=row;if(id.indexOf(',')>-1){id=id.substring(0,id.indexOf(','));}
var time=getPeriodTime(row,timeStart,timeEnd,map);time=getDelayTime(row,time,map);listMap[p.tf].push({id:id,timeStart:time.timeStart,timeEnd:time.timeEnd,row:row});}
else{Log.warn('there has one point gave an unsupported time format: '+p.tf);}});return{listMap:listMap,list:function(){var list=[];Object.keys(listMap).forEach(function(tf){var ids=listMap[tf];if(ids.length){var order={};var result=function(arr){var n={};for(var i=0;i<arr.length;i++){if(!n[arr[i].timeStart+'+'+arr[i].timeEnd]){n[arr[i].timeStart+'+'+arr[i].timeEnd]=[arr[i].id];order[arr[i].timeStart+'+'+arr[i].timeEnd]=[arr[i].row];}else{n[arr[i].timeStart+'+'+arr[i].timeEnd].push(arr[i].id);order[arr[i].timeStart+'+'+arr[i].timeEnd].push(arr[i].row);}}
return n;}(ids);for(var k in result){var timeArr=k.split('+');list.push({dsItemIds:result[k],timeStart:timeArr[0],timeEnd:timeArr[1],timeFormat:tf});listOrder.push(order[k]);}}});return list;}(),listOrder:listOrder};}
return function(options){var _this=this;var infoList=format(this.variableProcessTasks);var dsDefineMap={},variableList=[];var params=[];var promise=$.Deferred();options=options||{};infoList.forEach(function(row){dsDefineMap=$.extend(false,{},dsDefineMap,row.dsMap);});if(!Object.keys(dsDefineMap).length){variableList=infoList.map(function(info){return calc(info,{},info.ins.screen.variables||{});});promise.resolve(-1);}else{params=formatParamsMap(dsDefineMap,options.reportOptions||this.getReportOptions());$.ajax({type:'post',url:(AppConfig.isMobile&&AppConfig.host&&typeof cordova!='undefined'?AppConfig.host:'')+'/analysis/startWorkspaceDataGenHistogramMulti',data:JSON.stringify(params.list),contentType:'application/json'}).then(function(rs){if(!rs.length){Log.warn('get no data for the report.');promise.resolve(-1);return;}else{var dsMap={};var order=params.list.map(function(row){return row.timeFormat;});var listOrder=[],data=[];params.listOrder.forEach(function(it){listOrder=listOrder.concat(it);});rs.forEach(function(it){var time=it.timeShaft;it.list.forEach(function(item){data.push({data:item.data,timeShaft:time});});});listOrder.forEach(function(it,i){dsMap[it]=data[i]?data[i]:{data:[],timeShaft:[]};});infoList.map(function(info){var map={},calcRs;Object.keys(dsMap).forEach(function(ds){map[ds]=dsMap[ds];});calcRs=calc(info,map,info.ins.screen.variables||{});info.promise.resolve(calcRs);});promise.resolve();}},function(){promise.resolve(-1);}).always(function(){_this.variableProcessTasks.length=0;params.list=[];});}
return promise.done(function(status){var item,i;if(status===-1){i=0;while(item=_this.variableProcessTasks.shift()){item.promise.resolve(variableList[i]);i++;}}});};}();}.call(VariableProcessMixin.prototype);exports.VariableProcessMixin=VariableProcessMixin;})(namespace('factory.report.mixins'));;(function(exports){function Component(){}
+function(){this.onRenderComplete=function(){throw new Error('onRenderComplete ');};this.render=function(){throw new Error('render ');};this.destroy=function(){throw new Error('destroy ');};}.call(Component.prototype);exports.Component=Component;})(namespace('factory.report.components'));;(function(exports,SuperClass,DateUtil){function Base(parent,entity,root,idx){SuperClass.apply(this,arguments);this.screen=parent;this.entity=entity;this.entity.id=this.entity.id||ObjectId();this.wrap=null;this.container=null;this.spinner=null;this.variables=null;this.root=root||this;this.initEntity();this.init(idx);}
Base.prototype=Object.create(SuperClass.prototype);Base.prototype.constructor=Base;+function(){this.UNIT_WIDTH=100/12;this.UNIT_HEIGHT=60;this.TPL_PARAMS_PATTERN=/<#\s*(\w*?)\s*#>/mg;this.TPL_PARAMS_IN_VARIABLES_PATTERN=/<@\s*(\w*?)\s*@>/mg;this.configModalType=undefined;this.initEntity=function(){};this.render=function(){};this.init=function(insertIdx){var _this=this;var divWrap,divParent;this.wrap=divWrap=document.createElement('div');divWrap.id='reportContainer_'+this.entity.id;divWrap.className='report-container-wrap';if(this.optionTemplate.className){divWrap.classList.add.apply(divWrap.classList,this.optionTemplate.className.split(' '));}
divParent=document.createElement('div');divParent.classList.add('report-container');divWrap.appendChild(divParent);if(typeof insertIdx==='undefined'){this.screen.container.appendChild(divWrap);}
else{this.screen.container.insertBefore(divWrap,this.screen.container.childNodes[insertIdx]);}
if(AppConfig.isReportConifgMode){this.initHeader();if(!this.isReadonly()){this.initTools();this.initResizer();}}
this.container=document.createElement('div');this.container.className='report-content clearfix';divParent.appendChild(this.container);this.resize();return this;};this.initHeader=function(){var divWrap=this.wrap;var divParent=divWrap.querySelector('.report-container');var divTop,divHeader;divTop=document.createElement('div');divTop.classList.add('report-top-box');divTop.classList.add('clearfix');divParent.appendChild(divTop);divHeader=document.createElement('div');divHeader.className='report-header';divHeader.innerHTML=eval(this.optionTemplate.name);divTop.appendChild(divHeader);this.initTitle();};this.initTools=function(tools){var _this=this;var divWrap;var divTop;var divToolWrap;var btn,tool,len;divWrap=this.wrap;divTop=divWrap.querySelector('.report-top-box');divToolWrap=document.createElement('div');divToolWrap.className='report-tool-wrap';tools=tools||['variable','configure','remove'];tools=tools.concat();len=tools.length;while(tool=tools.shift()){switch(tool){case'variable':btn=document.createElement('a');btn.className='report-tool-btn';btn.title=I18n.resource.report.VAR_DECLARATION;btn.href='javascript:;';btn.innerHTML='<span class="glyphicon glyphicon-th-large"></span>';divToolWrap.appendChild(btn);btn.onclick=function(e){DeclareVariablesModal.show({js:_this.getDeclareVariables()},function(code){_this.render(true);},['js']);};break;case'configure':btn=document.createElement('a');btn.className='report-tool-btn ';btn.title=I18n.resource.report.chapterConfig.CONFIG;btn.href='javascript:;';btn.innerHTML='<span class="glyphicon glyphicon-cog"></span>';divToolWrap.appendChild(btn);btn.onclick=function(e){_this.showConfigModal();};break;case'remove':btn=document.createElement('a');btn.className='report-tool-btn ';btn.title=I18n.resource.report.REMOVE_BTN;btn.innerHTML='<span class="glyphicon glyphicon-remove"></span>';divToolWrap.appendChild(btn);btn.onclick=function(e){confirm(I18n.resource.report.CONFIRM_DELETE,function(){if(_this.chart)_this.chart.clear();_this.screen.remove(_this.entity.id);$(_this.wrap).remove();});};break;case'export':btn=document.createElement('a');btn.className='report-tool-btn ';btn.title=I18n.resource.report.EXPORT_BTN;btn.innerHTML='<span class="glyphicon glyphicon-export"></span>';divToolWrap.appendChild(btn);btn.onclick=function(){var name;if(name=prompt(I18n.resource.report.ENTER_TEMPLATE_NAME)){typeof _this.export==='function'&&_this.export(name).done(function(){alert(I18n.resource.report.EXPORT_SUCCESS);}).fail(function(){alert(I18n.resource.report.EXPORT_ERROR);});}else{alert(I18n.resource.report.ERROR_TEMPLATE_NAME);}};break;}}
if(len>0){divTop.appendChild(divToolWrap);}};this.getDeclareVariables=function(){this.entity.modal.variables=this.entity.modal.variables||{};return{title:this.entity.modal.type,val:this.entity.modal.variables};};this.initResizer=function(){var _this=this;var divWrap=this.wrap;var $divTop=$(divWrap.querySelector('.report-top-box'));var iptResizerCol,iptResizerRow;var options=this.optionTemplate;this.entity.spanC=this.entity.spanC||options.minWidth;this.entity.spanR=this.entity.spanR||options.minHeight;var $resizers=$(('<div class="btn-group number-resizer-wrap">\
                <label class="control-label">'+I18n.resource.report.LABEL_WIDTH+':</label><input type="number" class="btn btn-default number-resizer-col" value="{width}" min="{minWidth}" max="{maxWidth}">\
                <label class="control-label">'+I18n.resource.report.LABEL_HEIGHT+':</label><input type="number" class="btn btn-default number-resizer-row" value="{height}" min="{minHeight}" max="{maxHeight}">\
            </div>').formatEL({width:this.entity.spanC,height:this.entity.spanR,minWidth:options.minWidth,minHeight:options.minHeight,maxWidth:options.maxWidth,maxHeight:options.maxHeight})).appendTo($divTop);iptResizerCol=$resizers[0].querySelector('.number-resizer-col');iptResizerRow=$resizers[0].querySelector('.number-resizer-row');iptResizerRow.onchange=function(){this.value=Math.max(Math.min(options.maxHeight,this.value),options.minHeight);_this.entity.spanR=Math.floor(this.value);_this.resize();};iptResizerCol.onchange=function(){this.value=Math.max(Math.min(options.maxWidth,this.value),options.minWidth);_this.entity.spanC=Math.floor(this.value);_this.resize();};_this.divResizeByMouseInit();};this.divResizeByMouseInit=function(){var _this=this;var divContainer=$(this.wrap).get(0);var resizeOnRight=document.createElement('div');resizeOnRight.className='resizeOnRight';divContainer.appendChild(resizeOnRight);var resizeOnBottom=document.createElement('div');resizeOnBottom.className='resizeOnBottom';divContainer.appendChild(resizeOnBottom);var resizeOnCorner=document.createElement('div');resizeOnCorner.className='resizeOnCorner';divContainer.appendChild(resizeOnCorner);var mouseStart={};var containerStart={};var w,h,tempSpanR,tempSpanC;resizeOnBottom.onmousedown=function(e){e.stopPropagation();var $reportWrap=$('#reportWrap');var oEvent=e||event;mouseStart.y=oEvent.clientY;containerStart.h=$(divContainer).height();doResizeOnType(e,'bottom');$reportWrap.off('mousemove').on('mousemove',function(e){doResizeOnType(e,'bottom');});$reportWrap.off('mouseup').on('mouseup',function(e){stopResizeOnType(e,'bottom');$reportWrap.off('mousemove mouseup');$(resizeOnBottom).off('mousedown');});};resizeOnRight.onmousedown=function(e){e.stopPropagation();var $panels=$('#panels');var oEvent=e||event;mouseStart.x=oEvent.clientX;containerStart.w=$(divContainer).width();var minSpanC;if(_this.entity.modal.type==="Table"){minSpanC=6;}else{minSpanC=3;}
containerStart.minW=$(divContainer).parent().width()*(minSpanC*_this.UNIT_WIDTH/100)-parseInt($(divContainer).css('padding-left'))-parseInt($(divContainer).css('padding-right'));doResizeOnType(e,'right');$panels.off('mousemove').on('mousemove',function(e){doResizeOnType(e,'right');});$panels.off('mouseup').on('mouseup',function(e){stopResizeOnType(e,'right');$panels.off('mousemove mouseup');$(resizeOnRight).off('mousedown');});};resizeOnCorner.onmousedown=function(e){e.stopPropagation();var $panels=$('#panels');var oEvent=e||event;mouseStart.x=oEvent.clientX;mouseStart.y=oEvent.clientY;containerStart.w=$(divContainer).width();containerStart.h=$(divContainer).height();doResizeOnType(e,'corner');$panels.off('mousemove').on('mousemove',function(e){doResizeOnType(e,'corner');});$panels.off('mouseup').on('mouseup',function(e){stopResizeOnType(e,'corner');$panels.off('mousemove mouseup');$(resizeOnCorner).off('mousedown');});};function doResizeOnType(e,type){var oEvent=e||event;var differenceX,differenceY;switch(type){case'bottom':differenceY=oEvent.clientY-mouseStart.y;h=differenceY+containerStart.h;divContainer.style.height=h+"px";break;case'right':if(oEvent.clientX-containerStart.minW<$(divContainer).offset().left+parseInt($(divContainer).css('padding-left'))){return;}
differenceX=oEvent.clientX-mouseStart.x;w=differenceX+containerStart.w;$(divContainer).width(w);break;case'corner':differenceX=oEvent.clientX-mouseStart.x;w=differenceX+containerStart.w;$(divContainer).width(w);differenceY=oEvent.clientY-mouseStart.y;h=differenceY+containerStart.h;divContainer.style.height=h+"px";break;}}
function stopResizeOnType(e,type){var oEvent=e||event;var differenceX,differenceY;switch(type){case'bottom':differenceY=oEvent.clientY-mouseStart.y;h=differenceY+containerStart.h;tempSpanR=Math.round(h/_this.UNIT_HEIGHT);$(divContainer).find('.number-resizer-row').val(tempSpanR).trigger('change');break;case'right':differenceX=oEvent.clientX-mouseStart.x;w=differenceX+containerStart.w;tempSpanC=Math.round(w*100/($(divContainer).parent().width()*_this.UNIT_WIDTH));$(divContainer).find('.number-resizer-col').val(tempSpanC).trigger('change');break;case'corner':differenceX=oEvent.clientX-mouseStart.x;w=differenceX+containerStart.w;tempSpanC=Math.round(w*100/($(divContainer).parent().width()*_this.UNIT_WIDTH));differenceY=oEvent.clientY-mouseStart.y;h=differenceY+containerStart.h;tempSpanR=Math.round(h/_this.UNIT_HEIGHT);$(divContainer).find('.number-resizer-row').val(tempSpanR).trigger('change');$(divContainer).find('.number-resizer-col').val(tempSpanC).trigger('change');break;}}};this.initTitle=function(){};this.showConfigModal=function(modal){var domWindows=document.querySelector('#windowRightPanel');if(!modal){modal=exports[this.entity.modal.type+'ConfigModal'];if(!modal&&this.configModalType){modal=exports[this.configModalType+'ConfigModal'];}}
if(!modal){alert('no config modal found!');return;}
modal.setOptions({modalIns:this,container:'reportWrap'});modal.show().done(function(){modal.$modal.css({top:domWindows.scrollTop+'px',bottom:-domWindows.scrollTop+'px'});});};this.resize=function(){$(this.wrap).css({width:this.entity.spanC*this.UNIT_WIDTH+'%',height:this.entity.spanR*this.UNIT_HEIGHT+'px'});};this.getTplParams=function(){var str=function(){var variables=this.entity.modal.variables;var str='';if(!variables){return'';}
Object.keys(variables).forEach(function(k){str+=variables[k];});return str;}.call(this);var pattern=this.TPL_PARAMS_IN_VARIABLES_PATTERN;var match=null;var params=[];while(match=pattern.exec(str)){params.push(match[1]);}
return params;};this.closest=function(cond){var parent=this;var tmp;while(parent&&parent!==this.root){if(cond['type']){tmp=Object.prototype.toString.call(cond['type'])==='[object Array]'?cond['type']:[cond['type']];if(tmp.indexOf(parent.entity.modal.type)>-1){return parent;}}
parent=parent.screen;}
return null;};this.getTplParamsValue=function(){var tplParams=(this.closest({type:'ChapterContainer'})||this).entity.modal.option.tplParams;var variables=this.variables;return $.extend(true,{},tplParams,variables);};this.applyTplParams=function(params){this.entity.modal.option.tplParams=params;};this.getReportDate=function(){var options=this.root.entity.modal.option;var date=this.root.screen.reportDate;var now,weekDay,year,month;var tmp;if(!date){now=new Date();switch(options.period||'day'){case'day':date=new Date((Math.floor(now.valueOf()/86400000)-1)*86400000).format('yyyy-MM-dd');break;case'week':weekDay=now.getDay()===0?13:7+(now.getDay()-1);date=new Date((Math.floor(now.valueOf()/86400000)-weekDay)*86400000).format('yyyy-MM-dd');break;case'month':year=now.getFullYear();month=now.getMonth();tmp=year*12+month-1;year=parseInt(tmp/12);month=tmp%12+1;month=month<10?'0'+month:month;date=[year,month].join('-');break;case'year':year=now.getFullYear();date=year-1+'';break;default:break;}}
return date;};this.getReportPeriod=function(){return this.root.entity.modal.option.period||'day';};this.getReportOptions=function(){var options=this.root.entity.modal.option;var periodStartTime=typeof options.periodStartTime!=='undefined'?options.periodStartTime:0;var params={};var dStart,dEnd,month,year;dStart=new Date(this.getReportDate());switch(options.period||'day'){case'day':dStart=new Date(dStart.valueOf()+(periodStartTime===0?periodStartTime:periodStartTime-24)*3600000);dEnd=new Date(dStart.valueOf()+86400000);params['timeFormat']='m5';break;case'week':dStart=new Date(dStart.valueOf()+(periodStartTime===0?periodStartTime:periodStartTime-7)*86400000);dEnd=new Date(dStart.valueOf()+86400000*7);params['timeFormat']='d1';break;case'month':if(periodStartTime!==0){year=dStart.getFullYear();month=DateUtil.getLastMonth(dStart.getMonth()+1);if(month===12){year-=1;}
dStart=[year,month,'01'].join('-').toDate();}
dStart=new Date(dStart.valueOf()+periodStartTime*86400000);dEnd=new Date(dStart.valueOf()+DateUtil.daysInMonth(dStart)*86400000);params['timeFormat']='d1';break;case'year':year=dStart.getFullYear();if(periodStartTime!==0){year-=1;}
month=dStart.getMonth()+periodStartTime+1;month=month<10?'0'+month:month;dStart=new Date([year,month].join('-'));dEnd=new Date(dStart.valueOf()+(DateUtil.isLeapYear(year)?366:365)*86400000);params['timeFormat']='d1';break;}
dStart=new Date(dStart.valueOf()+dStart.getTimezoneOffset()*60000);dEnd=new Date(dEnd.valueOf()+dEnd.getTimezoneOffset()*60000-1000);params['startTime']=dStart.format('yyyy-MM-dd HH:mm:ss');params['endTime']=dEnd.format('yyyy-MM-dd HH:mm:ss');return params;};this.registVariableProcessTask=function(variables){return this.root.registTask(variables,this).then(function(rs){this.variables=this.createObjectWithChain(rs);}.bind(this));};this._getTplParamsAttachedVariables=function(variables){var params=this.getTplParamsValue();var pattern=this.TPL_PARAMS_IN_VARIABLES_PATTERN;var obj={};if(!params||!variables){return variables;}
Object.keys(variables).forEach(function(k){var row=variables[k];obj[k]=row.replace(pattern,function($0,$1){return params[$1]||'';});});return obj;};this.createObjectWithChain=function(){function PropFunction(props){var _this=this;for(var p in props){_this[p]=props[p];}}
return function(props){PropFunction.prototype=this.screen.variables||{};return new PropFunction(props);};}();this.isIn=function(type){var parent,find;if(typeof type!=='string'){return false;}
if(this===this.root){return false;}
find=false;parent=this.screen;while(parent!==null){if(parent.optionTemplate.type===type){find=true;break;}
if(parent===this.root){return false;}
parent=parent.screen;}
return find;};this.export=function(name){alert(I18n.resource.report.NOT_SUPPORT_EXPORT);};this.hasChapterNo=function(){return true;};this.isReadonly=function(){if(this===this.root){return false;}
return this.screen.isChildrenReadonly();};this.destroy=function(){};}.call(Base.prototype);exports.Base=Base;})(namespace('factory.report.components'),namespace('factory.report.components.Component'),DateUtil);;(function(exports,SuperClass,VariableProcessMixin){function Container(){this.children=[];SuperClass.apply(this,arguments);this.entity.modal.option=this.entity.modal.option||{};this.entity.modal.option.layouts=this.entity.modal.option.layouts||[];}
Container.prototype=Object.create(SuperClass.prototype);Container.prototype.constructor=Container;+function(){this.optionTemplate={group:'',name:'I18n.resource.report.REPORT_RIGHT_NAME',minWidth:12,minHeight:6,maxWidth:12,maxHeight:6,spanC:12,spanR:12,type:'Container',className:'chapter-container'};this.init=function(){SuperClass.prototype.init.apply(this,arguments);this.initIoc();this.initDropEvents();};this.initDropEvents=function(){var _this=this;var container=this.wrap;container.ondragenter=function(e){e.preventDefault();e.stopPropagation();var tooltip=document.createElement('div');tooltip.id='divTooltip';document.body.appendChild(tooltip);};container.ondragover=function(e){e.preventDefault();e.stopPropagation();var $divTooltip=$('#divTooltip');if(_this.root.wrap===this){$divTooltip.html('');}else{$divTooltip.html(''+_this.chapterNo);}
if(!$(_this.wrap).children().hasClass('borderHover')){$(_this.wrap).children().addClass('borderHover');}
$divTooltip.css('left',e.clientX-1.5*$('.badge').width());$divTooltip.css('top',e.clientY-$('#header').height());};container.ondragleave=function(e){e.preventDefault();e.stopPropagation();$('#divTooltip').remove();if($(_this.wrap).children().hasClass('borderHover')){$(_this.wrap).children().removeClass('borderHover');}};container.ondrop=function(e){$('#divTooltip').remove();if($(_this.wrap).children().hasClass('borderHover')){$(_this.wrap).children().removeClass('borderHover');}
var type=e.dataTransfer.getData('type');e.stopPropagation();var screen=$(_this.root.wrap);var currentY=e.clientY;var currentX=e.clientX;var insertIndex=_this.targetDom(screen,currentX,currentY);if(type!=='template'){_this.add({modal:{type:type,option:{}}},insertIndex);}
else{Spinner.spin($(_this.root.wrap)[0]);WebAPI.post('/factory/material/getByIds',{ids:[e.dataTransfer.getData('id')]}).done(function(rs){var data=_this.updateTemplateId(rs[0]);_this.addFromTemplate(data,insertIndex);Spinner.stop();});}};};this.targetDom=function($dom,currentX,currentY){if(!$dom||$dom.length===0)return;var $domPaddingTop=parseInt($dom.css('padding-top'));var $domPaddingBottom=parseInt($dom.css('padding-bottom'));var $domPaddingLeft=parseInt($dom.css('padding-left'));var $domPaddingRight=parseInt($dom.css('padding-right'));var $domY=$dom.offset().top;var $domX=$dom.offset().left+$domPaddingLeft;var $domPaddingY=$domPaddingTop+$domPaddingBottom;var $domPaddingX=$domPaddingLeft+$domPaddingRight;if($domY<currentY){if($domY+$dom.height()-$domPaddingY>currentY){if($domX<currentX){if($domX+$dom.width()-$domPaddingX>currentX){return this.targetDom($dom.find('.report-content').eq(0).children().eq(0),currentX,currentY);}else{return this.targetDom($dom.next().eq(0),currentX,currentY);}}else{return $dom.index();}}else{return this.targetDom($dom.next().eq(0),currentX,currentY);}}else{return $dom.index();}};this.updateTemplateId=function(){function replaceId(templateContent){if(templateContent.id){templateContent.id=ObjectId();}
var childrenLayout=templateContent.modal.option.layouts;if(childrenLayout&&childrenLayout.length>0){childrenLayout.forEach(function(row){replaceId(row);});}}
return function(data){var templateContent=data.content.layout;replaceId(templateContent);return templateContent;};}();this.initIoc=function(){this.factoryIoC=new FactoryIoC('report');};this.initResizer=function(){};this.initTools=function(tools){tools=tools||['variable'];SuperClass.prototype.initTools.call(this,tools);};this.add=function(params,idx){var modalClass=this.factoryIoC.getModel(params.modal.type);var options=modalClass.prototype.optionTemplate;var ins;var insertIndex=idx;idx=typeof idx==='undefined'?this.children.length:idx;params.spanC=params.spanC||options.spanC||options.minWidth;params.spanR=params.spanR||options.spanR||options.minHeight;ins=new modalClass(this,params,this.root,insertIndex);this.children.splice(idx,0,ins);this.entity.modal.option.layouts.splice(idx,0,ins.entity);ins.render(true);if(params.modal.type==='ChapterContainer'){this.refreshTitle(this.chapterNo);this.root.refreshSummary();}
return ins;};this.addFromTemplate=function(params,idx){var ins=this.add(params,idx);var tplParams=ins.getTplParams();if(tplParams.length){ins.showConfigModal(exports.ReportTplParamsConfigModal);}};this.remove=function(id){var idx=-1;var removed=null;this.children.some(function(row,i){if(row.entity.id===id){idx=i;return true;}
return false;});if(idx>-1){removed=this.children.splice(idx,1);removed[0].destroy();this.refreshTitle(this.chapterNo);this.root.refreshSummary();this.entity.modal.option.layouts.splice(idx,1);}};this.initLayout=function(layouts){layouts=layouts||this.entity.modal.option.layouts;if(!layouts||!layouts.length)return;try{layouts.forEach(function(layout){var modelClass,ins;var chapterDisplay;var _api;if(!layout.modal.type){return;}
modelClass=this.factoryIoC.getModel(layout.modal.type);if(!modelClass)return;ins=new modelClass(this,layout,this.root);this.children.push(ins);ins.render();}.bind(this));}catch(e){Log.error(e);}};this.resize=function(){this.container.parentNode.style.height='auto';this.children.forEach(function(row){row.resize();});};this.refreshTitle=function(chapterNo,isHideNo){var containerChildren=[],i=0;this.chapterNo=chapterNo=chapterNo||'';containerChildren=this.children.filter(function(row){return row instanceof exports.Container;});chapterNo=chapterNo?chapterNo+'.':chapterNo;containerChildren.forEach(function(row){var num;if(row.hasChapterNo()){num=row.refreshTitle(chapterNo+(i+1),isHideNo);}else{num=row.refreshTitle(chapterNo,isHideNo);}
if(num){i=i+num;}else{i=i+1;}});};this.refreshSummary=function(){var summary=this.getSummary();var list=this.children.concat();var row;while(row=list.shift()){list=list.concat(row.children||[]);if(row instanceof exports.Summary){row.refreshSummary(summary);}}};this.getSummary=function(){var summary=[];this.children.forEach(function(row){if(row instanceof exports.ChapterContainer||row instanceof exports.Block){summary=summary.concat(row.getSummary());}});return summary;};this.getTplParams=function(){var params=SuperClass.prototype.getTplParams.call(this);var tplParams=this.entity.modal.option.tplParams||{};this.children.forEach(function(row){params=params.concat(row.getTplParams());});params=params.sort().filter(function(row,pos,arr){return!pos||row!=arr[pos-1];});params=params.map(function(row){return{name:row,value:tplParams[row]||undefined};});return params;};this.getDeclareVariables=function(){this.entity.modal.variables=this.entity.modal.variables||{};var v;if(this.entity.modal.type.indexOf('Block')>-1){v=[{title:'',val:this.entity.modal.variables}];}else{v=[{title:''+this.chapterNo||''||''+(this.entity.modal.option.chapterTitle||''),val:this.entity.modal.variables}];}
this.children.forEach(function(row){v.push(row.getDeclareVariables()||{title:'',val:{}});});return v;};this.isChildrenReadonly=function(){if(this===this.root){return false;}
return this.screen.isChildrenReadonly();};this.destroy=function(){this.children.forEach(function(row){row.destroy();});this.wrap.parentNode.removeChild(this.wrap);};}.call(Container.prototype);Container.prototype=Mixin(Container.prototype,new VariableProcessMixin());exports.Container=Container;})(namespace('factory.report.components'),namespace('factory.report.components.Base'),namespace('factory.report.mixins.VariableProcessMixin'));;(function(exports,SuperClass){var Spinner=new LoadingSpinner({color:'#00FFFF'});function ReportContainer(){SuperClass.apply(this,arguments);}
ReportContainer.prototype=Object.create(SuperClass.prototype);ReportContainer.prototype.constructor=ReportContainer;+function(){this.optionTemplate=Mixin(this.optionTemplate,{group:'',name:'I18n.resource.report.REPORT_RIGHT_NAME',minWidth:12,minHeight:6,maxWidth:12,maxHeight:6,spanC:12,spanR:12,type:'ReportContainer',className:'root-container'});this.render=function(isProcessTask){this.registVariableProcessTask(this.entity.modal.variables).done(function(variables){this.variables=variables;}.bind(this));if(!this.children.length){this.initLayout();}else{this.children.forEach(function(row){row.render();});}
if(isProcessTask===true){Spinner.spin(document.body);this.processTask().always(function(){this.refreshSummary();Spinner.stop();console.info('phantom - render summary complete');}.bind(this));}
this.refreshTitle();};}.call(ReportContainer.prototype);exports.ReportContainer=ReportContainer;})(namespace('factory.report.components'),namespace('factory.report.components.Container'));;(function(exports,SuperClass){var Spinner=new LoadingSpinner({color:'#00FFFF'});function ChapterContainer(){SuperClass.apply(this,arguments);this.chapterNo=null;this.taskPromise=null;}
ChapterContainer.prototype=Object.create(SuperClass.prototype);ChapterContainer.prototype.constructor=ChapterContainer;+function(){var HtmlAPI=function(){function HtmlAPI(){this.promise=$.Deferred();}
HtmlAPI.prototype.show=function(){this.promise.resolve();};HtmlAPI.prototype.hide=function(){this.promise.reject();};return HtmlAPI;}();this.optionTemplate=Mixin(this.optionTemplate,{name:'I18n.resource.report.optionModal.CHAPTER',type:'ChapterContainer',spanC:12,spanR:4,className:'chapter-container'});this.render=function(isProcessTask){this.taskPromise=this.registVariableProcessTask(this.entity.modal.variables).fail(function(){this.destroy();}.bind(this));if(!this.children.length){this.initLayout();}else{this.children.forEach(function(row){row.render();});}
if(isProcessTask===true){Spinner.spin(document.body);this.root.processTask().always(function(){Spinner.stop();});}};this.initEntity=function(){var options=this.entity.modal.option;if(typeof options.chapterSummary==='undefined'||typeof options.chapterSummary==='string'){options.chapterSummary={html:options.chapterSummary||'',css:'',js:''};}
if(typeof options.chapterDisplay==='undefined'){options.chapterDisplay='';}};this.initTools=function(tools){tools=tools||['export','variable','configure','remove'];SuperClass.prototype.initTools.call(this,tools);};this.refreshTitle=function(){if(AppConfig.isReportConifgMode){return function(chapterNo,isHideNo){var divWrap=this.wrap;var divTitle=divWrap.querySelector('.report-title');var chapterChildren=[];if(!chapterNo){divTitle.innerHTML=(this.chapterNo&&!isHideNo?this._formatChapterNo(this.chapterNo)+' ':'')+(this.entity.modal.option.chapterTitle||'');return;}
divTitle.innerHTML=(chapterNo&&!isHideNo?this._formatChapterNo(chapterNo)+' ':'')+(this.entity.modal.option.chapterTitle||'');SuperClass.prototype.refreshTitle.apply(this,arguments);};}else{return function(chapterNo,isHideNo){var num=chapterNo.split('.').length;var domTitle=document.createElement('h'+num);var $container=$(this.container);domTitle.classList.add('headline');domTitle.id='headline_'+chapterNo.replace(/\./g,'-');domTitle.innerHTML=(chapterNo&&!isHideNo?this._formatChapterNo(chapterNo)+' ':'')+(this.entity.modal.option.chapterTitle||'');$container.children('.headline').remove();$container.prepend(domTitle);$container.addClass('chapter-'+chapterNo.split('.').length);SuperClass.prototype.refreshTitle.apply(this,arguments);};}}();this._formatChapterNo=function(chapterNo){if(chapterNo.indexOf('.')===-1){return I18n.resource.report.chapterConfig.NUMBER+chapterNo+I18n.resource.report.chapterConfig.CHAPTER;}
return chapterNo;};this.initTitle=function(){var divWrap=this.wrap;var divTOP=divWrap.querySelector('.report-top-box');var divTitle=document.createElement('div');divTitle.className='report-title';divTOP.appendChild(divTitle);};this.getSummary=function(){var summary=[];summary.push({variables:this.variables,chapterNo:this.chapterNo,chapterSummary:this.entity.modal.option.chapterSummary||''});summary.push(SuperClass.prototype.getSummary.apply(this,arguments));return[summary];};this.registVariableProcessTask=function(variables){var promise=this.root.registTask(variables,this);return promise.then(function(rs){this.variables=this.createObjectWithChain(rs);return this.isShow();}.bind(this));};this.isShow=function(){var layout=this.entity;var options=layout.modal.option;var _api;if(options){chapterDisplay=layout.modal.option.chapterDisplay;}
if(!AppConfig.isReportConifgMode&&chapterDisplay){_api=new HtmlAPI();new Function('_api','_reportOptions','_variables',chapterDisplay)(_api,this.getReportOptions(),this.variables);return _api.promise;}};this.export=function(name){return WebAPI.post('/factory/material/edit',{_id:ObjectId(),content:{layout:this.entity},creator:AppConfig.userProfile.fullname,group:'',isFolder:0,name:name,time:new Date().format('yyyy-MM-dd HH:mm:ss'),type:'report'});};}.call(ChapterContainer.prototype);exports.ChapterContainer=ChapterContainer;})(namespace('factory.report.components'),namespace('factory.report.components.Container'));;(function(exports,SuperClass,ChartThemeConfig){function Chart(){SuperClass.apply(this,arguments);this.store=null;this.chart=null;}
Chart.prototype=Object.create(SuperClass.prototype);+function(){this.optionTemplate=Mixin(this.optionTemplate,{group:'',name:'I18n.resource.report.optionModal.ECHARTS',minWidth:3,minHeight:2,maxWidth:12,maxHeight:15,type:'Chart'});this.resize=function(){SuperClass.prototype.resize.call(this);if(this.chart){this.__renderChart({animation:false});}};this.__renderChart=function(extendOptions){var rs=this.store;var chartOptions=$.extend(false,this.__getChartOptions(),extendOptions);if(this.chart){this.chart.dispose();}
if(chartOptions.series.length===0){return;}
this.chart=echarts.init(this.container);this.chart.setOption(chartOptions);};this.__getChartOptions=function(){var _this=this;var options;var moduleOptions=this.entity.modal.option;var data=this.store;var legend,series;if(moduleOptions.chartType==='pie'){options=$.extend(true,{},ChartThemeConfig.PIE_CHART_OPTIONS,new Function('return '+this.entity.modal.option.chartOptions)());if(AppConfig.isMobile){$(this.container).closest('.report-container-wrap').css('height','240px');options.legend.data=[];options.title.textStyle.color='#d8d6df';}}else{options=$.extend(true,{},ChartThemeConfig.AXIS_CHART_OPTIONS,new Function('return '+this.entity.modal.option.chartOptions)());if(AppConfig.isMobile&&_this.variables.a){options.xAxis.forEach(function(row){row.data=_this.variables.a.timeShaft;row.axisLabel=row.axisLabel||{};row.axisLabel.rotate=270;delete row.name;row.axisLabel.textStyle=row.axisLabel.textStyle||{};row.axisLabel.textStyle.color='#d8d6df';row.data.textStyle=row.data.textStyle||{};row.data.textStyle.color='#d8d6df';});options.yAxis.forEach(function(row){row.nameTextStyle=row.nameTextStyle||{};row.nameTextStyle.color='#d8d6df';row.axisLabel=row.axisLabel||{};row.axisLabel.textStyle=row.axisLabel.textStyle||{};row.nameLocation='middle';row.axisLabel.textStyle.color='#d8d6df';});options.legend.textStyle=options.legend.textStyle||{};options.title.textStyle.color='#d8d6df';}
options.xAxis.forEach(function(row){if(typeof row.data==='function'){try{row.data=row.data.call(null,data,_this.variables);}catch(e){row.data=[];}}});options.yAxis.forEach(function(row){if(typeof row.data==='function'){try{row.data=row.data.call(null,data,_this.variables);}catch(e){row.data=[];}}});}
if(typeof options.legend.data==='function'){try{options.legend.data=options.legend.data.call(null,data,_this.variables);}catch(e){options.legend.data=[];}}
options.series.forEach(function(row){if(typeof row.data==='function'){try{row.data=row.data.call(null,data,_this.variables);}catch(e){row.data=[];}}});if(moduleOptions.chartType!=='pie'){if(options.series.length===0){series=[];Object.keys(data.list).forEach(function(id){var row=data.list[id];series.push({type:moduleOptions.chartType,data:row.data});});options['xAxis'][0].data=data.timeShaft;options['series']=series;}
if(options.legend.data.length===0){var dsInfo,legend=[];if(moduleOptions.legend&&moduleOptions.legend.length){legend=moduleOptions.legend;moduleOptions.legend.forEach(function(row,i){options['series'][i].name=row;});}else{dsInfo=AppConfig.datasource.getDSItemById(Object.keys(data.list));dsInfo=Array.toMap(dsInfo,'id');Object.keys(data.list).forEach(function(dsId,i){var alias=dsInfo[dsId]?dsInfo[dsId].alias||dsId:dsId;options['series'][i].name=alias;legend.push(alias);});}
options['legend'].data=legend;}}
return options;};this.getTplParams=function(){var str=(this.entity.modal.points||[]).join(',');var pattern=this.TPL_PARAMS_PATTERN;var match=null;var params=SuperClass.prototype.getTplParams.call(this);while(match=pattern.exec(str)){params.push(match[1]);}
return params;};this.render=function(isProcessTask){var promise=$.Deferred();this.registVariableProcessTask(this.getVariables()).done(function(){promise.resolve();}.bind(this));promise.done(function(){var points=this.entity.modal.points;if(!this.entity.modal.points||!this.entity.modal.points.length){this.store={list:{},timeStart:[]};this.__renderChart();}else{var variables=this.variables;var rs={list:{}};for(var key in variables){var row=variables[key];if(key.indexOf('__p')===0){var index=key.slice(3,-2);rs.list[points[index]]={data:row.data,dsItemId:points[index]};if(!rs.timeShaft){rs.timeShaft=row.timeShaft;}}}
if(!rs.list){Log.warn('chart has no data.');return;}
this.store=rs;this.__renderChart();}}.bind(this));if(isProcessTask===true){this.root.processTask();}};this.getVariables=function(){var modal=$.extend(true,{},this.entity.modal);var option=modal.option;var variables=modal.variables;var points=modal.points;if(points){points.forEach(function(row,i){variables['__p'+i+'__']={'descr':option.legend[i],'val':'<%'+row+',tf='+option.timeFormat+'%>'};});}
return variables;};this.__getTplParamsAttachedPoints=function(){var _this=this;var points=this.entity.modal.points;var pattern=this.TPL_PARAMS_PATTERN;var params=this.getTplParamsValue();if(!params||points.length<=0){return points;}else{return points.join(',').replace(pattern,function($0,$1){return params[$1]||'';}).split(',');}};this.destroy=function(){SuperClass.prototype.destroy.apply(this,arguments);if(this.chart){this.chart.dispose();}
this.wrap.parentNode.removeChild(this.wrap);};}.call(Chart.prototype);exports.Chart=Chart;})(namespace('factory.report.components'),namespace('factory.report.components.Base'),namespace('factory.report.config.ChartThemeConfig'));;(function(exports,SuperClass){function Text(){SuperClass.apply(this,arguments);}
Text.prototype=Object.create(SuperClass.prototype);+function(){this.optionTemplate={group:'',name:'I18n.resource.report.optionModal.TEXT',minWidth:3,minHeight:1,maxWidth:12,maxHeight:100,type:'Text',className:'report-module-text'};this.initEntity=function(){var options=this.entity.modal.option;options.text=options.text||'';};this.render=function(isProcessTask){this.registVariableProcessTask(this.entity.modal.variables).done(function(){var options=this.entity.modal.option;if(!options||!options.text){$(this.container).html('');return;}
this.__renderText();}.bind(this));if(isProcessTask===true){this.root.processTask();}};this.__renderText=function(){var options=this.entity.modal.option;this.container.innerHTML=this.__getTplParamsAttachedHtml(options.text);};this.__getTplParamsAttachedHtml=function(code){var pattern=this.TPL_PARAMS_PATTERN;var params=this.getTplParamsValue();var match;params=$.extend(false,{},params,this.variables);code=code.replace(pattern,function($0,$1){if(!params[$1]){return $0;}
return params[$1];});return code;};this.getTplParams=function(){var str=this.entity.modal.option.text;var pattern=this.TPL_PARAMS_PATTERN;var match=null;var params=[];while(match=pattern.exec(str)){params.push(match[1]);}
return params;};this.showConfigModal=function(){var _this=this;var option=this.entity.modal.option;EditorModal.show(option.text,true,function(content){option.text=content;_this.__renderText();});};this.destroy=function(){SuperClass.prototype.destroy.apply(this,arguments);this.wrap.parentNode.removeChild(this.wrap);};}.call(Text.prototype);exports.Text=Text;})(namespace('factory.report.components'),namespace('factory.report.components.Base'));;(function(exports,SuperClass,ChartThemeConfig){function Html(){SuperClass.apply(this,arguments);this.guids=[];}
Html.prototype=Object.create(SuperClass.prototype);function HCAPI(){}
+function(){this.getHistoryData=function(params){return WebAPI.post('/analysis/startWorkspaceDataGenHistogram',params);};this.getChartThemes=function(){return $.extend(true,{},ChartThemeConfig);};}.call(HCAPI.prototype);+function(){this.optionTemplate={group:'',name:'I18n.resource.report.optionModal.HTML',minWidth:3,minHeight:1,maxWidth:12,maxHeight:100,type:'Html',className:'report-module-text'};this.initEntity=function(){var options=this.entity.modal.option;options.html=options.html||'';options.css=options.css||'';options.js=options.js||'';};this.getTemplateAPI=function(){return new HCAPI();};this.initResizer=function(){};this.render=function(isProcessTask){this.registVariableProcessTask(this.entity.modal.variables).done(function(){var options=this.entity.modal.option;var formattedCode,html,guid;if(!options){$(this.container).html('');return;}
guid=ObjectId();this.guids.push(guid);code=this.__getTplParamsAttachedHtml(options);formattedCode=this._getFormattedHtml(code,guid);namespace('__f_hc')[guid]={api:this.getTemplateAPI(),reportOptions:this.getReportOptions(),variables:this.variables};this._runCode(formattedCode);}.bind(this));if(isProcessTask===true){this.root.processTask();}};this._runCode=function(code){this.container.innerHTML=[code.html,code.css].join('\n');(function(code){var done=false;var script=document.createElement("script");var head=document.getElementsByTagName("head")[0];script.type="text\/javascript";script.text=code;head.appendChild(script);head.removeChild(script);})(code.js);};this._getFormattedHtml=function(code,guid){var _this=this;var patternScript=/(<script\b[^>]*>)([\s\S]*?)(<\/script>)/img;var htmlWrapTpl='<div id="hc_'+guid+'">|code|</div>';var jsWrapTpl=function(){return'(function(_data) {'+'var _api = _data.api, _reportOptions = _data.reportOptions, _variables = _data.variables, _container = document.querySelector("#hc_'+guid+'"); if(!_container) {return;}'+'|code|}).call(null, window.__f_hc["'+guid+'"]);';}();var cssWrapTpl='<style>|code|</style>';var formatHtml=code.html.replace(patternScript,function($0,$1,$2,$3){return'';});var formatCss=code.css.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*(?={))/mg,function($0,$1,$2){return'#hc_'+guid+' '+$1;});var formatJs=jsWrapTpl.replace('|code|',code.js);formatCss=cssWrapTpl.replace('|code|',formatCss);formatHtml=htmlWrapTpl.replace('|code|',formatHtml);return{html:formatHtml,css:formatCss,js:formatJs};};this.__getTplParamsAttachedHtml=function(code){var _this=this;var pattern=this.TPL_PARAMS_PATTERN;var params=this.getTplParamsValue();if(!params||Object.keys(params).length===0){return code;}else{return{html:(code.html||'').replace(pattern,function($0,$1){return params[$1];}),js:(code.js||'').replace(pattern,function($0,$1){return params[$1];}),css:(code.css||'').replace(pattern,function($0,$1){return params[$1];})};}};this.getTplParams=function(){var options=this.entity.modal.option;var str=options.html+options.css+options.js;var pattern=this.TPL_PARAMS_PATTERN;var match=null;var params=[];while(match=pattern.exec(str)){params.push(match[1]);}
return params;};this.resize=function(){var ele=this.container.parentNode;ele.style.height='auto';};this.showConfigModal=function(){var _this=this;var option=this.entity.modal.option;CodeEditorModal.show(option,function(code){_this.entity.modal.option.html=code.html;_this.entity.modal.option.js=code.js;_this.entity.modal.option.css=code.css;_this.render(true);});};this.destroy=function(){SuperClass.prototype.destroy.apply(this,arguments);this.guids.forEach(function(guid){namespace('__f_hc')[guid]=null;});this.wrap.parentNode.removeChild(this.wrap);};}.call(Html.prototype);exports.Html=Html;})(namespace('factory.report.components'),namespace('factory.report.components.Base'),namespace('factory.report.config.ChartThemeConfig'));;(function(exports,SuperClass){function Summary(){SuperClass.apply(this,arguments);this.chapterNo=null;options=null;}
Summary.prototype=Object.create(SuperClass.prototype);+function(){var DEFAULTS={showTitle:true};this.optionTemplate=Mixin(this.optionTemplate,{name:'I18n.resource.report.optionModal.SUMMARY',type:'Summary',spanC:12,spanR:4,className:'report-summary-container'});this.initTools=function(tools){tools=tools||['remove'];SuperClass.prototype.initTools.call(this,tools);};this.refreshSummary=function(){var options,_this;function recursion(data,deep){if(!data)return;data.forEach(function(row){var chapterNo=row[0].chapterNo;var chapterSummary=row[0].chapterSummary;var guid=ObjectId();var formattedCode;if(!chapterSummary||!chapterSummary.html&&!chapterSummary.js&&!chapterSummary.css){recursion(row[1],deep);return;}
formattedCode=_this._getFormattedHtml(chapterSummary,guid);if(formattedCode.html!==''||formattedCode.css!==''||formattedCode.js!==''){options.html+='<div data-deep="'+deep+'" data-chapter-no="'+chapterNo+'" class="chapter-summary-wrap" style="margin-top:5px; margin-left:'+(30+20*deep)+'px;">'+formattedCode.html+'</div>';options.css+=formattedCode.css;options.js+=formattedCode.js;_this.guids.push(guid);namespace('__f_hc')[guid]={variables:row[0].variables,api:_this.getTemplateAPI(),reportOptions:_this.getReportOptions()};}
recursion(row[1],deep+1);});}
return function(summary,opt){_this=this;arrHtml=[];opt=$.extend(false,{},DEFAULTS,opt);options={html:opt.showTitle?'<h1>'+I18n.resource.report.optionModal.SUMMARY+'</h1>':'',css:'',js:''};if(summary){recursion(summary,0);this._runCode(options);}};}();this.render=function(){};}.call(Summary.prototype);exports.Summary=Summary;})(namespace('factory.report.components'),namespace('factory.report.components.Html'));;(function(exports,SuperClass){function Block(){SuperClass.apply(this,arguments);this.store=null;}
Block.prototype=Object.create(SuperClass.prototype);Block.prototype.constructor=Block;+function(){this.optionTemplate=Mixin(this.optionTemplate,{name:'I18n.resource.report.optionModal.BLOCK',type:'Block',spanC:12,spanR:4,className:'block-container'});this.initEntity=function(){var options=this.entity.modal.option;if(typeof options.dataId==='undefined'){options.dataId='';}};this.initTools=function(tools){tools=tools||['variable','configure','remove'];SuperClass.prototype.initTools.call(this,tools);};this.initDropEvents=function(){};this.render=function(isProcessTask){var _this=this;var promise=$.Deferred();var dataId=this.entity.modal.option.dataId;while(row=_this.children.pop()){row.destroy();}
if(!dataId||dataId==='-1'){return;}
var url;if(this.entity.modal.option.findType==='name'){url='/factory/reportDataByName?name='+encodeURI(dataId)+'&date='+this.transformToSupportingDateFormat(this.getReportDate());}else{url='/factory/reportData/'+dataId+'/'+this.transformToSupportingDateFormat(this.getReportDate());}
$.ajax({type:'get',url:url,contentType:'application/json',async:false}).done(function(rs){var row;if(rs.status!=='OK'){if(AppConfig.isReportConifgMode){alert(rs.msg);return;}else{_this.showNoData();return;}}
$(_this.container).html("");_this.store=_this.formatBlockData(rs.data);_this.initLayout(_this.store||[]);if(isProcessTask===true){_this.root.processTask();}
_this.root.refreshTitle();_this.root.refreshSummary();});};this.transformToSupportingDateFormat=function(dateStr){return dateStr.toDate().format('yyyy-MM-dd');};this.showNoData=function(){var str='<div style="margin: 0 auto;width: 500px;height: 160px;margin-top:200px;">\
                            <img src="/static/images/project_img/report.png" alt="report">\
                            <div style="display:inline-block;margin-left:50px;"><p><strong i18n="observer.reportScreen.REPORT_FAIL_INFO"></strong></p></div>\
                        </div>';$(this.container).html(str);};this.formatBlockData=function(data){return JSON.parse(data.content);};this.refreshTitle=function(chapterNo,isHideNo){var containerChildren=[],i=0;containerChildren=this.children.filter(function(row){return row instanceof exports.Container;});chapterNo=chapterNo?chapterNo+'.':chapterNo;containerChildren.forEach(function(row){var num=row.refreshTitle(chapterNo+(i+1),isHideNo);if(num){i=i+num;}else{i=i+1;}});return i;};this.hasChapterNo=function(){return false;};this.isChildrenReadonly=function(){return true;};}.call(Block.prototype);exports.Block=Block;})(namespace('factory.report.components'),namespace('factory.report.components.Container'));;(function(exports,SuperClass){function Table(){SuperClass.apply(this,arguments);this.store=null;}
Table.prototype=Object.create(SuperClass.prototype);+function(){this.constructor=Table;this.optionTemplate=Mixin(this.optionTemplate,{group:'',name:'I18n.resource.report.optionModal.TABLE',minWidth:6,minHeight:5,maxWidth:12,maxHeight:15,type:'Table'});this.render=function(){var $table=$('<table></table>');var $thead=$('<thead></thead>');var $tbody=$('<tbody></tbody>');var option=this.entity.modal.option;var strTbody='',strThead='';$(this.container).empty();if($.isEmptyObject(option))return;if(option.isSwap){strThead='<th>Time</th>';for(var i=0;i<option.dataSrc.length;i++){strThead+='<th>'+option.dataSrc[i].title+'</th>';}
$thead.append('<tr>'+strThead+'</tr>');this.getData(option,function(result){if(result.timeShaft&&result.timeShaft.length>0){var listLen=result.list.length;var list=result.list;result.timeShaft.forEach(function(time,index){var strTd='';for(var m=0;m<listLen;m++){strTd+='<td>'+list[m].data[index]+'</td>';}
strTbody+='<tr><td>'+getFormatTime(time,option.interval)+'</td>'+strTd+'</tr>';});}
$tbody.append(strTbody);});}else{this.getData(option,function(result){strThead='<th>Time</th>';for(var i=0;i<result.timeShaft.length;i++){strThead+='<th>'+getFormatTime(result.timeShaft[i],option.interval)+'</th>';}
$thead.append('<tr>'+strThead+'</tr>');for(var i=0,list;i<option.dataSrc.length;i++){var strTd='';list=function(list,id){for(var k=0;k<list.length;k++){if(list[k].dsItemId==id){return list[k];}}}(result.list,option.dataSrc[i].dsId);for(var j=0;j<list.data.length;j++){strTd+='<td>'+list.data[j]+'</td>';}
strTbody+='<tr><td>'+option.dataSrc[i].title+'</td>'+strTd+'</tr>';}
$tbody.append(strTbody);});}
$table.append($thead).append($tbody);$(this.container).css({overflow:'auto'}).append($table);function getFormatTime(time,interval){var formatTime='';switch(interval){case'm5':case'h1':formatTime=time.replace(/^\d{4}-/,'').replace(/:\d{2}$/,'');break;case'd1':case'd7':formatTime=time.replace(/^\d{4}-/,'').replace(/\d{2}:\d{2}:\d{2}/,'');break;}
return formatTime;}};this.initTools=function(tools){tools=tools||['configure','remove'];SuperClass.prototype.initTools.call(this,tools);};this.destroy=function(){};this.getData=function(params,callback){Spinner.spin(this.container);var postData={dsItemIds:function(arrdataSrc){var arr=[];arrdataSrc.forEach(function(i){i.dsId&&arr.push(i.dsId);});return arr;}(params.dataSrc)};if(params.y=='default'){var options=this.getReportOptions();postData.timeStart=options.startTime;postData.timeEnd=options.endTime;postData.timeFormat=params.interval?params.interval:options.timeFormat;}else{postData.timeStart=new Date(params.start).format('yyyy-MM-dd HH:mm:ss');postData.timeEnd=new Date(params.end).format('yyyy-MM-dd HH:mm:ss');postData.timeFormat=params.interval;}
WebAPI.post('/analysis/startWorkspaceDataGenHistogram',postData).done(function(result){if(result&&result.timeShaft){callback(result);}}).always(function(){Spinner.stop();});};}.call(Table.prototype);exports.Table=Table;})(namespace('factory.report.components'),namespace('factory.report.components.Base'));(function(){var _this;var Spinner=new LoadingSpinner({color:'#00FFFF'});function EnergyScreen(options,container){_this=this;this.options=options;this.windowCtn=function(container){if(typeof container==='string'){return document.querySelector('#'+container);}else if(container instanceof HTMLElement){return container;}else{return null;}}(container);this.dataSourcePanelCtn=null;this.modulePanelCtn=null;this.container=null;this.$pageNav=null;this.store={};this.listEntity=[];this.arrEntityOrder=[];this.mapRefresh={};this.popRefresh={};this.requestPoints=[];this.dictPopToEntity={};this.paneDatasource=null;this.workerUpdate=null;}
EnergyScreen.prototype.htmlUrl='/static/app/WebFactory/views/energyScreen.html';EnergyScreen.prototype.show=function(){var _this=this;return WebAPI.get(this.htmlUrl).then(function(html){_this.windowCtn.innerHTML='';_this.initLayout(html);return _this.init();});};EnergyScreen.prototype.getPageData=function(){Spinner.spin(this.windowCtn);var material;if($('#hidPageInfo').length>0){material=JSON.parse($('#hidPageInfo').val()).material;}
if(material===1){return WebAPI.post("/factory/material/getByIds",{'ids':[this.options.id]}).always(function(e){Spinner.stop();});}else{return WebAPI.get("/spring/get/"+this.options.id+'/'+AppConfig.isFactory).always(function(e){Spinner.stop();});}};EnergyScreen.prototype.init=function(){var promise=this.getPageData();AppConfig.datasource=new DataSource(_this);return promise.done(function(rs){var material;if($('#hidPageInfo').length>0){material=JSON.parse($('#hidPageInfo').val()).material;}
if(material===1){rs[0].content.layout=[[rs[0].content.layout]];this.store=rs[0].content;}else{this.store=rs;}
this.initIoc();this.initModuleLayout();this.initWorkerForUpdating();this.attachEvents();}.bind(this));};EnergyScreen.prototype.attachEvents=function(){};EnergyScreen.prototype.initIoc=function(){this.factoryIoC=new FactoryIoC('dashboard');};EnergyScreen.prototype.initLayout=function(html){this.initLayoutDOM(html);};EnergyScreen.prototype.initLayoutDOM=function(html){var divMain,stCt;divMain=document.createElement('div');divMain.className='indexContent st-pusher';divMain.innerHTML=html;stCt=$('<div id="st-container" class="st-container">')[0];stCt.appendChild(divMain);this.windowCtn.appendChild(stCt);this.container=divMain.querySelector('#paneCenter');this.$container=$(_this.container);};EnergyScreen.prototype.initWorkerForUpdating=function(){this.workerUpdate=new Worker("/static/views/js/worker/workerUpdate.js");this.workerUpdate.self=this;this.workerUpdate.addEventListener("message",this.refreshData,true);this.workerUpdate.addEventListener("error",function(e){console.log(e);},true);this.workerUpdate.postMessage({pointList:this.requestPoints,type:"datasourceRealtime"});};EnergyScreen.prototype.initModuleLayout=function(){if(this.options.isForMobile)this.$container.addClass('forMobile');if(!(this.store&&this.store.layout))return;for(var i=0,item;i<this.store.layout.length;i++){for(var j=0;j<this.store.layout[i].length;j++){item=this.store.layout[i][j];var modelClass,entity;if(item.modal.type&&(item.modal.type!='ModalNone'||item.isNotRender==true)){modelClass=this.factoryIoC.getModel(item.modal.type);if(!modelClass)continue;if(item.isNotRender)continue;entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);if(item.modal.type=='ModalAppButton'){entity.render();continue;}
if(item.modal.interval&&item.modal.interval>=0){for(var k=0,point,kLen=item.modal.points.length;k<kLen;k++){point=item.modal.points[k];if(this.requestPoints.indexOf(point)<0){this.requestPoints.push(point);}}}
entity.render();}else if(item.modal.type=='ModalNone'){modelClass=this.factoryIoC.getModel(item.modal.type);entity=new modelClass(this,item);this.listEntity[item.id]=entity;this.arrEntityOrder.push(item.id);entity.render();}}}
var $springCtn=$('#paneCenter').children('.springContainer');if($springCtn.length==1&&parseFloat($springCtn[0].style.height)>=parseFloat("99%")&&parseFloat($springCtn[0].style.width)>=parseFloat("99%")){$springCtn.children('.panel-default').css({border:'none',left:0,top:0,width:'100%',height:'100%'});}};EnergyScreen.prototype.refreshData=function(e){var _this=this.self?this.self:this;if(!e.data.error&&e.data.dsItemList){var point;for(var i=0,iLen=e.data.dsItemList.length;i<iLen;i++){point=e.data.dsItemList[i];_this.mapRefresh[point.dsItemId]=point;if(_this.dictPopToEntity[point.dsItemId]){_this.popRefresh[point.dsItemId]=point;}}
var entity,arrUpdataData;for(var key in _this.listEntity){entity=_this.listEntity[key];if(entity.entity.modal.type=="ModalNone"||entity.entity.modal.type=="ModalMix")continue;arrUpdataData=[];if(entity.entity.modal&&entity.entity.modal.points){for(var i=0,iLen=entity.entity.modal.points.length;i<iLen;i++){var point=entity.entity.modal.points[i];if(!point)continue;if(entity.entity.modal.points.indexOf(point)!=i)continue;if(_this.mapRefresh[point]!=undefined)arrUpdataData.push(_this.mapRefresh[point]);}
if(entity.entity.modal.type=="ModalAppGauge"){arrUpdataData.push({'guageTitle':entity.entity.modal.option.guageTitle,'guageFulTitle':entity.entity.modal.option.guageFulTitle,'guageFixed':entity.entity.modal.option.guageFixed,'guageUnit':entity.entity.modal.option.guageUnit,'timeLocal':entity.entity.modal.option.timeLocal,'guageDirect':entity.entity.modal.option.guageDirect,'guageBgColor':entity.entity.modal.option.guageBgColor,'transDataDot':entity.entity.modal.option.transDataDot});}
entity.update(arrUpdataData);}}}else{}},EnergyScreen.prototype.close=function(){$('.datetimepicker').remove();this.listEntity.forEach(function(row){row.close();});if(this.workerUpdate){this.workerUpdate.terminate();this.workerUpdate=null;}
if(this.windowCtn){this.windowCtn.innerHTML='';this.windowCtn=null;}
this.store=null;this.listEntity=null;this.arrEntityOrder=null;this.dsInfolist=null;this.mapRefresh=null;this.requestPoints=null;this.dictPopToEntity=null;};namespace('observer.screens').EnergyScreen=EnergyScreen;})();;(function(exports,SuperClass){function FacReportScreen(options,container){SuperClass.apply(this,arguments);this.reportDate=options.date;}
FacReportScreen.prototype=Object.create(SuperClass.prototype);+function(){this.htmlUrl='/static/app/WebFactory/views/reportScreen.html';this.initIoc=function(){this.factoryIoC=new FactoryIoC('report');};this.initLayoutDOM=function(html){var domCtn;var divMain,stCt;this.windowCtn.innerHTML=html;this.windowCtn.classList.add('report-wrap','gray-scollbar');this.container=this.windowCtn.querySelector('#reportWrap');this.$container=$(this.container);this.container.classList.remove('report');this.container.classList.add('report-ob');};this.initWorkerForUpdating=function(){};this.initModuleLayout=function(type){var layouts=this.store.layout[0]||[];var options,Clazz;if(!type||type==='Container'){type='ReportContainer';}
Clazz=namespace('factory.report.components')[type];if(layouts.length===1&&['Container','ReportContainer'].indexOf(layouts[0].modal.type)>-1){options=layouts[0].modal.option;}else{options={layouts:layouts,period:'day'};}
this.reportEntity=new Clazz(this,{spanC:12,spanR:6,modal:{option:$.extend(false,options,{period:this.options.period}),type:type}});this.reportEntity.render(true);};this.setReportDate=function(date){this.reportDate=date;this.reportEntity.render(true);};this.resize=function(){this.reportEntity.resize();};this.close=function(){this.reportEntity.destroy();this.windowCtn.classList.remove('report-wrap','gray-scollbar');SuperClass.prototype.close.apply(this,arguments);};}.call(FacReportScreen.prototype);exports.FacReportScreen=FacReportScreen;})(namespace('observer.screens'),namespace('observer.screens.EnergyScreen'));var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};;(function(exports){function ReportAPI(){}
+function(){this.renderReport=function(container,reportId,chapterId,options){var _this=this;if(arguments.length===3){if((typeof chapterId==='undefined'?'undefined':_typeof(chapterId))==='object'){options=chapterId;chapterId=null;}}
options=options||{};return WebAPI.get("/spring/get/"+reportId+'/'+AppConfig.isFactory).then(function(rs){var layouts=rs.layout[0];var layout,modal,match;var ins;var period;if(layouts[0]){period=layouts[0].modal.option.period;}else{Log.error('');return;}
if(!chapterId){match=layouts[0];}else{while(layout=layouts.shift()){modal=layout.modal;if(!modal.option.layouts){continue;}
if(layout.id===chapterId){match=layout;break;}
layouts=layouts.concat(modal.option.layouts);}}
if(!match){Log.error('/');return;}
container.innerHTML='';container.classList.add('report-ob','report-wrap','report-ref-external');return function(container,data,period,options){var Clazz;var report;var promise=$.Deferred();var entity;if(options.onlySummary){Clazz=namespace('factory.report.components')['CustomSummary'];entity={spanC:12,spanR:6,modal:{option:{},type:'CustomSummary'}};promise.resolve();}else{Clazz=namespace('factory.report.components')[data.modal.type];entity=data;promise.reject();}
entity.modal.option.period=period||'day';report=new Clazz({container:container,reportDate:options.date},entity);return promise.then(function(){var summary=[];var o=null;if(data.modal.type==='ChapterContainer'){o={variables:{},chapterNo:'',chapterSummary:data.modal.option.chapterSummary,screen:{}};summary=[[o,[]]];report.registTask(data.modal.variables,o).done(function(rs){o.variables=report._createObjectWithChain(rs,o.screen.variables);});}
else{summary=report.getSummaryFromData(data);}
return report.processTask().then(function(){report.refreshSummary(summary,{showTitle:false});return report;});},function(){report.render(true);return report;});}(container,match,period,options);});};}.call(ReportAPI.prototype);exports.report=new ReportAPI();})(namespace('api'));;(function(exports,FacReportScreen){var Spinner=new LoadingSpinner({color:'#00FFFF'});var ie=navigator.userAgent.match(/MSIE\s([\d.]+)/);var ie11=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/);var ieEDGE=navigator.userAgent.match(/Edge/g);var ieVer=ie?ie[1]:ie11?11:ieEDGE?12:-1;function FacReportWrapScreen(options,container){this.container=function(container){if(typeof container==='string'){return document.querySelector('#'+container);}else if(container instanceof HTMLElement){return container;}else{return null;}}(container);this.container.innerHTML='';this.options=options;this.store=null;this.row=null;this.leftCtn=null;this.centerCtn=null;this.rightCtn=null;this.report=null;}
+function(){this.show=function(){Spinner.spin(document.body);this.container.classList.add('scrollable-y','gray-scrollbar');WebAPI.get('/factory/reportWrap/'+[AppConfig.isFactory,this.options.id].join('/')).done(function(rs){this.store=rs;this.init();}.bind(this)).always(function(){Spinner.stop();});};this.init=function(){var reportWrap,hash,dataArr,idx=0,$eles;this.initLayoutDOM();this.attachEvents();reportWrap=document.querySelector("#centerCtn");this.setTreeOptions({container:reportWrap});if(typeof this.options.default!=='undefined'){idx=this.options.default-0;}else{hash=window.location.hash;if(hash&&hash.indexOf("response=")>-1){dataArr=hash.split("&");for(var i=0,len=dataArr.length;i<len;i++){if(dataArr[i].indexOf("response=")!==-1){idx=dataArr[i].split("=")[1]-1;break;}}}}
$eles=this.leftCtn.find('.report-item');idx=Math.min(Math.max(0,idx),$eles.length-1);$eles.eq(idx).trigger('click');};this.attachEvents=function(){var _this=this;var leftCtnTopDivs=$('.leftCtnTop').find("div");$('.reportListName').hover(function(){$(this).find(".report-item").addClass("in");$(this).find("span.copyUrl").show().attr("title",I18n.resource.report.chartConfig.COPY_LINK);},function(){$(this).find(".report-item").removeClass("in");$(this).find("span.copyUrl").hide();});this.leftCtn.on('click','.report-item',function(){var period;var $iptDate;var options,date,now;_this.destroyTree();$('.report-item').removeClass("selected");if($(this).siblings("img").attr("src")=="/static/app/WebFactory/themes/default/images/down.svg"){$(this).siblings("img").attr("src","/static/app/WebFactory/themes/default/images/left.svg");}else{$(".report-item").siblings("img").attr("src","/static/app/WebFactory/themes/default/images/left.svg");$(this).siblings("img").attr("src","/static/app/WebFactory/themes/default/images/down.svg");$(this).addClass("selected");$("<div>").addClass("navTree").appendTo($(this).parent());period=this.getAttribute('data-period');$iptDate=$(".form_datetime");now=new Date();switch(period){case'day':date=new Date(now.valueOf()-86400000).format('yyyy-MM-dd');$iptDate.val(date);options={format:'yyyy-mm-dd',minView:'month',startView:'month'};break;case'week':var weekDay=now.getDay()===0?13:7+(now.getDay()-1);date=new Date(now.valueOf()-86400000*weekDay);date=date.format('yyyy-MM-dd');$iptDate.val(date);options={format:'yyyy-mm-dd',minView:'month',startView:'month'};break;case'month':date=new Date(now.valueOf()-now.getDate()*86400000).format('yyyy-MM');$iptDate.val(date);options={format:'yyyy-mm',minView:'year',startView:'year'};break;case'year':date=new Date(new Date(now.getFullYear()+'').valueOf()-86400000).format('yyyy');$iptDate.val(date);options={format:'yyyy',minView:'decade',startView:'decade'};break;}
$iptDate.datetimepicker('remove');window.setTimeout(function(){$iptDate.datetimepicker($.extend(false,options,{autoclose:true,endDate:function(){var date=new Date().format('yyyy-MM-dd');return date;}()}));},0);_this._showReport(this.getAttribute('data-id'),period,date).always(function(){_this.renderTree();});}});$(".reportListName").off("click.arrow").on("click.arrow",".arrow",function(){$(this).siblings(".report-item").trigger("click");});$(".reportListName").off("click.copyUrl").on("click.copyUrl",".copyUrl",function(){var reportChaptId=$(this).siblings(".report-item").attr("data-id");var isFactory=window.location.href.indexOf("factory")===-1?0:1;var input=document.createElement('textarea');var successful;document.body.appendChild(input);input.value=window.location.origin+'/factory/preview/report/'+reportChaptId+'/'+AppConfig.isFactory+'?projectId='+(AppConfig.projectId||'');input.focus();input.select();successful=document.execCommand('Copy');input.remove();if(successful){alert(I18n.resource.report.chartConfig.COPY_LINK_SUCCESS);}else{alert(I18n.resource.report.chartConfig.COPY_LINK_FAILED);}});$('.form_datetime').off('changeDate').on('changeDate',function(ev){if(!_this.report)return;Spinner.spin(document.body);window.setTimeout(function(){_this.report.setReportDate(this.value);Spinner.stop();}.bind(this),0);});$('.pdfDownCtn').off('click').on('click',function(){if(!_this.report){return;}
var checkReportId=_this.report.options.id;for(var j=0;j<_this.store.list.length;j++){if(_this.store.list[j].reportId===checkReportId){var reportTitle=_this.store.list[j].reportName;var period=_this.store.list[j].period;var reportPeriod;switch(period){case'day':reportPeriod="";break;case'month':reportPeriod="";break;case'year':reportPeriod="";break;}
break;}}
var arrHtml=[];arrHtml.push($('#centerCtn').html());var promise;Spinner.spin(document.body);var allEchartsArr=Array.prototype.map.call($('[_echarts_instance_]'),function(row){return echarts.getInstanceByDom(row);});var allEchartsDom=$('[_echarts_instance_]');for(var i=0,len=allEchartsArr.length;i<len;i++){var echartsId=allEchartsArr[i].id;var echartsDom=allEchartsDom.filter('div[_echarts_instance_ = '+echartsId+']');var echartsHtml=echartsDom.html();var imgWidth=210*(echartsDom.width()/$('#centerCtn').width());var imgUrl=allEchartsArr[i].getDataURL({backgroundColor:'#fff'});var img;if(imgUrl){img='<img src="'+imgUrl+'" style=" width:'+imgWidth+'mm;"/>';}else{img='<h4 style="width:'+imgWidth+'px; height: 20px;">This chart has no data.</h4>';}
arrHtml[0]=arrHtml[0].replace(echartsHtml,img);}
promise=WebAPI.get('/static/views/share/reportWrap/pdfTemplate.html');promise.done(function(html){var xhr,formData;html=html.formatEL({cover:BEOPUtil.getProjectImgByType(AppConfig.projectId,BEOPUtil.projectImgType.pdfCover),title:reportTitle,encoding:'UTF-8',entitiesHtml:arrHtml[0],logo:BEOPUtil.getProjectImgByType(AppConfig.projectId,BEOPUtil.projectImgType.logo)});formData=new FormData();formData.append('html',html);formData.append('skin','default');xhr=new XMLHttpRequest();xhr.open('POST','/admin/getShareReportWrapPDF');xhr.responseType='arraybuffer';xhr.onload=function(){var blob,url,lkPdfFile;if(this.status===200){blob=new Blob([xhr.response],{type:"application/pdf"});if(ie&&ieVer<10){console.warn("No blobs on IE ver<10");return;}
if(ieVer>-1){window.navigator.msSaveBlob(blob,reportTitle+' '+$('.calendarCtn').children('input').val()+' '+reportPeriod+'.pdf');}else{url=URL.createObjectURL(blob);lkPdfFile=document.createElement('a');lkPdfFile.style="display: none";lkPdfFile.id="lkPdfFile";lkPdfFile.href=url;lkPdfFile.download=reportTitle+' '+$('.calendarCtn').children('input').val()+' '+reportPeriod+'.pdf';document.body.appendChild(lkPdfFile);lkPdfFile.click();window.URL.revokeObjectURL(url);window.setTimeout(function(){lkPdfFile.parentNode.removeChild(lkPdfFile);},0);}}else{alert('Generate report failed, please try it again soon!');}
Spinner.stop();};xhr.send(formData);}).fail(function(e){throw e;});});};this._showReport=function(reportId,period,date){if(this.report){this.report.close();}
this.report=new FacReportScreen({id:reportId,period:period,date:date},this.centerCtn.children('div')[1]);return this.report.show();};this.initLayoutDOM=function(){$(this.container).removeClass("scrollable-y gray-scrollbar");this.row=$('<div class="reportContainer">').addClass("scrollable-y gray-scrollbar").css({"width":"100%",height:"100%"});this.row.appendTo(this.container);var link=window.location.href;if(link.indexOf("externalChainPage")!==-1){this.leftCtn=$('<div id="leftCtn" class="externalChainStyle"></div>');}else{this.leftCtn=$('<div id="leftCtn"></div>');}
this.leftCtn.appendTo(this.row);this.getReportList();this.centerCtn=$('<div id="centerCtn"><div class="top"></div><div class="center"></div></div>');this.centerCtn.appendTo(this.row);this.centerCtnCon();};this.getReportList=function(){var arrHtml=['<div class="leftCtnTop"></div>','<ul class="repotChapList">'];for(var i=0,row,len=this.store.list.length;i<len;i++){row=this.store.list[i];arrHtml.push('<li title="'+row.reportName+'" class="reportListName"><img class="arrow" src="/static/app/WebFactory/themes/default/images/left.svg"><span class="copyUrl"></span><a href="javascript:;" class="report-item" data-id="'+row.reportId+'" data-period="'+row.period+'">'+row.reportName+'</a></li>');}
arrHtml.push('</ul>');return this.leftCtn.html(arrHtml.join(''));};this.centerCtnCon=function(){var pdfDownCtn=$('<div class="pdfDownCtn in"></div>');var pdfDownCon='<span class="pdf_text">Download PDF</span>';pdfDownCtn.html(pdfDownCon);pdfDownCtn.appendTo($(".leftCtnTop"));var newDate=new Date().format("yyyy-MM-dd");var calendarCtn=$('<div class="calendarCtn"></div>');calendarCtn.html('<input type="text" value="'+newDate+'" readonly class="form_datetime calendar_date">');calendarCtn.appendTo($(".leftCtnTop"));$(".form_datetime").datetimepicker({format:'yyyy-mm-dd',minView:'month',autoclose:true});};+function(){var DEFAULT_TREE_OPTIONS={container:document.body};this.optionsArr=[];this.treeOptions={};this.option={};this.setTreeOptions=function(options){this.treeOptions=$.extend(false,DEFAULT_TREE_OPTIONS,options);};this.renderTree=function(){var _this=this;var container=this.treeOptions.container;var $headline=$(container).find(".headline");var navTreeArr=['<ul>'];Array.prototype.forEach.call($headline,function(row){var id=row.id;var title=row.innerHTML;var level=id.split('_')[1].split('-').length;navTreeArr.push('<li><a href="#'+id+'" title="'+title+'" class="col-xs-offset-'+(level-1)+' ">'+title+'</a></li>');});navTreeArr.push("</ul>");$(".navTree").html(navTreeArr.join(''));$('.navTree').find("li").hover(function(){$(this).addClass("in");},function(){$(this).removeClass("in");});$('.navTree').find("li").click(function(){$('.navTree').find("li").removeClass("selected");$(this).addClass("selected");});};this.destroyTree=function(){$(".navTree").empty().remove();};}.call(this);this.close=function(){if(this.report){this.report.close();}
this.store=null;this.row=null;this.leftCtn=null;this.centerCtn=null;this.rightCtn=null;this.container.innerHTML='';this.container.classList.remove('scrollable-y','gray-scrollbar');};}.call(FacReportWrapScreen.prototype);exports.FacReportWrapScreen=FacReportWrapScreen;})(namespace('observer.screens'),namespace('observer.screens.FacReportScreen'));