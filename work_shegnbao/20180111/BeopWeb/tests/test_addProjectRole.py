import pytestfrom beopWeb.mod_admin import controllersfrom beopWeb.mod_admin.FavoriteProject import FavoriteProjectfrom beopWeb.mod_admin.ProjectPermission import ProjectPermissionimport jsonuserId=2265global roleIdprojectId=687roleName="RNB研发"@pytest.mark.p0@pytest.mark.usefixtures("deleteRecord")@pytest.mark.parametrize(('rq_data'), [    ({"roleName":roleName,"userId":userId,"projectId":projectId}),])def test_addProjectRole(rq_data):    rt = controllers.do_add_project_role(rq_data)    rt=json.loads(bytes.decode(rt.data))    assert rt.get('success'),'add_project_role fail'    userRole_data = ProjectPermission.get_project_role(userId, "projectId", "projectName","roleId","roleName")    userRole_data=[ud for ud in userRole_data if ud.get("roleName")==rq_data['roleName'] and ud.get("projectId")==rq_data["projectId"]]    assert userRole_data,'add role user fail ,expected = {0} is not in user_role table'.format(rq_data)    global roleId    roleId= userRole_data[0].get("roleId")@pytest.fixture(scope='function')def deleteRecord(request):    def fin():        global roleId        controllers.do_delete_role_user({"roleId":roleId,"userId":userId})        controllers.do_delete_project_role({"roleId":roleId,"userId":userId,"projectId":projectId})    request.addfinalizer(fin)