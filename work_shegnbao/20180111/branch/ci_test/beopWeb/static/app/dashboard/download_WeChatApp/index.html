<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BeOP</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        .container {
            margin: 0;
            padding: 0;
        }
        
        #content {
            background: url(./images/background.jpg) no-repeat;
        }
        
        #languageSelectBox {
            width: 100%;
            height: 54%;
        }
        
        #languageSelectBox select {
            position: absolute;
            top: 2em;
            right: 2em;
            border: solid 1px rgb(153, 153, 153);
            border-radius: 2px;
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
            background: transparent;
            padding-top: 2px;
            padding-bottom: 2px;
            padding-right: 18px;
            padding-left: 18px;
            color: rgb(153, 153, 153);
        }
        
        #languageSelectBox select::-ms-expand {
            display: none;
        }
        
        #languageSelectBox option {
            background-color: transparent !important;
            background: no-repeat transparent !important;
            appearance: none !important;
            -moz-appearance: none;
            -webkit-appearance: none;
        }
        
        #iosDownload {
            width: 100%;
            height: 9%;
        }
        
        #apkDownload {
            width: 100%;
            height: 9%;
        }
        #versionTip {
            color: white;
            position: absolute;
            width: 100%;
            text-align: center;
            top: 45%;
        }
    </style>
</head>

<body>
    <div class="container">
        <div id="content">
            <div id="languageSelectBox">
                <select name="" id="languageSelect">
                <option value="zh">中 文</option>
                <option value="en">English</option>
                </select>

            </div>
            <div id="versionTip"><span class="tip">最新版本：</span><span id="lastVersion"></span></div>
            <div id="iosDownload"></div>
            <div id="apkDownload"></div>
        </div>
    </div>
</body>
<script src='https://cdn.bootcss.com/jquery/3.2.1/jquery.js'></script>
<script>
    var $content = $('#content')
    var $languageSelect = $('#languageSelect');
    var $apkDownload = $('#apkDownload');
    var $iosDownload = $('#iosDownload');
    var languageWechat;
    //中文、英文默认
    var $versionTip = $('#versionTip .tip');
    if (navigator.language.toLocaleLowerCase() == "zh-cn") {
        $content.css({ 'background': 'url(./images/backgroundZh.jpg) no-repeat' })
        $languageSelect[0].value = 'zh';
        languageWechat = 'weChatTipZh.png'
        $versionTip[0].innerHTML = '最新版本：'
    } else {
        $content.css({ 'background': "url(./images/backgroundEn.jpg) no-repeat" })
        $languageSelect[0].value = 'en';
        languageWechat = 'weChatTipEn.png';
        $versionTip[0].innerHTML = 'Last Version：'
    }
    aotoChangeBackground('content');
    //自适应
    window.onresize = function () {
        aotoChangeBackground('content');
    }
    //背景铺满浏览器屏幕
    function aotoChangeBackground(element) {
        var offsetWidth = document.documentElement.clientWidth;
        var offsetHeight = document.documentElement.clientHeight;
        var content = document.getElementById(element);
        content.style.width = offsetWidth + 'px';
        content.style.height = offsetHeight + 'px';
        content.style.backgroundSize = offsetWidth + 'px ' + offsetHeight + 'px'
    }
    //中英切换
    $languageSelect.change(function (e) {
        if (e.target.value == 'en') {
            $content.css({ 'background': "url(./images/backgroundEn.jpg) no-repeat" })
            aotoChangeBackground('content');
            aotoChangeBackground('content');
            $versionTip[0].innerHTML = 'Last Version：'
        } else {
            $content.css({ 'background': 'url(./images/backgroundZh.jpg) no-repeat' })
            aotoChangeBackground('content');
            $versionTip[0].innerHTML = '最新版本：'
        }
    })
    //是否微信
    function isWeChat() {
        var browserName = navigator.userAgent.toLowerCase();
        if (browserName.match(/MicroMessenger/i) == "micromessenger")
        { return true; } else { return false; }
    }
    var isWeChat = isWeChat();
    function loadWeChatTip() {
        var div = document.createElement('div');
        div.id = 'weChatTip';
        div.style.background = 'url(./images/' + languageWechat + ') no-repeat';
        document.body.appendChild(div);
    }
    function loadStyleText(cssText) {
        var style = document.createElement('style');
        style.rel = 'stylesheet';
        style.type = 'text/css';
        try {
            style.appendChild(document.createTextNode(cssText));
        } catch (e) {
            style.styleSheet.cssText = cssText; //ie9以下
        }
        var head = document.getElementsByTagName("head")[0]; //head标签之间加上style样式
        head.appendChild(style);
    }
    var cssText = "#weChatTip{position: fixed; left:0; top:0; background: rgba(0,0,0,0.8); filter:alpha(opacity=80); width: 100%; height:100%; z-index: 100;}";
    //加载微信提示
    if (isWeChat) {
        loadWeChatTip();
        loadStyleText(cssText);
        aotoChangeBackground('weChatTip');
    }

    $apkDownload.off('click').on('click', function () {
        window.open('http://beop.rnbtech.com.hk/static/help/download/BeopDb.apk')
    })
    $iosDownload.off('click').on('click', function () {
        var aTag = document.createElement('a');
        aTag.href = "https://itunes.apple.com/cn/app/id1066126957?mt=8";
        document.body.appendChild(aTag);
        aTag.onclick = function () {
            document.body.removeChild(aTag)
        }
        aTag.click();
    })
    getAppVersion();
    function getAppVersion(){
        var request = new XMLHttpRequest();
        //request.responseType = 'arraybuffer';
        request.onreadystatechange=function(){
            if (request.readyState==4) {// 4 = "loaded"
                if (request.status==200){// 200 = OK
                    document.getElementById('lastVersion').innerText = JSON.parse(request.responseText).version
                }else{

                }
            }
        };
        request.open("GET",location.origin + '/appCommon/getVersion/dashboard/0',true);
        request.send(null)
    }

</script>

</html>