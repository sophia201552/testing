#coding=utf-8
from tests.utils import *
from ExpertContainer.logic.LogicBase import LogicBase
from datetime import datetime
import pytest


@pytest.mark.p0
@pytest.mark.parametrize(('projId','pointName','acttime','expected'),[
    (72,'ChAMPS01',datetime(year=2017,month=11,day=11),None),
    # (72, 'BaseChillerSysCOP_sec_svr1', datetime(year=2017, month=7, day=2), None),#目前有bug
    (72, 'BaseChillerSysCOP_sec_svr', datetime(year=2017, month=11, day=11), 6.29),
])
def test_filter_point_gt_zero(projId,pointName,acttime,expected):
    lb = LogicBase(projId,acttime ,nMode=LogicBase.ONLINE_TEST_REALTIME)
    assert lb, "create instance failed"
    rt = lb.filter_point_gt_zero(projId,pointName)
    if expected is not None:
        assert almost_equals(expected, rt) , 'not equal ,actual={0},expected is {1}'.format(rt,expected)
    else:
        assert rt is None,'actual={0}'.format(rt)


